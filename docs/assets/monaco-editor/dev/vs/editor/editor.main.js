/*! For license information please see editor.main.js.LICENSE.txt */
(function(){var CSSLoaderPlugin,__m=["exports","require","vs/base/common/lifecycle","vs/editor/common/core/range","vs/base/common/event","vs/nls","vs/nls!vs/editor/editor.main","vs/base/browser/dom","vs/base/common/strings","vs/platform/instantiation/common/instantiation","vs/base/common/async","vs/editor/common/core/position","vs/css!vs/editor/editor.main","vs/base/common/errors","vs/platform/theme/common/themeService","vs/editor/browser/editorExtensions","vs/base/common/platform","vs/platform/contextkey/common/contextkey","vs/base/common/arrays","vs/base/common/types","vs/editor/common/services/languageFeatures","vs/base/common/cancellation","vs/editor/common/core/selection","vs/platform/theme/common/colorRegistry","vs/editor/common/editorContextKeys","vs/base/common/uri","vs/platform/commands/common/commands","vs/editor/common/languages","vs/base/common/codicons","vs/editor/browser/services/codeEditorService","vs/base/common/color","vs/base/browser/fastDomNode","vs/editor/common/config/editorOptions","vs/editor/common/languages/languageConfigurationRegistry","vs/base/browser/browser","vs/editor/common/languages/language","vs/platform/registry/common/platform","vs/platform/actions/common/actions","vs/editor/common/model/textModel","vs/platform/notification/common/notification","vs/base/common/objects","vs/platform/configuration/common/configuration","vs/base/common/resources","vs/platform/keybinding/common/keybinding","vs/base/browser/keyboardEvent","vs/base/common/network","vs/base/browser/ui/aria/aria","vs/base/common/actions","vs/editor/common/services/model","vs/base/common/map","vs/editor/common/model","vs/editor/browser/view/viewPart","vs/platform/instantiation/common/extensions","vs/platform/opener/common/opener","vs/editor/common/core/editorColorRegistry","vs/base/common/stopwatch","vs/editor/common/services/resolverService","vs/base/common/iterator","vs/base/common/keyCodes","vs/base/browser/mouseEvent","vs/base/browser/touch","vs/editor/common/cursorCommon","vs/base/browser/ui/widget","vs/editor/common/core/editOperation","vs/editor/browser/config/domFontInfo","vs/platform/accessibility/common/accessibility","vs/platform/log/common/log","vs/editor/common/services/languageFeatureDebounce","vs/base/common/htmlContent","vs/base/browser/ui/scrollbar/scrollableElement","vs/editor/common/core/cursorColumns","vs/editor/common/viewModel","vs/editor/common/standaloneStrings","vs/platform/progress/common/progress","vs/platform/theme/common/iconRegistry","vs/base/common/filters","vs/base/common/severity","vs/editor/common/tokens/lineTokens","vs/platform/contextview/browser/contextView","vs/platform/markers/common/markers","vs/platform/quickinput/common/quickInput","vs/editor/common/languages/modesRegistry","vs/platform/storage/common/storage","vs/base/common/linkedList","vs/base/common/path","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/length","vs/editor/contrib/hover/browser/hoverTypes","vs/base/browser/ui/actionbar/actionbar","vs/editor/common/services/editorWorker","vs/platform/keybinding/common/keybindingsRegistry","vs/platform/telemetry/common/telemetry","vs/base/common/functional","vs/base/browser/event","vs/editor/common/core/stringBuilder","vs/editor/common/textModelEvents","vs/base/common/decorators","vs/base/common/keybindings","vs/base/common/iconLabels","vs/base/browser/globalMouseMoveMonitor","vs/editor/common/core/characterClassifier","vs/editor/common/commands/replaceCommand","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/smallImmutableSet","vs/editor/browser/view/dynamicViewOverlay","vs/editor/standalone/common/standaloneTheme","vs/platform/clipboard/common/clipboardService","vs/platform/configuration/common/configurationRegistry","vs/editor/contrib/markdownRenderer/browser/markdownRenderer","vs/platform/quickinput/common/quickAccess","vs/editor/contrib/editorState/browser/editorState","vs/editor/contrib/suggest/browser/suggest","vs/editor/contrib/peekView/browser/peekView","vs/base/browser/ui/tree/tree","vs/base/common/buffer","vs/base/common/numbers","vs/base/common/hash","vs/base/browser/ui/iconLabel/iconLabels","vs/base/browser/ui/sash/sash","vs/base/browser/ui/list/listWidget","vs/editor/browser/view/renderingContext","vs/editor/common/core/eolCounter","vs/editor/common/core/wordCharacterClassifier","vs/editor/common/core/wordHelper","vs/editor/common/languages/languageConfiguration","vs/editor/common/languages/supports","vs/editor/common/languages/nullTokenize","vs/editor/common/viewEventHandler","vs/editor/common/viewLayout/viewLineRenderer","vs/editor/contrib/snippet/browser/snippetParser","vs/base/browser/ui/actionbar/actionViewItems","vs/editor/contrib/gotoSymbol/browser/referencesModel","vs/platform/dialogs/common/dialogs","vs/platform/label/common/label","vs/platform/layout/browser/layoutService","vs/editor/browser/editorDom","vs/platform/theme/common/styler","vs/platform/theme/common/theme","vs/base/common/idGenerator","vs/base/common/lazy","vs/base/common/mime","vs/base/common/range","vs/base/common/scrollable","vs/base/common/diff/diff","vs/base/common/uint","vs/base/browser/ui/codicons/codiconStyles","vs/base/browser/ui/mouseCursor/mouseCursor","vs/css!vs/base/parts/quickinput/browser/media/quickInput","vs/editor/browser/stableEditorScroll","vs/editor/common/config/editorZoom","vs/editor/common/core/textModelDefaults","vs/editor/common/editorCommon","vs/editor/browser/editorBrowser","vs/editor/common/cursor/cursorWordOperations","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/ast","vs/editor/common/model/textModelSearch","vs/editor/common/viewLayout/lineDecorations","vs/editor/contrib/codeAction/browser/types","vs/editor/common/services/textResourceConfiguration","vs/platform/instantiation/common/serviceCollection","vs/editor/browser/coreCommands","vs/editor/contrib/codeAction/browser/codeAction","vs/editor/contrib/message/browser/messageController","vs/platform/list/browser/listService","vs/platform/undoRedo/common/undoRedo","vs/editor/browser/widget/codeEditorWidget","vs/editor/browser/widget/embeddedCodeEditorWidget","vs/editor/contrib/find/browser/findModel","vs/base/browser/dnd","vs/base/browser/canIUse","vs/base/common/extpath","vs/base/browser/ui/tree/indexTreeModel","vs/base/browser/ui/tree/objectTreeModel","vs/base/browser/formattedTextRenderer","vs/base/browser/ui/scrollbar/scrollbarArrow","vs/base/common/labels","vs/base/browser/ui/checkbox/checkbox","vs/base/browser/ui/list/listView","vs/editor/common/config/fontInfo","vs/editor/common/core/indentation","vs/editor/browser/controller/textAreaInput","vs/editor/browser/view/viewLayer","vs/editor/common/cursor/cursorMoveOperations","vs/editor/common/cursor/cursorDeleteOperations","vs/editor/common/cursor/cursorMoveCommands","vs/editor/common/languages/supports/richEditBrackets","vs/editor/common/model/utils","vs/editor/common/standalone/standaloneEnums","vs/editor/common/textModelGuides","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/tokenizer","vs/editor/browser/viewParts/glyphMargin/glyphMargin","vs/editor/common/viewEvents","vs/editor/common/viewModelEventDispatcher","vs/editor/contrib/folding/browser/foldingRanges","vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture","vs/editor/contrib/inlineCompletions/browser/ghostText","vs/editor/contrib/inlineCompletions/browser/inlineCompletionToGhostText","vs/base/browser/ui/iconLabel/iconLabel","vs/base/browser/ui/tree/abstractTree","vs/base/browser/ui/inputbox/inputBox","vs/base/common/keybindingLabels","vs/platform/instantiation/common/descriptors","vs/editor/browser/services/bulkEditService","vs/editor/common/services/markerDecorations","vs/editor/common/commands/shiftCommand","vs/editor/common/cursor/cursorTypeOperations","vs/editor/contrib/parameterHints/browser/provideSignatureHelp","vs/editor/contrib/documentSymbols/browser/outlineModel","vs/platform/jsonschemas/common/jsonContributionRegistry","vs/editor/contrib/hover/browser/markdownHoverParticipant","vs/editor/contrib/inlineCompletions/browser/inlineCompletionsModel","vs/platform/actions/browser/menuEntryActionViewItem","vs/editor/contrib/gotoSymbol/browser/goToCommands","vs/platform/workspace/common/workspace","vs/editor/contrib/snippet/browser/snippetController2","vs/editor/standalone/browser/standaloneServices","vs/base/browser/iframe","vs/base/browser/ui/scrollbar/scrollbarState","vs/base/common/assert","vs/base/common/collections","vs/base/common/glob","vs/base/common/marshalling","vs/base/browser/ui/highlightedlabel/highlightedLabel","vs/base/browser/ui/scrollbar/abstractScrollbar","vs/base/common/worker/simpleWorker","vs/base/parts/quickinput/common/quickInput","vs/css!vs/base/browser/ui/actionbar/actionbar","vs/base/browser/ui/contextview/contextview","vs/base/browser/ui/countBadge/countBadge","vs/css!vs/base/browser/ui/dropdown/dropdown","vs/css!vs/base/browser/ui/findinput/findInput","vs/css!vs/base/browser/ui/list/list","vs/base/browser/ui/hover/hoverWidget","vs/base/browser/ui/splitview/splitview","vs/base/parts/quickinput/browser/quickInputUtils","vs/editor/browser/config/elementSizeObserver","vs/editor/browser/config/tabFocus","vs/editor/browser/view/viewUserInputEvents","vs/editor/browser/viewParts/minimap/minimapCharSheet","vs/editor/browser/controller/textAreaState","vs/editor/browser/widget/diffNavigator","vs/editor/common/core/rgba","vs/editor/common/core/textChange","vs/editor/common/cursor/cursorAtomicMoveOperations","vs/editor/common/editorAction","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/parser","vs/editor/common/model/prefixSumComputer","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeBase","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBuffer","vs/editor/common/modelLineProjectionData","vs/editor/common/services/unicodeTextModelHighlighter","vs/editor/common/model/guidesTextModelPart","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/brackets","vs/editor/common/services/editorBaseApi","vs/editor/common/languages/textToHtmlTokenizer","vs/editor/browser/viewParts/margin/margin","vs/editor/common/viewModel/minimapTokensColorTracker","vs/editor/common/viewModel/overviewZoneManager","vs/editor/contrib/comment/browser/blockCommentCommand","vs/editor/contrib/folding/browser/syntaxRangeProvider","vs/editor/contrib/format/browser/formattingEdit","vs/editor/contrib/hover/browser/hoverOperation","vs/editor/contrib/indentation/browser/indentUtils","vs/editor/contrib/inlayHints/browser/inlayHints","vs/editor/contrib/inlineCompletions/browser/consts","vs/editor/contrib/smartSelect/browser/bracketSelections","vs/editor/contrib/suggest/browser/resizable","vs/editor/standalone/common/monarch/monarchCommon","vs/editor/standalone/common/monarch/monarchLexer","vs/base/browser/ui/findinput/findInputCheckboxes","vs/base/browser/ui/tree/objectTree","vs/editor/browser/config/fontMeasurements","vs/editor/common/viewModel/viewModelDecorations","vs/editor/common/model/editStack","vs/platform/files/common/files","vs/editor/common/services/getSemanticTokens","vs/editor/contrib/codelens/browser/codelens","vs/editor/contrib/colorPicker/browser/color","vs/editor/common/cursor/cursor","vs/platform/contextkey/common/contextkeys","vs/platform/keybinding/common/resolvedKeybindingItem","vs/editor/standalone/browser/standaloneLayoutService","vs/editor/browser/services/editorWorkerService","vs/editor/contrib/suggest/browser/suggestWidgetDetails","vs/platform/history/browser/contextScopedHistoryWidget","vs/editor/browser/viewParts/lines/viewLine","vs/editor/browser/controller/mouseTarget","vs/editor/browser/viewParts/lineNumbers/lineNumbers","vs/editor/common/services/semanticTokensProviderStyling","vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess","vs/editor/contrib/symbolIcons/browser/symbolIcons","vs/editor/standalone/browser/standaloneCodeEditorService","vs/editor/contrib/format/browser/format","vs/editor/contrib/gotoSymbol/browser/goToSymbol","vs/editor/contrib/hover/browser/getHover","vs/editor/contrib/codeAction/browser/codeActionCommands","vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode","vs/editor/contrib/wordOperations/browser/wordOperations","vs/editor/common/services/modelService","vs/editor/browser/widget/diffEditorWidget","vs/editor/contrib/colorPicker/browser/colorDetector","vs/editor/contrib/find/browser/findController","vs/editor/contrib/gotoError/browser/gotoError","vs/editor/contrib/gotoSymbol/browser/peek/referencesController","vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition","vs/editor/contrib/hover/browser/hover","vs/editor/contrib/inlayHints/browser/inlayHintsController","vs/editor/contrib/snippet/browser/snippetSession","vs/editor/contrib/suggest/browser/suggestController","vs/editor/contrib/inlineCompletions/browser/ghostTextController","vs/platform/workspace/common/workspaceTrust","vs/base/browser/ui/list/list","vs/base/browser/ui/list/splice","vs/base/common/cache","vs/base/common/diff/diffChange","vs/base/common/marked/marked","vs/base/common/navigator","vs/base/common/history","vs/base/common/process","vs/base/browser/ui/list/rangeMap","vs/base/browser/ui/scrollbar/scrollbarVisibilityController","vs/base/common/comparers","vs/base/browser/ui/tree/compressedObjectTreeModel","vs/base/common/fuzzyScorer","vs/base/common/search","vs/base/browser/ui/list/rowCache","vs/base/browser/ui/scrollbar/horizontalScrollbar","vs/base/browser/ui/scrollbar/verticalScrollbar","vs/base/browser/markdownRenderer","vs/base/common/uuid","vs/base/browser/defaultWorkerFactory","vs/base/parts/storage/common/storage","vs/css!vs/base/browser/ui/aria/aria","vs/css!vs/base/browser/ui/button/button","vs/base/browser/ui/button/button","vs/css!vs/base/browser/ui/checkbox/checkbox","vs/css!vs/base/browser/ui/codicons/codicon/codicon","vs/css!vs/base/browser/ui/codicons/codicon/codicon-modifiers","vs/css!vs/base/browser/ui/contextview/contextview","vs/css!vs/base/browser/ui/countBadge/countBadge","vs/css!vs/base/browser/ui/hover/hover","vs/css!vs/base/browser/ui/iconLabel/iconlabel","vs/css!vs/base/browser/ui/inputbox/inputBox","vs/css!vs/base/browser/ui/keybindingLabel/keybindingLabel","vs/css!vs/base/browser/ui/mouseCursor/mouseCursor","vs/css!vs/base/browser/ui/progressbar/progressbar","vs/base/browser/ui/progressbar/progressbar","vs/css!vs/base/browser/ui/sash/sash","vs/css!vs/base/browser/ui/scrollbar/media/scrollbars","vs/base/browser/ui/list/listPaging","vs/css!vs/base/browser/ui/splitview/splitview","vs/css!vs/base/browser/ui/table/table","vs/base/browser/ui/table/tableWidget","vs/css!vs/base/browser/ui/tree/media/tree","vs/css!vs/editor/browser/controller/textAreaHandler","vs/css!vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight","vs/css!vs/editor/browser/viewParts/decorations/decorations","vs/css!vs/editor/browser/viewParts/glyphMargin/glyphMargin","vs/css!vs/editor/browser/viewParts/indentGuides/indentGuides","vs/css!vs/editor/browser/viewParts/lineNumbers/lineNumbers","vs/css!vs/editor/browser/viewParts/lines/viewLines","vs/css!vs/editor/browser/viewParts/linesDecorations/linesDecorations","vs/css!vs/editor/browser/viewParts/marginDecorations/marginDecorations","vs/css!vs/editor/browser/viewParts/minimap/minimap","vs/css!vs/editor/browser/viewParts/overlayWidgets/overlayWidgets","vs/css!vs/editor/browser/viewParts/rulers/rulers","vs/css!vs/editor/browser/viewParts/scrollDecoration/scrollDecoration","vs/css!vs/editor/browser/viewParts/selections/selections","vs/css!vs/editor/browser/viewParts/viewCursors/viewCursors","vs/css!vs/editor/browser/widget/media/diffEditor","vs/css!vs/editor/browser/widget/media/diffReview","vs/css!vs/editor/browser/widget/media/editor","vs/css!vs/editor/contrib/anchorSelect/browser/anchorSelect","vs/css!vs/editor/contrib/bracketMatching/browser/bracketMatching","vs/css!vs/editor/contrib/codeAction/browser/lightBulbWidget","vs/css!vs/editor/contrib/codelens/browser/codelensWidget","vs/css!vs/editor/contrib/colorPicker/browser/colorPicker","vs/css!vs/editor/contrib/dnd/browser/dnd","vs/css!vs/editor/contrib/find/browser/findWidget","vs/css!vs/editor/contrib/folding/browser/folding","vs/css!vs/editor/contrib/gotoError/browser/media/gotoErrorWidget","vs/css!vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition","vs/css!vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget","vs/css!vs/editor/contrib/inlineCompletions/browser/ghostText","vs/css!vs/editor/contrib/links/browser/links","vs/css!vs/editor/contrib/message/browser/messageController","vs/css!vs/editor/contrib/parameterHints/browser/parameterHints","vs/css!vs/editor/contrib/peekView/browser/media/peekViewWidget","vs/css!vs/editor/contrib/rename/browser/renameInputField","vs/css!vs/editor/contrib/snippet/browser/snippetSession","vs/css!vs/editor/contrib/suggest/browser/media/suggest","vs/css!vs/editor/contrib/unicodeHighlighter/browser/bannerController","vs/css!vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter","vs/css!vs/editor/contrib/zoneWidget/browser/zoneWidget","vs/css!vs/editor/standalone/browser/accessibilityHelp/accessibilityHelp","vs/css!vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard","vs/css!vs/editor/standalone/browser/inspectTokens/inspectTokens","vs/css!vs/editor/standalone/browser/quickInput/standaloneQuickInput","vs/css!vs/editor/standalone/browser/standalone-tokens","vs/css!vs/platform/actions/browser/menuEntryActionViewItem","vs/css!vs/platform/contextview/browser/contextMenuHandler","vs/editor/browser/config/migrateOptions","vs/editor/browser/viewParts/lines/rangeUtil","vs/editor/browser/viewParts/minimap/minimapCharRenderer","vs/editor/browser/viewParts/minimap/minimapPreBaked","vs/editor/browser/viewParts/minimap/minimapCharRendererFactory","vs/editor/common/commands/trimTrailingWhitespaceCommand","vs/editor/common/commands/surroundSelectionCommand","vs/editor/common/cursor/cursorContext","vs/editor/common/diff/diffComputer","vs/editor/common/editorTheme","vs/editor/common/languageSelector","vs/editor/common/languages/linkComputer","vs/editor/common/cursor/cursorColumnSelection","vs/editor/common/cursor/oneCursor","vs/editor/common/cursor/cursorCollection","vs/editor/common/languages/supports/characterPair","vs/editor/common/languages/supports/indentRules","vs/editor/common/languages/supports/inplaceReplaceSupport","vs/editor/common/languages/supports/onEnter","vs/editor/common/languages/supports/electricCharacter","vs/editor/common/languages/supports/tokenization","vs/editor/common/languageFeatureRegistry","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/nodeReader","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/concat23Trees","vs/editor/common/model/indentationGuesser","vs/editor/common/model/intervalTree","vs/editor/common/model/pieceTreeTextBuffer/rbTreeBase","vs/editor/common/model/mirrorTextModel","vs/editor/common/model/textModelPart","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBufferBuilder","vs/editor/common/services/languagesAssociations","vs/editor/common/services/semanticTokensDto","vs/editor/common/textModelBracketPairs","vs/editor/common/tokenizationRegistry","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/bracketPairsTree","vs/editor/common/model/bracketPairsTextModelPart/bracketPairsImpl","vs/editor/common/model/bracketPairsTextModelPart/fixBrackets","vs/editor/common/services/editorSimpleWorker","vs/editor/common/tokens/contiguousMultilineTokens","vs/editor/common/tokens/contiguousMultilineTokensBuilder","vs/editor/common/model/textModelTokens","vs/editor/common/tokens/contiguousTokensEditing","vs/editor/common/tokens/contiguousTokensStore","vs/editor/common/tokens/sparseMultilineTokens","vs/editor/common/tokens/sparseTokensStore","vs/editor/browser/viewParts/contentWidgets/contentWidgets","vs/editor/browser/viewParts/decorations/decorations","vs/editor/browser/viewParts/linesDecorations/linesDecorations","vs/editor/browser/viewParts/marginDecorations/marginDecorations","vs/editor/browser/viewParts/overlayWidgets/overlayWidgets","vs/editor/browser/viewParts/viewZones/viewZones","vs/editor/common/viewLayout/linesLayout","vs/editor/common/viewLayout/viewLinesViewportData","vs/editor/common/viewModel/modelLineProjection","vs/editor/common/viewModel/monospaceLineBreaksComputer","vs/editor/browser/viewParts/overviewRuler/overviewRuler","vs/editor/common/viewModel/viewContext","vs/editor/common/viewLayout/viewLayout","vs/editor/contrib/caretOperations/browser/moveCaretCommand","vs/editor/contrib/colorPicker/browser/colorPickerModel","vs/editor/contrib/dnd/browser/dragAndDropCommand","vs/editor/contrib/find/browser/replaceAllCommand","vs/editor/contrib/find/browser/replacePattern","vs/editor/contrib/folding/browser/foldingModel","vs/editor/contrib/folding/browser/hiddenRangeModel","vs/editor/contrib/folding/browser/indentRangeProvider","vs/editor/contrib/folding/browser/intializingRangeProvider","vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand","vs/editor/contrib/inlineCompletions/browser/utils","vs/editor/contrib/linesOperations/browser/copyLinesCommand","vs/editor/contrib/linesOperations/browser/sortLinesCommand","vs/editor/contrib/smartSelect/browser/wordSelections","vs/editor/contrib/suggest/browser/completionModel","vs/editor/contrib/suggest/browser/suggestCommitCharacters","vs/editor/contrib/suggest/browser/suggestOvertypingCapturer","vs/editor/contrib/suggest/browser/wordDistance","vs/editor/standalone/common/monarch/monarchCompile","vs/editor/standalone/browser/colorizer","vs/nls!vs/base/browser/ui/actionbar/actionViewItems","vs/nls!vs/base/browser/ui/findinput/findInput","vs/nls!vs/base/browser/ui/findinput/findInputCheckboxes","vs/nls!vs/base/browser/ui/findinput/replaceInput","vs/nls!vs/base/browser/ui/iconLabel/iconLabelHover","vs/base/browser/ui/iconLabel/iconLabelHover","vs/nls!vs/base/browser/ui/inputbox/inputBox","vs/nls!vs/base/browser/ui/keybindingLabel/keybindingLabel","vs/nls!vs/base/browser/ui/tree/abstractTree","vs/base/browser/ui/tree/dataTree","vs/base/browser/ui/tree/asyncDataTree","vs/nls!vs/base/common/actions","vs/base/browser/ui/dropdown/dropdown","vs/base/browser/ui/dropdown/dropdownActionViewItem","vs/base/browser/ui/findinput/findInput","vs/base/browser/ui/findinput/replaceInput","vs/base/browser/ui/menu/menu","vs/base/parts/quickinput/browser/quickInputBox","vs/nls!vs/base/common/errorMessage","vs/base/common/errorMessage","vs/nls!vs/base/common/keybindingLabels","vs/base/browser/ui/keybindingLabel/keybindingLabel","vs/nls!vs/base/parts/quickinput/browser/quickInput","vs/nls!vs/base/parts/quickinput/browser/quickInputList","vs/base/parts/quickinput/browser/quickInputList","vs/base/parts/quickinput/browser/quickInput","vs/nls!vs/editor/browser/controller/textAreaHandler","vs/nls!vs/editor/browser/coreCommands","vs/nls!vs/editor/browser/editorExtensions","vs/nls!vs/editor/browser/widget/codeEditorWidget","vs/nls!vs/editor/browser/widget/diffEditorWidget","vs/nls!vs/editor/browser/widget/diffReview","vs/nls!vs/editor/browser/widget/inlineDiffMargin","vs/editor/browser/widget/inlineDiffMargin","vs/nls!vs/editor/common/config/editorConfigurationSchema","vs/nls!vs/editor/common/config/editorOptions","vs/editor/browser/config/charWidthReader","vs/editor/browser/view/domLineBreaksComputer","vs/editor/browser/view/viewOverlays","vs/editor/browser/viewParts/viewCursors/viewCursor","vs/nls!vs/editor/common/core/editorColorRegistry","vs/nls!vs/editor/common/editorContextKeys","vs/nls!vs/editor/common/languages/modesRegistry","vs/nls!vs/editor/common/model/editStack","vs/nls!vs/editor/common/standaloneStrings","vs/nls!vs/editor/contrib/anchorSelect/browser/anchorSelect","vs/nls!vs/editor/contrib/bracketMatching/browser/bracketMatching","vs/nls!vs/editor/contrib/caretOperations/browser/caretOperations","vs/nls!vs/editor/contrib/caretOperations/browser/transpose","vs/nls!vs/editor/contrib/clipboard/browser/clipboard","vs/nls!vs/editor/contrib/codeAction/browser/codeActionCommands","vs/nls!vs/editor/contrib/codeAction/browser/lightBulbWidget","vs/nls!vs/editor/contrib/codelens/browser/codelensController","vs/nls!vs/editor/contrib/colorPicker/browser/colorPickerWidget","vs/nls!vs/editor/contrib/comment/browser/comment","vs/nls!vs/editor/contrib/contextmenu/browser/contextmenu","vs/nls!vs/editor/contrib/cursorUndo/browser/cursorUndo","vs/nls!vs/editor/contrib/editorState/browser/keybindingCancellation","vs/nls!vs/editor/contrib/find/browser/findController","vs/nls!vs/editor/contrib/find/browser/findWidget","vs/nls!vs/editor/contrib/folding/browser/folding","vs/nls!vs/editor/contrib/folding/browser/foldingDecorations","vs/nls!vs/editor/contrib/fontZoom/browser/fontZoom","vs/nls!vs/editor/contrib/format/browser/format","vs/nls!vs/editor/contrib/format/browser/formatActions","vs/nls!vs/editor/contrib/gotoError/browser/gotoError","vs/nls!vs/editor/contrib/gotoError/browser/gotoErrorWidget","vs/nls!vs/editor/contrib/gotoSymbol/browser/goToCommands","vs/nls!vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition","vs/nls!vs/editor/contrib/gotoSymbol/browser/peek/referencesController","vs/nls!vs/editor/contrib/gotoSymbol/browser/peek/referencesTree","vs/nls!vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget","vs/nls!vs/editor/contrib/gotoSymbol/browser/referencesModel","vs/nls!vs/editor/contrib/gotoSymbol/browser/symbolNavigation","vs/nls!vs/editor/contrib/hover/browser/hover","vs/nls!vs/editor/contrib/hover/browser/markdownHoverParticipant","vs/nls!vs/editor/contrib/hover/browser/markerHoverParticipant","vs/nls!vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace","vs/nls!vs/editor/contrib/indentation/browser/indentation","vs/nls!vs/editor/contrib/inlayHints/browser/inlayHintsHover","vs/nls!vs/editor/contrib/inlineCompletions/browser/ghostTextController","vs/nls!vs/editor/contrib/inlineCompletions/browser/inlineCompletionsHoverParticipant","vs/nls!vs/editor/contrib/lineSelection/browser/lineSelection","vs/nls!vs/editor/contrib/linesOperations/browser/linesOperations","vs/nls!vs/editor/contrib/linkedEditing/browser/linkedEditing","vs/nls!vs/editor/contrib/links/browser/links","vs/nls!vs/editor/contrib/message/browser/messageController","vs/nls!vs/editor/contrib/multicursor/browser/multicursor","vs/nls!vs/editor/contrib/parameterHints/browser/parameterHints","vs/nls!vs/editor/contrib/parameterHints/browser/parameterHintsWidget","vs/nls!vs/editor/contrib/peekView/browser/peekView","vs/nls!vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess","vs/nls!vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess","vs/nls!vs/editor/contrib/rename/browser/rename","vs/nls!vs/editor/contrib/rename/browser/renameInputField","vs/nls!vs/editor/contrib/smartSelect/browser/smartSelect","vs/nls!vs/editor/contrib/snippet/browser/snippetController2","vs/nls!vs/editor/contrib/snippet/browser/snippetVariables","vs/nls!vs/editor/contrib/suggest/browser/suggest","vs/nls!vs/editor/contrib/suggest/browser/suggestController","vs/nls!vs/editor/contrib/suggest/browser/suggestWidget","vs/nls!vs/editor/contrib/suggest/browser/suggestWidgetDetails","vs/nls!vs/editor/contrib/suggest/browser/suggestWidgetRenderer","vs/nls!vs/editor/contrib/suggest/browser/suggestWidgetStatus","vs/nls!vs/editor/contrib/symbolIcons/browser/symbolIcons","vs/nls!vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode","vs/nls!vs/editor/contrib/tokenization/browser/tokenization","vs/nls!vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter","vs/nls!vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators","vs/nls!vs/editor/contrib/wordHighlighter/browser/wordHighlighter","vs/nls!vs/editor/contrib/wordOperations/browser/wordOperations","vs/nls!vs/platform/actions/browser/menuEntryActionViewItem","vs/nls!vs/platform/configuration/common/configurationRegistry","vs/nls!vs/platform/contextkey/browser/contextKeyService","vs/nls!vs/platform/contextkey/common/contextkeys","vs/nls!vs/platform/history/browser/contextScopedHistoryWidget","vs/nls!vs/platform/keybinding/common/abstractKeybindingService","vs/nls!vs/platform/list/browser/listService","vs/nls!vs/platform/markers/common/markers","vs/nls!vs/platform/quickinput/browser/commandsQuickAccess","vs/nls!vs/platform/quickinput/browser/helpQuickAccess","vs/nls!vs/platform/theme/common/colorRegistry","vs/nls!vs/platform/theme/common/iconRegistry","vs/nls!vs/platform/undoRedo/common/undoRedoService","vs/nls!vs/platform/workspace/common/workspace","vs/platform/editor/common/editor","vs/platform/extensions/common/extensions","vs/platform/history/browser/historyWidgetKeybindingHint","vs/platform/instantiation/common/graph","vs/editor/common/services/languageFeaturesService","vs/editor/contrib/links/browser/getLinks","vs/editor/contrib/comment/browser/lineCommentCommand","vs/editor/contrib/linesOperations/browser/moveLinesCommand","vs/editor/contrib/parameterHints/browser/parameterHintsModel","vs/editor/contrib/suggest/browser/suggestAlternatives","vs/editor/contrib/suggest/browser/wordContextKey","vs/editor/browser/config/editorConfiguration","vs/platform/accessibility/browser/accessibilityService","vs/platform/contextkey/browser/contextKeyService","vs/platform/instantiation/common/instantiationService","vs/platform/keybinding/common/abstractKeybindingService","vs/platform/keybinding/common/baseResolvedKeybinding","vs/platform/keybinding/common/keybindingResolver","vs/platform/keybinding/common/usLayoutResolvedKeybinding","vs/platform/contextview/browser/contextViewService","vs/editor/browser/services/webWorker","vs/editor/contrib/documentSymbols/browser/documentSymbols","vs/platform/clipboard/browser/clipboardService","vs/editor/contrib/gotoError/browser/markerNavigationService","vs/platform/markers/common/markerService","vs/editor/browser/services/openerService","vs/platform/quickinput/browser/pickerQuickAccess","vs/editor/common/config/editorConfigurationSchema","vs/editor/common/services/getIconClasses","vs/editor/common/services/languagesRegistry","vs/editor/common/services/languageService","vs/editor/contrib/hover/browser/marginHover","vs/platform/configuration/common/configurationModels","vs/platform/quickinput/browser/helpQuickAccess","vs/editor/standalone/browser/quickAccess/standaloneHelpQuickAccess","vs/platform/quickinput/browser/quickAccess","vs/editor/contrib/codelens/browser/codeLensCache","vs/editor/contrib/suggest/browser/suggestMemory","vs/platform/quickinput/browser/commandsQuickAccess","vs/editor/contrib/quickAccess/browser/commandsQuickAccess","vs/platform/contextview/browser/contextMenuHandler","vs/editor/browser/controller/mouseHandler","vs/editor/browser/controller/pointerHandler","vs/editor/browser/viewParts/lines/viewLines","vs/editor/browser/services/abstractCodeEditorService","vs/editor/browser/viewParts/editorScrollbar/editorScrollbar","vs/editor/browser/viewParts/minimap/minimap","vs/editor/browser/viewParts/scrollDecoration/scrollDecoration","vs/editor/browser/viewParts/selections/selections","vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight","vs/editor/browser/viewParts/indentGuides/indentGuides","vs/editor/browser/controller/textAreaHandler","vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler","vs/editor/browser/viewParts/rulers/rulers","vs/editor/browser/viewParts/viewCursors/viewCursors","vs/editor/common/model/bracketPairsTextModelPart/colorizedBracketPairsDecorationProvider","vs/editor/common/services/markerDecorationsService","vs/editor/contrib/codeAction/browser/lightBulbWidget","vs/editor/contrib/colorPicker/browser/colorPickerWidget","vs/editor/contrib/gotoSymbol/browser/peek/referencesTree","vs/editor/contrib/inlineCompletions/browser/ghostTextWidget","vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess","vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess","vs/editor/contrib/rename/browser/renameInputField","vs/editor/standalone/common/themes","vs/editor/browser/services/markerDecorations","vs/editor/browser/view/viewController","vs/editor/browser/view","vs/editor/contrib/anchorSelect/browser/anchorSelect","vs/editor/contrib/caretOperations/browser/caretOperations","vs/editor/contrib/caretOperations/browser/transpose","vs/editor/contrib/clipboard/browser/clipboard","vs/editor/contrib/comment/browser/comment","vs/editor/contrib/contextmenu/browser/contextmenu","vs/editor/contrib/cursorUndo/browser/cursorUndo","vs/editor/contrib/editorState/browser/keybindingCancellation","vs/editor/contrib/codeAction/browser/codeActionMenu","vs/editor/contrib/codeAction/browser/codeActionModel","vs/editor/contrib/fontZoom/browser/fontZoom","vs/editor/contrib/format/browser/formatActions","vs/editor/contrib/gotoSymbol/browser/symbolNavigation","vs/editor/contrib/indentation/browser/indentation","vs/editor/contrib/lineSelection/browser/lineSelection","vs/editor/contrib/linesOperations/browser/linesOperations","vs/editor/contrib/codeAction/browser/codeActionUi","vs/editor/contrib/codeAction/browser/codeActionContributions","vs/editor/contrib/rename/browser/rename","vs/editor/contrib/smartSelect/browser/smartSelect","vs/editor/contrib/tokenization/browser/tokenization","vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators","vs/editor/contrib/wordPartOperations/browser/wordPartOperations","vs/editor/standalone/browser/accessibilityHelp/accessibilityHelp","vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard","vs/editor/standalone/browser/inspectTokens/inspectTokens","vs/editor/standalone/browser/quickAccess/standaloneCommandsQuickAccess","vs/editor/standalone/browser/quickAccess/standaloneGotoLineQuickAccess","vs/editor/standalone/browser/quickAccess/standaloneGotoSymbolQuickAccess","vs/editor/standalone/browser/toggleHighContrast/toggleHighContrast","vs/editor/contrib/suggest/browser/suggestWidgetStatus","vs/platform/actions/common/menuService","vs/platform/contextview/browser/contextMenuService","vs/platform/opener/browser/link","vs/platform/quickinput/browser/quickInput","vs/editor/standalone/browser/quickInput/standaloneQuickInputService","vs/platform/severityIcon/common/severityIcon","vs/editor/browser/widget/diffReview","vs/editor/contrib/parameterHints/browser/parameterHintsWidget","vs/editor/contrib/parameterHints/browser/parameterHints","vs/editor/contrib/suggest/browser/suggestWidgetRenderer","vs/editor/contrib/unicodeHighlighter/browser/bannerController","vs/platform/theme/browser/iconsStyleSheet","vs/editor/standalone/browser/standaloneThemeService","vs/editor/common/viewModel/viewModelLines","vs/editor/common/viewModel/viewModelImpl","vs/editor/contrib/bracketMatching/browser/bracketMatching","vs/editor/contrib/codelens/browser/codelensWidget","vs/editor/contrib/codelens/browser/codelensController","vs/editor/contrib/colorPicker/browser/colorHoverParticipant","vs/editor/contrib/dnd/browser/dnd","vs/editor/contrib/find/browser/findDecorations","vs/editor/contrib/find/browser/findOptionsWidget","vs/editor/contrib/find/browser/findState","vs/editor/contrib/find/browser/findWidget","vs/editor/contrib/folding/browser/foldingDecorations","vs/editor/contrib/folding/browser/folding","vs/editor/contrib/hover/browser/contentHover","vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace","vs/editor/contrib/linkedEditing/browser/linkedEditing","vs/editor/contrib/links/browser/links","vs/editor/contrib/multicursor/browser/multicursor","vs/editor/contrib/suggest/browser/suggestWidget","vs/editor/contrib/viewportSemanticTokens/browser/viewportSemanticTokens","vs/editor/contrib/wordHighlighter/browser/wordHighlighter","vs/editor/contrib/zoneWidget/browser/zoneWidget","vs/editor/contrib/gotoError/browser/gotoErrorWidget","vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget","vs/editor/contrib/hover/browser/markerHoverParticipant","vs/editor/contrib/colorPicker/browser/colorContributions","vs/editor/contrib/inlayHints/browser/inlayHintsLocations","vs/editor/contrib/inlayHints/browser/inlayHintsHover","vs/editor/contrib/inlayHints/browser/inlayHintsContribution","vs/editor/standalone/browser/referenceSearch/standaloneReferenceSearch","vs/platform/undoRedo/common/undoRedoService","vs/editor/contrib/snippet/browser/snippetVariables","vs/editor/contrib/suggest/browser/suggestModel","vs/editor/contrib/inlineCompletions/browser/suggestWidgetInlineCompletionProvider","vs/editor/contrib/inlineCompletions/browser/suggestWidgetPreviewModel","vs/editor/contrib/inlineCompletions/browser/ghostTextModel","vs/editor/contrib/inlineCompletions/browser/inlineCompletionsHoverParticipant","vs/editor/contrib/inlineCompletions/browser/inlineCompletionsContribution","vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter","vs/editor/editor.all","vs/editor/standalone/browser/standaloneCodeEditor","vs/editor/standalone/browser/standaloneEditor","vs/editor/standalone/browser/standaloneLanguages","vs/editor/editor.api","vs/base/browser/dompurify/dompurify","vs/editor/edcore.main"],__M=function(deps){for(var result=[],i=0,len=deps.length;i<len;i++)result[i]=__m[deps[i]];return result};!function(CSSLoaderPlugin){var BrowserCSSLoader=function(){function BrowserCSSLoader(){this._pendingLoads=0}return BrowserCSSLoader.prototype.attachListeners=function(name,linkNode,callback,errorback){var unbind=function(){linkNode.removeEventListener("load",loadEventListener),linkNode.removeEventListener("error",errorEventListener)},loadEventListener=function(e){unbind(),callback()},errorEventListener=function(e){unbind(),errorback(e)};linkNode.addEventListener("load",loadEventListener),linkNode.addEventListener("error",errorEventListener)},BrowserCSSLoader.prototype._onLoad=function(name,callback){this._pendingLoads--,callback()},BrowserCSSLoader.prototype._onLoadError=function(name,errorback,err){this._pendingLoads--,errorback(err)},BrowserCSSLoader.prototype._insertLinkNode=function(linkNode){this._pendingLoads++,(document.head||document.getElementsByTagName("head")[0]).appendChild(linkNode)},BrowserCSSLoader.prototype.createLinkTag=function(name,cssUrl,externalCallback,externalErrorback){var _this=this,linkNode=document.createElement("link");linkNode.setAttribute("rel","stylesheet"),linkNode.setAttribute("type","text/css"),linkNode.setAttribute("data-name",name);return this.attachListeners(name,linkNode,(function(){return _this._onLoad(name,externalCallback)}),(function(err){return _this._onLoadError(name,externalErrorback,err)})),linkNode.setAttribute("href",cssUrl),linkNode},BrowserCSSLoader.prototype._linkTagExists=function(name,cssUrl){var i,len,nameAttr,hrefAttr,links=document.getElementsByTagName("link");for(i=0,len=links.length;i<len;i++)if(nameAttr=links[i].getAttribute("data-name"),hrefAttr=links[i].getAttribute("href"),nameAttr===name||hrefAttr===cssUrl)return!0;return!1},BrowserCSSLoader.prototype.load=function(name,cssUrl,externalCallback,externalErrorback){if(this._linkTagExists(name,cssUrl))externalCallback();else{var linkNode=this.createLinkTag(name,cssUrl,externalCallback,externalErrorback);this._insertLinkNode(linkNode)}},BrowserCSSLoader}(),CSSPlugin=function(){function CSSPlugin(){this._cssLoader=new BrowserCSSLoader}return CSSPlugin.prototype.load=function(name,req,load,config){if(((config=config||{})["vs/css"]||{}).disabled)load({});else{var cssUrl=req.toUrl(name+".css");this._cssLoader.load(name,cssUrl,(function(contents){load({})}),(function(err){"function"==typeof load.error&&load.error("Could not find "+cssUrl+" or it was empty")}))}},CSSPlugin}();CSSLoaderPlugin.CSSPlugin=CSSPlugin,define("vs/css",new CSSPlugin)}(CSSLoaderPlugin||(CSSLoaderPlugin={}));var NLSLoaderPlugin,__spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};!function(NLSLoaderPlugin){var Environment=function(){function Environment(){this._detected=!1,this._isPseudo=!1}return Object.defineProperty(Environment.prototype,"isPseudo",{get:function(){return this._detect(),this._isPseudo},enumerable:!1,configurable:!0}),Environment.prototype._detect=function(){this._detected||(this._detected=!0,this._isPseudo="undefined"!=typeof document&&document.location&&document.location.hash.indexOf("pseudo=true")>=0)},Environment}();function _format(message,args,env){var result;return result=0===args.length?message:message.replace(/\{(\d+)\}/g,(function(match,rest){var index=rest[0],arg=args[index],result=match;return"string"==typeof arg?result=arg:"number"!=typeof arg&&"boolean"!=typeof arg&&null!=arg||(result=String(arg)),result})),env.isPseudo&&(result="［"+result.replace(/[aouei]/g,"$&$&")+"］"),result}function localize(env,data,message){for(var args=[],_i=3;_i<arguments.length;_i++)args[_i-3]=arguments[_i];return _format(message,args,env)}function createScopedLocalize(scope,env){return function(idx,defaultValue){var restArgs=Array.prototype.slice.call(arguments,2);return _format(scope[idx],restArgs,env)}}var NLSPlugin=function(){function NLSPlugin(env){var _this=this;this._env=env,this.localize=function(data,message){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return localize.apply(void 0,__spreadArrays([_this._env,data,message],args))}}return NLSPlugin.prototype.setPseudoTranslation=function(value){this._env._isPseudo=value},NLSPlugin.prototype.create=function(key,data){return{localize:createScopedLocalize(data[key],this._env)}},NLSPlugin.prototype.load=function(name,req,load,config){var _this=this;if(config=config||{},name&&0!==name.length){var pluginConfig=config["vs/nls"]||{},language=pluginConfig.availableLanguages?function findLanguageForModule(config,name){var result=config[name];return result||(result=config["*"])||null}(pluginConfig.availableLanguages,name):null,suffix=".nls";null!==language&&language!==NLSPlugin.DEFAULT_TAG&&(suffix=suffix+"."+language);var messagesLoaded_1=function(messages){Array.isArray(messages)?messages.localize=createScopedLocalize(messages,_this._env):messages.localize=createScopedLocalize(messages[name],_this._env),load(messages)};"function"==typeof pluginConfig.loadBundle?pluginConfig.loadBundle(name,language,(function(err,messages){err?req([name+".nls"],messagesLoaded_1):messagesLoaded_1(messages)})):req([name+suffix],messagesLoaded_1)}else load({localize:this.localize})},NLSPlugin.DEFAULT_TAG="i-default",NLSPlugin}();NLSLoaderPlugin.NLSPlugin=NLSPlugin,define("vs/nls",new NLSPlugin(new Environment))}(NLSLoaderPlugin||(NLSLoaderPlugin={}));var hasOwnProperty=Object.hasOwnProperty,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,getPrototypeOf=Object.getPrototypeOf,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,freeze=Object.freeze,seal=Object.seal,create=Object.create,_ref="undefined"!=typeof Reflect&&Reflect,apply=_ref.apply,construct=_ref.construct;apply||(apply=function apply(fun,thisValue,args){return fun.apply(thisValue,args)}),freeze||(freeze=function freeze(x){return x}),seal||(seal=function seal(x){return x}),construct||(construct=function construct(Func,args){return new(Function.prototype.bind.apply(Func,[null].concat(function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}(args))))});var arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=function unconstruct(func){return function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return construct(func,args)}}(TypeError);function unapply(func){return function(thisArg){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return apply(func,thisArg,args)}}function addToSet(set,array){setPrototypeOf&&setPrototypeOf(set,null);for(var l=array.length;l--;){var element=array[l];if("string"==typeof element){var lcElement=stringToLowerCase(element);lcElement!==element&&(isFrozen(array)||(array[l]=lcElement),element=lcElement)}set[element]=!0}return set}function clone(object){var newObject=create(null),property=void 0;for(property in object)apply(hasOwnProperty,object,[property])&&(newObject[property]=object[property]);return newObject}function lookupGetter(object,prop){for(;null!==object;){var desc=getOwnPropertyDescriptor(object,prop);if(desc){if(desc.get)return unapply(desc.get);if("function"==typeof desc.value)return unapply(desc.value)}object=getPrototypeOf(object)}return function fallbackValue(element){return console.warn("fallback value for",element),null}}var html=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html$1=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg$1=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl$1=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\s\S]*|[\s\S]*\}\}/gm),ERB_EXPR=seal(/<%[\s\S]*|[\s\S]*%>/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _toConsumableArray$1(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var getGlobal=function getGlobal(){return"undefined"==typeof window?null:window},_createTrustedTypesPolicy=function _createTrustedTypesPolicy(trustedTypes,document){if("object"!==(void 0===trustedTypes?"undefined":_typeof(trustedTypes))||"function"!=typeof trustedTypes.createPolicy)return null;var suffix=null;document.currentScript&&document.currentScript.hasAttribute("data-tt-policy-suffix")&&(suffix=document.currentScript.getAttribute("data-tt-policy-suffix"));var policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:function createHTML(html$$1){return html$$1}})}catch(_){return console.warn("TrustedTypes policy "+policyName+" could not be created."),null}};var purify=function createDOMPurify(){var window=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getGlobal(),DOMPurify=function DOMPurify(root){return createDOMPurify(root)};if(DOMPurify.version="2.3.1",DOMPurify.removed=[],!window||!window.document||9!==window.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var originalDocument=window.document,document=window.document,DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,Node=window.Node,Element=window.Element,NodeFilter=window.NodeFilter,_window$NamedNodeMap=window.NamedNodeMap,NamedNodeMap=void 0===_window$NamedNodeMap?window.NamedNodeMap||window.MozNamedAttrMap:_window$NamedNodeMap,Text=window.Text,Comment=window.Comment,DOMParser=window.DOMParser,trustedTypes=window.trustedTypes,ElementPrototype=Element.prototype,cloneNode=lookupGetter(ElementPrototype,"cloneNode"),getNextSibling=lookupGetter(ElementPrototype,"nextSibling"),getChildNodes=lookupGetter(ElementPrototype,"childNodes"),getParentNode=lookupGetter(ElementPrototype,"parentNode");if("function"==typeof HTMLTemplateElement){var template=document.createElement("template");template.content&&template.content.ownerDocument&&(document=template.content.ownerDocument)}var trustedTypesPolicy=_createTrustedTypesPolicy(trustedTypes,originalDocument),emptyHTML=trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(""):"",_document=document,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,createDocumentFragment=_document.createDocumentFragment,getElementsByTagName=_document.getElementsByTagName,importNode=originalDocument.importNode,documentMode={};try{documentMode=clone(document).documentMode?document.documentMode:{}}catch(_){}var hooks={};DOMPurify.isSupported="function"==typeof getParentNode&&implementation&&void 0!==implementation.createHTMLDocument&&9!==documentMode;var MUSTACHE_EXPR$$1=MUSTACHE_EXPR,ERB_EXPR$$1=ERB_EXPR,DATA_ATTR$$1=DATA_ATTR,ARIA_ATTR$$1=ARIA_ATTR,IS_SCRIPT_OR_DATA$$1=IS_SCRIPT_OR_DATA,ATTR_WHITESPACE$$1=ATTR_WHITESPACE,IS_ALLOWED_URI$$1=IS_ALLOWED_URI,ALLOWED_TAGS=null,DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray$1(html),_toConsumableArray$1(svg),_toConsumableArray$1(svgFilters),_toConsumableArray$1(mathMl),_toConsumableArray$1(text))),ALLOWED_ATTR=null,DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray$1(html$1),_toConsumableArray$1(svg$1),_toConsumableArray$1(mathMl$1),_toConsumableArray$1(xml))),FORBID_TAGS=null,FORBID_ATTR=null,ALLOW_ARIA_ATTR=!0,ALLOW_DATA_ATTR=!0,ALLOW_UNKNOWN_PROTOCOLS=!1,SAFE_FOR_TEMPLATES=!1,WHOLE_DOCUMENT=!1,SET_CONFIG=!1,FORCE_BODY=!1,RETURN_DOM=!1,RETURN_DOM_FRAGMENT=!1,RETURN_DOM_IMPORT=!0,RETURN_TRUSTED_TYPE=!1,SANITIZE_DOM=!0,KEEP_CONTENT=!0,IN_PLACE=!1,USE_PROFILES={},FORBID_CONTENTS=null,DEFAULT_FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),DATA_URI_TAGS=null,DEFAULT_DATA_URI_TAGS=addToSet({},["audio","video","img","source","image","track"]),URI_SAFE_ATTRIBUTES=null,DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),MATHML_NAMESPACE="http://www.w3.org/1998/Math/MathML",SVG_NAMESPACE="http://www.w3.org/2000/svg",HTML_NAMESPACE="http://www.w3.org/1999/xhtml",NAMESPACE=HTML_NAMESPACE,IS_EMPTY_INPUT=!1,CONFIG=null,formElement=document.createElement("form"),_parseConfig=function _parseConfig(cfg){CONFIG&&CONFIG===cfg||(cfg&&"object"===(void 0===cfg?"undefined":_typeof(cfg))||(cfg={}),cfg=clone(cfg),ALLOWED_TAGS="ALLOWED_TAGS"in cfg?addToSet({},cfg.ALLOWED_TAGS):DEFAULT_ALLOWED_TAGS,ALLOWED_ATTR="ALLOWED_ATTR"in cfg?addToSet({},cfg.ALLOWED_ATTR):DEFAULT_ALLOWED_ATTR,URI_SAFE_ATTRIBUTES="ADD_URI_SAFE_ATTR"in cfg?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR):DEFAULT_URI_SAFE_ATTRIBUTES,DATA_URI_TAGS="ADD_DATA_URI_TAGS"in cfg?addToSet(clone(DEFAULT_DATA_URI_TAGS),cfg.ADD_DATA_URI_TAGS):DEFAULT_DATA_URI_TAGS,FORBID_CONTENTS="FORBID_CONTENTS"in cfg?addToSet({},cfg.FORBID_CONTENTS):DEFAULT_FORBID_CONTENTS,FORBID_TAGS="FORBID_TAGS"in cfg?addToSet({},cfg.FORBID_TAGS):{},FORBID_ATTR="FORBID_ATTR"in cfg?addToSet({},cfg.FORBID_ATTR):{},USE_PROFILES="USE_PROFILES"in cfg&&cfg.USE_PROFILES,ALLOW_ARIA_ATTR=!1!==cfg.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR=!1!==cfg.ALLOW_DATA_ATTR,ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||!1,SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||!1,WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||!1,RETURN_DOM=cfg.RETURN_DOM||!1,RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||!1,RETURN_DOM_IMPORT=!1!==cfg.RETURN_DOM_IMPORT,RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||!1,FORCE_BODY=cfg.FORCE_BODY||!1,SANITIZE_DOM=!1!==cfg.SANITIZE_DOM,KEEP_CONTENT=!1!==cfg.KEEP_CONTENT,IN_PLACE=cfg.IN_PLACE||!1,IS_ALLOWED_URI$$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI$$1,NAMESPACE=cfg.NAMESPACE||HTML_NAMESPACE,SAFE_FOR_TEMPLATES&&(ALLOW_DATA_ATTR=!1),RETURN_DOM_FRAGMENT&&(RETURN_DOM=!0),USE_PROFILES&&(ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray$1(text))),ALLOWED_ATTR=[],!0===USE_PROFILES.html&&(addToSet(ALLOWED_TAGS,html),addToSet(ALLOWED_ATTR,html$1)),!0===USE_PROFILES.svg&&(addToSet(ALLOWED_TAGS,svg),addToSet(ALLOWED_ATTR,svg$1),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.svgFilters&&(addToSet(ALLOWED_TAGS,svgFilters),addToSet(ALLOWED_ATTR,svg$1),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.mathMl&&(addToSet(ALLOWED_TAGS,mathMl),addToSet(ALLOWED_ATTR,mathMl$1),addToSet(ALLOWED_ATTR,xml))),cfg.ADD_TAGS&&(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS&&(ALLOWED_TAGS=clone(ALLOWED_TAGS)),addToSet(ALLOWED_TAGS,cfg.ADD_TAGS)),cfg.ADD_ATTR&&(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR&&(ALLOWED_ATTR=clone(ALLOWED_ATTR)),addToSet(ALLOWED_ATTR,cfg.ADD_ATTR)),cfg.ADD_URI_SAFE_ATTR&&addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR),cfg.FORBID_CONTENTS&&(FORBID_CONTENTS===DEFAULT_FORBID_CONTENTS&&(FORBID_CONTENTS=clone(FORBID_CONTENTS)),addToSet(FORBID_CONTENTS,cfg.FORBID_CONTENTS)),KEEP_CONTENT&&(ALLOWED_TAGS["#text"]=!0),WHOLE_DOCUMENT&&addToSet(ALLOWED_TAGS,["html","head","body"]),ALLOWED_TAGS.table&&(addToSet(ALLOWED_TAGS,["tbody"]),delete FORBID_TAGS.tbody),freeze&&freeze(cfg),CONFIG=cfg)},MATHML_TEXT_INTEGRATION_POINTS=addToSet({},["mi","mo","mn","ms","mtext"]),HTML_INTEGRATION_POINTS=addToSet({},["foreignobject","desc","title","annotation-xml"]),ALL_SVG_TAGS=addToSet({},svg);addToSet(ALL_SVG_TAGS,svgFilters),addToSet(ALL_SVG_TAGS,svgDisallowed);var ALL_MATHML_TAGS=addToSet({},mathMl);addToSet(ALL_MATHML_TAGS,mathMlDisallowed);var _checkValidNamespace=function _checkValidNamespace(element){var parent=getParentNode(element);parent&&parent.tagName||(parent={namespaceURI:HTML_NAMESPACE,tagName:"template"});var tagName=stringToLowerCase(element.tagName),parentTagName=stringToLowerCase(parent.tagName);if(element.namespaceURI===SVG_NAMESPACE)return parent.namespaceURI===HTML_NAMESPACE?"svg"===tagName:parent.namespaceURI===MATHML_NAMESPACE?"svg"===tagName&&("annotation-xml"===parentTagName||MATHML_TEXT_INTEGRATION_POINTS[parentTagName]):Boolean(ALL_SVG_TAGS[tagName]);if(element.namespaceURI===MATHML_NAMESPACE)return parent.namespaceURI===HTML_NAMESPACE?"math"===tagName:parent.namespaceURI===SVG_NAMESPACE?"math"===tagName&&HTML_INTEGRATION_POINTS[parentTagName]:Boolean(ALL_MATHML_TAGS[tagName]);if(element.namespaceURI===HTML_NAMESPACE){if(parent.namespaceURI===SVG_NAMESPACE&&!HTML_INTEGRATION_POINTS[parentTagName])return!1;if(parent.namespaceURI===MATHML_NAMESPACE&&!MATHML_TEXT_INTEGRATION_POINTS[parentTagName])return!1;var commonSvgAndHTMLElements=addToSet({},["title","style","font","a","script"]);return!ALL_MATHML_TAGS[tagName]&&(commonSvgAndHTMLElements[tagName]||!ALL_SVG_TAGS[tagName])}return!1},_forceRemove=function _forceRemove(node){arrayPush(DOMPurify.removed,{element:node});try{node.parentNode.removeChild(node)}catch(_){try{node.outerHTML=emptyHTML}catch(_){node.remove()}}},_removeAttribute=function _removeAttribute(name,node){try{arrayPush(DOMPurify.removed,{attribute:node.getAttributeNode(name),from:node})}catch(_){arrayPush(DOMPurify.removed,{attribute:null,from:node})}if(node.removeAttribute(name),"is"===name&&!ALLOWED_ATTR[name])if(RETURN_DOM||RETURN_DOM_FRAGMENT)try{_forceRemove(node)}catch(_){}else try{node.setAttribute(name,"")}catch(_){}},_initDocument=function _initDocument(dirty){var doc=void 0,leadingWhitespace=void 0;if(FORCE_BODY)dirty="<remove></remove>"+dirty;else{var matches=stringMatch(dirty,/^[\r\n\t ]+/);leadingWhitespace=matches&&matches[0]}var dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(NAMESPACE===HTML_NAMESPACE)try{doc=(new DOMParser).parseFromString(dirtyPayload,"text/html")}catch(_){}if(!doc||!doc.documentElement){doc=implementation.createDocument(NAMESPACE,"template",null);try{doc.documentElement.innerHTML=IS_EMPTY_INPUT?"":dirtyPayload}catch(_){}}var body=doc.body||doc.documentElement;return dirty&&leadingWhitespace&&body.insertBefore(document.createTextNode(leadingWhitespace),body.childNodes[0]||null),NAMESPACE===HTML_NAMESPACE?getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]:WHOLE_DOCUMENT?doc.documentElement:body},_createIterator=function _createIterator(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,null,!1)},_isClobbered=function _isClobbered(elm){return!(elm instanceof Text||elm instanceof Comment)&&!("string"==typeof elm.nodeName&&"string"==typeof elm.textContent&&"function"==typeof elm.removeChild&&elm.attributes instanceof NamedNodeMap&&"function"==typeof elm.removeAttribute&&"function"==typeof elm.setAttribute&&"string"==typeof elm.namespaceURI&&"function"==typeof elm.insertBefore)},_isNode=function _isNode(object){return"object"===(void 0===Node?"undefined":_typeof(Node))?object instanceof Node:object&&"object"===(void 0===object?"undefined":_typeof(object))&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},_executeHook=function _executeHook(entryPoint,currentNode,data){hooks[entryPoint]&&arrayForEach(hooks[entryPoint],(function(hook){hook.call(DOMPurify,currentNode,data,CONFIG)}))},_sanitizeElements=function _sanitizeElements(currentNode){var content=void 0;if(_executeHook("beforeSanitizeElements",currentNode,null),_isClobbered(currentNode))return _forceRemove(currentNode),!0;if(stringMatch(currentNode.nodeName,/[\u0080-\uFFFF]/))return _forceRemove(currentNode),!0;var tagName=stringToLowerCase(currentNode.nodeName);if(_executeHook("uponSanitizeElement",currentNode,{tagName,allowedTags:ALLOWED_TAGS}),!_isNode(currentNode.firstElementChild)&&(!_isNode(currentNode.content)||!_isNode(currentNode.content.firstElementChild))&&regExpTest(/<[/\w]/g,currentNode.innerHTML)&&regExpTest(/<[/\w]/g,currentNode.textContent))return _forceRemove(currentNode),!0;if("select"===tagName&&regExpTest(/<template/i,currentNode.innerHTML))return _forceRemove(currentNode),!0;if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]){var parentNode=getParentNode(currentNode)||currentNode.parentNode,childNodes=getChildNodes(currentNode)||currentNode.childNodes;if(childNodes&&parentNode)for(var i=childNodes.length-1;i>=0;--i)parentNode.insertBefore(cloneNode(childNodes[i],!0),getNextSibling(currentNode))}return _forceRemove(currentNode),!0}return currentNode instanceof Element&&!_checkValidNamespace(currentNode)?(_forceRemove(currentNode),!0):"noscript"!==tagName&&"noembed"!==tagName||!regExpTest(/<\/no(script|embed)/i,currentNode.innerHTML)?(SAFE_FOR_TEMPLATES&&3===currentNode.nodeType&&(content=currentNode.textContent,content=stringReplace(content,MUSTACHE_EXPR$$1," "),content=stringReplace(content,ERB_EXPR$$1," "),currentNode.textContent!==content&&(arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()}),currentNode.textContent=content)),_executeHook("afterSanitizeElements",currentNode,null),!1):(_forceRemove(currentNode),!0)},_isValidAttribute=function _isValidAttribute(lcTag,lcName,value){if(SANITIZE_DOM&&("id"===lcName||"name"===lcName)&&(value in document||value in formElement))return!1;if(ALLOW_DATA_ATTR&&!FORBID_ATTR[lcName]&&regExpTest(DATA_ATTR$$1,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR$$1,lcName));else{if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName])return!1;if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$$1,stringReplace(value,ATTR_WHITESPACE$$1,"")));else if("src"!==lcName&&"xlink:href"!==lcName&&"href"!==lcName||"script"===lcTag||0!==stringIndexOf(value,"data:")||!DATA_URI_TAGS[lcTag]){if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA$$1,stringReplace(value,ATTR_WHITESPACE$$1,"")));else if(value)return!1}else;}return!0},_sanitizeAttributes=function _sanitizeAttributes(currentNode){var attr=void 0,value=void 0,lcName=void 0,l=void 0;_executeHook("beforeSanitizeAttributes",currentNode,null);var attributes=currentNode.attributes;if(attributes){var hookEvent={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ALLOWED_ATTR};for(l=attributes.length;l--;){var _attr=attr=attributes[l],name=_attr.name,namespaceURI=_attr.namespaceURI;if(value=stringTrim(attr.value),lcName=stringToLowerCase(name),hookEvent.attrName=lcName,hookEvent.attrValue=value,hookEvent.keepAttr=!0,hookEvent.forceKeepAttr=void 0,_executeHook("uponSanitizeAttribute",currentNode,hookEvent),value=hookEvent.attrValue,!hookEvent.forceKeepAttr&&(_removeAttribute(name,currentNode),hookEvent.keepAttr))if(regExpTest(/\/>/i,value))_removeAttribute(name,currentNode);else{SAFE_FOR_TEMPLATES&&(value=stringReplace(value,MUSTACHE_EXPR$$1," "),value=stringReplace(value,ERB_EXPR$$1," "));var lcTag=currentNode.nodeName.toLowerCase();if(_isValidAttribute(lcTag,lcName,value))try{namespaceURI?currentNode.setAttributeNS(namespaceURI,name,value):currentNode.setAttribute(name,value),arrayPop(DOMPurify.removed)}catch(_){}}}_executeHook("afterSanitizeAttributes",currentNode,null)}},_sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){var shadowNode=void 0,shadowIterator=_createIterator(fragment);for(_executeHook("beforeSanitizeShadowDOM",fragment,null);shadowNode=shadowIterator.nextNode();)_executeHook("uponSanitizeShadowNode",shadowNode,null),_sanitizeElements(shadowNode)||(shadowNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(shadowNode.content),_sanitizeAttributes(shadowNode));_executeHook("afterSanitizeShadowDOM",fragment,null)};return DOMPurify.sanitize=function(dirty,cfg){var body=void 0,importedNode=void 0,currentNode=void 0,oldNode=void 0,returnNode=void 0;if((IS_EMPTY_INPUT=!dirty)&&(dirty="\x3c!--\x3e"),"string"!=typeof dirty&&!_isNode(dirty)){if("function"!=typeof dirty.toString)throw typeErrorCreate("toString is not a function");if("string"!=typeof(dirty=dirty.toString()))throw typeErrorCreate("dirty is not a string, aborting")}if(!DOMPurify.isSupported){if("object"===_typeof(window.toStaticHTML)||"function"==typeof window.toStaticHTML){if("string"==typeof dirty)return window.toStaticHTML(dirty);if(_isNode(dirty))return window.toStaticHTML(dirty.outerHTML)}return dirty}if(SET_CONFIG||_parseConfig(cfg),DOMPurify.removed=[],"string"==typeof dirty&&(IN_PLACE=!1),IN_PLACE);else if(dirty instanceof Node)1===(importedNode=(body=_initDocument("\x3c!----\x3e")).ownerDocument.importNode(dirty,!0)).nodeType&&"BODY"===importedNode.nodeName||"HTML"===importedNode.nodeName?body=importedNode:body.appendChild(importedNode);else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&-1===dirty.indexOf("<"))return trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(dirty):dirty;if(!(body=_initDocument(dirty)))return RETURN_DOM?null:emptyHTML}body&&FORCE_BODY&&_forceRemove(body.firstChild);for(var nodeIterator=_createIterator(IN_PLACE?dirty:body);currentNode=nodeIterator.nextNode();)3===currentNode.nodeType&&currentNode===oldNode||_sanitizeElements(currentNode)||(currentNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(currentNode.content),_sanitizeAttributes(currentNode),oldNode=currentNode);if(oldNode=null,IN_PLACE)return dirty;if(RETURN_DOM){if(RETURN_DOM_FRAGMENT)for(returnNode=createDocumentFragment.call(body.ownerDocument);body.firstChild;)returnNode.appendChild(body.firstChild);else returnNode=body;return RETURN_DOM_IMPORT&&(returnNode=importNode.call(originalDocument,returnNode,!0)),returnNode}var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;return SAFE_FOR_TEMPLATES&&(serializedHTML=stringReplace(serializedHTML,MUSTACHE_EXPR$$1," "),serializedHTML=stringReplace(serializedHTML,ERB_EXPR$$1," ")),trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML},DOMPurify.setConfig=function(cfg){_parseConfig(cfg),SET_CONFIG=!0},DOMPurify.clearConfig=function(){CONFIG=null,SET_CONFIG=!1},DOMPurify.isValidAttribute=function(tag,attr,value){CONFIG||_parseConfig({});var lcTag=stringToLowerCase(tag),lcName=stringToLowerCase(attr);return _isValidAttribute(lcTag,lcName,value)},DOMPurify.addHook=function(entryPoint,hookFunction){"function"==typeof hookFunction&&(hooks[entryPoint]=hooks[entryPoint]||[],arrayPush(hooks[entryPoint],hookFunction))},DOMPurify.removeHook=function(entryPoint){hooks[entryPoint]&&arrayPop(hooks[entryPoint])},DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]&&(hooks[entryPoint]=[])},DOMPurify.removeAllHooks=function(){hooks={}},DOMPurify}();define("vs/base/browser/dompurify/dompurify",(function(){return purify})),define(__m[31],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFastDomNode=exports.FastDomNode=void 0;class FastDomNode{constructor(domNode){this.domNode=domNode,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._fontStyle="",this._fontFeatureSettings="",this._textDecoration="",this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(maxWidth){this._maxWidth!==maxWidth&&(this._maxWidth=maxWidth,this.domNode.style.maxWidth=this._maxWidth+"px")}setWidth(width){this._width!==width&&(this._width=width,this.domNode.style.width=this._width+"px")}setHeight(height){this._height!==height&&(this._height=height,this.domNode.style.height=this._height+"px")}setTop(top){this._top!==top&&(this._top=top,this.domNode.style.top=this._top+"px")}unsetTop(){-1!==this._top&&(this._top=-1,this.domNode.style.top="")}setLeft(left){this._left!==left&&(this._left=left,this.domNode.style.left=this._left+"px")}setBottom(bottom){this._bottom!==bottom&&(this._bottom=bottom,this.domNode.style.bottom=this._bottom+"px")}setRight(right){this._right!==right&&(this._right=right,this.domNode.style.right=this._right+"px")}setFontFamily(fontFamily){this._fontFamily!==fontFamily&&(this._fontFamily=fontFamily,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(fontWeight){this._fontWeight!==fontWeight&&(this._fontWeight=fontWeight,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(fontSize){this._fontSize!==fontSize&&(this._fontSize=fontSize,this.domNode.style.fontSize=this._fontSize+"px")}setFontStyle(fontStyle){this._fontStyle!==fontStyle&&(this._fontStyle=fontStyle,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(fontFeatureSettings){this._fontFeatureSettings!==fontFeatureSettings&&(this._fontFeatureSettings=fontFeatureSettings,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setTextDecoration(textDecoration){this._textDecoration!==textDecoration&&(this._textDecoration=textDecoration,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(lineHeight){this._lineHeight!==lineHeight&&(this._lineHeight=lineHeight,this.domNode.style.lineHeight=this._lineHeight+"px")}setLetterSpacing(letterSpacing){this._letterSpacing!==letterSpacing&&(this._letterSpacing=letterSpacing,this.domNode.style.letterSpacing=this._letterSpacing+"px")}setClassName(className){this._className!==className&&(this._className=className,this.domNode.className=this._className)}toggleClassName(className,shouldHaveIt){this.domNode.classList.toggle(className,shouldHaveIt),this._className=this.domNode.className}setDisplay(display){this._display!==display&&(this._display=display,this.domNode.style.display=this._display)}setPosition(position){this._position!==position&&(this._position=position,this.domNode.style.position=this._position)}setVisibility(visibility){this._visibility!==visibility&&(this._visibility=visibility,this.domNode.style.visibility=this._visibility)}setColor(color){this._color!==color&&(this._color=color,this.domNode.style.color=this._color)}setBackgroundColor(backgroundColor){this._backgroundColor!==backgroundColor&&(this._backgroundColor=backgroundColor,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(layerHint){this._layerHint!==layerHint&&(this._layerHint=layerHint,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(boxShadow){this._boxShadow!==boxShadow&&(this._boxShadow=boxShadow,this.domNode.style.boxShadow=boxShadow)}setContain(contain){this._contain!==contain&&(this._contain=contain,this.domNode.style.contain=this._contain)}setAttribute(name,value){this.domNode.setAttribute(name,value)}removeAttribute(name){this.domNode.removeAttribute(name)}appendChild(child){this.domNode.appendChild(child.domNode)}removeChild(child){this.domNode.removeChild(child.domNode)}}exports.FastDomNode=FastDomNode,exports.createFastDomNode=function createFastDomNode(domNode){return new FastDomNode(domNode)}})),define(__m[214],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IframeUtils=void 0;let hasDifferentOriginAncestorFlag=!1,sameOriginWindowChainCache=null;function getParentWindowIfSameOrigin(w){if(!w.parent||w.parent===w)return null;try{let location=w.location,parentLocation=w.parent.location;if("null"!==location.origin&&"null"!==parentLocation.origin&&location.origin!==parentLocation.origin)return hasDifferentOriginAncestorFlag=!0,null}catch(e){return hasDifferentOriginAncestorFlag=!0,null}return w.parent}exports.IframeUtils=class IframeUtils{static getSameOriginWindowChain(){if(!sameOriginWindowChainCache){sameOriginWindowChainCache=[];let parent,w=window;do{parent=getParentWindowIfSameOrigin(w),parent?sameOriginWindowChainCache.push({window:w,iframeElement:w.frameElement||null}):sameOriginWindowChainCache.push({window:w,iframeElement:null}),w=parent}while(w)}return sameOriginWindowChainCache.slice(0)}static hasDifferentOriginAncestor(){return sameOriginWindowChainCache||this.getSameOriginWindowChain(),hasDifferentOriginAncestorFlag}static getPositionOfChildWindowRelativeToAncestorWindow(childWindow,ancestorWindow){if(!ancestorWindow||childWindow===ancestorWindow)return{top:0,left:0};let top=0,left=0,windowChain=this.getSameOriginWindowChain();for(const windowChainEl of windowChain){if(top+=windowChainEl.window.scrollY,left+=windowChainEl.window.scrollX,windowChainEl.window===ancestorWindow)break;if(!windowChainEl.iframeElement)break;let boundingRect=windowChainEl.iframeElement.getBoundingClientRect();top+=boundingRect.top,left+=boundingRect.left}return{top,left}}}})),define(__m[310],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ListError=void 0;class ListError extends Error{constructor(user,message){super(`ListError [${user}] ${message}`)}}exports.ListError=ListError})),define(__m[311],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CombinedSpliceable=void 0;exports.CombinedSpliceable=class CombinedSpliceable{constructor(spliceables){this.spliceables=spliceables}splice(start,deleteCount,elements){this.spliceables.forEach((s=>s.splice(start,deleteCount,elements)))}}})),define(__m[215],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScrollbarState=void 0;class ScrollbarState{constructor(arrowSize,scrollbarSize,oppositeScrollbarSize,visibleSize,scrollSize,scrollPosition){this._scrollbarSize=Math.round(scrollbarSize),this._oppositeScrollbarSize=Math.round(oppositeScrollbarSize),this._arrowSize=Math.round(arrowSize),this._visibleSize=visibleSize,this._scrollSize=scrollSize,this._scrollPosition=scrollPosition,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new ScrollbarState(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(visibleSize){const iVisibleSize=Math.round(visibleSize);return this._visibleSize!==iVisibleSize&&(this._visibleSize=iVisibleSize,this._refreshComputedValues(),!0)}setScrollSize(scrollSize){const iScrollSize=Math.round(scrollSize);return this._scrollSize!==iScrollSize&&(this._scrollSize=iScrollSize,this._refreshComputedValues(),!0)}setScrollPosition(scrollPosition){const iScrollPosition=Math.round(scrollPosition);return this._scrollPosition!==iScrollPosition&&(this._scrollPosition=iScrollPosition,this._refreshComputedValues(),!0)}setScrollbarSize(scrollbarSize){this._scrollbarSize=Math.round(scrollbarSize)}setOppositeScrollbarSize(oppositeScrollbarSize){this._oppositeScrollbarSize=Math.round(oppositeScrollbarSize)}static _computeValues(oppositeScrollbarSize,arrowSize,visibleSize,scrollSize,scrollPosition){const computedAvailableSize=Math.max(0,visibleSize-oppositeScrollbarSize),computedRepresentableSize=Math.max(0,computedAvailableSize-2*arrowSize),computedIsNeeded=scrollSize>0&&scrollSize>visibleSize;if(!computedIsNeeded)return{computedAvailableSize:Math.round(computedAvailableSize),computedIsNeeded,computedSliderSize:Math.round(computedRepresentableSize),computedSliderRatio:0,computedSliderPosition:0};const computedSliderSize=Math.round(Math.max(20,Math.floor(visibleSize*computedRepresentableSize/scrollSize))),computedSliderRatio=(computedRepresentableSize-computedSliderSize)/(scrollSize-visibleSize),computedSliderPosition=scrollPosition*computedSliderRatio;return{computedAvailableSize:Math.round(computedAvailableSize),computedIsNeeded,computedSliderSize:Math.round(computedSliderSize),computedSliderRatio,computedSliderPosition:Math.round(computedSliderPosition)}}_refreshComputedValues(){const r=ScrollbarState._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=r.computedAvailableSize,this._computedIsNeeded=r.computedIsNeeded,this._computedSliderSize=r.computedSliderSize,this._computedSliderRatio=r.computedSliderRatio,this._computedSliderPosition=r.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(offset){if(!this._computedIsNeeded)return 0;const desiredSliderPosition=offset-this._arrowSize-this._computedSliderSize/2;return Math.round(desiredSliderPosition/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(offset){if(!this._computedIsNeeded)return 0;const correctedOffset=offset-this._arrowSize;let desiredScrollPosition=this._scrollPosition;return correctedOffset<this._computedSliderPosition?desiredScrollPosition-=this._visibleSize:desiredScrollPosition+=this._visibleSize,desiredScrollPosition}getDesiredScrollPositionFromDelta(delta){if(!this._computedIsNeeded)return 0;const desiredSliderPosition=this._computedSliderPosition+delta;return Math.round(desiredSliderPosition/this._computedSliderRatio)}}exports.ScrollbarState=ScrollbarState})),define(__m[111],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeakMapper=exports.TreeError=exports.TreeMouseEventTarget=void 0,function(TreeMouseEventTarget){TreeMouseEventTarget[TreeMouseEventTarget.Unknown=0]="Unknown",TreeMouseEventTarget[TreeMouseEventTarget.Twistie=1]="Twistie",TreeMouseEventTarget[TreeMouseEventTarget.Element=2]="Element"}(exports.TreeMouseEventTarget||(exports.TreeMouseEventTarget={}));class TreeError extends Error{constructor(user,message){super(`TreeError [${user}] ${message}`)}}exports.TreeError=TreeError;exports.WeakMapper=class WeakMapper{constructor(fn){this.fn=fn,this._map=new WeakMap}map(key){let result=this._map.get(key);return result||(result=this.fn(key),this._map.set(key,result)),result}}})),define(__m[18],__M([1,0]),(function(require,exports){"use strict";function lastIndex(array,fn){for(let i=array.length-1;i>=0;i--){if(fn(array[i]))return i}return-1}function insertInto(array,start,newItems){const startIdx=getActualStartIndex(array,start),originalLength=array.length,newItemsLength=newItems.length;array.length=originalLength+newItemsLength;for(let i=originalLength-1;i>=startIdx;i--)array[i+newItemsLength]=array[i];for(let i=0;i<newItemsLength;i++)array[i+startIdx]=newItems[i]}function getActualStartIndex(array,start){return start<0?Math.max(start+array.length,0):Math.min(start,array.length)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrayQueue=exports.findMinBy=exports.findLastMaxBy=exports.findMaxBy=exports.numberComparator=exports.compareBy=exports.splice=exports.insertInto=exports.asArray=exports.pushToEnd=exports.pushToStart=exports.arrayInsert=exports.range=exports.flatten=exports.firstOrDefault=exports.lastIndex=exports.findLast=exports.distinct=exports.isNonEmptyArray=exports.isFalsyOrEmpty=exports.coalesce=exports.groupBy=exports.quickSelect=exports.findFirstInSorted=exports.binarySearch=exports.equals=exports.tail2=exports.tail=void 0,exports.tail=function tail(array,n=0){return array[array.length-(1+n)]},exports.tail2=function tail2(arr){if(0===arr.length)throw new Error("Invalid tail call");return[arr.slice(0,arr.length-1),arr[arr.length-1]]},exports.equals=function equals(one,other,itemEquals=((a,b)=>a===b)){if(one===other)return!0;if(!one||!other)return!1;if(one.length!==other.length)return!1;for(let i=0,len=one.length;i<len;i++)if(!itemEquals(one[i],other[i]))return!1;return!0},exports.binarySearch=function binarySearch(array,key,comparator){let low=0,high=array.length-1;for(;low<=high;){const mid=(low+high)/2|0,comp=comparator(array[mid],key);if(comp<0)low=mid+1;else{if(!(comp>0))return mid;high=mid-1}}return-(low+1)},exports.findFirstInSorted=function findFirstInSorted(array,p){let low=0,high=array.length;if(0===high)return 0;for(;low<high;){const mid=Math.floor((low+high)/2);p(array[mid])?high=mid:low=mid+1}return low},exports.quickSelect=function quickSelect(nth,data,compare){if((nth|=0)>=data.length)throw new TypeError("invalid index");let pivotValue=data[Math.floor(data.length*Math.random())],lower=[],higher=[],pivots=[];for(let value of data){const val=compare(value,pivotValue);val<0?lower.push(value):val>0?higher.push(value):pivots.push(value)}return nth<lower.length?quickSelect(nth,lower,compare):nth<lower.length+pivots.length?pivots[0]:quickSelect(nth-(lower.length+pivots.length),higher,compare)},exports.groupBy=function groupBy(data,compare){const result=[];let currentGroup;for(const element of data.slice(0).sort(compare))currentGroup&&0===compare(currentGroup[0],element)?currentGroup.push(element):(currentGroup=[element],result.push(currentGroup));return result},exports.coalesce=function coalesce(array){return array.filter((e=>!!e))},exports.isFalsyOrEmpty=function isFalsyOrEmpty(obj){return!Array.isArray(obj)||0===obj.length},exports.isNonEmptyArray=function isNonEmptyArray(obj){return Array.isArray(obj)&&obj.length>0},exports.distinct=function distinct(array,keyFn=(value=>value)){const seen=new Set;return array.filter((element=>{const key=keyFn(element);return!seen.has(key)&&(seen.add(key),!0)}))},exports.findLast=function findLast(arr,predicate){const idx=lastIndex(arr,predicate);if(-1!==idx)return arr[idx]},exports.lastIndex=lastIndex,exports.firstOrDefault=function firstOrDefault(array,notFoundValue){return array.length>0?array[0]:notFoundValue},exports.flatten=function flatten(arr){return[].concat(...arr)},exports.range=function range(arg,to){let from="number"==typeof to?arg:0;"number"==typeof to?from=arg:(from=0,to=arg);const result=[];if(from<=to)for(let i=from;i<to;i++)result.push(i);else for(let i=from;i>to;i--)result.push(i);return result},exports.arrayInsert=function arrayInsert(target,insertIndex,insertArr){const before=target.slice(0,insertIndex),after=target.slice(insertIndex);return before.concat(insertArr,after)},exports.pushToStart=function pushToStart(arr,value){const index=arr.indexOf(value);index>-1&&(arr.splice(index,1),arr.unshift(value))},exports.pushToEnd=function pushToEnd(arr,value){const index=arr.indexOf(value);index>-1&&(arr.splice(index,1),arr.push(value))},exports.asArray=function asArray(x){return Array.isArray(x)?x:[x]},exports.insertInto=insertInto,exports.splice=function splice(array,start,deleteCount,newItems){const index=getActualStartIndex(array,start),result=array.splice(index,deleteCount);return insertInto(array,index,newItems),result},exports.compareBy=function compareBy(selector,comparator){return(a,b)=>comparator(selector(a),selector(b))};function findMaxBy(items,comparator){if(0===items.length)return;let max=items[0];for(let i=1;i<items.length;i++){const item=items[i];comparator(item,max)>0&&(max=item)}return max}exports.numberComparator=(a,b)=>a-b,exports.findMaxBy=findMaxBy,exports.findLastMaxBy=function findLastMaxBy(items,comparator){if(0===items.length)return;let max=items[0];for(let i=1;i<items.length;i++){const item=items[i];comparator(item,max)>=0&&(max=item)}return max},exports.findMinBy=function findMinBy(items,comparator){return findMaxBy(items,((a,b)=>-comparator(a,b)))};exports.ArrayQueue=class ArrayQueue{constructor(items){this.items=items,this.firstIdx=0,this.lastIdx=this.items.length-1}takeWhile(predicate){let startIdx=this.firstIdx;for(;startIdx<this.items.length&&predicate(this.items[startIdx]);)startIdx++;const result=startIdx===this.firstIdx?null:this.items.slice(this.firstIdx,startIdx);return this.firstIdx=startIdx,result}takeFromEndWhile(predicate){let endIdx=this.lastIdx;for(;endIdx>=0&&predicate(this.items[endIdx]);)endIdx--;const result=endIdx===this.lastIdx?null:this.items.slice(endIdx+1,this.lastIdx+1);return this.lastIdx=endIdx,result}peek(){return this.items[this.firstIdx]}dequeue(){const result=this.items[this.firstIdx];return this.firstIdx++,result}takeCount(count){const result=this.items.slice(this.firstIdx,this.firstIdx+count);return this.firstIdx+=count,result}}})),define(__m[216],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ok=void 0,exports.ok=function ok(value,message){if(!value)throw new Error(message?`Assertion failed (${message})`:"Assertion Failed")}})),define(__m[112],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.writeUInt8=exports.readUInt8=exports.writeUInt32BE=exports.readUInt32BE=exports.writeUInt16LE=exports.readUInt16LE=exports.VSBuffer=void 0;const hasBuffer="undefined"!=typeof Buffer;let textDecoder;class VSBuffer{constructor(buffer){this.buffer=buffer,this.byteLength=this.buffer.byteLength}static wrap(actual){return hasBuffer&&!Buffer.isBuffer(actual)&&(actual=Buffer.from(actual.buffer,actual.byteOffset,actual.byteLength)),new VSBuffer(actual)}toString(){return hasBuffer?this.buffer.toString():(textDecoder||(textDecoder=new TextDecoder),textDecoder.decode(this.buffer))}}exports.VSBuffer=VSBuffer,exports.readUInt16LE=function readUInt16LE(source,offset){return source[offset+0]<<0>>>0|source[offset+1]<<8>>>0},exports.writeUInt16LE=function writeUInt16LE(destination,value,offset){destination[offset+0]=255&value,value>>>=8,destination[offset+1]=255&value},exports.readUInt32BE=function readUInt32BE(source,offset){return source[offset]*Math.pow(2,24)+source[offset+1]*Math.pow(2,16)+source[offset+2]*Math.pow(2,8)+source[offset+3]},exports.writeUInt32BE=function writeUInt32BE(destination,value,offset){destination[offset+3]=value,value>>>=8,destination[offset+2]=value,value>>>=8,destination[offset+1]=value,value>>>=8,destination[offset]=value},exports.readUInt8=function readUInt8(source,offset){return source[offset]},exports.writeUInt8=function writeUInt8(destination,value,offset){destination[offset]=value}})),define(__m[312],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LRUCachedComputed=void 0;exports.LRUCachedComputed=class LRUCachedComputed{constructor(computeFn){this.computeFn=computeFn,this.lastCache=void 0,this.lastArgKey=void 0}get(arg){const key=JSON.stringify(arg);return this.lastArgKey!==key&&(this.lastArgKey=key,this.lastCache=this.computeFn(arg)),this.lastCache}}})),define(__m[28],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CSSIcon=exports.Codicon=exports.getCodiconAriaLabel=void 0,exports.getCodiconAriaLabel=function getCodiconAriaLabel(text){return text?text.replace(/\$\((.*?)\)/g,((_match,codiconName)=>` ${codiconName} `)).trim():""};class Codicon{constructor(id,definition,description){this.id=id,this.definition=definition,this.description=description,Codicon._allCodicons.push(this)}get classNames(){return"codicon codicon-"+this.id}get classNamesArray(){return["codicon","codicon-"+this.id]}get cssSelector(){return".codicon.codicon-"+this.id}static getAll(){return Codicon._allCodicons}}exports.Codicon=Codicon,Codicon._allCodicons=[],Codicon.add=new Codicon("add",{fontCharacter:"\\ea60"}),Codicon.plus=new Codicon("plus",Codicon.add.definition),Codicon.gistNew=new Codicon("gist-new",Codicon.add.definition),Codicon.repoCreate=new Codicon("repo-create",Codicon.add.definition),Codicon.lightbulb=new Codicon("lightbulb",{fontCharacter:"\\ea61"}),Codicon.lightBulb=new Codicon("light-bulb",{fontCharacter:"\\ea61"}),Codicon.repo=new Codicon("repo",{fontCharacter:"\\ea62"}),Codicon.repoDelete=new Codicon("repo-delete",{fontCharacter:"\\ea62"}),Codicon.gistFork=new Codicon("gist-fork",{fontCharacter:"\\ea63"}),Codicon.repoForked=new Codicon("repo-forked",{fontCharacter:"\\ea63"}),Codicon.gitPullRequest=new Codicon("git-pull-request",{fontCharacter:"\\ea64"}),Codicon.gitPullRequestAbandoned=new Codicon("git-pull-request-abandoned",{fontCharacter:"\\ea64"}),Codicon.recordKeys=new Codicon("record-keys",{fontCharacter:"\\ea65"}),Codicon.keyboard=new Codicon("keyboard",{fontCharacter:"\\ea65"}),Codicon.tag=new Codicon("tag",{fontCharacter:"\\ea66"}),Codicon.tagAdd=new Codicon("tag-add",{fontCharacter:"\\ea66"}),Codicon.tagRemove=new Codicon("tag-remove",{fontCharacter:"\\ea66"}),Codicon.person=new Codicon("person",{fontCharacter:"\\ea67"}),Codicon.personFollow=new Codicon("person-follow",{fontCharacter:"\\ea67"}),Codicon.personOutline=new Codicon("person-outline",{fontCharacter:"\\ea67"}),Codicon.personFilled=new Codicon("person-filled",{fontCharacter:"\\ea67"}),Codicon.gitBranch=new Codicon("git-branch",{fontCharacter:"\\ea68"}),Codicon.gitBranchCreate=new Codicon("git-branch-create",{fontCharacter:"\\ea68"}),Codicon.gitBranchDelete=new Codicon("git-branch-delete",{fontCharacter:"\\ea68"}),Codicon.sourceControl=new Codicon("source-control",{fontCharacter:"\\ea68"}),Codicon.mirror=new Codicon("mirror",{fontCharacter:"\\ea69"}),Codicon.mirrorPublic=new Codicon("mirror-public",{fontCharacter:"\\ea69"}),Codicon.star=new Codicon("star",{fontCharacter:"\\ea6a"}),Codicon.starAdd=new Codicon("star-add",{fontCharacter:"\\ea6a"}),Codicon.starDelete=new Codicon("star-delete",{fontCharacter:"\\ea6a"}),Codicon.starEmpty=new Codicon("star-empty",{fontCharacter:"\\ea6a"}),Codicon.comment=new Codicon("comment",{fontCharacter:"\\ea6b"}),Codicon.commentAdd=new Codicon("comment-add",{fontCharacter:"\\ea6b"}),Codicon.alert=new Codicon("alert",{fontCharacter:"\\ea6c"}),Codicon.warning=new Codicon("warning",{fontCharacter:"\\ea6c"}),Codicon.search=new Codicon("search",{fontCharacter:"\\ea6d"}),Codicon.searchSave=new Codicon("search-save",{fontCharacter:"\\ea6d"}),Codicon.logOut=new Codicon("log-out",{fontCharacter:"\\ea6e"}),Codicon.signOut=new Codicon("sign-out",{fontCharacter:"\\ea6e"}),Codicon.logIn=new Codicon("log-in",{fontCharacter:"\\ea6f"}),Codicon.signIn=new Codicon("sign-in",{fontCharacter:"\\ea6f"}),Codicon.eye=new Codicon("eye",{fontCharacter:"\\ea70"}),Codicon.eyeUnwatch=new Codicon("eye-unwatch",{fontCharacter:"\\ea70"}),Codicon.eyeWatch=new Codicon("eye-watch",{fontCharacter:"\\ea70"}),Codicon.circleFilled=new Codicon("circle-filled",{fontCharacter:"\\ea71"}),Codicon.primitiveDot=new Codicon("primitive-dot",{fontCharacter:"\\ea71"}),Codicon.closeDirty=new Codicon("close-dirty",{fontCharacter:"\\ea71"}),Codicon.debugBreakpoint=new Codicon("debug-breakpoint",{fontCharacter:"\\ea71"}),Codicon.debugBreakpointDisabled=new Codicon("debug-breakpoint-disabled",{fontCharacter:"\\ea71"}),Codicon.debugHint=new Codicon("debug-hint",{fontCharacter:"\\ea71"}),Codicon.primitiveSquare=new Codicon("primitive-square",{fontCharacter:"\\ea72"}),Codicon.edit=new Codicon("edit",{fontCharacter:"\\ea73"}),Codicon.pencil=new Codicon("pencil",{fontCharacter:"\\ea73"}),Codicon.info=new Codicon("info",{fontCharacter:"\\ea74"}),Codicon.issueOpened=new Codicon("issue-opened",{fontCharacter:"\\ea74"}),Codicon.gistPrivate=new Codicon("gist-private",{fontCharacter:"\\ea75"}),Codicon.gitForkPrivate=new Codicon("git-fork-private",{fontCharacter:"\\ea75"}),Codicon.lock=new Codicon("lock",{fontCharacter:"\\ea75"}),Codicon.mirrorPrivate=new Codicon("mirror-private",{fontCharacter:"\\ea75"}),Codicon.close=new Codicon("close",{fontCharacter:"\\ea76"}),Codicon.removeClose=new Codicon("remove-close",{fontCharacter:"\\ea76"}),Codicon.x=new Codicon("x",{fontCharacter:"\\ea76"}),Codicon.repoSync=new Codicon("repo-sync",{fontCharacter:"\\ea77"}),Codicon.sync=new Codicon("sync",{fontCharacter:"\\ea77"}),Codicon.clone=new Codicon("clone",{fontCharacter:"\\ea78"}),Codicon.desktopDownload=new Codicon("desktop-download",{fontCharacter:"\\ea78"}),Codicon.beaker=new Codicon("beaker",{fontCharacter:"\\ea79"}),Codicon.microscope=new Codicon("microscope",{fontCharacter:"\\ea79"}),Codicon.vm=new Codicon("vm",{fontCharacter:"\\ea7a"}),Codicon.deviceDesktop=new Codicon("device-desktop",{fontCharacter:"\\ea7a"}),Codicon.file=new Codicon("file",{fontCharacter:"\\ea7b"}),Codicon.fileText=new Codicon("file-text",{fontCharacter:"\\ea7b"}),Codicon.more=new Codicon("more",{fontCharacter:"\\ea7c"}),Codicon.ellipsis=new Codicon("ellipsis",{fontCharacter:"\\ea7c"}),Codicon.kebabHorizontal=new Codicon("kebab-horizontal",{fontCharacter:"\\ea7c"}),Codicon.mailReply=new Codicon("mail-reply",{fontCharacter:"\\ea7d"}),Codicon.reply=new Codicon("reply",{fontCharacter:"\\ea7d"}),Codicon.organization=new Codicon("organization",{fontCharacter:"\\ea7e"}),Codicon.organizationFilled=new Codicon("organization-filled",{fontCharacter:"\\ea7e"}),Codicon.organizationOutline=new Codicon("organization-outline",{fontCharacter:"\\ea7e"}),Codicon.newFile=new Codicon("new-file",{fontCharacter:"\\ea7f"}),Codicon.fileAdd=new Codicon("file-add",{fontCharacter:"\\ea7f"}),Codicon.newFolder=new Codicon("new-folder",{fontCharacter:"\\ea80"}),Codicon.fileDirectoryCreate=new Codicon("file-directory-create",{fontCharacter:"\\ea80"}),Codicon.trash=new Codicon("trash",{fontCharacter:"\\ea81"}),Codicon.trashcan=new Codicon("trashcan",{fontCharacter:"\\ea81"}),Codicon.history=new Codicon("history",{fontCharacter:"\\ea82"}),Codicon.clock=new Codicon("clock",{fontCharacter:"\\ea82"}),Codicon.folder=new Codicon("folder",{fontCharacter:"\\ea83"}),Codicon.fileDirectory=new Codicon("file-directory",{fontCharacter:"\\ea83"}),Codicon.symbolFolder=new Codicon("symbol-folder",{fontCharacter:"\\ea83"}),Codicon.logoGithub=new Codicon("logo-github",{fontCharacter:"\\ea84"}),Codicon.markGithub=new Codicon("mark-github",{fontCharacter:"\\ea84"}),Codicon.github=new Codicon("github",{fontCharacter:"\\ea84"}),Codicon.terminal=new Codicon("terminal",{fontCharacter:"\\ea85"}),Codicon.console=new Codicon("console",{fontCharacter:"\\ea85"}),Codicon.repl=new Codicon("repl",{fontCharacter:"\\ea85"}),Codicon.zap=new Codicon("zap",{fontCharacter:"\\ea86"}),Codicon.symbolEvent=new Codicon("symbol-event",{fontCharacter:"\\ea86"}),Codicon.error=new Codicon("error",{fontCharacter:"\\ea87"}),Codicon.stop=new Codicon("stop",{fontCharacter:"\\ea87"}),Codicon.variable=new Codicon("variable",{fontCharacter:"\\ea88"}),Codicon.symbolVariable=new Codicon("symbol-variable",{fontCharacter:"\\ea88"}),Codicon.array=new Codicon("array",{fontCharacter:"\\ea8a"}),Codicon.symbolArray=new Codicon("symbol-array",{fontCharacter:"\\ea8a"}),Codicon.symbolModule=new Codicon("symbol-module",{fontCharacter:"\\ea8b"}),Codicon.symbolPackage=new Codicon("symbol-package",{fontCharacter:"\\ea8b"}),Codicon.symbolNamespace=new Codicon("symbol-namespace",{fontCharacter:"\\ea8b"}),Codicon.symbolObject=new Codicon("symbol-object",{fontCharacter:"\\ea8b"}),Codicon.symbolMethod=new Codicon("symbol-method",{fontCharacter:"\\ea8c"}),Codicon.symbolFunction=new Codicon("symbol-function",{fontCharacter:"\\ea8c"}),Codicon.symbolConstructor=new Codicon("symbol-constructor",{fontCharacter:"\\ea8c"}),Codicon.symbolBoolean=new Codicon("symbol-boolean",{fontCharacter:"\\ea8f"}),Codicon.symbolNull=new Codicon("symbol-null",{fontCharacter:"\\ea8f"}),Codicon.symbolNumeric=new Codicon("symbol-numeric",{fontCharacter:"\\ea90"}),Codicon.symbolNumber=new Codicon("symbol-number",{fontCharacter:"\\ea90"}),Codicon.symbolStructure=new Codicon("symbol-structure",{fontCharacter:"\\ea91"}),Codicon.symbolStruct=new Codicon("symbol-struct",{fontCharacter:"\\ea91"}),Codicon.symbolParameter=new Codicon("symbol-parameter",{fontCharacter:"\\ea92"}),Codicon.symbolTypeParameter=new Codicon("symbol-type-parameter",{fontCharacter:"\\ea92"}),Codicon.symbolKey=new Codicon("symbol-key",{fontCharacter:"\\ea93"}),Codicon.symbolText=new Codicon("symbol-text",{fontCharacter:"\\ea93"}),Codicon.symbolReference=new Codicon("symbol-reference",{fontCharacter:"\\ea94"}),Codicon.goToFile=new Codicon("go-to-file",{fontCharacter:"\\ea94"}),Codicon.symbolEnum=new Codicon("symbol-enum",{fontCharacter:"\\ea95"}),Codicon.symbolValue=new Codicon("symbol-value",{fontCharacter:"\\ea95"}),Codicon.symbolRuler=new Codicon("symbol-ruler",{fontCharacter:"\\ea96"}),Codicon.symbolUnit=new Codicon("symbol-unit",{fontCharacter:"\\ea96"}),Codicon.activateBreakpoints=new Codicon("activate-breakpoints",{fontCharacter:"\\ea97"}),Codicon.archive=new Codicon("archive",{fontCharacter:"\\ea98"}),Codicon.arrowBoth=new Codicon("arrow-both",{fontCharacter:"\\ea99"}),Codicon.arrowDown=new Codicon("arrow-down",{fontCharacter:"\\ea9a"}),Codicon.arrowLeft=new Codicon("arrow-left",{fontCharacter:"\\ea9b"}),Codicon.arrowRight=new Codicon("arrow-right",{fontCharacter:"\\ea9c"}),Codicon.arrowSmallDown=new Codicon("arrow-small-down",{fontCharacter:"\\ea9d"}),Codicon.arrowSmallLeft=new Codicon("arrow-small-left",{fontCharacter:"\\ea9e"}),Codicon.arrowSmallRight=new Codicon("arrow-small-right",{fontCharacter:"\\ea9f"}),Codicon.arrowSmallUp=new Codicon("arrow-small-up",{fontCharacter:"\\eaa0"}),Codicon.arrowUp=new Codicon("arrow-up",{fontCharacter:"\\eaa1"}),Codicon.bell=new Codicon("bell",{fontCharacter:"\\eaa2"}),Codicon.bold=new Codicon("bold",{fontCharacter:"\\eaa3"}),Codicon.book=new Codicon("book",{fontCharacter:"\\eaa4"}),Codicon.bookmark=new Codicon("bookmark",{fontCharacter:"\\eaa5"}),Codicon.debugBreakpointConditionalUnverified=new Codicon("debug-breakpoint-conditional-unverified",{fontCharacter:"\\eaa6"}),Codicon.debugBreakpointConditional=new Codicon("debug-breakpoint-conditional",{fontCharacter:"\\eaa7"}),Codicon.debugBreakpointConditionalDisabled=new Codicon("debug-breakpoint-conditional-disabled",{fontCharacter:"\\eaa7"}),Codicon.debugBreakpointDataUnverified=new Codicon("debug-breakpoint-data-unverified",{fontCharacter:"\\eaa8"}),Codicon.debugBreakpointData=new Codicon("debug-breakpoint-data",{fontCharacter:"\\eaa9"}),Codicon.debugBreakpointDataDisabled=new Codicon("debug-breakpoint-data-disabled",{fontCharacter:"\\eaa9"}),Codicon.debugBreakpointLogUnverified=new Codicon("debug-breakpoint-log-unverified",{fontCharacter:"\\eaaa"}),Codicon.debugBreakpointLog=new Codicon("debug-breakpoint-log",{fontCharacter:"\\eaab"}),Codicon.debugBreakpointLogDisabled=new Codicon("debug-breakpoint-log-disabled",{fontCharacter:"\\eaab"}),Codicon.briefcase=new Codicon("briefcase",{fontCharacter:"\\eaac"}),Codicon.broadcast=new Codicon("broadcast",{fontCharacter:"\\eaad"}),Codicon.browser=new Codicon("browser",{fontCharacter:"\\eaae"}),Codicon.bug=new Codicon("bug",{fontCharacter:"\\eaaf"}),Codicon.calendar=new Codicon("calendar",{fontCharacter:"\\eab0"}),Codicon.caseSensitive=new Codicon("case-sensitive",{fontCharacter:"\\eab1"}),Codicon.check=new Codicon("check",{fontCharacter:"\\eab2"}),Codicon.checklist=new Codicon("checklist",{fontCharacter:"\\eab3"}),Codicon.chevronDown=new Codicon("chevron-down",{fontCharacter:"\\eab4"}),Codicon.dropDownButton=new Codicon("drop-down-button",Codicon.chevronDown.definition),Codicon.chevronLeft=new Codicon("chevron-left",{fontCharacter:"\\eab5"}),Codicon.chevronRight=new Codicon("chevron-right",{fontCharacter:"\\eab6"}),Codicon.chevronUp=new Codicon("chevron-up",{fontCharacter:"\\eab7"}),Codicon.chromeClose=new Codicon("chrome-close",{fontCharacter:"\\eab8"}),Codicon.chromeMaximize=new Codicon("chrome-maximize",{fontCharacter:"\\eab9"}),Codicon.chromeMinimize=new Codicon("chrome-minimize",{fontCharacter:"\\eaba"}),Codicon.chromeRestore=new Codicon("chrome-restore",{fontCharacter:"\\eabb"}),Codicon.circleOutline=new Codicon("circle-outline",{fontCharacter:"\\eabc"}),Codicon.debugBreakpointUnverified=new Codicon("debug-breakpoint-unverified",{fontCharacter:"\\eabc"}),Codicon.circleSlash=new Codicon("circle-slash",{fontCharacter:"\\eabd"}),Codicon.circuitBoard=new Codicon("circuit-board",{fontCharacter:"\\eabe"}),Codicon.clearAll=new Codicon("clear-all",{fontCharacter:"\\eabf"}),Codicon.clippy=new Codicon("clippy",{fontCharacter:"\\eac0"}),Codicon.closeAll=new Codicon("close-all",{fontCharacter:"\\eac1"}),Codicon.cloudDownload=new Codicon("cloud-download",{fontCharacter:"\\eac2"}),Codicon.cloudUpload=new Codicon("cloud-upload",{fontCharacter:"\\eac3"}),Codicon.code=new Codicon("code",{fontCharacter:"\\eac4"}),Codicon.collapseAll=new Codicon("collapse-all",{fontCharacter:"\\eac5"}),Codicon.colorMode=new Codicon("color-mode",{fontCharacter:"\\eac6"}),Codicon.commentDiscussion=new Codicon("comment-discussion",{fontCharacter:"\\eac7"}),Codicon.compareChanges=new Codicon("compare-changes",{fontCharacter:"\\eafd"}),Codicon.creditCard=new Codicon("credit-card",{fontCharacter:"\\eac9"}),Codicon.dash=new Codicon("dash",{fontCharacter:"\\eacc"}),Codicon.dashboard=new Codicon("dashboard",{fontCharacter:"\\eacd"}),Codicon.database=new Codicon("database",{fontCharacter:"\\eace"}),Codicon.debugContinue=new Codicon("debug-continue",{fontCharacter:"\\eacf"}),Codicon.debugDisconnect=new Codicon("debug-disconnect",{fontCharacter:"\\ead0"}),Codicon.debugPause=new Codicon("debug-pause",{fontCharacter:"\\ead1"}),Codicon.debugRestart=new Codicon("debug-restart",{fontCharacter:"\\ead2"}),Codicon.debugStart=new Codicon("debug-start",{fontCharacter:"\\ead3"}),Codicon.debugStepInto=new Codicon("debug-step-into",{fontCharacter:"\\ead4"}),Codicon.debugStepOut=new Codicon("debug-step-out",{fontCharacter:"\\ead5"}),Codicon.debugStepOver=new Codicon("debug-step-over",{fontCharacter:"\\ead6"}),Codicon.debugStop=new Codicon("debug-stop",{fontCharacter:"\\ead7"}),Codicon.debug=new Codicon("debug",{fontCharacter:"\\ead8"}),Codicon.deviceCameraVideo=new Codicon("device-camera-video",{fontCharacter:"\\ead9"}),Codicon.deviceCamera=new Codicon("device-camera",{fontCharacter:"\\eada"}),Codicon.deviceMobile=new Codicon("device-mobile",{fontCharacter:"\\eadb"}),Codicon.diffAdded=new Codicon("diff-added",{fontCharacter:"\\eadc"}),Codicon.diffIgnored=new Codicon("diff-ignored",{fontCharacter:"\\eadd"}),Codicon.diffModified=new Codicon("diff-modified",{fontCharacter:"\\eade"}),Codicon.diffRemoved=new Codicon("diff-removed",{fontCharacter:"\\eadf"}),Codicon.diffRenamed=new Codicon("diff-renamed",{fontCharacter:"\\eae0"}),Codicon.diff=new Codicon("diff",{fontCharacter:"\\eae1"}),Codicon.discard=new Codicon("discard",{fontCharacter:"\\eae2"}),Codicon.editorLayout=new Codicon("editor-layout",{fontCharacter:"\\eae3"}),Codicon.emptyWindow=new Codicon("empty-window",{fontCharacter:"\\eae4"}),Codicon.exclude=new Codicon("exclude",{fontCharacter:"\\eae5"}),Codicon.extensions=new Codicon("extensions",{fontCharacter:"\\eae6"}),Codicon.eyeClosed=new Codicon("eye-closed",{fontCharacter:"\\eae7"}),Codicon.fileBinary=new Codicon("file-binary",{fontCharacter:"\\eae8"}),Codicon.fileCode=new Codicon("file-code",{fontCharacter:"\\eae9"}),Codicon.fileMedia=new Codicon("file-media",{fontCharacter:"\\eaea"}),Codicon.filePdf=new Codicon("file-pdf",{fontCharacter:"\\eaeb"}),Codicon.fileSubmodule=new Codicon("file-submodule",{fontCharacter:"\\eaec"}),Codicon.fileSymlinkDirectory=new Codicon("file-symlink-directory",{fontCharacter:"\\eaed"}),Codicon.fileSymlinkFile=new Codicon("file-symlink-file",{fontCharacter:"\\eaee"}),Codicon.fileZip=new Codicon("file-zip",{fontCharacter:"\\eaef"}),Codicon.files=new Codicon("files",{fontCharacter:"\\eaf0"}),Codicon.filter=new Codicon("filter",{fontCharacter:"\\eaf1"}),Codicon.flame=new Codicon("flame",{fontCharacter:"\\eaf2"}),Codicon.foldDown=new Codicon("fold-down",{fontCharacter:"\\eaf3"}),Codicon.foldUp=new Codicon("fold-up",{fontCharacter:"\\eaf4"}),Codicon.fold=new Codicon("fold",{fontCharacter:"\\eaf5"}),Codicon.folderActive=new Codicon("folder-active",{fontCharacter:"\\eaf6"}),Codicon.folderOpened=new Codicon("folder-opened",{fontCharacter:"\\eaf7"}),Codicon.gear=new Codicon("gear",{fontCharacter:"\\eaf8"}),Codicon.gift=new Codicon("gift",{fontCharacter:"\\eaf9"}),Codicon.gistSecret=new Codicon("gist-secret",{fontCharacter:"\\eafa"}),Codicon.gist=new Codicon("gist",{fontCharacter:"\\eafb"}),Codicon.gitCommit=new Codicon("git-commit",{fontCharacter:"\\eafc"}),Codicon.gitCompare=new Codicon("git-compare",{fontCharacter:"\\eafd"}),Codicon.gitMerge=new Codicon("git-merge",{fontCharacter:"\\eafe"}),Codicon.githubAction=new Codicon("github-action",{fontCharacter:"\\eaff"}),Codicon.githubAlt=new Codicon("github-alt",{fontCharacter:"\\eb00"}),Codicon.globe=new Codicon("globe",{fontCharacter:"\\eb01"}),Codicon.grabber=new Codicon("grabber",{fontCharacter:"\\eb02"}),Codicon.graph=new Codicon("graph",{fontCharacter:"\\eb03"}),Codicon.gripper=new Codicon("gripper",{fontCharacter:"\\eb04"}),Codicon.heart=new Codicon("heart",{fontCharacter:"\\eb05"}),Codicon.home=new Codicon("home",{fontCharacter:"\\eb06"}),Codicon.horizontalRule=new Codicon("horizontal-rule",{fontCharacter:"\\eb07"}),Codicon.hubot=new Codicon("hubot",{fontCharacter:"\\eb08"}),Codicon.inbox=new Codicon("inbox",{fontCharacter:"\\eb09"}),Codicon.issueClosed=new Codicon("issue-closed",{fontCharacter:"\\eba4"}),Codicon.issueReopened=new Codicon("issue-reopened",{fontCharacter:"\\eb0b"}),Codicon.issues=new Codicon("issues",{fontCharacter:"\\eb0c"}),Codicon.italic=new Codicon("italic",{fontCharacter:"\\eb0d"}),Codicon.jersey=new Codicon("jersey",{fontCharacter:"\\eb0e"}),Codicon.json=new Codicon("json",{fontCharacter:"\\eb0f"}),Codicon.kebabVertical=new Codicon("kebab-vertical",{fontCharacter:"\\eb10"}),Codicon.key=new Codicon("key",{fontCharacter:"\\eb11"}),Codicon.law=new Codicon("law",{fontCharacter:"\\eb12"}),Codicon.lightbulbAutofix=new Codicon("lightbulb-autofix",{fontCharacter:"\\eb13"}),Codicon.linkExternal=new Codicon("link-external",{fontCharacter:"\\eb14"}),Codicon.link=new Codicon("link",{fontCharacter:"\\eb15"}),Codicon.listOrdered=new Codicon("list-ordered",{fontCharacter:"\\eb16"}),Codicon.listUnordered=new Codicon("list-unordered",{fontCharacter:"\\eb17"}),Codicon.liveShare=new Codicon("live-share",{fontCharacter:"\\eb18"}),Codicon.loading=new Codicon("loading",{fontCharacter:"\\eb19"}),Codicon.location=new Codicon("location",{fontCharacter:"\\eb1a"}),Codicon.mailRead=new Codicon("mail-read",{fontCharacter:"\\eb1b"}),Codicon.mail=new Codicon("mail",{fontCharacter:"\\eb1c"}),Codicon.markdown=new Codicon("markdown",{fontCharacter:"\\eb1d"}),Codicon.megaphone=new Codicon("megaphone",{fontCharacter:"\\eb1e"}),Codicon.mention=new Codicon("mention",{fontCharacter:"\\eb1f"}),Codicon.milestone=new Codicon("milestone",{fontCharacter:"\\eb20"}),Codicon.mortarBoard=new Codicon("mortar-board",{fontCharacter:"\\eb21"}),Codicon.move=new Codicon("move",{fontCharacter:"\\eb22"}),Codicon.multipleWindows=new Codicon("multiple-windows",{fontCharacter:"\\eb23"}),Codicon.mute=new Codicon("mute",{fontCharacter:"\\eb24"}),Codicon.noNewline=new Codicon("no-newline",{fontCharacter:"\\eb25"}),Codicon.note=new Codicon("note",{fontCharacter:"\\eb26"}),Codicon.octoface=new Codicon("octoface",{fontCharacter:"\\eb27"}),Codicon.openPreview=new Codicon("open-preview",{fontCharacter:"\\eb28"}),Codicon.package_=new Codicon("package",{fontCharacter:"\\eb29"}),Codicon.paintcan=new Codicon("paintcan",{fontCharacter:"\\eb2a"}),Codicon.pin=new Codicon("pin",{fontCharacter:"\\eb2b"}),Codicon.play=new Codicon("play",{fontCharacter:"\\eb2c"}),Codicon.run=new Codicon("run",{fontCharacter:"\\eb2c"}),Codicon.plug=new Codicon("plug",{fontCharacter:"\\eb2d"}),Codicon.preserveCase=new Codicon("preserve-case",{fontCharacter:"\\eb2e"}),Codicon.preview=new Codicon("preview",{fontCharacter:"\\eb2f"}),Codicon.project=new Codicon("project",{fontCharacter:"\\eb30"}),Codicon.pulse=new Codicon("pulse",{fontCharacter:"\\eb31"}),Codicon.question=new Codicon("question",{fontCharacter:"\\eb32"}),Codicon.quote=new Codicon("quote",{fontCharacter:"\\eb33"}),Codicon.radioTower=new Codicon("radio-tower",{fontCharacter:"\\eb34"}),Codicon.reactions=new Codicon("reactions",{fontCharacter:"\\eb35"}),Codicon.references=new Codicon("references",{fontCharacter:"\\eb36"}),Codicon.refresh=new Codicon("refresh",{fontCharacter:"\\eb37"}),Codicon.regex=new Codicon("regex",{fontCharacter:"\\eb38"}),Codicon.remoteExplorer=new Codicon("remote-explorer",{fontCharacter:"\\eb39"}),Codicon.remote=new Codicon("remote",{fontCharacter:"\\eb3a"}),Codicon.remove=new Codicon("remove",{fontCharacter:"\\eb3b"}),Codicon.replaceAll=new Codicon("replace-all",{fontCharacter:"\\eb3c"}),Codicon.replace=new Codicon("replace",{fontCharacter:"\\eb3d"}),Codicon.repoClone=new Codicon("repo-clone",{fontCharacter:"\\eb3e"}),Codicon.repoForcePush=new Codicon("repo-force-push",{fontCharacter:"\\eb3f"}),Codicon.repoPull=new Codicon("repo-pull",{fontCharacter:"\\eb40"}),Codicon.repoPush=new Codicon("repo-push",{fontCharacter:"\\eb41"}),Codicon.report=new Codicon("report",{fontCharacter:"\\eb42"}),Codicon.requestChanges=new Codicon("request-changes",{fontCharacter:"\\eb43"}),Codicon.rocket=new Codicon("rocket",{fontCharacter:"\\eb44"}),Codicon.rootFolderOpened=new Codicon("root-folder-opened",{fontCharacter:"\\eb45"}),Codicon.rootFolder=new Codicon("root-folder",{fontCharacter:"\\eb46"}),Codicon.rss=new Codicon("rss",{fontCharacter:"\\eb47"}),Codicon.ruby=new Codicon("ruby",{fontCharacter:"\\eb48"}),Codicon.saveAll=new Codicon("save-all",{fontCharacter:"\\eb49"}),Codicon.saveAs=new Codicon("save-as",{fontCharacter:"\\eb4a"}),Codicon.save=new Codicon("save",{fontCharacter:"\\eb4b"}),Codicon.screenFull=new Codicon("screen-full",{fontCharacter:"\\eb4c"}),Codicon.screenNormal=new Codicon("screen-normal",{fontCharacter:"\\eb4d"}),Codicon.searchStop=new Codicon("search-stop",{fontCharacter:"\\eb4e"}),Codicon.server=new Codicon("server",{fontCharacter:"\\eb50"}),Codicon.settingsGear=new Codicon("settings-gear",{fontCharacter:"\\eb51"}),Codicon.settings=new Codicon("settings",{fontCharacter:"\\eb52"}),Codicon.shield=new Codicon("shield",{fontCharacter:"\\eb53"}),Codicon.smiley=new Codicon("smiley",{fontCharacter:"\\eb54"}),Codicon.sortPrecedence=new Codicon("sort-precedence",{fontCharacter:"\\eb55"}),Codicon.splitHorizontal=new Codicon("split-horizontal",{fontCharacter:"\\eb56"}),Codicon.splitVertical=new Codicon("split-vertical",{fontCharacter:"\\eb57"}),Codicon.squirrel=new Codicon("squirrel",{fontCharacter:"\\eb58"}),Codicon.starFull=new Codicon("star-full",{fontCharacter:"\\eb59"}),Codicon.starHalf=new Codicon("star-half",{fontCharacter:"\\eb5a"}),Codicon.symbolClass=new Codicon("symbol-class",{fontCharacter:"\\eb5b"}),Codicon.symbolColor=new Codicon("symbol-color",{fontCharacter:"\\eb5c"}),Codicon.symbolCustomColor=new Codicon("symbol-customcolor",{fontCharacter:"\\eb5c"}),Codicon.symbolConstant=new Codicon("symbol-constant",{fontCharacter:"\\eb5d"}),Codicon.symbolEnumMember=new Codicon("symbol-enum-member",{fontCharacter:"\\eb5e"}),Codicon.symbolField=new Codicon("symbol-field",{fontCharacter:"\\eb5f"}),Codicon.symbolFile=new Codicon("symbol-file",{fontCharacter:"\\eb60"}),Codicon.symbolInterface=new Codicon("symbol-interface",{fontCharacter:"\\eb61"}),Codicon.symbolKeyword=new Codicon("symbol-keyword",{fontCharacter:"\\eb62"}),Codicon.symbolMisc=new Codicon("symbol-misc",{fontCharacter:"\\eb63"}),Codicon.symbolOperator=new Codicon("symbol-operator",{fontCharacter:"\\eb64"}),Codicon.symbolProperty=new Codicon("symbol-property",{fontCharacter:"\\eb65"}),Codicon.wrench=new Codicon("wrench",{fontCharacter:"\\eb65"}),Codicon.wrenchSubaction=new Codicon("wrench-subaction",{fontCharacter:"\\eb65"}),Codicon.symbolSnippet=new Codicon("symbol-snippet",{fontCharacter:"\\eb66"}),Codicon.tasklist=new Codicon("tasklist",{fontCharacter:"\\eb67"}),Codicon.telescope=new Codicon("telescope",{fontCharacter:"\\eb68"}),Codicon.textSize=new Codicon("text-size",{fontCharacter:"\\eb69"}),Codicon.threeBars=new Codicon("three-bars",{fontCharacter:"\\eb6a"}),Codicon.thumbsdown=new Codicon("thumbsdown",{fontCharacter:"\\eb6b"}),Codicon.thumbsup=new Codicon("thumbsup",{fontCharacter:"\\eb6c"}),Codicon.tools=new Codicon("tools",{fontCharacter:"\\eb6d"}),Codicon.triangleDown=new Codicon("triangle-down",{fontCharacter:"\\eb6e"}),Codicon.triangleLeft=new Codicon("triangle-left",{fontCharacter:"\\eb6f"}),Codicon.triangleRight=new Codicon("triangle-right",{fontCharacter:"\\eb70"}),Codicon.triangleUp=new Codicon("triangle-up",{fontCharacter:"\\eb71"}),Codicon.twitter=new Codicon("twitter",{fontCharacter:"\\eb72"}),Codicon.unfold=new Codicon("unfold",{fontCharacter:"\\eb73"}),Codicon.unlock=new Codicon("unlock",{fontCharacter:"\\eb74"}),Codicon.unmute=new Codicon("unmute",{fontCharacter:"\\eb75"}),Codicon.unverified=new Codicon("unverified",{fontCharacter:"\\eb76"}),Codicon.verified=new Codicon("verified",{fontCharacter:"\\eb77"}),Codicon.versions=new Codicon("versions",{fontCharacter:"\\eb78"}),Codicon.vmActive=new Codicon("vm-active",{fontCharacter:"\\eb79"}),Codicon.vmOutline=new Codicon("vm-outline",{fontCharacter:"\\eb7a"}),Codicon.vmRunning=new Codicon("vm-running",{fontCharacter:"\\eb7b"}),Codicon.watch=new Codicon("watch",{fontCharacter:"\\eb7c"}),Codicon.whitespace=new Codicon("whitespace",{fontCharacter:"\\eb7d"}),Codicon.wholeWord=new Codicon("whole-word",{fontCharacter:"\\eb7e"}),Codicon.window=new Codicon("window",{fontCharacter:"\\eb7f"}),Codicon.wordWrap=new Codicon("word-wrap",{fontCharacter:"\\eb80"}),Codicon.zoomIn=new Codicon("zoom-in",{fontCharacter:"\\eb81"}),Codicon.zoomOut=new Codicon("zoom-out",{fontCharacter:"\\eb82"}),Codicon.listFilter=new Codicon("list-filter",{fontCharacter:"\\eb83"}),Codicon.listFlat=new Codicon("list-flat",{fontCharacter:"\\eb84"}),Codicon.listSelection=new Codicon("list-selection",{fontCharacter:"\\eb85"}),Codicon.selection=new Codicon("selection",{fontCharacter:"\\eb85"}),Codicon.listTree=new Codicon("list-tree",{fontCharacter:"\\eb86"}),Codicon.debugBreakpointFunctionUnverified=new Codicon("debug-breakpoint-function-unverified",{fontCharacter:"\\eb87"}),Codicon.debugBreakpointFunction=new Codicon("debug-breakpoint-function",{fontCharacter:"\\eb88"}),Codicon.debugBreakpointFunctionDisabled=new Codicon("debug-breakpoint-function-disabled",{fontCharacter:"\\eb88"}),Codicon.debugStackframeActive=new Codicon("debug-stackframe-active",{fontCharacter:"\\eb89"}),Codicon.debugStackframeDot=new Codicon("debug-stackframe-dot",{fontCharacter:"\\eb8a"}),Codicon.debugStackframe=new Codicon("debug-stackframe",{fontCharacter:"\\eb8b"}),Codicon.debugStackframeFocused=new Codicon("debug-stackframe-focused",{fontCharacter:"\\eb8b"}),Codicon.debugBreakpointUnsupported=new Codicon("debug-breakpoint-unsupported",{fontCharacter:"\\eb8c"}),Codicon.symbolString=new Codicon("symbol-string",{fontCharacter:"\\eb8d"}),Codicon.debugReverseContinue=new Codicon("debug-reverse-continue",{fontCharacter:"\\eb8e"}),Codicon.debugStepBack=new Codicon("debug-step-back",{fontCharacter:"\\eb8f"}),Codicon.debugRestartFrame=new Codicon("debug-restart-frame",{fontCharacter:"\\eb90"}),Codicon.callIncoming=new Codicon("call-incoming",{fontCharacter:"\\eb92"}),Codicon.callOutgoing=new Codicon("call-outgoing",{fontCharacter:"\\eb93"}),Codicon.menu=new Codicon("menu",{fontCharacter:"\\eb94"}),Codicon.expandAll=new Codicon("expand-all",{fontCharacter:"\\eb95"}),Codicon.feedback=new Codicon("feedback",{fontCharacter:"\\eb96"}),Codicon.groupByRefType=new Codicon("group-by-ref-type",{fontCharacter:"\\eb97"}),Codicon.ungroupByRefType=new Codicon("ungroup-by-ref-type",{fontCharacter:"\\eb98"}),Codicon.account=new Codicon("account",{fontCharacter:"\\eb99"}),Codicon.bellDot=new Codicon("bell-dot",{fontCharacter:"\\eb9a"}),Codicon.debugConsole=new Codicon("debug-console",{fontCharacter:"\\eb9b"}),Codicon.library=new Codicon("library",{fontCharacter:"\\eb9c"}),Codicon.output=new Codicon("output",{fontCharacter:"\\eb9d"}),Codicon.runAll=new Codicon("run-all",{fontCharacter:"\\eb9e"}),Codicon.syncIgnored=new Codicon("sync-ignored",{fontCharacter:"\\eb9f"}),Codicon.pinned=new Codicon("pinned",{fontCharacter:"\\eba0"}),Codicon.githubInverted=new Codicon("github-inverted",{fontCharacter:"\\eba1"}),Codicon.debugAlt=new Codicon("debug-alt",{fontCharacter:"\\eb91"}),Codicon.serverProcess=new Codicon("server-process",{fontCharacter:"\\eba2"}),Codicon.serverEnvironment=new Codicon("server-environment",{fontCharacter:"\\eba3"}),Codicon.pass=new Codicon("pass",{fontCharacter:"\\eba4"}),Codicon.stopCircle=new Codicon("stop-circle",{fontCharacter:"\\eba5"}),Codicon.playCircle=new Codicon("play-circle",{fontCharacter:"\\eba6"}),Codicon.record=new Codicon("record",{fontCharacter:"\\eba7"}),Codicon.debugAltSmall=new Codicon("debug-alt-small",{fontCharacter:"\\eba8"}),Codicon.vmConnect=new Codicon("vm-connect",{fontCharacter:"\\eba9"}),Codicon.cloud=new Codicon("cloud",{fontCharacter:"\\ebaa"}),Codicon.merge=new Codicon("merge",{fontCharacter:"\\ebab"}),Codicon.exportIcon=new Codicon("export",{fontCharacter:"\\ebac"}),Codicon.graphLeft=new Codicon("graph-left",{fontCharacter:"\\ebad"}),Codicon.magnet=new Codicon("magnet",{fontCharacter:"\\ebae"}),Codicon.notebook=new Codicon("notebook",{fontCharacter:"\\ebaf"}),Codicon.redo=new Codicon("redo",{fontCharacter:"\\ebb0"}),Codicon.checkAll=new Codicon("check-all",{fontCharacter:"\\ebb1"}),Codicon.pinnedDirty=new Codicon("pinned-dirty",{fontCharacter:"\\ebb2"}),Codicon.passFilled=new Codicon("pass-filled",{fontCharacter:"\\ebb3"}),Codicon.circleLargeFilled=new Codicon("circle-large-filled",{fontCharacter:"\\ebb4"}),Codicon.circleLargeOutline=new Codicon("circle-large-outline",{fontCharacter:"\\ebb5"}),Codicon.combine=new Codicon("combine",{fontCharacter:"\\ebb6"}),Codicon.gather=new Codicon("gather",{fontCharacter:"\\ebb6"}),Codicon.table=new Codicon("table",{fontCharacter:"\\ebb7"}),Codicon.variableGroup=new Codicon("variable-group",{fontCharacter:"\\ebb8"}),Codicon.typeHierarchy=new Codicon("type-hierarchy",{fontCharacter:"\\ebb9"}),Codicon.typeHierarchySub=new Codicon("type-hierarchy-sub",{fontCharacter:"\\ebba"}),Codicon.typeHierarchySuper=new Codicon("type-hierarchy-super",{fontCharacter:"\\ebbb"}),Codicon.gitPullRequestCreate=new Codicon("git-pull-request-create",{fontCharacter:"\\ebbc"}),Codicon.runAbove=new Codicon("run-above",{fontCharacter:"\\ebbd"}),Codicon.runBelow=new Codicon("run-below",{fontCharacter:"\\ebbe"}),Codicon.notebookTemplate=new Codicon("notebook-template",{fontCharacter:"\\ebbf"}),Codicon.debugRerun=new Codicon("debug-rerun",{fontCharacter:"\\ebc0"}),Codicon.workspaceTrusted=new Codicon("workspace-trusted",{fontCharacter:"\\ebc1"}),Codicon.workspaceUntrusted=new Codicon("workspace-untrusted",{fontCharacter:"\\ebc2"}),Codicon.workspaceUnspecified=new Codicon("workspace-unspecified",{fontCharacter:"\\ebc3"}),Codicon.terminalCmd=new Codicon("terminal-cmd",{fontCharacter:"\\ebc4"}),Codicon.terminalDebian=new Codicon("terminal-debian",{fontCharacter:"\\ebc5"}),Codicon.terminalLinux=new Codicon("terminal-linux",{fontCharacter:"\\ebc6"}),Codicon.terminalPowershell=new Codicon("terminal-powershell",{fontCharacter:"\\ebc7"}),Codicon.terminalTmux=new Codicon("terminal-tmux",{fontCharacter:"\\ebc8"}),Codicon.terminalUbuntu=new Codicon("terminal-ubuntu",{fontCharacter:"\\ebc9"}),Codicon.terminalBash=new Codicon("terminal-bash",{fontCharacter:"\\ebca"}),Codicon.arrowSwap=new Codicon("arrow-swap",{fontCharacter:"\\ebcb"}),Codicon.copy=new Codicon("copy",{fontCharacter:"\\ebcc"}),Codicon.personAdd=new Codicon("person-add",{fontCharacter:"\\ebcd"}),Codicon.filterFilled=new Codicon("filter-filled",{fontCharacter:"\\ebce"}),Codicon.wand=new Codicon("wand",{fontCharacter:"\\ebcf"}),Codicon.debugLineByLine=new Codicon("debug-line-by-line",{fontCharacter:"\\ebd0"}),Codicon.inspect=new Codicon("inspect",{fontCharacter:"\\ebd1"}),Codicon.layers=new Codicon("layers",{fontCharacter:"\\ebd2"}),Codicon.layersDot=new Codicon("layers-dot",{fontCharacter:"\\ebd3"}),Codicon.layersActive=new Codicon("layers-active",{fontCharacter:"\\ebd4"}),Codicon.compass=new Codicon("compass",{fontCharacter:"\\ebd5"}),Codicon.compassDot=new Codicon("compass-dot",{fontCharacter:"\\ebd6"}),Codicon.compassActive=new Codicon("compass-active",{fontCharacter:"\\ebd7"}),Codicon.azure=new Codicon("azure",{fontCharacter:"\\ebd8"}),Codicon.issueDraft=new Codicon("issue-draft",{fontCharacter:"\\ebd9"}),Codicon.gitPullRequestClosed=new Codicon("git-pull-request-closed",{fontCharacter:"\\ebda"}),Codicon.gitPullRequestDraft=new Codicon("git-pull-request-draft",{fontCharacter:"\\ebdb"}),Codicon.debugAll=new Codicon("debug-all",{fontCharacter:"\\ebdc"}),Codicon.debugCoverage=new Codicon("debug-coverage",{fontCharacter:"\\ebdd"}),Codicon.runErrors=new Codicon("run-errors",{fontCharacter:"\\ebde"}),Codicon.folderLibrary=new Codicon("folder-library",{fontCharacter:"\\ebdf"}),Codicon.debugContinueSmall=new Codicon("debug-continue-small",{fontCharacter:"\\ebe0"}),Codicon.beakerStop=new Codicon("beaker-stop",{fontCharacter:"\\ebe1"}),Codicon.graphLine=new Codicon("graph-line",{fontCharacter:"\\ebe2"}),Codicon.graphScatter=new Codicon("graph-scatter",{fontCharacter:"\\ebe3"}),Codicon.pieChart=new Codicon("pie-chart",{fontCharacter:"\\ebe4"}),Codicon.bracket=new Codicon("bracket",Codicon.json.definition),Codicon.bracketDot=new Codicon("bracket-dot",{fontCharacter:"\\ebe5"}),Codicon.bracketError=new Codicon("bracket-error",{fontCharacter:"\\ebe6"}),Codicon.lockSmall=new Codicon("lock-small",{fontCharacter:"\\ebe7"}),Codicon.azureDevops=new Codicon("azure-devops",{fontCharacter:"\\ebe8"}),Codicon.verifiedFilled=new Codicon("verified-filled",{fontCharacter:"\\ebe9"}),Codicon.newLine=new Codicon("newline",{fontCharacter:"\\ebea"}),Codicon.layout=new Codicon("layout",{fontCharacter:"\\ebeb"}),Codicon.layoutActivitybarLeft=new Codicon("layout-activitybar-left",{fontCharacter:"\\ebec"}),Codicon.layoutActivitybarRight=new Codicon("layout-activitybar-right",{fontCharacter:"\\ebed"}),Codicon.layoutPanelLeft=new Codicon("layout-panel-left",{fontCharacter:"\\ebee"}),Codicon.layoutPanelCenter=new Codicon("layout-panel-center",{fontCharacter:"\\ebef"}),Codicon.layoutPanelJustify=new Codicon("layout-panel-justify",{fontCharacter:"\\ebf0"}),Codicon.layoutPanelRight=new Codicon("layout-panel-right",{fontCharacter:"\\ebf1"}),Codicon.layoutPanel=new Codicon("layout-panel",{fontCharacter:"\\ebf2"}),Codicon.layoutSidebarLeft=new Codicon("layout-sidebar-left",{fontCharacter:"\\ebf3"}),Codicon.layoutSidebarRight=new Codicon("layout-sidebar-right",{fontCharacter:"\\ebf4"}),Codicon.layoutStatusbar=new Codicon("layout-statusbar",{fontCharacter:"\\ebf5"}),Codicon.layoutMenubar=new Codicon("layout-menubar",{fontCharacter:"\\ebf6"}),Codicon.layoutCentered=new Codicon("layout-centered",{fontCharacter:"\\ebf7"}),Codicon.target=new Codicon("target",{fontCharacter:"\\ebf8"}),Codicon.indent=new Codicon("indent",{fontCharacter:"\\ebf9"}),Codicon.recordSmall=new Codicon("record-small",{fontCharacter:"\\ebfa"}),Codicon.errorSmall=new Codicon("error-small",{fontCharacter:"\\ebfb"}),Codicon.arrowCircleDown=new Codicon("arrow-circle-down",{fontCharacter:"\\ebfc"}),Codicon.arrowCircleLeft=new Codicon("arrow-circle-left",{fontCharacter:"\\ebfd"}),Codicon.arrowCircleRight=new Codicon("arrow-circle-right",{fontCharacter:"\\ebfe"}),Codicon.arrowCircleUp=new Codicon("arrow-circle-up",{fontCharacter:"\\ebff"}),Codicon.dialogError=new Codicon("dialog-error",Codicon.error.definition),Codicon.dialogWarning=new Codicon("dialog-warning",Codicon.warning.definition),Codicon.dialogInfo=new Codicon("dialog-info",Codicon.info.definition),Codicon.dialogClose=new Codicon("dialog-close",Codicon.close.definition),Codicon.treeItemExpanded=new Codicon("tree-item-expanded",Codicon.chevronDown.definition),Codicon.treeFilterOnTypeOn=new Codicon("tree-filter-on-type-on",Codicon.listFilter.definition),Codicon.treeFilterOnTypeOff=new Codicon("tree-filter-on-type-off",Codicon.listSelection.definition),Codicon.treeFilterClear=new Codicon("tree-filter-clear",Codicon.close.definition),Codicon.treeItemLoading=new Codicon("tree-item-loading",Codicon.loading.definition),Codicon.menuSelection=new Codicon("menu-selection",Codicon.check.definition),Codicon.menuSubmenu=new Codicon("menu-submenu",Codicon.chevronRight.definition),Codicon.menuBarMore=new Codicon("menubar-more",Codicon.more.definition),Codicon.scrollbarButtonLeft=new Codicon("scrollbar-button-left",Codicon.triangleLeft.definition),Codicon.scrollbarButtonRight=new Codicon("scrollbar-button-right",Codicon.triangleRight.definition),Codicon.scrollbarButtonUp=new Codicon("scrollbar-button-up",Codicon.triangleUp.definition),Codicon.scrollbarButtonDown=new Codicon("scrollbar-button-down",Codicon.triangleDown.definition),Codicon.toolBarMore=new Codicon("toolbar-more",Codicon.more.definition),Codicon.quickInputBack=new Codicon("quick-input-back",Codicon.arrowLeft.definition),function(CSSIcon){CSSIcon.iconNameSegment="[A-Za-z0-9]+",CSSIcon.iconNameExpression="[A-Za-z0-9-]+",CSSIcon.iconModifierExpression="~[A-Za-z]+",CSSIcon.iconNameCharacter="[A-Za-z0-9~-]";const cssIconIdRegex=new RegExp(`^(${CSSIcon.iconNameExpression})(${CSSIcon.iconModifierExpression})?$`);function asClassNameArray(icon){if(icon instanceof Codicon)return["codicon","codicon-"+icon.id];const match=cssIconIdRegex.exec(icon.id);if(!match)return asClassNameArray(Codicon.error);let[,id,modifier]=match;const classNames=["codicon","codicon-"+id];return modifier&&classNames.push("codicon-modifier-"+modifier.substr(1)),classNames}CSSIcon.asClassNameArray=asClassNameArray,CSSIcon.asClassName=function asClassName(icon){return asClassNameArray(icon).join(" ")},CSSIcon.asCSSSelector=function asCSSSelector(icon){return"."+asClassNameArray(icon).join(".")}}(exports.CSSIcon||(exports.CSSIcon={}))})),define(__m[217],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SetMap=exports.forEach=void 0;const hasOwnProperty=Object.prototype.hasOwnProperty;exports.forEach=function forEach(from,callback){for(let key in from)if(hasOwnProperty.call(from,key)){if(!1===callback({key,value:from[key]},(function(){delete from[key]})))return}};exports.SetMap=class SetMap{constructor(){this.map=new Map}add(key,value){let values=this.map.get(key);values||(values=new Set,this.map.set(key,values)),values.add(value)}delete(key,value){const values=this.map.get(key);values&&(values.delete(value),0===values.size&&this.map.delete(key))}forEach(key,fn){const values=this.map.get(key);values&&values.forEach(fn)}}})),define(__m[30],__M([1,0]),(function(require,exports){"use strict";function roundFloat(number,decimalPoints){const decimal=Math.pow(10,decimalPoints);return Math.round(number*decimal)/decimal}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Color=exports.HSVA=exports.HSLA=exports.RGBA=void 0;class RGBA{constructor(r,g,b,a=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,r)),this.g=0|Math.min(255,Math.max(0,g)),this.b=0|Math.min(255,Math.max(0,b)),this.a=roundFloat(Math.max(Math.min(1,a),0),3)}static equals(a,b){return a.r===b.r&&a.g===b.g&&a.b===b.b&&a.a===b.a}}exports.RGBA=RGBA;class HSLA{constructor(h,s,l,a){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,h),0),this.s=roundFloat(Math.max(Math.min(1,s),0),3),this.l=roundFloat(Math.max(Math.min(1,l),0),3),this.a=roundFloat(Math.max(Math.min(1,a),0),3)}static equals(a,b){return a.h===b.h&&a.s===b.s&&a.l===b.l&&a.a===b.a}static fromRGBA(rgba){const r=rgba.r/255,g=rgba.g/255,b=rgba.b/255,a=rgba.a,max=Math.max(r,g,b),min=Math.min(r,g,b);let h=0,s=0;const l=(min+max)/2,chroma=max-min;if(chroma>0){switch(s=Math.min(l<=.5?chroma/(2*l):chroma/(2-2*l),1),max){case r:h=(g-b)/chroma+(g<b?6:0);break;case g:h=(b-r)/chroma+2;break;case b:h=(r-g)/chroma+4}h*=60,h=Math.round(h)}return new HSLA(h,s,l,a)}static _hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}static toRGBA(hsla){const h=hsla.h/360,{s,l,a}=hsla;let r,g,b;if(0===s)r=g=b=l;else{const q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=HSLA._hue2rgb(p,q,h+1/3),g=HSLA._hue2rgb(p,q,h),b=HSLA._hue2rgb(p,q,h-1/3)}return new RGBA(Math.round(255*r),Math.round(255*g),Math.round(255*b),a)}}exports.HSLA=HSLA;class HSVA{constructor(h,s,v,a){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,h),0),this.s=roundFloat(Math.max(Math.min(1,s),0),3),this.v=roundFloat(Math.max(Math.min(1,v),0),3),this.a=roundFloat(Math.max(Math.min(1,a),0),3)}static equals(a,b){return a.h===b.h&&a.s===b.s&&a.v===b.v&&a.a===b.a}static fromRGBA(rgba){const r=rgba.r/255,g=rgba.g/255,b=rgba.b/255,cmax=Math.max(r,g,b),delta=cmax-Math.min(r,g,b),s=0===cmax?0:delta/cmax;let m;return m=0===delta?0:cmax===r?((g-b)/delta%6+6)%6:cmax===g?(b-r)/delta+2:(r-g)/delta+4,new HSVA(Math.round(60*m),s,cmax,rgba.a)}static toRGBA(hsva){const{h,s,v,a}=hsva,c=v*s,x=c*(1-Math.abs(h/60%2-1)),m=v-c;let[r,g,b]=[0,0,0];return h<60?(r=c,g=x):h<120?(r=x,g=c):h<180?(g=c,b=x):h<240?(g=x,b=c):h<300?(r=x,b=c):h<=360&&(r=c,b=x),r=Math.round(255*(r+m)),g=Math.round(255*(g+m)),b=Math.round(255*(b+m)),new RGBA(r,g,b,a)}}exports.HSVA=HSVA;class Color{constructor(arg){if(!arg)throw new Error("Color needs a value");if(arg instanceof RGBA)this.rgba=arg;else if(arg instanceof HSLA)this._hsla=arg,this.rgba=HSLA.toRGBA(arg);else{if(!(arg instanceof HSVA))throw new Error("Invalid color ctor argument");this._hsva=arg,this.rgba=HSVA.toRGBA(arg)}}static fromHex(hex){return Color.Format.CSS.parseHex(hex)||Color.red}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}equals(other){return!!other&&RGBA.equals(this.rgba,other.rgba)&&HSLA.equals(this.hsla,other.hsla)&&HSVA.equals(this.hsva,other.hsva)}getRelativeLuminance(){return roundFloat(.2126*Color._relativeLuminanceForComponent(this.rgba.r)+.7152*Color._relativeLuminanceForComponent(this.rgba.g)+.0722*Color._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(color){const c=color/255;return c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4)}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(another){return this.getRelativeLuminance()>another.getRelativeLuminance()}isDarkerThan(another){return this.getRelativeLuminance()<another.getRelativeLuminance()}lighten(factor){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*factor,this.hsla.a))}darken(factor){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*factor,this.hsla.a))}transparent(factor){const{r,g,b,a}=this.rgba;return new Color(new RGBA(r,g,b,a*factor))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new Color(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}toString(){return this._toString||(this._toString=Color.Format.CSS.format(this)),this._toString}static getLighterColor(of,relative,factor){if(of.isLighterThan(relative))return of;factor=factor||.5;const lum1=of.getRelativeLuminance(),lum2=relative.getRelativeLuminance();return factor=factor*(lum2-lum1)/lum2,of.lighten(factor)}static getDarkerColor(of,relative,factor){if(of.isDarkerThan(relative))return of;factor=factor||.5;const lum1=of.getRelativeLuminance();return factor=factor*(lum1-relative.getRelativeLuminance())/lum1,of.darken(factor)}}exports.Color=Color,Color.white=new Color(new RGBA(255,255,255,1)),Color.black=new Color(new RGBA(0,0,0,1)),Color.red=new Color(new RGBA(255,0,0,1)),Color.blue=new Color(new RGBA(0,0,255,1)),Color.green=new Color(new RGBA(0,255,0,1)),Color.cyan=new Color(new RGBA(0,255,255,1)),Color.lightgrey=new Color(new RGBA(211,211,211,1)),Color.transparent=new Color(new RGBA(0,0,0,0)),function(Color){let Format;!function(Format){let CSS;!function(CSS){function _toTwoDigitHex(n){const r=n.toString(16);return 2!==r.length?"0"+r:r}function _parseHexDigit(charCode){switch(charCode){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:case 65:return 10;case 98:case 66:return 11;case 99:case 67:return 12;case 100:case 68:return 13;case 101:case 69:return 14;case 102:case 70:return 15}return 0}CSS.formatRGB=function formatRGB(color){return 1===color.rgba.a?`rgb(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b})`:Color.Format.CSS.formatRGBA(color)},CSS.formatRGBA=function formatRGBA(color){return`rgba(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b}, ${+color.rgba.a.toFixed(2)})`},CSS.formatHSL=function formatHSL(color){return 1===color.hsla.a?`hsl(${color.hsla.h}, ${(100*color.hsla.s).toFixed(2)}%, ${(100*color.hsla.l).toFixed(2)}%)`:Color.Format.CSS.formatHSLA(color)},CSS.formatHSLA=function formatHSLA(color){return`hsla(${color.hsla.h}, ${(100*color.hsla.s).toFixed(2)}%, ${(100*color.hsla.l).toFixed(2)}%, ${color.hsla.a.toFixed(2)})`},CSS.formatHex=function formatHex(color){return`#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}`},CSS.formatHexA=function formatHexA(color,compact=!1){return compact&&1===color.rgba.a?Color.Format.CSS.formatHex(color):`#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}${_toTwoDigitHex(Math.round(255*color.rgba.a))}`},CSS.format=function format(color){return color.isOpaque()?Color.Format.CSS.formatHex(color):Color.Format.CSS.formatRGBA(color)},CSS.parseHex=function parseHex(hex){const length=hex.length;if(0===length)return null;if(35!==hex.charCodeAt(0))return null;if(7===length){const r=16*_parseHexDigit(hex.charCodeAt(1))+_parseHexDigit(hex.charCodeAt(2)),g=16*_parseHexDigit(hex.charCodeAt(3))+_parseHexDigit(hex.charCodeAt(4)),b=16*_parseHexDigit(hex.charCodeAt(5))+_parseHexDigit(hex.charCodeAt(6));return new Color(new RGBA(r,g,b,1))}if(9===length){const r=16*_parseHexDigit(hex.charCodeAt(1))+_parseHexDigit(hex.charCodeAt(2)),g=16*_parseHexDigit(hex.charCodeAt(3))+_parseHexDigit(hex.charCodeAt(4)),b=16*_parseHexDigit(hex.charCodeAt(5))+_parseHexDigit(hex.charCodeAt(6)),a=16*_parseHexDigit(hex.charCodeAt(7))+_parseHexDigit(hex.charCodeAt(8));return new Color(new RGBA(r,g,b,a/255))}if(4===length){const r=_parseHexDigit(hex.charCodeAt(1)),g=_parseHexDigit(hex.charCodeAt(2)),b=_parseHexDigit(hex.charCodeAt(3));return new Color(new RGBA(16*r+r,16*g+g,16*b+b))}if(5===length){const r=_parseHexDigit(hex.charCodeAt(1)),g=_parseHexDigit(hex.charCodeAt(2)),b=_parseHexDigit(hex.charCodeAt(3)),a=_parseHexDigit(hex.charCodeAt(4));return new Color(new RGBA(16*r+r,16*g+g,16*b+b,(16*a+a)/255))}return null}}(CSS=Format.CSS||(Format.CSS={}))}(Format=Color.Format||(Color.Format={}))}(Color=exports.Color||(exports.Color={}))})),define(__m[95],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.memoize=void 0,exports.memoize=function memoize(_target,key,descriptor){let fnKey=null,fn=null;if("function"==typeof descriptor.value?(fnKey="value",fn=descriptor.value,0!==fn.length&&console.warn("Memoize should only be used in functions with zero parameters")):"function"==typeof descriptor.get&&(fnKey="get",fn=descriptor.get),!fn)throw new Error("not supported");const memoizeKey=`$memoize$${key}`;descriptor[fnKey]=function(...args){return this.hasOwnProperty(memoizeKey)||Object.defineProperty(this,memoizeKey,{configurable:!1,enumerable:!1,writable:!1,value:fn.apply(this,args)}),this[memoizeKey]}}})),define(__m[313],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DiffChange=void 0;exports.DiffChange=class DiffChange{constructor(originalStart,originalLength,modifiedStart,modifiedLength){this.originalStart=originalStart,this.originalLength=originalLength,this.modifiedStart=modifiedStart,this.modifiedLength=modifiedLength}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}})),define(__m[13],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NotSupportedError=exports.illegalState=exports.illegalArgument=exports.canceled=exports.CancellationError=exports.isCancellationError=exports.transformErrorForSerialization=exports.onUnexpectedExternalError=exports.onUnexpectedError=exports.errorHandler=exports.ErrorHandler=void 0;class ErrorHandler{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout((()=>{if(e.stack)throw new Error(e.message+"\n\n"+e.stack);throw e}),0)}}emit(e){this.listeners.forEach((listener=>{listener(e)}))}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}exports.ErrorHandler=ErrorHandler,exports.errorHandler=new ErrorHandler,exports.onUnexpectedError=function onUnexpectedError(e){isCancellationError(e)||exports.errorHandler.onUnexpectedError(e)},exports.onUnexpectedExternalError=function onUnexpectedExternalError(e){isCancellationError(e)||exports.errorHandler.onUnexpectedExternalError(e)},exports.transformErrorForSerialization=function transformErrorForSerialization(error){if(error instanceof Error){let{name,message}=error;return{$isError:!0,name,message,stack:error.stacktrace||error.stack}}return error};function isCancellationError(error){return error instanceof CancellationError||error instanceof Error&&"Canceled"===error.name&&"Canceled"===error.message}exports.isCancellationError=isCancellationError;class CancellationError extends Error{constructor(){super("Canceled"),this.name=this.message}}exports.CancellationError=CancellationError,exports.canceled=function canceled(){const error=new Error("Canceled");return error.name=error.message,error},exports.illegalArgument=function illegalArgument(name){return name?new Error(`Illegal argument: ${name}`):new Error("Illegal argument")},exports.illegalState=function illegalState(name){return name?new Error(`Illegal state: ${name}`):new Error("Illegal state")};class NotSupportedError extends Error{constructor(message){super("NotSupported"),message&&(this.message=message)}}exports.NotSupportedError=NotSupportedError})),define(__m[91],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.once=void 0,exports.once=function once(fn){const _this=this;let result,didCall=!1;return function(){return didCall||(didCall=!0,result=fn.apply(_this,arguments)),result}}})),define(__m[136],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultGenerator=exports.IdGenerator=void 0;class IdGenerator{constructor(prefix){this._prefix=prefix,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}exports.IdGenerator=IdGenerator,exports.defaultGenerator=new IdGenerator("id#")})),define(__m[57],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Iterable=void 0,function(Iterable){Iterable.is=function is(thing){return thing&&"object"==typeof thing&&"function"==typeof thing[Symbol.iterator]};const _empty=Object.freeze([]);Iterable.empty=function empty(){return _empty},Iterable.single=function*single(element){yield element},Iterable.from=function from(iterable){return iterable||_empty},Iterable.isEmpty=function isEmpty(iterable){return!iterable||!0===iterable[Symbol.iterator]().next().done},Iterable.first=function first(iterable){return iterable[Symbol.iterator]().next().value},Iterable.some=function some(iterable,predicate){for(const element of iterable)if(predicate(element))return!0;return!1},Iterable.find=function find(iterable,predicate){for(const element of iterable)if(predicate(element))return element},Iterable.filter=function*filter(iterable,predicate){for(const element of iterable)predicate(element)&&(yield element)},Iterable.map=function*map(iterable,fn){let index=0;for(const element of iterable)yield fn(element,index++)},Iterable.concat=function*concat(...iterables){for(const iterable of iterables)for(const element of iterable)yield element},Iterable.concatNested=function*concatNested(iterables){for(const iterable of iterables)for(const element of iterable)yield element},Iterable.reduce=function reduce(iterable,reducer,initialValue){let value=initialValue;for(const element of iterable)value=reducer(value,element);return value},Iterable.slice=function*slice(arr,from,to=arr.length){for(from<0&&(from+=arr.length),to<0?to+=arr.length:to>arr.length&&(to=arr.length);from<to;from++)yield arr[from]},Iterable.consume=function consume(iterable,atMost=Number.POSITIVE_INFINITY){const consumed=[];if(0===atMost)return[consumed,iterable];const iterator=iterable[Symbol.iterator]();for(let i=0;i<atMost;i++){const next=iterator.next();if(next.done)return[consumed,Iterable.empty()];consumed.push(next.value)}return[consumed,{[Symbol.iterator]:()=>iterator}]},Iterable.equals=function equals(a,b,comparator=((at,bt)=>at===bt)){const ai=a[Symbol.iterator](),bi=b[Symbol.iterator]();for(;;){const an=ai.next(),bn=bi.next();if(an.done!==bn.done)return!1;if(an.done)return!0;if(!comparator(an.value,bn.value))return!1}}}(exports.Iterable||(exports.Iterable={}))})),define(__m[58],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyChord=exports.KeyCodeUtils=exports.IMMUTABLE_KEY_CODE_TO_CODE=exports.IMMUTABLE_CODE_TO_KEY_CODE=exports.NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE=exports.EVENT_KEY_CODE_MAP=void 0;class KeyCodeStrMap{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(keyCode,str){this._keyCodeToStr[keyCode]=str,this._strToKeyCode[str.toLowerCase()]=keyCode}keyCodeToStr(keyCode){return this._keyCodeToStr[keyCode]}strToKeyCode(str){return this._strToKeyCode[str.toLowerCase()]||0}}const uiMap=new KeyCodeStrMap,userSettingsUSMap=new KeyCodeStrMap,userSettingsGeneralMap=new KeyCodeStrMap;exports.EVENT_KEY_CODE_MAP=new Array(230),exports.NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE={};const scanCodeIntToStr=[],scanCodeStrToInt=Object.create(null),scanCodeLowerCaseStrToInt=Object.create(null);exports.IMMUTABLE_CODE_TO_KEY_CODE=[],exports.IMMUTABLE_KEY_CODE_TO_CODE=[];for(let i=0;i<=193;i++)exports.IMMUTABLE_CODE_TO_KEY_CODE[i]=-1;for(let i=0;i<=127;i++)exports.IMMUTABLE_KEY_CODE_TO_CODE[i]=-1;!function(){const mappings=[[0,1,0,"None",0,"unknown",0,"VK_UNKNOWN","",""],[0,1,1,"Hyper",0,"",0,"","",""],[0,1,2,"Super",0,"",0,"","",""],[0,1,3,"Fn",0,"",0,"","",""],[0,1,4,"FnLock",0,"",0,"","",""],[0,1,5,"Suspend",0,"",0,"","",""],[0,1,6,"Resume",0,"",0,"","",""],[0,1,7,"Turbo",0,"",0,"","",""],[0,1,8,"Sleep",0,"",0,"VK_SLEEP","",""],[0,1,9,"WakeUp",0,"",0,"","",""],[31,0,10,"KeyA",31,"A",65,"VK_A","",""],[32,0,11,"KeyB",32,"B",66,"VK_B","",""],[33,0,12,"KeyC",33,"C",67,"VK_C","",""],[34,0,13,"KeyD",34,"D",68,"VK_D","",""],[35,0,14,"KeyE",35,"E",69,"VK_E","",""],[36,0,15,"KeyF",36,"F",70,"VK_F","",""],[37,0,16,"KeyG",37,"G",71,"VK_G","",""],[38,0,17,"KeyH",38,"H",72,"VK_H","",""],[39,0,18,"KeyI",39,"I",73,"VK_I","",""],[40,0,19,"KeyJ",40,"J",74,"VK_J","",""],[41,0,20,"KeyK",41,"K",75,"VK_K","",""],[42,0,21,"KeyL",42,"L",76,"VK_L","",""],[43,0,22,"KeyM",43,"M",77,"VK_M","",""],[44,0,23,"KeyN",44,"N",78,"VK_N","",""],[45,0,24,"KeyO",45,"O",79,"VK_O","",""],[46,0,25,"KeyP",46,"P",80,"VK_P","",""],[47,0,26,"KeyQ",47,"Q",81,"VK_Q","",""],[48,0,27,"KeyR",48,"R",82,"VK_R","",""],[49,0,28,"KeyS",49,"S",83,"VK_S","",""],[50,0,29,"KeyT",50,"T",84,"VK_T","",""],[51,0,30,"KeyU",51,"U",85,"VK_U","",""],[52,0,31,"KeyV",52,"V",86,"VK_V","",""],[53,0,32,"KeyW",53,"W",87,"VK_W","",""],[54,0,33,"KeyX",54,"X",88,"VK_X","",""],[55,0,34,"KeyY",55,"Y",89,"VK_Y","",""],[56,0,35,"KeyZ",56,"Z",90,"VK_Z","",""],[22,0,36,"Digit1",22,"1",49,"VK_1","",""],[23,0,37,"Digit2",23,"2",50,"VK_2","",""],[24,0,38,"Digit3",24,"3",51,"VK_3","",""],[25,0,39,"Digit4",25,"4",52,"VK_4","",""],[26,0,40,"Digit5",26,"5",53,"VK_5","",""],[27,0,41,"Digit6",27,"6",54,"VK_6","",""],[28,0,42,"Digit7",28,"7",55,"VK_7","",""],[29,0,43,"Digit8",29,"8",56,"VK_8","",""],[30,0,44,"Digit9",30,"9",57,"VK_9","",""],[21,0,45,"Digit0",21,"0",48,"VK_0","",""],[3,1,46,"Enter",3,"Enter",13,"VK_RETURN","",""],[9,1,47,"Escape",9,"Escape",27,"VK_ESCAPE","",""],[1,1,48,"Backspace",1,"Backspace",8,"VK_BACK","",""],[2,1,49,"Tab",2,"Tab",9,"VK_TAB","",""],[10,1,50,"Space",10,"Space",32,"VK_SPACE","",""],[83,0,51,"Minus",83,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[81,0,52,"Equal",81,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[87,0,53,"BracketLeft",87,"[",219,"VK_OEM_4","[","OEM_4"],[89,0,54,"BracketRight",89,"]",221,"VK_OEM_6","]","OEM_6"],[88,0,55,"Backslash",88,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,0,56,"IntlHash",0,"",0,"","",""],[80,0,57,"Semicolon",80,";",186,"VK_OEM_1",";","OEM_1"],[90,0,58,"Quote",90,"'",222,"VK_OEM_7","'","OEM_7"],[86,0,59,"Backquote",86,"`",192,"VK_OEM_3","`","OEM_3"],[82,0,60,"Comma",82,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[84,0,61,"Period",84,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[85,0,62,"Slash",85,"/",191,"VK_OEM_2","/","OEM_2"],[8,1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL","",""],[59,1,64,"F1",59,"F1",112,"VK_F1","",""],[60,1,65,"F2",60,"F2",113,"VK_F2","",""],[61,1,66,"F3",61,"F3",114,"VK_F3","",""],[62,1,67,"F4",62,"F4",115,"VK_F4","",""],[63,1,68,"F5",63,"F5",116,"VK_F5","",""],[64,1,69,"F6",64,"F6",117,"VK_F6","",""],[65,1,70,"F7",65,"F7",118,"VK_F7","",""],[66,1,71,"F8",66,"F8",119,"VK_F8","",""],[67,1,72,"F9",67,"F9",120,"VK_F9","",""],[68,1,73,"F10",68,"F10",121,"VK_F10","",""],[69,1,74,"F11",69,"F11",122,"VK_F11","",""],[70,1,75,"F12",70,"F12",123,"VK_F12","",""],[0,1,76,"PrintScreen",0,"",0,"","",""],[79,1,77,"ScrollLock",79,"ScrollLock",145,"VK_SCROLL","",""],[7,1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE","",""],[19,1,79,"Insert",19,"Insert",45,"VK_INSERT","",""],[14,1,80,"Home",14,"Home",36,"VK_HOME","",""],[11,1,81,"PageUp",11,"PageUp",33,"VK_PRIOR","",""],[20,1,82,"Delete",20,"Delete",46,"VK_DELETE","",""],[13,1,83,"End",13,"End",35,"VK_END","",""],[12,1,84,"PageDown",12,"PageDown",34,"VK_NEXT","",""],[17,1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",""],[15,1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",""],[18,1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",""],[16,1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",""],[78,1,89,"NumLock",78,"NumLock",144,"VK_NUMLOCK","",""],[108,1,90,"NumpadDivide",108,"NumPad_Divide",111,"VK_DIVIDE","",""],[103,1,91,"NumpadMultiply",103,"NumPad_Multiply",106,"VK_MULTIPLY","",""],[106,1,92,"NumpadSubtract",106,"NumPad_Subtract",109,"VK_SUBTRACT","",""],[104,1,93,"NumpadAdd",104,"NumPad_Add",107,"VK_ADD","",""],[3,1,94,"NumpadEnter",3,"",0,"","",""],[94,1,95,"Numpad1",94,"NumPad1",97,"VK_NUMPAD1","",""],[95,1,96,"Numpad2",95,"NumPad2",98,"VK_NUMPAD2","",""],[96,1,97,"Numpad3",96,"NumPad3",99,"VK_NUMPAD3","",""],[97,1,98,"Numpad4",97,"NumPad4",100,"VK_NUMPAD4","",""],[98,1,99,"Numpad5",98,"NumPad5",101,"VK_NUMPAD5","",""],[99,1,100,"Numpad6",99,"NumPad6",102,"VK_NUMPAD6","",""],[100,1,101,"Numpad7",100,"NumPad7",103,"VK_NUMPAD7","",""],[101,1,102,"Numpad8",101,"NumPad8",104,"VK_NUMPAD8","",""],[102,1,103,"Numpad9",102,"NumPad9",105,"VK_NUMPAD9","",""],[93,1,104,"Numpad0",93,"NumPad0",96,"VK_NUMPAD0","",""],[107,1,105,"NumpadDecimal",107,"NumPad_Decimal",110,"VK_DECIMAL","",""],[92,0,106,"IntlBackslash",92,"OEM_102",226,"VK_OEM_102","",""],[58,1,107,"ContextMenu",58,"ContextMenu",93,"","",""],[0,1,108,"Power",0,"",0,"","",""],[0,1,109,"NumpadEqual",0,"",0,"","",""],[71,1,110,"F13",71,"F13",124,"VK_F13","",""],[72,1,111,"F14",72,"F14",125,"VK_F14","",""],[73,1,112,"F15",73,"F15",126,"VK_F15","",""],[74,1,113,"F16",74,"F16",127,"VK_F16","",""],[75,1,114,"F17",75,"F17",128,"VK_F17","",""],[76,1,115,"F18",76,"F18",129,"VK_F18","",""],[77,1,116,"F19",77,"F19",130,"VK_F19","",""],[0,1,117,"F20",0,"",0,"VK_F20","",""],[0,1,118,"F21",0,"",0,"VK_F21","",""],[0,1,119,"F22",0,"",0,"VK_F22","",""],[0,1,120,"F23",0,"",0,"VK_F23","",""],[0,1,121,"F24",0,"",0,"VK_F24","",""],[0,1,122,"Open",0,"",0,"","",""],[0,1,123,"Help",0,"",0,"","",""],[0,1,124,"Select",0,"",0,"","",""],[0,1,125,"Again",0,"",0,"","",""],[0,1,126,"Undo",0,"",0,"","",""],[0,1,127,"Cut",0,"",0,"","",""],[0,1,128,"Copy",0,"",0,"","",""],[0,1,129,"Paste",0,"",0,"","",""],[0,1,130,"Find",0,"",0,"","",""],[0,1,131,"AudioVolumeMute",112,"AudioVolumeMute",173,"VK_VOLUME_MUTE","",""],[0,1,132,"AudioVolumeUp",113,"AudioVolumeUp",175,"VK_VOLUME_UP","",""],[0,1,133,"AudioVolumeDown",114,"AudioVolumeDown",174,"VK_VOLUME_DOWN","",""],[105,1,134,"NumpadComma",105,"NumPad_Separator",108,"VK_SEPARATOR","",""],[110,0,135,"IntlRo",110,"ABNT_C1",193,"VK_ABNT_C1","",""],[0,1,136,"KanaMode",0,"",0,"","",""],[0,0,137,"IntlYen",0,"",0,"","",""],[0,1,138,"Convert",0,"",0,"","",""],[0,1,139,"NonConvert",0,"",0,"","",""],[0,1,140,"Lang1",0,"",0,"","",""],[0,1,141,"Lang2",0,"",0,"","",""],[0,1,142,"Lang3",0,"",0,"","",""],[0,1,143,"Lang4",0,"",0,"","",""],[0,1,144,"Lang5",0,"",0,"","",""],[0,1,145,"Abort",0,"",0,"","",""],[0,1,146,"Props",0,"",0,"","",""],[0,1,147,"NumpadParenLeft",0,"",0,"","",""],[0,1,148,"NumpadParenRight",0,"",0,"","",""],[0,1,149,"NumpadBackspace",0,"",0,"","",""],[0,1,150,"NumpadMemoryStore",0,"",0,"","",""],[0,1,151,"NumpadMemoryRecall",0,"",0,"","",""],[0,1,152,"NumpadMemoryClear",0,"",0,"","",""],[0,1,153,"NumpadMemoryAdd",0,"",0,"","",""],[0,1,154,"NumpadMemorySubtract",0,"",0,"","",""],[0,1,155,"NumpadClear",126,"Clear",12,"VK_CLEAR","",""],[0,1,156,"NumpadClearEntry",0,"",0,"","",""],[5,1,0,"",5,"Ctrl",17,"VK_CONTROL","",""],[4,1,0,"",4,"Shift",16,"VK_SHIFT","",""],[6,1,0,"",6,"Alt",18,"VK_MENU","",""],[57,1,0,"",57,"Meta",0,"VK_COMMAND","",""],[5,1,157,"ControlLeft",5,"",0,"VK_LCONTROL","",""],[4,1,158,"ShiftLeft",4,"",0,"VK_LSHIFT","",""],[6,1,159,"AltLeft",6,"",0,"VK_LMENU","",""],[57,1,160,"MetaLeft",57,"",0,"VK_LWIN","",""],[5,1,161,"ControlRight",5,"",0,"VK_RCONTROL","",""],[4,1,162,"ShiftRight",4,"",0,"VK_RSHIFT","",""],[6,1,163,"AltRight",6,"",0,"VK_RMENU","",""],[57,1,164,"MetaRight",57,"",0,"VK_RWIN","",""],[0,1,165,"BrightnessUp",0,"",0,"","",""],[0,1,166,"BrightnessDown",0,"",0,"","",""],[0,1,167,"MediaPlay",0,"",0,"","",""],[0,1,168,"MediaRecord",0,"",0,"","",""],[0,1,169,"MediaFastForward",0,"",0,"","",""],[0,1,170,"MediaRewind",0,"",0,"","",""],[114,1,171,"MediaTrackNext",119,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK","",""],[115,1,172,"MediaTrackPrevious",120,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK","",""],[116,1,173,"MediaStop",121,"MediaStop",178,"VK_MEDIA_STOP","",""],[0,1,174,"Eject",0,"",0,"","",""],[117,1,175,"MediaPlayPause",122,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE","",""],[0,1,176,"MediaSelect",123,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT","",""],[0,1,177,"LaunchMail",124,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL","",""],[0,1,178,"LaunchApp2",125,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2","",""],[0,1,179,"LaunchApp1",0,"",0,"VK_MEDIA_LAUNCH_APP1","",""],[0,1,180,"SelectTask",0,"",0,"","",""],[0,1,181,"LaunchScreenSaver",0,"",0,"","",""],[0,1,182,"BrowserSearch",115,"BrowserSearch",170,"VK_BROWSER_SEARCH","",""],[0,1,183,"BrowserHome",116,"BrowserHome",172,"VK_BROWSER_HOME","",""],[112,1,184,"BrowserBack",117,"BrowserBack",166,"VK_BROWSER_BACK","",""],[113,1,185,"BrowserForward",118,"BrowserForward",167,"VK_BROWSER_FORWARD","",""],[0,1,186,"BrowserStop",0,"",0,"VK_BROWSER_STOP","",""],[0,1,187,"BrowserRefresh",0,"",0,"VK_BROWSER_REFRESH","",""],[0,1,188,"BrowserFavorites",0,"",0,"VK_BROWSER_FAVORITES","",""],[0,1,189,"ZoomToggle",0,"",0,"","",""],[0,1,190,"MailReply",0,"",0,"","",""],[0,1,191,"MailForward",0,"",0,"","",""],[0,1,192,"MailSend",0,"",0,"","",""],[109,1,0,"",109,"KeyInComposition",229,"","",""],[111,1,0,"",111,"ABNT_C2",194,"VK_ABNT_C2","",""],[91,1,0,"",91,"OEM_8",223,"VK_OEM_8","",""],[0,1,0,"",0,"",0,"VK_KANA","",""],[0,1,0,"",0,"",0,"VK_HANGUL","",""],[0,1,0,"",0,"",0,"VK_JUNJA","",""],[0,1,0,"",0,"",0,"VK_FINAL","",""],[0,1,0,"",0,"",0,"VK_HANJA","",""],[0,1,0,"",0,"",0,"VK_KANJI","",""],[0,1,0,"",0,"",0,"VK_CONVERT","",""],[0,1,0,"",0,"",0,"VK_NONCONVERT","",""],[0,1,0,"",0,"",0,"VK_ACCEPT","",""],[0,1,0,"",0,"",0,"VK_MODECHANGE","",""],[0,1,0,"",0,"",0,"VK_SELECT","",""],[0,1,0,"",0,"",0,"VK_PRINT","",""],[0,1,0,"",0,"",0,"VK_EXECUTE","",""],[0,1,0,"",0,"",0,"VK_SNAPSHOT","",""],[0,1,0,"",0,"",0,"VK_HELP","",""],[0,1,0,"",0,"",0,"VK_APPS","",""],[0,1,0,"",0,"",0,"VK_PROCESSKEY","",""],[0,1,0,"",0,"",0,"VK_PACKET","",""],[0,1,0,"",0,"",0,"VK_DBE_SBCSCHAR","",""],[0,1,0,"",0,"",0,"VK_DBE_DBCSCHAR","",""],[0,1,0,"",0,"",0,"VK_ATTN","",""],[0,1,0,"",0,"",0,"VK_CRSEL","",""],[0,1,0,"",0,"",0,"VK_EXSEL","",""],[0,1,0,"",0,"",0,"VK_EREOF","",""],[0,1,0,"",0,"",0,"VK_PLAY","",""],[0,1,0,"",0,"",0,"VK_ZOOM","",""],[0,1,0,"",0,"",0,"VK_NONAME","",""],[0,1,0,"",0,"",0,"VK_PA1","",""],[0,1,0,"",0,"",0,"VK_OEM_CLEAR","",""]];let seenKeyCode=[],seenScanCode=[];for(const mapping of mappings){const[_keyCodeOrd,immutable,scanCode,scanCodeStr,keyCode,keyCodeStr,eventKeyCode,vkey,usUserSettingsLabel,generalUserSettingsLabel]=mapping;if(seenScanCode[scanCode]||(seenScanCode[scanCode]=!0,scanCodeIntToStr[scanCode]=scanCodeStr,scanCodeStrToInt[scanCodeStr]=scanCode,scanCodeLowerCaseStrToInt[scanCodeStr.toLowerCase()]=scanCode,immutable&&(exports.IMMUTABLE_CODE_TO_KEY_CODE[scanCode]=keyCode,0!==keyCode&&3!==keyCode&&5!==keyCode&&4!==keyCode&&6!==keyCode&&57!==keyCode&&(exports.IMMUTABLE_KEY_CODE_TO_CODE[keyCode]=scanCode))),!seenKeyCode[keyCode]){if(seenKeyCode[keyCode]=!0,!keyCodeStr)throw new Error(`String representation missing for key code ${keyCode} around scan code ${scanCodeStr}`);uiMap.define(keyCode,keyCodeStr),userSettingsUSMap.define(keyCode,usUserSettingsLabel||keyCodeStr),userSettingsGeneralMap.define(keyCode,generalUserSettingsLabel||usUserSettingsLabel||keyCodeStr)}eventKeyCode&&(exports.EVENT_KEY_CODE_MAP[eventKeyCode]=keyCode),vkey&&(exports.NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE[vkey]=keyCode)}exports.IMMUTABLE_KEY_CODE_TO_CODE[3]=46}(),function(KeyCodeUtils){KeyCodeUtils.toString=function toString(keyCode){return uiMap.keyCodeToStr(keyCode)},KeyCodeUtils.fromString=function fromString(key){return uiMap.strToKeyCode(key)},KeyCodeUtils.toUserSettingsUS=function toUserSettingsUS(keyCode){return userSettingsUSMap.keyCodeToStr(keyCode)},KeyCodeUtils.toUserSettingsGeneral=function toUserSettingsGeneral(keyCode){return userSettingsGeneralMap.keyCodeToStr(keyCode)},KeyCodeUtils.fromUserSettings=function fromUserSettings(key){return userSettingsUSMap.strToKeyCode(key)||userSettingsGeneralMap.strToKeyCode(key)},KeyCodeUtils.toElectronAccelerator=function toElectronAccelerator(keyCode){if(keyCode>=93&&keyCode<=108)return null;switch(keyCode){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return uiMap.keyCodeToStr(keyCode)}}(exports.KeyCodeUtils||(exports.KeyCodeUtils={})),exports.KeyChord=function KeyChord(firstPart,secondPart){return(firstPart|(65535&secondPart)<<16>>>0)>>>0}})),define(__m[96],__M([1,0,13]),(function(require,exports,errors_1){"use strict";function createSimpleKeybinding(keybinding,OS){const ctrlCmd=!!(2048&keybinding),winCtrl=!!(256&keybinding);return new SimpleKeybinding(2===OS?winCtrl:ctrlCmd,!!(1024&keybinding),!!(512&keybinding),2===OS?ctrlCmd:winCtrl,255&keybinding)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResolvedKeybinding=exports.ResolvedKeybindingPart=exports.ScanCodeBinding=exports.ChordKeybinding=exports.SimpleKeybinding=exports.createSimpleKeybinding=exports.createKeybinding=void 0,exports.createKeybinding=function createKeybinding(keybinding,OS){if(0===keybinding)return null;const firstPart=(65535&keybinding)>>>0,chordPart=(4294901760&keybinding)>>>16;return new ChordKeybinding(0!==chordPart?[createSimpleKeybinding(firstPart,OS),createSimpleKeybinding(chordPart,OS)]:[createSimpleKeybinding(firstPart,OS)])},exports.createSimpleKeybinding=createSimpleKeybinding;class SimpleKeybinding{constructor(ctrlKey,shiftKey,altKey,metaKey,keyCode){this.ctrlKey=ctrlKey,this.shiftKey=shiftKey,this.altKey=altKey,this.metaKey=metaKey,this.keyCode=keyCode}equals(other){return this.ctrlKey===other.ctrlKey&&this.shiftKey===other.shiftKey&&this.altKey===other.altKey&&this.metaKey===other.metaKey&&this.keyCode===other.keyCode}isModifierKey(){return 0===this.keyCode||5===this.keyCode||57===this.keyCode||6===this.keyCode||4===this.keyCode}toChord(){return new ChordKeybinding([this])}isDuplicateModifierCase(){return this.ctrlKey&&5===this.keyCode||this.shiftKey&&4===this.keyCode||this.altKey&&6===this.keyCode||this.metaKey&&57===this.keyCode}}exports.SimpleKeybinding=SimpleKeybinding;class ChordKeybinding{constructor(parts){if(0===parts.length)throw(0,errors_1.illegalArgument)("parts");this.parts=parts}}exports.ChordKeybinding=ChordKeybinding;exports.ScanCodeBinding=class ScanCodeBinding{constructor(ctrlKey,shiftKey,altKey,metaKey,scanCode){this.ctrlKey=ctrlKey,this.shiftKey=shiftKey,this.altKey=altKey,this.metaKey=metaKey,this.scanCode=scanCode}isDuplicateModifierCase(){return this.ctrlKey&&(157===this.scanCode||161===this.scanCode)||this.shiftKey&&(158===this.scanCode||162===this.scanCode)||this.altKey&&(159===this.scanCode||163===this.scanCode)||this.metaKey&&(160===this.scanCode||164===this.scanCode)}};exports.ResolvedKeybindingPart=class ResolvedKeybindingPart{constructor(ctrlKey,shiftKey,altKey,metaKey,kbLabel,kbAriaLabel){this.ctrlKey=ctrlKey,this.shiftKey=shiftKey,this.altKey=altKey,this.metaKey=metaKey,this.keyLabel=kbLabel,this.keyAriaLabel=kbAriaLabel}};exports.ResolvedKeybinding=class ResolvedKeybinding{}})),define(__m[137],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Lazy=void 0;exports.Lazy=class Lazy{constructor(executor){this.executor=executor,this._didRun=!1}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(err){this._error=err}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}})),define(__m[2],__M([1,0,91,57]),(function(require,exports,functional_1,iterator_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImmortalReference=exports.SafeDisposable=exports.MutableDisposable=exports.Disposable=exports.DisposableStore=exports.toDisposable=exports.combinedDisposable=exports.dispose=exports.isDisposable=exports.MultiDisposeError=exports.markAsSingleton=exports.setDisposableTracker=void 0;let disposableTracker=null;function setDisposableTracker(tracker){disposableTracker=tracker}function trackDisposable(x){return null==disposableTracker||disposableTracker.trackDisposable(x),x}function markAsDisposed(disposable){null==disposableTracker||disposableTracker.markAsDisposed(disposable)}function setParentOfDisposable(child,parent){null==disposableTracker||disposableTracker.setParent(child,parent)}exports.setDisposableTracker=setDisposableTracker,exports.markAsSingleton=function markAsSingleton(singleton){return null==disposableTracker||disposableTracker.markAsSingleton(singleton),singleton};class MultiDisposeError extends Error{constructor(errors){super(`Encountered errors while disposing of store. Errors: [${errors.join(", ")}]`),this.errors=errors}}function dispose(arg){if(iterator_1.Iterable.is(arg)){let errors=[];for(const d of arg)if(d)try{d.dispose()}catch(e){errors.push(e)}if(1===errors.length)throw errors[0];if(errors.length>1)throw new MultiDisposeError(errors);return Array.isArray(arg)?[]:arg}if(arg)return arg.dispose(),arg}function toDisposable(fn){const self=trackDisposable({dispose:(0,functional_1.once)((()=>{markAsDisposed(self),fn()}))});return self}exports.MultiDisposeError=MultiDisposeError,exports.isDisposable=function isDisposable(thing){return"function"==typeof thing.dispose&&0===thing.dispose.length},exports.dispose=dispose,exports.combinedDisposable=function combinedDisposable(...disposables){const parent=toDisposable((()=>dispose(disposables)));return function setParentOfDisposables(children,parent){if(disposableTracker)for(const child of children)disposableTracker.setParent(child,parent)}(disposables,parent),parent},exports.toDisposable=toDisposable;class DisposableStore{constructor(){this._toDispose=new Set,this._isDisposed=!1,trackDisposable(this)}dispose(){this._isDisposed||(markAsDisposed(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){try{dispose(this._toDispose.values())}finally{this._toDispose.clear()}}add(o){if(!o)return o;if(o===this)throw new Error("Cannot register a disposable on itself!");return setParentOfDisposable(o,this),this._isDisposed?DisposableStore.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(o),o}}exports.DisposableStore=DisposableStore,DisposableStore.DISABLE_DISPOSED_WARNING=!1;class Disposable{constructor(){this._store=new DisposableStore,trackDisposable(this),setParentOfDisposable(this._store,this)}dispose(){markAsDisposed(this),this._store.dispose()}_register(o){if(o===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(o)}}exports.Disposable=Disposable,Disposable.None=Object.freeze({dispose(){}});exports.MutableDisposable=class MutableDisposable{constructor(){this._isDisposed=!1,trackDisposable(this)}get value(){return this._isDisposed?void 0:this._value}set value(value){var _a;this._isDisposed||value===this._value||(null===(_a=this._value)||void 0===_a||_a.dispose(),value&&setParentOfDisposable(value,this),this._value=value)}clear(){this.value=void 0}dispose(){var _a;this._isDisposed=!0,markAsDisposed(this),null===(_a=this._value)||void 0===_a||_a.dispose(),this._value=void 0}clearAndLeak(){const oldValue=this._value;return this._value=void 0,oldValue&&setParentOfDisposable(oldValue,null),oldValue}};exports.SafeDisposable=class SafeDisposable{constructor(){this.dispose=()=>{},this.unset=()=>{},this.isset=()=>!1,trackDisposable(this)}set(fn){let callback=fn;return this.unset=()=>callback=void 0,this.isset=()=>void 0!==callback,this.dispose=()=>{callback&&(callback(),callback=void 0,markAsDisposed(this))},this}};exports.ImmortalReference=class ImmortalReference{constructor(object){this.object=object}dispose(){}}})),define(__m[83],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LinkedList=void 0;class Node{constructor(element){this.element=element,this.next=Node.Undefined,this.prev=Node.Undefined}}Node.Undefined=new Node(void 0);class LinkedList{constructor(){this._first=Node.Undefined,this._last=Node.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Node.Undefined}clear(){let node=this._first;for(;node!==Node.Undefined;){const next=node.next;node.prev=Node.Undefined,node.next=Node.Undefined,node=next}this._first=Node.Undefined,this._last=Node.Undefined,this._size=0}unshift(element){return this._insert(element,!1)}push(element){return this._insert(element,!0)}_insert(element,atTheEnd){const newNode=new Node(element);if(this._first===Node.Undefined)this._first=newNode,this._last=newNode;else if(atTheEnd){const oldLast=this._last;this._last=newNode,newNode.prev=oldLast,oldLast.next=newNode}else{const oldFirst=this._first;this._first=newNode,newNode.next=oldFirst,oldFirst.prev=newNode}this._size+=1;let didRemove=!1;return()=>{didRemove||(didRemove=!0,this._remove(newNode))}}shift(){if(this._first!==Node.Undefined){const res=this._first.element;return this._remove(this._first),res}}pop(){if(this._last!==Node.Undefined){const res=this._last.element;return this._remove(this._last),res}}_remove(node){if(node.prev!==Node.Undefined&&node.next!==Node.Undefined){const anchor=node.prev;anchor.next=node.next,node.next.prev=anchor}else node.prev===Node.Undefined&&node.next===Node.Undefined?(this._first=Node.Undefined,this._last=Node.Undefined):node.next===Node.Undefined?(this._last=this._last.prev,this._last.next=Node.Undefined):node.prev===Node.Undefined&&(this._first=this._first.next,this._first.prev=Node.Undefined);this._size-=1}*[Symbol.iterator](){let node=this._first;for(;node!==Node.Undefined;)yield node.element,node=node.next}}exports.LinkedList=LinkedList})),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(__m[314],__M([0]),factory):factory((global="undefined"!=typeof globalThis?globalThis:global||self).marked={})}(this,(function(exports){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function getDefaults(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}exports.defaults={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};var escapeTest=/[&<>"']/,escapeReplace=/[&<>"']/g,escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g,escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=function getEscapeReplacement(ch){return escapeReplacements[ch]};function escape(html,encode){if(encode){if(escapeTest.test(html))return html.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(html))return html.replace(escapeReplaceNoEncode,getEscapeReplacement);return html}var unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function unescape(html){return html.replace(unescapeTest,(function(_,n){return"colon"===(n=n.toLowerCase())?":":"#"===n.charAt(0)?"x"===n.charAt(1)?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""}))}var caret=/(^|[^\[])\^/g;function edit(regex,opt){regex=regex.source||regex,opt=opt||"";var obj={replace:function replace(name,val){return val=(val=val.source||val).replace(caret,"$1"),regex=regex.replace(name,val),obj},getRegex:function getRegex(){return new RegExp(regex,opt)}};return obj}var nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(sanitize,base,href){if(sanitize){var prot;try{prot=decodeURIComponent(unescape(href)).replace(nonWordAndColonTest,"").toLowerCase()}catch(e){return null}if(0===prot.indexOf("javascript:")||0===prot.indexOf("vbscript:")||0===prot.indexOf("data:"))return null}base&&!originIndependentUrl.test(href)&&(href=function resolveUrl(base,href){baseUrls[" "+base]||(justDomain.test(base)?baseUrls[" "+base]=base+"/":baseUrls[" "+base]=rtrim(base,"/",!0));var relativeBase=-1===(base=baseUrls[" "+base]).indexOf(":");return"//"===href.substring(0,2)?relativeBase?href:base.replace(protocol,"$1")+href:"/"===href.charAt(0)?relativeBase?href:base.replace(domain,"$1")+href:base+href}(base,href));try{href=encodeURI(href).replace(/%25/g,"%")}catch(e){return null}return href}var baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;var noopTest={exec:function noopTest(){}};function merge(obj){for(var target,key,i=1;i<arguments.length;i++)for(key in target=arguments[i])Object.prototype.hasOwnProperty.call(target,key)&&(obj[key]=target[key]);return obj}function splitCells(tableRow,count){var cells=tableRow.replace(/\|/g,(function(match,offset,str){for(var escaped=!1,curr=offset;--curr>=0&&"\\"===str[curr];)escaped=!escaped;return escaped?"|":" |"})).split(/ \|/),i=0;if(cells[0].trim()||cells.shift(),cells[cells.length-1].trim()||cells.pop(),cells.length>count)cells.splice(count);else for(;cells.length<count;)cells.push("");for(;i<cells.length;i++)cells[i]=cells[i].trim().replace(/\\\|/g,"|");return cells}function rtrim(str,c,invert){var l=str.length;if(0===l)return"";for(var suffLen=0;suffLen<l;){var currChar=str.charAt(l-suffLen-1);if(currChar!==c||invert){if(currChar===c||!invert)break;suffLen++}else suffLen++}return str.substr(0,l-suffLen)}function checkSanitizeDeprecation(opt){opt&&opt.sanitize&&!opt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(pattern,count){if(count<1)return"";for(var result="";count>1;)1&count&&(result+=pattern),count>>=1,pattern+=pattern;return result+pattern}function outputLink(cap,link,raw,lexer){var href=link.href,title=link.title?escape(link.title):null,text=cap[1].replace(/\\([\[\]])/g,"$1");if("!"!==cap[0].charAt(0)){lexer.state.inLink=!0;var token={type:"link",raw,href,title,text,tokens:lexer.inlineTokens(text,[])};return lexer.state.inLink=!1,token}return{type:"image",raw,href,title,text:escape(text)}}var Tokenizer=function(){function Tokenizer(options){this.options=options||exports.defaults}var _proto=Tokenizer.prototype;return _proto.space=function space(src){var cap=this.rules.block.newline.exec(src);if(cap&&cap[0].length>0)return{type:"space",raw:cap[0]}},_proto.code=function code(src){var cap=this.rules.block.code.exec(src);if(cap){var text=cap[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:cap[0],codeBlockStyle:"indented",text:this.options.pedantic?text:rtrim(text,"\n")}}},_proto.fences=function fences(src){var cap=this.rules.block.fences.exec(src);if(cap){var raw=cap[0],text=function indentCodeCompensation(raw,text){var matchIndentToCode=raw.match(/^(\s+)(?:```)/);if(null===matchIndentToCode)return text;var indentToCode=matchIndentToCode[1];return text.split("\n").map((function(node){var matchIndentInNode=node.match(/^\s+/);return null===matchIndentInNode?node:matchIndentInNode[0].length>=indentToCode.length?node.slice(indentToCode.length):node})).join("\n")}(raw,cap[3]||"");return{type:"code",raw,lang:cap[2]?cap[2].trim():cap[2],text}}},_proto.heading=function heading(src){var cap=this.rules.block.heading.exec(src);if(cap){var text=cap[2].trim();if(/#$/.test(text)){var trimmed=rtrim(text,"#");this.options.pedantic?text=trimmed.trim():trimmed&&!/ $/.test(trimmed)||(text=trimmed.trim())}var token={type:"heading",raw:cap[0],depth:cap[1].length,text,tokens:[]};return this.lexer.inline(token.text,token.tokens),token}},_proto.hr=function hr(src){var cap=this.rules.block.hr.exec(src);if(cap)return{type:"hr",raw:cap[0]}},_proto.blockquote=function blockquote(src){var cap=this.rules.block.blockquote.exec(src);if(cap){var text=cap[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:cap[0],tokens:this.lexer.blockTokens(text,[]),text}}},_proto.list=function list(src){var cap=this.rules.block.list.exec(src);if(cap){var raw,istask,ischecked,indent,i,blankLine,endsWithBlankLine,line,nextLine,rawLine,itemContents,endEarly,bull=cap[1].trim(),isordered=bull.length>1,list={type:"list",raw:"",ordered:isordered,start:isordered?+bull.slice(0,-1):"",loose:!1,items:[]};bull=isordered?"\\d{1,9}\\"+bull.slice(-1):"\\"+bull,this.options.pedantic&&(bull=isordered?bull:"[*+-]");for(var itemRegex=new RegExp("^( {0,3}"+bull+")((?: [^\\n]*)?(?:\\n|$))");src&&(endEarly=!1,cap=itemRegex.exec(src))&&!this.rules.block.hr.test(src);){if(raw=cap[0],src=src.substring(raw.length),line=cap[2].split("\n",1)[0],nextLine=src.split("\n",1)[0],this.options.pedantic?(indent=2,itemContents=line.trimLeft()):(indent=(indent=cap[2].search(/[^ ]/))>4?1:indent,itemContents=line.slice(indent),indent+=cap[1].length),blankLine=!1,!line&&/^ *$/.test(nextLine)&&(raw+=nextLine+"\n",src=src.substring(nextLine.length+1),endEarly=!0),!endEarly)for(var nextBulletRegex=new RegExp("^ {0,"+Math.min(3,indent-1)+"}(?:[*+-]|\\d{1,9}[.)])");src&&(line=rawLine=src.split("\n",1)[0],this.options.pedantic&&(line=line.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!nextBulletRegex.test(line));){if(line.search(/[^ ]/)>=indent||!line.trim())itemContents+="\n"+line.slice(indent);else{if(blankLine)break;itemContents+="\n"+line}blankLine||line.trim()||(blankLine=!0),raw+=rawLine+"\n",src=src.substring(rawLine.length+1)}list.loose||(endsWithBlankLine?list.loose=!0:/\n *\n *$/.test(raw)&&(endsWithBlankLine=!0)),this.options.gfm&&(istask=/^\[[ xX]\] /.exec(itemContents))&&(ischecked="[ ] "!==istask[0],itemContents=itemContents.replace(/^\[[ xX]\] +/,"")),list.items.push({type:"list_item",raw,task:!!istask,checked:ischecked,loose:!1,text:itemContents}),list.raw+=raw}list.items[list.items.length-1].raw=raw.trimRight(),list.items[list.items.length-1].text=itemContents.trimRight(),list.raw=list.raw.trimRight();var l=list.items.length;for(i=0;i<l;i++){this.lexer.state.top=!1,list.items[i].tokens=this.lexer.blockTokens(list.items[i].text,[]);var spacers=list.items[i].tokens.filter((function(t){return"space"===t.type})),hasMultipleLineBreaks=spacers.every((function(t){for(var _step,lineBreaks=0,_iterator=_createForOfIteratorHelperLoose(t.raw.split(""));!(_step=_iterator()).done;){if("\n"===_step.value&&(lineBreaks+=1),lineBreaks>1)return!0}return!1}));!list.loose&&spacers.length&&hasMultipleLineBreaks&&(list.loose=!0,list.items[i].loose=!0)}return list}},_proto.html=function html(src){var cap=this.rules.block.html.exec(src);if(cap){var token={type:"html",raw:cap[0],pre:!this.options.sanitizer&&("pre"===cap[1]||"script"===cap[1]||"style"===cap[1]),text:cap[0]};return this.options.sanitize&&(token.type="paragraph",token.text=this.options.sanitizer?this.options.sanitizer(cap[0]):escape(cap[0]),token.tokens=[],this.lexer.inline(token.text,token.tokens)),token}},_proto.def=function def(src){var cap=this.rules.block.def.exec(src);if(cap)return cap[3]&&(cap[3]=cap[3].substring(1,cap[3].length-1)),{type:"def",tag:cap[1].toLowerCase().replace(/\s+/g," "),raw:cap[0],href:cap[2],title:cap[3]}},_proto.table=function table(src){var cap=this.rules.block.table.exec(src);if(cap){var item={type:"table",header:splitCells(cap[1]).map((function(c){return{text:c}})),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:cap[3]?cap[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(item.header.length===item.align.length){item.raw=cap[0];var i,j,k,row,l=item.align.length;for(i=0;i<l;i++)/^ *-+: *$/.test(item.align[i])?item.align[i]="right":/^ *:-+: *$/.test(item.align[i])?item.align[i]="center":/^ *:-+ *$/.test(item.align[i])?item.align[i]="left":item.align[i]=null;for(l=item.rows.length,i=0;i<l;i++)item.rows[i]=splitCells(item.rows[i],item.header.length).map((function(c){return{text:c}}));for(l=item.header.length,j=0;j<l;j++)item.header[j].tokens=[],this.lexer.inlineTokens(item.header[j].text,item.header[j].tokens);for(l=item.rows.length,j=0;j<l;j++)for(row=item.rows[j],k=0;k<row.length;k++)row[k].tokens=[],this.lexer.inlineTokens(row[k].text,row[k].tokens);return item}}},_proto.lheading=function lheading(src){var cap=this.rules.block.lheading.exec(src);if(cap){var token={type:"heading",raw:cap[0],depth:"="===cap[2].charAt(0)?1:2,text:cap[1],tokens:[]};return this.lexer.inline(token.text,token.tokens),token}},_proto.paragraph=function paragraph(src){var cap=this.rules.block.paragraph.exec(src);if(cap){var token={type:"paragraph",raw:cap[0],text:"\n"===cap[1].charAt(cap[1].length-1)?cap[1].slice(0,-1):cap[1],tokens:[]};return this.lexer.inline(token.text,token.tokens),token}},_proto.text=function text(src){var cap=this.rules.block.text.exec(src);if(cap){var token={type:"text",raw:cap[0],text:cap[0],tokens:[]};return this.lexer.inline(token.text,token.tokens),token}},_proto.escape=function escape$1(src){var cap=this.rules.inline.escape.exec(src);if(cap)return{type:"escape",raw:cap[0],text:escape(cap[1])}},_proto.tag=function tag(src){var cap=this.rules.inline.tag.exec(src);if(cap)return!this.lexer.state.inLink&&/^<a /i.test(cap[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(cap[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(cap[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(cap[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:cap[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(cap[0]):escape(cap[0]):cap[0]}},_proto.link=function link(src){var cap=this.rules.inline.link.exec(src);if(cap){var trimmedUrl=cap[2].trim();if(!this.options.pedantic&&/^</.test(trimmedUrl)){if(!/>$/.test(trimmedUrl))return;var rtrimSlash=rtrim(trimmedUrl.slice(0,-1),"\\");if((trimmedUrl.length-rtrimSlash.length)%2==0)return}else{var lastParenIndex=function findClosingBracket(str,b){if(-1===str.indexOf(b[1]))return-1;for(var l=str.length,level=0,i=0;i<l;i++)if("\\"===str[i])i++;else if(str[i]===b[0])level++;else if(str[i]===b[1]&&--level<0)return i;return-1}(cap[2],"()");if(lastParenIndex>-1){var linkLen=(0===cap[0].indexOf("!")?5:4)+cap[1].length+lastParenIndex;cap[2]=cap[2].substring(0,lastParenIndex),cap[0]=cap[0].substring(0,linkLen).trim(),cap[3]=""}}var href=cap[2],title="";if(this.options.pedantic){var link=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(href);link&&(href=link[1],title=link[3])}else title=cap[3]?cap[3].slice(1,-1):"";return href=href.trim(),/^</.test(href)&&(href=this.options.pedantic&&!/>$/.test(trimmedUrl)?href.slice(1):href.slice(1,-1)),outputLink(cap,{href:href?href.replace(this.rules.inline._escapes,"$1"):href,title:title?title.replace(this.rules.inline._escapes,"$1"):title},cap[0],this.lexer)}},_proto.reflink=function reflink(src,links){var cap;if((cap=this.rules.inline.reflink.exec(src))||(cap=this.rules.inline.nolink.exec(src))){var link=(cap[2]||cap[1]).replace(/\s+/g," ");if(!(link=links[link.toLowerCase()])||!link.href){var text=cap[0].charAt(0);return{type:"text",raw:text,text}}return outputLink(cap,link,cap[0],this.lexer)}},_proto.emStrong=function emStrong(src,maskedSrc,prevChar){void 0===prevChar&&(prevChar="");var match=this.rules.inline.emStrong.lDelim.exec(src);if(match&&(!match[3]||!prevChar.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var nextChar=match[1]||match[2]||"";if(!nextChar||nextChar&&(""===prevChar||this.rules.inline.punctuation.exec(prevChar))){var rDelim,rLength,lLength=match[0].length-1,delimTotal=lLength,midDelimTotal=0,endReg="*"===match[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(endReg.lastIndex=0,maskedSrc=maskedSrc.slice(-1*src.length+lLength);null!=(match=endReg.exec(maskedSrc));)if(rDelim=match[1]||match[2]||match[3]||match[4]||match[5]||match[6])if(rLength=rDelim.length,match[3]||match[4])delimTotal+=rLength;else if(!((match[5]||match[6])&&lLength%3)||(lLength+rLength)%3){if(!((delimTotal-=rLength)>0)){if(rLength=Math.min(rLength,rLength+delimTotal+midDelimTotal),Math.min(lLength,rLength)%2){var _text=src.slice(1,lLength+match.index+rLength);return{type:"em",raw:src.slice(0,lLength+match.index+rLength+1),text:_text,tokens:this.lexer.inlineTokens(_text,[])}}var text=src.slice(2,lLength+match.index+rLength-1);return{type:"strong",raw:src.slice(0,lLength+match.index+rLength+1),text,tokens:this.lexer.inlineTokens(text,[])}}}else midDelimTotal+=rLength}}},_proto.codespan=function codespan(src){var cap=this.rules.inline.code.exec(src);if(cap){var text=cap[2].replace(/\n/g," "),hasNonSpaceChars=/[^ ]/.test(text),hasSpaceCharsOnBothEnds=/^ /.test(text)&&/ $/.test(text);return hasNonSpaceChars&&hasSpaceCharsOnBothEnds&&(text=text.substring(1,text.length-1)),text=escape(text,!0),{type:"codespan",raw:cap[0],text}}},_proto.br=function br(src){var cap=this.rules.inline.br.exec(src);if(cap)return{type:"br",raw:cap[0]}},_proto.del=function del(src){var cap=this.rules.inline.del.exec(src);if(cap)return{type:"del",raw:cap[0],text:cap[2],tokens:this.lexer.inlineTokens(cap[2],[])}},_proto.autolink=function autolink(src,mangle){var text,href,cap=this.rules.inline.autolink.exec(src);if(cap)return href="@"===cap[2]?"mailto:"+(text=escape(this.options.mangle?mangle(cap[1]):cap[1])):text=escape(cap[1]),{type:"link",raw:cap[0],text,href,tokens:[{type:"text",raw:text,text}]}},_proto.url=function url(src,mangle){var cap;if(cap=this.rules.inline.url.exec(src)){var text,href;if("@"===cap[2])href="mailto:"+(text=escape(this.options.mangle?mangle(cap[0]):cap[0]));else{var prevCapZero;do{prevCapZero=cap[0],cap[0]=this.rules.inline._backpedal.exec(cap[0])[0]}while(prevCapZero!==cap[0]);text=escape(cap[0]),href="www."===cap[1]?"http://"+text:text}return{type:"link",raw:cap[0],text,href,tokens:[{type:"text",raw:text,text}]}}},_proto.inlineText=function inlineText(src,smartypants){var text,cap=this.rules.inline.text.exec(src);if(cap)return text=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(cap[0]):escape(cap[0]):cap[0]:escape(this.options.smartypants?smartypants(cap[0]):cap[0]),{type:"text",raw:cap[0],text}},Tokenizer}(),block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex(),block.bullet=/(?:[*+-]|\d{1,9}[.)])/,block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex(),block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex(),block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex(),block.normal=merge({},block),block.gfm=merge({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.pedantic=merge({},block.normal,{html:edit("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function smartypants(text){return text.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function mangle(text){var i,ch,out="",l=text.length;for(i=0;i<l;i++)ch=text.charCodeAt(i),Math.random()>.5&&(ch="x"+ch.toString(16)),out+="&#"+ch+";";return out}inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex(),inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,inline.escapedEmSt=/\\\*|\\_/g,inline._comment=edit(block._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex(),inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex(),inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex(),inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex(),inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex(),inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex(),inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex(),inline.normal=merge({},inline),inline.pedantic=merge({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()}),inline.gfm=merge({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex(),inline.breaks=merge({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Lexer=function(){function Lexer(options){this.tokens=[],this.tokens.links=Object.create(null),this.options=options||exports.defaults,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var rules={block:block.normal,inline:inline.normal};this.options.pedantic?(rules.block=block.pedantic,rules.inline=inline.pedantic):this.options.gfm&&(rules.block=block.gfm,this.options.breaks?rules.inline=inline.breaks:rules.inline=inline.gfm),this.tokenizer.rules=rules}Lexer.lex=function lex(src,options){return new Lexer(options).lex(src)},Lexer.lexInline=function lexInline(src,options){return new Lexer(options).inlineTokens(src)};var _proto=Lexer.prototype;return _proto.lex=function lex(src){var next;for(src=src.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(src,this.tokens);next=this.inlineQueue.shift();)this.inlineTokens(next.src,next.tokens);return this.tokens},_proto.blockTokens=function blockTokens(src,tokens){var token,lastToken,cutSrc,lastParagraphClipped,_this=this;for(void 0===tokens&&(tokens=[]),this.options.pedantic&&(src=src.replace(/^ +$/gm,""));src;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((function(extTokenizer){return!!(token=extTokenizer.call({lexer:_this},src,tokens))&&(src=src.substring(token.raw.length),tokens.push(token),!0)}))))if(token=this.tokenizer.space(src))src=src.substring(token.raw.length),1===token.raw.length&&tokens.length>0?tokens[tokens.length-1].raw+="\n":tokens.push(token);else if(token=this.tokenizer.code(src))src=src.substring(token.raw.length),!(lastToken=tokens[tokens.length-1])||"paragraph"!==lastToken.type&&"text"!==lastToken.type?tokens.push(token):(lastToken.raw+="\n"+token.raw,lastToken.text+="\n"+token.text,this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text);else if(token=this.tokenizer.fences(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.heading(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.hr(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.blockquote(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.list(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.html(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.def(src))src=src.substring(token.raw.length),!(lastToken=tokens[tokens.length-1])||"paragraph"!==lastToken.type&&"text"!==lastToken.type?this.tokens.links[token.tag]||(this.tokens.links[token.tag]={href:token.href,title:token.title}):(lastToken.raw+="\n"+token.raw,lastToken.text+="\n"+token.raw,this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text);else if(token=this.tokenizer.table(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.lheading(src))src=src.substring(token.raw.length),tokens.push(token);else if(cutSrc=src,this.options.extensions&&this.options.extensions.startBlock&&function(){var startIndex=1/0,tempSrc=src.slice(1),tempStart=void 0;_this.options.extensions.startBlock.forEach((function(getStartIndex){"number"==typeof(tempStart=getStartIndex.call({lexer:this},tempSrc))&&tempStart>=0&&(startIndex=Math.min(startIndex,tempStart))})),startIndex<1/0&&startIndex>=0&&(cutSrc=src.substring(0,startIndex+1))}(),this.state.top&&(token=this.tokenizer.paragraph(cutSrc)))lastToken=tokens[tokens.length-1],lastParagraphClipped&&"paragraph"===lastToken.type?(lastToken.raw+="\n"+token.raw,lastToken.text+="\n"+token.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text):tokens.push(token),lastParagraphClipped=cutSrc.length!==src.length,src=src.substring(token.raw.length);else if(token=this.tokenizer.text(src))src=src.substring(token.raw.length),(lastToken=tokens[tokens.length-1])&&"text"===lastToken.type?(lastToken.raw+="\n"+token.raw,lastToken.text+="\n"+token.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=lastToken.text):tokens.push(token);else if(src){var errMsg="Infinite loop on byte: "+src.charCodeAt(0);if(this.options.silent){console.error(errMsg);break}throw new Error(errMsg)}return this.state.top=!0,tokens},_proto.inline=function inline(src,tokens){this.inlineQueue.push({src,tokens})},_proto.inlineTokens=function inlineTokens(src,tokens){var token,lastToken,cutSrc,_this2=this;void 0===tokens&&(tokens=[]);var match,keepPrevChar,prevChar,maskedSrc=src;if(this.tokens.links){var links=Object.keys(this.tokens.links);if(links.length>0)for(;null!=(match=this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc));)links.includes(match[0].slice(match[0].lastIndexOf("[")+1,-1))&&(maskedSrc=maskedSrc.slice(0,match.index)+"["+repeatString("a",match[0].length-2)+"]"+maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(match=this.tokenizer.rules.inline.blockSkip.exec(maskedSrc));)maskedSrc=maskedSrc.slice(0,match.index)+"["+repeatString("a",match[0].length-2)+"]"+maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(match=this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc));)maskedSrc=maskedSrc.slice(0,match.index)+"++"+maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;src;)if(keepPrevChar||(prevChar=""),keepPrevChar=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((function(extTokenizer){return!!(token=extTokenizer.call({lexer:_this2},src,tokens))&&(src=src.substring(token.raw.length),tokens.push(token),!0)}))))if(token=this.tokenizer.escape(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.tag(src))src=src.substring(token.raw.length),(lastToken=tokens[tokens.length-1])&&"text"===token.type&&"text"===lastToken.type?(lastToken.raw+=token.raw,lastToken.text+=token.text):tokens.push(token);else if(token=this.tokenizer.link(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.reflink(src,this.tokens.links))src=src.substring(token.raw.length),(lastToken=tokens[tokens.length-1])&&"text"===token.type&&"text"===lastToken.type?(lastToken.raw+=token.raw,lastToken.text+=token.text):tokens.push(token);else if(token=this.tokenizer.emStrong(src,maskedSrc,prevChar))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.codespan(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.br(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.del(src))src=src.substring(token.raw.length),tokens.push(token);else if(token=this.tokenizer.autolink(src,mangle))src=src.substring(token.raw.length),tokens.push(token);else if(this.state.inLink||!(token=this.tokenizer.url(src,mangle))){if(cutSrc=src,this.options.extensions&&this.options.extensions.startInline&&function(){var startIndex=1/0,tempSrc=src.slice(1),tempStart=void 0;_this2.options.extensions.startInline.forEach((function(getStartIndex){"number"==typeof(tempStart=getStartIndex.call({lexer:this},tempSrc))&&tempStart>=0&&(startIndex=Math.min(startIndex,tempStart))})),startIndex<1/0&&startIndex>=0&&(cutSrc=src.substring(0,startIndex+1))}(),token=this.tokenizer.inlineText(cutSrc,smartypants))src=src.substring(token.raw.length),"_"!==token.raw.slice(-1)&&(prevChar=token.raw.slice(-1)),keepPrevChar=!0,(lastToken=tokens[tokens.length-1])&&"text"===lastToken.type?(lastToken.raw+=token.raw,lastToken.text+=token.text):tokens.push(token);else if(src){var errMsg="Infinite loop on byte: "+src.charCodeAt(0);if(this.options.silent){console.error(errMsg);break}throw new Error(errMsg)}}else src=src.substring(token.raw.length),tokens.push(token);return tokens},function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Lexer,null,[{key:"rules",get:function get(){return{block,inline}}}]),Lexer}(),Renderer=function(){function Renderer(options){this.options=options||exports.defaults}var _proto=Renderer.prototype;return _proto.code=function code(_code,infostring,escaped){var lang=(infostring||"").match(/\S*/)[0];if(this.options.highlight){var out=this.options.highlight(_code,lang);null!=out&&out!==_code&&(escaped=!0,_code=out)}return _code=_code.replace(/\n$/,"")+"\n",lang?'<pre><code class="'+this.options.langPrefix+escape(lang,!0)+'">'+(escaped?_code:escape(_code,!0))+"</code></pre>\n":"<pre><code>"+(escaped?_code:escape(_code,!0))+"</code></pre>\n"},_proto.blockquote=function blockquote(quote){return"<blockquote>\n"+quote+"</blockquote>\n"},_proto.html=function html(_html){return _html},_proto.heading=function heading(text,level,raw,slugger){return this.options.headerIds?"<h"+level+' id="'+this.options.headerPrefix+slugger.slug(raw)+'">'+text+"</h"+level+">\n":"<h"+level+">"+text+"</h"+level+">\n"},_proto.hr=function hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},_proto.list=function list(body,ordered,start){var type=ordered?"ol":"ul";return"<"+type+(ordered&&1!==start?' start="'+start+'"':"")+">\n"+body+"</"+type+">\n"},_proto.listitem=function listitem(text){return"<li>"+text+"</li>\n"},_proto.checkbox=function checkbox(checked){return"<input "+(checked?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},_proto.paragraph=function paragraph(text){return"<p>"+text+"</p>\n"},_proto.table=function table(header,body){return body&&(body="<tbody>"+body+"</tbody>"),"<table>\n<thead>\n"+header+"</thead>\n"+body+"</table>\n"},_proto.tablerow=function tablerow(content){return"<tr>\n"+content+"</tr>\n"},_proto.tablecell=function tablecell(content,flags){var type=flags.header?"th":"td";return(flags.align?"<"+type+' align="'+flags.align+'">':"<"+type+">")+content+"</"+type+">\n"},_proto.strong=function strong(text){return"<strong>"+text+"</strong>"},_proto.em=function em(text){return"<em>"+text+"</em>"},_proto.codespan=function codespan(text){return"<code>"+text+"</code>"},_proto.br=function br(){return this.options.xhtml?"<br/>":"<br>"},_proto.del=function del(text){return"<del>"+text+"</del>"},_proto.link=function link(href,title,text){if(null===(href=cleanUrl(this.options.sanitize,this.options.baseUrl,href)))return text;var out='<a href="'+escape(href)+'"';return title&&(out+=' title="'+title+'"'),out+=">"+text+"</a>"},_proto.image=function image(href,title,text){if(null===(href=cleanUrl(this.options.sanitize,this.options.baseUrl,href)))return text;var out='<img src="'+href+'" alt="'+text+'"';return title&&(out+=' title="'+title+'"'),out+=this.options.xhtml?"/>":">"},_proto.text=function text(_text){return _text},Renderer}(),TextRenderer=function(){function TextRenderer(){}var _proto=TextRenderer.prototype;return _proto.strong=function strong(text){return text},_proto.em=function em(text){return text},_proto.codespan=function codespan(text){return text},_proto.del=function del(text){return text},_proto.html=function html(text){return text},_proto.text=function text(_text){return _text},_proto.link=function link(href,title,text){return""+text},_proto.image=function image(href,title,text){return""+text},_proto.br=function br(){return""},TextRenderer}(),Slugger=function(){function Slugger(){this.seen={}}var _proto=Slugger.prototype;return _proto.serialize=function serialize(value){return value.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},_proto.getNextSafeSlug=function getNextSafeSlug(originalSlug,isDryRun){var slug=originalSlug,occurenceAccumulator=0;if(this.seen.hasOwnProperty(slug)){occurenceAccumulator=this.seen[originalSlug];do{slug=originalSlug+"-"+ ++occurenceAccumulator}while(this.seen.hasOwnProperty(slug))}return isDryRun||(this.seen[originalSlug]=occurenceAccumulator,this.seen[slug]=0),slug},_proto.slug=function slug(value,options){void 0===options&&(options={});var slug=this.serialize(value);return this.getNextSafeSlug(slug,options.dryrun)},Slugger}(),Parser=function(){function Parser(options){this.options=options||exports.defaults,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}Parser.parse=function parse(tokens,options){return new Parser(options).parse(tokens)},Parser.parseInline=function parseInline(tokens,options){return new Parser(options).parseInline(tokens)};var _proto=Parser.prototype;return _proto.parse=function parse(tokens,top){void 0===top&&(top=!0);var i,j,k,l2,l3,row,cell,header,body,token,ordered,start,loose,itemBody,item,checked,task,checkbox,ret,out="",l=tokens.length;for(i=0;i<l;i++)if(token=tokens[i],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[token.type])||!1===(ret=this.options.extensions.renderers[token.type].call({parser:this},token))&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(token.type))switch(token.type){case"space":continue;case"hr":out+=this.renderer.hr();continue;case"heading":out+=this.renderer.heading(this.parseInline(token.tokens),token.depth,unescape(this.parseInline(token.tokens,this.textRenderer)),this.slugger);continue;case"code":out+=this.renderer.code(token.text,token.lang,token.escaped);continue;case"table":for(header="",cell="",l2=token.header.length,j=0;j<l2;j++)cell+=this.renderer.tablecell(this.parseInline(token.header[j].tokens),{header:!0,align:token.align[j]});for(header+=this.renderer.tablerow(cell),body="",l2=token.rows.length,j=0;j<l2;j++){for(cell="",l3=(row=token.rows[j]).length,k=0;k<l3;k++)cell+=this.renderer.tablecell(this.parseInline(row[k].tokens),{header:!1,align:token.align[k]});body+=this.renderer.tablerow(cell)}out+=this.renderer.table(header,body);continue;case"blockquote":body=this.parse(token.tokens),out+=this.renderer.blockquote(body);continue;case"list":for(ordered=token.ordered,start=token.start,loose=token.loose,l2=token.items.length,body="",j=0;j<l2;j++)checked=(item=token.items[j]).checked,task=item.task,itemBody="",item.task&&(checkbox=this.renderer.checkbox(checked),loose?item.tokens.length>0&&"paragraph"===item.tokens[0].type?(item.tokens[0].text=checkbox+" "+item.tokens[0].text,item.tokens[0].tokens&&item.tokens[0].tokens.length>0&&"text"===item.tokens[0].tokens[0].type&&(item.tokens[0].tokens[0].text=checkbox+" "+item.tokens[0].tokens[0].text)):item.tokens.unshift({type:"text",text:checkbox}):itemBody+=checkbox),itemBody+=this.parse(item.tokens,loose),body+=this.renderer.listitem(itemBody,task,checked);out+=this.renderer.list(body,ordered,start);continue;case"html":out+=this.renderer.html(token.text);continue;case"paragraph":out+=this.renderer.paragraph(this.parseInline(token.tokens));continue;case"text":for(body=token.tokens?this.parseInline(token.tokens):token.text;i+1<l&&"text"===tokens[i+1].type;)body+="\n"+((token=tokens[++i]).tokens?this.parseInline(token.tokens):token.text);out+=top?this.renderer.paragraph(body):body;continue;default:var errMsg='Token with "'+token.type+'" type was not found.';if(this.options.silent)return void console.error(errMsg);throw new Error(errMsg)}else out+=ret||"";return out},_proto.parseInline=function parseInline(tokens,renderer){renderer=renderer||this.renderer;var i,token,ret,out="",l=tokens.length;for(i=0;i<l;i++)if(token=tokens[i],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[token.type])||!1===(ret=this.options.extensions.renderers[token.type].call({parser:this},token))&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(token.type))switch(token.type){case"escape":case"text":out+=renderer.text(token.text);break;case"html":out+=renderer.html(token.text);break;case"link":out+=renderer.link(token.href,token.title,this.parseInline(token.tokens,renderer));break;case"image":out+=renderer.image(token.href,token.title,token.text);break;case"strong":out+=renderer.strong(this.parseInline(token.tokens,renderer));break;case"em":out+=renderer.em(this.parseInline(token.tokens,renderer));break;case"codespan":out+=renderer.codespan(token.text);break;case"br":out+=renderer.br();break;case"del":out+=renderer.del(this.parseInline(token.tokens,renderer));break;default:var errMsg='Token with "'+token.type+'" type was not found.';if(this.options.silent)return void console.error(errMsg);throw new Error(errMsg)}else out+=ret||"";return out},Parser}();function marked(src,opt,callback){if(null==src)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof src)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(src)+", string expected");if("function"==typeof opt&&(callback=opt,opt=null),checkSanitizeDeprecation(opt=merge({},marked.defaults,opt||{})),callback){var tokens,highlight=opt.highlight;try{tokens=Lexer.lex(src,opt)}catch(e){return callback(e)}var done=function done(err){var out;if(!err)try{opt.walkTokens&&marked.walkTokens(tokens,opt.walkTokens),out=Parser.parse(tokens,opt)}catch(e){err=e}return opt.highlight=highlight,err?callback(err):callback(null,out)};if(!highlight||highlight.length<3)return done();if(delete opt.highlight,!tokens.length)return done();var pending=0;return marked.walkTokens(tokens,(function(token){"code"===token.type&&(pending++,setTimeout((function(){highlight(token.text,token.lang,(function(err,code){if(err)return done(err);null!=code&&code!==token.text&&(token.text=code,token.escaped=!0),0===--pending&&done()}))}),0))})),void(0===pending&&done())}try{var _tokens=Lexer.lex(src,opt);return opt.walkTokens&&marked.walkTokens(_tokens,opt.walkTokens),Parser.parse(_tokens,opt)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",opt.silent)return"<p>An error occurred:</p><pre>"+escape(e.message+"",!0)+"</pre>";throw e}}marked.options=marked.setOptions=function(opt){return merge(marked.defaults,opt),function changeDefaults(newDefaults){exports.defaults=newDefaults}(marked.defaults),marked},marked.getDefaults=getDefaults,marked.defaults=exports.defaults,marked.use=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var hasExtensions,opts=merge.apply(void 0,[{}].concat(args)),extensions=marked.defaults.extensions||{renderers:{},childTokens:{}};args.forEach((function(pack){if(pack.extensions&&(hasExtensions=!0,pack.extensions.forEach((function(ext){if(!ext.name)throw new Error("extension name required");if(ext.renderer){var prevRenderer=extensions.renderers?extensions.renderers[ext.name]:null;extensions.renderers[ext.name]=prevRenderer?function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];var ret=ext.renderer.apply(this,args);return!1===ret&&(ret=prevRenderer.apply(this,args)),ret}:ext.renderer}if(ext.tokenizer){if(!ext.level||"block"!==ext.level&&"inline"!==ext.level)throw new Error("extension level must be 'block' or 'inline'");extensions[ext.level]?extensions[ext.level].unshift(ext.tokenizer):extensions[ext.level]=[ext.tokenizer],ext.start&&("block"===ext.level?extensions.startBlock?extensions.startBlock.push(ext.start):extensions.startBlock=[ext.start]:"inline"===ext.level&&(extensions.startInline?extensions.startInline.push(ext.start):extensions.startInline=[ext.start]))}ext.childTokens&&(extensions.childTokens[ext.name]=ext.childTokens)}))),pack.renderer&&function(){var renderer=marked.defaults.renderer||new Renderer,_loop=function _loop(prop){var prevRenderer=renderer[prop];renderer[prop]=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];var ret=pack.renderer[prop].apply(renderer,args);return!1===ret&&(ret=prevRenderer.apply(renderer,args)),ret}};for(var prop in pack.renderer)_loop(prop);opts.renderer=renderer}(),pack.tokenizer&&function(){var tokenizer=marked.defaults.tokenizer||new Tokenizer,_loop2=function _loop2(prop){var prevTokenizer=tokenizer[prop];tokenizer[prop]=function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];var ret=pack.tokenizer[prop].apply(tokenizer,args);return!1===ret&&(ret=prevTokenizer.apply(tokenizer,args)),ret}};for(var prop in pack.tokenizer)_loop2(prop);opts.tokenizer=tokenizer}(),pack.walkTokens){var _walkTokens=marked.defaults.walkTokens;opts.walkTokens=function(token){pack.walkTokens.call(this,token),_walkTokens&&_walkTokens.call(this,token)}}hasExtensions&&(opts.extensions=extensions),marked.setOptions(opts)}))},marked.walkTokens=function(tokens,callback){for(var _step,_loop3=function _loop3(){var token=_step.value;switch(callback.call(marked,token),token.type){case"table":for(var _step2,_iterator2=_createForOfIteratorHelperLoose(token.header);!(_step2=_iterator2()).done;){var cell=_step2.value;marked.walkTokens(cell.tokens,callback)}for(var _step3,_iterator3=_createForOfIteratorHelperLoose(token.rows);!(_step3=_iterator3()).done;)for(var _step4,_iterator4=_createForOfIteratorHelperLoose(_step3.value);!(_step4=_iterator4()).done;){var _cell=_step4.value;marked.walkTokens(_cell.tokens,callback)}break;case"list":marked.walkTokens(token.items,callback);break;default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[token.type]?marked.defaults.extensions.childTokens[token.type].forEach((function(childTokens){marked.walkTokens(token[childTokens],callback)})):token.tokens&&marked.walkTokens(token.tokens,callback)}},_iterator=_createForOfIteratorHelperLoose(tokens);!(_step=_iterator()).done;)_loop3()},marked.parseInline=function(src,opt){if(null==src)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof src)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(src)+", string expected");checkSanitizeDeprecation(opt=merge({},marked.defaults,opt||{}));try{var tokens=Lexer.lexInline(src,opt);return opt.walkTokens&&marked.walkTokens(tokens,opt.walkTokens),Parser.parseInline(tokens,opt)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",opt.silent)return"<p>An error occurred:</p><pre>"+escape(e.message+"",!0)+"</pre>";throw e}},marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer,marked.TextRenderer=TextRenderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.Tokenizer=Tokenizer,marked.Slugger=Slugger,marked.parse=marked;var options=marked.options,setOptions=marked.setOptions,use=marked.use,walkTokens=marked.walkTokens,parseInline=marked.parseInline,parse=marked,parser=Parser.parse,lexer=Lexer.lex;exports.Lexer=Lexer,exports.Parser=Parser,exports.Renderer=Renderer,exports.Slugger=Slugger,exports.TextRenderer=TextRenderer,exports.Tokenizer=Tokenizer,exports.getDefaults=getDefaults,exports.lexer=lexer,exports.marked=marked,exports.options=options,exports.parse=parse,exports.parseInline=parseInline,exports.parser=parser,exports.setOptions=setOptions,exports.use=use,exports.walkTokens=walkTokens,Object.defineProperty(exports,"__esModule",{value:!0})})),define(__m[138],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mimes=void 0,function(Mimes){Mimes.text="text/plain",Mimes.binary="application/octet-stream",Mimes.unknown="application/unknown",Mimes.markdown="text/markdown",Mimes.latex="text/latex",Mimes.uriList="text/uri-list"}(exports.Mimes||(exports.Mimes={}))})),define(__m[166],__M([1,0,138]),(function(require,exports,mime_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StaticDND=exports.DragAndDropData=exports.DataTransfers=void 0,exports.DataTransfers={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:mime_1.Mimes.text,TERMINALS:"Terminals"};exports.DragAndDropData=class DragAndDropData{constructor(data){this.data=data}update(){}getData(){return this.data}},exports.StaticDND={CurrentDragAndDropData:void 0}})),define(__m[315],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrayNavigator=void 0;exports.ArrayNavigator=class ArrayNavigator{constructor(items,start=0,end=items.length,index=start-1){this.items=items,this.start=start,this.end=end,this.index=index}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}})),define(__m[316],__M([1,0,315]),(function(require,exports,navigator_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HistoryNavigator=void 0;exports.HistoryNavigator=class HistoryNavigator{constructor(history=[],limit=10){this._initialize(history),this._limit=limit,this._onChange()}getHistory(){return this._elements}add(t){this._history.delete(t),this._history.add(t),this._onChange()}next(){return this._currentPosition()!==this._elements.length-1?this._navigator.next():null}previous(){return 0!==this._currentPosition()?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}has(t){return this._history.has(t)}_onChange(){this._reduceToLimit();const elements=this._elements;this._navigator=new navigator_1.ArrayNavigator(elements,0,elements.length,elements.length)}_reduceToLimit(){const data=this._elements;data.length>this._limit&&this._initialize(data.slice(data.length-this._limit))}_currentPosition(){const currentElement=this._navigator.current();return currentElement?this._elements.indexOf(currentElement):-1}_initialize(history){this._history=new Set;for(const entry of history)this._history.add(entry)}get _elements(){const elements=[];return this._history.forEach((e=>elements.push(e))),elements}}})),define(__m[113],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SlidingWindowAverage=exports.MovingAverage=exports.clamp=void 0,exports.clamp=function clamp(value,min,max){return Math.min(Math.max(value,min),max)};exports.MovingAverage=class MovingAverage{constructor(){this._n=1,this._val=0}update(value){return this._val=this._val+(value-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}};exports.SlidingWindowAverage=class SlidingWindowAverage{constructor(size){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(size),this._values.fill(0,0,size)}update(value){const oldValue=this._values[this._index];return this._values[this._index]=value,this._index=(this._index+1)%this._values.length,this._sum-=oldValue,this._sum+=value,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}})),define(__m[16],__M([1,0]),(function(require,exports){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAndroid=exports.isEdge=exports.isSafari=exports.isFirefox=exports.isChrome=exports.isLittleEndian=exports.OS=exports.setTimeout0=exports.language=exports.userAgent=exports.isIOS=exports.isWebWorker=exports.isWeb=exports.isNative=exports.isLinux=exports.isMacintosh=exports.isWindows=exports.globals=void 0;let _locale,_translationsConfigFile,_userAgent,nodeProcess,_isWindows=!1,_isMacintosh=!1,_isLinux=!1,_isLinuxSnap=!1,_isNative=!1,_isWeb=!1,_isElectron=!1,_isIOS=!1,_isCI=!1,_language="en";exports.globals="object"==typeof self?self:"object"==typeof global?global:{},void 0!==exports.globals.vscode&&void 0!==exports.globals.vscode.process?nodeProcess=exports.globals.vscode.process:"undefined"!=typeof process&&(nodeProcess=process);const isElectronProcess="string"==typeof(null===(_a=null==nodeProcess?void 0:nodeProcess.versions)||void 0===_a?void 0:_a.electron),isElectronRenderer=isElectronProcess&&"renderer"===(null==nodeProcess?void 0:nodeProcess.type);if("object"!=typeof navigator||isElectronRenderer)if("object"==typeof nodeProcess){_isWindows="win32"===nodeProcess.platform,_isMacintosh="darwin"===nodeProcess.platform,_isLinux="linux"===nodeProcess.platform,_isLinuxSnap=_isLinux&&!!nodeProcess.env.SNAP&&!!nodeProcess.env.SNAP_REVISION,_isElectron=isElectronProcess,_isCI=!!nodeProcess.env.CI||!!nodeProcess.env.BUILD_ARTIFACTSTAGINGDIRECTORY,_locale="en",_language="en";const rawNlsConfig=nodeProcess.env.VSCODE_NLS_CONFIG;if(rawNlsConfig)try{const nlsConfig=JSON.parse(rawNlsConfig),resolved=nlsConfig.availableLanguages["*"];_locale=nlsConfig.locale,_language=resolved||"en",_translationsConfigFile=nlsConfig._translationsConfigFile}catch(e){}_isNative=!0}else console.error("Unable to resolve platform.");else _userAgent=navigator.userAgent,_isWindows=_userAgent.indexOf("Windows")>=0,_isMacintosh=_userAgent.indexOf("Macintosh")>=0,_isIOS=(_userAgent.indexOf("Macintosh")>=0||_userAgent.indexOf("iPad")>=0||_userAgent.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_isLinux=_userAgent.indexOf("Linux")>=0,_isWeb=!0,_locale=navigator.language,_language=_locale;let _platform=0;_isMacintosh?_platform=1:_isWindows?_platform=3:_isLinux&&(_platform=2),exports.isWindows=_isWindows,exports.isMacintosh=_isMacintosh,exports.isLinux=_isLinux,exports.isNative=_isNative,exports.isWeb=_isWeb,exports.isWebWorker=_isWeb&&"function"==typeof exports.globals.importScripts,exports.isIOS=_isIOS,exports.userAgent=_userAgent,exports.language=_language,exports.setTimeout0=(()=>{if("function"==typeof exports.globals.postMessage&&!exports.globals.importScripts){let pending=[];exports.globals.addEventListener("message",(e=>{if(e.data&&e.data.vscodeScheduleAsyncWork)for(let i=0,len=pending.length;i<len;i++){const candidate=pending[i];if(candidate.id===e.data.vscodeScheduleAsyncWork)return pending.splice(i,1),void candidate.callback()}}));let lastId=0;return callback=>{const myId=++lastId;pending.push({id:myId,callback}),exports.globals.postMessage({vscodeScheduleAsyncWork:myId},"*")}}return callback=>setTimeout(callback)})(),exports.OS=_isMacintosh||_isIOS?2:_isWindows?1:3;let _isLittleEndian=!0,_isLittleEndianComputed=!1;exports.isLittleEndian=function isLittleEndian(){if(!_isLittleEndianComputed){_isLittleEndianComputed=!0;const test=new Uint8Array(2);test[0]=1,test[1]=2;const view=new Uint16Array(test.buffer);_isLittleEndian=513===view[0]}return _isLittleEndian},exports.isChrome=!!(exports.userAgent&&exports.userAgent.indexOf("Chrome")>=0),exports.isFirefox=!!(exports.userAgent&&exports.userAgent.indexOf("Firefox")>=0),exports.isSafari=!!(!exports.isChrome&&exports.userAgent&&exports.userAgent.indexOf("Safari")>=0),exports.isEdge=!!(exports.userAgent&&exports.userAgent.indexOf("Edg/")>=0),exports.isAndroid=!!(exports.userAgent&&exports.userAgent.indexOf("Android")>=0)})),define(__m[317],__M([1,0,16]),(function(require,exports,platform_1){"use strict";let safeProcess;if(Object.defineProperty(exports,"__esModule",{value:!0}),exports.platform=exports.env=exports.cwd=void 0,void 0!==platform_1.globals.vscode&&void 0!==platform_1.globals.vscode.process){const sandboxProcess=platform_1.globals.vscode.process;safeProcess={get platform(){return sandboxProcess.platform},get arch(){return sandboxProcess.arch},get env(){return sandboxProcess.env},cwd:()=>sandboxProcess.cwd()}}else safeProcess="undefined"!=typeof process?{get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd:()=>process.env.VSCODE_CWD||process.cwd()}:{get platform(){return platform_1.isWindows?"win32":platform_1.isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd:()=>"/"};exports.cwd=safeProcess.cwd,exports.env=safeProcess.env,exports.platform=safeProcess.platform})),define(__m[84],__M([1,0,317]),(function(require,exports,process){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sep=exports.extname=exports.basename=exports.dirname=exports.relative=exports.resolve=exports.normalize=exports.posix=exports.win32=void 0;class ErrorInvalidArgType extends Error{constructor(name,expected,actual){let determiner;"string"==typeof expected&&0===expected.indexOf("not ")?(determiner="must not be",expected=expected.replace(/^not /,"")):determiner="must be";const type=-1!==name.indexOf(".")?"property":"argument";let msg=`The "${name}" ${type} ${determiner} of type ${expected}`;msg+=". Received type "+typeof actual,super(msg),this.code="ERR_INVALID_ARG_TYPE"}}function validateString(value,name){if("string"!=typeof value)throw new ErrorInvalidArgType(name,"string",value)}function isPathSeparator(code){return 47===code||92===code}function isPosixPathSeparator(code){return 47===code}function isWindowsDeviceRoot(code){return code>=65&&code<=90||code>=97&&code<=122}function normalizeString(path,allowAboveRoot,separator,isPathSeparator){let res="",lastSegmentLength=0,lastSlash=-1,dots=0,code=0;for(let i=0;i<=path.length;++i){if(i<path.length)code=path.charCodeAt(i);else{if(isPathSeparator(code))break;code=47}if(isPathSeparator(code)){if(lastSlash===i-1||1===dots);else if(2===dots){if(res.length<2||2!==lastSegmentLength||46!==res.charCodeAt(res.length-1)||46!==res.charCodeAt(res.length-2)){if(res.length>2){const lastSlashIndex=res.lastIndexOf(separator);-1===lastSlashIndex?(res="",lastSegmentLength=0):(res=res.slice(0,lastSlashIndex),lastSegmentLength=res.length-1-res.lastIndexOf(separator)),lastSlash=i,dots=0;continue}if(0!==res.length){res="",lastSegmentLength=0,lastSlash=i,dots=0;continue}}allowAboveRoot&&(res+=res.length>0?`${separator}..`:"..",lastSegmentLength=2)}else res.length>0?res+=`${separator}${path.slice(lastSlash+1,i)}`:res=path.slice(lastSlash+1,i),lastSegmentLength=i-lastSlash-1;lastSlash=i,dots=0}else 46===code&&-1!==dots?++dots:dots=-1}return res}function _format(sep,pathObject){if(null===pathObject||"object"!=typeof pathObject)throw new ErrorInvalidArgType("pathObject","Object",pathObject);const dir=pathObject.dir||pathObject.root,base=pathObject.base||`${pathObject.name||""}${pathObject.ext||""}`;return dir?dir===pathObject.root?`${dir}${base}`:`${dir}${sep}${base}`:base}exports.win32={resolve(...pathSegments){let resolvedDevice="",resolvedTail="",resolvedAbsolute=!1;for(let i=pathSegments.length-1;i>=-1;i--){let path;if(i>=0){if(path=pathSegments[i],validateString(path,"path"),0===path.length)continue}else 0===resolvedDevice.length?path=process.cwd():(path=process.env[`=${resolvedDevice}`]||process.cwd(),(void 0===path||path.slice(0,2).toLowerCase()!==resolvedDevice.toLowerCase()&&92===path.charCodeAt(2))&&(path=`${resolvedDevice}\\`));const len=path.length;let rootEnd=0,device="",isAbsolute=!1;const code=path.charCodeAt(0);if(1===len)isPathSeparator(code)&&(rootEnd=1,isAbsolute=!0);else if(isPathSeparator(code))if(isAbsolute=!0,isPathSeparator(path.charCodeAt(1))){let j=2,last=j;for(;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){const firstPart=path.slice(last,j);for(last=j;j<len&&isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;j!==len&&j===last||(device=`\\\\${firstPart}\\${path.slice(last,j)}`,rootEnd=j)}}}else rootEnd=1;else isWindowsDeviceRoot(code)&&58===path.charCodeAt(1)&&(device=path.slice(0,2),rootEnd=2,len>2&&isPathSeparator(path.charCodeAt(2))&&(isAbsolute=!0,rootEnd=3));if(device.length>0)if(resolvedDevice.length>0){if(device.toLowerCase()!==resolvedDevice.toLowerCase())continue}else resolvedDevice=device;if(resolvedAbsolute){if(resolvedDevice.length>0)break}else if(resolvedTail=`${path.slice(rootEnd)}\\${resolvedTail}`,resolvedAbsolute=isAbsolute,isAbsolute&&resolvedDevice.length>0)break}return resolvedTail=normalizeString(resolvedTail,!resolvedAbsolute,"\\",isPathSeparator),resolvedAbsolute?`${resolvedDevice}\\${resolvedTail}`:`${resolvedDevice}${resolvedTail}`||"."},normalize(path){validateString(path,"path");const len=path.length;if(0===len)return".";let device,rootEnd=0,isAbsolute=!1;const code=path.charCodeAt(0);if(1===len)return isPosixPathSeparator(code)?"\\":path;if(isPathSeparator(code))if(isAbsolute=!0,isPathSeparator(path.charCodeAt(1))){let j=2,last=j;for(;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){const firstPart=path.slice(last,j);for(last=j;j<len&&isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j===len)return`\\\\${firstPart}\\${path.slice(last)}\\`;j!==last&&(device=`\\\\${firstPart}\\${path.slice(last,j)}`,rootEnd=j)}}}else rootEnd=1;else isWindowsDeviceRoot(code)&&58===path.charCodeAt(1)&&(device=path.slice(0,2),rootEnd=2,len>2&&isPathSeparator(path.charCodeAt(2))&&(isAbsolute=!0,rootEnd=3));let tail=rootEnd<len?normalizeString(path.slice(rootEnd),!isAbsolute,"\\",isPathSeparator):"";return 0!==tail.length||isAbsolute||(tail="."),tail.length>0&&isPathSeparator(path.charCodeAt(len-1))&&(tail+="\\"),void 0===device?isAbsolute?`\\${tail}`:tail:isAbsolute?`${device}\\${tail}`:`${device}${tail}`},isAbsolute(path){validateString(path,"path");const len=path.length;if(0===len)return!1;const code=path.charCodeAt(0);return isPathSeparator(code)||len>2&&isWindowsDeviceRoot(code)&&58===path.charCodeAt(1)&&isPathSeparator(path.charCodeAt(2))},join(...paths){if(0===paths.length)return".";let joined,firstPart;for(let i=0;i<paths.length;++i){const arg=paths[i];validateString(arg,"path"),arg.length>0&&(void 0===joined?joined=firstPart=arg:joined+=`\\${arg}`)}if(void 0===joined)return".";let needsReplace=!0,slashCount=0;if("string"==typeof firstPart&&isPathSeparator(firstPart.charCodeAt(0))){++slashCount;const firstLen=firstPart.length;firstLen>1&&isPathSeparator(firstPart.charCodeAt(1))&&(++slashCount,firstLen>2&&(isPathSeparator(firstPart.charCodeAt(2))?++slashCount:needsReplace=!1))}if(needsReplace){for(;slashCount<joined.length&&isPathSeparator(joined.charCodeAt(slashCount));)slashCount++;slashCount>=2&&(joined=`\\${joined.slice(slashCount)}`)}return exports.win32.normalize(joined)},relative(from,to){if(validateString(from,"from"),validateString(to,"to"),from===to)return"";const fromOrig=exports.win32.resolve(from),toOrig=exports.win32.resolve(to);if(fromOrig===toOrig)return"";if((from=fromOrig.toLowerCase())===(to=toOrig.toLowerCase()))return"";let fromStart=0;for(;fromStart<from.length&&92===from.charCodeAt(fromStart);)fromStart++;let fromEnd=from.length;for(;fromEnd-1>fromStart&&92===from.charCodeAt(fromEnd-1);)fromEnd--;const fromLen=fromEnd-fromStart;let toStart=0;for(;toStart<to.length&&92===to.charCodeAt(toStart);)toStart++;let toEnd=to.length;for(;toEnd-1>toStart&&92===to.charCodeAt(toEnd-1);)toEnd--;const toLen=toEnd-toStart,length=fromLen<toLen?fromLen:toLen;let lastCommonSep=-1,i=0;for(;i<length;i++){const fromCode=from.charCodeAt(fromStart+i);if(fromCode!==to.charCodeAt(toStart+i))break;92===fromCode&&(lastCommonSep=i)}if(i!==length){if(-1===lastCommonSep)return toOrig}else{if(toLen>length){if(92===to.charCodeAt(toStart+i))return toOrig.slice(toStart+i+1);if(2===i)return toOrig.slice(toStart+i)}fromLen>length&&(92===from.charCodeAt(fromStart+i)?lastCommonSep=i:2===i&&(lastCommonSep=3)),-1===lastCommonSep&&(lastCommonSep=0)}let out="";for(i=fromStart+lastCommonSep+1;i<=fromEnd;++i)i!==fromEnd&&92!==from.charCodeAt(i)||(out+=0===out.length?"..":"\\..");return toStart+=lastCommonSep,out.length>0?`${out}${toOrig.slice(toStart,toEnd)}`:(92===toOrig.charCodeAt(toStart)&&++toStart,toOrig.slice(toStart,toEnd))},toNamespacedPath(path){if("string"!=typeof path)return path;if(0===path.length)return"";const resolvedPath=exports.win32.resolve(path);if(resolvedPath.length<=2)return path;if(92===resolvedPath.charCodeAt(0)){if(92===resolvedPath.charCodeAt(1)){const code=resolvedPath.charCodeAt(2);if(63!==code&&46!==code)return`\\\\?\\UNC\\${resolvedPath.slice(2)}`}}else if(isWindowsDeviceRoot(resolvedPath.charCodeAt(0))&&58===resolvedPath.charCodeAt(1)&&92===resolvedPath.charCodeAt(2))return`\\\\?\\${resolvedPath}`;return path},dirname(path){validateString(path,"path");const len=path.length;if(0===len)return".";let rootEnd=-1,offset=0;const code=path.charCodeAt(0);if(1===len)return isPathSeparator(code)?path:".";if(isPathSeparator(code)){if(rootEnd=offset=1,isPathSeparator(path.charCodeAt(1))){let j=2,last=j;for(;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j===len)return path;j!==last&&(rootEnd=offset=j+1)}}}}else isWindowsDeviceRoot(code)&&58===path.charCodeAt(1)&&(rootEnd=len>2&&isPathSeparator(path.charCodeAt(2))?3:2,offset=rootEnd);let end=-1,matchedSlash=!0;for(let i=len-1;i>=offset;--i)if(isPathSeparator(path.charCodeAt(i))){if(!matchedSlash){end=i;break}}else matchedSlash=!1;if(-1===end){if(-1===rootEnd)return".";end=rootEnd}return path.slice(0,end)},basename(path,ext){void 0!==ext&&validateString(ext,"ext"),validateString(path,"path");let i,start=0,end=-1,matchedSlash=!0;if(path.length>=2&&isWindowsDeviceRoot(path.charCodeAt(0))&&58===path.charCodeAt(1)&&(start=2),void 0!==ext&&ext.length>0&&ext.length<=path.length){if(ext===path)return"";let extIdx=ext.length-1,firstNonSlashEnd=-1;for(i=path.length-1;i>=start;--i){const code=path.charCodeAt(i);if(isPathSeparator(code)){if(!matchedSlash){start=i+1;break}}else-1===firstNonSlashEnd&&(matchedSlash=!1,firstNonSlashEnd=i+1),extIdx>=0&&(code===ext.charCodeAt(extIdx)?-1==--extIdx&&(end=i):(extIdx=-1,end=firstNonSlashEnd))}return start===end?end=firstNonSlashEnd:-1===end&&(end=path.length),path.slice(start,end)}for(i=path.length-1;i>=start;--i)if(isPathSeparator(path.charCodeAt(i))){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)},extname(path){validateString(path,"path");let start=0,startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0;path.length>=2&&58===path.charCodeAt(1)&&isWindowsDeviceRoot(path.charCodeAt(0))&&(start=startPart=2);for(let i=path.length-1;i>=start;--i){const code=path.charCodeAt(i);if(isPathSeparator(code)){if(!matchedSlash){startPart=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1)}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)},format:_format.bind(null,"\\"),parse(path){validateString(path,"path");const ret={root:"",dir:"",base:"",ext:"",name:""};if(0===path.length)return ret;const len=path.length;let rootEnd=0,code=path.charCodeAt(0);if(1===len)return isPathSeparator(code)?(ret.root=ret.dir=path,ret):(ret.base=ret.name=path,ret);if(isPathSeparator(code)){if(rootEnd=1,isPathSeparator(path.charCodeAt(1))){let j=2,last=j;for(;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&isPathSeparator(path.charCodeAt(j));)j++;if(j<len&&j!==last){for(last=j;j<len&&!isPathSeparator(path.charCodeAt(j));)j++;j===len?rootEnd=j:j!==last&&(rootEnd=j+1)}}}}else if(isWindowsDeviceRoot(code)&&58===path.charCodeAt(1)){if(len<=2)return ret.root=ret.dir=path,ret;if(rootEnd=2,isPathSeparator(path.charCodeAt(2))){if(3===len)return ret.root=ret.dir=path,ret;rootEnd=3}}rootEnd>0&&(ret.root=path.slice(0,rootEnd));let startDot=-1,startPart=rootEnd,end=-1,matchedSlash=!0,i=path.length-1,preDotState=0;for(;i>=rootEnd;--i)if(code=path.charCodeAt(i),isPathSeparator(code)){if(!matchedSlash){startPart=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);return-1!==end&&(-1===startDot||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?ret.base=ret.name=path.slice(startPart,end):(ret.name=path.slice(startPart,startDot),ret.base=path.slice(startPart,end),ret.ext=path.slice(startDot,end))),ret.dir=startPart>0&&startPart!==rootEnd?path.slice(0,startPart-1):ret.root,ret},sep:"\\",delimiter:";",win32:null,posix:null},exports.posix={resolve(...pathSegments){let resolvedPath="",resolvedAbsolute=!1;for(let i=pathSegments.length-1;i>=-1&&!resolvedAbsolute;i--){const path=i>=0?pathSegments[i]:process.cwd();validateString(path,"path"),0!==path.length&&(resolvedPath=`${path}/${resolvedPath}`,resolvedAbsolute=47===path.charCodeAt(0))}return resolvedPath=normalizeString(resolvedPath,!resolvedAbsolute,"/",isPosixPathSeparator),resolvedAbsolute?`/${resolvedPath}`:resolvedPath.length>0?resolvedPath:"."},normalize(path){if(validateString(path,"path"),0===path.length)return".";const isAbsolute=47===path.charCodeAt(0),trailingSeparator=47===path.charCodeAt(path.length-1);return 0===(path=normalizeString(path,!isAbsolute,"/",isPosixPathSeparator)).length?isAbsolute?"/":trailingSeparator?"./":".":(trailingSeparator&&(path+="/"),isAbsolute?`/${path}`:path)},isAbsolute:path=>(validateString(path,"path"),path.length>0&&47===path.charCodeAt(0)),join(...paths){if(0===paths.length)return".";let joined;for(let i=0;i<paths.length;++i){const arg=paths[i];validateString(arg,"path"),arg.length>0&&(void 0===joined?joined=arg:joined+=`/${arg}`)}return void 0===joined?".":exports.posix.normalize(joined)},relative(from,to){if(validateString(from,"from"),validateString(to,"to"),from===to)return"";if((from=exports.posix.resolve(from))===(to=exports.posix.resolve(to)))return"";const fromEnd=from.length,fromLen=fromEnd-1,toLen=to.length-1,length=fromLen<toLen?fromLen:toLen;let lastCommonSep=-1,i=0;for(;i<length;i++){const fromCode=from.charCodeAt(1+i);if(fromCode!==to.charCodeAt(1+i))break;47===fromCode&&(lastCommonSep=i)}if(i===length)if(toLen>length){if(47===to.charCodeAt(1+i))return to.slice(1+i+1);if(0===i)return to.slice(1+i)}else fromLen>length&&(47===from.charCodeAt(1+i)?lastCommonSep=i:0===i&&(lastCommonSep=0));let out="";for(i=1+lastCommonSep+1;i<=fromEnd;++i)i!==fromEnd&&47!==from.charCodeAt(i)||(out+=0===out.length?"..":"/..");return`${out}${to.slice(1+lastCommonSep)}`},toNamespacedPath:path=>path,dirname(path){if(validateString(path,"path"),0===path.length)return".";const hasRoot=47===path.charCodeAt(0);let end=-1,matchedSlash=!0;for(let i=path.length-1;i>=1;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"//":path.slice(0,end)},basename(path,ext){void 0!==ext&&validateString(ext,"ext"),validateString(path,"path");let i,start=0,end=-1,matchedSlash=!0;if(void 0!==ext&&ext.length>0&&ext.length<=path.length){if(ext===path)return"";let extIdx=ext.length-1,firstNonSlashEnd=-1;for(i=path.length-1;i>=0;--i){const code=path.charCodeAt(i);if(47===code){if(!matchedSlash){start=i+1;break}}else-1===firstNonSlashEnd&&(matchedSlash=!1,firstNonSlashEnd=i+1),extIdx>=0&&(code===ext.charCodeAt(extIdx)?-1==--extIdx&&(end=i):(extIdx=-1,end=firstNonSlashEnd))}return start===end?end=firstNonSlashEnd:-1===end&&(end=path.length),path.slice(start,end)}for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)},extname(path){validateString(path,"path");let startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0;for(let i=path.length-1;i>=0;--i){const code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)},format:_format.bind(null,"/"),parse(path){validateString(path,"path");const ret={root:"",dir:"",base:"",ext:"",name:""};if(0===path.length)return ret;const isAbsolute=47===path.charCodeAt(0);let start;isAbsolute?(ret.root="/",start=1):start=0;let startDot=-1,startPart=0,end=-1,matchedSlash=!0,i=path.length-1,preDotState=0;for(;i>=start;--i){const code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}if(-1!==end){const start=0===startPart&&isAbsolute?1:startPart;-1===startDot||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?ret.base=ret.name=path.slice(start,end):(ret.name=path.slice(start,startDot),ret.base=path.slice(start,end),ret.ext=path.slice(startDot,end))}return startPart>0?ret.dir=path.slice(0,startPart-1):isAbsolute&&(ret.dir="/"),ret},sep:"/",delimiter:":",win32:null,posix:null},exports.posix.win32=exports.win32.win32=exports.win32,exports.posix.posix=exports.win32.posix=exports.posix,exports.normalize="win32"===process.platform?exports.win32.normalize:exports.posix.normalize,exports.resolve="win32"===process.platform?exports.win32.resolve:exports.posix.resolve,exports.relative="win32"===process.platform?exports.win32.relative:exports.posix.relative,exports.dirname="win32"===process.platform?exports.win32.dirname:exports.posix.dirname,exports.basename="win32"===process.platform?exports.win32.basename:exports.posix.basename,exports.extname="win32"===process.platform?exports.win32.extname:exports.posix.extname,exports.sep="win32"===process.platform?exports.win32.sep:exports.posix.sep})),define(__m[139],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Range=void 0,function(Range){function intersect(one,other){if(one.start>=other.end||other.start>=one.end)return{start:0,end:0};const start=Math.max(one.start,other.start),end=Math.min(one.end,other.end);return end-start<=0?{start:0,end:0}:{start,end}}function isEmpty(range){return range.end-range.start<=0}Range.intersect=intersect,Range.isEmpty=isEmpty,Range.intersects=function intersects(one,other){return!isEmpty(intersect(one,other))},Range.relativeComplement=function relativeComplement(one,other){const result=[],first={start:one.start,end:Math.min(other.start,one.end)},second={start:Math.max(other.end,one.start),end:one.end};return isEmpty(first)||result.push(first),isEmpty(second)||result.push(second),result}}(exports.Range||(exports.Range={}))})),define(__m[318],__M([1,0,139]),(function(require,exports,range_1){"use strict";function groupIntersect(range,groups){const result=[];for(let r of groups){if(range.start>=r.range.end)continue;if(range.end<r.range.start)break;const intersection=range_1.Range.intersect(range,r.range);range_1.Range.isEmpty(intersection)||result.push({range:intersection,size:r.size})}return result}function shift({start,end},much){return{start:start+much,end:end+much}}function consolidate(groups){const result=[];let previousGroup=null;for(let group of groups){const start=group.range.start,end=group.range.end,size=group.size;previousGroup&&size===previousGroup.size?previousGroup.range.end=end:(previousGroup={range:{start,end},size},result.push(previousGroup))}return result}Object.defineProperty(exports,"__esModule",{value:!0}),exports.RangeMap=exports.consolidate=exports.shift=exports.groupIntersect=void 0,exports.groupIntersect=groupIntersect,exports.shift=shift,exports.consolidate=consolidate;exports.RangeMap=class RangeMap{constructor(){this.groups=[],this._size=0}splice(index,deleteCount,items=[]){const diff=items.length-deleteCount,before=groupIntersect({start:0,end:index},this.groups),after=groupIntersect({start:index+deleteCount,end:Number.POSITIVE_INFINITY},this.groups).map((g=>({range:shift(g.range,diff),size:g.size}))),middle=items.map(((item,i)=>({range:{start:index+i,end:index+i+1},size:item.size})));this.groups=function concat(...groups){return consolidate(groups.reduce(((r,g)=>r.concat(g)),[]))}(before,middle,after),this._size=this.groups.reduce(((t,g)=>t+g.size*(g.range.end-g.range.start)),0)}get count(){const len=this.groups.length;return len?this.groups[len-1].range.end:0}get size(){return this._size}indexAt(position){if(position<0)return-1;let index=0,size=0;for(let group of this.groups){const count=group.range.end-group.range.start,newSize=size+count*group.size;if(position<newSize)return index+Math.floor((position-size)/group.size);index+=count,size=newSize}return index}indexAfter(position){return Math.min(this.indexAt(position)+1,this.count)}positionAt(index){if(index<0)return-1;let position=0,count=0;for(let group of this.groups){const groupCount=group.range.end-group.range.start,newCount=count+groupCount;if(index<newCount)return position+(index-count)*group.size;position+=groupCount*group.size,count=newCount}return-1}}})),define(__m[55],__M([1,0,16]),(function(require,exports,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StopWatch=void 0;const hasPerformanceNow=platform_1.globals.performance&&"function"==typeof platform_1.globals.performance.now;class StopWatch{constructor(highResolution){this._highResolution=hasPerformanceNow&&highResolution,this._startTime=this._now(),this._stopTime=-1}static create(highResolution=!0){return new StopWatch(highResolution)}stop(){this._stopTime=this._now()}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?platform_1.globals.performance.now():Date.now()}}exports.StopWatch=StopWatch})),define(__m[4],__M([1,0,13,2,83,55]),(function(require,exports,errors_1,lifecycle_1,linkedList_1,stopwatch_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Relay=exports.EventBufferer=exports.DebounceEmitter=exports.PauseableEmitter=exports.Emitter=exports.Event=void 0;var Event;!function(Event){function _addLeakageTraceLogic(options){false}function once(event){return(listener,thisArgs=null,disposables)=>{let result,didFire=!1;return result=event((e=>{if(!didFire)return result?result.dispose():didFire=!0,listener.call(thisArgs,e)}),null,disposables),didFire&&result.dispose(),result}}function map(event,map,disposable){return snapshot(((listener,thisArgs=null,disposables)=>event((i=>listener.call(thisArgs,map(i))),null,disposables)),disposable)}function forEach(event,each,disposable){return snapshot(((listener,thisArgs=null,disposables)=>event((i=>{each(i),listener.call(thisArgs,i)}),null,disposables)),disposable)}function filter(event,filter,disposable){return snapshot(((listener,thisArgs=null,disposables)=>event((e=>filter(e)&&listener.call(thisArgs,e)),null,disposables)),disposable)}function reduce(event,merge,initial,disposable){let output=initial;return map(event,(e=>(output=merge(output,e),output)),disposable)}function snapshot(event,disposable){let listener;const options={onFirstListenerAdd(){listener=event(emitter.fire,emitter)},onLastListenerRemove(){listener.dispose()}};disposable||_addLeakageTraceLogic();const emitter=new Emitter(options);return disposable&&disposable.add(emitter),emitter.event}function debounce(event,merge,delay=100,leading=!1,leakWarningThreshold,disposable){let subscription,output,handle,numDebouncedCalls=0;const options={leakWarningThreshold,onFirstListenerAdd(){subscription=event((cur=>{numDebouncedCalls++,output=merge(output,cur),leading&&!handle&&(emitter.fire(output),output=void 0),clearTimeout(handle),handle=setTimeout((()=>{const _output=output;output=void 0,handle=void 0,(!leading||numDebouncedCalls>1)&&emitter.fire(_output),numDebouncedCalls=0}),delay)}))},onLastListenerRemove(){subscription.dispose()}};disposable||_addLeakageTraceLogic();const emitter=new Emitter(options);return disposable&&disposable.add(emitter),emitter.event}function latch(event,equals=((a,b)=>a===b),disposable){let cache,firstCall=!0;return filter(event,(value=>{const shouldEmit=firstCall||!equals(value,cache);return firstCall=!1,cache=value,shouldEmit}),disposable)}Event.None=()=>lifecycle_1.Disposable.None,Event.once=once,Event.map=map,Event.forEach=forEach,Event.filter=filter,Event.signal=function signal(event){return event},Event.any=function any(...events){return(listener,thisArgs=null,disposables)=>(0,lifecycle_1.combinedDisposable)(...events.map((event=>event((e=>listener.call(thisArgs,e)),null,disposables))))},Event.reduce=reduce,Event.debounce=debounce,Event.latch=latch,Event.split=function split(event,isT,disposable){return[Event.filter(event,isT,disposable),Event.filter(event,(e=>!isT(e)),disposable)]},Event.buffer=function buffer(event,flushAfterTimeout=!1,_buffer=[]){let buffer=_buffer.slice(),listener=event((e=>{buffer?buffer.push(e):emitter.fire(e)}));const flush=()=>{buffer&&buffer.forEach((e=>emitter.fire(e))),buffer=null},emitter=new Emitter({onFirstListenerAdd(){listener||(listener=event((e=>emitter.fire(e))))},onFirstListenerDidAdd(){buffer&&(flushAfterTimeout?setTimeout(flush):flush())},onLastListenerRemove(){listener&&listener.dispose(),listener=null}});return emitter.event};class ChainableEvent{constructor(event){this.event=event}map(fn){return new ChainableEvent(map(this.event,fn))}forEach(fn){return new ChainableEvent(forEach(this.event,fn))}filter(fn){return new ChainableEvent(filter(this.event,fn))}reduce(merge,initial){return new ChainableEvent(reduce(this.event,merge,initial))}latch(){return new ChainableEvent(latch(this.event))}debounce(merge,delay=100,leading=!1,leakWarningThreshold){return new ChainableEvent(debounce(this.event,merge,delay,leading,leakWarningThreshold))}on(listener,thisArgs,disposables){return this.event(listener,thisArgs,disposables)}once(listener,thisArgs,disposables){return once(this.event)(listener,thisArgs,disposables)}}Event.chain=function chain(event){return new ChainableEvent(event)},Event.fromNodeEventEmitter=function fromNodeEventEmitter(emitter,eventName,map=(id=>id)){const fn=(...args)=>result.fire(map(...args)),result=new Emitter({onFirstListenerAdd:()=>emitter.on(eventName,fn),onLastListenerRemove:()=>emitter.removeListener(eventName,fn)});return result.event},Event.fromDOMEventEmitter=function fromDOMEventEmitter(emitter,eventName,map=(id=>id)){const fn=(...args)=>result.fire(map(...args)),result=new Emitter({onFirstListenerAdd:()=>emitter.addEventListener(eventName,fn),onLastListenerRemove:()=>emitter.removeEventListener(eventName,fn)});return result.event},Event.toPromise=function toPromise(event){return new Promise((resolve=>once(event)(resolve)))},Event.runAndSubscribe=function runAndSubscribe(event,handler){return handler(void 0),event((e=>handler(e)))},Event.runAndSubscribeWithStore=function runAndSubscribeWithStore(event,handler){let store=null;function run(e){null==store||store.dispose(),store=new lifecycle_1.DisposableStore,handler(e,store)}run(void 0);const disposable=event((e=>run(e)));return(0,lifecycle_1.toDisposable)((()=>{disposable.dispose(),null==store||store.dispose()}))}}(Event=exports.Event||(exports.Event={}));class EventProfiling{constructor(name){this._listenerCount=0,this._invocationCount=0,this._elapsedOverall=0,this._name=`${name}_${EventProfiling._idPool++}`}start(listenerCount){this._stopWatch=new stopwatch_1.StopWatch(!0),this._listenerCount=listenerCount}stop(){if(this._stopWatch){const elapsed=this._stopWatch.elapsed();this._elapsedOverall+=elapsed,this._invocationCount+=1,console.info(`did FIRE ${this._name}: elapsed_ms: ${elapsed.toFixed(5)}, listener: ${this._listenerCount} (elapsed_overall: ${this._elapsedOverall.toFixed(2)}, invocations: ${this._invocationCount})`),this._stopWatch=void 0}}}EventProfiling._idPool=0;class Stacktrace{constructor(value){this.value=value}static create(){var _a;return new Stacktrace(null!==(_a=(new Error).stack)&&void 0!==_a?_a:"")}print(){console.warn(this.value.split("\n").slice(2).join("\n"))}}class Listener{constructor(callback,callbackThis,stack){this.callback=callback,this.callbackThis=callbackThis,this.stack=stack,this.subscription=new lifecycle_1.SafeDisposable}invoke(e){this.callback.call(this.callbackThis,e)}}class Emitter{constructor(options){var _a;this._disposed=!1,this._options=options,this._leakageMon=void 0,this._perfMon=(null===(_a=this._options)||void 0===_a?void 0:_a._profName)?new EventProfiling(this._options._profName):void 0}dispose(){var _a,_b,_c,_d;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),null===(_a=this._deliveryQueue)||void 0===_a||_a.clear(),null===(_c=null===(_b=this._options)||void 0===_b?void 0:_b.onLastListenerRemove)||void 0===_c||_c.call(_b),null===(_d=this._leakageMon)||void 0===_d||_d.dispose())}get event(){return this._event||(this._event=(callback,thisArgs,disposables)=>{var _a,_b,_c;this._listeners||(this._listeners=new linkedList_1.LinkedList);const firstListener=this._listeners.isEmpty();let removeMonitor,stack;firstListener&&(null===(_a=this._options)||void 0===_a?void 0:_a.onFirstListenerAdd)&&this._options.onFirstListenerAdd(this),this._leakageMon&&this._listeners.size>=30&&(stack=Stacktrace.create(),removeMonitor=this._leakageMon.check(stack,this._listeners.size+1));const listener=new Listener(callback,thisArgs,stack),removeListener=this._listeners.push(listener);firstListener&&(null===(_b=this._options)||void 0===_b?void 0:_b.onFirstListenerDidAdd)&&this._options.onFirstListenerDidAdd(this),(null===(_c=this._options)||void 0===_c?void 0:_c.onListenerDidAdd)&&this._options.onListenerDidAdd(this,callback,thisArgs);const result=listener.subscription.set((()=>{if(removeMonitor&&removeMonitor(),!this._disposed&&(removeListener(),this._options&&this._options.onLastListenerRemove)){this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this)}}));return disposables instanceof lifecycle_1.DisposableStore?disposables.add(result):Array.isArray(disposables)&&disposables.push(result),result}),this._event}fire(event){var _a,_b;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new linkedList_1.LinkedList);for(let listener of this._listeners)this._deliveryQueue.push([listener,event]);for(null===(_a=this._perfMon)||void 0===_a||_a.start(this._deliveryQueue.size);this._deliveryQueue.size>0;){const[listener,event]=this._deliveryQueue.shift();try{listener.invoke(event)}catch(e){(0,errors_1.onUnexpectedError)(e)}}null===(_b=this._perfMon)||void 0===_b||_b.stop()}}}exports.Emitter=Emitter;class PauseableEmitter extends Emitter{constructor(options){super(options),this._isPaused=0,this._eventQueue=new linkedList_1.LinkedList,this._mergeFn=null==options?void 0:options.merge}pause(){this._isPaused++}resume(){if(0!==this._isPaused&&0==--this._isPaused)if(this._mergeFn){const events=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(events))}else for(;!this._isPaused&&0!==this._eventQueue.size;)super.fire(this._eventQueue.shift())}fire(event){this._listeners&&(0!==this._isPaused?this._eventQueue.push(event):super.fire(event))}}exports.PauseableEmitter=PauseableEmitter;exports.DebounceEmitter=class DebounceEmitter extends PauseableEmitter{constructor(options){var _a;super(options),this._delay=null!==(_a=options.delay)&&void 0!==_a?_a:100}fire(event){this._handle||(this.pause(),this._handle=setTimeout((()=>{this._handle=void 0,this.resume()}),this._delay)),super.fire(event)}};exports.EventBufferer=class EventBufferer{constructor(){this.buffers=[]}wrapEvent(event){return(listener,thisArgs,disposables)=>event((i=>{const buffer=this.buffers[this.buffers.length-1];buffer?buffer.push((()=>listener.call(thisArgs,i))):listener.call(thisArgs,i)}),void 0,disposables)}bufferEvents(fn){const buffer=[];this.buffers.push(buffer);const r=fn();return this.buffers.pop(),buffer.forEach((flush=>flush())),r}};exports.Relay=class Relay{constructor(){this.listening=!1,this.inputEvent=Event.None,this.inputEventListener=lifecycle_1.Disposable.None,this.emitter=new Emitter({onFirstListenerDidAdd:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onLastListenerRemove:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(event){this.inputEvent=event,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=event(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}})),define(__m[34],__M([1,0,4,2]),(function(require,exports,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isStandalone=exports.isAndroid=exports.isElectron=exports.isWebkitWebView=exports.isSafari=exports.isChrome=exports.isWebKit=exports.isFirefox=exports.getZoomFactor=exports.PixelRatio=void 0;class WindowManager{constructor(){this._zoomFactor=1}getZoomFactor(){return this._zoomFactor}}WindowManager.INSTANCE=new WindowManager;class DevicePixelRatioMonitor extends lifecycle_1.Disposable{constructor(){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(fireEvent){this._mediaQueryList&&this._mediaQueryList.removeEventListener("change",this._listener),this._mediaQueryList=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),fireEvent&&this._onDidChange.fire()}}class PixelRatioImpl extends lifecycle_1.Disposable{constructor(){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const dprMonitor=this._register(new DevicePixelRatioMonitor);this._register(dprMonitor.onDidChange((()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)})))}get value(){return this._value}_getPixelRatio(){const ctx=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1)}}exports.PixelRatio=new class PixelRatioFacade{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=new PixelRatioImpl),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}},exports.getZoomFactor=function getZoomFactor(){return WindowManager.INSTANCE.getZoomFactor()};const userAgent=navigator.userAgent;exports.isFirefox=userAgent.indexOf("Firefox")>=0,exports.isWebKit=userAgent.indexOf("AppleWebKit")>=0,exports.isChrome=userAgent.indexOf("Chrome")>=0,exports.isSafari=!exports.isChrome&&userAgent.indexOf("Safari")>=0,exports.isWebkitWebView=!exports.isChrome&&!exports.isSafari&&exports.isWebKit,exports.isElectron=userAgent.indexOf("Electron/")>=0,exports.isAndroid=userAgent.indexOf("Android")>=0,exports.isStandalone=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches})),define(__m[167],__M([1,0,34,16]),(function(require,exports,browser,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserFeatures=void 0,exports.BrowserFeatures={clipboard:{writeText:platform.isNative||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:platform.isNative||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:platform.isNative||browser.isStandalone?0:navigator.keyboard||browser.isSafari?1:2,touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)}})),define(__m[92],__M([1,0,4]),(function(require,exports,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopEvent=exports.DomEmitter=void 0;exports.DomEmitter=class DomEmitter{constructor(element,type,useCapture){const fn=e=>this.emitter.fire(e);this.emitter=new event_1.Emitter({onFirstListenerAdd:()=>element.addEventListener(type,fn,useCapture),onLastListenerRemove:()=>element.removeEventListener(type,fn,useCapture)})}get event(){return this.emitter.event}dispose(){this.emitter.dispose()}},exports.stopEvent=function stopEvent(event){return event.preventDefault(),event.stopPropagation(),event}})),define(__m[44],__M([1,0,34,58,96,16]),(function(require,exports,browser,keyCodes_1,keybindings_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandardKeyboardEvent=void 0;const ctrlKeyMod=platform.isMacintosh?256:2048,metaKeyMod=platform.isMacintosh?2048:256;exports.StandardKeyboardEvent=class StandardKeyboardEvent{constructor(source){this._standardKeyboardEventBrand=!0;let e=source;this.browserEvent=e,this.target=e.target,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.keyCode=function extractKeyCode(e){if(e.charCode){let char=String.fromCharCode(e.charCode).toUpperCase();return keyCodes_1.KeyCodeUtils.fromString(char)}const keyCode=e.keyCode;if(3===keyCode)return 7;if(browser.isFirefox){if(59===keyCode)return 80;if(107===keyCode)return 81;if(109===keyCode)return 83;if(platform.isMacintosh&&224===keyCode)return 57}else if(browser.isWebKit){if(91===keyCode)return 57;if(platform.isMacintosh&&93===keyCode)return 57;if(!platform.isMacintosh&&92===keyCode)return 57}return keyCodes_1.EVENT_KEY_CODE_MAP[keyCode]||0}(e),this.code=e.code,this.ctrlKey=this.ctrlKey||5===this.keyCode,this.altKey=this.altKey||6===this.keyCode,this.shiftKey=this.shiftKey||4===this.keyCode,this.metaKey=this.metaKey||57===this.keyCode,this._asKeybinding=this._computeKeybinding(),this._asRuntimeKeybinding=this._computeRuntimeKeybinding()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeybinding(){return this._asRuntimeKeybinding}equals(other){return this._asKeybinding===other}_computeKeybinding(){let key=0;5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(key=this.keyCode);let result=0;return this.ctrlKey&&(result|=ctrlKeyMod),this.altKey&&(result|=512),this.shiftKey&&(result|=1024),this.metaKey&&(result|=metaKeyMod),result|=key,result}_computeRuntimeKeybinding(){let key=0;return 5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(key=this.keyCode),new keybindings_1.SimpleKeybinding(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,key)}}})),define(__m[59],__M([1,0,34,214,16]),(function(require,exports,browser,iframe_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandardWheelEvent=exports.StandardMouseEvent=void 0;exports.StandardMouseEvent=class StandardMouseEvent{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=0===e.button,this.middleButton=1===e.button,this.rightButton=2===e.button,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,"dblclick"===e.type&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,"number"==typeof e.pageX?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);let iframeOffsets=iframe_1.IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(self,e.view);this.posx-=iframeOffsets.left,this.posy-=iframeOffsets.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};exports.StandardWheelEvent=class StandardWheelEvent{constructor(e,deltaX=0,deltaY=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=deltaY,this.deltaX=deltaX,e){let e1=e,e2=e;if(void 0!==e1.wheelDeltaY)this.deltaY=e1.wheelDeltaY/120;else if(void 0!==e2.VERTICAL_AXIS&&e2.axis===e2.VERTICAL_AXIS)this.deltaY=-e2.detail/3;else if("wheel"===e.type){const ev=e;ev.deltaMode===ev.DOM_DELTA_LINE?browser.isFirefox&&!platform.isMacintosh?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(void 0!==e1.wheelDeltaX)browser.isSafari&&platform.isWindows?this.deltaX=-e1.wheelDeltaX/120:this.deltaX=e1.wheelDeltaX/120;else if(void 0!==e2.HORIZONTAL_AXIS&&e2.axis===e2.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if("wheel"===e.type){const ev=e;ev.deltaMode===ev.DOM_DELTA_LINE?browser.isFirefox&&!platform.isMacintosh?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}0===this.deltaY&&0===this.deltaX&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation()}}})),define(__m[21],__M([1,0,4]),(function(require,exports,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CancellationTokenSource=exports.CancellationToken=void 0;const shortcutEvent=Object.freeze((function(callback,context){const handle=setTimeout(callback.bind(context),0);return{dispose(){clearTimeout(handle)}}}));var CancellationToken;!function(CancellationToken){CancellationToken.isCancellationToken=function isCancellationToken(thing){return thing===CancellationToken.None||thing===CancellationToken.Cancelled||(thing instanceof MutableToken||!(!thing||"object"!=typeof thing)&&("boolean"==typeof thing.isCancellationRequested&&"function"==typeof thing.onCancellationRequested))},CancellationToken.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:event_1.Event.None}),CancellationToken.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:shortcutEvent})}(CancellationToken=exports.CancellationToken||(exports.CancellationToken={}));class MutableToken{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?shortcutEvent:(this._emitter||(this._emitter=new event_1.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}exports.CancellationTokenSource=class CancellationTokenSource{constructor(parent){this._token=void 0,this._parentListener=void 0,this._parentListener=parent&&parent.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=CancellationToken.Cancelled}dispose(cancel=!1){cancel&&this.cancel(),this._parentListener&&this._parentListener.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=CancellationToken.None}}}));var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__asyncValues=this&&this.__asyncValues||function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,m=o[Symbol.asyncIterator];return m?m.call(o):(o="function"==typeof __values?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){(function settle(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)})(resolve,reject,(v=o[n](v)).done,v.value)}))}}};define(__m[10],__M([1,0,21,13,4,2,16]),(function(require,exports,cancellation_1,errors_1,event_1,lifecycle_1,platform_1){"use strict";function createCancelablePromise(callback){const source=new cancellation_1.CancellationTokenSource,thenable=callback(source.token),promise=new Promise(((resolve,reject)=>{const subscription=source.token.onCancellationRequested((()=>{subscription.dispose(),source.dispose(),reject(new errors_1.CancellationError)}));Promise.resolve(thenable).then((value=>{subscription.dispose(),source.dispose(),resolve(value)}),(err=>{subscription.dispose(),source.dispose(),reject(err)}))}));return new class{cancel(){source.cancel()}then(resolve,reject){return promise.then(resolve,reject)}catch(reject){return this.then(void 0,reject)}finally(onfinally){return promise.finally(onfinally)}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCancelableAsyncIterable=exports.CancelableAsyncIterableObject=exports.AsyncIterableObject=exports.Promises=exports.DeferredPromise=exports.IdleValue=exports.runWhenIdle=exports.RunOnceScheduler=exports.IntervalTimer=exports.TimeoutTimer=exports.first=exports.disposableTimeout=exports.timeout=exports.ThrottledDelayer=exports.Delayer=exports.MicrotaskDelay=exports.Throttler=exports.raceCancellation=exports.createCancelablePromise=exports.isThenable=void 0,exports.isThenable=function isThenable(obj){return!!obj&&"function"==typeof obj.then},exports.createCancelablePromise=createCancelablePromise,exports.raceCancellation=function raceCancellation(promise,token,defaultValue){return new Promise(((resolve,reject)=>{const ref=token.onCancellationRequested((()=>{ref.dispose(),resolve(defaultValue)}));promise.then(resolve,reject).finally((()=>ref.dispose()))}))};class Throttler{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(promiseFactory){if(this.activePromise){if(this.queuedPromiseFactory=promiseFactory,!this.queuedPromise){const onComplete=()=>{this.queuedPromise=null;const result=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,result};this.queuedPromise=new Promise((resolve=>{this.activePromise.then(onComplete,onComplete).then(resolve)}))}return new Promise(((resolve,reject)=>{this.queuedPromise.then(resolve,reject)}))}return this.activePromise=promiseFactory(),new Promise(((resolve,reject)=>{this.activePromise.then((result=>{this.activePromise=null,resolve(result)}),(err=>{this.activePromise=null,reject(err)}))}))}}exports.Throttler=Throttler;exports.MicrotaskDelay=Symbol("MicrotaskDelay");class Delayer{constructor(defaultDelay){this.defaultDelay=defaultDelay,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(task,delay=this.defaultDelay){this.task=task,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((resolve,reject)=>{this.doResolve=resolve,this.doReject=reject})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const task=this.task;return this.task=null,task()}})));const fn=()=>{var _a;this.deferred=null,null===(_a=this.doResolve)||void 0===_a||_a.call(this,null)};return this.deferred=delay===exports.MicrotaskDelay?(fn=>{let scheduled=!0;return queueMicrotask((()=>{scheduled&&(scheduled=!1,fn())})),{isTriggered:()=>scheduled,dispose:()=>{scheduled=!1}}})(fn):((timeout,fn)=>{let scheduled=!0;const handle=setTimeout((()=>{scheduled=!1,fn()}),timeout);return{isTriggered:()=>scheduled,dispose:()=>{clearTimeout(handle),scheduled=!1}}})(delay,fn),this.completionPromise}isTriggered(){var _a;return!!(null===(_a=this.deferred)||void 0===_a?void 0:_a.isTriggered())}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject&&this.doReject(new errors_1.CancellationError),this.completionPromise=null)}cancelTimeout(){var _a;null===(_a=this.deferred)||void 0===_a||_a.dispose(),this.deferred=null}dispose(){this.cancel()}}exports.Delayer=Delayer;exports.ThrottledDelayer=class ThrottledDelayer{constructor(defaultDelay){this.delayer=new Delayer(defaultDelay),this.throttler=new Throttler}trigger(promiseFactory,delay){return this.delayer.trigger((()=>this.throttler.queue(promiseFactory)),delay)}dispose(){this.delayer.dispose()}},exports.timeout=function timeout(millis,token){return token?new Promise(((resolve,reject)=>{const handle=setTimeout((()=>{disposable.dispose(),resolve()}),millis),disposable=token.onCancellationRequested((()=>{clearTimeout(handle),disposable.dispose(),reject(new errors_1.CancellationError)}))})):createCancelablePromise((token=>timeout(millis,token)))},exports.disposableTimeout=function disposableTimeout(handler,timeout=0){const timer=setTimeout(handler,timeout);return(0,lifecycle_1.toDisposable)((()=>clearTimeout(timer)))},exports.first=function first(promiseFactories,shouldStop=(t=>!!t),defaultValue=null){let index=0;const len=promiseFactories.length,loop=()=>{if(index>=len)return Promise.resolve(defaultValue);const factory=promiseFactories[index++];return Promise.resolve(factory()).then((result=>shouldStop(result)?Promise.resolve(result):loop()))};return loop()};exports.TimeoutTimer=class TimeoutTimer{constructor(runner,timeout){this._token=-1,"function"==typeof runner&&"number"==typeof timeout&&this.setIfNotSet(runner,timeout)}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(runner,timeout){this.cancel(),this._token=setTimeout((()=>{this._token=-1,runner()}),timeout)}setIfNotSet(runner,timeout){-1===this._token&&(this._token=setTimeout((()=>{this._token=-1,runner()}),timeout))}};exports.IntervalTimer=class IntervalTimer{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearInterval(this._token),this._token=-1)}cancelAndSet(runner,interval){this.cancel(),this._token=setInterval((()=>{runner()}),interval)}};exports.RunOnceScheduler=class RunOnceScheduler{constructor(runner,delay){this.timeoutToken=-1,this.runner=runner,this.timeout=delay,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(delay=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,delay)}get delay(){return this.timeout}set delay(value){this.timeout=value}isScheduled(){return-1!==this.timeoutToken}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner&&this.runner()}},"function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback?exports.runWhenIdle=runner=>{(0,platform_1.setTimeout0)((()=>{if(disposed)return;const end=Date.now()+15;runner(Object.freeze({didTimeout:!0,timeRemaining:()=>Math.max(0,end-Date.now())}))}));let disposed=!1;return{dispose(){disposed||(disposed=!0)}}}:exports.runWhenIdle=(runner,timeout)=>{const handle=requestIdleCallback(runner,"number"==typeof timeout?{timeout}:void 0);let disposed=!1;return{dispose(){disposed||(disposed=!0,cancelIdleCallback(handle))}}};exports.IdleValue=class IdleValue{constructor(executor){this._didRun=!1,this._executor=()=>{try{this._value=executor()}catch(err){this._error=err}finally{this._didRun=!0}},this._handle=(0,exports.runWhenIdle)((()=>this._executor()))}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}};exports.DeferredPromise=class DeferredPromise{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((c,e)=>{this.completeCallback=c,this.errorCallback=e}))}get isRejected(){return this.rejected}get isSettled(){return this.rejected||this.resolved}complete(value){return new Promise((resolve=>{this.completeCallback(value),this.resolved=!0,resolve()}))}cancel(){new Promise((resolve=>{this.errorCallback(new errors_1.CancellationError),this.rejected=!0,resolve()}))}},function(Promises){Promises.settled=function settled(promises){return __awaiter(this,void 0,void 0,(function*(){let firstError;const result=yield Promise.all(promises.map((promise=>promise.then((value=>value),(error=>{firstError||(firstError=error)})))));if(void 0!==firstError)throw firstError;return result}))},Promises.withAsyncBody=function withAsyncBody(bodyFn){return new Promise(((resolve,reject)=>__awaiter(this,void 0,void 0,(function*(){try{yield bodyFn(resolve,reject)}catch(error){reject(error)}}))))}}(exports.Promises||(exports.Promises={}));class AsyncIterableObject{constructor(executor){this._state=0,this._results=[],this._error=null,this._onStateChanged=new event_1.Emitter,queueMicrotask((()=>__awaiter(this,void 0,void 0,(function*(){const writer={emitOne:item=>this.emitOne(item),emitMany:items=>this.emitMany(items),reject:error=>this.reject(error)};try{yield Promise.resolve(executor(writer)),this.resolve()}catch(err){this.reject(err)}finally{writer.emitOne=void 0,writer.emitMany=void 0,writer.reject=void 0}}))))}static fromArray(items){return new AsyncIterableObject((writer=>{writer.emitMany(items)}))}static fromPromise(promise){return new AsyncIterableObject((emitter=>__awaiter(this,void 0,void 0,(function*(){emitter.emitMany(yield promise)}))))}static fromPromises(promises){return new AsyncIterableObject((emitter=>__awaiter(this,void 0,void 0,(function*(){yield Promise.all(promises.map((p=>__awaiter(this,void 0,void 0,(function*(){return emitter.emitOne(yield p)})))))}))))}static merge(iterables){return new AsyncIterableObject((emitter=>__awaiter(this,void 0,void 0,(function*(){yield Promise.all(iterables.map((iterable=>{var iterable_1,iterable_1_1;return __awaiter(this,void 0,void 0,(function*(){var e_1,_a;try{for(iterable_1=__asyncValues(iterable);!(iterable_1_1=yield iterable_1.next()).done;){const item=iterable_1_1.value;emitter.emitOne(item)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{iterable_1_1&&!iterable_1_1.done&&(_a=iterable_1.return)&&(yield _a.call(iterable_1))}finally{if(e_1)throw e_1.error}}}))})))}))))}[Symbol.asyncIterator](){let i=0;return{next:()=>__awaiter(this,void 0,void 0,(function*(){for(;;){if(2===this._state)throw this._error;if(i<this._results.length)return{done:!1,value:this._results[i++]};if(1===this._state)return{done:!0,value:void 0};yield event_1.Event.toPromise(this._onStateChanged.event)}}))}}static map(iterable,mapFn){return new AsyncIterableObject((emitter=>__awaiter(this,void 0,void 0,(function*(){var e_2,_a;try{for(var iterable_2_1,iterable_2=__asyncValues(iterable);!(iterable_2_1=yield iterable_2.next()).done;){const item=iterable_2_1.value;emitter.emitOne(mapFn(item))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{iterable_2_1&&!iterable_2_1.done&&(_a=iterable_2.return)&&(yield _a.call(iterable_2))}finally{if(e_2)throw e_2.error}}}))))}map(mapFn){return AsyncIterableObject.map(this,mapFn)}static filter(iterable,filterFn){return new AsyncIterableObject((emitter=>__awaiter(this,void 0,void 0,(function*(){var e_3,_a;try{for(var iterable_3_1,iterable_3=__asyncValues(iterable);!(iterable_3_1=yield iterable_3.next()).done;){const item=iterable_3_1.value;filterFn(item)&&emitter.emitOne(item)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{iterable_3_1&&!iterable_3_1.done&&(_a=iterable_3.return)&&(yield _a.call(iterable_3))}finally{if(e_3)throw e_3.error}}}))))}filter(filterFn){return AsyncIterableObject.filter(this,filterFn)}static coalesce(iterable){return AsyncIterableObject.filter(iterable,(item=>!!item))}coalesce(){return AsyncIterableObject.coalesce(this)}static toPromise(iterable){var iterable_4,iterable_4_1,e_4,_a;return __awaiter(this,void 0,void 0,(function*(){const result=[];try{for(iterable_4=__asyncValues(iterable);!(iterable_4_1=yield iterable_4.next()).done;){const item=iterable_4_1.value;result.push(item)}}catch(e_4_1){e_4={error:e_4_1}}finally{try{iterable_4_1&&!iterable_4_1.done&&(_a=iterable_4.return)&&(yield _a.call(iterable_4))}finally{if(e_4)throw e_4.error}}return result}))}toPromise(){return AsyncIterableObject.toPromise(this)}emitOne(value){0===this._state&&(this._results.push(value),this._onStateChanged.fire())}emitMany(values){0===this._state&&(this._results=this._results.concat(values),this._onStateChanged.fire())}resolve(){0===this._state&&(this._state=1,this._onStateChanged.fire())}reject(error){0===this._state&&(this._state=2,this._error=error,this._onStateChanged.fire())}}exports.AsyncIterableObject=AsyncIterableObject,AsyncIterableObject.EMPTY=AsyncIterableObject.fromArray([]);class CancelableAsyncIterableObject extends AsyncIterableObject{constructor(_source,executor){super(executor),this._source=_source}cancel(){this._source.cancel()}}exports.CancelableAsyncIterableObject=CancelableAsyncIterableObject,exports.createCancelableAsyncIterable=function createCancelableAsyncIterable(callback){const source=new cancellation_1.CancellationTokenSource,innerIterable=callback(source.token);return new CancelableAsyncIterableObject(source,(emitter=>__awaiter(this,void 0,void 0,(function*(){var e_5,_a;const subscription=source.token.onCancellationRequested((()=>{subscription.dispose(),source.dispose(),emitter.reject(new errors_1.CancellationError)}));try{try{for(var innerIterable_1_1,innerIterable_1=__asyncValues(innerIterable);!(innerIterable_1_1=yield innerIterable_1.next()).done;){const item=innerIterable_1_1.value;if(source.token.isCancellationRequested)return;emitter.emitOne(item)}}catch(e_5_1){e_5={error:e_5_1}}finally{try{innerIterable_1_1&&!innerIterable_1_1.done&&(_a=innerIterable_1.return)&&(yield _a.call(innerIterable_1))}finally{if(e_5)throw e_5.error}}subscription.dispose(),source.dispose()}catch(err){subscription.dispose(),source.dispose(),emitter.reject(err)}}))))}})),define(__m[319],__M([1,0,10,2]),(function(require,exports,async_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScrollbarVisibilityController=void 0;class ScrollbarVisibilityController extends lifecycle_1.Disposable{constructor(visibility,visibleClassName,invisibleClassName){super(),this._visibility=visibility,this._visibleClassName=visibleClassName,this._invisibleClassName=invisibleClassName,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new async_1.TimeoutTimer)}setVisibility(visibility){this._visibility!==visibility&&(this._visibility=visibility,this._updateShouldBeVisible())}setShouldBeVisible(rawShouldBeVisible){this._rawShouldBeVisible=rawShouldBeVisible,this._updateShouldBeVisible()}_applyVisibilitySetting(){return 2!==this._visibility&&(3===this._visibility||this._rawShouldBeVisible)}_updateShouldBeVisible(){const shouldBeVisible=this._applyVisibilitySetting();this._shouldBeVisible!==shouldBeVisible&&(this._shouldBeVisible=shouldBeVisible,this.ensureVisibility())}setIsNeeded(isNeeded){this._isNeeded!==isNeeded&&(this._isNeeded=isNeeded,this.ensureVisibility())}setDomNode(domNode){this._domNode=domNode,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet((()=>{this._domNode&&this._domNode.setClassName(this._visibleClassName)}),0))}_hide(withFadeAway){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode&&this._domNode.setClassName(this._invisibleClassName+(withFadeAway?" fade":"")))}}exports.ScrollbarVisibilityController=ScrollbarVisibilityController})),define(__m[320],__M([1,0,10]),(function(require,exports,async_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.compareByPrefix=exports.compareAnything=exports.compareFileNames=void 0;const intlFileNameCollatorBaseNumeric=new async_1.IdleValue((()=>{const collator=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator,collatorIsNumeric:collator.resolvedOptions().numeric}}));new async_1.IdleValue((()=>({collator:new Intl.Collator(void 0,{numeric:!0})}))),new async_1.IdleValue((()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})})));function compareFileNames(one,other,caseSensitive=!1){const a=one||"",b=other||"",result=intlFileNameCollatorBaseNumeric.value.collator.compare(a,b);return intlFileNameCollatorBaseNumeric.value.collatorIsNumeric&&0===result&&a!==b?a<b?-1:1:result}function compareByPrefix(one,other,lookFor){const elementAName=one.toLowerCase(),elementBName=other.toLowerCase(),elementAPrefixMatch=elementAName.startsWith(lookFor),elementBPrefixMatch=elementBName.startsWith(lookFor);if(elementAPrefixMatch!==elementBPrefixMatch)return elementAPrefixMatch?-1:1;if(elementAPrefixMatch&&elementBPrefixMatch){if(elementAName.length<elementBName.length)return-1;if(elementAName.length>elementBName.length)return 1}return 0}exports.compareFileNames=compareFileNames,exports.compareAnything=function compareAnything(one,other,lookFor){const elementAName=one.toLowerCase(),elementBName=other.toLowerCase(),prefixCompare=compareByPrefix(one,other,lookFor);if(prefixCompare)return prefixCompare;const elementASuffixMatch=elementAName.endsWith(lookFor);if(elementASuffixMatch!==elementBName.endsWith(lookFor))return elementASuffixMatch?-1:1;const r=compareFileNames(elementAName,elementBName);return 0!==r?r:elementAName.localeCompare(elementBName)},exports.compareByPrefix=compareByPrefix})),define(__m[140],__M([1,0,4,2]),(function(require,exports,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SmoothScrollingOperation=exports.SmoothScrollingUpdate=exports.Scrollable=exports.ScrollState=void 0;class ScrollState{constructor(_forceIntegerValues,width,scrollWidth,scrollLeft,height,scrollHeight,scrollTop){this._forceIntegerValues=_forceIntegerValues,this._scrollStateBrand=void 0,this._forceIntegerValues&&(width|=0,scrollWidth|=0,scrollLeft|=0,height|=0,scrollHeight|=0,scrollTop|=0),this.rawScrollLeft=scrollLeft,this.rawScrollTop=scrollTop,width<0&&(width=0),scrollLeft+width>scrollWidth&&(scrollLeft=scrollWidth-width),scrollLeft<0&&(scrollLeft=0),height<0&&(height=0),scrollTop+height>scrollHeight&&(scrollTop=scrollHeight-height),scrollTop<0&&(scrollTop=0),this.width=width,this.scrollWidth=scrollWidth,this.scrollLeft=scrollLeft,this.height=height,this.scrollHeight=scrollHeight,this.scrollTop=scrollTop}equals(other){return this.rawScrollLeft===other.rawScrollLeft&&this.rawScrollTop===other.rawScrollTop&&this.width===other.width&&this.scrollWidth===other.scrollWidth&&this.scrollLeft===other.scrollLeft&&this.height===other.height&&this.scrollHeight===other.scrollHeight&&this.scrollTop===other.scrollTop}withScrollDimensions(update,useRawScrollPositions){return new ScrollState(this._forceIntegerValues,void 0!==update.width?update.width:this.width,void 0!==update.scrollWidth?update.scrollWidth:this.scrollWidth,useRawScrollPositions?this.rawScrollLeft:this.scrollLeft,void 0!==update.height?update.height:this.height,void 0!==update.scrollHeight?update.scrollHeight:this.scrollHeight,useRawScrollPositions?this.rawScrollTop:this.scrollTop)}withScrollPosition(update){return new ScrollState(this._forceIntegerValues,this.width,this.scrollWidth,void 0!==update.scrollLeft?update.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,void 0!==update.scrollTop?update.scrollTop:this.rawScrollTop)}createScrollEvent(previous,inSmoothScrolling){const widthChanged=this.width!==previous.width,scrollWidthChanged=this.scrollWidth!==previous.scrollWidth,scrollLeftChanged=this.scrollLeft!==previous.scrollLeft,heightChanged=this.height!==previous.height,scrollHeightChanged=this.scrollHeight!==previous.scrollHeight,scrollTopChanged=this.scrollTop!==previous.scrollTop;return{inSmoothScrolling,oldWidth:previous.width,oldScrollWidth:previous.scrollWidth,oldScrollLeft:previous.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:previous.height,oldScrollHeight:previous.scrollHeight,oldScrollTop:previous.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged,scrollWidthChanged,scrollLeftChanged,heightChanged,scrollHeightChanged,scrollTopChanged}}}exports.ScrollState=ScrollState;class Scrollable extends lifecycle_1.Disposable{constructor(options){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new event_1.Emitter),this.onScroll=this._onScroll.event,this._smoothScrollDuration=options.smoothScrollDuration,this._scheduleAtNextAnimationFrame=options.scheduleAtNextAnimationFrame,this._state=new ScrollState(options.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(smoothScrollDuration){this._smoothScrollDuration=smoothScrollDuration}validateScrollPosition(scrollPosition){return this._state.withScrollPosition(scrollPosition)}getScrollDimensions(){return this._state}setScrollDimensions(dimensions,useRawScrollPositions){const newState=this._state.withScrollDimensions(dimensions,useRawScrollPositions);this._setState(newState,Boolean(this._smoothScrolling)),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(update){const newState=this._state.withScrollPosition(update);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(newState,!1)}setScrollPositionSmooth(update,reuseAnimation){if(0===this._smoothScrollDuration)return this.setScrollPositionNow(update);if(this._smoothScrolling){update={scrollLeft:void 0===update.scrollLeft?this._smoothScrolling.to.scrollLeft:update.scrollLeft,scrollTop:void 0===update.scrollTop?this._smoothScrolling.to.scrollTop:update.scrollTop};const validTarget=this._state.withScrollPosition(update);if(this._smoothScrolling.to.scrollLeft===validTarget.scrollLeft&&this._smoothScrolling.to.scrollTop===validTarget.scrollTop)return;let newSmoothScrolling;newSmoothScrolling=reuseAnimation?new SmoothScrollingOperation(this._smoothScrolling.from,validTarget,this._smoothScrolling.startTime,this._smoothScrolling.duration):this._smoothScrolling.combine(this._state,validTarget,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=newSmoothScrolling}else{const validTarget=this._state.withScrollPosition(update);this._smoothScrolling=SmoothScrollingOperation.start(this._state,validTarget,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))}_performSmoothScrolling(){if(!this._smoothScrolling)return;const update=this._smoothScrolling.tick(),newState=this._state.withScrollPosition(update);return this._setState(newState,!0),this._smoothScrolling?update.isDone?(this._smoothScrolling.dispose(),void(this._smoothScrolling=null)):void(this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))):void 0}_setState(newState,inSmoothScrolling){const oldState=this._state;oldState.equals(newState)||(this._state=newState,this._onScroll.fire(this._state.createScrollEvent(oldState,inSmoothScrolling)))}}exports.Scrollable=Scrollable;class SmoothScrollingUpdate{constructor(scrollLeft,scrollTop,isDone){this.scrollLeft=scrollLeft,this.scrollTop=scrollTop,this.isDone=isDone}}function createEaseOutCubic(from,to){const delta=to-from;return function(completion){return from+delta*function easeOutCubic(t){return 1-function easeInCubic(t){return Math.pow(t,3)}(1-t)}(completion)}}exports.SmoothScrollingUpdate=SmoothScrollingUpdate;class SmoothScrollingOperation{constructor(from,to,startTime,duration){this.from=from,this.to=to,this.duration=duration,this.startTime=startTime,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(from,to,viewportSize){if(Math.abs(from-to)>2.5*viewportSize){let stop1,stop2;return from<to?(stop1=from+.75*viewportSize,stop2=to-.75*viewportSize):(stop1=from-.75*viewportSize,stop2=to+.75*viewportSize),function createComposed(a,b,cut){return function(completion){return completion<cut?a(completion/cut):b((completion-cut)/(1-cut))}}(createEaseOutCubic(from,stop1),createEaseOutCubic(stop2,to),.33)}return createEaseOutCubic(from,to)}dispose(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(state){this.to=state.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(now){const completion=(now-this.startTime)/this.duration;if(completion<1){const newScrollLeft=this.scrollLeft(completion),newScrollTop=this.scrollTop(completion);return new SmoothScrollingUpdate(newScrollLeft,newScrollTop,!1)}return new SmoothScrollingUpdate(this.to.scrollLeft,this.to.scrollTop,!0)}combine(from,to,duration){return SmoothScrollingOperation.start(from,to,duration)}static start(from,to,duration){duration+=10;const startTime=Date.now()-10;return new SmoothScrollingOperation(from,to,startTime,duration)}}exports.SmoothScrollingOperation=SmoothScrollingOperation})),define(__m[8],__M([1,0,312,137]),(function(require,exports,cache_1,lazy_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.InvisibleCharacters=exports.AmbiguousCharacters=exports.noBreakWhitespace=exports.getLeftDeleteOffset=exports.singleLetterHash=exports.containsUppercaseCharacter=exports.startsWithUTF8BOM=exports.UTF8_BOM_CHARACTER=exports.isEmojiImprecise=exports.isFullWidthCharacter=exports.containsUnusualLineTerminators=exports.UNUSUAL_LINE_TERMINATORS=exports.isBasicASCII=exports.containsRTL=exports.getCharContainingOffset=exports.prevCharLength=exports.nextCharLength=exports.GraphemeIterator=exports.CodePointIterator=exports.getNextCodePoint=exports.computeCodePoint=exports.isLowSurrogate=exports.isHighSurrogate=exports.commonSuffixLength=exports.commonPrefixLength=exports.startsWithIgnoreCase=exports.equalsIgnoreCase=exports.isUpperAsciiLetter=exports.isLowerAsciiLetter=exports.compareSubstringIgnoreCase=exports.compareIgnoreCase=exports.compareSubstring=exports.compare=exports.lastNonWhitespaceIndex=exports.getLeadingWhitespace=exports.firstNonWhitespaceIndex=exports.splitLines=exports.regExpFlags=exports.regExpLeadsToEndlessLoop=exports.createRegExp=exports.stripWildcards=exports.convertSimple2RegExpPattern=exports.rtrim=exports.ltrim=exports.trim=exports.escapeRegExpCharacters=exports.escape=exports.format=exports.isFalsyOrWhitespace=void 0,exports.isFalsyOrWhitespace=function isFalsyOrWhitespace(str){return!str||"string"!=typeof str||0===str.trim().length};const _formatRegexp=/{(\d+)}/g;function escapeRegExpCharacters(value){return value.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function ltrim(haystack,needle){if(!haystack||!needle)return haystack;const needleLen=needle.length;if(0===needleLen||0===haystack.length)return haystack;let offset=0;for(;haystack.indexOf(needle,offset)===offset;)offset+=needleLen;return haystack.substring(offset)}function rtrim(haystack,needle){if(!haystack||!needle)return haystack;const needleLen=needle.length,haystackLen=haystack.length;if(0===needleLen||0===haystackLen)return haystack;let offset=haystackLen,idx=-1;for(;idx=haystack.lastIndexOf(needle,offset-1),-1!==idx&&idx+needleLen===offset;){if(0===idx)return"";offset=idx}return haystack.substring(0,offset)}function compareSubstring(a,b,aStart=0,aEnd=a.length,bStart=0,bEnd=b.length){for(;aStart<aEnd&&bStart<bEnd;aStart++,bStart++){let codeA=a.charCodeAt(aStart),codeB=b.charCodeAt(bStart);if(codeA<codeB)return-1;if(codeA>codeB)return 1}const aLen=aEnd-aStart,bLen=bEnd-bStart;return aLen<bLen?-1:aLen>bLen?1:0}function compareSubstringIgnoreCase(a,b,aStart=0,aEnd=a.length,bStart=0,bEnd=b.length){for(;aStart<aEnd&&bStart<bEnd;aStart++,bStart++){let codeA=a.charCodeAt(aStart),codeB=b.charCodeAt(bStart);if(codeA===codeB)continue;if(codeA>=128||codeB>=128)return compareSubstring(a.toLowerCase(),b.toLowerCase(),aStart,aEnd,bStart,bEnd);isLowerAsciiLetter(codeA)&&(codeA-=32),isLowerAsciiLetter(codeB)&&(codeB-=32);const diff=codeA-codeB;if(0!==diff)return diff}const aLen=aEnd-aStart,bLen=bEnd-bStart;return aLen<bLen?-1:aLen>bLen?1:0}function isLowerAsciiLetter(code){return code>=97&&code<=122}function isHighSurrogate(charCode){return 55296<=charCode&&charCode<=56319}function isLowSurrogate(charCode){return 56320<=charCode&&charCode<=57343}function computeCodePoint(highSurrogate,lowSurrogate){return lowSurrogate-56320+(highSurrogate-55296<<10)+65536}function getNextCodePoint(str,len,offset){const charCode=str.charCodeAt(offset);if(isHighSurrogate(charCode)&&offset+1<len){const nextCharCode=str.charCodeAt(offset+1);if(isLowSurrogate(nextCharCode))return computeCodePoint(charCode,nextCharCode)}return charCode}exports.format=function format(value,...args){return 0===args.length?value:value.replace(_formatRegexp,(function(match,group){const idx=parseInt(group,10);return isNaN(idx)||idx<0||idx>=args.length?match:args[idx]}))},exports.escape=function escape(html){return html.replace(/[<>&]/g,(function(match){switch(match){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return match}}))},exports.escapeRegExpCharacters=escapeRegExpCharacters,exports.trim=function trim(haystack,needle=" "){return rtrim(ltrim(haystack,needle),needle)},exports.ltrim=ltrim,exports.rtrim=rtrim,exports.convertSimple2RegExpPattern=function convertSimple2RegExpPattern(pattern){return pattern.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")},exports.stripWildcards=function stripWildcards(pattern){return pattern.replace(/\*/g,"")},exports.createRegExp=function createRegExp(searchString,isRegex,options={}){if(!searchString)throw new Error("Cannot create regex from empty string");isRegex||(searchString=escapeRegExpCharacters(searchString)),options.wholeWord&&(/\B/.test(searchString.charAt(0))||(searchString="\\b"+searchString),/\B/.test(searchString.charAt(searchString.length-1))||(searchString+="\\b"));let modifiers="";return options.global&&(modifiers+="g"),options.matchCase||(modifiers+="i"),options.multiline&&(modifiers+="m"),options.unicode&&(modifiers+="u"),new RegExp(searchString,modifiers)},exports.regExpLeadsToEndlessLoop=function regExpLeadsToEndlessLoop(regexp){return"^"!==regexp.source&&"^$"!==regexp.source&&"$"!==regexp.source&&"^\\s*$"!==regexp.source&&!(!regexp.exec("")||0!==regexp.lastIndex)},exports.regExpFlags=function regExpFlags(regexp){return(regexp.global?"g":"")+(regexp.ignoreCase?"i":"")+(regexp.multiline?"m":"")+(regexp.unicode?"u":"")},exports.splitLines=function splitLines(str){return str.split(/\r\n|\r|\n/)},exports.firstNonWhitespaceIndex=function firstNonWhitespaceIndex(str){for(let i=0,len=str.length;i<len;i++){const chCode=str.charCodeAt(i);if(32!==chCode&&9!==chCode)return i}return-1},exports.getLeadingWhitespace=function getLeadingWhitespace(str,start=0,end=str.length){for(let i=start;i<end;i++){const chCode=str.charCodeAt(i);if(32!==chCode&&9!==chCode)return str.substring(start,i)}return str.substring(start,end)},exports.lastNonWhitespaceIndex=function lastNonWhitespaceIndex(str,startIndex=str.length-1){for(let i=startIndex;i>=0;i--){const chCode=str.charCodeAt(i);if(32!==chCode&&9!==chCode)return i}return-1},exports.compare=function compare(a,b){return a<b?-1:a>b?1:0},exports.compareSubstring=compareSubstring,exports.compareIgnoreCase=function compareIgnoreCase(a,b){return compareSubstringIgnoreCase(a,b,0,a.length,0,b.length)},exports.compareSubstringIgnoreCase=compareSubstringIgnoreCase,exports.isLowerAsciiLetter=isLowerAsciiLetter,exports.isUpperAsciiLetter=function isUpperAsciiLetter(code){return code>=65&&code<=90},exports.equalsIgnoreCase=function equalsIgnoreCase(a,b){return a.length===b.length&&0===compareSubstringIgnoreCase(a,b)},exports.startsWithIgnoreCase=function startsWithIgnoreCase(str,candidate){const candidateLength=candidate.length;return!(candidate.length>str.length)&&0===compareSubstringIgnoreCase(str,candidate,0,candidateLength)},exports.commonPrefixLength=function commonPrefixLength(a,b){let i,len=Math.min(a.length,b.length);for(i=0;i<len;i++)if(a.charCodeAt(i)!==b.charCodeAt(i))return i;return len},exports.commonSuffixLength=function commonSuffixLength(a,b){let i,len=Math.min(a.length,b.length);const aLastIndex=a.length-1,bLastIndex=b.length-1;for(i=0;i<len;i++)if(a.charCodeAt(aLastIndex-i)!==b.charCodeAt(bLastIndex-i))return i;return len},exports.isHighSurrogate=isHighSurrogate,exports.isLowSurrogate=isLowSurrogate,exports.computeCodePoint=computeCodePoint,exports.getNextCodePoint=getNextCodePoint;class CodePointIterator{constructor(str,offset=0){this._str=str,this._len=str.length,this._offset=offset}get offset(){return this._offset}setOffset(offset){this._offset=offset}prevCodePoint(){const codePoint=function getPrevCodePoint(str,offset){const charCode=str.charCodeAt(offset-1);if(isLowSurrogate(charCode)&&offset>1){const prevCharCode=str.charCodeAt(offset-2);if(isHighSurrogate(prevCharCode))return computeCodePoint(prevCharCode,charCode)}return charCode}(this._str,this._offset);return this._offset-=codePoint>=65536?2:1,codePoint}nextCodePoint(){const codePoint=getNextCodePoint(this._str,this._len,this._offset);return this._offset+=codePoint>=65536?2:1,codePoint}eol(){return this._offset>=this._len}}exports.CodePointIterator=CodePointIterator;class GraphemeIterator{constructor(str,offset=0){this._iterator=new CodePointIterator(str,offset)}get offset(){return this._iterator.offset}nextGraphemeLength(){const graphemeBreakTree=GraphemeBreakTree.getInstance(),iterator=this._iterator,initialOffset=iterator.offset;let graphemeBreakType=graphemeBreakTree.getGraphemeBreakType(iterator.nextCodePoint());for(;!iterator.eol();){const offset=iterator.offset,nextGraphemeBreakType=graphemeBreakTree.getGraphemeBreakType(iterator.nextCodePoint());if(breakBetweenGraphemeBreakType(graphemeBreakType,nextGraphemeBreakType)){iterator.setOffset(offset);break}graphemeBreakType=nextGraphemeBreakType}return iterator.offset-initialOffset}prevGraphemeLength(){const graphemeBreakTree=GraphemeBreakTree.getInstance(),iterator=this._iterator,initialOffset=iterator.offset;let graphemeBreakType=graphemeBreakTree.getGraphemeBreakType(iterator.prevCodePoint());for(;iterator.offset>0;){const offset=iterator.offset,prevGraphemeBreakType=graphemeBreakTree.getGraphemeBreakType(iterator.prevCodePoint());if(breakBetweenGraphemeBreakType(prevGraphemeBreakType,graphemeBreakType)){iterator.setOffset(offset);break}graphemeBreakType=prevGraphemeBreakType}return initialOffset-iterator.offset}eol(){return this._iterator.eol()}}function nextCharLength(str,initialOffset){return new GraphemeIterator(str,initialOffset).nextGraphemeLength()}function prevCharLength(str,initialOffset){return new GraphemeIterator(str,initialOffset).prevGraphemeLength()}exports.GraphemeIterator=GraphemeIterator,exports.nextCharLength=nextCharLength,exports.prevCharLength=prevCharLength,exports.getCharContainingOffset=function getCharContainingOffset(str,offset){offset>0&&isLowSurrogate(str.charCodeAt(offset))&&offset--;const endOffset=offset+nextCharLength(str,offset);return[endOffset-prevCharLength(str,endOffset),endOffset]};const CONTAINS_RTL=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/;exports.containsRTL=function containsRTL(str){return CONTAINS_RTL.test(str)};const IS_BASIC_ASCII=/^[\t\n\r\x20-\x7E]*$/;function isEmojiImprecise(x){return x>=127462&&x<=127487||8986===x||8987===x||9200===x||9203===x||x>=9728&&x<=10175||11088===x||11093===x||x>=127744&&x<=128591||x>=128640&&x<=128764||x>=128992&&x<=129008||x>=129280&&x<=129535||x>=129648&&x<=129782}function breakBetweenGraphemeBreakType(breakTypeA,breakTypeB){return 0===breakTypeA?5!==breakTypeB&&7!==breakTypeB:(2!==breakTypeA||3!==breakTypeB)&&(4===breakTypeA||2===breakTypeA||3===breakTypeA||(4===breakTypeB||2===breakTypeB||3===breakTypeB||(8!==breakTypeA||8!==breakTypeB&&9!==breakTypeB&&11!==breakTypeB&&12!==breakTypeB)&&((11!==breakTypeA&&9!==breakTypeA||9!==breakTypeB&&10!==breakTypeB)&&((12!==breakTypeA&&10!==breakTypeA||10!==breakTypeB)&&(5!==breakTypeB&&13!==breakTypeB&&(7!==breakTypeB&&(1!==breakTypeA&&((13!==breakTypeA||14!==breakTypeB)&&(6!==breakTypeA||6!==breakTypeB)))))))))}exports.isBasicASCII=function isBasicASCII(str){return IS_BASIC_ASCII.test(str)},exports.UNUSUAL_LINE_TERMINATORS=/[\u2028\u2029]/,exports.containsUnusualLineTerminators=function containsUnusualLineTerminators(str){return exports.UNUSUAL_LINE_TERMINATORS.test(str)},exports.isFullWidthCharacter=function isFullWidthCharacter(charCode){return charCode>=11904&&charCode<=55215||charCode>=63744&&charCode<=64255||charCode>=65281&&charCode<=65374},exports.isEmojiImprecise=isEmojiImprecise,exports.UTF8_BOM_CHARACTER=String.fromCharCode(65279),exports.startsWithUTF8BOM=function startsWithUTF8BOM(str){return!!(str&&str.length>0&&65279===str.charCodeAt(0))},exports.containsUppercaseCharacter=function containsUppercaseCharacter(target,ignoreEscapedChars=!1){return!!target&&(ignoreEscapedChars&&(target=target.replace(/\\./g,"")),target.toLowerCase()!==target)},exports.singleLetterHash=function singleLetterHash(n){return(n%=52)<26?String.fromCharCode(97+n):String.fromCharCode(65+n-26)};class GraphemeBreakTree{constructor(){this._data=function getGraphemeBreakRawData(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}()}static getInstance(){return GraphemeBreakTree._INSTANCE||(GraphemeBreakTree._INSTANCE=new GraphemeBreakTree),GraphemeBreakTree._INSTANCE}getGraphemeBreakType(codePoint){if(codePoint<32)return 10===codePoint?3:13===codePoint?2:4;if(codePoint<127)return 0;const data=this._data,nodeCount=data.length/3;let nodeIndex=1;for(;nodeIndex<=nodeCount;)if(codePoint<data[3*nodeIndex])nodeIndex*=2;else{if(!(codePoint>data[3*nodeIndex+1]))return data[3*nodeIndex+2];nodeIndex=2*nodeIndex+1}return 0}}function isEmojiModifier(codePoint){return 127995<=codePoint&&codePoint<=127999}GraphemeBreakTree._INSTANCE=null,exports.getLeftDeleteOffset=function getLeftDeleteOffset(offset,str){if(0===offset)return 0;const emojiOffset=function getOffsetBeforeLastEmojiComponent(initialOffset,str){const iterator=new CodePointIterator(str,initialOffset);let codePoint=iterator.prevCodePoint();for(;isEmojiModifier(codePoint)||65039===codePoint||8419===codePoint;){if(0===iterator.offset)return;codePoint=iterator.prevCodePoint()}if(!isEmojiImprecise(codePoint))return;let resultOffset=iterator.offset;if(resultOffset>0){8205===iterator.prevCodePoint()&&(resultOffset=iterator.offset)}return resultOffset}(offset,str);if(void 0!==emojiOffset)return emojiOffset;const iterator=new CodePointIterator(str,offset);return iterator.prevCodePoint(),iterator.offset},exports.noBreakWhitespace=" ";class AmbiguousCharacters{constructor(confusableDictionary){this.confusableDictionary=confusableDictionary}static getInstance(locales){return AmbiguousCharacters.cache.get(Array.from(locales))}static getLocales(){return AmbiguousCharacters._locales.getValue()}isAmbiguous(codePoint){return this.confusableDictionary.has(codePoint)}getPrimaryConfusable(codePoint){return this.confusableDictionary.get(codePoint)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}exports.AmbiguousCharacters=AmbiguousCharacters,_a=AmbiguousCharacters,AmbiguousCharacters.ambiguousCharacterData=new lazy_1.Lazy((()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))),AmbiguousCharacters.cache=new cache_1.LRUCachedComputed((locales=>{function arrayToMap(arr){const result=new Map;for(let i=0;i<arr.length;i+=2)result.set(arr[i],arr[i+1]);return result}function intersectMaps(map1,map2){if(!map1)return map2;const result=new Map;for(const[key,value]of map1)map2.has(key)&&result.set(key,value);return result}const data=_a.ambiguousCharacterData.getValue();let languageSpecificMap,filteredLocales=locales.filter((l=>!l.startsWith("_")&&l in data));0===filteredLocales.length&&(filteredLocales=["_default"]);for(const locale of filteredLocales){languageSpecificMap=intersectMaps(languageSpecificMap,arrayToMap(data[locale]))}const map=function mergeMaps(map1,map2){const result=new Map(map1);for(const[key,value]of map2)result.set(key,value);return result}(arrayToMap(data._common),languageSpecificMap);return new AmbiguousCharacters(map)})),AmbiguousCharacters._locales=new lazy_1.Lazy((()=>Object.keys(AmbiguousCharacters.ambiguousCharacterData.getValue()).filter((k=>!k.startsWith("_")))));class InvisibleCharacters{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(InvisibleCharacters.getRawData())),this._data}static isInvisibleCharacter(codePoint){return InvisibleCharacters.getData().has(codePoint)}static get codePoints(){return InvisibleCharacters.getData()}}exports.InvisibleCharacters=InvisibleCharacters,InvisibleCharacters._data=void 0})),define(__m[168],__M([1,0,84,16,8]),(function(require,exports,path_1,platform_1,strings_1){"use strict";function isPathSeparator(code){return 47===code||92===code}function toSlashes(osPath){return osPath.replace(/[\\/]/g,path_1.posix.sep)}function isWindowsDriveLetter(char0){return char0>=65&&char0<=90||char0>=97&&char0<=122}function hasDriveLetter(path,continueAsWindows){return!!(void 0!==continueAsWindows?continueAsWindows:platform_1.isWindows)&&(isWindowsDriveLetter(path.charCodeAt(0))&&58===path.charCodeAt(1))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasDriveLetter=exports.isRootOrDriveLetter=exports.isWindowsDriveLetter=exports.isEqualOrParent=exports.getRoot=exports.toPosixPath=exports.toSlashes=exports.isPathSeparator=void 0,exports.isPathSeparator=isPathSeparator,exports.toSlashes=toSlashes,exports.toPosixPath=function toPosixPath(osPath){return-1===osPath.indexOf("/")&&(osPath=toSlashes(osPath)),/^[a-zA-Z]:(\/|$)/.test(osPath)&&(osPath="/"+osPath),osPath},exports.getRoot=function getRoot(path,sep=path_1.posix.sep){if(!path)return"";const len=path.length,firstLetter=path.charCodeAt(0);if(isPathSeparator(firstLetter)){if(isPathSeparator(path.charCodeAt(1))&&!isPathSeparator(path.charCodeAt(2))){let pos=3;const start=pos;for(;pos<len&&!isPathSeparator(path.charCodeAt(pos));pos++);if(start!==pos&&!isPathSeparator(path.charCodeAt(pos+1)))for(pos+=1;pos<len;pos++)if(isPathSeparator(path.charCodeAt(pos)))return path.slice(0,pos+1).replace(/[\\/]/g,sep)}return sep}if(isWindowsDriveLetter(firstLetter)&&58===path.charCodeAt(1))return isPathSeparator(path.charCodeAt(2))?path.slice(0,2)+sep:path.slice(0,2);let pos=path.indexOf("://");if(-1!==pos)for(pos+=3;pos<len;pos++)if(isPathSeparator(path.charCodeAt(pos)))return path.slice(0,pos+1);return""},exports.isEqualOrParent=function isEqualOrParent(base,parentCandidate,ignoreCase,separator=path_1.sep){if(base===parentCandidate)return!0;if(!base||!parentCandidate)return!1;if(parentCandidate.length>base.length)return!1;if(ignoreCase){if(!(0,strings_1.startsWithIgnoreCase)(base,parentCandidate))return!1;if(parentCandidate.length===base.length)return!0;let sepOffset=parentCandidate.length;return parentCandidate.charAt(parentCandidate.length-1)===separator&&sepOffset--,base.charAt(sepOffset)===separator}return parentCandidate.charAt(parentCandidate.length-1)!==separator&&(parentCandidate+=separator),0===base.indexOf(parentCandidate)},exports.isWindowsDriveLetter=isWindowsDriveLetter,exports.isRootOrDriveLetter=function isRootOrDriveLetter(path){const pathNormalized=(0,path_1.normalize)(path);return platform_1.isWindows?!(path.length>3)&&(hasDriveLetter(pathNormalized)&&(2===path.length||92===pathNormalized.charCodeAt(2))):pathNormalized===path_1.posix.sep},exports.hasDriveLetter=hasDriveLetter})),define(__m[114],__M([1,0,8]),(function(require,exports,strings){"use strict";function doHash(obj,hashVal){switch(typeof obj){case"object":return null===obj?numberHash(349,hashVal):Array.isArray(obj)?function arrayHash(arr,initialHashVal){return initialHashVal=numberHash(104579,initialHashVal),arr.reduce(((hashVal,item)=>doHash(item,hashVal)),initialHashVal)}(obj,hashVal):function objectHash(obj,initialHashVal){return initialHashVal=numberHash(181387,initialHashVal),Object.keys(obj).sort().reduce(((hashVal,key)=>(hashVal=stringHash(key,hashVal),doHash(obj[key],hashVal))),initialHashVal)}(obj,hashVal);case"string":return stringHash(obj,hashVal);case"boolean":return function booleanHash(b,initialHashVal){return numberHash(b?433:863,initialHashVal)}(obj,hashVal);case"number":return numberHash(obj,hashVal);case"undefined":return numberHash(937,hashVal);default:return numberHash(617,hashVal)}}function numberHash(val,initialHashVal){return(initialHashVal<<5)-initialHashVal+val|0}function stringHash(s,hashVal){hashVal=numberHash(149417,hashVal);for(let i=0,length=s.length;i<length;i++)hashVal=numberHash(s.charCodeAt(i),hashVal);return hashVal}function leftRotate(value,bits,totalBits=32){const delta=totalBits-bits;return(value<<bits|(~((1<<delta)-1)&value)>>>delta)>>>0}function fill(dest,index=0,count=dest.byteLength,value=0){for(let i=0;i<count;i++)dest[index+i]=value}function toHexString(bufferOrValue,bitsize=32){return bufferOrValue instanceof ArrayBuffer?Array.from(new Uint8Array(bufferOrValue)).map((b=>b.toString(16).padStart(2,"0"))).join(""):function leftPad(value,length,char="0"){for(;value.length<length;)value=char+value;return value}((bufferOrValue>>>0).toString(16),bitsize/4)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringSHA1=exports.toHexString=exports.stringHash=exports.numberHash=exports.doHash=exports.hash=void 0,exports.hash=function hash(obj){return doHash(obj,0)},exports.doHash=doHash,exports.numberHash=numberHash,exports.stringHash=stringHash,exports.toHexString=toHexString;class StringSHA1{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(str){const strLen=str.length;if(0===strLen)return;const buff=this._buff;let charCode,offset,buffLen=this._buffLen,leftoverHighSurrogate=this._leftoverHighSurrogate;for(0!==leftoverHighSurrogate?(charCode=leftoverHighSurrogate,offset=-1,leftoverHighSurrogate=0):(charCode=str.charCodeAt(0),offset=0);;){let codePoint=charCode;if(strings.isHighSurrogate(charCode)){if(!(offset+1<strLen)){leftoverHighSurrogate=charCode;break}{const nextCharCode=str.charCodeAt(offset+1);strings.isLowSurrogate(nextCharCode)?(offset++,codePoint=strings.computeCodePoint(charCode,nextCharCode)):codePoint=65533}}else strings.isLowSurrogate(charCode)&&(codePoint=65533);if(buffLen=this._push(buff,buffLen,codePoint),offset++,!(offset<strLen))break;charCode=str.charCodeAt(offset)}this._buffLen=buffLen,this._leftoverHighSurrogate=leftoverHighSurrogate}_push(buff,buffLen,codePoint){return codePoint<128?buff[buffLen++]=codePoint:codePoint<2048?(buff[buffLen++]=192|(1984&codePoint)>>>6,buff[buffLen++]=128|(63&codePoint)>>>0):codePoint<65536?(buff[buffLen++]=224|(61440&codePoint)>>>12,buff[buffLen++]=128|(4032&codePoint)>>>6,buff[buffLen++]=128|(63&codePoint)>>>0):(buff[buffLen++]=240|(1835008&codePoint)>>>18,buff[buffLen++]=128|(258048&codePoint)>>>12,buff[buffLen++]=128|(4032&codePoint)>>>6,buff[buffLen++]=128|(63&codePoint)>>>0),buffLen>=64&&(this._step(),buffLen-=64,this._totalLen+=64,buff[0]=buff[64],buff[1]=buff[65],buff[2]=buff[66]),buffLen}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),toHexString(this._h0)+toHexString(this._h1)+toHexString(this._h2)+toHexString(this._h3)+toHexString(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,fill(this._buff,this._buffLen),this._buffLen>56&&(this._step(),fill(this._buff));const ml=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(ml/4294967296),!1),this._buffDV.setUint32(60,ml%4294967296,!1),this._step()}_step(){const bigBlock32=StringSHA1._bigBlock32,data=this._buffDV;for(let j=0;j<64;j+=4)bigBlock32.setUint32(j,data.getUint32(j,!1),!1);for(let j=64;j<320;j+=4)bigBlock32.setUint32(j,leftRotate(bigBlock32.getUint32(j-12,!1)^bigBlock32.getUint32(j-32,!1)^bigBlock32.getUint32(j-56,!1)^bigBlock32.getUint32(j-64,!1),1),!1);let f,k,temp,a=this._h0,b=this._h1,c=this._h2,d=this._h3,e=this._h4;for(let j=0;j<80;j++)j<20?(f=b&c|~b&d,k=1518500249):j<40?(f=b^c^d,k=1859775393):j<60?(f=b&c|b&d|c&d,k=2400959708):(f=b^c^d,k=3395469782),temp=leftRotate(a,5)+f+e+k+bigBlock32.getUint32(4*j,!1)&4294967295,e=d,d=c,c=leftRotate(b,30),b=a,a=temp;this._h0=this._h0+a&4294967295,this._h1=this._h1+b&4294967295,this._h2=this._h2+c&4294967295,this._h3=this._h3+d&4294967295,this._h4=this._h4+e&4294967295}}exports.StringSHA1=StringSHA1,StringSHA1._bigBlock32=new DataView(new ArrayBuffer(320))})),define(__m[141],__M([1,0,313,114]),(function(require,exports,diffChange_1,hash_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LcsDiff=exports.MyArray=exports.Debug=exports.stringDiff=exports.StringDiffSequence=void 0;class StringDiffSequence{constructor(source){this.source=source}getElements(){const source=this.source,characters=new Int32Array(source.length);for(let i=0,len=source.length;i<len;i++)characters[i]=source.charCodeAt(i);return characters}}exports.StringDiffSequence=StringDiffSequence,exports.stringDiff=function stringDiff(original,modified,pretty){return new LcsDiff(new StringDiffSequence(original),new StringDiffSequence(modified)).ComputeDiff(pretty).changes};class Debug{static Assert(condition,message){if(!condition)throw new Error(message)}}exports.Debug=Debug;class MyArray{static Copy(sourceArray,sourceIndex,destinationArray,destinationIndex,length){for(let i=0;i<length;i++)destinationArray[destinationIndex+i]=sourceArray[sourceIndex+i]}static Copy2(sourceArray,sourceIndex,destinationArray,destinationIndex,length){for(let i=0;i<length;i++)destinationArray[destinationIndex+i]=sourceArray[sourceIndex+i]}}exports.MyArray=MyArray;class DiffChangeHelper{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new diffChange_1.DiffChange(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(originalIndex,modifiedIndex){this.m_originalStart=Math.min(this.m_originalStart,originalIndex),this.m_modifiedStart=Math.min(this.m_modifiedStart,modifiedIndex),this.m_originalCount++}AddModifiedElement(originalIndex,modifiedIndex){this.m_originalStart=Math.min(this.m_originalStart,originalIndex),this.m_modifiedStart=Math.min(this.m_modifiedStart,modifiedIndex),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class LcsDiff{constructor(originalSequence,modifiedSequence,continueProcessingPredicate=null){this.ContinueProcessingPredicate=continueProcessingPredicate,this._originalSequence=originalSequence,this._modifiedSequence=modifiedSequence;const[originalStringElements,originalElementsOrHash,originalHasStrings]=LcsDiff._getElements(originalSequence),[modifiedStringElements,modifiedElementsOrHash,modifiedHasStrings]=LcsDiff._getElements(modifiedSequence);this._hasStrings=originalHasStrings&&modifiedHasStrings,this._originalStringElements=originalStringElements,this._originalElementsOrHash=originalElementsOrHash,this._modifiedStringElements=modifiedStringElements,this._modifiedElementsOrHash=modifiedElementsOrHash,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(arr){return arr.length>0&&"string"==typeof arr[0]}static _getElements(sequence){const elements=sequence.getElements();if(LcsDiff._isStringArray(elements)){const hashes=new Int32Array(elements.length);for(let i=0,len=elements.length;i<len;i++)hashes[i]=(0,hash_1.stringHash)(elements[i],0);return[elements,hashes,!0]}return elements instanceof Int32Array?[[],elements,!1]:[[],new Int32Array(elements),!1]}ElementsAreEqual(originalIndex,newIndex){return this._originalElementsOrHash[originalIndex]===this._modifiedElementsOrHash[newIndex]&&(!this._hasStrings||this._originalStringElements[originalIndex]===this._modifiedStringElements[newIndex])}ElementsAreStrictEqual(originalIndex,newIndex){if(!this.ElementsAreEqual(originalIndex,newIndex))return!1;return LcsDiff._getStrictElement(this._originalSequence,originalIndex)===LcsDiff._getStrictElement(this._modifiedSequence,newIndex)}static _getStrictElement(sequence,index){return"function"==typeof sequence.getStrictElement?sequence.getStrictElement(index):null}OriginalElementsAreEqual(index1,index2){return this._originalElementsOrHash[index1]===this._originalElementsOrHash[index2]&&(!this._hasStrings||this._originalStringElements[index1]===this._originalStringElements[index2])}ModifiedElementsAreEqual(index1,index2){return this._modifiedElementsOrHash[index1]===this._modifiedElementsOrHash[index2]&&(!this._hasStrings||this._modifiedStringElements[index1]===this._modifiedStringElements[index2])}ComputeDiff(pretty){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,pretty)}_ComputeDiff(originalStart,originalEnd,modifiedStart,modifiedEnd,pretty){const quitEarlyArr=[!1];let changes=this.ComputeDiffRecursive(originalStart,originalEnd,modifiedStart,modifiedEnd,quitEarlyArr);return pretty&&(changes=this.PrettifyChanges(changes)),{quitEarly:quitEarlyArr[0],changes}}ComputeDiffRecursive(originalStart,originalEnd,modifiedStart,modifiedEnd,quitEarlyArr){for(quitEarlyArr[0]=!1;originalStart<=originalEnd&&modifiedStart<=modifiedEnd&&this.ElementsAreEqual(originalStart,modifiedStart);)originalStart++,modifiedStart++;for(;originalEnd>=originalStart&&modifiedEnd>=modifiedStart&&this.ElementsAreEqual(originalEnd,modifiedEnd);)originalEnd--,modifiedEnd--;if(originalStart>originalEnd||modifiedStart>modifiedEnd){let changes;return modifiedStart<=modifiedEnd?(Debug.Assert(originalStart===originalEnd+1,"originalStart should only be one more than originalEnd"),changes=[new diffChange_1.DiffChange(originalStart,0,modifiedStart,modifiedEnd-modifiedStart+1)]):originalStart<=originalEnd?(Debug.Assert(modifiedStart===modifiedEnd+1,"modifiedStart should only be one more than modifiedEnd"),changes=[new diffChange_1.DiffChange(originalStart,originalEnd-originalStart+1,modifiedStart,0)]):(Debug.Assert(originalStart===originalEnd+1,"originalStart should only be one more than originalEnd"),Debug.Assert(modifiedStart===modifiedEnd+1,"modifiedStart should only be one more than modifiedEnd"),changes=[]),changes}const midOriginalArr=[0],midModifiedArr=[0],result=this.ComputeRecursionPoint(originalStart,originalEnd,modifiedStart,modifiedEnd,midOriginalArr,midModifiedArr,quitEarlyArr),midOriginal=midOriginalArr[0],midModified=midModifiedArr[0];if(null!==result)return result;if(!quitEarlyArr[0]){const leftChanges=this.ComputeDiffRecursive(originalStart,midOriginal,modifiedStart,midModified,quitEarlyArr);let rightChanges=[];return rightChanges=quitEarlyArr[0]?[new diffChange_1.DiffChange(midOriginal+1,originalEnd-(midOriginal+1)+1,midModified+1,modifiedEnd-(midModified+1)+1)]:this.ComputeDiffRecursive(midOriginal+1,originalEnd,midModified+1,modifiedEnd,quitEarlyArr),this.ConcatenateChanges(leftChanges,rightChanges)}return[new diffChange_1.DiffChange(originalStart,originalEnd-originalStart+1,modifiedStart,modifiedEnd-modifiedStart+1)]}WALKTRACE(diagonalForwardBase,diagonalForwardStart,diagonalForwardEnd,diagonalForwardOffset,diagonalReverseBase,diagonalReverseStart,diagonalReverseEnd,diagonalReverseOffset,forwardPoints,reversePoints,originalIndex,originalEnd,midOriginalArr,modifiedIndex,modifiedEnd,midModifiedArr,deltaIsEven,quitEarlyArr){let forwardChanges=null,reverseChanges=null,changeHelper=new DiffChangeHelper,diagonalMin=diagonalForwardStart,diagonalMax=diagonalForwardEnd,diagonalRelative=midOriginalArr[0]-midModifiedArr[0]-diagonalForwardOffset,lastOriginalIndex=-1073741824,historyIndex=this.m_forwardHistory.length-1;do{const diagonal=diagonalRelative+diagonalForwardBase;diagonal===diagonalMin||diagonal<diagonalMax&&forwardPoints[diagonal-1]<forwardPoints[diagonal+1]?(modifiedIndex=(originalIndex=forwardPoints[diagonal+1])-diagonalRelative-diagonalForwardOffset,originalIndex<lastOriginalIndex&&changeHelper.MarkNextChange(),lastOriginalIndex=originalIndex,changeHelper.AddModifiedElement(originalIndex+1,modifiedIndex),diagonalRelative=diagonal+1-diagonalForwardBase):(modifiedIndex=(originalIndex=forwardPoints[diagonal-1]+1)-diagonalRelative-diagonalForwardOffset,originalIndex<lastOriginalIndex&&changeHelper.MarkNextChange(),lastOriginalIndex=originalIndex-1,changeHelper.AddOriginalElement(originalIndex,modifiedIndex+1),diagonalRelative=diagonal-1-diagonalForwardBase),historyIndex>=0&&(diagonalForwardBase=(forwardPoints=this.m_forwardHistory[historyIndex])[0],diagonalMin=1,diagonalMax=forwardPoints.length-1)}while(--historyIndex>=-1);if(forwardChanges=changeHelper.getReverseChanges(),quitEarlyArr[0]){let originalStartPoint=midOriginalArr[0]+1,modifiedStartPoint=midModifiedArr[0]+1;if(null!==forwardChanges&&forwardChanges.length>0){const lastForwardChange=forwardChanges[forwardChanges.length-1];originalStartPoint=Math.max(originalStartPoint,lastForwardChange.getOriginalEnd()),modifiedStartPoint=Math.max(modifiedStartPoint,lastForwardChange.getModifiedEnd())}reverseChanges=[new diffChange_1.DiffChange(originalStartPoint,originalEnd-originalStartPoint+1,modifiedStartPoint,modifiedEnd-modifiedStartPoint+1)]}else{changeHelper=new DiffChangeHelper,diagonalMin=diagonalReverseStart,diagonalMax=diagonalReverseEnd,diagonalRelative=midOriginalArr[0]-midModifiedArr[0]-diagonalReverseOffset,lastOriginalIndex=1073741824,historyIndex=deltaIsEven?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const diagonal=diagonalRelative+diagonalReverseBase;diagonal===diagonalMin||diagonal<diagonalMax&&reversePoints[diagonal-1]>=reversePoints[diagonal+1]?(modifiedIndex=(originalIndex=reversePoints[diagonal+1]-1)-diagonalRelative-diagonalReverseOffset,originalIndex>lastOriginalIndex&&changeHelper.MarkNextChange(),lastOriginalIndex=originalIndex+1,changeHelper.AddOriginalElement(originalIndex+1,modifiedIndex+1),diagonalRelative=diagonal+1-diagonalReverseBase):(modifiedIndex=(originalIndex=reversePoints[diagonal-1])-diagonalRelative-diagonalReverseOffset,originalIndex>lastOriginalIndex&&changeHelper.MarkNextChange(),lastOriginalIndex=originalIndex,changeHelper.AddModifiedElement(originalIndex+1,modifiedIndex+1),diagonalRelative=diagonal-1-diagonalReverseBase),historyIndex>=0&&(diagonalReverseBase=(reversePoints=this.m_reverseHistory[historyIndex])[0],diagonalMin=1,diagonalMax=reversePoints.length-1)}while(--historyIndex>=-1);reverseChanges=changeHelper.getChanges()}return this.ConcatenateChanges(forwardChanges,reverseChanges)}ComputeRecursionPoint(originalStart,originalEnd,modifiedStart,modifiedEnd,midOriginalArr,midModifiedArr,quitEarlyArr){let originalIndex=0,modifiedIndex=0,diagonalForwardStart=0,diagonalForwardEnd=0,diagonalReverseStart=0,diagonalReverseEnd=0;originalStart--,modifiedStart--,midOriginalArr[0]=0,midModifiedArr[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const maxDifferences=originalEnd-originalStart+(modifiedEnd-modifiedStart),numDiagonals=maxDifferences+1,forwardPoints=new Int32Array(numDiagonals),reversePoints=new Int32Array(numDiagonals),diagonalForwardBase=modifiedEnd-modifiedStart,diagonalReverseBase=originalEnd-originalStart,diagonalForwardOffset=originalStart-modifiedStart,diagonalReverseOffset=originalEnd-modifiedEnd,deltaIsEven=(diagonalReverseBase-diagonalForwardBase)%2==0;forwardPoints[diagonalForwardBase]=originalStart,reversePoints[diagonalReverseBase]=originalEnd,quitEarlyArr[0]=!1;for(let numDifferences=1;numDifferences<=maxDifferences/2+1;numDifferences++){let furthestOriginalIndex=0,furthestModifiedIndex=0;diagonalForwardStart=this.ClipDiagonalBound(diagonalForwardBase-numDifferences,numDifferences,diagonalForwardBase,numDiagonals),diagonalForwardEnd=this.ClipDiagonalBound(diagonalForwardBase+numDifferences,numDifferences,diagonalForwardBase,numDiagonals);for(let diagonal=diagonalForwardStart;diagonal<=diagonalForwardEnd;diagonal+=2){originalIndex=diagonal===diagonalForwardStart||diagonal<diagonalForwardEnd&&forwardPoints[diagonal-1]<forwardPoints[diagonal+1]?forwardPoints[diagonal+1]:forwardPoints[diagonal-1]+1,modifiedIndex=originalIndex-(diagonal-diagonalForwardBase)-diagonalForwardOffset;const tempOriginalIndex=originalIndex;for(;originalIndex<originalEnd&&modifiedIndex<modifiedEnd&&this.ElementsAreEqual(originalIndex+1,modifiedIndex+1);)originalIndex++,modifiedIndex++;if(forwardPoints[diagonal]=originalIndex,originalIndex+modifiedIndex>furthestOriginalIndex+furthestModifiedIndex&&(furthestOriginalIndex=originalIndex,furthestModifiedIndex=modifiedIndex),!deltaIsEven&&Math.abs(diagonal-diagonalReverseBase)<=numDifferences-1&&originalIndex>=reversePoints[diagonal])return midOriginalArr[0]=originalIndex,midModifiedArr[0]=modifiedIndex,tempOriginalIndex<=reversePoints[diagonal]&&numDifferences<=1448?this.WALKTRACE(diagonalForwardBase,diagonalForwardStart,diagonalForwardEnd,diagonalForwardOffset,diagonalReverseBase,diagonalReverseStart,diagonalReverseEnd,diagonalReverseOffset,forwardPoints,reversePoints,originalIndex,originalEnd,midOriginalArr,modifiedIndex,modifiedEnd,midModifiedArr,deltaIsEven,quitEarlyArr):null}const matchLengthOfLongest=(furthestOriginalIndex-originalStart+(furthestModifiedIndex-modifiedStart)-numDifferences)/2;if(null!==this.ContinueProcessingPredicate&&!this.ContinueProcessingPredicate(furthestOriginalIndex,matchLengthOfLongest))return quitEarlyArr[0]=!0,midOriginalArr[0]=furthestOriginalIndex,midModifiedArr[0]=furthestModifiedIndex,matchLengthOfLongest>0&&numDifferences<=1448?this.WALKTRACE(diagonalForwardBase,diagonalForwardStart,diagonalForwardEnd,diagonalForwardOffset,diagonalReverseBase,diagonalReverseStart,diagonalReverseEnd,diagonalReverseOffset,forwardPoints,reversePoints,originalIndex,originalEnd,midOriginalArr,modifiedIndex,modifiedEnd,midModifiedArr,deltaIsEven,quitEarlyArr):(originalStart++,modifiedStart++,[new diffChange_1.DiffChange(originalStart,originalEnd-originalStart+1,modifiedStart,modifiedEnd-modifiedStart+1)]);diagonalReverseStart=this.ClipDiagonalBound(diagonalReverseBase-numDifferences,numDifferences,diagonalReverseBase,numDiagonals),diagonalReverseEnd=this.ClipDiagonalBound(diagonalReverseBase+numDifferences,numDifferences,diagonalReverseBase,numDiagonals);for(let diagonal=diagonalReverseStart;diagonal<=diagonalReverseEnd;diagonal+=2){originalIndex=diagonal===diagonalReverseStart||diagonal<diagonalReverseEnd&&reversePoints[diagonal-1]>=reversePoints[diagonal+1]?reversePoints[diagonal+1]-1:reversePoints[diagonal-1],modifiedIndex=originalIndex-(diagonal-diagonalReverseBase)-diagonalReverseOffset;const tempOriginalIndex=originalIndex;for(;originalIndex>originalStart&&modifiedIndex>modifiedStart&&this.ElementsAreEqual(originalIndex,modifiedIndex);)originalIndex--,modifiedIndex--;if(reversePoints[diagonal]=originalIndex,deltaIsEven&&Math.abs(diagonal-diagonalForwardBase)<=numDifferences&&originalIndex<=forwardPoints[diagonal])return midOriginalArr[0]=originalIndex,midModifiedArr[0]=modifiedIndex,tempOriginalIndex>=forwardPoints[diagonal]&&numDifferences<=1448?this.WALKTRACE(diagonalForwardBase,diagonalForwardStart,diagonalForwardEnd,diagonalForwardOffset,diagonalReverseBase,diagonalReverseStart,diagonalReverseEnd,diagonalReverseOffset,forwardPoints,reversePoints,originalIndex,originalEnd,midOriginalArr,modifiedIndex,modifiedEnd,midModifiedArr,deltaIsEven,quitEarlyArr):null}if(numDifferences<=1447){let temp=new Int32Array(diagonalForwardEnd-diagonalForwardStart+2);temp[0]=diagonalForwardBase-diagonalForwardStart+1,MyArray.Copy2(forwardPoints,diagonalForwardStart,temp,1,diagonalForwardEnd-diagonalForwardStart+1),this.m_forwardHistory.push(temp),temp=new Int32Array(diagonalReverseEnd-diagonalReverseStart+2),temp[0]=diagonalReverseBase-diagonalReverseStart+1,MyArray.Copy2(reversePoints,diagonalReverseStart,temp,1,diagonalReverseEnd-diagonalReverseStart+1),this.m_reverseHistory.push(temp)}}return this.WALKTRACE(diagonalForwardBase,diagonalForwardStart,diagonalForwardEnd,diagonalForwardOffset,diagonalReverseBase,diagonalReverseStart,diagonalReverseEnd,diagonalReverseOffset,forwardPoints,reversePoints,originalIndex,originalEnd,midOriginalArr,modifiedIndex,modifiedEnd,midModifiedArr,deltaIsEven,quitEarlyArr)}PrettifyChanges(changes){for(let i=0;i<changes.length;i++){const change=changes[i],originalStop=i<changes.length-1?changes[i+1].originalStart:this._originalElementsOrHash.length,modifiedStop=i<changes.length-1?changes[i+1].modifiedStart:this._modifiedElementsOrHash.length,checkOriginal=change.originalLength>0,checkModified=change.modifiedLength>0;for(;change.originalStart+change.originalLength<originalStop&&change.modifiedStart+change.modifiedLength<modifiedStop&&(!checkOriginal||this.OriginalElementsAreEqual(change.originalStart,change.originalStart+change.originalLength))&&(!checkModified||this.ModifiedElementsAreEqual(change.modifiedStart,change.modifiedStart+change.modifiedLength));){const startStrictEqual=this.ElementsAreStrictEqual(change.originalStart,change.modifiedStart);if(this.ElementsAreStrictEqual(change.originalStart+change.originalLength,change.modifiedStart+change.modifiedLength)&&!startStrictEqual)break;change.originalStart++,change.modifiedStart++}let mergedChangeArr=[null];i<changes.length-1&&this.ChangesOverlap(changes[i],changes[i+1],mergedChangeArr)&&(changes[i]=mergedChangeArr[0],changes.splice(i+1,1),i--)}for(let i=changes.length-1;i>=0;i--){const change=changes[i];let originalStop=0,modifiedStop=0;if(i>0){const prevChange=changes[i-1];originalStop=prevChange.originalStart+prevChange.originalLength,modifiedStop=prevChange.modifiedStart+prevChange.modifiedLength}const checkOriginal=change.originalLength>0,checkModified=change.modifiedLength>0;let bestDelta=0,bestScore=this._boundaryScore(change.originalStart,change.originalLength,change.modifiedStart,change.modifiedLength);for(let delta=1;;delta++){const originalStart=change.originalStart-delta,modifiedStart=change.modifiedStart-delta;if(originalStart<originalStop||modifiedStart<modifiedStop)break;if(checkOriginal&&!this.OriginalElementsAreEqual(originalStart,originalStart+change.originalLength))break;if(checkModified&&!this.ModifiedElementsAreEqual(modifiedStart,modifiedStart+change.modifiedLength))break;const score=(originalStart===originalStop&&modifiedStart===modifiedStop?5:0)+this._boundaryScore(originalStart,change.originalLength,modifiedStart,change.modifiedLength);score>bestScore&&(bestScore=score,bestDelta=delta)}change.originalStart-=bestDelta,change.modifiedStart-=bestDelta;const mergedChangeArr=[null];i>0&&this.ChangesOverlap(changes[i-1],changes[i],mergedChangeArr)&&(changes[i-1]=mergedChangeArr[0],changes.splice(i,1),i++)}if(this._hasStrings)for(let i=1,len=changes.length;i<len;i++){const aChange=changes[i-1],bChange=changes[i],matchedLength=bChange.originalStart-aChange.originalStart-aChange.originalLength,aOriginalStart=aChange.originalStart,bOriginalEnd=bChange.originalStart+bChange.originalLength,abOriginalLength=bOriginalEnd-aOriginalStart,aModifiedStart=aChange.modifiedStart,bModifiedEnd=bChange.modifiedStart+bChange.modifiedLength,abModifiedLength=bModifiedEnd-aModifiedStart;if(matchedLength<5&&abOriginalLength<20&&abModifiedLength<20){const t=this._findBetterContiguousSequence(aOriginalStart,abOriginalLength,aModifiedStart,abModifiedLength,matchedLength);if(t){const[originalMatchStart,modifiedMatchStart]=t;originalMatchStart===aChange.originalStart+aChange.originalLength&&modifiedMatchStart===aChange.modifiedStart+aChange.modifiedLength||(aChange.originalLength=originalMatchStart-aChange.originalStart,aChange.modifiedLength=modifiedMatchStart-aChange.modifiedStart,bChange.originalStart=originalMatchStart+matchedLength,bChange.modifiedStart=modifiedMatchStart+matchedLength,bChange.originalLength=bOriginalEnd-bChange.originalStart,bChange.modifiedLength=bModifiedEnd-bChange.modifiedStart)}}}return changes}_findBetterContiguousSequence(originalStart,originalLength,modifiedStart,modifiedLength,desiredLength){if(originalLength<desiredLength||modifiedLength<desiredLength)return null;const originalMax=originalStart+originalLength-desiredLength+1,modifiedMax=modifiedStart+modifiedLength-desiredLength+1;let bestScore=0,bestOriginalStart=0,bestModifiedStart=0;for(let i=originalStart;i<originalMax;i++)for(let j=modifiedStart;j<modifiedMax;j++){const score=this._contiguousSequenceScore(i,j,desiredLength);score>0&&score>bestScore&&(bestScore=score,bestOriginalStart=i,bestModifiedStart=j)}return bestScore>0?[bestOriginalStart,bestModifiedStart]:null}_contiguousSequenceScore(originalStart,modifiedStart,length){let score=0;for(let l=0;l<length;l++){if(!this.ElementsAreEqual(originalStart+l,modifiedStart+l))return 0;score+=this._originalStringElements[originalStart+l].length}return score}_OriginalIsBoundary(index){return index<=0||index>=this._originalElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._originalStringElements[index])}_OriginalRegionIsBoundary(originalStart,originalLength){if(this._OriginalIsBoundary(originalStart)||this._OriginalIsBoundary(originalStart-1))return!0;if(originalLength>0){const originalEnd=originalStart+originalLength;if(this._OriginalIsBoundary(originalEnd-1)||this._OriginalIsBoundary(originalEnd))return!0}return!1}_ModifiedIsBoundary(index){return index<=0||index>=this._modifiedElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[index])}_ModifiedRegionIsBoundary(modifiedStart,modifiedLength){if(this._ModifiedIsBoundary(modifiedStart)||this._ModifiedIsBoundary(modifiedStart-1))return!0;if(modifiedLength>0){const modifiedEnd=modifiedStart+modifiedLength;if(this._ModifiedIsBoundary(modifiedEnd-1)||this._ModifiedIsBoundary(modifiedEnd))return!0}return!1}_boundaryScore(originalStart,originalLength,modifiedStart,modifiedLength){return(this._OriginalRegionIsBoundary(originalStart,originalLength)?1:0)+(this._ModifiedRegionIsBoundary(modifiedStart,modifiedLength)?1:0)}ConcatenateChanges(left,right){let mergedChangeArr=[];if(0===left.length||0===right.length)return right.length>0?right:left;if(this.ChangesOverlap(left[left.length-1],right[0],mergedChangeArr)){const result=new Array(left.length+right.length-1);return MyArray.Copy(left,0,result,0,left.length-1),result[left.length-1]=mergedChangeArr[0],MyArray.Copy(right,1,result,left.length,right.length-1),result}{const result=new Array(left.length+right.length);return MyArray.Copy(left,0,result,0,left.length),MyArray.Copy(right,0,result,left.length,right.length),result}}ChangesOverlap(left,right,mergedChangeArr){if(Debug.Assert(left.originalStart<=right.originalStart,"Left change is not less than or equal to right change"),Debug.Assert(left.modifiedStart<=right.modifiedStart,"Left change is not less than or equal to right change"),left.originalStart+left.originalLength>=right.originalStart||left.modifiedStart+left.modifiedLength>=right.modifiedStart){const originalStart=left.originalStart;let originalLength=left.originalLength;const modifiedStart=left.modifiedStart;let modifiedLength=left.modifiedLength;return left.originalStart+left.originalLength>=right.originalStart&&(originalLength=right.originalStart+right.originalLength-left.originalStart),left.modifiedStart+left.modifiedLength>=right.modifiedStart&&(modifiedLength=right.modifiedStart+right.modifiedLength-left.modifiedStart),mergedChangeArr[0]=new diffChange_1.DiffChange(originalStart,originalLength,modifiedStart,modifiedLength),!0}return mergedChangeArr[0]=null,!1}ClipDiagonalBound(diagonal,numDifferences,diagonalBaseIndex,numDiagonals){if(diagonal>=0&&diagonal<numDiagonals)return diagonal;const diffEven=numDifferences%2==0;if(diagonal<0){return diffEven===(diagonalBaseIndex%2==0)?0:1}return diffEven===((numDiagonals-diagonalBaseIndex-1)%2==0)?numDiagonals-1:numDiagonals-2}}exports.LcsDiff=LcsDiff})),define(__m[169],__M([1,0,111,18,10,141,4,57]),(function(require,exports,tree_1,arrays_1,async_1,diff_1,event_1,iterator_1){"use strict";function isFilterResult(obj){return"object"==typeof obj&&"visibility"in obj&&"data"in obj}function getVisibleState(visibility){switch(visibility){case!0:return 1;case!1:return 0;default:return visibility}}function isCollapsibleStateUpdate(update){return"boolean"==typeof update.collapsible}Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexTreeModel=exports.getVisibleState=exports.isFilterResult=void 0,exports.isFilterResult=isFilterResult,exports.getVisibleState=getVisibleState;exports.IndexTreeModel=class IndexTreeModel{constructor(user,list,rootElement,options={}){this.user=user,this.list=list,this.rootRef=[],this.eventBufferer=new event_1.EventBufferer,this._onDidChangeCollapseState=new event_1.Emitter,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new event_1.Emitter,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new event_1.Emitter,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new async_1.Delayer(async_1.MicrotaskDelay),this.collapseByDefault=void 0!==options.collapseByDefault&&options.collapseByDefault,this.filter=options.filter,this.autoExpandSingleChildren=void 0!==options.autoExpandSingleChildren&&options.autoExpandSingleChildren,this.root={parent:void 0,element:rootElement,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(location,deleteCount,toInsert=iterator_1.Iterable.empty(),options={}){if(0===location.length)throw new tree_1.TreeError(this.user,"Invalid tree location");options.diffIdentityProvider?this.spliceSmart(options.diffIdentityProvider,location,deleteCount,toInsert,options):this.spliceSimple(location,deleteCount,toInsert,options)}spliceSmart(identity,location,deleteCount,toInsertIterable,options,recurseLevels){var _a;void 0===toInsertIterable&&(toInsertIterable=iterator_1.Iterable.empty()),void 0===recurseLevels&&(recurseLevels=null!==(_a=options.diffDepth)&&void 0!==_a?_a:0);const{parentNode}=this.getParentNodeWithListIndex(location);if(!parentNode.lastDiffIds)return this.spliceSimple(location,deleteCount,toInsertIterable,options);const toInsert=[...toInsertIterable],index=location[location.length-1],diff=new diff_1.LcsDiff({getElements:()=>parentNode.lastDiffIds},{getElements:()=>[...parentNode.children.slice(0,index),...toInsert,...parentNode.children.slice(index+deleteCount)].map((e=>identity.getId(e.element).toString()))}).ComputeDiff(!1);if(diff.quitEarly)return parentNode.lastDiffIds=void 0,this.spliceSimple(location,deleteCount,toInsert,options);const locationPrefix=location.slice(0,-1),recurseSplice=(fromOriginal,fromModified,count)=>{if(recurseLevels>0)for(let i=0;i<count;i++)fromOriginal--,fromModified--,this.spliceSmart(identity,[...locationPrefix,fromOriginal,0],Number.MAX_SAFE_INTEGER,toInsert[fromModified].children,options,recurseLevels-1)};let lastStartO=Math.min(parentNode.children.length,index+deleteCount),lastStartM=toInsert.length;for(const change of diff.changes.sort(((a,b)=>b.originalStart-a.originalStart)))recurseSplice(lastStartO,lastStartM,lastStartO-(change.originalStart+change.originalLength)),lastStartO=change.originalStart,lastStartM=change.modifiedStart-index,this.spliceSimple([...locationPrefix,lastStartO],change.originalLength,iterator_1.Iterable.slice(toInsert,lastStartM,lastStartM+change.modifiedLength),options);recurseSplice(lastStartO,lastStartM,lastStartO)}spliceSimple(location,deleteCount,toInsert=iterator_1.Iterable.empty(),{onDidCreateNode,onDidDeleteNode,diffIdentityProvider}){const{parentNode,listIndex,revealed,visible}=this.getParentNodeWithListIndex(location),treeListElementsToInsert=[],nodesToInsertIterator=iterator_1.Iterable.map(toInsert,(el=>this.createTreeNode(el,parentNode,parentNode.visible?1:0,revealed,treeListElementsToInsert,onDidCreateNode))),lastIndex=location[location.length-1],lastHadChildren=parentNode.children.length>0;let visibleChildStartIndex=0;for(let i=lastIndex;i>=0&&i<parentNode.children.length;i--){const child=parentNode.children[i];if(child.visible){visibleChildStartIndex=child.visibleChildIndex;break}}const nodesToInsert=[];let insertedVisibleChildrenCount=0,renderNodeCount=0;for(const child of nodesToInsertIterator)nodesToInsert.push(child),renderNodeCount+=child.renderNodeCount,child.visible&&(child.visibleChildIndex=visibleChildStartIndex+insertedVisibleChildrenCount++);const deletedNodes=(0,arrays_1.splice)(parentNode.children,lastIndex,deleteCount,nodesToInsert);diffIdentityProvider?parentNode.lastDiffIds?(0,arrays_1.splice)(parentNode.lastDiffIds,lastIndex,deleteCount,nodesToInsert.map((n=>diffIdentityProvider.getId(n.element).toString()))):parentNode.lastDiffIds=parentNode.children.map((n=>diffIdentityProvider.getId(n.element).toString())):parentNode.lastDiffIds=void 0;let deletedVisibleChildrenCount=0;for(const child of deletedNodes)child.visible&&deletedVisibleChildrenCount++;if(0!==deletedVisibleChildrenCount)for(let i=lastIndex+nodesToInsert.length;i<parentNode.children.length;i++){const child=parentNode.children[i];child.visible&&(child.visibleChildIndex-=deletedVisibleChildrenCount)}if(parentNode.visibleChildrenCount+=insertedVisibleChildrenCount-deletedVisibleChildrenCount,revealed&&visible){const visibleDeleteCount=deletedNodes.reduce(((r,node)=>r+(node.visible?node.renderNodeCount:0)),0);this._updateAncestorsRenderNodeCount(parentNode,renderNodeCount-visibleDeleteCount),this.list.splice(listIndex,visibleDeleteCount,treeListElementsToInsert)}if(deletedNodes.length>0&&onDidDeleteNode){const visit=node=>{onDidDeleteNode(node),node.children.forEach(visit)};deletedNodes.forEach(visit)}this._onDidSplice.fire({insertedNodes:nodesToInsert,deletedNodes});const currentlyHasChildren=parentNode.children.length>0;lastHadChildren!==currentlyHasChildren&&this.setCollapsible(location.slice(0,-1),currentlyHasChildren);let node=parentNode;for(;node;){if(2===node.visibility){this.refilterDelayer.trigger((()=>this.refilter()));break}node=node.parent}}rerender(location){if(0===location.length)throw new tree_1.TreeError(this.user,"Invalid tree location");const{node,listIndex,revealed}=this.getTreeNodeWithListIndex(location);node.visible&&revealed&&this.list.splice(listIndex,1,[node])}has(location){return this.hasTreeNode(location)}getListIndex(location){const{listIndex,visible,revealed}=this.getTreeNodeWithListIndex(location);return visible&&revealed?listIndex:-1}getListRenderCount(location){return this.getTreeNode(location).renderNodeCount}isCollapsible(location){return this.getTreeNode(location).collapsible}setCollapsible(location,collapsible){const node=this.getTreeNode(location);void 0===collapsible&&(collapsible=!node.collapsible);const update={collapsible};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(location,update)))}isCollapsed(location){return this.getTreeNode(location).collapsed}setCollapsed(location,collapsed,recursive){const node=this.getTreeNode(location);void 0===collapsed&&(collapsed=!node.collapsed);const update={collapsed,recursive:recursive||!1};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(location,update)))}_setCollapseState(location,update){const{node,listIndex,revealed}=this.getTreeNodeWithListIndex(location),result=this._setListNodeCollapseState(node,listIndex,revealed,update);if(node!==this.root&&this.autoExpandSingleChildren&&result&&!isCollapsibleStateUpdate(update)&&node.collapsible&&!node.collapsed&&!update.recursive){let onlyVisibleChildIndex=-1;for(let i=0;i<node.children.length;i++){if(node.children[i].visible){if(onlyVisibleChildIndex>-1){onlyVisibleChildIndex=-1;break}onlyVisibleChildIndex=i}}onlyVisibleChildIndex>-1&&this._setCollapseState([...location,onlyVisibleChildIndex],update)}return result}_setListNodeCollapseState(node,listIndex,revealed,update){const result=this._setNodeCollapseState(node,update,!1);if(!revealed||!node.visible||!result)return result;const previousRenderNodeCount=node.renderNodeCount,toInsert=this.updateNodeAfterCollapseChange(node),deleteCount=previousRenderNodeCount-(-1===listIndex?0:1);return this.list.splice(listIndex+1,deleteCount,toInsert.slice(1)),result}_setNodeCollapseState(node,update,deep){let result;if(node===this.root?result=!1:(isCollapsibleStateUpdate(update)?(result=node.collapsible!==update.collapsible,node.collapsible=update.collapsible):node.collapsible?(result=node.collapsed!==update.collapsed,node.collapsed=update.collapsed):result=!1,result&&this._onDidChangeCollapseState.fire({node,deep})),!isCollapsibleStateUpdate(update)&&update.recursive)for(const child of node.children)result=this._setNodeCollapseState(child,update,!0)||result;return result}expandTo(location){this.eventBufferer.bufferEvents((()=>{let node=this.getTreeNode(location);for(;node.parent;)node=node.parent,location=location.slice(0,location.length-1),node.collapsed&&this._setCollapseState(location,{collapsed:!1,recursive:!1})}))}refilter(){const previousRenderNodeCount=this.root.renderNodeCount,toInsert=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,previousRenderNodeCount,toInsert),this.refilterDelayer.cancel()}createTreeNode(treeElement,parent,parentVisibility,revealed,treeListElements,onDidCreateNode){const node={parent,element:treeElement.element,children:[],depth:parent.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:"boolean"==typeof treeElement.collapsible?treeElement.collapsible:void 0!==treeElement.collapsed,collapsed:void 0===treeElement.collapsed?this.collapseByDefault:treeElement.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},visibility=this._filterNode(node,parentVisibility);node.visibility=visibility,revealed&&treeListElements.push(node);const childElements=treeElement.children||iterator_1.Iterable.empty(),childRevealed=revealed&&0!==visibility&&!node.collapsed,childNodes=iterator_1.Iterable.map(childElements,(el=>this.createTreeNode(el,node,visibility,childRevealed,treeListElements,onDidCreateNode)));let visibleChildrenCount=0,renderNodeCount=1;for(const child of childNodes)node.children.push(child),renderNodeCount+=child.renderNodeCount,child.visible&&(child.visibleChildIndex=visibleChildrenCount++);return node.collapsible=node.collapsible||node.children.length>0,node.visibleChildrenCount=visibleChildrenCount,node.visible=2===visibility?visibleChildrenCount>0:1===visibility,node.visible?node.collapsed||(node.renderNodeCount=renderNodeCount):(node.renderNodeCount=0,revealed&&treeListElements.pop()),onDidCreateNode&&onDidCreateNode(node),node}updateNodeAfterCollapseChange(node){const previousRenderNodeCount=node.renderNodeCount,result=[];return this._updateNodeAfterCollapseChange(node,result),this._updateAncestorsRenderNodeCount(node.parent,result.length-previousRenderNodeCount),result}_updateNodeAfterCollapseChange(node,result){if(!1===node.visible)return 0;if(result.push(node),node.renderNodeCount=1,!node.collapsed)for(const child of node.children)node.renderNodeCount+=this._updateNodeAfterCollapseChange(child,result);return this._onDidChangeRenderNodeCount.fire(node),node.renderNodeCount}updateNodeAfterFilterChange(node){const previousRenderNodeCount=node.renderNodeCount,result=[];return this._updateNodeAfterFilterChange(node,node.visible?1:0,result),this._updateAncestorsRenderNodeCount(node.parent,result.length-previousRenderNodeCount),result}_updateNodeAfterFilterChange(node,parentVisibility,result,revealed=!0){let visibility;if(node!==this.root){if(visibility=this._filterNode(node,parentVisibility),0===visibility)return node.visible=!1,node.renderNodeCount=0,!1;revealed&&result.push(node)}const resultStartLength=result.length;node.renderNodeCount=node===this.root?0:1;let hasVisibleDescendants=!1;if(node.collapsed&&0===visibility)node.visibleChildrenCount=0;else{let visibleChildIndex=0;for(const child of node.children)hasVisibleDescendants=this._updateNodeAfterFilterChange(child,visibility,result,revealed&&!node.collapsed)||hasVisibleDescendants,child.visible&&(child.visibleChildIndex=visibleChildIndex++);node.visibleChildrenCount=visibleChildIndex}return node!==this.root&&(node.visible=2===visibility?hasVisibleDescendants:1===visibility,node.visibility=visibility),node.visible?node.collapsed||(node.renderNodeCount+=result.length-resultStartLength):(node.renderNodeCount=0,revealed&&result.pop()),this._onDidChangeRenderNodeCount.fire(node),node.visible}_updateAncestorsRenderNodeCount(node,diff){if(0!==diff)for(;node;)node.renderNodeCount+=diff,this._onDidChangeRenderNodeCount.fire(node),node=node.parent}_filterNode(node,parentVisibility){const result=this.filter?this.filter.filter(node.element,parentVisibility):1;return"boolean"==typeof result?(node.filterData=void 0,result?1:0):isFilterResult(result)?(node.filterData=result.data,getVisibleState(result.visibility)):(node.filterData=void 0,getVisibleState(result))}hasTreeNode(location,node=this.root){if(!location||0===location.length)return!0;const[index,...rest]=location;return!(index<0||index>node.children.length)&&this.hasTreeNode(rest,node.children[index])}getTreeNode(location,node=this.root){if(!location||0===location.length)return node;const[index,...rest]=location;if(index<0||index>node.children.length)throw new tree_1.TreeError(this.user,"Invalid tree location");return this.getTreeNode(rest,node.children[index])}getTreeNodeWithListIndex(location){if(0===location.length)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode,listIndex,revealed,visible}=this.getParentNodeWithListIndex(location),index=location[location.length-1];if(index<0||index>parentNode.children.length)throw new tree_1.TreeError(this.user,"Invalid tree location");const node=parentNode.children[index];return{node,listIndex,revealed,visible:visible&&node.visible}}getParentNodeWithListIndex(location,node=this.root,listIndex=0,revealed=!0,visible=!0){const[index,...rest]=location;if(index<0||index>node.children.length)throw new tree_1.TreeError(this.user,"Invalid tree location");for(let i=0;i<index;i++)listIndex+=node.children[i].renderNodeCount;return revealed=revealed&&!node.collapsed,visible=visible&&node.visible,0===rest.length?{parentNode:node,listIndex,revealed,visible}:this.getParentNodeWithListIndex(rest,node.children[index],listIndex+1,revealed,visible)}getNode(location=[]){return this.getTreeNode(location)}getNodeLocation(node){const location=[];let indexTreeNode=node;for(;indexTreeNode.parent;)location.push(indexTreeNode.parent.children.indexOf(indexTreeNode)),indexTreeNode=indexTreeNode.parent;return location.reverse()}getParentNodeLocation(location){return 0===location.length?void 0:1===location.length?[]:(0,arrays_1.tail2)(location)[0]}getFirstElementChild(location){const node=this.getTreeNode(location);if(0!==node.children.length)return node.children[0].element}}})),define(__m[170],__M([1,0,169,111,57]),(function(require,exports,indexTreeModel_1,tree_1,iterator_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectTreeModel=void 0;exports.ObjectTreeModel=class ObjectTreeModel{constructor(user,list,options={}){this.user=user,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new indexTreeModel_1.IndexTreeModel(user,list,null,options),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,options.sorter&&(this.sorter={compare:(a,b)=>options.sorter.compare(a.element,b.element)}),this.identityProvider=options.identityProvider}setChildren(element,children=iterator_1.Iterable.empty(),options={}){const location=this.getElementLocation(element);this._setChildren(location,this.preserveCollapseState(children),options)}_setChildren(location,children=iterator_1.Iterable.empty(),options){const insertedElements=new Set,insertedElementIds=new Set;this.model.splice([...location,0],Number.MAX_VALUE,children,Object.assign(Object.assign({},options),{onDidCreateNode:node=>{var _a;if(null===node.element)return;const tnode=node;if(insertedElements.add(tnode.element),this.nodes.set(tnode.element,tnode),this.identityProvider){const id=this.identityProvider.getId(tnode.element).toString();insertedElementIds.add(id),this.nodesByIdentity.set(id,tnode)}null===(_a=options.onDidCreateNode)||void 0===_a||_a.call(options,tnode)},onDidDeleteNode:node=>{var _a;if(null===node.element)return;const tnode=node;if(insertedElements.has(tnode.element)||this.nodes.delete(tnode.element),this.identityProvider){const id=this.identityProvider.getId(tnode.element).toString();insertedElementIds.has(id)||this.nodesByIdentity.delete(id)}null===(_a=options.onDidDeleteNode)||void 0===_a||_a.call(options,tnode)}}))}preserveCollapseState(elements=iterator_1.Iterable.empty()){return this.sorter&&(elements=[...elements].sort(this.sorter.compare.bind(this.sorter))),iterator_1.Iterable.map(elements,(treeElement=>{let node=this.nodes.get(treeElement.element);if(!node&&this.identityProvider){const id=this.identityProvider.getId(treeElement.element).toString();node=this.nodesByIdentity.get(id)}if(!node)return Object.assign(Object.assign({},treeElement),{children:this.preserveCollapseState(treeElement.children)});const collapsible="boolean"==typeof treeElement.collapsible?treeElement.collapsible:node.collapsible,collapsed=void 0!==treeElement.collapsed?treeElement.collapsed:node.collapsed;return Object.assign(Object.assign({},treeElement),{collapsible,collapsed,children:this.preserveCollapseState(treeElement.children)})}))}rerender(element){const location=this.getElementLocation(element);this.model.rerender(location)}getFirstElementChild(ref=null){const location=this.getElementLocation(ref);return this.model.getFirstElementChild(location)}has(element){return this.nodes.has(element)}getListIndex(element){const location=this.getElementLocation(element);return this.model.getListIndex(location)}getListRenderCount(element){const location=this.getElementLocation(element);return this.model.getListRenderCount(location)}isCollapsible(element){const location=this.getElementLocation(element);return this.model.isCollapsible(location)}setCollapsible(element,collapsible){const location=this.getElementLocation(element);return this.model.setCollapsible(location,collapsible)}isCollapsed(element){const location=this.getElementLocation(element);return this.model.isCollapsed(location)}setCollapsed(element,collapsed,recursive){const location=this.getElementLocation(element);return this.model.setCollapsed(location,collapsed,recursive)}expandTo(element){const location=this.getElementLocation(element);this.model.expandTo(location)}refilter(){this.model.refilter()}getNode(element=null){if(null===element)return this.model.getNode(this.model.rootRef);const node=this.nodes.get(element);if(!node)throw new tree_1.TreeError(this.user,`Tree element not found: ${element}`);return node}getNodeLocation(node){return node.element}getParentNodeLocation(element){if(null===element)throw new tree_1.TreeError(this.user,"Invalid getParentNodeLocation call");const node=this.nodes.get(element);if(!node)throw new tree_1.TreeError(this.user,`Tree element not found: ${element}`);const location=this.model.getNodeLocation(node),parentLocation=this.model.getParentNodeLocation(location);return this.model.getNode(parentLocation).element}getElementLocation(element){if(null===element)return[];const node=this.nodes.get(element);if(!node)throw new tree_1.TreeError(this.user,`Tree element not found: ${element}`);return this.model.getNodeLocation(node)}}})),define(__m[321],__M([1,0,170,111,4,57]),(function(require,exports,objectTreeModel_1,tree_1,event_1,iterator_1){"use strict";function noCompress(element){return{element:{elements:[element.element],incompressible:element.incompressible||!1},children:iterator_1.Iterable.map(iterator_1.Iterable.from(element.children),noCompress),collapsible:element.collapsible,collapsed:element.collapsed}}function compress(element){const elements=[element.element],incompressible=element.incompressible||!1;let childrenIterator,children;for(;[children,childrenIterator]=iterator_1.Iterable.consume(iterator_1.Iterable.from(element.children),2),1===children.length&&!children[0].incompressible;)element=children[0],elements.push(element.element);return{element:{elements,incompressible},children:iterator_1.Iterable.map(iterator_1.Iterable.concat(children,childrenIterator),compress),collapsible:element.collapsible,collapsed:element.collapsed}}function _decompress(element,index=0){let children;return children=index<element.element.elements.length-1?[_decompress(element,index+1)]:iterator_1.Iterable.map(iterator_1.Iterable.from(element.children),(el=>_decompress(el,0))),0===index&&element.element.incompressible?{element:element.element.elements[index],children,incompressible:!0,collapsible:element.collapsible,collapsed:element.collapsed}:{element:element.element.elements[index],children,collapsible:element.collapsible,collapsed:element.collapsed}}function decompress(element){return _decompress(element,0)}function splice(treeElement,element,children){return treeElement.element===element?Object.assign(Object.assign({},treeElement),{children}):Object.assign(Object.assign({},treeElement),{children:iterator_1.Iterable.map(iterator_1.Iterable.from(treeElement.children),(e=>splice(e,element,children)))})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompressibleObjectTreeModel=exports.DefaultElementMapper=exports.CompressedObjectTreeModel=exports.decompress=exports.compress=void 0,exports.compress=compress,exports.decompress=decompress;class CompressedObjectTreeModel{constructor(user,list,options={}){this.user=user,this.rootRef=null,this.nodes=new Map,this.model=new objectTreeModel_1.ObjectTreeModel(user,list,options),this.enabled=void 0===options.compressionEnabled||options.compressionEnabled,this.identityProvider=options.identityProvider}get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}setChildren(element,children=iterator_1.Iterable.empty(),options){const diffIdentityProvider=options.diffIdentityProvider&&(base=options.diffIdentityProvider,{getId:node=>node.elements.map((e=>base.getId(e).toString())).join("\0")});var base;if(null===element){const compressedChildren=iterator_1.Iterable.map(children,this.enabled?compress:noCompress);return void this._setChildren(null,compressedChildren,{diffIdentityProvider,diffDepth:1/0})}const compressedNode=this.nodes.get(element);if(!compressedNode)throw new Error("Unknown compressed tree node");const node=this.model.getNode(compressedNode),compressedParentNode=this.model.getParentNodeLocation(compressedNode),parent=this.model.getNode(compressedParentNode),splicedElement=splice(decompress(node),element,children),recompressedElement=(this.enabled?compress:noCompress)(splicedElement),parentChildren=parent.children.map((child=>child===node?recompressedElement:child));this._setChildren(parent.element,parentChildren,{diffIdentityProvider,diffDepth:node.depth-parent.depth})}setCompressionEnabled(enabled){if(enabled===this.enabled)return;this.enabled=enabled;const rootChildren=this.model.getNode().children,decompressedRootChildren=iterator_1.Iterable.map(rootChildren,decompress),recompressedRootChildren=iterator_1.Iterable.map(decompressedRootChildren,enabled?compress:noCompress);this._setChildren(null,recompressedRootChildren,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(node,children,options){const insertedElements=new Set;this.model.setChildren(node,children,Object.assign(Object.assign({},options),{onDidCreateNode:node=>{for(const element of node.element.elements)insertedElements.add(element),this.nodes.set(element,node.element)},onDidDeleteNode:node=>{for(const element of node.element.elements)insertedElements.has(element)||this.nodes.delete(element)}}))}has(element){return this.nodes.has(element)}getListIndex(location){const node=this.getCompressedNode(location);return this.model.getListIndex(node)}getListRenderCount(location){const node=this.getCompressedNode(location);return this.model.getListRenderCount(node)}getNode(location){if(void 0===location)return this.model.getNode();const node=this.getCompressedNode(location);return this.model.getNode(node)}getNodeLocation(node){const compressedNode=this.model.getNodeLocation(node);return null===compressedNode?null:compressedNode.elements[compressedNode.elements.length-1]}getParentNodeLocation(location){const compressedNode=this.getCompressedNode(location),parentNode=this.model.getParentNodeLocation(compressedNode);return null===parentNode?null:parentNode.elements[parentNode.elements.length-1]}getFirstElementChild(location){const compressedNode=this.getCompressedNode(location);return this.model.getFirstElementChild(compressedNode)}isCollapsible(location){const compressedNode=this.getCompressedNode(location);return this.model.isCollapsible(compressedNode)}setCollapsible(location,collapsible){const compressedNode=this.getCompressedNode(location);return this.model.setCollapsible(compressedNode,collapsible)}isCollapsed(location){const compressedNode=this.getCompressedNode(location);return this.model.isCollapsed(compressedNode)}setCollapsed(location,collapsed,recursive){const compressedNode=this.getCompressedNode(location);return this.model.setCollapsed(compressedNode,collapsed,recursive)}expandTo(location){const compressedNode=this.getCompressedNode(location);this.model.expandTo(compressedNode)}rerender(location){const compressedNode=this.getCompressedNode(location);this.model.rerender(compressedNode)}refilter(){this.model.refilter()}getCompressedNode(element){if(null===element)return null;const node=this.nodes.get(element);if(!node)throw new tree_1.TreeError(this.user,`Tree element not found: ${element}`);return node}}exports.CompressedObjectTreeModel=CompressedObjectTreeModel;exports.DefaultElementMapper=elements=>elements[elements.length-1];class CompressedTreeNodeWrapper{constructor(unwrapper,node){this.unwrapper=unwrapper,this.node=node}get element(){return null===this.node.element?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map((node=>new CompressedTreeNodeWrapper(this.unwrapper,node)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}exports.CompressibleObjectTreeModel=class CompressibleObjectTreeModel{constructor(user,list,options={}){this.rootRef=null,this.elementMapper=options.elementMapper||exports.DefaultElementMapper;const compressedNodeUnwrapper=node=>this.elementMapper(node.elements);this.nodeMapper=new tree_1.WeakMapper((node=>new CompressedTreeNodeWrapper(compressedNodeUnwrapper,node))),this.model=new CompressedObjectTreeModel(user,function mapList(nodeMapper,list){return{splice(start,deleteCount,toInsert){list.splice(start,deleteCount,toInsert.map((node=>nodeMapper.map(node))))},updateElementHeight(index,height){list.updateElementHeight(index,height)}}}(this.nodeMapper,list),function mapOptions(compressedNodeUnwrapper,options){return Object.assign(Object.assign({},options),{identityProvider:options.identityProvider&&{getId:node=>options.identityProvider.getId(compressedNodeUnwrapper(node))},sorter:options.sorter&&{compare:(node,otherNode)=>options.sorter.compare(node.elements[0],otherNode.elements[0])},filter:options.filter&&{filter:(node,parentVisibility)=>options.filter.filter(compressedNodeUnwrapper(node),parentVisibility)}})}(compressedNodeUnwrapper,options))}get onDidSplice(){return event_1.Event.map(this.model.onDidSplice,(({insertedNodes,deletedNodes})=>({insertedNodes:insertedNodes.map((node=>this.nodeMapper.map(node))),deletedNodes:deletedNodes.map((node=>this.nodeMapper.map(node)))})))}get onDidChangeCollapseState(){return event_1.Event.map(this.model.onDidChangeCollapseState,(({node,deep})=>({node:this.nodeMapper.map(node),deep})))}get onDidChangeRenderNodeCount(){return event_1.Event.map(this.model.onDidChangeRenderNodeCount,(node=>this.nodeMapper.map(node)))}setChildren(element,children=iterator_1.Iterable.empty(),options={}){this.model.setChildren(element,children,options)}setCompressionEnabled(enabled){this.model.setCompressionEnabled(enabled)}has(location){return this.model.has(location)}getListIndex(location){return this.model.getListIndex(location)}getListRenderCount(location){return this.model.getListRenderCount(location)}getNode(location){return this.nodeMapper.map(this.model.getNode(location))}getNodeLocation(node){return node.element}getParentNodeLocation(location){return this.model.getParentNodeLocation(location)}getFirstElementChild(location){const result=this.model.getFirstElementChild(location);return null==result?result:this.elementMapper(result.elements)}isCollapsible(location){return this.model.isCollapsible(location)}setCollapsible(location,collapsed){return this.model.setCollapsible(location,collapsed)}isCollapsed(location){return this.model.isCollapsed(location)}setCollapsed(location,collapsed,recursive){return this.model.setCollapsed(location,collapsed,recursive)}expandTo(location){return this.model.expandTo(location)}rerender(location){return this.model.rerender(location)}refilter(){return this.model.refilter()}getCompressedTreeNode(location=null){return this.model.getNode(location)}}})),define(__m[49],__M([1,0,8]),(function(require,exports,strings_1){"use strict";var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LRUCache=exports.LinkedMap=exports.ResourceMap=exports.TernarySearchTree=exports.UriIterator=exports.PathIterator=exports.ConfigKeysIterator=exports.StringIterator=void 0;class StringIterator{constructor(){this._value="",this._pos=0}reset(key){return this._value=key,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(a){return a.charCodeAt(0)-this._value.charCodeAt(this._pos)}value(){return this._value[this._pos]}}exports.StringIterator=StringIterator;class ConfigKeysIterator{constructor(_caseSensitive=!0){this._caseSensitive=_caseSensitive}reset(key){return this._value=key,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let justSeps=!0;for(;this._to<this._value.length;this._to++){if(46===this._value.charCodeAt(this._to)){if(!justSeps)break;this._from++}else justSeps=!1}return this}cmp(a){return this._caseSensitive?(0,strings_1.compareSubstring)(a,this._value,0,a.length,this._from,this._to):(0,strings_1.compareSubstringIgnoreCase)(a,this._value,0,a.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}exports.ConfigKeysIterator=ConfigKeysIterator;class PathIterator{constructor(_splitOnBackslash=!0,_caseSensitive=!0){this._splitOnBackslash=_splitOnBackslash,this._caseSensitive=_caseSensitive}reset(key){this._from=0,this._to=0,this._value=key,this._valueLen=key.length;for(let pos=key.length-1;pos>=0;pos--,this._valueLen--){const ch=this._value.charCodeAt(pos);if(!(47===ch||this._splitOnBackslash&&92===ch))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let justSeps=!0;for(;this._to<this._valueLen;this._to++){const ch=this._value.charCodeAt(this._to);if(47===ch||this._splitOnBackslash&&92===ch){if(!justSeps)break;this._from++}else justSeps=!1}return this}cmp(a){return this._caseSensitive?(0,strings_1.compareSubstring)(a,this._value,0,a.length,this._from,this._to):(0,strings_1.compareSubstringIgnoreCase)(a,this._value,0,a.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}exports.PathIterator=PathIterator;class UriIterator{constructor(_ignorePathCasing){this._ignorePathCasing=_ignorePathCasing,this._states=[],this._stateIdx=0}reset(key){return this._value=key,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new PathIterator(!1,!this._ignorePathCasing(key)),this._pathIterator.reset(key.path),this._pathIterator.value()&&this._states.push(3)),this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5),this._stateIdx=0,this}next(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(a){if(1===this._states[this._stateIdx])return(0,strings_1.compareIgnoreCase)(a,this._value.scheme);if(2===this._states[this._stateIdx])return(0,strings_1.compareIgnoreCase)(a,this._value.authority);if(3===this._states[this._stateIdx])return this._pathIterator.cmp(a);if(4===this._states[this._stateIdx])return(0,strings_1.compare)(a,this._value.query);if(5===this._states[this._stateIdx])return(0,strings_1.compare)(a,this._value.fragment);throw new Error}value(){if(1===this._states[this._stateIdx])return this._value.scheme;if(2===this._states[this._stateIdx])return this._value.authority;if(3===this._states[this._stateIdx])return this._pathIterator.value();if(4===this._states[this._stateIdx])return this._value.query;if(5===this._states[this._stateIdx])return this._value.fragment;throw new Error}}exports.UriIterator=UriIterator;class TernarySearchTreeNode{constructor(){this.height=1}rotateLeft(){const tmp=this.right;return this.right=tmp.left,tmp.left=this,this.updateHeight(),tmp.updateHeight(),tmp}rotateRight(){const tmp=this.left;return this.left=tmp.right,tmp.right=this,this.updateHeight(),tmp.updateHeight(),tmp}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var _c,_d;return null!==(_d=null===(_c=this.left)||void 0===_c?void 0:_c.height)&&void 0!==_d?_d:0}get heightRight(){var _c,_d;return null!==(_d=null===(_c=this.right)||void 0===_c?void 0:_c.height)&&void 0!==_d?_d:0}}class TernarySearchTree{constructor(segments){this._iter=segments}static forUris(ignorePathCasing=(()=>!1)){return new TernarySearchTree(new UriIterator(ignorePathCasing))}static forStrings(){return new TernarySearchTree(new StringIterator)}static forConfigKeys(){return new TernarySearchTree(new ConfigKeysIterator)}clear(){this._root=void 0}set(key,element){const iter=this._iter.reset(key);let node;this._root||(this._root=new TernarySearchTreeNode,this._root.segment=iter.value());const stack=[];for(node=this._root;;){const val=iter.cmp(node.segment);if(val>0)node.left||(node.left=new TernarySearchTreeNode,node.left.segment=iter.value()),stack.push([-1,node]),node=node.left;else if(val<0)node.right||(node.right=new TernarySearchTreeNode,node.right.segment=iter.value()),stack.push([1,node]),node=node.right;else{if(!iter.hasNext())break;iter.next(),node.mid||(node.mid=new TernarySearchTreeNode,node.mid.segment=iter.value()),stack.push([0,node]),node=node.mid}}const oldElement=node.value;node.value=element,node.key=key;for(let i=stack.length-1;i>=0;i--){const node=stack[i][1];node.updateHeight();const bf=node.balanceFactor();if(bf<-1||bf>1){const d1=stack[i][0],d2=stack[i+1][0];if(1===d1&&1===d2)stack[i][1]=node.rotateLeft();else if(-1===d1&&-1===d2)stack[i][1]=node.rotateRight();else if(1===d1&&-1===d2)node.right=stack[i+1][1]=stack[i+1][1].rotateRight(),stack[i][1]=node.rotateLeft();else{if(-1!==d1||1!==d2)throw new Error;node.left=stack[i+1][1]=stack[i+1][1].rotateLeft(),stack[i][1]=node.rotateRight()}if(i>0)switch(stack[i-1][0]){case-1:stack[i-1][1].left=stack[i][1];break;case 1:stack[i-1][1].right=stack[i][1];break;case 0:stack[i-1][1].mid=stack[i][1]}else this._root=stack[0][1]}}return oldElement}get(key){var _c;return null===(_c=this._getNode(key))||void 0===_c?void 0:_c.value}_getNode(key){const iter=this._iter.reset(key);let node=this._root;for(;node;){const val=iter.cmp(node.segment);if(val>0)node=node.left;else if(val<0)node=node.right;else{if(!iter.hasNext())break;iter.next(),node=node.mid}}return node}has(key){const node=this._getNode(key);return!(void 0===(null==node?void 0:node.value)&&void 0===(null==node?void 0:node.mid))}delete(key){return this._delete(key,!1)}deleteSuperstr(key){return this._delete(key,!0)}_delete(key,superStr){var _c;const iter=this._iter.reset(key),stack=[];let node=this._root;for(;node;){const val=iter.cmp(node.segment);if(val>0)stack.push([-1,node]),node=node.left;else if(val<0)stack.push([1,node]),node=node.right;else{if(!iter.hasNext())break;iter.next(),stack.push([0,node]),node=node.mid}}if(node){if(superStr?(node.left=void 0,node.mid=void 0,node.right=void 0,node.height=1):(node.key=void 0,node.value=void 0),!node.mid&&!node.value)if(node.left&&node.right){const min=this._min(node.right),{key,value,segment}=min;this._delete(min.key,!1),node.key=key,node.value=value,node.segment=segment}else{const newChild=null!==(_c=node.left)&&void 0!==_c?_c:node.right;if(stack.length>0){const[dir,parent]=stack[stack.length-1];switch(dir){case-1:parent.left=newChild;break;case 0:parent.mid=newChild;break;case 1:parent.right=newChild}}else this._root=newChild}for(let i=stack.length-1;i>=0;i--){const node=stack[i][1];node.updateHeight();const bf=node.balanceFactor();if(bf>1?(node.right.balanceFactor()>=0||(node.right=node.right.rotateRight()),stack[i][1]=node.rotateLeft()):bf<-1&&(node.left.balanceFactor()<=0||(node.left=node.left.rotateLeft()),stack[i][1]=node.rotateRight()),i>0)switch(stack[i-1][0]){case-1:stack[i-1][1].left=stack[i][1];break;case 1:stack[i-1][1].right=stack[i][1];break;case 0:stack[i-1][1].mid=stack[i][1]}else this._root=stack[0][1]}}}_min(node){for(;node.left;)node=node.left;return node}findSubstr(key){const iter=this._iter.reset(key);let candidate,node=this._root;for(;node;){const val=iter.cmp(node.segment);if(val>0)node=node.left;else if(val<0)node=node.right;else{if(!iter.hasNext())break;iter.next(),candidate=node.value||candidate,node=node.mid}}return node&&node.value||candidate}findSuperstr(key){const iter=this._iter.reset(key);let node=this._root;for(;node;){const val=iter.cmp(node.segment);if(val>0)node=node.left;else if(val<0)node=node.right;else{if(!iter.hasNext())return node.mid?this._entries(node.mid):void 0;iter.next(),node=node.mid}}}forEach(callback){for(const[key,value]of this)callback(value,key)}*[Symbol.iterator](){yield*this._entries(this._root)}*_entries(node){node&&(node.left&&(yield*this._entries(node.left)),node.value&&(yield[node.key,node.value]),node.mid&&(yield*this._entries(node.mid)),node.right&&(yield*this._entries(node.right)))}}exports.TernarySearchTree=TernarySearchTree;class ResourceMapEntry{constructor(uri,value){this.uri=uri,this.value=value}}class ResourceMap{constructor(mapOrKeyFn,toKey){this[_a]="ResourceMap",mapOrKeyFn instanceof ResourceMap?(this.map=new Map(mapOrKeyFn.map),this.toKey=null!=toKey?toKey:ResourceMap.defaultToKey):(this.map=new Map,this.toKey=null!=mapOrKeyFn?mapOrKeyFn:ResourceMap.defaultToKey)}set(resource,value){return this.map.set(this.toKey(resource),new ResourceMapEntry(resource,value)),this}get(resource){var _c;return null===(_c=this.map.get(this.toKey(resource)))||void 0===_c?void 0:_c.value}has(resource){return this.map.has(this.toKey(resource))}get size(){return this.map.size}clear(){this.map.clear()}delete(resource){return this.map.delete(this.toKey(resource))}forEach(clb,thisArg){void 0!==thisArg&&(clb=clb.bind(thisArg));for(let[_,entry]of this.map)clb(entry.value,entry.uri,this)}*values(){for(let entry of this.map.values())yield entry.value}*keys(){for(let entry of this.map.values())yield entry.uri}*entries(){for(let entry of this.map.values())yield[entry.uri,entry.value]}*[(_a=Symbol.toStringTag,Symbol.iterator)](){for(let[,entry]of this.map)yield[entry.uri,entry.value]}}exports.ResourceMap=ResourceMap,ResourceMap.defaultToKey=resource=>resource.toString();class LinkedMap{constructor(){this[_b]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var _c;return null===(_c=this._head)||void 0===_c?void 0:_c.value}get last(){var _c;return null===(_c=this._tail)||void 0===_c?void 0:_c.value}has(key){return this._map.has(key)}get(key,touch=0){const item=this._map.get(key);if(item)return 0!==touch&&this.touch(item,touch),item.value}set(key,value,touch=0){let item=this._map.get(key);if(item)item.value=value,0!==touch&&this.touch(item,touch);else{switch(item={key,value,next:void 0,previous:void 0},touch){case 0:case 2:default:this.addItemLast(item);break;case 1:this.addItemFirst(item)}this._map.set(key,item),this._size++}return this}delete(key){return!!this.remove(key)}remove(key){const item=this._map.get(key);if(item)return this._map.delete(key),this.removeItem(item),this._size--,item.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const item=this._head;return this._map.delete(item.key),this.removeItem(item),this._size--,item.value}forEach(callbackfn,thisArg){const state=this._state;let current=this._head;for(;current;){if(thisArg?callbackfn.bind(thisArg)(current.value,current.key,this):callbackfn(current.value,current.key,this),this._state!==state)throw new Error("LinkedMap got modified during iteration.");current=current.next}}keys(){const map=this,state=this._state;let current=this._head;const iterator={[Symbol.iterator]:()=>iterator,next(){if(map._state!==state)throw new Error("LinkedMap got modified during iteration.");if(current){const result={value:current.key,done:!1};return current=current.next,result}return{value:void 0,done:!0}}};return iterator}values(){const map=this,state=this._state;let current=this._head;const iterator={[Symbol.iterator]:()=>iterator,next(){if(map._state!==state)throw new Error("LinkedMap got modified during iteration.");if(current){const result={value:current.value,done:!1};return current=current.next,result}return{value:void 0,done:!0}}};return iterator}entries(){const map=this,state=this._state;let current=this._head;const iterator={[Symbol.iterator]:()=>iterator,next(){if(map._state!==state)throw new Error("LinkedMap got modified during iteration.");if(current){const result={value:[current.key,current.value],done:!1};return current=current.next,result}return{value:void 0,done:!0}}};return iterator}[(_b=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(newSize){if(newSize>=this.size)return;if(0===newSize)return void this.clear();let current=this._head,currentSize=this.size;for(;current&&currentSize>newSize;)this._map.delete(current.key),current=current.next,currentSize--;this._head=current,this._size=currentSize,current&&(current.previous=void 0),this._state++}addItemFirst(item){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");item.next=this._head,this._head.previous=item}else this._tail=item;this._head=item,this._state++}addItemLast(item){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");item.previous=this._tail,this._tail.next=item}else this._head=item;this._tail=item,this._state++}removeItem(item){if(item===this._head&&item===this._tail)this._head=void 0,this._tail=void 0;else if(item===this._head){if(!item.next)throw new Error("Invalid list");item.next.previous=void 0,this._head=item.next}else if(item===this._tail){if(!item.previous)throw new Error("Invalid list");item.previous.next=void 0,this._tail=item.previous}else{const next=item.next,previous=item.previous;if(!next||!previous)throw new Error("Invalid list");next.previous=previous,previous.next=next}item.next=void 0,item.previous=void 0,this._state++}touch(item,touch){if(!this._head||!this._tail)throw new Error("Invalid list");if(1===touch||2===touch)if(1===touch){if(item===this._head)return;const next=item.next,previous=item.previous;item===this._tail?(previous.next=void 0,this._tail=previous):(next.previous=previous,previous.next=next),item.previous=void 0,item.next=this._head,this._head.previous=item,this._head=item,this._state++}else if(2===touch){if(item===this._tail)return;const next=item.next,previous=item.previous;item===this._head?(next.previous=void 0,this._head=next):(next.previous=previous,previous.next=next),item.next=void 0,item.previous=this._tail,this._tail.next=item,this._tail=item,this._state++}}toJSON(){const data=[];return this.forEach(((value,key)=>{data.push([key,value])})),data}fromJSON(data){this.clear();for(const[key,value]of data)this.set(key,value)}}exports.LinkedMap=LinkedMap;exports.LRUCache=class LRUCache extends LinkedMap{constructor(limit,ratio=1){super(),this._limit=limit,this._ratio=Math.min(Math.max(0,ratio),1)}get limit(){return this._limit}set limit(limit){this._limit=limit,this.checkTrim()}get(key,touch=2){return super.get(key,touch)}peek(key){return super.get(key,0)}set(key,value){return super.set(key,value,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}})),define(__m[75],__M([1,0,49,8]),(function(require,exports,map_1,strings){"use strict";function or(...filter){return function(word,wordToMatchAgainst){for(let i=0,len=filter.length;i<len;i++){const match=filter[i](word,wordToMatchAgainst);if(match)return match}return null}}function _matchesPrefix(ignoreCase,word,wordToMatchAgainst){if(!wordToMatchAgainst||wordToMatchAgainst.length<word.length)return null;let matches;return matches=ignoreCase?strings.startsWithIgnoreCase(wordToMatchAgainst,word):0===wordToMatchAgainst.indexOf(word),matches?word.length>0?[{start:0,end:word.length}]:[]:null}function matchesContiguousSubString(word,wordToMatchAgainst){const index=wordToMatchAgainst.toLowerCase().indexOf(word.toLowerCase());return-1===index?null:[{start:index,end:index+word.length}]}function matchesSubString(word,wordToMatchAgainst){return _matchesSubString(word.toLowerCase(),wordToMatchAgainst.toLowerCase(),0,0)}function _matchesSubString(word,wordToMatchAgainst,i,j){if(i===word.length)return[];if(j===wordToMatchAgainst.length)return null;if(word[i]===wordToMatchAgainst[j]){let result=null;return(result=_matchesSubString(word,wordToMatchAgainst,i+1,j+1))?join({start:j,end:j+1},result):null}return _matchesSubString(word,wordToMatchAgainst,i,j+1)}function isLower(code){return 97<=code&&code<=122}function isUpper(code){return 65<=code&&code<=90}function isNumber(code){return 48<=code&&code<=57}function isWhitespace(code){return 32===code||9===code||10===code||13===code}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fuzzyScoreGracefulAggressive=exports.fuzzyScore=exports.FuzzyScore=exports.isPatternInWord=exports.createMatches=exports.anyScore=exports.matchesFuzzy=exports.matchesWords=exports.matchesCamelCase=exports.isUpper=exports.matchesSubString=exports.matchesContiguousSubString=exports.matchesPrefix=exports.matchesStrictPrefix=exports.or=void 0,exports.or=or,exports.matchesStrictPrefix=_matchesPrefix.bind(void 0,!1),exports.matchesPrefix=_matchesPrefix.bind(void 0,!0),exports.matchesContiguousSubString=matchesContiguousSubString,exports.matchesSubString=matchesSubString,exports.isUpper=isUpper;const wordSeparators=new Set;function isWordSeparator(code){return isWhitespace(code)||wordSeparators.has(code)}function isAlphanumeric(code){return isLower(code)||isUpper(code)||isNumber(code)}function join(head,tail){return 0===tail.length?tail=[head]:head.end===tail[0].start?tail[0].start=head.start:tail.unshift(head),tail}function nextAnchor(camelCaseWord,start){for(let i=start;i<camelCaseWord.length;i++){const c=camelCaseWord.charCodeAt(i);if(isUpper(c)||isNumber(c)||i>0&&!isAlphanumeric(camelCaseWord.charCodeAt(i-1)))return i}return camelCaseWord.length}function _matchesCamelCase(word,camelCaseWord,i,j){if(i===word.length)return[];if(j===camelCaseWord.length)return null;if(word[i]!==camelCaseWord[j].toLowerCase())return null;{let result=null,nextUpperIndex=j+1;for(result=_matchesCamelCase(word,camelCaseWord,i+1,j+1);!result&&(nextUpperIndex=nextAnchor(camelCaseWord,nextUpperIndex))<camelCaseWord.length;)result=_matchesCamelCase(word,camelCaseWord,i+1,nextUpperIndex),nextUpperIndex++;return null===result?null:join({start:j,end:j+1},result)}}function matchesCamelCase(word,camelCaseWord){if(!camelCaseWord)return null;if(0===(camelCaseWord=camelCaseWord.trim()).length)return null;if(!function isCamelCasePattern(word){let upper=0,lower=0,code=0,whitespace=0;for(let i=0;i<word.length;i++)code=word.charCodeAt(i),isUpper(code)&&upper++,isLower(code)&&lower++,isWhitespace(code)&&whitespace++;return 0!==upper&&0!==lower||0!==whitespace?upper<=5:word.length<=30}(word))return null;if(camelCaseWord.length>60)return null;const analysis=function analyzeCamelCaseWord(word){let upper=0,lower=0,alpha=0,numeric=0,code=0;for(let i=0;i<word.length;i++)code=word.charCodeAt(i),isUpper(code)&&upper++,isLower(code)&&lower++,isAlphanumeric(code)&&alpha++,isNumber(code)&&numeric++;return{upperPercent:upper/word.length,lowerPercent:lower/word.length,alphaPercent:alpha/word.length,numericPercent:numeric/word.length}}(camelCaseWord);if(!function isCamelCaseWord(analysis){const{upperPercent,lowerPercent,alphaPercent,numericPercent}=analysis;return lowerPercent>.2&&upperPercent<.8&&alphaPercent>.6&&numericPercent<.2}(analysis)){if(!function isUpperCaseWord(analysis){const{upperPercent,lowerPercent}=analysis;return 0===lowerPercent&&upperPercent>.6}(analysis))return null;camelCaseWord=camelCaseWord.toLowerCase()}let result=null,i=0;for(word=word.toLowerCase();i<camelCaseWord.length&&null===(result=_matchesCamelCase(word,camelCaseWord,0,i));)i=nextAnchor(camelCaseWord,i+1);return result}function _matchesWords(word,target,i,j,contiguous){if(i===word.length)return[];if(j===target.length)return null;if(function charactersMatch(codeA,codeB){return codeA===codeB||isWordSeparator(codeA)&&isWordSeparator(codeB)}(word.charCodeAt(i),target.charCodeAt(j))){let result=null,nextWordIndex=j+1;if(result=_matchesWords(word,target,i+1,j+1,contiguous),!contiguous)for(;!result&&(nextWordIndex=nextWord(target,nextWordIndex))<target.length;)result=_matchesWords(word,target,i+1,nextWordIndex,contiguous),nextWordIndex++;return null===result?null:join({start:j,end:j+1},result)}return null}function nextWord(word,start){for(let i=start;i<word.length;i++)if(isWordSeparator(word.charCodeAt(i))||i>0&&isWordSeparator(word.charCodeAt(i-1)))return i;return word.length}"()[]{}<>`'\"-/;:,.?!".split("").forEach((s=>wordSeparators.add(s.charCodeAt(0)))),exports.matchesCamelCase=matchesCamelCase,exports.matchesWords=function matchesWords(word,target,contiguous=!1){if(!target||0===target.length)return null;let result=null,i=0;for(word=word.toLowerCase(),target=target.toLowerCase();i<target.length&&null===(result=_matchesWords(word,target,0,i,contiguous));)i=nextWord(target,i+1);return result};const fuzzyContiguousFilter=or(exports.matchesPrefix,matchesCamelCase,matchesContiguousSubString),fuzzySeparateFilter=or(exports.matchesPrefix,matchesCamelCase,matchesSubString),fuzzyRegExpCache=new map_1.LRUCache(1e4);exports.matchesFuzzy=function matchesFuzzy(word,wordToMatchAgainst,enableSeparateSubstringMatching=!1){if("string"!=typeof word||"string"!=typeof wordToMatchAgainst)return null;let regexp=fuzzyRegExpCache.get(word);regexp||(regexp=new RegExp(strings.convertSimple2RegExpPattern(word),"i"),fuzzyRegExpCache.set(word,regexp));const match=regexp.exec(wordToMatchAgainst);return match?[{start:match.index,end:match.index+match[0].length}]:enableSeparateSubstringMatching?fuzzySeparateFilter(word,wordToMatchAgainst):fuzzyContiguousFilter(word,wordToMatchAgainst)},exports.anyScore=function anyScore(pattern,lowPattern,patternPos,word,lowWord,wordPos){const max=Math.min(13,pattern.length);for(;patternPos<max;patternPos++){const result=fuzzyScore(pattern,lowPattern,patternPos,word,lowWord,wordPos,!1);if(result)return result}return[0,wordPos]},exports.createMatches=function createMatches(score){if(void 0===score)return[];const res=[],wordPos=score[1];for(let i=score.length-1;i>1;i--){const pos=score[i]+wordPos,last=res[res.length-1];last&&last.end===pos?last.end=pos+1:res.push({start:pos,end:pos+1})}return res};function initTable(){const table=[],row=[];for(let i=0;i<=128;i++)row[i]=0;for(let i=0;i<=128;i++)table.push(row.slice(0));return table}function initArr(maxLen){const row=[];for(let i=0;i<=maxLen;i++)row[i]=0;return row}const _minWordMatchPos=initArr(256),_maxWordMatchPos=initArr(256),_diag=initTable(),_table=initTable(),_arrows=initTable();function isSeparatorAtPos(value,index){if(index<0||index>=value.length)return!1;const code=value.codePointAt(index);switch(code){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 40:case 91:return!0;case void 0:return!1;default:return!!strings.isEmojiImprecise(code)}}function isWhitespaceAtPos(value,index){if(index<0||index>=value.length)return!1;switch(value.charCodeAt(index)){case 32:case 9:return!0;default:return!1}}function isUpperCaseAtPos(pos,word,wordLow){return word[pos]!==wordLow[pos]}function isPatternInWord(patternLow,patternPos,patternLen,wordLow,wordPos,wordLen,fillMinWordPosArr=!1){for(;patternPos<patternLen&&wordPos<wordLen;)patternLow[patternPos]===wordLow[wordPos]&&(fillMinWordPosArr&&(_minWordMatchPos[patternPos]=wordPos),patternPos+=1),wordPos+=1;return patternPos===patternLen}function fuzzyScore(pattern,patternLow,patternStart,word,wordLow,wordStart,firstMatchCanBeWeak){const patternLen=pattern.length>128?128:pattern.length,wordLen=word.length>128?128:word.length;if(patternStart>=patternLen||wordStart>=wordLen||patternLen-patternStart>wordLen-wordStart)return;if(!isPatternInWord(patternLow,patternStart,patternLen,wordLow,wordStart,wordLen,!0))return;!function _fillInMaxWordMatchPos(patternLen,wordLen,patternStart,wordStart,patternLow,wordLow){let patternPos=patternLen-1,wordPos=wordLen-1;for(;patternPos>=patternStart&&wordPos>=wordStart;)patternLow[patternPos]===wordLow[wordPos]&&(_maxWordMatchPos[patternPos]=wordPos,patternPos--),wordPos--}(patternLen,wordLen,patternStart,wordStart,patternLow,wordLow);let row=1,column=1,patternPos=patternStart,wordPos=wordStart;const hasStrongFirstMatch=[!1];for(row=1,patternPos=patternStart;patternPos<patternLen;row++,patternPos++){const minWordMatchPos=_minWordMatchPos[patternPos],maxWordMatchPos=_maxWordMatchPos[patternPos],nextMaxWordMatchPos=patternPos+1<patternLen?_maxWordMatchPos[patternPos+1]:wordLen;for(column=minWordMatchPos-wordStart+1,wordPos=minWordMatchPos;wordPos<nextMaxWordMatchPos;column++,wordPos++){let score=Number.MIN_SAFE_INTEGER,canComeDiag=!1;wordPos<=maxWordMatchPos&&(score=_doScore(pattern,patternLow,patternPos,patternStart,word,wordLow,wordPos,wordLen,wordStart,0===_diag[row-1][column-1],hasStrongFirstMatch));let diagScore=0;score!==Number.MAX_SAFE_INTEGER&&(canComeDiag=!0,diagScore=score+_table[row-1][column-1]);const canComeLeft=wordPos>minWordMatchPos,leftScore=canComeLeft?_table[row][column-1]+(_diag[row][column-1]>0?-5:0):0,canComeLeftLeft=wordPos>minWordMatchPos+1&&_diag[row][column-1]>0,leftLeftScore=canComeLeftLeft?_table[row][column-2]+(_diag[row][column-2]>0?-5:0):0;if(canComeLeftLeft&&(!canComeLeft||leftLeftScore>=leftScore)&&(!canComeDiag||leftLeftScore>=diagScore))_table[row][column]=leftLeftScore,_arrows[row][column]=3,_diag[row][column]=0;else if(canComeLeft&&(!canComeDiag||leftScore>=diagScore))_table[row][column]=leftScore,_arrows[row][column]=2,_diag[row][column]=0;else{if(!canComeDiag)throw new Error("not possible");_table[row][column]=diagScore,_arrows[row][column]=1,_diag[row][column]=_diag[row-1][column-1]+1}}}if(!hasStrongFirstMatch[0]&&!firstMatchCanBeWeak)return;row--,column--;const result=[_table[row][column],wordStart];let backwardsDiagLength=0,maxMatchColumn=0;for(;row>=1;){let diagColumn=column;do{const arrow=_arrows[row][diagColumn];if(3===arrow)diagColumn-=2;else{if(2!==arrow)break;diagColumn-=1}}while(diagColumn>=1);backwardsDiagLength>1&&patternLow[patternStart+row-1]===wordLow[wordStart+column-1]&&!isUpperCaseAtPos(diagColumn+wordStart-1,word,wordLow)&&backwardsDiagLength+1>_diag[row][diagColumn]&&(diagColumn=column),diagColumn===column?backwardsDiagLength++:backwardsDiagLength=1,maxMatchColumn||(maxMatchColumn=diagColumn),row--,column=diagColumn-1,result.push(column)}wordLen===patternLen&&(result[0]+=2);const skippedCharsCount=maxMatchColumn-patternLen;return result[0]-=skippedCharsCount,result}function _doScore(pattern,patternLow,patternPos,patternStart,word,wordLow,wordPos,wordLen,wordStart,newMatchStart,outFirstMatchStrong){if(patternLow[patternPos]!==wordLow[wordPos])return Number.MIN_SAFE_INTEGER;let score=1,isGapLocation=!1;return wordPos===patternPos-patternStart?score=pattern[patternPos]===word[wordPos]?7:5:!isUpperCaseAtPos(wordPos,word,wordLow)||0!==wordPos&&isUpperCaseAtPos(wordPos-1,word,wordLow)?!isSeparatorAtPos(wordLow,wordPos)||0!==wordPos&&isSeparatorAtPos(wordLow,wordPos-1)?(isSeparatorAtPos(wordLow,wordPos-1)||isWhitespaceAtPos(wordLow,wordPos-1))&&(score=5,isGapLocation=!0):score=5:(score=pattern[patternPos]===word[wordPos]?7:5,isGapLocation=!0),score>1&&patternPos===patternStart&&(outFirstMatchStrong[0]=!0),isGapLocation||(isGapLocation=isUpperCaseAtPos(wordPos,word,wordLow)||isSeparatorAtPos(wordLow,wordPos-1)||isWhitespaceAtPos(wordLow,wordPos-1)),patternPos===patternStart?wordPos>wordStart&&(score-=isGapLocation?3:5):score+=newMatchStart?isGapLocation?2:0:isGapLocation?0:1,wordPos+1===wordLen&&(score-=isGapLocation?3:5),score}function nextTypoPermutation(pattern,patternPos){if(patternPos+1>=pattern.length)return;const swap1=pattern[patternPos],swap2=pattern[patternPos+1];return swap1!==swap2?pattern.slice(0,patternPos)+swap2+swap1+pattern.slice(patternPos+2):void 0}exports.isPatternInWord=isPatternInWord,function(FuzzyScore){FuzzyScore.Default=[-100,0],FuzzyScore.isDefault=function isDefault(score){return!score||2===score.length&&-100===score[0]&&0===score[1]}}(exports.FuzzyScore||(exports.FuzzyScore={})),exports.fuzzyScore=fuzzyScore,exports.fuzzyScoreGracefulAggressive=function fuzzyScoreGracefulAggressive(pattern,lowPattern,patternPos,word,lowWord,wordPos,firstMatchCanBeWeak){return function fuzzyScoreWithPermutations(pattern,lowPattern,patternPos,word,lowWord,wordPos,aggressive,firstMatchCanBeWeak){let top=fuzzyScore(pattern,lowPattern,patternPos,word,lowWord,wordPos,firstMatchCanBeWeak);if(top&&!aggressive)return top;if(pattern.length>=3){const tries=Math.min(7,pattern.length-1);for(let movingPatternPos=patternPos+1;movingPatternPos<tries;movingPatternPos++){const newPattern=nextTypoPermutation(pattern,movingPatternPos);if(newPattern){const candidate=fuzzyScore(newPattern,newPattern.toLowerCase(),patternPos,word,lowWord,wordPos,firstMatchCanBeWeak);candidate&&(candidate[0]-=3,(!top||candidate[0]>top[0])&&(top=candidate))}}}return top}(pattern,lowPattern,patternPos,word,lowWord,wordPos,!0,firstMatchCanBeWeak)}})),define(__m[322],__M([1,0,75,84,16,8]),(function(require,exports,filters_1,path_1,platform_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pieceToQuery=exports.prepareQuery=exports.scoreFuzzy2=void 0;const NO_SCORE2=[void 0,[]];function doScoreFuzzy2Single(target,query,patternStart,wordStart){const score=(0,filters_1.fuzzyScore)(query.original,query.originalLowercase,patternStart,target,target.toLowerCase(),wordStart,!0);return score?[score[0],(0,filters_1.createMatches)(score)]:NO_SCORE2}exports.scoreFuzzy2=function scoreFuzzy2(target,query,patternStart=0,wordStart=0){const preparedQuery=query;return preparedQuery.values&&preparedQuery.values.length>1?function doScoreFuzzy2Multiple(target,query,patternStart,wordStart){let totalScore=0;const totalMatches=[];for(const queryPiece of query){const[score,matches]=doScoreFuzzy2Single(target,queryPiece,patternStart,wordStart);if("number"!=typeof score)return NO_SCORE2;totalScore+=score,totalMatches.push(...matches)}return[totalScore,normalizeMatches(totalMatches)]}(target,preparedQuery.values,patternStart,wordStart):doScoreFuzzy2Single(target,query,patternStart,wordStart)};Object.freeze({score:0});function normalizeMatches(matches){const sortedMatches=matches.sort(((matchA,matchB)=>matchA.start-matchB.start)),normalizedMatches=[];let currentMatch;for(const match of sortedMatches)currentMatch&&matchOverlaps(currentMatch,match)?(currentMatch.start=Math.min(currentMatch.start,match.start),currentMatch.end=Math.max(currentMatch.end,match.end)):(currentMatch=match,normalizedMatches.push(match));return normalizedMatches}function matchOverlaps(matchA,matchB){return!(matchA.end<matchB.start)&&!(matchB.end<matchA.start)}function queryExpectsExactMatch(query){return query.startsWith('"')&&query.endsWith('"')}function prepareQuery(original){"string"!=typeof original&&(original="");const originalLowercase=original.toLowerCase(),{pathNormalized,normalized,normalizedLowercase}=normalizeQuery(original),containsPathSeparator=pathNormalized.indexOf(path_1.sep)>=0,expectExactMatch=queryExpectsExactMatch(original);let values;const originalSplit=original.split(" ");if(originalSplit.length>1)for(const originalPiece of originalSplit){const expectExactMatchPiece=queryExpectsExactMatch(originalPiece),{pathNormalized:pathNormalizedPiece,normalized:normalizedPiece,normalizedLowercase:normalizedLowercasePiece}=normalizeQuery(originalPiece);normalizedPiece&&(values||(values=[]),values.push({original:originalPiece,originalLowercase:originalPiece.toLowerCase(),pathNormalized:pathNormalizedPiece,normalized:normalizedPiece,normalizedLowercase:normalizedLowercasePiece,expectContiguousMatch:expectExactMatchPiece}))}return{original,originalLowercase,pathNormalized,normalized,normalizedLowercase,values,containsPathSeparator,expectContiguousMatch:expectExactMatch}}function normalizeQuery(original){let pathNormalized;pathNormalized=platform_1.isWindows?original.replace(/\//g,path_1.sep):original.replace(/\\/g,path_1.sep);const normalized=(0,strings_1.stripWildcards)(pathNormalized).replace(/\s|"/g,"");return{pathNormalized,normalized,normalizedLowercase:normalized.toLowerCase()}}exports.prepareQuery=prepareQuery,exports.pieceToQuery=function pieceToQuery(arg1){return Array.isArray(arg1)?prepareQuery(arg1.map((piece=>piece.original)).join(" ")):prepareQuery(arg1.original)}})),define(__m[218],__M([1,0,10,168,49,84,16,8]),(function(require,exports,async_1,extpath_1,map_1,path_1,platform_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isRelativePattern=exports.parse=exports.match=exports.splitGlobAware=exports.GLOB_SPLIT=exports.GLOBSTAR=void 0,exports.GLOBSTAR="**",exports.GLOB_SPLIT="/";const ALL_FORWARD_SLASHES=/\//g;function starsToRegExp(starCount){switch(starCount){case 0:return"";case 1:return"[^/\\\\]*?";default:return"(?:[/\\\\]|[^/\\\\]+[/\\\\]|[/\\\\][^/\\\\]+)*?"}}function splitGlobAware(pattern,splitChar){if(!pattern)return[];const segments=[];let inBraces=!1,inBrackets=!1,curVal="";for(const char of pattern){switch(char){case splitChar:if(!inBraces&&!inBrackets){segments.push(curVal),curVal="";continue}break;case"{":inBraces=!0;break;case"}":inBraces=!1;break;case"[":inBrackets=!0;break;case"]":inBrackets=!1}curVal+=char}return curVal&&segments.push(curVal),segments}function parseRegExp(pattern){if(!pattern)return"";let regEx="";const segments=splitGlobAware(pattern,exports.GLOB_SPLIT);if(segments.every((s=>s===exports.GLOBSTAR)))regEx=".*";else{let previousSegmentWasGlobStar=!1;segments.forEach(((segment,index)=>{if(segment===exports.GLOBSTAR)return void(previousSegmentWasGlobStar||(regEx+=starsToRegExp(2),previousSegmentWasGlobStar=!0));let inBraces=!1,braceVal="",inBrackets=!1,bracketVal="";for(const char of segment)if("}"!==char&&inBraces)braceVal+=char;else if(!inBrackets||"]"===char&&bracketVal)switch(char){case"{":inBraces=!0;continue;case"[":inBrackets=!0;continue;case"}":{const braceRegExp=`(?:${splitGlobAware(braceVal,",").map((c=>parseRegExp(c))).join("|")})`;regEx+=braceRegExp,inBraces=!1,braceVal="";break}case"]":regEx+="["+bracketVal+"]",inBrackets=!1,bracketVal="";break;case"?":regEx+="[^/\\\\]";continue;case"*":regEx+=starsToRegExp(1);continue;default:regEx+=(0,strings_1.escapeRegExpCharacters)(char)}else{let res;res="-"===char?char:"^"!==char&&"!"!==char||bracketVal?char===exports.GLOB_SPLIT?"":(0,strings_1.escapeRegExpCharacters)(char):"^",bracketVal+=res}index<segments.length-1&&(segments[index+1]!==exports.GLOBSTAR||index+2<segments.length)&&(regEx+="[/\\\\]"),previousSegmentWasGlobStar=!1}))}return regEx}exports.splitGlobAware=splitGlobAware;const T1=/^\*\*\/\*\.[\w\.-]+$/,T2=/^\*\*\/([\w\.-]+)\/?$/,T3=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,T3_2=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,T4=/^\*\*((\/[\w\.-]+)+)\/?$/,T5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,CACHE=new map_1.LRUCache(1e4),FALSE=function(){return!1},NULL=function(){return null};function parsePattern(arg1,options){if(!arg1)return NULL;let pattern;pattern="string"!=typeof arg1?arg1.pattern:arg1,pattern=pattern.trim();const patternKey=`${pattern}_${!!options.trimForExclusions}`;let match,parsedPattern=CACHE.get(patternKey);if(parsedPattern)return wrapRelativePattern(parsedPattern,arg1);if(T1.test(pattern)){const base=pattern.substr(4);parsedPattern=function(path,basename){return"string"==typeof path&&path.endsWith(base)?pattern:null}}else parsedPattern=(match=T2.exec(trimForExclusions(pattern,options)))?function trivia2(base,originalPattern){const slashBase=`/${base}`,backslashBase=`\\${base}`,parsedPattern=function(path,basename){return"string"!=typeof path?null:basename?basename===base?originalPattern:null:path===base||path.endsWith(slashBase)||path.endsWith(backslashBase)?originalPattern:null},basenames=[base];return parsedPattern.basenames=basenames,parsedPattern.patterns=[originalPattern],parsedPattern.allBasenames=basenames,parsedPattern}(match[1],pattern):(options.trimForExclusions?T3_2:T3).test(pattern)?function trivia3(pattern,options){const parsedPatterns=aggregateBasenameMatches(pattern.slice(1,-1).split(",").map((pattern=>parsePattern(pattern,options))).filter((pattern=>pattern!==NULL)),pattern),n=parsedPatterns.length;if(!n)return NULL;if(1===n)return parsedPatterns[0];const parsedPattern=function(path,basename){for(let i=0,n=parsedPatterns.length;i<n;i++)if(parsedPatterns[i](path,basename))return pattern;return null},withBasenames=parsedPatterns.find((pattern=>!!pattern.allBasenames));withBasenames&&(parsedPattern.allBasenames=withBasenames.allBasenames);const allPaths=parsedPatterns.reduce(((all,current)=>current.allPaths?all.concat(current.allPaths):all),[]);allPaths.length&&(parsedPattern.allPaths=allPaths);return parsedPattern}(pattern,options):(match=T4.exec(trimForExclusions(pattern,options)))?trivia4and5(match[1].substr(1),pattern,!0):(match=T5.exec(trimForExclusions(pattern,options)))?trivia4and5(match[1],pattern,!1):function toRegExp(pattern){try{const regExp=new RegExp(`^${parseRegExp(pattern)}$`);return function(path){return regExp.lastIndex=0,"string"==typeof path&&regExp.test(path)?pattern:null}}catch(error){return NULL}}(pattern);return CACHE.set(patternKey,parsedPattern),wrapRelativePattern(parsedPattern,arg1)}function wrapRelativePattern(parsedPattern,arg2){return"string"==typeof arg2?parsedPattern:function(path,basename){return(0,extpath_1.isEqualOrParent)(path,arg2.base,!platform_1.isLinux)?parsedPattern(path.substr(arg2.base.length+1),basename):null}}function trimForExclusions(pattern,options){return options.trimForExclusions&&pattern.endsWith("/**")?pattern.substr(0,pattern.length-2):pattern}function trivia4and5(targetPath,pattern,matchPathEnds){const usingPosixSep=path_1.sep===path_1.posix.sep,nativePath=usingPosixSep?targetPath:targetPath.replace(ALL_FORWARD_SLASHES,path_1.sep),nativePathEnd=path_1.sep+nativePath,targetPathEnd=path_1.posix.sep+targetPath,parsedPattern=matchPathEnds?function(testPath,basename){return"string"!=typeof testPath||testPath!==nativePath&&!testPath.endsWith(nativePathEnd)&&(usingPosixSep||testPath!==targetPath&&!testPath.endsWith(targetPathEnd))?null:pattern}:function(testPath,basename){return"string"!=typeof testPath||testPath!==nativePath&&(usingPosixSep||testPath!==targetPath)?null:pattern};return parsedPattern.allPaths=[(matchPathEnds?"*/":"./")+targetPath],parsedPattern}function parse(arg1,options={}){if(!arg1)return FALSE;if("string"==typeof arg1||isRelativePattern(arg1)){const parsedPattern=parsePattern(arg1,options);if(parsedPattern===NULL)return FALSE;const resultPattern=function(path,basename){return!!parsedPattern(path,basename)};return parsedPattern.allBasenames&&(resultPattern.allBasenames=parsedPattern.allBasenames),parsedPattern.allPaths&&(resultPattern.allPaths=parsedPattern.allPaths),resultPattern}return function parsedExpression(expression,options){const parsedPatterns=aggregateBasenameMatches(Object.getOwnPropertyNames(expression).map((pattern=>function parseExpressionPattern(pattern,value,options){if(!1===value)return NULL;const parsedPattern=parsePattern(pattern,options);if(parsedPattern===NULL)return NULL;if("boolean"==typeof value)return parsedPattern;if(value){const when=value.when;if("string"==typeof when){const result=(path,basename,name,hasSibling)=>{if(!hasSibling||!parsedPattern(path,basename))return null;const matched=hasSibling(when.replace("$(basename)",name));return(0,async_1.isThenable)(matched)?matched.then((m=>m?pattern:null)):matched?pattern:null};return result.requiresSiblings=!0,result}}return parsedPattern}(pattern,expression[pattern],options))).filter((pattern=>pattern!==NULL))),n=parsedPatterns.length;if(!n)return NULL;if(!parsedPatterns.some((parsedPattern=>!!parsedPattern.requiresSiblings))){if(1===n)return parsedPatterns[0];const resultExpression=function(path,basename){for(let i=0,n=parsedPatterns.length;i<n;i++){const result=parsedPatterns[i](path,basename);if(result)return result}return null},withBasenames=parsedPatterns.find((pattern=>!!pattern.allBasenames));withBasenames&&(resultExpression.allBasenames=withBasenames.allBasenames);const allPaths=parsedPatterns.reduce(((all,current)=>current.allPaths?all.concat(current.allPaths):all),[]);return allPaths.length&&(resultExpression.allPaths=allPaths),resultExpression}const resultExpression=function(path,base,hasSibling){let name;for(let i=0,n=parsedPatterns.length;i<n;i++){const parsedPattern=parsedPatterns[i];parsedPattern.requiresSiblings&&hasSibling&&(base||(base=(0,path_1.basename)(path)),name||(name=base.substr(0,base.length-(0,path_1.extname)(path).length)));const result=parsedPattern(path,base,name,hasSibling);if(result)return result}return null},withBasenames=parsedPatterns.find((pattern=>!!pattern.allBasenames));withBasenames&&(resultExpression.allBasenames=withBasenames.allBasenames);const allPaths=parsedPatterns.reduce(((all,current)=>current.allPaths?all.concat(current.allPaths):all),[]);allPaths.length&&(resultExpression.allPaths=allPaths);return resultExpression}(arg1,options)}function isRelativePattern(obj){const rp=obj;return!!rp&&("string"==typeof rp.base&&"string"==typeof rp.pattern)}function aggregateBasenameMatches(parsedPatterns,result){const basenamePatterns=parsedPatterns.filter((parsedPattern=>!!parsedPattern.basenames));if(basenamePatterns.length<2)return parsedPatterns;const basenames=basenamePatterns.reduce(((all,current)=>{const basenames=current.basenames;return basenames?all.concat(basenames):all}),[]);let patterns;if(result){patterns=[];for(let i=0,n=basenames.length;i<n;i++)patterns.push(result)}else patterns=basenamePatterns.reduce(((all,current)=>{const patterns=current.patterns;return patterns?all.concat(patterns):all}),[]);const aggregate=function(path,basename){if("string"!=typeof path)return null;if(!basename){let i;for(i=path.length;i>0;i--){const ch=path.charCodeAt(i-1);if(47===ch||92===ch)break}basename=path.substr(i)}const index=basenames.indexOf(basename);return-1!==index?patterns[index]:null};aggregate.basenames=basenames,aggregate.patterns=patterns,aggregate.allBasenames=basenames;const aggregatedPatterns=parsedPatterns.filter((parsedPattern=>!parsedPattern.basenames));return aggregatedPatterns.push(aggregate),aggregatedPatterns}exports.match=function match(arg1,path,hasSibling){return!(!arg1||"string"!=typeof path)&&parse(arg1)(path,void 0,hasSibling)},exports.parse=parse,exports.isRelativePattern=isRelativePattern})),define(__m[97],__M([1,0,28,75,8]),(function(require,exports,codicons_1,filters_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchesFuzzyIconAware=exports.parseLabelWithIcons=exports.stripIcons=exports.markdownEscapeEscapedIcons=exports.escapeIcons=exports.iconStartMarker=void 0,exports.iconStartMarker="$(";const iconsRegex=new RegExp(`\\$\\(${codicons_1.CSSIcon.iconNameExpression}(?:${codicons_1.CSSIcon.iconModifierExpression})?\\)`,"g"),iconNameCharacterRegexp=new RegExp(codicons_1.CSSIcon.iconNameCharacter),escapeIconsRegex=new RegExp(`(\\\\)?${iconsRegex.source}`,"g");exports.escapeIcons=function escapeIcons(text){return text.replace(escapeIconsRegex,((match,escaped)=>escaped?match:`\\${match}`))};const markdownEscapedIconsRegex=new RegExp(`\\\\${iconsRegex.source}`,"g");exports.markdownEscapeEscapedIcons=function markdownEscapeEscapedIcons(text){return text.replace(markdownEscapedIconsRegex,(match=>`\\${match}`))};const stripIconsRegex=new RegExp(`(\\s)?(\\\\)?${iconsRegex.source}(\\s)?`,"g");exports.stripIcons=function stripIcons(text){return-1===text.indexOf(exports.iconStartMarker)?text:text.replace(stripIconsRegex,((match,preWhitespace,escaped,postWhitespace)=>escaped?match:preWhitespace||postWhitespace||""))},exports.parseLabelWithIcons=function parseLabelWithIcons(text){const firstIconIndex=text.indexOf(exports.iconStartMarker);return-1===firstIconIndex?{text}:function doParseLabelWithIcons(text,firstIconIndex){const iconOffsets=[];let textWithoutIcons="";function appendChars(chars){if(chars){textWithoutIcons+=chars;for(const _ of chars)iconOffsets.push(iconsOffset)}}let char,nextChar,currentIconStart=-1,currentIconValue="",iconsOffset=0,offset=firstIconIndex;const length=text.length;appendChars(text.substr(0,firstIconIndex));for(;offset<length;){if(char=text[offset],nextChar=text[offset+1],char===exports.iconStartMarker[0]&&nextChar===exports.iconStartMarker[1])currentIconStart=offset,appendChars(currentIconValue),currentIconValue=exports.iconStartMarker,offset++;else if(")"===char&&-1!==currentIconStart){iconsOffset+=offset-currentIconStart+1,currentIconStart=-1,currentIconValue=""}else-1!==currentIconStart?iconNameCharacterRegexp.test(char)?currentIconValue+=char:(appendChars(currentIconValue),currentIconStart=-1,currentIconValue=""):appendChars(char);offset++}return appendChars(currentIconValue),{text:textWithoutIcons,iconOffsets}}(text,firstIconIndex)},exports.matchesFuzzyIconAware=function matchesFuzzyIconAware(query,target,enableSeparateSubstringMatching=!1){const{text,iconOffsets}=target;if(!iconOffsets||0===iconOffsets.length)return(0,filters_1.matchesFuzzy)(query,text,enableSeparateSubstringMatching);const wordToMatchAgainstWithoutIconsTrimmed=(0,strings_1.ltrim)(text," "),leadingWhitespaceOffset=text.length-wordToMatchAgainstWithoutIconsTrimmed.length,matches=(0,filters_1.matchesFuzzy)(query,wordToMatchAgainstWithoutIconsTrimmed,enableSeparateSubstringMatching);if(matches)for(const match of matches){const iconOffset=iconOffsets[match.start+leadingWhitespaceOffset]+leadingWhitespaceOffset;match.start+=iconOffset,match.end+=iconOffset}return matches}})),define(__m[68],__M([1,0,13,97]),(function(require,exports,errors_1,iconLabels_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseHrefAndDimensions=exports.removeMarkdownEscapes=exports.escapeMarkdownSyntaxTokens=exports.isMarkdownString=exports.isEmptyMarkdownString=exports.MarkdownString=void 0;class MarkdownString{constructor(value="",isTrustedOrOptions=!1){var _a,_b,_c;if(this.value=value,"string"!=typeof this.value)throw(0,errors_1.illegalArgument)("value");"boolean"==typeof isTrustedOrOptions?(this.isTrusted=isTrustedOrOptions,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=null!==(_a=isTrustedOrOptions.isTrusted)&&void 0!==_a?_a:void 0,this.supportThemeIcons=null!==(_b=isTrustedOrOptions.supportThemeIcons)&&void 0!==_b&&_b,this.supportHtml=null!==(_c=isTrustedOrOptions.supportHtml)&&void 0!==_c&&_c)}appendText(value,newlineStyle=0){return this.value+=escapeMarkdownSyntaxTokens(this.supportThemeIcons?(0,iconLabels_1.escapeIcons)(value):value).replace(/([ \t]+)/g,((_match,g1)=>"&nbsp;".repeat(g1.length))).replace(/\>/gm,"\\>").replace(/\n/g,1===newlineStyle?"\\\n":"\n\n"),this}appendMarkdown(value){return this.value+=value,this}appendCodeblock(langId,code){return this.value+="\n```",this.value+=langId,this.value+="\n",this.value+=code,this.value+="\n```\n",this}}function isMarkdownString(thing){return thing instanceof MarkdownString||!(!thing||"object"!=typeof thing)&&!("string"!=typeof thing.value||"boolean"!=typeof thing.isTrusted&&void 0!==thing.isTrusted||"boolean"!=typeof thing.supportThemeIcons&&void 0!==thing.supportThemeIcons)}function escapeMarkdownSyntaxTokens(text){return text.replace(/[\\`*_{}[\]()#+\-!]/g,"\\$&")}exports.MarkdownString=MarkdownString,exports.isEmptyMarkdownString=function isEmptyMarkdownString(oneOrMany){return isMarkdownString(oneOrMany)?!oneOrMany.value:!Array.isArray(oneOrMany)||oneOrMany.every(isEmptyMarkdownString)},exports.isMarkdownString=isMarkdownString,exports.escapeMarkdownSyntaxTokens=escapeMarkdownSyntaxTokens,exports.removeMarkdownEscapes=function removeMarkdownEscapes(text){return text?text.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1"):text},exports.parseHrefAndDimensions=function parseHrefAndDimensions(href){const dimensions=[],splitted=href.split("|").map((s=>s.trim()));href=splitted[0];const parameters=splitted[1];if(parameters){const heightFromParams=/height=(\d+)/.exec(parameters),widthFromParams=/width=(\d+)/.exec(parameters),height=heightFromParams?heightFromParams[1]:"",width=widthFromParams?widthFromParams[1]:"",widthIsFinite=isFinite(parseInt(width)),heightIsFinite=isFinite(parseInt(height));widthIsFinite&&dimensions.push(`width="${width}"`),heightIsFinite&&dimensions.push(`height="${height}"`)}return{href,dimensions}}})),define(__m[323],__M([1,0,8]),(function(require,exports,strings){"use strict";function buildReplaceStringWithCasePreserved(matches,pattern){if(matches&&""!==matches[0]){const containsHyphens=validateSpecificSpecialCharacter(matches,pattern,"-"),containsUnderscores=validateSpecificSpecialCharacter(matches,pattern,"_");return containsHyphens&&!containsUnderscores?buildReplaceStringForSpecificSpecialCharacter(matches,pattern,"-"):!containsHyphens&&containsUnderscores?buildReplaceStringForSpecificSpecialCharacter(matches,pattern,"_"):matches[0].toUpperCase()===matches[0]?pattern.toUpperCase():matches[0].toLowerCase()===matches[0]?pattern.toLowerCase():strings.containsUppercaseCharacter(matches[0][0])&&pattern.length>0?pattern[0].toUpperCase()+pattern.substr(1):matches[0][0].toUpperCase()!==matches[0][0]&&pattern.length>0?pattern[0].toLowerCase()+pattern.substr(1):pattern}return pattern}function validateSpecificSpecialCharacter(matches,pattern,specialCharacter){return-1!==matches[0].indexOf(specialCharacter)&&-1!==pattern.indexOf(specialCharacter)&&matches[0].split(specialCharacter).length===pattern.split(specialCharacter).length}function buildReplaceStringForSpecificSpecialCharacter(matches,pattern,specialCharacter){const splitPatternAtSpecialCharacter=pattern.split(specialCharacter),splitMatchAtSpecialCharacter=matches[0].split(specialCharacter);let replaceString="";return splitPatternAtSpecialCharacter.forEach(((splitValue,index)=>{replaceString+=buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]],splitValue)+specialCharacter})),replaceString.slice(0,-1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildReplaceStringWithCasePreserved=void 0,exports.buildReplaceStringWithCasePreserved=buildReplaceStringWithCasePreserved})),define(__m[76],__M([1,0,8]),(function(require,exports,strings){"use strict";var Severity;Object.defineProperty(exports,"__esModule",{value:!0}),function(Severity){Severity[Severity.Ignore=0]="Ignore",Severity[Severity.Info=1]="Info",Severity[Severity.Warning=2]="Warning",Severity[Severity.Error=3]="Error"}(Severity||(Severity={})),function(Severity){Severity.fromValue=function fromValue(value){return value?strings.equalsIgnoreCase("error",value)?Severity.Error:strings.equalsIgnoreCase("warning",value)||strings.equalsIgnoreCase("warn",value)?Severity.Warning:strings.equalsIgnoreCase("info",value)?Severity.Info:Severity.Ignore:Severity.Ignore},Severity.toString=function toString(severity){switch(severity){case Severity.Error:return"error";case Severity.Warning:return"warning";case Severity.Info:return"info";default:return"ignore"}}}(Severity||(Severity={})),exports.default=Severity})),define(__m[19],__M([1,0]),(function(require,exports){"use strict";function isString(str){return"string"==typeof str}function isUndefined(obj){return void 0===obj}function isUndefinedOrNull(obj){return isUndefined(obj)||null===obj}function isFunction(obj){return"function"==typeof obj}function validateConstraint(arg,constraint){if(isString(constraint)){if(typeof arg!==constraint)throw new Error(`argument does not match constraint: typeof ${constraint}`)}else if(isFunction(constraint)){try{if(arg instanceof constraint)return}catch(_a){}if(!isUndefinedOrNull(arg)&&arg.constructor===constraint)return;if(1===constraint.length&&!0===constraint.call(void 0,arg))return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function getAllPropertyNames(obj){let res=[],proto=Object.getPrototypeOf(obj);for(;Object.prototype!==proto;)res=res.concat(Object.getOwnPropertyNames(proto)),proto=Object.getPrototypeOf(proto);return res}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertNever=exports.withNullAsUndefined=exports.createProxyObject=exports.getAllMethodNames=exports.getAllPropertyNames=exports.validateConstraint=exports.validateConstraints=exports.isFunction=exports.assertIsDefined=exports.assertType=exports.isUndefinedOrNull=exports.isDefined=exports.isUndefined=exports.isBoolean=exports.isIterable=exports.isNumber=exports.isObject=exports.isString=exports.isArray=void 0,exports.isArray=function isArray(array){return Array.isArray(array)},exports.isString=isString,exports.isObject=function isObject(obj){return!("object"!=typeof obj||null===obj||Array.isArray(obj)||obj instanceof RegExp||obj instanceof Date)},exports.isNumber=function isNumber(obj){return"number"==typeof obj&&!isNaN(obj)},exports.isIterable=function isIterable(obj){return!!obj&&"function"==typeof obj[Symbol.iterator]},exports.isBoolean=function isBoolean(obj){return!0===obj||!1===obj},exports.isUndefined=isUndefined,exports.isDefined=function isDefined(arg){return!isUndefinedOrNull(arg)},exports.isUndefinedOrNull=isUndefinedOrNull,exports.assertType=function assertType(condition,type){if(!condition)throw new Error(type?`Unexpected type, expected '${type}'`:"Unexpected type")},exports.assertIsDefined=function assertIsDefined(arg){if(isUndefinedOrNull(arg))throw new Error("Assertion Failed: argument is undefined or null");return arg},exports.isFunction=isFunction,exports.validateConstraints=function validateConstraints(args,constraints){const len=Math.min(args.length,constraints.length);for(let i=0;i<len;i++)validateConstraint(args[i],constraints[i])},exports.validateConstraint=validateConstraint,exports.getAllPropertyNames=getAllPropertyNames,exports.getAllMethodNames=function getAllMethodNames(obj){const methods=[];for(const prop of getAllPropertyNames(obj))"function"==typeof obj[prop]&&methods.push(prop);return methods},exports.createProxyObject=function createProxyObject(methodNames,invoke){const createProxyMethod=method=>function(){const args=Array.prototype.slice.call(arguments,0);return invoke(method,args)};let result={};for(const methodName of methodNames)result[methodName]=createProxyMethod(methodName);return result},exports.withNullAsUndefined=function withNullAsUndefined(x){return null===x?void 0:x},exports.assertNever=function assertNever(value,message="Unreachable"){throw new Error(message)}})),define(__m[40],__M([1,0,19]),(function(require,exports,types_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOrDefault=exports.equals=exports.mixin=exports.cloneAndChange=exports.deepFreeze=exports.deepClone=void 0,exports.deepClone=function deepClone(obj){if(!obj||"object"!=typeof obj)return obj;if(obj instanceof RegExp)return obj;const result=Array.isArray(obj)?[]:{};return Object.keys(obj).forEach((key=>{obj[key]&&"object"==typeof obj[key]?result[key]=deepClone(obj[key]):result[key]=obj[key]})),result},exports.deepFreeze=function deepFreeze(obj){if(!obj||"object"!=typeof obj)return obj;const stack=[obj];for(;stack.length>0;){const obj=stack.shift();Object.freeze(obj);for(const key in obj)if(_hasOwnProperty.call(obj,key)){const prop=obj[key];"object"!=typeof prop||Object.isFrozen(prop)||stack.push(prop)}}return obj};const _hasOwnProperty=Object.prototype.hasOwnProperty;function _cloneAndChange(obj,changer,seen){if((0,types_1.isUndefinedOrNull)(obj))return obj;const changed=changer(obj);if(void 0!==changed)return changed;if((0,types_1.isArray)(obj)){const r1=[];for(const e of obj)r1.push(_cloneAndChange(e,changer,seen));return r1}if((0,types_1.isObject)(obj)){if(seen.has(obj))throw new Error("Cannot clone recursive data-structure");seen.add(obj);const r2={};for(let i2 in obj)_hasOwnProperty.call(obj,i2)&&(r2[i2]=_cloneAndChange(obj[i2],changer,seen));return seen.delete(obj),r2}return obj}exports.cloneAndChange=function cloneAndChange(obj,changer){return _cloneAndChange(obj,changer,new Set)},exports.mixin=function mixin(destination,source,overwrite=!0){return(0,types_1.isObject)(destination)?((0,types_1.isObject)(source)&&Object.keys(source).forEach((key=>{key in destination?overwrite&&((0,types_1.isObject)(destination[key])&&(0,types_1.isObject)(source[key])?mixin(destination[key],source[key],overwrite):destination[key]=source[key]):destination[key]=source[key]})),destination):source},exports.equals=function equals(one,other){if(one===other)return!0;if(null==one||null==other)return!1;if(typeof one!=typeof other)return!1;if("object"!=typeof one)return!1;if(Array.isArray(one)!==Array.isArray(other))return!1;let i,key;if(Array.isArray(one)){if(one.length!==other.length)return!1;for(i=0;i<one.length;i++)if(!equals(one[i],other[i]))return!1}else{const oneKeys=[];for(key in one)oneKeys.push(key);oneKeys.sort();const otherKeys=[];for(key in other)otherKeys.push(key);if(otherKeys.sort(),!equals(oneKeys,otherKeys))return!1;for(i=0;i<oneKeys.length;i++)if(!equals(one[oneKeys[i]],other[oneKeys[i]]))return!1}return!0},exports.getOrDefault=function getOrDefault(obj,fn,defaultValue){const result=fn(obj);return void 0===result?defaultValue:result}})),define(__m[142],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toUint32=exports.toUint8=void 0,exports.toUint8=function toUint8(v){return v<0?0:v>255?255:0|v},exports.toUint32=function toUint32(v){return v<0?0:v>4294967295?4294967295:0|v}})),define(__m[25],__M([1,0,84,16]),(function(require,exports,paths,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.uriToFsPath=exports.URI=void 0;const _schemePattern=/^\w[\w\d+.-]*$/,_singleSlashStart=/^\//,_doubleSlashStart=/^\/\//;function _validateUri(ret,_strict){if(!ret.scheme&&_strict)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${ret.authority}", path: "${ret.path}", query: "${ret.query}", fragment: "${ret.fragment}"}`);if(ret.scheme&&!_schemePattern.test(ret.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(ret.path)if(ret.authority){if(!_singleSlashStart.test(ret.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(_doubleSlashStart.test(ret.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}const _slash="/",_regexp=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class URI{constructor(schemeOrData,authority,path,query,fragment,_strict=!1){"object"==typeof schemeOrData?(this.scheme=schemeOrData.scheme||"",this.authority=schemeOrData.authority||"",this.path=schemeOrData.path||"",this.query=schemeOrData.query||"",this.fragment=schemeOrData.fragment||""):(this.scheme=function _schemeFix(scheme,_strict){return scheme||_strict?scheme:"file"}(schemeOrData,_strict),this.authority=authority||"",this.path=function _referenceResolution(scheme,path){switch(scheme){case"https":case"http":case"file":path?path[0]!==_slash&&(path=_slash+path):path=_slash}return path}(this.scheme,path||""),this.query=query||"",this.fragment=fragment||"",_validateUri(this,_strict))}static isUri(thing){return thing instanceof URI||!!thing&&("string"==typeof thing.authority&&"string"==typeof thing.fragment&&"string"==typeof thing.path&&"string"==typeof thing.query&&"string"==typeof thing.scheme&&"string"==typeof thing.fsPath&&"function"==typeof thing.with&&"function"==typeof thing.toString)}get fsPath(){return uriToFsPath(this,!1)}with(change){if(!change)return this;let{scheme,authority,path,query,fragment}=change;return void 0===scheme?scheme=this.scheme:null===scheme&&(scheme=""),void 0===authority?authority=this.authority:null===authority&&(authority=""),void 0===path?path=this.path:null===path&&(path=""),void 0===query?query=this.query:null===query&&(query=""),void 0===fragment?fragment=this.fragment:null===fragment&&(fragment=""),scheme===this.scheme&&authority===this.authority&&path===this.path&&query===this.query&&fragment===this.fragment?this:new Uri(scheme,authority,path,query,fragment)}static parse(value,_strict=!1){const match=_regexp.exec(value);return match?new Uri(match[2]||"",percentDecode(match[4]||""),percentDecode(match[5]||""),percentDecode(match[7]||""),percentDecode(match[9]||""),_strict):new Uri("","","","","")}static file(path){let authority="";if(platform_1.isWindows&&(path=path.replace(/\\/g,_slash)),path[0]===_slash&&path[1]===_slash){const idx=path.indexOf(_slash,2);-1===idx?(authority=path.substring(2),path=_slash):(authority=path.substring(2,idx),path=path.substring(idx)||_slash)}return new Uri("file",authority,path,"","")}static from(components){const result=new Uri(components.scheme,components.authority,components.path,components.query,components.fragment);return _validateUri(result,!0),result}static joinPath(uri,...pathFragment){if(!uri.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let newPath;return newPath=platform_1.isWindows&&"file"===uri.scheme?URI.file(paths.win32.join(uriToFsPath(uri,!0),...pathFragment)).path:paths.posix.join(uri.path,...pathFragment),uri.with({path:newPath})}toString(skipEncoding=!1){return _asFormatted(this,skipEncoding)}toJSON(){return this}static revive(data){if(data){if(data instanceof URI)return data;{const result=new Uri(data);return result._formatted=data.external,result._fsPath=data._sep===_pathSepMarker?data.fsPath:null,result}}return data}}exports.URI=URI;const _pathSepMarker=platform_1.isWindows?1:void 0;class Uri extends URI{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=uriToFsPath(this,!1)),this._fsPath}toString(skipEncoding=!1){return skipEncoding?_asFormatted(this,!0):(this._formatted||(this._formatted=_asFormatted(this,!1)),this._formatted)}toJSON(){const res={$mid:1};return this._fsPath&&(res.fsPath=this._fsPath,res._sep=_pathSepMarker),this._formatted&&(res.external=this._formatted),this.path&&(res.path=this.path),this.scheme&&(res.scheme=this.scheme),this.authority&&(res.authority=this.authority),this.query&&(res.query=this.query),this.fragment&&(res.fragment=this.fragment),res}}const encodeTable={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function encodeURIComponentFast(uriComponent,allowSlash){let res,nativeEncodePos=-1;for(let pos=0;pos<uriComponent.length;pos++){const code=uriComponent.charCodeAt(pos);if(code>=97&&code<=122||code>=65&&code<=90||code>=48&&code<=57||45===code||46===code||95===code||126===code||allowSlash&&47===code)-1!==nativeEncodePos&&(res+=encodeURIComponent(uriComponent.substring(nativeEncodePos,pos)),nativeEncodePos=-1),void 0!==res&&(res+=uriComponent.charAt(pos));else{void 0===res&&(res=uriComponent.substr(0,pos));const escaped=encodeTable[code];void 0!==escaped?(-1!==nativeEncodePos&&(res+=encodeURIComponent(uriComponent.substring(nativeEncodePos,pos)),nativeEncodePos=-1),res+=escaped):-1===nativeEncodePos&&(nativeEncodePos=pos)}}return-1!==nativeEncodePos&&(res+=encodeURIComponent(uriComponent.substring(nativeEncodePos))),void 0!==res?res:uriComponent}function encodeURIComponentMinimal(path){let res;for(let pos=0;pos<path.length;pos++){const code=path.charCodeAt(pos);35===code||63===code?(void 0===res&&(res=path.substr(0,pos)),res+=encodeTable[code]):void 0!==res&&(res+=path[pos])}return void 0!==res?res:path}function uriToFsPath(uri,keepDriveLetterCasing){let value;return value=uri.authority&&uri.path.length>1&&"file"===uri.scheme?`//${uri.authority}${uri.path}`:47===uri.path.charCodeAt(0)&&(uri.path.charCodeAt(1)>=65&&uri.path.charCodeAt(1)<=90||uri.path.charCodeAt(1)>=97&&uri.path.charCodeAt(1)<=122)&&58===uri.path.charCodeAt(2)?keepDriveLetterCasing?uri.path.substr(1):uri.path[1].toLowerCase()+uri.path.substr(2):uri.path,platform_1.isWindows&&(value=value.replace(/\//g,"\\")),value}function _asFormatted(uri,skipEncoding){const encoder=skipEncoding?encodeURIComponentMinimal:encodeURIComponentFast;let res="",{scheme,authority,path,query,fragment}=uri;if(scheme&&(res+=scheme,res+=":"),(authority||"file"===scheme)&&(res+=_slash,res+=_slash),authority){let idx=authority.indexOf("@");if(-1!==idx){const userinfo=authority.substr(0,idx);authority=authority.substr(idx+1),idx=userinfo.indexOf(":"),-1===idx?res+=encoder(userinfo,!1):(res+=encoder(userinfo.substr(0,idx),!1),res+=":",res+=encoder(userinfo.substr(idx+1),!1)),res+="@"}authority=authority.toLowerCase(),idx=authority.indexOf(":"),-1===idx?res+=encoder(authority,!1):(res+=encoder(authority.substr(0,idx),!1),res+=authority.substr(idx))}if(path){if(path.length>=3&&47===path.charCodeAt(0)&&58===path.charCodeAt(2)){const code=path.charCodeAt(1);code>=65&&code<=90&&(path=`/${String.fromCharCode(code+32)}:${path.substr(3)}`)}else if(path.length>=2&&58===path.charCodeAt(1)){const code=path.charCodeAt(0);code>=65&&code<=90&&(path=`${String.fromCharCode(code+32)}:${path.substr(2)}`)}res+=encoder(path,!0)}return query&&(res+="?",res+=encoder(query,!1)),fragment&&(res+="#",res+=skipEncoding?fragment:encodeURIComponentFast(fragment,!1)),res}function decodeURIComponentGraceful(str){try{return decodeURIComponent(str)}catch(_a){return str.length>3?str.substr(0,3)+decodeURIComponentGraceful(str.substr(3)):str}}exports.uriToFsPath=uriToFsPath;const _rEncodedAsHex=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function percentDecode(str){return str.match(_rEncodedAsHex)?str.replace(_rEncodedAsHex,(match=>decodeURIComponentGraceful(match))):str}})),define(__m[219],__M([1,0,112,25]),(function(require,exports,buffer_1,uri_1){"use strict";function revive(obj,depth=0){if(!obj||depth>200)return obj;if("object"==typeof obj){switch(obj.$mid){case 1:return uri_1.URI.revive(obj);case 2:return new RegExp(obj.source,obj.flags);case 14:return new Date(obj.source)}if(obj instanceof buffer_1.VSBuffer||obj instanceof Uint8Array)return obj;if(Array.isArray(obj))for(let i=0;i<obj.length;++i)obj[i]=revive(obj[i],depth+1);else for(const key in obj)Object.hasOwnProperty.call(obj,key)&&(obj[key]=revive(obj[key],depth+1))}return obj}Object.defineProperty(exports,"__esModule",{value:!0}),exports.revive=exports.parse=void 0,exports.parse=function parse(text){let data=JSON.parse(text);return data=revive(data),data},exports.revive=revive})),define(__m[45],__M([1,0,16,25]),(function(require,exports,platform,uri_1){"use strict";var Schemas;Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileAccess=exports.RemoteAuthorities=exports.connectionTokenQueryName=exports.Schemas=void 0,function(Schemas){Schemas.inMemory="inmemory",Schemas.vscode="vscode",Schemas.internal="private",Schemas.walkThrough="walkThrough",Schemas.walkThroughSnippet="walkThroughSnippet",Schemas.http="http",Schemas.https="https",Schemas.file="file",Schemas.mailto="mailto",Schemas.untitled="untitled",Schemas.data="data",Schemas.command="command",Schemas.vscodeRemote="vscode-remote",Schemas.vscodeRemoteResource="vscode-remote-resource",Schemas.userData="vscode-userdata",Schemas.vscodeCustomEditor="vscode-custom-editor",Schemas.vscodeNotebook="vscode-notebook",Schemas.vscodeNotebookCell="vscode-notebook-cell",Schemas.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Schemas.vscodeNotebookCellOutput="vscode-notebook-cell-output",Schemas.vscodeInteractive="vscode-interactive",Schemas.vscodeInteractiveInput="vscode-interactive-input",Schemas.vscodeSettings="vscode-settings",Schemas.vscodeWorkspaceTrust="vscode-workspace-trust",Schemas.vscodeTerminal="vscode-terminal",Schemas.webviewPanel="webview-panel",Schemas.vscodeWebview="vscode-webview",Schemas.extension="extension",Schemas.vscodeFileResource="vscode-file",Schemas.tmp="tmp",Schemas.vsls="vsls"}(Schemas=exports.Schemas||(exports.Schemas={})),exports.connectionTokenQueryName="tkn";exports.RemoteAuthorities=new class RemoteAuthoritiesImpl{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null}setPreferredWebSchema(schema){this._preferredWebSchema=schema}rewrite(uri){if(this._delegate)return this._delegate(uri);const authority=uri.authority;let host=this._hosts[authority];host&&-1!==host.indexOf(":")&&(host=`[${host}]`);const port=this._ports[authority],connectionToken=this._connectionTokens[authority];let query=`path=${encodeURIComponent(uri.path)}`;return"string"==typeof connectionToken&&(query+=`&${exports.connectionTokenQueryName}=${encodeURIComponent(connectionToken)}`),uri_1.URI.from({scheme:platform.isWeb?this._preferredWebSchema:Schemas.vscodeRemoteResource,authority:`${host}:${port}`,path:"/vscode-remote-resource",query})}};class FileAccessImpl{asBrowserUri(uriOrModule,moduleIdToUrl){const uri=this.toUri(uriOrModule,moduleIdToUrl);return uri.scheme===Schemas.vscodeRemote?exports.RemoteAuthorities.rewrite(uri):uri.scheme===Schemas.file&&(platform.isNative||platform.isWebWorker&&platform.globals.origin===`${Schemas.vscodeFileResource}://${FileAccessImpl.FALLBACK_AUTHORITY}`)?uri.with({scheme:Schemas.vscodeFileResource,authority:uri.authority||FileAccessImpl.FALLBACK_AUTHORITY,query:null,fragment:null}):uri}toUri(uriOrModule,moduleIdToUrl){return uri_1.URI.isUri(uriOrModule)?uriOrModule:uri_1.URI.parse(moduleIdToUrl.toUrl(uriOrModule))}}FileAccessImpl.FALLBACK_AUTHORITY="vscode-app",exports.FileAccess=new FileAccessImpl})),define(__m[7],__M([1,0,34,167,44,59,10,13,4,2,45,16]),(function(require,exports,browser,canIUse_1,keyboardEvent_1,mouseEvent_1,async_1,errors_1,event,lifecycle_1,network_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addMatchMediaChangeListener=exports.ModifierKeyEmitter=exports.asCSSPropertyValue=exports.asCSSUrl=exports.animate=exports.windowOpenNoOpener=exports.computeScreenAwareSize=exports.getElementsByTagName=exports.hide=exports.show=exports.$=exports.Namespace=exports.reset=exports.prepend=exports.append=exports.trackFocus=exports.restoreParentsScrollTop=exports.saveParentsScrollTop=exports.EventHelper=exports.EventType=exports.isHTMLElement=exports.removeCSSRulesContainingSelector=exports.createCSSRule=exports.createStyleSheet=exports.getActiveElement=exports.getShadowRoot=exports.isInShadowDOM=exports.isShadowRoot=exports.hasParentWithClass=exports.findParentWithClass=exports.isAncestor=exports.getTotalHeight=exports.getContentHeight=exports.getContentWidth=exports.getTotalWidth=exports.StandardWindow=exports.getDomNodePagePosition=exports.size=exports.getTopLeftOffset=exports.Dimension=exports.getClientArea=exports.getComputedStyle=exports.addDisposableThrottledListener=exports.scheduleAtNextAnimationFrame=exports.runAtThisOrScheduleAtNextAnimationFrame=exports.createEventEmitter=exports.addDisposableNonBubblingPointerOutListener=exports.addDisposableNonBubblingMouseOutListener=exports.addDisposableGenericMouseUpListener=exports.addDisposableGenericMouseDownListener=exports.addStandardDisposableGenericMouseUpListener=exports.addStandardDisposableGenericMouseDownListener=exports.addStandardDisposableListener=exports.addDisposableListener=exports.isInDOM=exports.clearNode=void 0,exports.clearNode=function clearNode(node){for(;node.firstChild;)node.firstChild.remove()},exports.isInDOM=function isInDOM(node){var _a;return null!==(_a=null==node?void 0:node.isConnected)&&void 0!==_a&&_a};class DomListener{constructor(node,type,handler,options){this._node=node,this._type=type,this._handler=handler,this._options=options||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(node,type,handler,useCaptureOrOptions){return new DomListener(node,type,handler,useCaptureOrOptions)}function _wrapAsStandardMouseEvent(handler){return function(e){return handler(new mouseEvent_1.StandardMouseEvent(e))}}exports.addDisposableListener=addDisposableListener;exports.addStandardDisposableListener=function addStandardDisposableListener(node,type,handler,useCapture){let wrapHandler=handler;return"click"===type||"mousedown"===type?wrapHandler=_wrapAsStandardMouseEvent(handler):"keydown"!==type&&"keypress"!==type&&"keyup"!==type||(wrapHandler=function _wrapAsStandardKeyboardEvent(handler){return function(e){return handler(new keyboardEvent_1.StandardKeyboardEvent(e))}}(handler)),addDisposableListener(node,type,wrapHandler,useCapture)};exports.addStandardDisposableGenericMouseDownListener=function addStandardDisposableListener(node,handler,useCapture){return addDisposableGenericMouseDownListener(node,_wrapAsStandardMouseEvent(handler),useCapture)};function addDisposableGenericMouseDownListener(node,handler,useCapture){return addDisposableListener(node,platform.isIOS&&canIUse_1.BrowserFeatures.pointerEvents?exports.EventType.POINTER_DOWN:exports.EventType.MOUSE_DOWN,handler,useCapture)}function addDisposableGenericMouseUpListener(node,handler,useCapture){return addDisposableListener(node,platform.isIOS&&canIUse_1.BrowserFeatures.pointerEvents?exports.EventType.POINTER_UP:exports.EventType.MOUSE_UP,handler,useCapture)}exports.addStandardDisposableGenericMouseUpListener=function addStandardDisposableListener(node,handler,useCapture){return addDisposableGenericMouseUpListener(node,_wrapAsStandardMouseEvent(handler),useCapture)},exports.addDisposableGenericMouseDownListener=addDisposableGenericMouseDownListener,exports.addDisposableGenericMouseUpListener=addDisposableGenericMouseUpListener,exports.addDisposableNonBubblingMouseOutListener=function addDisposableNonBubblingMouseOutListener(node,handler){return addDisposableListener(node,"mouseout",(e=>{let toElement=e.relatedTarget;for(;toElement&&toElement!==node;)toElement=toElement.parentNode;toElement!==node&&handler(e)}))},exports.addDisposableNonBubblingPointerOutListener=function addDisposableNonBubblingPointerOutListener(node,handler){return addDisposableListener(node,"pointerout",(e=>{let toElement=e.relatedTarget;for(;toElement&&toElement!==node;)toElement=toElement.parentNode;toElement!==node&&handler(e)}))},exports.createEventEmitter=function createEventEmitter(target,type,options){let domListener=null;const handler=e=>result.fire(e),result=new event.Emitter({onFirstListenerAdd:()=>{domListener||(domListener=new DomListener(target,type,handler,options))},onLastListenerRemove:()=>{domListener&&(domListener.dispose(),domListener=null)}});return result};let _animationFrame=null;class AnimationFrameQueueItem{constructor(runner,priority=0){this._runner=runner,this.priority=priority,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){(0,errors_1.onUnexpectedError)(e)}}static sort(a,b){return b.priority-a.priority}}!function(){let NEXT_QUEUE=[],CURRENT_QUEUE=null,animFrameRequested=!1,inAnimationFrameRunner=!1,animationFrameRunner=()=>{for(animFrameRequested=!1,CURRENT_QUEUE=NEXT_QUEUE,NEXT_QUEUE=[],inAnimationFrameRunner=!0;CURRENT_QUEUE.length>0;){CURRENT_QUEUE.sort(AnimationFrameQueueItem.sort),CURRENT_QUEUE.shift().execute()}inAnimationFrameRunner=!1};exports.scheduleAtNextAnimationFrame=(runner,priority=0)=>{let item=new AnimationFrameQueueItem(runner,priority);return NEXT_QUEUE.push(item),animFrameRequested||(animFrameRequested=!0,function doRequestAnimationFrame(callback){if(!_animationFrame){const emulatedRequestAnimationFrame=callback=>setTimeout((()=>callback((new Date).getTime())),0);_animationFrame=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||emulatedRequestAnimationFrame}return _animationFrame.call(self,callback)}(animationFrameRunner)),item},exports.runAtThisOrScheduleAtNextAnimationFrame=(runner,priority)=>{if(inAnimationFrameRunner){let item=new AnimationFrameQueueItem(runner,priority);return CURRENT_QUEUE.push(item),item}return(0,exports.scheduleAtNextAnimationFrame)(runner,priority)}}();const DEFAULT_EVENT_MERGER=function(lastEvent,currentEvent){return currentEvent};class TimeoutThrottledDomListener extends lifecycle_1.Disposable{constructor(node,type,handler,eventMerger=DEFAULT_EVENT_MERGER,minimumTimeMs=8){super();let lastEvent=null,lastHandlerTime=0,timeout=this._register(new async_1.TimeoutTimer),invokeHandler=()=>{lastHandlerTime=(new Date).getTime(),handler(lastEvent),lastEvent=null};this._register(addDisposableListener(node,type,(e=>{lastEvent=eventMerger(lastEvent,e);let elapsedTime=(new Date).getTime()-lastHandlerTime;elapsedTime>=minimumTimeMs?(timeout.cancel(),invokeHandler()):timeout.setIfNotSet(invokeHandler,minimumTimeMs-elapsedTime)})))}}function getComputedStyle(el){return document.defaultView.getComputedStyle(el,null)}exports.addDisposableThrottledListener=function addDisposableThrottledListener(node,type,handler,eventMerger,minimumTimeMs){return new TimeoutThrottledDomListener(node,type,handler,eventMerger,minimumTimeMs)},exports.getComputedStyle=getComputedStyle,exports.getClientArea=function getClientArea(element){if(element!==document.body)return new Dimension(element.clientWidth,element.clientHeight);if(platform.isIOS&&window.visualViewport)return new Dimension(window.visualViewport.width,window.visualViewport.height);if(window.innerWidth&&window.innerHeight)return new Dimension(window.innerWidth,window.innerHeight);if(document.body&&document.body.clientWidth&&document.body.clientHeight)return new Dimension(document.body.clientWidth,document.body.clientHeight);if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new Dimension(document.documentElement.clientWidth,document.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")};class SizeUtils{static convertToPixels(element,value){return parseFloat(value)||0}static getDimension(element,cssPropertyName,jsPropertyName){let computedStyle=getComputedStyle(element),value="0";return computedStyle&&(value=computedStyle.getPropertyValue?computedStyle.getPropertyValue(cssPropertyName):computedStyle.getAttribute(jsPropertyName)),SizeUtils.convertToPixels(element,value)}static getBorderLeftWidth(element){return SizeUtils.getDimension(element,"border-left-width","borderLeftWidth")}static getBorderRightWidth(element){return SizeUtils.getDimension(element,"border-right-width","borderRightWidth")}static getBorderTopWidth(element){return SizeUtils.getDimension(element,"border-top-width","borderTopWidth")}static getBorderBottomWidth(element){return SizeUtils.getDimension(element,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(element){return SizeUtils.getDimension(element,"padding-left","paddingLeft")}static getPaddingRight(element){return SizeUtils.getDimension(element,"padding-right","paddingRight")}static getPaddingTop(element){return SizeUtils.getDimension(element,"padding-top","paddingTop")}static getPaddingBottom(element){return SizeUtils.getDimension(element,"padding-bottom","paddingBottom")}static getMarginLeft(element){return SizeUtils.getDimension(element,"margin-left","marginLeft")}static getMarginTop(element){return SizeUtils.getDimension(element,"margin-top","marginTop")}static getMarginRight(element){return SizeUtils.getDimension(element,"margin-right","marginRight")}static getMarginBottom(element){return SizeUtils.getDimension(element,"margin-bottom","marginBottom")}}class Dimension{constructor(width,height){this.width=width,this.height=height}with(width=this.width,height=this.height){return width!==this.width||height!==this.height?new Dimension(width,height):this}static is(obj){return"object"==typeof obj&&"number"==typeof obj.height&&"number"==typeof obj.width}static lift(obj){return obj instanceof Dimension?obj:new Dimension(obj.width,obj.height)}static equals(a,b){return a===b||!(!a||!b)&&(a.width===b.width&&a.height===b.height)}}function isAncestor(testChild,testAncestor){for(;testChild;){if(testChild===testAncestor)return!0;testChild=testChild.parentNode}return!1}function findParentWithClass(node,clazz,stopAtClazzOrNode){for(;node&&node.nodeType===node.ELEMENT_NODE;){if(node.classList.contains(clazz))return node;if(stopAtClazzOrNode)if("string"==typeof stopAtClazzOrNode){if(node.classList.contains(stopAtClazzOrNode))return null}else if(node===stopAtClazzOrNode)return null;node=node.parentNode}return null}function isShadowRoot(node){return node&&!!node.host&&!!node.mode}function getShadowRoot(domNode){for(;domNode.parentNode;){if(domNode===document.body)return null;domNode=domNode.parentNode}return isShadowRoot(domNode)?domNode:null}function createStyleSheet(container=document.getElementsByTagName("head")[0]){let style=document.createElement("style");return style.type="text/css",style.media="screen",container.appendChild(style),style}exports.Dimension=Dimension,Dimension.None=new Dimension(0,0),exports.getTopLeftOffset=function getTopLeftOffset(element){let offsetParent=element.offsetParent,top=element.offsetTop,left=element.offsetLeft;for(;null!==(element=element.parentNode)&&element!==document.body&&element!==document.documentElement;){top-=element.scrollTop;const c=isShadowRoot(element)?null:getComputedStyle(element);c&&(left-="rtl"!==c.direction?element.scrollLeft:-element.scrollLeft),element===offsetParent&&(left+=SizeUtils.getBorderLeftWidth(element),top+=SizeUtils.getBorderTopWidth(element),top+=element.offsetTop,left+=element.offsetLeft,offsetParent=element.offsetParent)}return{left,top}},exports.size=function size(element,width,height){"number"==typeof width&&(element.style.width=`${width}px`),"number"==typeof height&&(element.style.height=`${height}px`)},exports.getDomNodePagePosition=function getDomNodePagePosition(domNode){let bb=domNode.getBoundingClientRect();return{left:bb.left+exports.StandardWindow.scrollX,top:bb.top+exports.StandardWindow.scrollY,width:bb.width,height:bb.height}},exports.StandardWindow=new class{get scrollX(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft}get scrollY(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop}},exports.getTotalWidth=function getTotalWidth(element){let margin=SizeUtils.getMarginLeft(element)+SizeUtils.getMarginRight(element);return element.offsetWidth+margin},exports.getContentWidth=function getContentWidth(element){let border=SizeUtils.getBorderLeftWidth(element)+SizeUtils.getBorderRightWidth(element),padding=SizeUtils.getPaddingLeft(element)+SizeUtils.getPaddingRight(element);return element.offsetWidth-border-padding},exports.getContentHeight=function getContentHeight(element){let border=SizeUtils.getBorderTopWidth(element)+SizeUtils.getBorderBottomWidth(element),padding=SizeUtils.getPaddingTop(element)+SizeUtils.getPaddingBottom(element);return element.offsetHeight-border-padding},exports.getTotalHeight=function getTotalHeight(element){let margin=SizeUtils.getMarginTop(element)+SizeUtils.getMarginBottom(element);return element.offsetHeight+margin},exports.isAncestor=isAncestor,exports.findParentWithClass=findParentWithClass,exports.hasParentWithClass=function hasParentWithClass(node,clazz,stopAtClazzOrNode){return!!findParentWithClass(node,clazz,stopAtClazzOrNode)},exports.isShadowRoot=isShadowRoot,exports.isInShadowDOM=function isInShadowDOM(domNode){return!!getShadowRoot(domNode)},exports.getShadowRoot=getShadowRoot,exports.getActiveElement=function getActiveElement(){let result=document.activeElement;for(;null==result?void 0:result.shadowRoot;)result=result.shadowRoot.activeElement;return result},exports.createStyleSheet=createStyleSheet;let _sharedStyleSheet=null;function getSharedStyleSheet(){return _sharedStyleSheet||(_sharedStyleSheet=createStyleSheet()),_sharedStyleSheet}exports.createCSSRule=function createCSSRule(selector,cssText,style=getSharedStyleSheet()){style&&cssText&&style.sheet.insertRule(selector+"{"+cssText+"}",0)},exports.removeCSSRulesContainingSelector=function removeCSSRulesContainingSelector(ruleName,style=getSharedStyleSheet()){if(!style)return;let rules=function getDynamicStyleSheetRules(style){var _a,_b;return(null===(_a=null==style?void 0:style.sheet)||void 0===_a?void 0:_a.rules)?style.sheet.rules:(null===(_b=null==style?void 0:style.sheet)||void 0===_b?void 0:_b.cssRules)?style.sheet.cssRules:[]}(style),toDelete=[];for(let i=0;i<rules.length;i++){-1!==rules[i].selectorText.indexOf(ruleName)&&toDelete.push(i)}for(let i=toDelete.length-1;i>=0;i--)style.sheet.deleteRule(toDelete[i])},exports.isHTMLElement=function isHTMLElement(o){return"object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&1===o.nodeType&&"string"==typeof o.nodeName},exports.EventType={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:browser.isWebKit?"webkitAnimationStart":"animationstart",ANIMATION_END:browser.isWebKit?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:browser.isWebKit?"webkitAnimationIteration":"animationiteration"},exports.EventHelper={stop:function(e,cancelBubble){e.preventDefault?e.preventDefault():e.returnValue=!1,cancelBubble&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}},exports.saveParentsScrollTop=function saveParentsScrollTop(node){let r=[];for(let i=0;node&&node.nodeType===node.ELEMENT_NODE;i++)r[i]=node.scrollTop,node=node.parentNode;return r},exports.restoreParentsScrollTop=function restoreParentsScrollTop(node,state){for(let i=0;node&&node.nodeType===node.ELEMENT_NODE;i++)node.scrollTop!==state[i]&&(node.scrollTop=state[i]),node=node.parentNode};class FocusTracker extends lifecycle_1.Disposable{constructor(element){super(),this._onDidFocus=this._register(new event.Emitter),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new event.Emitter),this.onDidBlur=this._onDidBlur.event;let hasFocus=FocusTracker.hasFocusWithin(element),loosingFocus=!1;const onFocus=()=>{loosingFocus=!1,hasFocus||(hasFocus=!0,this._onDidFocus.fire())},onBlur=()=>{hasFocus&&(loosingFocus=!0,window.setTimeout((()=>{loosingFocus&&(loosingFocus=!1,hasFocus=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{FocusTracker.hasFocusWithin(element)!==hasFocus&&(hasFocus?onBlur():onFocus())},this._register(addDisposableListener(element,exports.EventType.FOCUS,onFocus,!0)),this._register(addDisposableListener(element,exports.EventType.BLUR,onBlur,!0)),this._register(addDisposableListener(element,exports.EventType.FOCUS_IN,(()=>this._refreshStateHandler()))),this._register(addDisposableListener(element,exports.EventType.FOCUS_OUT,(()=>this._refreshStateHandler())))}static hasFocusWithin(element){const shadowRoot=getShadowRoot(element);return isAncestor(shadowRoot?shadowRoot.activeElement:document.activeElement,element)}}function append(parent,...children){if(parent.append(...children),1===children.length&&"string"!=typeof children[0])return children[0]}exports.trackFocus=function trackFocus(element){return new FocusTracker(element)},exports.append=append,exports.prepend=function prepend(parent,child){return parent.insertBefore(child,parent.firstChild),child},exports.reset=function reset(parent,...children){parent.innerText="",append(parent,...children)};const SELECTOR_REGEX=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Namespace;function _$(namespace,description,attrs,...children){let match=SELECTOR_REGEX.exec(description);if(!match)throw new Error("Bad use of emmet");attrs=Object.assign({},attrs||{});let result,tagName=match[1]||"div";return result=namespace!==Namespace.HTML?document.createElementNS(namespace,tagName):document.createElement(tagName),match[3]&&(result.id=match[3]),match[4]&&(result.className=match[4].replace(/\./g," ").trim()),Object.keys(attrs).forEach((name=>{const value=attrs[name];void 0!==value&&(/^on\w+$/.test(name)?result[name]=value:"selected"===name?value&&result.setAttribute(name,"true"):result.setAttribute(name,value))})),result.append(...children),result}function $(description,attrs,...children){return _$(Namespace.HTML,description,attrs,...children)}!function(Namespace){Namespace.HTML="http://www.w3.org/1999/xhtml",Namespace.SVG="http://www.w3.org/2000/svg"}(Namespace=exports.Namespace||(exports.Namespace={})),exports.$=$,$.SVG=function(description,attrs,...children){return _$(Namespace.SVG,description,attrs,...children)},exports.show=function show(...elements){for(let element of elements)element.style.display="",element.removeAttribute("aria-hidden")},exports.hide=function hide(...elements){for(let element of elements)element.style.display="none",element.setAttribute("aria-hidden","true")},exports.getElementsByTagName=function getElementsByTagName(tag){return Array.prototype.slice.call(document.getElementsByTagName(tag),0)},exports.computeScreenAwareSize=function computeScreenAwareSize(cssPx){const screenPx=window.devicePixelRatio*cssPx;return Math.max(1,Math.floor(screenPx))/window.devicePixelRatio},exports.windowOpenNoOpener=function windowOpenNoOpener(url){window.open(url,"_blank","noopener")},exports.animate=function animate(fn){const step=()=>{fn(),stepDisposable=(0,exports.scheduleAtNextAnimationFrame)(step)};let stepDisposable=(0,exports.scheduleAtNextAnimationFrame)(step);return(0,lifecycle_1.toDisposable)((()=>stepDisposable.dispose()))},network_1.RemoteAuthorities.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http"),exports.asCSSUrl=function asCSSUrl(uri){return uri?`url('${network_1.FileAccess.asBrowserUri(uri).toString(!0).replace(/'/g,"%27")}')`:"url('')"},exports.asCSSPropertyValue=function asCSSPropertyValue(value){return`'${value.replace(/'/g,"%27")}'`};class ModifierKeyEmitter extends event.Emitter{constructor(){super(),this._subscriptions=new lifecycle_1.DisposableStore,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(addDisposableListener(window,"keydown",(e=>{if(e.defaultPrevented)return;const event=new keyboardEvent_1.StandardKeyboardEvent(e);if(6!==event.keyCode||!e.repeat){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else{if(6===event.keyCode)return;this._keyStatus.lastKeyPressed=void 0}this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}}),!0)),this._subscriptions.add(addDisposableListener(window,"keyup",(e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mousedown",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mouseup",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mousemove",(e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)}),!0)),this._subscriptions.add(addDisposableListener(window,"blur",(()=>{this.resetKeyStatus()})))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return ModifierKeyEmitter.instance||(ModifierKeyEmitter.instance=new ModifierKeyEmitter),ModifierKeyEmitter.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}exports.ModifierKeyEmitter=ModifierKeyEmitter,exports.addMatchMediaChangeListener=function addMatchMediaChangeListener(query,callback){window.matchMedia(query).addEventListener("change",callback)}})),define(__m[171],__M([1,0,7]),(function(require,exports,DOM){"use strict";function createElement(options){const tagName=options.inline?"span":"div",element=document.createElement(tagName);return options.className&&(element.className=options.className),element}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createElement=exports.renderFormattedText=exports.renderText=void 0,exports.renderText=function renderText(text,options={}){const element=createElement(options);return element.textContent=text,element},exports.renderFormattedText=function renderFormattedText(formattedText,options={}){const element=createElement(options);return _renderFormattedText(element,function parseFormattedText(content,parseCodeSegments){const root={type:1,children:[]};let actionViewItemIndex=0,current=root;const stack=[],stream=new StringStream(content);for(;!stream.eos();){let next=stream.next();const isEscapedFormatType="\\"===next&&0!==formatTagType(stream.peek(),parseCodeSegments);if(isEscapedFormatType&&(next=stream.next()),!isEscapedFormatType&&isFormatTag(next,parseCodeSegments)&&next===stream.peek()){stream.advance(),2===current.type&&(current=stack.pop());const type=formatTagType(next,parseCodeSegments);if(current.type===type||5===current.type&&6===type)current=stack.pop();else{const newCurrent={type,children:[]};5===type&&(newCurrent.index=actionViewItemIndex,actionViewItemIndex++),current.children.push(newCurrent),stack.push(current),current=newCurrent}}else if("\n"===next)2===current.type&&(current=stack.pop()),current.children.push({type:8});else if(2!==current.type){const textCurrent={type:2,content:next};current.children.push(textCurrent),stack.push(current),current=textCurrent}else current.content+=next}2===current.type&&(current=stack.pop());stack.length;return root}(formattedText,!!options.renderCodeSegments),options.actionHandler,options.renderCodeSegments),element},exports.createElement=createElement;class StringStream{constructor(source){this.source=source,this.index=0}eos(){return this.index>=this.source.length}next(){const next=this.peek();return this.advance(),next}peek(){return this.source[this.index]}advance(){this.index++}}function _renderFormattedText(element,treeNode,actionHandler,renderCodeSegments){let child;if(2===treeNode.type)child=document.createTextNode(treeNode.content||"");else if(3===treeNode.type)child=document.createElement("b");else if(4===treeNode.type)child=document.createElement("i");else if(7===treeNode.type&&renderCodeSegments)child=document.createElement("code");else if(5===treeNode.type&&actionHandler){const a=document.createElement("a");actionHandler.disposables.add(DOM.addStandardDisposableListener(a,"click",(event=>{actionHandler.callback(String(treeNode.index),event)}))),child=a}else 8===treeNode.type?child=document.createElement("br"):1===treeNode.type&&(child=element);child&&element!==child&&element.appendChild(child),child&&Array.isArray(treeNode.children)&&treeNode.children.forEach((nodeChild=>{_renderFormattedText(child,nodeChild,actionHandler,renderCodeSegments)}))}function isFormatTag(char,supportCodeSegments){return 0!==formatTagType(char,supportCodeSegments)}function formatTagType(char,supportCodeSegments){switch(char){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return supportCodeSegments?7:0;default:return 0}}})),define(__m[98],__M([1,0,7,214,59,2,16]),(function(require,exports,dom,iframe_1,mouseEvent_1,lifecycle_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalMouseMoveMonitor=exports.standardMouseMoveMerger=void 0,exports.standardMouseMoveMerger=function standardMouseMoveMerger(lastEvent,currentEvent){let ev=new mouseEvent_1.StandardMouseEvent(currentEvent);return ev.preventDefault(),{leftButton:ev.leftButton,buttons:ev.buttons,posx:ev.posx,posy:ev.posy}};exports.GlobalMouseMoveMonitor=class GlobalMouseMoveMonitor{constructor(){this._hooks=new lifecycle_1.DisposableStore,this._mouseMoveEventMerger=null,this._mouseMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(invokeStopCallback,browserEvent){if(!this.isMonitoring())return;this._hooks.clear(),this._mouseMoveEventMerger=null,this._mouseMoveCallback=null;const onStopCallback=this._onStopCallback;this._onStopCallback=null,invokeStopCallback&&onStopCallback&&onStopCallback(browserEvent)}isMonitoring(){return!!this._mouseMoveEventMerger}startMonitoring(initialElement,initialButtons,mouseMoveEventMerger,mouseMoveCallback,onStopCallback){if(this.isMonitoring())return;this._mouseMoveEventMerger=mouseMoveEventMerger,this._mouseMoveCallback=mouseMoveCallback,this._onStopCallback=onStopCallback;const windowChain=iframe_1.IframeUtils.getSameOriginWindowChain(),mouseMove=platform_1.isIOS?"pointermove":"mousemove",listenTo=windowChain.map((element=>element.window.document)),shadowRoot=dom.getShadowRoot(initialElement);shadowRoot&&listenTo.unshift(shadowRoot);for(const element of listenTo)this._hooks.add(dom.addDisposableThrottledListener(element,mouseMove,(data=>{data.buttons===initialButtons?this._mouseMoveCallback(data):this.stopMonitoring(!0)}),((lastEvent,currentEvent)=>this._mouseMoveEventMerger(lastEvent,currentEvent)))),this._hooks.add(dom.addDisposableListener(element,"mouseup",(e=>this.stopMonitoring(!0))));if(iframe_1.IframeUtils.hasDifferentOriginAncestor()){let lastSameOriginAncestor=windowChain[windowChain.length-1];this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document,"mouseout",(browserEvent=>{"html"===new mouseEvent_1.StandardMouseEvent(browserEvent).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document,"mouseover",(browserEvent=>{"html"===new mouseEvent_1.StandardMouseEvent(browserEvent).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(dom.addDisposableListener(lastSameOriginAncestor.window.document.body,"mouseleave",(browserEvent=>{this.stopMonitoring(!0)})))}}}}));var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};define(__m[60],__M([1,0,7,18,95,2]),(function(require,exports,DomUtils,arrays,decorators_1,lifecycle_1){"use strict";var EventType;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Gesture=exports.EventType=void 0,function(EventType){EventType.Tap="-monaco-gesturetap",EventType.Change="-monaco-gesturechange",EventType.Start="-monaco-gesturestart",EventType.End="-monaco-gesturesend",EventType.Contextmenu="-monaco-gesturecontextmenu"}(EventType=exports.EventType||(exports.EventType={}));class Gesture extends lifecycle_1.Disposable{constructor(){super(),this.dispatched=!1,this.activeTouches={},this.handle=null,this.targets=[],this.ignoreTargets=[],this._lastSetTapCountTime=0,this._register(DomUtils.addDisposableListener(document,"touchstart",(e=>this.onTouchStart(e)),{passive:!1})),this._register(DomUtils.addDisposableListener(document,"touchend",(e=>this.onTouchEnd(e)))),this._register(DomUtils.addDisposableListener(document,"touchmove",(e=>this.onTouchMove(e)),{passive:!1}))}static addTarget(element){return Gesture.isTouchDevice()?(Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture),Gesture.INSTANCE.targets.push(element),{dispose:()=>{Gesture.INSTANCE.targets=Gesture.INSTANCE.targets.filter((t=>t!==element))}}):lifecycle_1.Disposable.None}static ignoreTarget(element){return Gesture.isTouchDevice()?(Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture),Gesture.INSTANCE.ignoreTargets.push(element),{dispose:()=>{Gesture.INSTANCE.ignoreTargets=Gesture.INSTANCE.ignoreTargets.filter((t=>t!==element))}}):lifecycle_1.Disposable.None}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let timestamp=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,len=e.targetTouches.length;i<len;i++){let touch=e.targetTouches.item(i);this.activeTouches[touch.identifier]={id:touch.identifier,initialTarget:touch.target,initialTimeStamp:timestamp,initialPageX:touch.pageX,initialPageY:touch.pageY,rollingTimestamps:[timestamp],rollingPageX:[touch.pageX],rollingPageY:[touch.pageY]};let evt=this.newGestureEvent(EventType.Start,touch.target);evt.pageX=touch.pageX,evt.pageY=touch.pageY,this.dispatchEvent(evt)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){let timestamp=Date.now(),activeTouchCount=Object.keys(this.activeTouches).length;for(let i=0,len=e.changedTouches.length;i<len;i++){let touch=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(touch.identifier))){console.warn("move of an UNKNOWN touch",touch);continue}let data=this.activeTouches[touch.identifier],holdTime=Date.now()-data.initialTimeStamp;if(holdTime<Gesture.HOLD_DELAY&&Math.abs(data.initialPageX-arrays.tail(data.rollingPageX))<30&&Math.abs(data.initialPageY-arrays.tail(data.rollingPageY))<30){let evt=this.newGestureEvent(EventType.Tap,data.initialTarget);evt.pageX=arrays.tail(data.rollingPageX),evt.pageY=arrays.tail(data.rollingPageY),this.dispatchEvent(evt)}else if(holdTime>=Gesture.HOLD_DELAY&&Math.abs(data.initialPageX-arrays.tail(data.rollingPageX))<30&&Math.abs(data.initialPageY-arrays.tail(data.rollingPageY))<30){let evt=this.newGestureEvent(EventType.Contextmenu,data.initialTarget);evt.pageX=arrays.tail(data.rollingPageX),evt.pageY=arrays.tail(data.rollingPageY),this.dispatchEvent(evt)}else if(1===activeTouchCount){let finalX=arrays.tail(data.rollingPageX),finalY=arrays.tail(data.rollingPageY),deltaT=arrays.tail(data.rollingTimestamps)-data.rollingTimestamps[0],deltaX=finalX-data.rollingPageX[0],deltaY=finalY-data.rollingPageY[0];const dispatchTo=this.targets.filter((t=>data.initialTarget instanceof Node&&t.contains(data.initialTarget)));this.inertia(dispatchTo,timestamp,Math.abs(deltaX)/deltaT,deltaX>0?1:-1,finalX,Math.abs(deltaY)/deltaT,deltaY>0?1:-1,finalY)}this.dispatchEvent(this.newGestureEvent(EventType.End,data.initialTarget)),delete this.activeTouches[touch.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(type,initialTarget){let event=document.createEvent("CustomEvent");return event.initEvent(type,!1,!0),event.initialTarget=initialTarget,event.tapCount=0,event}dispatchEvent(event){if(event.type===EventType.Tap){const currentTime=(new Date).getTime();let setTapCount=0;setTapCount=currentTime-this._lastSetTapCountTime>Gesture.CLEAR_TAP_COUNT_TIME?1:2,this._lastSetTapCountTime=currentTime,event.tapCount=setTapCount}else event.type!==EventType.Change&&event.type!==EventType.Contextmenu||(this._lastSetTapCountTime=0);for(let i=0;i<this.ignoreTargets.length;i++)if(event.initialTarget instanceof Node&&this.ignoreTargets[i].contains(event.initialTarget))return;this.targets.forEach((target=>{event.initialTarget instanceof Node&&target.contains(event.initialTarget)&&(target.dispatchEvent(event),this.dispatched=!0)}))}inertia(dispatchTo,t1,vX,dirX,x,vY,dirY,y){this.handle=DomUtils.scheduleAtNextAnimationFrame((()=>{let now=Date.now(),deltaT=now-t1,delta_pos_x=0,delta_pos_y=0,stopped=!0;vX+=Gesture.SCROLL_FRICTION*deltaT,vY+=Gesture.SCROLL_FRICTION*deltaT,vX>0&&(stopped=!1,delta_pos_x=dirX*vX*deltaT),vY>0&&(stopped=!1,delta_pos_y=dirY*vY*deltaT);let evt=this.newGestureEvent(EventType.Change);evt.translationX=delta_pos_x,evt.translationY=delta_pos_y,dispatchTo.forEach((d=>d.dispatchEvent(evt))),stopped||this.inertia(dispatchTo,now,vX,dirX,x+delta_pos_x,vY,dirY,y+delta_pos_y)}))}onTouchMove(e){let timestamp=Date.now();for(let i=0,len=e.changedTouches.length;i<len;i++){let touch=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(touch.identifier))){console.warn("end of an UNKNOWN touch",touch);continue}let data=this.activeTouches[touch.identifier],evt=this.newGestureEvent(EventType.Change,data.initialTarget);evt.translationX=touch.pageX-arrays.tail(data.rollingPageX),evt.translationY=touch.pageY-arrays.tail(data.rollingPageY),evt.pageX=touch.pageX,evt.pageY=touch.pageY,this.dispatchEvent(evt),data.rollingPageX.length>3&&(data.rollingPageX.shift(),data.rollingPageY.shift(),data.rollingTimestamps.shift()),data.rollingPageX.push(touch.pageX),data.rollingPageY.push(touch.pageY),data.rollingTimestamps.push(timestamp)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}Gesture.SCROLL_FRICTION=-.005,Gesture.HOLD_DELAY=700,Gesture.CLEAR_TAP_COUNT_TIME=400,__decorate([decorators_1.memoize],Gesture,"isTouchDevice",null),exports.Gesture=Gesture})),define(__m[115],__M([1,0,7,28]),(function(require,exports,dom,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderIcon=exports.renderLabelWithIcons=void 0;const labelWithIconsRegex=new RegExp(`(\\\\)?\\$\\((${codicons_1.CSSIcon.iconNameExpression}(?:${codicons_1.CSSIcon.iconModifierExpression})?)\\)`,"g");function renderIcon(icon){const node=dom.$("span");return node.classList.add(...codicons_1.CSSIcon.asClassNameArray(icon)),node}exports.renderLabelWithIcons=function renderLabelWithIcons(text){const elements=new Array;let match,textStart=0,textStop=0;for(;null!==(match=labelWithIconsRegex.exec(text));){textStop=match.index||0,elements.push(text.substring(textStart,textStop)),textStart=(match.index||0)+match[0].length;const[,escaped,codicon]=match;elements.push(escaped?`$(${codicon})`:renderIcon({id:codicon}))}return textStart<text.length&&elements.push(text.substring(textStart)),elements},exports.renderIcon=renderIcon})),define(__m[220],__M([1,0,7,115,40]),(function(require,exports,dom,iconLabels_1,objects){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HighlightedLabel=void 0;class HighlightedLabel{constructor(container,options){var _a;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=null!==(_a=null==options?void 0:options.supportIcons)&&void 0!==_a&&_a,this.domNode=dom.append(container,dom.$("span.monaco-highlighted-label"))}get element(){return this.domNode}set(text,highlights=[],title="",escapeNewLines){text||(text=""),escapeNewLines&&(text=HighlightedLabel.escapeNewLines(text,highlights)),this.didEverRender&&this.text===text&&this.title===title&&objects.equals(this.highlights,highlights)||(this.text=text,this.title=title,this.highlights=highlights,this.render())}render(){const children=[];let pos=0;for(const highlight of this.highlights){if(highlight.end===highlight.start)continue;if(pos<highlight.start){const substring=this.text.substring(pos,highlight.start);children.push(dom.$("span",void 0,...this.supportIcons?(0,iconLabels_1.renderLabelWithIcons)(substring):[substring])),pos=highlight.end}const substring=this.text.substring(highlight.start,highlight.end),element=dom.$("span.highlight",void 0,...this.supportIcons?(0,iconLabels_1.renderLabelWithIcons)(substring):[substring]);highlight.extraClasses&&element.classList.add(...highlight.extraClasses),children.push(element),pos=highlight.end}if(pos<this.text.length){const substring=this.text.substring(pos);children.push(dom.$("span",void 0,...this.supportIcons?(0,iconLabels_1.renderLabelWithIcons)(substring):[substring]))}dom.reset(this.domNode,...children),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(text,highlights){let total=0,extra=0;return text.replace(/\r\n|\r|\n/g,((match,offset)=>{extra="\r\n"===match?-1:0,offset+=total;for(const highlight of highlights)highlight.end<=offset||(highlight.start>=offset&&(highlight.start+=extra),highlight.end>=offset&&(highlight.end+=extra));return total+=extra,"⏎"}))}}exports.HighlightedLabel=HighlightedLabel})),define(__m[324],__M([1,0,7]),(function(require,exports,dom_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RowCache=void 0;exports.RowCache=class RowCache{constructor(renderers){this.renderers=renderers,this.cache=new Map}alloc(templateId){let result=this.getTemplateCache(templateId).pop();if(!result){const domNode=(0,dom_1.$)(".monaco-list-row");result={domNode,templateId,templateData:this.getRenderer(templateId).renderTemplate(domNode)}}return result}release(row){row&&this.releaseRow(row)}releaseRow(row){const{domNode,templateId}=row;domNode&&(domNode.classList.remove("scrolling"),function removeFromParent(element){try{element.parentElement&&element.parentElement.removeChild(element)}catch(e){}}(domNode));this.getTemplateCache(templateId).push(row)}getTemplateCache(templateId){let result=this.cache.get(templateId);return result||(result=[],this.cache.set(templateId,result)),result}dispose(){this.cache.forEach(((cachedRows,templateId)=>{for(const cachedRow of cachedRows){this.getRenderer(templateId).disposeTemplate(cachedRow.templateData),cachedRow.templateData=null}})),this.cache.clear()}getRenderer(templateId){const renderer=this.renderers.get(templateId);if(!renderer)throw new Error(`No renderer found for ${templateId}`);return renderer}}})),define(__m[62],__M([1,0,7,44,59,60,2]),(function(require,exports,dom,keyboardEvent_1,mouseEvent_1,touch_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Widget=void 0;class Widget extends lifecycle_1.Disposable{onclick(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.CLICK,(e=>listener(new mouseEvent_1.StandardMouseEvent(e)))))}onmousedown(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.MOUSE_DOWN,(e=>listener(new mouseEvent_1.StandardMouseEvent(e)))))}onmouseover(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.MOUSE_OVER,(e=>listener(new mouseEvent_1.StandardMouseEvent(e)))))}onnonbubblingmouseout(domNode,listener){this._register(dom.addDisposableNonBubblingMouseOutListener(domNode,(e=>listener(new mouseEvent_1.StandardMouseEvent(e)))))}onkeydown(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.KEY_DOWN,(e=>listener(new keyboardEvent_1.StandardKeyboardEvent(e)))))}onkeyup(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.KEY_UP,(e=>listener(new keyboardEvent_1.StandardKeyboardEvent(e)))))}oninput(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.INPUT,listener))}onblur(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.BLUR,listener))}onfocus(domNode,listener){this._register(dom.addDisposableListener(domNode,dom.EventType.FOCUS,listener))}ignoreGesture(domNode){touch_1.Gesture.ignoreTarget(domNode)}}exports.Widget=Widget})),define(__m[172],__M([1,0,98,62,10]),(function(require,exports,globalMouseMoveMonitor_1,widget_1,async_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScrollbarArrow=exports.ARROW_IMG_SIZE=void 0,exports.ARROW_IMG_SIZE=11;class ScrollbarArrow extends widget_1.Widget{constructor(opts){super(),this._onActivate=opts.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=opts.bgWidth+"px",this.bgDomNode.style.height=opts.bgHeight+"px",void 0!==opts.top&&(this.bgDomNode.style.top="0px"),void 0!==opts.left&&(this.bgDomNode.style.left="0px"),void 0!==opts.bottom&&(this.bgDomNode.style.bottom="0px"),void 0!==opts.right&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=opts.className,this.domNode.classList.add(...opts.icon.classNamesArray),this.domNode.style.position="absolute",this.domNode.style.width=exports.ARROW_IMG_SIZE+"px",this.domNode.style.height=exports.ARROW_IMG_SIZE+"px",void 0!==opts.top&&(this.domNode.style.top=opts.top+"px"),void 0!==opts.left&&(this.domNode.style.left=opts.left+"px"),void 0!==opts.bottom&&(this.domNode.style.bottom=opts.bottom+"px"),void 0!==opts.right&&(this.domNode.style.right=opts.right+"px"),this._mouseMoveMonitor=this._register(new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor),this.onmousedown(this.bgDomNode,(e=>this._arrowMouseDown(e))),this.onmousedown(this.domNode,(e=>this._arrowMouseDown(e))),this._mousedownRepeatTimer=this._register(new async_1.IntervalTimer),this._mousedownScheduleRepeatTimer=this._register(new async_1.TimeoutTimer)}_arrowMouseDown(e){this._onActivate(),this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancelAndSet((()=>{this._mousedownRepeatTimer.cancelAndSet((()=>this._onActivate()),1e3/24)}),200),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(mouseMoveData=>{}),(()=>{this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancel()})),e.preventDefault()}}exports.ScrollbarArrow=ScrollbarArrow})),define(__m[221],__M([1,0,7,31,98,172,319,62,16]),(function(require,exports,dom,fastDomNode_1,globalMouseMoveMonitor_1,scrollbarArrow_1,scrollbarVisibilityController_1,widget_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractScrollbar=void 0;class AbstractScrollbar extends widget_1.Widget{constructor(opts){super(),this._lazyRender=opts.lazyRender,this._host=opts.host,this._scrollable=opts.scrollable,this._scrollByPage=opts.scrollByPage,this._scrollbarState=opts.scrollbarState,this._visibilityController=this._register(new scrollbarVisibilityController_1.ScrollbarVisibilityController(opts.visibility,"visible scrollbar "+opts.extraScrollbarClassName,"invisible scrollbar "+opts.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._mouseMoveMonitor=this._register(new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor),this._shouldRender=!0,this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,(e=>this._domNodeMouseDown(e)))}_createArrow(opts){const arrow=this._register(new scrollbarArrow_1.ScrollbarArrow(opts));this.domNode.domNode.appendChild(arrow.bgDomNode),this.domNode.domNode.appendChild(arrow.domNode)}_createSlider(top,left,width,height){this.slider=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(top),this.slider.setLeft(left),"number"==typeof width&&this.slider.setWidth(width),"number"==typeof height&&this.slider.setHeight(height),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,(e=>{e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))})),this.onclick(this.slider.domNode,(e=>{e.leftButton&&e.stopPropagation()}))}_onElementSize(visibleSize){return this._scrollbarState.setVisibleSize(visibleSize)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(elementScrollSize){return this._scrollbarState.setScrollSize(elementScrollSize)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(elementScrollPosition){return this._scrollbarState.setScrollPosition(elementScrollPosition)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodeMouseDown(e){e.target===this.domNode.domNode&&this._onMouseDown(e)}delegateMouseDown(e){const domTop=this.domNode.domNode.getClientRects()[0].top,sliderStart=domTop+this._scrollbarState.getSliderPosition(),sliderStop=domTop+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),mousePos=this._sliderMousePosition(e);sliderStart<=mousePos&&mousePos<=sliderStop?e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{}))):this._onMouseDown(e)}_onMouseDown(e){let offsetX,offsetY;if(e.target===this.domNode.domNode&&"number"==typeof e.browserEvent.offsetX&&"number"==typeof e.browserEvent.offsetY)offsetX=e.browserEvent.offsetX,offsetY=e.browserEvent.offsetY;else{const domNodePosition=dom.getDomNodePagePosition(this.domNode.domNode);offsetX=e.posx-domNodePosition.left,offsetY=e.posy-domNodePosition.top}const offset=this._mouseDownRelativePosition(offsetX,offsetY);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(offset):this._scrollbarState.getDesiredScrollPositionFromOffset(offset)),e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))}_sliderMouseDown(e,onDragFinished){const initialMousePosition=this._sliderMousePosition(e),initialMouseOrthogonalPosition=this._sliderOrthogonalMousePosition(e),initialScrollbarState=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(mouseMoveData=>{const mouseOrthogonalPosition=this._sliderOrthogonalMousePosition(mouseMoveData),mouseOrthogonalDelta=Math.abs(mouseOrthogonalPosition-initialMouseOrthogonalPosition);if(platform.isWindows&&mouseOrthogonalDelta>140)return void this._setDesiredScrollPositionNow(initialScrollbarState.getScrollPosition());const mouseDelta=this._sliderMousePosition(mouseMoveData)-initialMousePosition;this._setDesiredScrollPositionNow(initialScrollbarState.getDesiredScrollPositionFromDelta(mouseDelta))}),(()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd(),onDragFinished()})),this._host.onDragStart()}_setDesiredScrollPositionNow(_desiredScrollPosition){const desiredScrollPosition={};this.writeScrollPosition(desiredScrollPosition,_desiredScrollPosition),this._scrollable.setScrollPositionNow(desiredScrollPosition)}updateScrollbarSize(scrollbarSize){this._updateScrollbarSize(scrollbarSize),this._scrollbarState.setScrollbarSize(scrollbarSize),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}exports.AbstractScrollbar=AbstractScrollbar})),define(__m[325],__M([1,0,59,221,172,215,28]),(function(require,exports,mouseEvent_1,abstractScrollbar_1,scrollbarArrow_1,scrollbarState_1,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HorizontalScrollbar=void 0;class HorizontalScrollbar extends abstractScrollbar_1.AbstractScrollbar{constructor(scrollable,options,host){const scrollDimensions=scrollable.getScrollDimensions(),scrollPosition=scrollable.getCurrentScrollPosition();if(super({lazyRender:options.lazyRender,host,scrollbarState:new scrollbarState_1.ScrollbarState(options.horizontalHasArrows?options.arrowSize:0,2===options.horizontal?0:options.horizontalScrollbarSize,2===options.vertical?0:options.verticalScrollbarSize,scrollDimensions.width,scrollDimensions.scrollWidth,scrollPosition.scrollLeft),visibility:options.horizontal,extraScrollbarClassName:"horizontal",scrollable,scrollByPage:options.scrollByPage}),options.horizontalHasArrows){const arrowDelta=(options.arrowSize-scrollbarArrow_1.ARROW_IMG_SIZE)/2,scrollbarDelta=(options.horizontalScrollbarSize-scrollbarArrow_1.ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:codicons_1.Codicon.scrollbarButtonLeft,top:scrollbarDelta,left:arrowDelta,bottom:void 0,right:void 0,bgWidth:options.arrowSize,bgHeight:options.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new mouseEvent_1.StandardWheelEvent(null,1,0))}),this._createArrow({className:"scra",icon:codicons_1.Codicon.scrollbarButtonRight,top:scrollbarDelta,left:void 0,bottom:void 0,right:arrowDelta,bgWidth:options.arrowSize,bgHeight:options.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new mouseEvent_1.StandardWheelEvent(null,-1,0))})}this._createSlider(Math.floor((options.horizontalScrollbarSize-options.horizontalSliderSize)/2),0,void 0,options.horizontalSliderSize)}_updateSlider(sliderSize,sliderPosition){this.slider.setWidth(sliderSize),this.slider.setLeft(sliderPosition)}_renderDomNode(largeSize,smallSize){this.domNode.setWidth(largeSize),this.domNode.setHeight(smallSize),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(offsetX,offsetY){return offsetX}_sliderMousePosition(e){return e.posx}_sliderOrthogonalMousePosition(e){return e.posy}_updateScrollbarSize(size){this.slider.setHeight(size)}writeScrollPosition(target,scrollPosition){target.scrollLeft=scrollPosition}updateOptions(options){this.updateScrollbarSize(2===options.horizontal?0:options.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(2===options.vertical?0:options.verticalScrollbarSize),this._visibilityController.setVisibility(options.horizontal),this._scrollByPage=options.scrollByPage}}exports.HorizontalScrollbar=HorizontalScrollbar})),define(__m[326],__M([1,0,59,221,172,215,28]),(function(require,exports,mouseEvent_1,abstractScrollbar_1,scrollbarArrow_1,scrollbarState_1,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VerticalScrollbar=void 0;class VerticalScrollbar extends abstractScrollbar_1.AbstractScrollbar{constructor(scrollable,options,host){const scrollDimensions=scrollable.getScrollDimensions(),scrollPosition=scrollable.getCurrentScrollPosition();if(super({lazyRender:options.lazyRender,host,scrollbarState:new scrollbarState_1.ScrollbarState(options.verticalHasArrows?options.arrowSize:0,2===options.vertical?0:options.verticalScrollbarSize,0,scrollDimensions.height,scrollDimensions.scrollHeight,scrollPosition.scrollTop),visibility:options.vertical,extraScrollbarClassName:"vertical",scrollable,scrollByPage:options.scrollByPage}),options.verticalHasArrows){const arrowDelta=(options.arrowSize-scrollbarArrow_1.ARROW_IMG_SIZE)/2,scrollbarDelta=(options.verticalScrollbarSize-scrollbarArrow_1.ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:codicons_1.Codicon.scrollbarButtonUp,top:arrowDelta,left:scrollbarDelta,bottom:void 0,right:void 0,bgWidth:options.verticalScrollbarSize,bgHeight:options.arrowSize,onActivate:()=>this._host.onMouseWheel(new mouseEvent_1.StandardWheelEvent(null,0,1))}),this._createArrow({className:"scra",icon:codicons_1.Codicon.scrollbarButtonDown,top:void 0,left:scrollbarDelta,bottom:arrowDelta,right:void 0,bgWidth:options.verticalScrollbarSize,bgHeight:options.arrowSize,onActivate:()=>this._host.onMouseWheel(new mouseEvent_1.StandardWheelEvent(null,0,-1))})}this._createSlider(0,Math.floor((options.verticalScrollbarSize-options.verticalSliderSize)/2),options.verticalSliderSize,void 0)}_updateSlider(sliderSize,sliderPosition){this.slider.setHeight(sliderSize),this.slider.setTop(sliderPosition)}_renderDomNode(largeSize,smallSize){this.domNode.setWidth(smallSize),this.domNode.setHeight(largeSize),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(offsetX,offsetY){return offsetY}_sliderMousePosition(e){return e.posy}_sliderOrthogonalMousePosition(e){return e.posx}_updateScrollbarSize(size){this.slider.setWidth(size)}writeScrollPosition(target,scrollPosition){target.scrollTop=scrollPosition}updateOptions(options){this.updateScrollbarSize(2===options.vertical?0:options.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(options.vertical),this._scrollByPage=options.scrollByPage}}exports.VerticalScrollbar=VerticalScrollbar})),define(__m[42],__M([1,0,168,45,84,16,8,25]),(function(require,exports,extpath,network_1,paths,platform_1,strings_1,uri_1){"use strict";function originalFSPath(uri){return(0,uri_1.uriToFsPath)(uri,!0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataUri=exports.addTrailingPathSeparator=exports.removeTrailingPathSeparator=exports.hasTrailingPathSeparator=exports.isEqualAuthority=exports.isAbsolutePath=exports.resolvePath=exports.relativePath=exports.normalizePath=exports.joinPath=exports.dirname=exports.extname=exports.basename=exports.basenameOrAuthority=exports.getComparisonKey=exports.isEqualOrParent=exports.isEqual=exports.extUriIgnorePathCase=exports.extUriBiasedIgnorePathCase=exports.extUri=exports.ExtUri=exports.originalFSPath=void 0,exports.originalFSPath=originalFSPath;class ExtUri{constructor(_ignorePathCasing){this._ignorePathCasing=_ignorePathCasing}compare(uri1,uri2,ignoreFragment=!1){return uri1===uri2?0:(0,strings_1.compare)(this.getComparisonKey(uri1,ignoreFragment),this.getComparisonKey(uri2,ignoreFragment))}isEqual(uri1,uri2,ignoreFragment=!1){return uri1===uri2||!(!uri1||!uri2)&&this.getComparisonKey(uri1,ignoreFragment)===this.getComparisonKey(uri2,ignoreFragment)}getComparisonKey(uri,ignoreFragment=!1){return uri.with({path:this._ignorePathCasing(uri)?uri.path.toLowerCase():void 0,fragment:ignoreFragment?null:void 0}).toString()}isEqualOrParent(base,parentCandidate,ignoreFragment=!1){if(base.scheme===parentCandidate.scheme){if(base.scheme===network_1.Schemas.file)return extpath.isEqualOrParent(originalFSPath(base),originalFSPath(parentCandidate),this._ignorePathCasing(base))&&base.query===parentCandidate.query&&(ignoreFragment||base.fragment===parentCandidate.fragment);if((0,exports.isEqualAuthority)(base.authority,parentCandidate.authority))return extpath.isEqualOrParent(base.path,parentCandidate.path,this._ignorePathCasing(base),"/")&&base.query===parentCandidate.query&&(ignoreFragment||base.fragment===parentCandidate.fragment)}return!1}joinPath(resource,...pathFragment){return uri_1.URI.joinPath(resource,...pathFragment)}basenameOrAuthority(resource){return(0,exports.basename)(resource)||resource.authority}basename(resource){return paths.posix.basename(resource.path)}extname(resource){return paths.posix.extname(resource.path)}dirname(resource){if(0===resource.path.length)return resource;let dirname;return resource.scheme===network_1.Schemas.file?dirname=uri_1.URI.file(paths.dirname(originalFSPath(resource))).path:(dirname=paths.posix.dirname(resource.path),resource.authority&&dirname.length&&47!==dirname.charCodeAt(0)&&(console.error(`dirname("${resource.toString})) resulted in a relative path`),dirname="/")),resource.with({path:dirname})}normalizePath(resource){if(!resource.path.length)return resource;let normalizedPath;return normalizedPath=resource.scheme===network_1.Schemas.file?uri_1.URI.file(paths.normalize(originalFSPath(resource))).path:paths.posix.normalize(resource.path),resource.with({path:normalizedPath})}relativePath(from,to){if(from.scheme!==to.scheme||!(0,exports.isEqualAuthority)(from.authority,to.authority))return;if(from.scheme===network_1.Schemas.file){const relativePath=paths.relative(originalFSPath(from),originalFSPath(to));return platform_1.isWindows?extpath.toSlashes(relativePath):relativePath}let fromPath=from.path||"/",toPath=to.path||"/";if(this._ignorePathCasing(from)){let i=0;for(const len=Math.min(fromPath.length,toPath.length);i<len&&(fromPath.charCodeAt(i)===toPath.charCodeAt(i)||fromPath.charAt(i).toLowerCase()===toPath.charAt(i).toLowerCase());i++);fromPath=toPath.substr(0,i)+fromPath.substr(i)}return paths.posix.relative(fromPath,toPath)}resolvePath(base,path){if(base.scheme===network_1.Schemas.file){const newURI=uri_1.URI.file(paths.resolve(originalFSPath(base),path));return base.with({authority:newURI.authority,path:newURI.path})}return path=extpath.toPosixPath(path),base.with({path:paths.posix.resolve(base.path,path)})}isAbsolutePath(resource){return!!resource.path&&"/"===resource.path[0]}isEqualAuthority(a1,a2){return a1===a2||void 0!==a1&&void 0!==a2&&(0,strings_1.equalsIgnoreCase)(a1,a2)}hasTrailingPathSeparator(resource,sep=paths.sep){if(resource.scheme===network_1.Schemas.file){const fsp=originalFSPath(resource);return fsp.length>extpath.getRoot(fsp).length&&fsp[fsp.length-1]===sep}{const p=resource.path;return p.length>1&&47===p.charCodeAt(p.length-1)&&!/^[a-zA-Z]:(\/$|\\$)/.test(resource.fsPath)}}removeTrailingPathSeparator(resource,sep=paths.sep){return(0,exports.hasTrailingPathSeparator)(resource,sep)?resource.with({path:resource.path.substr(0,resource.path.length-1)}):resource}addTrailingPathSeparator(resource,sep=paths.sep){let isRootSep=!1;if(resource.scheme===network_1.Schemas.file){const fsp=originalFSPath(resource);isRootSep=void 0!==fsp&&fsp.length===extpath.getRoot(fsp).length&&fsp[fsp.length-1]===sep}else{sep="/";const p=resource.path;isRootSep=1===p.length&&47===p.charCodeAt(p.length-1)}return isRootSep||(0,exports.hasTrailingPathSeparator)(resource,sep)?resource:resource.with({path:resource.path+"/"})}}exports.ExtUri=ExtUri,exports.extUri=new ExtUri((()=>!1)),exports.extUriBiasedIgnorePathCase=new ExtUri((uri=>uri.scheme!==network_1.Schemas.file||!platform_1.isLinux)),exports.extUriIgnorePathCase=new ExtUri((_=>!0)),exports.isEqual=exports.extUri.isEqual.bind(exports.extUri),exports.isEqualOrParent=exports.extUri.isEqualOrParent.bind(exports.extUri),exports.getComparisonKey=exports.extUri.getComparisonKey.bind(exports.extUri),exports.basenameOrAuthority=exports.extUri.basenameOrAuthority.bind(exports.extUri),exports.basename=exports.extUri.basename.bind(exports.extUri),exports.extname=exports.extUri.extname.bind(exports.extUri),exports.dirname=exports.extUri.dirname.bind(exports.extUri),exports.joinPath=exports.extUri.joinPath.bind(exports.extUri),exports.normalizePath=exports.extUri.normalizePath.bind(exports.extUri),exports.relativePath=exports.extUri.relativePath.bind(exports.extUri),exports.resolvePath=exports.extUri.resolvePath.bind(exports.extUri),exports.isAbsolutePath=exports.extUri.isAbsolutePath.bind(exports.extUri),exports.isEqualAuthority=exports.extUri.isEqualAuthority.bind(exports.extUri),exports.hasTrailingPathSeparator=exports.extUri.hasTrailingPathSeparator.bind(exports.extUri),exports.removeTrailingPathSeparator=exports.extUri.removeTrailingPathSeparator.bind(exports.extUri),exports.addTrailingPathSeparator=exports.extUri.addTrailingPathSeparator.bind(exports.extUri),function(DataUri){DataUri.META_DATA_LABEL="label",DataUri.META_DATA_DESCRIPTION="description",DataUri.META_DATA_SIZE="size",DataUri.META_DATA_MIME="mime",DataUri.parseMetaData=function parseMetaData(dataUri){const metadata=new Map;dataUri.path.substring(dataUri.path.indexOf(";")+1,dataUri.path.lastIndexOf(";")).split(";").forEach((property=>{const[key,value]=property.split(":");key&&value&&metadata.set(key,value)}));const mime=dataUri.path.substring(0,dataUri.path.indexOf(";"));return mime&&metadata.set(DataUri.META_DATA_MIME,mime),metadata}}(exports.DataUri||(exports.DataUri={}))})),define(__m[327],__M([1,0,7,759,92,171,59,115,10,21,13,4,68,97,136,2,314,219,45,40,42,8,25]),(function(require,exports,DOM,dompurify,event_1,formattedTextRenderer_1,mouseEvent_1,iconLabels_1,async_1,cancellation_1,errors_1,event_2,htmlContent_1,iconLabels_2,idGenerator_1,lifecycle_1,marked_1,marshalling_1,network_1,objects_1,resources_1,strings_1,uri_1){"use strict";function resolveWithBaseUri(baseUri,href){return/^\w[\w\d+.-]*:/.test(href)?href:baseUri.path.endsWith("/")?(0,resources_1.resolvePath)(baseUri,href).toString():(0,resources_1.resolvePath)((0,resources_1.dirname)(baseUri),href).toString()}function sanitizeRenderedMarkdown(options,renderedMarkdown){const{config,allowedSchemes}=function getSanitizerOptions(options){const allowedSchemes=[network_1.Schemas.http,network_1.Schemas.https,network_1.Schemas.mailto,network_1.Schemas.data,network_1.Schemas.file,network_1.Schemas.vscodeFileResource,network_1.Schemas.vscodeRemote,network_1.Schemas.vscodeRemoteResource];options.isTrusted&&allowedSchemes.push(network_1.Schemas.command);return{config:{ALLOWED_TAGS:["ul","li","p","b","i","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"],ALLOWED_ATTR:["href","data-href","target","title","src","alt","class","style","data-code","width","height","align"],ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes}}(options);dompurify.addHook("uponSanitizeAttribute",((element,e)=>{if("style"!==e.attrName&&"class"!==e.attrName);else{if("SPAN"===element.tagName){if("style"===e.attrName)return void(e.keepAttr=/^(color\:#[0-9a-fA-F]+;)?(background-color\:#[0-9a-fA-F]+;)?$/.test(e.attrValue));if("class"===e.attrName)return void(e.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(e.attrValue))}e.keepAttr=!1}}));const anchor=document.createElement("a");dompurify.addHook("afterSanitizeAttributes",(node=>{for(const attr of["href","src"])node.hasAttribute(attr)&&(anchor.href=node.getAttribute(attr),allowedSchemes.includes(anchor.protocol.replace(/:$/,""))||node.removeAttribute(attr))}));try{return dompurify.sanitize(renderedMarkdown,Object.assign(Object.assign({},config),{RETURN_TRUSTED_TYPE:!0}))}finally{dompurify.removeHook("uponSanitizeAttribute"),dompurify.removeHook("afterSanitizeAttributes")}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderMarkdown=void 0,exports.renderMarkdown=function renderMarkdown(markdown,options={},markedOptions={}){var _a;const disposables=new lifecycle_1.DisposableStore;let isDisposed=!1;const cts=disposables.add(new cancellation_1.CancellationTokenSource),element=(0,formattedTextRenderer_1.createElement)(options),_uriMassage=function(part){let data;try{data=(0,marshalling_1.parse)(decodeURIComponent(part))}catch(e){}return data?(data=(0,objects_1.cloneAndChange)(data,(value=>markdown.uris&&markdown.uris[value]?uri_1.URI.revive(markdown.uris[value]):void 0)),encodeURIComponent(JSON.stringify(data))):part},_href=function(href,isDomUri){const data=markdown.uris&&markdown.uris[href];let uri=uri_1.URI.revive(data);return isDomUri?href.startsWith(network_1.Schemas.data+":")?href:(uri||(uri=uri_1.URI.parse(href)),network_1.FileAccess.asBrowserUri(uri).toString(!0)):uri?uri_1.URI.parse(href).toString()===uri.toString()?href:(uri.query&&(uri=uri.with({query:_uriMassage(uri.query)})),uri.toString()):href};let signalInnerHTML;const withInnerHTML=new Promise((c=>signalInnerHTML=c)),renderer=new marked_1.marked.Renderer;if(renderer.image=(href,title,text)=>{let dimensions=[],attributes=[];return href&&(({href,dimensions}=(0,htmlContent_1.parseHrefAndDimensions)(href)),attributes.push(`src="${href}"`)),text&&attributes.push(`alt="${text}"`),title&&attributes.push(`title="${title}"`),dimensions.length&&(attributes=attributes.concat(dimensions)),"<img "+attributes.join(" ")+">"},renderer.link=(href,title,text)=>"string"!=typeof href?"":(href===text&&(text=(0,htmlContent_1.removeMarkdownEscapes)(text)),href=_href(href,!1),markdown.baseUri&&(href=resolveWithBaseUri(uri_1.URI.from(markdown.baseUri),href)),title="string"==typeof title?(0,htmlContent_1.removeMarkdownEscapes)(title):"",!(href=(0,htmlContent_1.removeMarkdownEscapes)(href))||/^data:|javascript:/i.test(href)||/^command:/i.test(href)&&!markdown.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(href)?text:`<a data-href="${href=href.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" title="${title||href}">${text}</a>`),renderer.paragraph=text=>`<p>${text}</p>`,options.codeBlockRenderer&&(renderer.code=(code,lang)=>{const value=options.codeBlockRenderer(null!=lang?lang:"",code),id=idGenerator_1.defaultGenerator.nextId();return(0,async_1.raceCancellation)(Promise.all([value,withInnerHTML]),cts.token).then((values=>{var _a;if(!isDisposed&&values){const span=element.querySelector(`div[data-code="${id}"]`);span&&DOM.reset(span,values[0]),null===(_a=options.asyncRenderCallback)||void 0===_a||_a.call(options)}})).catch((()=>{})),`<div class="code" data-code="${id}">${(0,strings_1.escape)(code)}</div>`}),options.actionHandler){const onClick=options.actionHandler.disposables.add(new event_1.DomEmitter(element,"click")),onAuxClick=options.actionHandler.disposables.add(new event_1.DomEmitter(element,"auxclick"));options.actionHandler.disposables.add(event_2.Event.any(onClick.event,onAuxClick.event)((e=>{const mouseEvent=new mouseEvent_1.StandardMouseEvent(e);if(!mouseEvent.leftButton&&!mouseEvent.middleButton)return;let target=mouseEvent.target;if("A"===target.tagName||(target=target.parentElement,target&&"A"===target.tagName))try{let href=target.dataset.href;href&&(markdown.baseUri&&(href=resolveWithBaseUri(uri_1.URI.from(markdown.baseUri),href)),options.actionHandler.callback(href,mouseEvent))}catch(err){(0,errors_1.onUnexpectedError)(err)}finally{mouseEvent.preventDefault()}})))}markdown.supportHtml||(markedOptions.sanitizer=html=>(markdown.isTrusted?html.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?html:"",markedOptions.sanitize=!0,markedOptions.silent=!0),markedOptions.renderer=renderer;let value=null!==(_a=markdown.value)&&void 0!==_a?_a:"";value.length>1e5&&(value=`${value.substr(0,1e5)}…`),markdown.supportThemeIcons&&(value=(0,iconLabels_2.markdownEscapeEscapedIcons)(value));let renderedMarkdown=marked_1.marked.parse(value,markedOptions);if(markdown.supportThemeIcons){renderedMarkdown=(0,iconLabels_1.renderLabelWithIcons)(renderedMarkdown).map((e=>"string"==typeof e?e:e.outerHTML)).join("")}const markdownHtmlDoc=(new DOMParser).parseFromString(sanitizeRenderedMarkdown(markdown,renderedMarkdown),"text/html");if(markdownHtmlDoc.body.querySelectorAll("img").forEach((img=>{const src=img.getAttribute("src");if(src){let href=src;try{markdown.baseUri&&(href=resolveWithBaseUri(uri_1.URI.from(markdown.baseUri),href))}catch(err){}img.src=_href(href,!0)}})),element.innerHTML=sanitizeRenderedMarkdown(markdown,markdownHtmlDoc.body.innerHTML),signalInnerHTML(),options.asyncRenderCallback)for(const img of element.getElementsByTagName("img")){const listener=disposables.add(DOM.addDisposableListener(img,"load",(()=>{listener.dispose(),options.asyncRenderCallback()})))}return{element,dispose:()=>{isDisposed=!0,cts.cancel(),disposables.dispose()}}}})),define(__m[173],__M([1,0,168,45,16,42,25]),(function(require,exports,extpath_1,network_1,platform_1,resources_1,uri_1){"use strict";function normalizeDriveLetter(path,continueAsWindows){return(0,extpath_1.hasDriveLetter)(path,continueAsWindows)?path.charAt(0).toUpperCase()+path.slice(1):path}Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeDriveLetter=exports.getBaseLabel=void 0,exports.getBaseLabel=function getBaseLabel(resource){if(!resource)return;"string"==typeof resource&&(resource=uri_1.URI.file(resource));const base=(0,resources_1.basename)(resource)||(resource.scheme===network_1.Schemas.file?resource.fsPath:resource.path);return platform_1.isWindows&&(0,extpath_1.isRootOrDriveLetter)(base)?normalizeDriveLetter(base):base},exports.normalizeDriveLetter=normalizeDriveLetter;Object.create(null)})),define(__m[328],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateUuid=void 0;const _data=new Uint8Array(16),_hex=[];for(let i=0;i<256;i++)_hex.push(i.toString(16).padStart(2,"0"));let _fillRandomValues;_fillRandomValues="object"==typeof crypto&&"function"==typeof crypto.getRandomValues?crypto.getRandomValues.bind(crypto):function(bucket){for(let i=0;i<bucket.length;i++)bucket[i]=Math.floor(256*Math.random());return bucket},exports.generateUuid=function generateUuid(){_fillRandomValues(_data),_data[6]=15&_data[6]|64,_data[8]=63&_data[8]|128;let i=0,result="";return result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+="-",result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+="-",result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+="-",result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+="-",result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result+=_hex[_data[i++]],result}})),define(__m[222],__M([1,0,13,4,2,16,19,8]),(function(require,exports,errors_1,event_1,lifecycle_1,platform_1,types,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=exports.SimpleWorkerServer=exports.SimpleWorkerClient=exports.logOnceWebWorkerWarning=void 0;let webWorkerWarningLogged=!1;exports.logOnceWebWorkerWarning=function logOnceWebWorkerWarning(err){platform_1.isWeb&&(webWorkerWarningLogged||(webWorkerWarningLogged=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(err.message))};class RequestMessage{constructor(vsWorker,req,method,args){this.vsWorker=vsWorker,this.req=req,this.method=method,this.args=args,this.type=0}}class ReplyMessage{constructor(vsWorker,seq,res,err){this.vsWorker=vsWorker,this.seq=seq,this.res=res,this.err=err,this.type=1}}class SubscribeEventMessage{constructor(vsWorker,req,eventName,arg){this.vsWorker=vsWorker,this.req=req,this.eventName=eventName,this.arg=arg,this.type=2}}class EventMessage{constructor(vsWorker,req,event){this.vsWorker=vsWorker,this.req=req,this.event=event,this.type=3}}class UnsubscribeEventMessage{constructor(vsWorker,req){this.vsWorker=vsWorker,this.req=req,this.type=4}}class SimpleWorkerProtocol{constructor(handler){this._workerId=-1,this._handler=handler,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(workerId){this._workerId=workerId}sendMessage(method,args){const req=String(++this._lastSentReq);return new Promise(((resolve,reject)=>{this._pendingReplies[req]={resolve,reject},this._send(new RequestMessage(this._workerId,req,method,args))}))}listen(eventName,arg){let req=null;const emitter=new event_1.Emitter({onFirstListenerAdd:()=>{req=String(++this._lastSentReq),this._pendingEmitters.set(req,emitter),this._send(new SubscribeEventMessage(this._workerId,req,eventName,arg))},onLastListenerRemove:()=>{this._pendingEmitters.delete(req),this._send(new UnsubscribeEventMessage(this._workerId,req)),req=null}});return emitter.event}handleMessage(message){message&&message.vsWorker&&(-1!==this._workerId&&message.vsWorker!==this._workerId||this._handleMessage(message))}_handleMessage(msg){switch(msg.type){case 1:return this._handleReplyMessage(msg);case 0:return this._handleRequestMessage(msg);case 2:return this._handleSubscribeEventMessage(msg);case 3:return this._handleEventMessage(msg);case 4:return this._handleUnsubscribeEventMessage(msg)}}_handleReplyMessage(replyMessage){if(!this._pendingReplies[replyMessage.seq])return void console.warn("Got reply to unknown seq");let reply=this._pendingReplies[replyMessage.seq];if(delete this._pendingReplies[replyMessage.seq],replyMessage.err){let err=replyMessage.err;return replyMessage.err.$isError&&(err=new Error,err.name=replyMessage.err.name,err.message=replyMessage.err.message,err.stack=replyMessage.err.stack),void reply.reject(err)}reply.resolve(replyMessage.res)}_handleRequestMessage(requestMessage){let req=requestMessage.req;this._handler.handleMessage(requestMessage.method,requestMessage.args).then((r=>{this._send(new ReplyMessage(this._workerId,req,r,void 0))}),(e=>{e.detail instanceof Error&&(e.detail=(0,errors_1.transformErrorForSerialization)(e.detail)),this._send(new ReplyMessage(this._workerId,req,void 0,(0,errors_1.transformErrorForSerialization)(e)))}))}_handleSubscribeEventMessage(msg){const req=msg.req,disposable=this._handler.handleEvent(msg.eventName,msg.arg)((event=>{this._send(new EventMessage(this._workerId,req,event))}));this._pendingEvents.set(req,disposable)}_handleEventMessage(msg){this._pendingEmitters.has(msg.req)?this._pendingEmitters.get(msg.req).fire(msg.event):console.warn("Got event for unknown req")}_handleUnsubscribeEventMessage(msg){this._pendingEvents.has(msg.req)?(this._pendingEvents.get(msg.req).dispose(),this._pendingEvents.delete(msg.req)):console.warn("Got unsubscribe for unknown req")}_send(msg){let transfer=[];if(0===msg.type)for(let i=0;i<msg.args.length;i++)msg.args[i]instanceof ArrayBuffer&&transfer.push(msg.args[i]);else 1===msg.type&&msg.res instanceof ArrayBuffer&&transfer.push(msg.res);this._handler.sendMessage(msg,transfer)}}class SimpleWorkerClient extends lifecycle_1.Disposable{constructor(workerFactory,moduleId,host){super();let lazyProxyReject=null;this._worker=this._register(workerFactory.create("vs/base/common/worker/simpleWorker",(msg=>{this._protocol.handleMessage(msg)}),(err=>{lazyProxyReject&&lazyProxyReject(err)}))),this._protocol=new SimpleWorkerProtocol({sendMessage:(msg,transfer)=>{this._worker.postMessage(msg,transfer)},handleMessage:(method,args)=>{if("function"!=typeof host[method])return Promise.reject(new Error("Missing method "+method+" on main thread host."));try{return Promise.resolve(host[method].apply(host,args))}catch(e){return Promise.reject(e)}},handleEvent:(eventName,arg)=>{if(propertyIsDynamicEvent(eventName)){const event=host[eventName].call(host,arg);if("function"!=typeof event)throw new Error(`Missing dynamic event ${eventName} on main thread host.`);return event}if(propertyIsEvent(eventName)){const event=host[eventName];if("function"!=typeof event)throw new Error(`Missing event ${eventName} on main thread host.`);return event}throw new Error(`Malformed event name ${eventName}`)}}),this._protocol.setWorkerId(this._worker.getId());let loaderConfiguration=null;void 0!==platform_1.globals.require&&"function"==typeof platform_1.globals.require.getConfig?loaderConfiguration=platform_1.globals.require.getConfig():void 0!==platform_1.globals.requirejs&&(loaderConfiguration=platform_1.globals.requirejs.s.contexts._.config);const hostMethods=types.getAllMethodNames(host);this._onModuleLoaded=this._protocol.sendMessage("$initialize",[this._worker.getId(),JSON.parse(JSON.stringify(loaderConfiguration)),moduleId,hostMethods]);const proxyMethodRequest=(method,args)=>this._request(method,args),proxyListen=(eventName,arg)=>this._protocol.listen(eventName,arg);this._lazyProxy=new Promise(((resolve,reject)=>{lazyProxyReject=reject,this._onModuleLoaded.then((availableMethods=>{resolve(createProxyObject(availableMethods,proxyMethodRequest,proxyListen))}),(e=>{reject(e),this._onError("Worker failed to load "+moduleId,e)}))}))}getProxyObject(){return this._lazyProxy}_request(method,args){return new Promise(((resolve,reject)=>{this._onModuleLoaded.then((()=>{this._protocol.sendMessage(method,args).then(resolve,reject)}),reject)}))}_onError(message,error){console.error(message),console.info(error)}}function propertyIsEvent(name){return"o"===name[0]&&"n"===name[1]&&strings.isUpperAsciiLetter(name.charCodeAt(2))}function propertyIsDynamicEvent(name){return/^onDynamic/.test(name)&&strings.isUpperAsciiLetter(name.charCodeAt(9))}function createProxyObject(methodNames,invoke,proxyListen){const createProxyMethod=method=>function(){const args=Array.prototype.slice.call(arguments,0);return invoke(method,args)},createProxyDynamicEvent=eventName=>function(arg){return proxyListen(eventName,arg)};let result={};for(const methodName of methodNames)propertyIsDynamicEvent(methodName)?result[methodName]=createProxyDynamicEvent(methodName):propertyIsEvent(methodName)?result[methodName]=proxyListen(methodName,void 0):result[methodName]=createProxyMethod(methodName);return result}exports.SimpleWorkerClient=SimpleWorkerClient;class SimpleWorkerServer{constructor(postMessage,requestHandlerFactory){this._requestHandlerFactory=requestHandlerFactory,this._requestHandler=null,this._protocol=new SimpleWorkerProtocol({sendMessage:(msg,transfer)=>{postMessage(msg,transfer)},handleMessage:(method,args)=>this._handleMessage(method,args),handleEvent:(eventName,arg)=>this._handleEvent(eventName,arg)})}onmessage(msg){this._protocol.handleMessage(msg)}_handleMessage(method,args){if("$initialize"===method)return this.initialize(args[0],args[1],args[2],args[3]);if(!this._requestHandler||"function"!=typeof this._requestHandler[method])return Promise.reject(new Error("Missing requestHandler or method: "+method));try{return Promise.resolve(this._requestHandler[method].apply(this._requestHandler,args))}catch(e){return Promise.reject(e)}}_handleEvent(eventName,arg){if(!this._requestHandler)throw new Error("Missing requestHandler");if(propertyIsDynamicEvent(eventName)){const event=this._requestHandler[eventName].call(this._requestHandler,arg);if("function"!=typeof event)throw new Error(`Missing dynamic event ${eventName} on request handler.`);return event}if(propertyIsEvent(eventName)){const event=this._requestHandler[eventName];if("function"!=typeof event)throw new Error(`Missing event ${eventName} on request handler.`);return event}throw new Error(`Malformed event name ${eventName}`)}initialize(workerId,loaderConfig,moduleId,hostMethods){this._protocol.setWorkerId(workerId);const hostProxy=createProxyObject(hostMethods,((method,args)=>this._protocol.sendMessage(method,args)),((eventName,arg)=>this._protocol.listen(eventName,arg)));return this._requestHandlerFactory?(this._requestHandler=this._requestHandlerFactory(hostProxy),Promise.resolve(types.getAllMethodNames(this._requestHandler))):(loaderConfig&&(void 0!==loaderConfig.baseUrl&&delete loaderConfig.baseUrl,void 0!==loaderConfig.paths&&void 0!==loaderConfig.paths.vs&&delete loaderConfig.paths.vs,void 0!==typeof loaderConfig.trustedTypesPolicy&&delete loaderConfig.trustedTypesPolicy,loaderConfig.catchError=!0,platform_1.globals.require.config(loaderConfig)),new Promise(((resolve,reject)=>{(platform_1.globals.require||require)([moduleId],(module=>{this._requestHandler=module.create(hostProxy),this._requestHandler?resolve(types.getAllMethodNames(this._requestHandler)):reject(new Error("No RequestHandler!"))}),reject)})))}}exports.SimpleWorkerServer=SimpleWorkerServer,exports.create=function create(postMessage){return new SimpleWorkerServer(postMessage,null)}})),define(__m[329],__M([1,0,16,222]),(function(require,exports,platform_1,simpleWorker_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DefaultWorkerFactory=exports.getWorkerBootstrapUrl=void 0;const ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("defaultWorkerFactory",{createScriptURL:value=>value});function getWorkerBootstrapUrl(scriptPath,label){if(/^((http:)|(https:)|(file:))/.test(scriptPath)&&scriptPath.substring(0,self.origin.length)!==self.origin){const myPath="vs/base/worker/defaultWorkerFactory.js",workerBaseUrl=require.toUrl(myPath).slice(0,-myPath.length),blob=new Blob([`/*${label}*/self.MonacoEnvironment={baseUrl: '${workerBaseUrl}'};const ttPolicy = self.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });importScripts(ttPolicy?.createScriptURL('${scriptPath}') ?? '${scriptPath}');/*${label}*/`],{type:"application/javascript"});return URL.createObjectURL(blob)}return scriptPath+"#"+label}exports.getWorkerBootstrapUrl=getWorkerBootstrapUrl;class WebWorker{constructor(moduleId,id,label,onMessageCallback,onErrorCallback){this.id=id;const workerOrPromise=function getWorker(label){if(platform_1.globals.MonacoEnvironment){if("function"==typeof platform_1.globals.MonacoEnvironment.getWorker)return platform_1.globals.MonacoEnvironment.getWorker("workerMain.js",label);if("function"==typeof platform_1.globals.MonacoEnvironment.getWorkerUrl){const workerUrl=platform_1.globals.MonacoEnvironment.getWorkerUrl("workerMain.js",label);return new Worker(ttPolicy?ttPolicy.createScriptURL(workerUrl):workerUrl,{name:label})}}if("function"==typeof require){const workerUrl=getWorkerBootstrapUrl(require.toUrl("vs/base/worker/workerMain.js"),label);return new Worker(ttPolicy?ttPolicy.createScriptURL(workerUrl):workerUrl,{name:label})}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}(label);!function isPromiseLike(obj){return"function"==typeof obj.then}(workerOrPromise)?this.worker=Promise.resolve(workerOrPromise):this.worker=workerOrPromise,this.postMessage(moduleId,[]),this.worker.then((w=>{w.onmessage=function(ev){onMessageCallback(ev.data)},w.onmessageerror=onErrorCallback,"function"==typeof w.addEventListener&&w.addEventListener("error",onErrorCallback)}))}getId(){return this.id}postMessage(message,transfer){this.worker&&this.worker.then((w=>w.postMessage(message,transfer)))}dispose(){this.worker&&this.worker.then((w=>w.terminate())),this.worker=null}}class DefaultWorkerFactory{constructor(label){this._label=label,this._webWorkerFailedBeforeError=!1}create(moduleId,onMessageCallback,onErrorCallback){let workerId=++DefaultWorkerFactory.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new WebWorker(moduleId,workerId,this._label||"anonymous"+workerId,onMessageCallback,(err=>{(0,simpleWorker_1.logOnceWebWorkerWarning)(err),this._webWorkerFailedBeforeError=err,onErrorCallback(err)}))}}exports.DefaultWorkerFactory=DefaultWorkerFactory,DefaultWorkerFactory.LAST_WORKER_ID=0})),define(__m[223],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.quickPickItemScorerAccessor=exports.QuickPickItemScorerAccessor=exports.ItemActivation=exports.QuickInputHideReason=exports.NO_KEY_MODS=void 0,exports.NO_KEY_MODS={ctrlCmd:!1,alt:!1},function(QuickInputHideReason){QuickInputHideReason[QuickInputHideReason.Blur=1]="Blur",QuickInputHideReason[QuickInputHideReason.Gesture=2]="Gesture",QuickInputHideReason[QuickInputHideReason.Other=3]="Other"}(exports.QuickInputHideReason||(exports.QuickInputHideReason={})),function(ItemActivation){ItemActivation[ItemActivation.NONE=0]="NONE",ItemActivation[ItemActivation.FIRST=1]="FIRST",ItemActivation[ItemActivation.SECOND=2]="SECOND",ItemActivation[ItemActivation.LAST=3]="LAST"}(exports.ItemActivation||(exports.ItemActivation={}));class QuickPickItemScorerAccessor{constructor(options){this.options=options}}exports.QuickPickItemScorerAccessor=QuickPickItemScorerAccessor,exports.quickPickItemScorerAccessor=new QuickPickItemScorerAccessor})),define(__m[330],__M([1,0,10,4,2,19]),(function(require,exports,async_1,event_1,lifecycle_1,types_1){"use strict";var StorageState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.InMemoryStorageDatabase=exports.Storage=void 0,function(StorageState){StorageState[StorageState.None=0]="None",StorageState[StorageState.Initialized=1]="Initialized",StorageState[StorageState.Closed=2]="Closed"}(StorageState||(StorageState={}));class Storage extends lifecycle_1.Disposable{constructor(database,options=Object.create(null)){super(),this.database=database,this.options=options,this._onDidChangeStorage=this._register(new event_1.Emitter),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=StorageState.None,this.cache=new Map,this.flushDelayer=new async_1.ThrottledDelayer(Storage.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal((e=>this.onDidChangeItemsExternal(e))))}onDidChangeItemsExternal(e){var _a,_b;null===(_a=e.changed)||void 0===_a||_a.forEach(((value,key)=>this.accept(key,value))),null===(_b=e.deleted)||void 0===_b||_b.forEach((key=>this.accept(key,void 0)))}accept(key,value){if(this.state===StorageState.Closed)return;let changed=!1;if((0,types_1.isUndefinedOrNull)(value))changed=this.cache.delete(key);else{this.cache.get(key)!==value&&(this.cache.set(key,value),changed=!0)}changed&&this._onDidChangeStorage.fire(key)}get(key,fallbackValue){const value=this.cache.get(key);return(0,types_1.isUndefinedOrNull)(value)?fallbackValue:value}getBoolean(key,fallbackValue){const value=this.get(key);return(0,types_1.isUndefinedOrNull)(value)?fallbackValue:"true"===value}getNumber(key,fallbackValue){const value=this.get(key);return(0,types_1.isUndefinedOrNull)(value)?fallbackValue:parseInt(value,10)}set(key,value){return __awaiter(this,void 0,void 0,(function*(){if(this.state===StorageState.Closed)return;if((0,types_1.isUndefinedOrNull)(value))return this.delete(key);const valueStr=String(value);return this.cache.get(key)!==valueStr?(this.cache.set(key,valueStr),this.pendingInserts.set(key,valueStr),this.pendingDeletes.delete(key),this._onDidChangeStorage.fire(key),this.doFlush()):void 0}))}delete(key){return __awaiter(this,void 0,void 0,(function*(){if(this.state===StorageState.Closed)return;return this.cache.delete(key)?(this.pendingDeletes.has(key)||this.pendingDeletes.add(key),this.pendingInserts.delete(key),this._onDidChangeStorage.fire(key),this.doFlush()):void 0}))}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return __awaiter(this,void 0,void 0,(function*(){if(!this.hasPending)return;const updateRequest={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(updateRequest).finally((()=>{var _a;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)null===(_a=this.whenFlushedCallbacks.pop())||void 0===_a||_a()}))}))}doFlush(delay){return __awaiter(this,void 0,void 0,(function*(){return this.flushDelayer.trigger((()=>this.flushPending()),delay)}))}dispose(){this.flushDelayer.dispose(),super.dispose()}}exports.Storage=Storage,Storage.DEFAULT_FLUSH_DELAY=100;exports.InMemoryStorageDatabase=class InMemoryStorageDatabase{constructor(){this.onDidChangeItemsExternal=event_1.Event.None,this.items=new Map}updateItems(request){return __awaiter(this,void 0,void 0,(function*(){request.insert&&request.insert.forEach(((value,key)=>this.items.set(key,value))),request.delete&&request.delete.forEach((key=>this.items.delete(key)))}))}}})),define(__m[224],__M([12]),{}),define(__m[331],__M([12]),{}),define(__m[46],__M([1,0,7,16,331]),(function(require,exports,dom,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.status=exports.alert=exports.setARIAContainer=void 0;let ariaContainer,alertContainer,alertContainer2,statusContainer,statusContainer2;function alert(msg){ariaContainer&&(alertContainer.textContent!==msg?(dom.clearNode(alertContainer2),insertMessage(alertContainer,msg)):(dom.clearNode(alertContainer),insertMessage(alertContainer2,msg)))}function insertMessage(target,msg){dom.clearNode(target),msg.length>2e4&&(msg=msg.substr(0,2e4)),target.textContent=msg,target.style.visibility="hidden",target.style.visibility="visible"}exports.setARIAContainer=function setARIAContainer(parent){ariaContainer=document.createElement("div"),ariaContainer.className="monaco-aria-container";const createAlertContainer=()=>{const element=document.createElement("div");return element.className="monaco-alert",element.setAttribute("role","alert"),element.setAttribute("aria-atomic","true"),ariaContainer.appendChild(element),element};alertContainer=createAlertContainer(),alertContainer2=createAlertContainer();const createStatusContainer=()=>{const element=document.createElement("div");return element.className="monaco-status",element.setAttribute("role","complementary"),element.setAttribute("aria-live","polite"),element.setAttribute("aria-atomic","true"),ariaContainer.appendChild(element),element};statusContainer=createStatusContainer(),statusContainer2=createStatusContainer(),parent.appendChild(ariaContainer)},exports.alert=alert,exports.status=function status(msg){ariaContainer&&(platform_1.isMacintosh?alert(msg):statusContainer.textContent!==msg?(dom.clearNode(statusContainer2),insertMessage(statusContainer,msg)):(dom.clearNode(statusContainer),insertMessage(statusContainer2,msg)))}})),define(__m[332],__M([12]),{}),define(__m[333],__M([1,0,7,44,60,115,30,4,2,40,332]),(function(require,exports,dom_1,keyboardEvent_1,touch_1,iconLabels_1,color_1,event_1,lifecycle_1,objects_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Button=void 0;const defaultOptions={buttonBackground:color_1.Color.fromHex("#0E639C"),buttonHoverBackground:color_1.Color.fromHex("#006BB3"),buttonForeground:color_1.Color.white};class Button extends lifecycle_1.Disposable{constructor(container,options){super(),this._onDidClick=this._register(new event_1.Emitter),this.options=options||Object.create(null),(0,objects_1.mixin)(this.options,defaultOptions,!1),this.buttonForeground=this.options.buttonForeground,this.buttonBackground=this.options.buttonBackground,this.buttonHoverBackground=this.options.buttonHoverBackground,this.buttonSecondaryForeground=this.options.buttonSecondaryForeground,this.buttonSecondaryBackground=this.options.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=this.options.buttonSecondaryHoverBackground,this.buttonBorder=this.options.buttonBorder,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),container.appendChild(this._element),this._register(touch_1.Gesture.addTarget(this._element)),[dom_1.EventType.CLICK,touch_1.EventType.Tap].forEach((eventType=>{this._register((0,dom_1.addDisposableListener)(this._element,eventType,(e=>{this.enabled?this._onDidClick.fire(e):dom_1.EventHelper.stop(e)})))})),this._register((0,dom_1.addDisposableListener)(this._element,dom_1.EventType.KEY_DOWN,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);let eventHandled=!1;this.enabled&&(event.equals(3)||event.equals(10))?(this._onDidClick.fire(e),eventHandled=!0):event.equals(9)&&(this._element.blur(),eventHandled=!0),eventHandled&&dom_1.EventHelper.stop(event,!0)}))),this._register((0,dom_1.addDisposableListener)(this._element,dom_1.EventType.MOUSE_OVER,(e=>{this._element.classList.contains("disabled")||this.setHoverBackground()}))),this._register((0,dom_1.addDisposableListener)(this._element,dom_1.EventType.MOUSE_OUT,(e=>{this.applyStyles()}))),this.focusTracker=this._register((0,dom_1.trackFocus)(this._element)),this._register(this.focusTracker.onDidFocus((()=>this.setHoverBackground()))),this._register(this.focusTracker.onDidBlur((()=>this.applyStyles()))),this.applyStyles()}get onDidClick(){return this._onDidClick.event}setHoverBackground(){let hoverBackground;hoverBackground=this.options.secondary?this.buttonSecondaryHoverBackground?this.buttonSecondaryHoverBackground.toString():null:this.buttonHoverBackground?this.buttonHoverBackground.toString():null,hoverBackground&&(this._element.style.backgroundColor=hoverBackground)}style(styles){this.buttonForeground=styles.buttonForeground,this.buttonBackground=styles.buttonBackground,this.buttonHoverBackground=styles.buttonHoverBackground,this.buttonSecondaryForeground=styles.buttonSecondaryForeground,this.buttonSecondaryBackground=styles.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=styles.buttonSecondaryHoverBackground,this.buttonBorder=styles.buttonBorder,this.applyStyles()}applyStyles(){if(this._element){let background,foreground;this.options.secondary?(foreground=this.buttonSecondaryForeground?this.buttonSecondaryForeground.toString():"",background=this.buttonSecondaryBackground?this.buttonSecondaryBackground.toString():""):(foreground=this.buttonForeground?this.buttonForeground.toString():"",background=this.buttonBackground?this.buttonBackground.toString():"");const border=this.buttonBorder?this.buttonBorder.toString():"";this._element.style.color=foreground,this._element.style.backgroundColor=background,this._element.style.borderWidth=border?"1px":"",this._element.style.borderStyle=border?"solid":"",this._element.style.borderColor=border}}get element(){return this._element}set label(value){this._element.classList.add("monaco-text-button"),this.options.supportIcons?(0,dom_1.reset)(this._element,...(0,iconLabels_1.renderLabelWithIcons)(value)):this._element.textContent=value,"string"==typeof this.options.title?this._element.title=this.options.title:this.options.title&&(this._element.title=value)}set enabled(value){value?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}exports.Button=Button})),define(__m[334],__M([12]),{}),define(__m[174],__M([1,0,62,28,30,4,334]),(function(require,exports,widget_1,codicons_1,color_1,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Checkbox=void 0;const defaultOpts={inputActiveOptionBorder:color_1.Color.fromHex("#007ACC00"),inputActiveOptionForeground:color_1.Color.fromHex("#FFFFFF"),inputActiveOptionBackground:color_1.Color.fromHex("#0E639C50")};class Checkbox extends widget_1.Widget{constructor(opts){super(),this._onChange=this._register(new event_1.Emitter),this.onChange=this._onChange.event,this._onKeyDown=this._register(new event_1.Emitter),this.onKeyDown=this._onKeyDown.event,this._opts=Object.assign(Object.assign({},defaultOpts),opts),this._checked=this._opts.isChecked;const classes=["monaco-custom-checkbox"];this._opts.icon&&classes.push(...codicons_1.CSSIcon.asClassNameArray(this._opts.icon)),this._opts.actionClassName&&classes.push(...this._opts.actionClassName.split(" ")),this._checked&&classes.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...classes),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,(ev=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),ev.preventDefault())})),this.ignoreGesture(this.domNode),this.onkeydown(this.domNode,(keyboardEvent=>{if(10===keyboardEvent.keyCode||3===keyboardEvent.keyCode)return this.checked=!this._checked,this._onChange.fire(!0),void keyboardEvent.preventDefault();this._onKeyDown.fire(keyboardEvent)}))}get enabled(){return"true"!==this.domNode.getAttribute("aria-disabled")}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(newIsChecked){this._checked=newIsChecked,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}style(styles){styles.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=styles.inputActiveOptionBorder),styles.inputActiveOptionForeground&&(this._opts.inputActiveOptionForeground=styles.inputActiveOptionForeground),styles.inputActiveOptionBackground&&(this._opts.inputActiveOptionBackground=styles.inputActiveOptionBackground),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground?this._opts.inputActiveOptionForeground.toString():"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground?this._opts.inputActiveOptionBackground.toString():"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}exports.Checkbox=Checkbox})),define(__m[335],__M([12]),{}),define(__m[336],__M([12]),{}),define(__m[143],__M([1,0,28,335,336]),(function(require,exports,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatRule=void 0,exports.formatRule=function formatRule(c){let def=c.definition;for(;def instanceof codicons_1.Codicon;)def=def.definition;return`.codicon-${c.id}:before { content: '${def.fontCharacter}'; }`}})),define(__m[337],__M([12]),{}),define(__m[225],__M([1,0,167,7,2,16,139,337]),(function(require,exports,canIUse_1,DOM,lifecycle_1,platform,range_1){"use strict";var LayoutAnchorMode;function layout(viewportSize,viewSize,anchor){const layoutAfterAnchorBoundary=anchor.mode===LayoutAnchorMode.ALIGN?anchor.offset:anchor.offset+anchor.size,layoutBeforeAnchorBoundary=anchor.mode===LayoutAnchorMode.ALIGN?anchor.offset+anchor.size:anchor.offset;return 0===anchor.position?viewSize<=viewportSize-layoutAfterAnchorBoundary?layoutAfterAnchorBoundary:viewSize<=layoutBeforeAnchorBoundary?layoutBeforeAnchorBoundary-viewSize:Math.max(viewportSize-viewSize,0):viewSize<=layoutBeforeAnchorBoundary?layoutBeforeAnchorBoundary-viewSize:viewSize<=viewportSize-layoutAfterAnchorBoundary?layoutAfterAnchorBoundary:0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextView=exports.layout=exports.LayoutAnchorMode=void 0,function(LayoutAnchorMode){LayoutAnchorMode[LayoutAnchorMode.AVOID=0]="AVOID",LayoutAnchorMode[LayoutAnchorMode.ALIGN=1]="ALIGN"}(LayoutAnchorMode=exports.LayoutAnchorMode||(exports.LayoutAnchorMode={})),exports.layout=layout;class ContextView extends lifecycle_1.Disposable{constructor(container,domPosition){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=lifecycle_1.Disposable.None,this.toDisposeOnSetContainer=lifecycle_1.Disposable.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=DOM.$(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,DOM.hide(this.view),this.setContainer(container,domPosition),this._register((0,lifecycle_1.toDisposable)((()=>this.setContainer(null,1))))}setContainer(container,domPosition){var _a;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,null===(_a=this.shadowRootHostElement)||void 0===_a||_a.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),container){if(this.container=container,this.useFixedPosition=1!==domPosition,this.useShadowDOM=3===domPosition,this.useShadowDOM){this.shadowRootHostElement=DOM.$(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const style=document.createElement("style");style.textContent=SHADOW_ROOT_CSS,this.shadowRoot.appendChild(style),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(DOM.$("slot"))}else this.container.appendChild(this.view);const toDisposeOnSetContainer=new lifecycle_1.DisposableStore;ContextView.BUBBLE_UP_EVENTS.forEach((event=>{toDisposeOnSetContainer.add(DOM.addStandardDisposableListener(this.container,event,(e=>{this.onDOMEvent(e,!1)})))})),ContextView.BUBBLE_DOWN_EVENTS.forEach((event=>{toDisposeOnSetContainer.add(DOM.addStandardDisposableListener(this.container,event,(e=>{this.onDOMEvent(e,!0)}),!0))})),this.toDisposeOnSetContainer=toDisposeOnSetContainer}}show(delegate){this.isVisible()&&this.hide(),DOM.clearNode(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2500",this.view.style.position=this.useFixedPosition?"fixed":"absolute",DOM.show(this.view),this.toDisposeOnClean=delegate.render(this.view)||lifecycle_1.Disposable.None,this.delegate=delegate,this.doLayout(),this.delegate.focus&&this.delegate.focus()}getViewElement(){return this.view}layout(){this.isVisible()&&(!1!==this.delegate.canRelayout||platform.isIOS&&canIUse_1.BrowserFeatures.pointerEvents?(this.delegate.layout&&this.delegate.layout(),this.doLayout()):this.hide())}doLayout(){if(!this.isVisible())return;let around,anchor=this.delegate.getAnchor();if(DOM.isHTMLElement(anchor)){let elementPosition=DOM.getDomNodePagePosition(anchor);around={top:elementPosition.top,left:elementPosition.left,width:elementPosition.width,height:elementPosition.height}}else around={top:anchor.y,left:anchor.x,width:anchor.width||1,height:anchor.height||2};const viewSizeWidth=DOM.getTotalWidth(this.view),viewSizeHeight=DOM.getTotalHeight(this.view),anchorPosition=this.delegate.anchorPosition||0,anchorAlignment=this.delegate.anchorAlignment||0;let top,left;if(0===(this.delegate.anchorAxisAlignment||0)){const verticalAnchor={offset:around.top-window.pageYOffset,size:around.height,position:0===anchorPosition?0:1},horizontalAnchor={offset:around.left,size:around.width,position:0===anchorAlignment?0:1,mode:LayoutAnchorMode.ALIGN};top=layout(window.innerHeight,viewSizeHeight,verticalAnchor)+window.pageYOffset,range_1.Range.intersects({start:top,end:top+viewSizeHeight},{start:verticalAnchor.offset,end:verticalAnchor.offset+verticalAnchor.size})&&(horizontalAnchor.mode=LayoutAnchorMode.AVOID),left=layout(window.innerWidth,viewSizeWidth,horizontalAnchor)}else{const horizontalAnchor={offset:around.left,size:around.width,position:0===anchorAlignment?0:1},verticalAnchor={offset:around.top,size:around.height,position:0===anchorPosition?0:1,mode:LayoutAnchorMode.ALIGN};left=layout(window.innerWidth,viewSizeWidth,horizontalAnchor),range_1.Range.intersects({start:left,end:left+viewSizeWidth},{start:horizontalAnchor.offset,end:horizontalAnchor.offset+horizontalAnchor.size})&&(verticalAnchor.mode=LayoutAnchorMode.AVOID),top=layout(window.innerHeight,viewSizeHeight,verticalAnchor)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(0===anchorPosition?"bottom":"top"),this.view.classList.add(0===anchorAlignment?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const containerPosition=DOM.getDomNodePagePosition(this.container);this.view.style.top=top-(this.useFixedPosition?DOM.getDomNodePagePosition(this.view).top:containerPosition.top)+"px",this.view.style.left=left-(this.useFixedPosition?DOM.getDomNodePagePosition(this.view).left:containerPosition.left)+"px",this.view.style.width="initial"}hide(data){const delegate=this.delegate;this.delegate=null,(null==delegate?void 0:delegate.onHide)&&delegate.onHide(data),this.toDisposeOnClean.dispose(),DOM.hide(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,onCapture){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):onCapture&&!DOM.isAncestor(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}exports.ContextView=ContextView,ContextView.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],ContextView.BUBBLE_DOWN_EVENTS=["click"];let SHADOW_ROOT_CSS='\n\t:host {\n\t\tall: initial; /* 1st rule so subsequent properties are reset. */\n\t}\n\n\t@font-face {\n\t\tfont-family: "codicon";\n\t\tfont-display: block;\n\t\tsrc: url("./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6") format("truetype");\n\t}\n\n\t.codicon[class*=\'codicon-\'] {\n\t\tfont: normal normal normal 16px/1 codicon;\n\t\tdisplay: inline-block;\n\t\ttext-decoration: none;\n\t\ttext-rendering: auto;\n\t\ttext-align: center;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t\tuser-select: none;\n\t\t-webkit-user-select: none;\n\t\t-ms-user-select: none;\n\t}\n\n\t:host {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;\n\t}\n\n\t:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }\n\t:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }\n\t:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }\n\t:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }\n\t:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }\n\n\t:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }\n\t:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }\n\t:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }\n\t:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }\n\t:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }\n\n\t:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }\n'})),define(__m[338],__M([12]),{}),define(__m[226],__M([1,0,7,30,40,8,338]),(function(require,exports,dom_1,color_1,objects_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CountBadge=void 0;const defaultOpts={badgeBackground:color_1.Color.fromHex("#4D4D4D"),badgeForeground:color_1.Color.fromHex("#FFFFFF")};exports.CountBadge=class CountBadge{constructor(container,options){this.count=0,this.options=options||Object.create(null),(0,objects_1.mixin)(this.options,defaultOpts,!1),this.badgeBackground=this.options.badgeBackground,this.badgeForeground=this.options.badgeForeground,this.badgeBorder=this.options.badgeBorder,this.element=(0,dom_1.append)(container,(0,dom_1.$)(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(count){this.count=count,this.render()}setTitleFormat(titleFormat){this.titleFormat=titleFormat,this.render()}render(){this.element.textContent=(0,strings_1.format)(this.countFormat,this.count),this.element.title=(0,strings_1.format)(this.titleFormat,this.count),this.applyStyles()}style(styles){this.badgeBackground=styles.badgeBackground,this.badgeForeground=styles.badgeForeground,this.badgeBorder=styles.badgeBorder,this.applyStyles()}applyStyles(){if(this.element){const background=this.badgeBackground?this.badgeBackground.toString():"",foreground=this.badgeForeground?this.badgeForeground.toString():"",border=this.badgeBorder?this.badgeBorder.toString():"";this.element.style.backgroundColor=background,this.element.style.color=foreground,this.element.style.borderWidth=border?"1px":"",this.element.style.borderStyle=border?"solid":"",this.element.style.borderColor=border}}}})),define(__m[227],__M([12]),{}),define(__m[228],__M([12]),{}),define(__m[339],__M([12]),{}),define(__m[340],__M([12]),{}),define(__m[341],__M([12]),{}),define(__m[342],__M([12]),{}),define(__m[229],__M([12]),{}),define(__m[343],__M([12]),{}),define(__m[144],__M([1,0,343]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME=void 0,exports.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME="monaco-mouse-cursor-text"})),define(__m[344],__M([12]),{}),define(__m[345],__M([1,0,7,10,30,2,40,344]),(function(require,exports,dom_1,async_1,color_1,lifecycle_1,objects_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProgressBar=void 0;const defaultOpts={progressBarBackground:color_1.Color.fromHex("#0E70C0")};class ProgressBar extends lifecycle_1.Disposable{constructor(container,options){super(),this.options=options||Object.create(null),(0,objects_1.mixin)(this.options,defaultOpts,!1),this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this.showDelayedScheduler=this._register(new async_1.RunOnceScheduler((()=>(0,dom_1.show)(this.element)),0)),this.longRunningScheduler=this._register(new async_1.RunOnceScheduler((()=>this.infiniteLongRunning()),ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(container)}create(container){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),container.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.element.appendChild(this.bit),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove("active","infinite","infinite-long-running","discrete"),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(delayed){return this.element.classList.add("done"),this.element.classList.contains("infinite")?(this.bit.style.opacity="0",delayed?setTimeout((()=>this.off()),200):this.off()):(this.bit.style.width="inherit",delayed?setTimeout((()=>this.off()),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove("discrete","done","infinite-long-running"),this.element.classList.add("active","infinite"),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add("infinite-long-running")}getContainer(){return this.element}style(styles){this.progressBarBackground=styles.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const background=this.progressBarBackground?this.progressBarBackground.toString():"";this.bit.style.backgroundColor=background}}}exports.ProgressBar=ProgressBar,ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD=1e4})),define(__m[346],__M([12]),{}),define(__m[116],__M([1,0,7,92,60,10,95,4,2,16,346]),(function(require,exports,dom_1,event_1,touch_1,async_1,decorators_1,event_2,lifecycle_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sash=exports.OrthogonalEdge=void 0;!function(OrthogonalEdge){OrthogonalEdge.North="north",OrthogonalEdge.South="south",OrthogonalEdge.East="east",OrthogonalEdge.West="west"}(exports.OrthogonalEdge||(exports.OrthogonalEdge={}));const onDidChangeGlobalSize=new event_2.Emitter;const onDidChangeHoverDelay=new event_2.Emitter;class MouseEventFactory{constructor(){this.disposables=new lifecycle_1.DisposableStore}get onPointerMove(){return this.disposables.add(new event_1.DomEmitter(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new event_1.DomEmitter(window,"mouseup")).event}dispose(){this.disposables.dispose()}}__decorate([decorators_1.memoize],MouseEventFactory.prototype,"onPointerMove",null),__decorate([decorators_1.memoize],MouseEventFactory.prototype,"onPointerUp",null);class GestureEventFactory{constructor(el){this.el=el,this.disposables=new lifecycle_1.DisposableStore}get onPointerMove(){return this.disposables.add(new event_1.DomEmitter(this.el,touch_1.EventType.Change)).event}get onPointerUp(){return this.disposables.add(new event_1.DomEmitter(this.el,touch_1.EventType.End)).event}dispose(){this.disposables.dispose()}}__decorate([decorators_1.memoize],GestureEventFactory.prototype,"onPointerMove",null),__decorate([decorators_1.memoize],GestureEventFactory.prototype,"onPointerUp",null);class OrthogonalPointerEventFactory{constructor(factory){this.factory=factory}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}}__decorate([decorators_1.memoize],OrthogonalPointerEventFactory.prototype,"onPointerMove",null),__decorate([decorators_1.memoize],OrthogonalPointerEventFactory.prototype,"onPointerUp",null);class Sash extends lifecycle_1.Disposable{constructor(container,layoutProvider,options){super(),this.hoverDelay=300,this.hoverDelayer=this._register(new async_1.Delayer(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new event_2.Emitter),this._onDidStart=this._register(new event_2.Emitter),this._onDidChange=this._register(new event_2.Emitter),this._onDidReset=this._register(new event_2.Emitter),this._onDidEnd=this._register(new event_2.Emitter),this.orthogonalStartSashDisposables=this._register(new lifecycle_1.DisposableStore),this.orthogonalStartDragHandleDisposables=this._register(new lifecycle_1.DisposableStore),this.orthogonalEndSashDisposables=this._register(new lifecycle_1.DisposableStore),this.orthogonalEndDragHandleDisposables=this._register(new lifecycle_1.DisposableStore),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=(0,dom_1.append)(container,(0,dom_1.$)(".monaco-sash")),options.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${options.orthogonalEdge}`),platform_1.isMacintosh&&this.el.classList.add("mac");const onMouseDown=this._register(new event_1.DomEmitter(this.el,"mousedown")).event;this._register(onMouseDown((e=>this.onPointerStart(e,new MouseEventFactory)),this));const onMouseDoubleClick=this._register(new event_1.DomEmitter(this.el,"dblclick")).event;this._register(onMouseDoubleClick(this.onPointerDoublePress,this));const onMouseEnter=this._register(new event_1.DomEmitter(this.el,"mouseenter")).event;this._register(onMouseEnter((()=>Sash.onMouseEnter(this))));const onMouseLeave=this._register(new event_1.DomEmitter(this.el,"mouseleave")).event;this._register(onMouseLeave((()=>Sash.onMouseLeave(this)))),this._register(touch_1.Gesture.addTarget(this.el));const onTouchStart=event_2.Event.map(this._register(new event_1.DomEmitter(this.el,touch_1.EventType.Start)).event,(e=>{var _a;return Object.assign(Object.assign({},e),{target:null!==(_a=e.initialTarget)&&void 0!==_a?_a:null})}));this._register(onTouchStart((e=>this.onPointerStart(e,new GestureEventFactory(this.el))),this));const onTap=this._register(new event_1.DomEmitter(this.el,touch_1.EventType.Tap)).event,onDoubleTap=event_2.Event.map(event_2.Event.filter(event_2.Event.debounce(onTap,((res,event)=>{var _a;return{event,count:(null!==(_a=null==res?void 0:res.count)&&void 0!==_a?_a:0)+1}}),250),(({count})=>2===count)),(({event})=>{var _a;return Object.assign(Object.assign({},event),{target:null!==(_a=event.initialTarget)&&void 0!==_a?_a:null})}));this._register(onDoubleTap(this.onPointerDoublePress,this)),"number"==typeof options.size?(this.size=options.size,0===options.orientation?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=4,this._register(onDidChangeGlobalSize.event((size=>{this.size=size,this.layout()})))),this._register(onDidChangeHoverDelay.event((delay=>this.hoverDelay=delay))),this.layoutProvider=layoutProvider,this.orthogonalStartSash=options.orthogonalStartSash,this.orthogonalEndSash=options.orthogonalEndSash,this.orientation=options.orientation||0,1===this.orientation?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",false),this.layout()}get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(state){this._state!==state&&(this.el.classList.toggle("disabled",0===state),this.el.classList.toggle("minimum",1===state),this.el.classList.toggle("maximum",2===state),this._state=state,this.onDidEnablementChange.fire(state))}set orthogonalStartSash(sash){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),sash){const onChange=state=>{this.orthogonalStartDragHandleDisposables.clear(),0!==state&&(this._orthogonalStartDragHandle=(0,dom_1.append)(this.el,(0,dom_1.$)(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add((0,lifecycle_1.toDisposable)((()=>this._orthogonalStartDragHandle.remove()))),this.orthogonalStartDragHandleDisposables.add(new event_1.DomEmitter(this._orthogonalStartDragHandle,"mouseenter")).event((()=>Sash.onMouseEnter(sash)),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new event_1.DomEmitter(this._orthogonalStartDragHandle,"mouseleave")).event((()=>Sash.onMouseLeave(sash)),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(sash.onDidEnablementChange.event(onChange,this)),onChange(sash.state)}this._orthogonalStartSash=sash}set orthogonalEndSash(sash){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),sash){const onChange=state=>{this.orthogonalEndDragHandleDisposables.clear(),0!==state&&(this._orthogonalEndDragHandle=(0,dom_1.append)(this.el,(0,dom_1.$)(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add((0,lifecycle_1.toDisposable)((()=>this._orthogonalEndDragHandle.remove()))),this.orthogonalEndDragHandleDisposables.add(new event_1.DomEmitter(this._orthogonalEndDragHandle,"mouseenter")).event((()=>Sash.onMouseEnter(sash)),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new event_1.DomEmitter(this._orthogonalEndDragHandle,"mouseleave")).event((()=>Sash.onMouseLeave(sash)),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(sash.onDidEnablementChange.event(onChange,this)),onChange(sash.state)}this._orthogonalEndSash=sash}onPointerStart(event,pointerEventFactory){dom_1.EventHelper.stop(event);let isMultisashResize=!1;if(!event.__orthogonalSashEvent){const orthogonalSash=this.getOrthogonalSash(event);orthogonalSash&&(isMultisashResize=!0,event.__orthogonalSashEvent=!0,orthogonalSash.onPointerStart(event,new OrthogonalPointerEventFactory(pointerEventFactory)))}if(this.linkedSash&&!event.__linkedSashEvent&&(event.__linkedSashEvent=!0,this.linkedSash.onPointerStart(event,new OrthogonalPointerEventFactory(pointerEventFactory))),!this.state)return;const iframes=(0,dom_1.getElementsByTagName)("iframe");for(const iframe of iframes)iframe.classList.add("pointer-events-disabled");const startX=event.pageX,startY=event.pageY,altKey=event.altKey,startEvent={startX,currentX:startX,startY,currentY:startY,altKey};this.el.classList.add("active"),this._onDidStart.fire(startEvent);const style=(0,dom_1.createStyleSheet)(this.el),updateStyle=()=>{let cursor="";cursor=isMultisashResize?"all-scroll":1===this.orientation?1===this.state?"s-resize":2===this.state?"n-resize":platform_1.isMacintosh?"row-resize":"ns-resize":1===this.state?"e-resize":2===this.state?"w-resize":platform_1.isMacintosh?"col-resize":"ew-resize",style.textContent=`* { cursor: ${cursor} !important; }`},disposables=new lifecycle_1.DisposableStore;updateStyle(),isMultisashResize||this.onDidEnablementChange.event(updateStyle,null,disposables);pointerEventFactory.onPointerMove((e=>{dom_1.EventHelper.stop(e,!1);const event={startX,currentX:e.pageX,startY,currentY:e.pageY,altKey};this._onDidChange.fire(event)}),null,disposables),pointerEventFactory.onPointerUp((e=>{dom_1.EventHelper.stop(e,!1),this.el.removeChild(style),this.el.classList.remove("active"),this._onDidEnd.fire(),disposables.dispose();for(const iframe of iframes)iframe.classList.remove("pointer-events-disabled")}),null,disposables),disposables.add(pointerEventFactory)}onPointerDoublePress(e){const orthogonalSash=this.getOrthogonalSash(e);orthogonalSash&&orthogonalSash._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(sash,fromLinkedSash=!1){sash.el.classList.contains("active")?(sash.hoverDelayer.cancel(),sash.el.classList.add("hover")):sash.hoverDelayer.trigger((()=>sash.el.classList.add("hover")),sash.hoverDelay).then(void 0,(()=>{})),!fromLinkedSash&&sash.linkedSash&&Sash.onMouseEnter(sash.linkedSash,!0)}static onMouseLeave(sash,fromLinkedSash=!1){sash.hoverDelayer.cancel(),sash.el.classList.remove("hover"),!fromLinkedSash&&sash.linkedSash&&Sash.onMouseLeave(sash.linkedSash,!0)}clearSashHoverState(){Sash.onMouseLeave(this)}layout(){if(0===this.orientation){const verticalProvider=this.layoutProvider;this.el.style.left=verticalProvider.getVerticalSashLeft(this)-this.size/2+"px",verticalProvider.getVerticalSashTop&&(this.el.style.top=verticalProvider.getVerticalSashTop(this)+"px"),verticalProvider.getVerticalSashHeight&&(this.el.style.height=verticalProvider.getVerticalSashHeight(this)+"px")}else{const horizontalProvider=this.layoutProvider;this.el.style.top=horizontalProvider.getHorizontalSashTop(this)-this.size/2+"px",horizontalProvider.getHorizontalSashLeft&&(this.el.style.left=horizontalProvider.getHorizontalSashLeft(this)+"px"),horizontalProvider.getHorizontalSashWidth&&(this.el.style.width=horizontalProvider.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){if(e.target&&e.target instanceof HTMLElement)return e.target.classList.contains("orthogonal-drag-handle")?e.target.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash:void 0}dispose(){super.dispose(),this.el.remove()}}exports.Sash=Sash})),define(__m[347],__M([12]),{}),define(__m[69],__M([1,0,34,7,31,59,325,326,62,10,4,2,16,140,347]),(function(require,exports,browser_1,dom,fastDomNode_1,mouseEvent_1,horizontalScrollbar_1,verticalScrollbar_1,widget_1,async_1,event_1,lifecycle_1,platform,scrollable_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DomScrollableElement=exports.SmoothScrollableElement=exports.ScrollableElement=exports.AbstractScrollableElement=exports.MouseWheelClassifier=void 0;class MouseWheelClassifierItem{constructor(timestamp,deltaX,deltaY){this.timestamp=timestamp,this.deltaX=deltaX,this.deltaY=deltaY,this.score=0}}class MouseWheelClassifier{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(-1===this._front&&-1===this._rear)return!1;let remainingInfluence=1,score=0,iteration=1,index=this._rear;for(;;){const influence=index===this._front?remainingInfluence:Math.pow(2,-iteration);if(remainingInfluence-=influence,score+=this._memory[index].score*influence,index===this._front)break;index=(this._capacity+index-1)%this._capacity,iteration++}return score<=.5}accept(timestamp,deltaX,deltaY){const item=new MouseWheelClassifierItem(timestamp,deltaX,deltaY);item.score=this._computeScore(item),-1===this._front&&-1===this._rear?(this._memory[0]=item,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=item)}_computeScore(item){if(Math.abs(item.deltaX)>0&&Math.abs(item.deltaY)>0)return 1;let score=.5;-1===this._front&&-1===this._rear||this._memory[this._rear];return this._isAlmostInt(item.deltaX)&&this._isAlmostInt(item.deltaY)||(score+=.25),Math.min(Math.max(score,0),1)}_isAlmostInt(value){return Math.abs(Math.round(value)-value)<.01}}exports.MouseWheelClassifier=MouseWheelClassifier,MouseWheelClassifier.INSTANCE=new MouseWheelClassifier;class AbstractScrollableElement extends widget_1.Widget{constructor(element,options,scrollable){super(),this._onScroll=this._register(new event_1.Emitter),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new event_1.Emitter),element.style.overflow="hidden",this._options=function resolveOptions(opts){const result={lazyRender:void 0!==opts.lazyRender&&opts.lazyRender,className:void 0!==opts.className?opts.className:"",useShadows:void 0===opts.useShadows||opts.useShadows,handleMouseWheel:void 0===opts.handleMouseWheel||opts.handleMouseWheel,flipAxes:void 0!==opts.flipAxes&&opts.flipAxes,consumeMouseWheelIfScrollbarIsNeeded:void 0!==opts.consumeMouseWheelIfScrollbarIsNeeded&&opts.consumeMouseWheelIfScrollbarIsNeeded,alwaysConsumeMouseWheel:void 0!==opts.alwaysConsumeMouseWheel&&opts.alwaysConsumeMouseWheel,scrollYToX:void 0!==opts.scrollYToX&&opts.scrollYToX,mouseWheelScrollSensitivity:void 0!==opts.mouseWheelScrollSensitivity?opts.mouseWheelScrollSensitivity:1,fastScrollSensitivity:void 0!==opts.fastScrollSensitivity?opts.fastScrollSensitivity:5,scrollPredominantAxis:void 0===opts.scrollPredominantAxis||opts.scrollPredominantAxis,mouseWheelSmoothScroll:void 0===opts.mouseWheelSmoothScroll||opts.mouseWheelSmoothScroll,arrowSize:void 0!==opts.arrowSize?opts.arrowSize:11,listenOnDomNode:void 0!==opts.listenOnDomNode?opts.listenOnDomNode:null,horizontal:void 0!==opts.horizontal?opts.horizontal:1,horizontalScrollbarSize:void 0!==opts.horizontalScrollbarSize?opts.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==opts.horizontalSliderSize?opts.horizontalSliderSize:0,horizontalHasArrows:void 0!==opts.horizontalHasArrows&&opts.horizontalHasArrows,vertical:void 0!==opts.vertical?opts.vertical:1,verticalScrollbarSize:void 0!==opts.verticalScrollbarSize?opts.verticalScrollbarSize:10,verticalHasArrows:void 0!==opts.verticalHasArrows&&opts.verticalHasArrows,verticalSliderSize:void 0!==opts.verticalSliderSize?opts.verticalSliderSize:0,scrollByPage:void 0!==opts.scrollByPage&&opts.scrollByPage};result.horizontalSliderSize=void 0!==opts.horizontalSliderSize?opts.horizontalSliderSize:result.horizontalScrollbarSize,result.verticalSliderSize=void 0!==opts.verticalSliderSize?opts.verticalSliderSize:result.verticalScrollbarSize,platform.isMacintosh&&(result.className+=" mac");return result}(options),this._scrollable=scrollable,this._register(this._scrollable.onScroll((e=>{this._onWillScroll.fire(e),this._onDidScroll(e),this._onScroll.fire(e)})));const scrollbarHost={onMouseWheel:mouseWheelEvent=>this._onMouseWheel(mouseWheelEvent),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new verticalScrollbar_1.VerticalScrollbar(this._scrollable,this._options,scrollbarHost)),this._horizontalScrollbar=this._register(new horizontalScrollbar_1.HorizontalScrollbar(this._scrollable,this._options,scrollbarHost)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(element),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,(e=>this._onMouseOver(e))),this.onnonbubblingmouseout(this._listenOnDomNode,(e=>this._onMouseOut(e))),this._hideTimeout=this._register(new async_1.TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=(0,lifecycle_1.dispose)(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarMouseDown(browserEvent){this._verticalScrollbar.delegateMouseDown(browserEvent)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(dimensions){this._scrollable.setScrollDimensions(dimensions,!1)}updateClassName(newClassName){this._options.className=newClassName,platform.isMacintosh&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(newOptions){void 0!==newOptions.handleMouseWheel&&(this._options.handleMouseWheel=newOptions.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),void 0!==newOptions.mouseWheelScrollSensitivity&&(this._options.mouseWheelScrollSensitivity=newOptions.mouseWheelScrollSensitivity),void 0!==newOptions.fastScrollSensitivity&&(this._options.fastScrollSensitivity=newOptions.fastScrollSensitivity),void 0!==newOptions.scrollPredominantAxis&&(this._options.scrollPredominantAxis=newOptions.scrollPredominantAxis),void 0!==newOptions.horizontal&&(this._options.horizontal=newOptions.horizontal),void 0!==newOptions.vertical&&(this._options.vertical=newOptions.vertical),void 0!==newOptions.horizontalScrollbarSize&&(this._options.horizontalScrollbarSize=newOptions.horizontalScrollbarSize),void 0!==newOptions.verticalScrollbarSize&&(this._options.verticalScrollbarSize=newOptions.verticalScrollbarSize),void 0!==newOptions.scrollByPage&&(this._options.scrollByPage=newOptions.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}_setListeningToMouseWheel(shouldListen){if(this._mouseWheelToDispose.length>0!==shouldListen&&(this._mouseWheelToDispose=(0,lifecycle_1.dispose)(this._mouseWheelToDispose),shouldListen)){const onMouseWheel=browserEvent=>{this._onMouseWheel(new mouseEvent_1.StandardWheelEvent(browserEvent))};this._mouseWheelToDispose.push(dom.addDisposableListener(this._listenOnDomNode,dom.EventType.MOUSE_WHEEL,onMouseWheel,{passive:!1}))}}_onMouseWheel(e){const classifier=MouseWheelClassifier.INSTANCE;{const osZoomFactor=window.devicePixelRatio/(0,browser_1.getZoomFactor)();platform.isWindows||platform.isLinux?classifier.accept(Date.now(),e.deltaX/osZoomFactor,e.deltaY/osZoomFactor):classifier.accept(Date.now(),e.deltaX,e.deltaY)}let didScroll=!1;if(e.deltaY||e.deltaX){let deltaY=e.deltaY*this._options.mouseWheelScrollSensitivity,deltaX=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(Math.abs(deltaY)>=Math.abs(deltaX)?deltaX=0:deltaY=0),this._options.flipAxes&&([deltaY,deltaX]=[deltaX,deltaY]);const shiftConvert=!platform.isMacintosh&&e.browserEvent&&e.browserEvent.shiftKey;!this._options.scrollYToX&&!shiftConvert||deltaX||(deltaX=deltaY,deltaY=0),e.browserEvent&&e.browserEvent.altKey&&(deltaX*=this._options.fastScrollSensitivity,deltaY*=this._options.fastScrollSensitivity);const futureScrollPosition=this._scrollable.getFutureScrollPosition();let desiredScrollPosition={};if(deltaY){const deltaScrollTop=50*deltaY,desiredScrollTop=futureScrollPosition.scrollTop-(deltaScrollTop<0?Math.floor(deltaScrollTop):Math.ceil(deltaScrollTop));this._verticalScrollbar.writeScrollPosition(desiredScrollPosition,desiredScrollTop)}if(deltaX){const deltaScrollLeft=50*deltaX,desiredScrollLeft=futureScrollPosition.scrollLeft-(deltaScrollLeft<0?Math.floor(deltaScrollLeft):Math.ceil(deltaScrollLeft));this._horizontalScrollbar.writeScrollPosition(desiredScrollPosition,desiredScrollLeft)}if(desiredScrollPosition=this._scrollable.validateScrollPosition(desiredScrollPosition),futureScrollPosition.scrollLeft!==desiredScrollPosition.scrollLeft||futureScrollPosition.scrollTop!==desiredScrollPosition.scrollTop){this._options.mouseWheelSmoothScroll&&classifier.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(desiredScrollPosition):this._scrollable.setScrollPositionNow(desiredScrollPosition),didScroll=!0}}let consumeMouseWheel=didScroll;!consumeMouseWheel&&this._options.alwaysConsumeMouseWheel&&(consumeMouseWheel=!0),!consumeMouseWheel&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(consumeMouseWheel=!0),consumeMouseWheel&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const scrollState=this._scrollable.getCurrentScrollPosition(),enableTop=scrollState.scrollTop>0,enableLeft=scrollState.scrollLeft>0,leftClassName=enableLeft?" left":"",topClassName=enableTop?" top":"",topLeftClassName=enableLeft||enableTop?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${leftClassName}`),this._topShadowDomNode.setClassName(`shadow${topClassName}`),this._topLeftShadowDomNode.setClassName(`shadow${topLeftClassName}${topClassName}${leftClassName}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseOut(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet((()=>this._hide()),500)}}exports.AbstractScrollableElement=AbstractScrollableElement;exports.ScrollableElement=class ScrollableElement extends AbstractScrollableElement{constructor(element,options){(options=options||{}).mouseWheelSmoothScroll=!1;const scrollable=new scrollable_1.Scrollable({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:callback=>dom.scheduleAtNextAnimationFrame(callback)});super(element,options,scrollable),this._register(scrollable)}setScrollPosition(update){this._scrollable.setScrollPositionNow(update)}};exports.SmoothScrollableElement=class SmoothScrollableElement extends AbstractScrollableElement{constructor(element,options,scrollable){super(element,options,scrollable)}setScrollPosition(update){update.reuseAnimation?this._scrollable.setScrollPositionSmooth(update,update.reuseAnimation):this._scrollable.setScrollPositionNow(update)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};exports.DomScrollableElement=class DomScrollableElement extends AbstractScrollableElement{constructor(element,options){(options=options||{}).mouseWheelSmoothScroll=!1;const scrollable=new scrollable_1.Scrollable({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:callback=>dom.scheduleAtNextAnimationFrame(callback)});super(element,options,scrollable),this._register(scrollable),this._element=element,this.onScroll((e=>{e.scrollTopChanged&&(this._element.scrollTop=e.scrollTop),e.scrollLeftChanged&&(this._element.scrollLeft=e.scrollLeft)})),this.scanDomNode()}setScrollPosition(update){this._scrollable.setScrollPositionNow(update)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}})),define(__m[230],__M([1,0,7,44,69,2,339]),(function(require,exports,dom,keyboardEvent_1,scrollableElement_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HoverAction=exports.HoverWidget=void 0;const $=dom.$;class HoverWidget extends lifecycle_1.Disposable{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new scrollableElement_1.DomScrollableElement(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}}exports.HoverWidget=HoverWidget;class HoverAction extends lifecycle_1.Disposable{constructor(parent,actionOptions,keybindingLabel){super(),this.actionContainer=dom.append(parent,$("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=dom.append(this.actionContainer,$("a.action")),this.action.setAttribute("role","button"),actionOptions.iconClass&&dom.append(this.action,$(`span.icon.${actionOptions.iconClass}`));dom.append(this.action,$("span")).textContent=keybindingLabel?`${actionOptions.label} (${keybindingLabel})`:actionOptions.label,this._register(dom.addDisposableListener(this.actionContainer,dom.EventType.CLICK,(e=>{e.stopPropagation(),e.preventDefault(),actionOptions.run(this.actionContainer)}))),this._register(dom.addDisposableListener(this.actionContainer,dom.EventType.KEY_UP,(e=>{new keyboardEvent_1.StandardKeyboardEvent(e).equals(3)&&(e.stopPropagation(),e.preventDefault(),actionOptions.run(this.actionContainer))}))),this.setEnabled(!0)}static render(parent,actionOptions,keybindingLabel){return new HoverAction(parent,actionOptions,keybindingLabel)}setEnabled(enabled){enabled?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}exports.HoverAction=HoverAction})),define(__m[175],__M([1,0,34,166,7,92,60,69,18,10,95,4,2,40,139,140,318,324]),(function(require,exports,browser_1,dnd_1,dom_1,event_1,touch_1,scrollableElement_1,arrays_1,async_1,decorators_1,event_2,lifecycle_1,objects_1,range_1,scrollable_1,rangeMap_1,rowCache_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ListView=exports.NativeDragAndDropData=exports.ExternalElementsDragAndDropData=exports.ElementsDragAndDropData=void 0;const DefaultOptions={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements:e=>[e],getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class ElementsDragAndDropData{constructor(elements){this.elements=elements}update(){}getData(){return this.elements}}exports.ElementsDragAndDropData=ElementsDragAndDropData;class ExternalElementsDragAndDropData{constructor(elements){this.elements=elements}update(){}getData(){return this.elements}}exports.ExternalElementsDragAndDropData=ExternalElementsDragAndDropData;class NativeDragAndDropData{constructor(){this.types=[],this.files=[]}update(dataTransfer){if(dataTransfer.types&&this.types.splice(0,this.types.length,...dataTransfer.types),dataTransfer.files){this.files.splice(0,this.files.length);for(let i=0;i<dataTransfer.files.length;i++){const file=dataTransfer.files.item(i);file&&(file.size||file.type)&&this.files.push(file)}}}getData(){return{types:this.types,files:this.files}}}exports.NativeDragAndDropData=NativeDragAndDropData;class ListViewAccessibilityProvider{constructor(accessibilityProvider){(null==accessibilityProvider?void 0:accessibilityProvider.getSetSize)?this.getSetSize=accessibilityProvider.getSetSize.bind(accessibilityProvider):this.getSetSize=(e,i,l)=>l,(null==accessibilityProvider?void 0:accessibilityProvider.getPosInSet)?this.getPosInSet=accessibilityProvider.getPosInSet.bind(accessibilityProvider):this.getPosInSet=(e,i)=>i+1,(null==accessibilityProvider?void 0:accessibilityProvider.getRole)?this.getRole=accessibilityProvider.getRole.bind(accessibilityProvider):this.getRole=_=>"listitem",(null==accessibilityProvider?void 0:accessibilityProvider.isChecked)?this.isChecked=accessibilityProvider.isChecked.bind(accessibilityProvider):this.isChecked=_=>{}}}class ListView{constructor(container,virtualDelegate,renderers,options=DefaultOptions){if(this.virtualDelegate=virtualDelegate,this.domId="list_id_"+ ++ListView.InstanceCount,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new async_1.Delayer(50),this.splicing=!1,this.dragOverAnimationStopDisposable=lifecycle_1.Disposable.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=lifecycle_1.Disposable.None,this.onDragLeaveTimeout=lifecycle_1.Disposable.None,this.disposables=new lifecycle_1.DisposableStore,this._onDidChangeContentHeight=new event_2.Emitter,this._horizontalScrolling=!1,options.horizontalScrolling&&options.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new rangeMap_1.RangeMap;for(const renderer of renderers)this.renderers.set(renderer.templateId,renderer);this.cache=this.disposables.add(new rowCache_1.RowCache(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support","boolean"!=typeof options.mouseSupport||options.mouseSupport),this._horizontalScrolling=(0,objects_1.getOrDefault)(options,(o=>o.horizontalScrolling),DefaultOptions.horizontalScrolling),this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.additionalScrollHeight=void 0===options.additionalScrollHeight?0:options.additionalScrollHeight,this.accessibilityProvider=new ListViewAccessibilityProvider(options.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows";(0,objects_1.getOrDefault)(options,(o=>o.transformOptimization),DefaultOptions.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)"),this.disposables.add(touch_1.Gesture.addTarget(this.rowsContainer)),this.scrollable=new scrollable_1.Scrollable({forceIntegerValues:!0,smoothScrollDuration:(0,objects_1.getOrDefault)(options,(o=>o.smoothScrolling),!1)?125:0,scheduleAtNextAnimationFrame:cb=>(0,dom_1.scheduleAtNextAnimationFrame)(cb)}),this.scrollableElement=this.disposables.add(new scrollableElement_1.SmoothScrollableElement(this.rowsContainer,{alwaysConsumeMouseWheel:(0,objects_1.getOrDefault)(options,(o=>o.alwaysConsumeMouseWheel),DefaultOptions.alwaysConsumeMouseWheel),horizontal:1,vertical:(0,objects_1.getOrDefault)(options,(o=>o.verticalScrollMode),DefaultOptions.verticalScrollMode),useShadows:(0,objects_1.getOrDefault)(options,(o=>o.useShadows),DefaultOptions.useShadows),mouseWheelScrollSensitivity:options.mouseWheelScrollSensitivity,fastScrollSensitivity:options.fastScrollSensitivity},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),container.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add((0,dom_1.addDisposableListener)(this.rowsContainer,touch_1.EventType.Change,(e=>this.onTouchChange(e)))),this.disposables.add((0,dom_1.addDisposableListener)(this.scrollableElement.getDomNode(),"scroll",(e=>e.target.scrollTop=0))),this.disposables.add((0,dom_1.addDisposableListener)(this.domNode,"dragover",(e=>this.onDragOver(this.toDragEvent(e))))),this.disposables.add((0,dom_1.addDisposableListener)(this.domNode,"drop",(e=>this.onDrop(this.toDragEvent(e))))),this.disposables.add((0,dom_1.addDisposableListener)(this.domNode,"dragleave",(e=>this.onDragLeave(this.toDragEvent(e))))),this.disposables.add((0,dom_1.addDisposableListener)(this.domNode,"dragend",(e=>this.onDragEnd(e)))),this.setRowLineHeight=(0,objects_1.getOrDefault)(options,(o=>o.setRowLineHeight),DefaultOptions.setRowLineHeight),this.setRowHeight=(0,objects_1.getOrDefault)(options,(o=>o.setRowHeight),DefaultOptions.setRowHeight),this.supportDynamicHeights=(0,objects_1.getOrDefault)(options,(o=>o.supportDynamicHeights),DefaultOptions.supportDynamicHeights),this.dnd=(0,objects_1.getOrDefault)(options,(o=>o.dnd),DefaultOptions.dnd),this.layout()}get contentHeight(){return this.rangeMap.size}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(value){if(value!==this._horizontalScrolling){if(value&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=value,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const item of this.items)this.measureItemWidth(item);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:(0,dom_1.getContentWidth)(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(options){void 0!==options.additionalScrollHeight&&(this.additionalScrollHeight=options.additionalScrollHeight,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),void 0!==options.smoothScrolling&&this.scrollable.setSmoothScrollDuration(options.smoothScrolling?125:0),void 0!==options.horizontalScrolling&&(this.horizontalScrolling=options.horizontalScrolling),void 0!==options.mouseWheelScrollSensitivity&&this.scrollableElement.updateOptions({mouseWheelScrollSensitivity:options.mouseWheelScrollSensitivity}),void 0!==options.fastScrollSensitivity&&this.scrollableElement.updateOptions({fastScrollSensitivity:options.fastScrollSensitivity})}splice(start,deleteCount,elements=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(start,deleteCount,elements)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(start,deleteCount,elements=[]){const previousRenderRange=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),deleteRange={start,end:start+deleteCount},removeRange=range_1.Range.intersect(previousRenderRange,deleteRange),rowsToDispose=new Map;for(let i=removeRange.end-1;i>=removeRange.start;i--){const item=this.items[i];if(item.dragStartDisposable.dispose(),item.row){let rows=rowsToDispose.get(item.templateId);rows||(rows=[],rowsToDispose.set(item.templateId,rows));const renderer=this.renderers.get(item.templateId);renderer&&renderer.disposeElement&&renderer.disposeElement(item.element,i,item.row.templateData,item.size),rows.push(item.row)}item.row=null}const previousRestRange={start:start+deleteCount,end:this.items.length},previousRenderedRestRange=range_1.Range.intersect(previousRestRange,previousRenderRange),previousUnrenderedRestRanges=range_1.Range.relativeComplement(previousRestRange,previousRenderRange),inserted=elements.map((element=>({id:String(this.itemId++),element,templateId:this.virtualDelegate.getTemplateId(element),size:this.virtualDelegate.getHeight(element),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(element),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:lifecycle_1.Disposable.None,checkedDisposable:lifecycle_1.Disposable.None})));let deleted;0===start&&deleteCount>=this.items.length?(this.rangeMap=new rangeMap_1.RangeMap,this.rangeMap.splice(0,0,inserted),deleted=this.items,this.items=inserted):(this.rangeMap.splice(start,deleteCount,inserted),deleted=this.items.splice(start,deleteCount,...inserted));const delta=elements.length-deleteCount,renderRange=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),renderedRestRange=(0,rangeMap_1.shift)(previousRenderedRestRange,delta),updateRange=range_1.Range.intersect(renderRange,renderedRestRange);for(let i=updateRange.start;i<updateRange.end;i++)this.updateItemInDOM(this.items[i],i);const removeRanges=range_1.Range.relativeComplement(renderedRestRange,renderRange);for(const range of removeRanges)for(let i=range.start;i<range.end;i++)this.removeItemFromDOM(i);const unrenderedRestRanges=previousUnrenderedRestRanges.map((r=>(0,rangeMap_1.shift)(r,delta))),insertRanges=[{start,end:start+elements.length},...unrenderedRestRanges].map((r=>range_1.Range.intersect(renderRange,r))),beforeElement=this.getNextToLastElement(insertRanges);for(const range of insertRanges)for(let i=range.start;i<range.end;i++){const item=this.items[i],rows=rowsToDispose.get(item.templateId),row=null==rows?void 0:rows.pop();this.insertItemInDOM(i,beforeElement,row)}for(const rows of rowsToDispose.values())for(const row of rows)this.cache.release(row);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),deleted.map((i=>i.element))}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=(0,dom_1.scheduleAtNextAnimationFrame)((()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null})))}eventuallyUpdateScrollWidth(){this.horizontalScrolling?this.scrollableElementWidthDelayer.trigger((()=>this.updateScrollWidth())):this.scrollableElementWidthDelayer.cancel()}updateScrollWidth(){if(!this.horizontalScrolling)return;let scrollWidth=0;for(const item of this.items)void 0!==item.width&&(scrollWidth=Math.max(scrollWidth,item.width));this.scrollWidth=scrollWidth,this.scrollableElement.setScrollDimensions({scrollWidth:0===scrollWidth?0:scrollWidth+10})}rerender(){if(this.supportDynamicHeights){for(const item of this.items)item.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}element(index){return this.items[index].element}domElement(index){const row=this.items[index].row;return row&&row.domNode}elementHeight(index){return this.items[index].size}elementTop(index){return this.rangeMap.positionAt(index)}indexAt(position){return this.rangeMap.indexAt(position)}indexAfter(position){return this.rangeMap.indexAfter(position)}layout(height,width){let scrollDimensions={height:"number"==typeof height?height:(0,dom_1.getContentHeight)(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,scrollDimensions.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(scrollDimensions),void 0!==width&&(this.renderWidth=width,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:"number"==typeof width?width:(0,dom_1.getContentWidth)(this.domNode)})}render(previousRenderRange,renderTop,renderHeight,renderLeft,scrollWidth,updateItemsInDOM=!1){const renderRange=this.getRenderRange(renderTop,renderHeight),rangesToInsert=range_1.Range.relativeComplement(renderRange,previousRenderRange),rangesToRemove=range_1.Range.relativeComplement(previousRenderRange,renderRange),beforeElement=this.getNextToLastElement(rangesToInsert);if(updateItemsInDOM){const rangesToUpdate=range_1.Range.intersect(previousRenderRange,renderRange);for(let i=rangesToUpdate.start;i<rangesToUpdate.end;i++)this.updateItemInDOM(this.items[i],i)}for(const range of rangesToInsert)for(let i=range.start;i<range.end;i++)this.insertItemInDOM(i,beforeElement);for(const range of rangesToRemove)for(let i=range.start;i<range.end;i++)this.removeItemFromDOM(i);void 0!==renderLeft&&(this.rowsContainer.style.left=`-${renderLeft}px`),this.rowsContainer.style.top=`-${renderTop}px`,this.horizontalScrolling&&void 0!==scrollWidth&&(this.rowsContainer.style.width=`${Math.max(scrollWidth,this.renderWidth)}px`),this.lastRenderTop=renderTop,this.lastRenderHeight=renderHeight}insertItemInDOM(index,beforeElement,row){const item=this.items[index];item.row||(item.row=null!=row?row:this.cache.alloc(item.templateId));const role=this.accessibilityProvider.getRole(item.element)||"listitem";item.row.domNode.setAttribute("role",role);const checked=this.accessibilityProvider.isChecked(item.element);if("boolean"==typeof checked)item.row.domNode.setAttribute("aria-checked",String(!!checked));else if(checked){const update=checked=>item.row.domNode.setAttribute("aria-checked",String(!!checked));update(checked.value),item.checkedDisposable=checked.onDidChange(update)}item.row.domNode.parentElement||(beforeElement?this.rowsContainer.insertBefore(item.row.domNode,beforeElement):this.rowsContainer.appendChild(item.row.domNode)),this.updateItemInDOM(item,index);const renderer=this.renderers.get(item.templateId);if(!renderer)throw new Error(`No renderer found for template id ${item.templateId}`);renderer&&renderer.renderElement(item.element,index,item.row.templateData,item.size);const uri=this.dnd.getDragURI(item.element);item.dragStartDisposable.dispose(),item.row.domNode.draggable=!!uri,uri&&(item.dragStartDisposable=(0,dom_1.addDisposableListener)(item.row.domNode,"dragstart",(event=>this.onDragStart(item.element,uri,event)))),this.horizontalScrolling&&(this.measureItemWidth(item),this.eventuallyUpdateScrollWidth())}measureItemWidth(item){if(!item.row||!item.row.domNode)return;item.row.domNode.style.width=browser_1.isFirefox?"-moz-fit-content":"fit-content",item.width=(0,dom_1.getContentWidth)(item.row.domNode);const style=window.getComputedStyle(item.row.domNode);style.paddingLeft&&(item.width+=parseFloat(style.paddingLeft)),style.paddingRight&&(item.width+=parseFloat(style.paddingRight)),item.row.domNode.style.width=""}updateItemInDOM(item,index){item.row.domNode.style.top=`${this.elementTop(index)}px`,this.setRowHeight&&(item.row.domNode.style.height=`${item.size}px`),this.setRowLineHeight&&(item.row.domNode.style.lineHeight=`${item.size}px`),item.row.domNode.setAttribute("data-index",`${index}`),item.row.domNode.setAttribute("data-last-element",index===this.length-1?"true":"false"),item.row.domNode.setAttribute("data-parity",index%2==0?"even":"odd"),item.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(item.element,index,this.length))),item.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(item.element,index))),item.row.domNode.setAttribute("id",this.getElementDomId(index)),item.row.domNode.classList.toggle("drop-target",item.dropTarget)}removeItemFromDOM(index){const item=this.items[index];if(item.dragStartDisposable.dispose(),item.checkedDisposable.dispose(),item.row){const renderer=this.renderers.get(item.templateId);renderer&&renderer.disposeElement&&renderer.disposeElement(item.element,index,item.row.templateData,item.size),this.cache.release(item.row),item.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(scrollTop,reuseAnimation){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop,reuseAnimation})}get scrollTop(){return this.getScrollTop()}set scrollTop(scrollTop){this.setScrollTop(scrollTop)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.additionalScrollHeight}get onMouseClick(){return event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"click")).event,(e=>this.toMouseEvent(e)))}get onMouseDblClick(){return event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"dblclick")).event,(e=>this.toMouseEvent(e)))}get onMouseMiddleClick(){return event_2.Event.filter(event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"auxclick")).event,(e=>this.toMouseEvent(e))),(e=>1===e.browserEvent.button))}get onMouseDown(){return event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"mousedown")).event,(e=>this.toMouseEvent(e)))}get onContextMenu(){return event_2.Event.any(event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"contextmenu")).event,(e=>this.toMouseEvent(e))),event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,touch_1.EventType.Contextmenu)).event,(e=>this.toGestureEvent(e))))}get onTouchStart(){return event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.domNode,"touchstart")).event,(e=>this.toTouchEvent(e)))}get onTap(){return event_2.Event.map(this.disposables.add(new event_1.DomEmitter(this.rowsContainer,touch_1.EventType.Tap)).event,(e=>this.toGestureEvent(e)))}toMouseEvent(browserEvent){const index=this.getItemIndexFromEventTarget(browserEvent.target||null),item=void 0===index?void 0:this.items[index];return{browserEvent,index,element:item&&item.element}}toTouchEvent(browserEvent){const index=this.getItemIndexFromEventTarget(browserEvent.target||null),item=void 0===index?void 0:this.items[index];return{browserEvent,index,element:item&&item.element}}toGestureEvent(browserEvent){const index=this.getItemIndexFromEventTarget(browserEvent.initialTarget||null),item=void 0===index?void 0:this.items[index];return{browserEvent,index,element:item&&item.element}}toDragEvent(browserEvent){const index=this.getItemIndexFromEventTarget(browserEvent.target||null),item=void 0===index?void 0:this.items[index];return{browserEvent,index,element:item&&item.element}}onScroll(e){try{const previousRenderRange=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(previousRenderRange,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(err){throw console.error("Got bad scroll event:",e),err}}onTouchChange(event){event.preventDefault(),event.stopPropagation(),this.scrollTop-=event.translationY}onDragStart(element,uri,event){if(!event.dataTransfer)return;const elements=this.dnd.getDragElements(element);if(event.dataTransfer.effectAllowed="copyMove",event.dataTransfer.setData(dnd_1.DataTransfers.TEXT,uri),event.dataTransfer.setDragImage){let label;this.dnd.getDragLabel&&(label=this.dnd.getDragLabel(elements,event)),void 0===label&&(label=String(elements.length));const dragImage=(0,dom_1.$)(".monaco-drag-image");dragImage.textContent=label,document.body.appendChild(dragImage),event.dataTransfer.setDragImage(dragImage,-10,-10),setTimeout((()=>document.body.removeChild(dragImage)),0)}this.currentDragData=new ElementsDragAndDropData(elements),dnd_1.StaticDND.CurrentDragAndDropData=new ExternalElementsDragAndDropData(elements),this.dnd.onDragStart&&this.dnd.onDragStart(this.currentDragData,event)}onDragOver(event){if(event.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),dnd_1.StaticDND.CurrentDragAndDropData&&"vscode-ui"===dnd_1.StaticDND.CurrentDragAndDropData.getData())return!1;if(this.setupDragAndDropScrollTopAnimation(event.browserEvent),!event.browserEvent.dataTransfer)return!1;if(!this.currentDragData)if(dnd_1.StaticDND.CurrentDragAndDropData)this.currentDragData=dnd_1.StaticDND.CurrentDragAndDropData;else{if(!event.browserEvent.dataTransfer.types)return!1;this.currentDragData=new NativeDragAndDropData}const result=this.dnd.onDragOver(this.currentDragData,event.element,event.index,event.browserEvent);if(this.canDrop="boolean"==typeof result?result:result.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;let feedback;if(event.browserEvent.dataTransfer.dropEffect="boolean"!=typeof result&&0===result.effect?"copy":"move",feedback="boolean"!=typeof result&&result.feedback?result.feedback:void 0===event.index?[-1]:[event.index],feedback=(0,arrays_1.distinct)(feedback).filter((i=>i>=-1&&i<this.length)).sort(((a,b)=>a-b)),feedback=-1===feedback[0]?[-1]:feedback,function equalsDragFeedback(f1,f2){return Array.isArray(f1)&&Array.isArray(f2)?(0,arrays_1.equals)(f1,f2):f1===f2}(this.currentDragFeedback,feedback))return!0;if(this.currentDragFeedback=feedback,this.currentDragFeedbackDisposable.dispose(),-1===feedback[0])this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=(0,lifecycle_1.toDisposable)((()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")}));else{for(const index of feedback){const item=this.items[index];item.dropTarget=!0,item.row&&item.row.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=(0,lifecycle_1.toDisposable)((()=>{for(const index of feedback){const item=this.items[index];item.dropTarget=!1,item.row&&item.row.domNode.classList.remove("drop-target")}}))}return!0}onDragLeave(event){var _a,_b;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=(0,async_1.disposableTimeout)((()=>this.clearDragOverFeedback()),100),this.currentDragData&&(null===(_b=(_a=this.dnd).onDragLeave)||void 0===_b||_b.call(_a,this.currentDragData,event.element,event.index,event.browserEvent))}onDrop(event){if(!this.canDrop)return;const dragData=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,dnd_1.StaticDND.CurrentDragAndDropData=void 0,dragData&&event.browserEvent.dataTransfer&&(event.browserEvent.preventDefault(),dragData.update(event.browserEvent.dataTransfer),this.dnd.drop(dragData,event.element,event.index,event.browserEvent))}onDragEnd(event){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,dnd_1.StaticDND.CurrentDragAndDropData=void 0,this.dnd.onDragEnd&&this.dnd.onDragEnd(event)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=lifecycle_1.Disposable.None}setupDragAndDropScrollTopAnimation(event){if(!this.dragOverAnimationDisposable){const viewTop=(0,dom_1.getTopLeftOffset)(this.domNode).top;this.dragOverAnimationDisposable=(0,dom_1.animate)(this.animateDragAndDropScrollTop.bind(this,viewTop))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=(0,async_1.disposableTimeout)((()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}),1e3),this.dragOverMouseY=event.pageY}animateDragAndDropScrollTop(viewTop){if(void 0===this.dragOverMouseY)return;const diff=this.dragOverMouseY-viewTop,upperLimit=this.renderHeight-35;diff<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(diff-35))):diff>upperLimit&&(this.scrollTop+=Math.min(14,Math.floor(.3*(diff-upperLimit))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(target){const scrollableElement=this.scrollableElement.getDomNode();let element=target;for(;element instanceof HTMLElement&&element!==this.rowsContainer&&scrollableElement.contains(element);){const rawIndex=element.getAttribute("data-index");if(rawIndex){const index=Number(rawIndex);if(!isNaN(index))return index}element=element.parentElement}}getRenderRange(renderTop,renderHeight){return{start:this.rangeMap.indexAt(renderTop),end:this.rangeMap.indexAfter(renderTop+renderHeight-1)}}_rerender(renderTop,renderHeight,inSmoothScrolling){const previousRenderRange=this.getRenderRange(renderTop,renderHeight);let anchorElementIndex,anchorElementTopDelta;renderTop===this.elementTop(previousRenderRange.start)?(anchorElementIndex=previousRenderRange.start,anchorElementTopDelta=0):previousRenderRange.end-previousRenderRange.start>1&&(anchorElementIndex=previousRenderRange.start+1,anchorElementTopDelta=this.elementTop(anchorElementIndex)-renderTop);let heightDiff=0;for(;;){const renderRange=this.getRenderRange(renderTop,renderHeight);let didChange=!1;for(let i=renderRange.start;i<renderRange.end;i++){const diff=this.probeDynamicHeight(i);0!==diff&&this.rangeMap.splice(i,1,[this.items[i]]),heightDiff+=diff,didChange=didChange||0!==diff}if(!didChange){0!==heightDiff&&this.eventuallyUpdateScrollDimensions();const unrenderRanges=range_1.Range.relativeComplement(previousRenderRange,renderRange);for(const range of unrenderRanges)for(let i=range.start;i<range.end;i++)this.items[i].row&&this.removeItemFromDOM(i);const renderRanges=range_1.Range.relativeComplement(renderRange,previousRenderRange);for(const range of renderRanges)for(let i=range.start;i<range.end;i++){const afterIndex=i+1,beforeRow=afterIndex<this.items.length?this.items[afterIndex].row:null,beforeElement=beforeRow?beforeRow.domNode:null;this.insertItemInDOM(i,beforeElement)}for(let i=renderRange.start;i<renderRange.end;i++)this.items[i].row&&this.updateItemInDOM(this.items[i],i);if("number"==typeof anchorElementIndex){const deltaScrollTop=this.scrollable.getFutureScrollPosition().scrollTop-renderTop,newScrollTop=this.elementTop(anchorElementIndex)-anchorElementTopDelta+deltaScrollTop;this.setScrollTop(newScrollTop,inSmoothScrolling)}return void this._onDidChangeContentHeight.fire(this.contentHeight)}}}probeDynamicHeight(index){const item=this.items[index];if(this.virtualDelegate.getDynamicHeight){const newSize=this.virtualDelegate.getDynamicHeight(item.element);if(null!==newSize){const size=item.size;return item.size=newSize,item.lastDynamicHeightWidth=this.renderWidth,newSize-size}}if(!item.hasDynamicHeight||item.lastDynamicHeightWidth===this.renderWidth)return 0;if(this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(item.element))return 0;const size=item.size;if(!this.setRowHeight&&item.row){let newSize=item.row.domNode.offsetHeight;return item.size=newSize,item.lastDynamicHeightWidth=this.renderWidth,newSize-size}const row=this.cache.alloc(item.templateId);row.domNode.style.height="",this.rowsContainer.appendChild(row.domNode);const renderer=this.renderers.get(item.templateId);return renderer&&(renderer.renderElement(item.element,index,row.templateData,void 0),renderer.disposeElement&&renderer.disposeElement(item.element,index,row.templateData,void 0)),item.size=row.domNode.offsetHeight,this.virtualDelegate.setDynamicHeight&&this.virtualDelegate.setDynamicHeight(item.element,item.size),item.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(row.domNode),this.cache.release(row),item.size-size}getNextToLastElement(ranges){const lastRange=ranges[ranges.length-1];if(!lastRange)return null;const nextToLastItem=this.items[lastRange.end];return nextToLastItem&&nextToLastItem.row?nextToLastItem.row.domNode:null}getElementDomId(index){return`${this.domId}_${index}`}dispose(){if(this.items){for(const item of this.items)if(item.row){const renderer=this.renderers.get(item.row.templateId);renderer&&(renderer.disposeElement&&renderer.disposeElement(item.element,-1,item.row.templateData,void 0),renderer.disposeTemplate(item.row.templateData))}this.items=[]}this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),(0,lifecycle_1.dispose)(this.disposables)}}ListView.InstanceCount=0,__decorate([decorators_1.memoize],ListView.prototype,"onMouseClick",null),__decorate([decorators_1.memoize],ListView.prototype,"onMouseDblClick",null),__decorate([decorators_1.memoize],ListView.prototype,"onMouseMiddleClick",null),__decorate([decorators_1.memoize],ListView.prototype,"onMouseDown",null),__decorate([decorators_1.memoize],ListView.prototype,"onContextMenu",null),__decorate([decorators_1.memoize],ListView.prototype,"onTouchStart",null),__decorate([decorators_1.memoize],ListView.prototype,"onTap",null),exports.ListView=ListView})),define(__m[117],__M([1,0,7,92,44,60,46,311,18,10,30,95,4,75,2,113,40,16,19,310,175,229]),(function(require,exports,dom_1,event_1,keyboardEvent_1,touch_1,aria_1,splice_1,arrays_1,async_1,color_1,decorators_1,event_2,filters_1,lifecycle_1,numbers_1,objects_1,platform,types_1,list_1,listView_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.List=exports.DefaultStyleController=exports.MouseController=exports.isSelectionRangeChangeEvent=exports.isSelectionSingleChangeEvent=exports.DefaultKeyboardNavigationDelegate=exports.isMonacoEditor=exports.isInputElement=void 0;class TraitRenderer{constructor(trait){this.trait=trait,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(container){return container}renderElement(element,index,templateData){const renderedElementIndex=this.renderedElements.findIndex((el=>el.templateData===templateData));if(renderedElementIndex>=0){const rendered=this.renderedElements[renderedElementIndex];this.trait.unrender(templateData),rendered.index=index}else{const rendered={index,templateData};this.renderedElements.push(rendered)}this.trait.renderIndex(index,templateData)}splice(start,deleteCount,insertCount){const rendered=[];for(const renderedElement of this.renderedElements)renderedElement.index<start?rendered.push(renderedElement):renderedElement.index>=start+deleteCount&&rendered.push({index:renderedElement.index+insertCount-deleteCount,templateData:renderedElement.templateData});this.renderedElements=rendered}renderIndexes(indexes){for(const{index,templateData}of this.renderedElements)indexes.indexOf(index)>-1&&this.trait.renderIndex(index,templateData)}disposeTemplate(templateData){const index=this.renderedElements.findIndex((el=>el.templateData===templateData));index<0||this.renderedElements.splice(index,1)}}class Trait{constructor(_trait){this._trait=_trait,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new event_2.Emitter,this.onChange=this._onChange.event}get name(){return this._trait}get renderer(){return new TraitRenderer(this)}splice(start,deleteCount,elements){var _a;deleteCount=Math.max(0,Math.min(deleteCount,this.length-start));const diff=elements.length-deleteCount,end=start+deleteCount,sortedIndexes=[...this.sortedIndexes.filter((i=>i<start)),...elements.map(((hasTrait,i)=>hasTrait?i+start:-1)).filter((i=>-1!==i)),...this.sortedIndexes.filter((i=>i>=end)).map((i=>i+diff))],length=this.length+diff;if(this.sortedIndexes.length>0&&0===sortedIndexes.length&&length>0){const first=null!==(_a=this.sortedIndexes.find((index=>index>=start)))&&void 0!==_a?_a:length-1;sortedIndexes.push(Math.min(first,length-1))}this.renderer.splice(start,deleteCount,elements.length),this._set(sortedIndexes,sortedIndexes),this.length=length}renderIndex(index,container){container.classList.toggle(this._trait,this.contains(index))}unrender(container){container.classList.remove(this._trait)}set(indexes,browserEvent){return this._set(indexes,[...indexes].sort(numericSort),browserEvent)}_set(indexes,sortedIndexes,browserEvent){const result=this.indexes,sortedResult=this.sortedIndexes;this.indexes=indexes,this.sortedIndexes=sortedIndexes;const toRender=disjunction(sortedResult,indexes);return this.renderer.renderIndexes(toRender),this._onChange.fire({indexes,browserEvent}),result}get(){return this.indexes}contains(index){return(0,arrays_1.binarySearch)(this.sortedIndexes,index,numericSort)>=0}dispose(){(0,lifecycle_1.dispose)(this._onChange)}}__decorate([decorators_1.memoize],Trait.prototype,"renderer",null);class SelectionTrait extends Trait{constructor(setAriaSelected){super("selected"),this.setAriaSelected=setAriaSelected}renderIndex(index,container){super.renderIndex(index,container),this.setAriaSelected&&(this.contains(index)?container.setAttribute("aria-selected","true"):container.setAttribute("aria-selected","false"))}}class TraitSpliceable{constructor(trait,view,identityProvider){this.trait=trait,this.view=view,this.identityProvider=identityProvider}splice(start,deleteCount,elements){if(!this.identityProvider)return this.trait.splice(start,deleteCount,elements.map((()=>!1)));const pastElementsWithTrait=this.trait.get().map((i=>this.identityProvider.getId(this.view.element(i)).toString())),elementsWithTrait=elements.map((e=>pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString())>-1));this.trait.splice(start,deleteCount,elementsWithTrait)}}function isInputElement(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}function isMonacoEditor(e){return!!e.classList.contains("monaco-editor")||!e.classList.contains("monaco-list")&&(!!e.parentElement&&isMonacoEditor(e.parentElement))}exports.isInputElement=isInputElement,exports.isMonacoEditor=isMonacoEditor;class KeyboardController{constructor(list,view,options){this.list=list,this.view=view,this.disposables=new lifecycle_1.DisposableStore,this.multipleSelectionDisposables=new lifecycle_1.DisposableStore,this.onKeyDown.filter((e=>3===e.keyCode)).on(this.onEnter,this,this.disposables),this.onKeyDown.filter((e=>16===e.keyCode)).on(this.onUpArrow,this,this.disposables),this.onKeyDown.filter((e=>18===e.keyCode)).on(this.onDownArrow,this,this.disposables),this.onKeyDown.filter((e=>11===e.keyCode)).on(this.onPageUpArrow,this,this.disposables),this.onKeyDown.filter((e=>12===e.keyCode)).on(this.onPageDownArrow,this,this.disposables),this.onKeyDown.filter((e=>9===e.keyCode)).on(this.onEscape,this,this.disposables),!1!==options.multipleSelectionSupport&&this.onKeyDown.filter((e=>(platform.isMacintosh?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables)}get onKeyDown(){return event_2.Event.chain(this.disposables.add(new event_1.DomEmitter(this.view.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e)))}updateOptions(optionsUpdate){void 0!==optionsUpdate.multipleSelectionSupport&&(this.multipleSelectionDisposables.clear(),optionsUpdate.multipleSelectionSupport&&this.onKeyDown.filter((e=>(platform.isMacintosh?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables))}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const el=this.list.getFocus()[0];this.list.setAnchor(el),this.list.reveal(el),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const el=this.list.getFocus()[0];this.list.setAnchor(el),this.list.reveal(el),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const el=this.list.getFocus()[0];this.list.setAnchor(el),this.list.reveal(el),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const el=this.list.getFocus()[0];this.list.setAnchor(el),this.list.reveal(el),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection((0,arrays_1.range)(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}var TypeLabelControllerState;__decorate([decorators_1.memoize],KeyboardController.prototype,"onKeyDown",null),function(TypeLabelControllerState){TypeLabelControllerState[TypeLabelControllerState.Idle=0]="Idle",TypeLabelControllerState[TypeLabelControllerState.Typing=1]="Typing"}(TypeLabelControllerState||(TypeLabelControllerState={})),exports.DefaultKeyboardNavigationDelegate=new class{mightProducePrintableCharacter(event){return!(event.ctrlKey||event.metaKey||event.altKey)&&(event.keyCode>=31&&event.keyCode<=56||event.keyCode>=21&&event.keyCode<=30||event.keyCode>=93&&event.keyCode<=102||event.keyCode>=80&&event.keyCode<=90)}};class TypeLabelController{constructor(list,view,keyboardNavigationLabelProvider,delegate){this.list=list,this.view=view,this.keyboardNavigationLabelProvider=keyboardNavigationLabelProvider,this.delegate=delegate,this.enabled=!1,this.state=TypeLabelControllerState.Idle,this.automaticKeyboardNavigation=!0,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new lifecycle_1.DisposableStore,this.disposables=new lifecycle_1.DisposableStore,this.updateOptions(list.options)}updateOptions(options){void 0===options.enableKeyboardNavigation||!!options.enableKeyboardNavigation?this.enable():this.disable(),void 0!==options.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=options.automaticKeyboardNavigation)}enable(){if(this.enabled)return;const onChar=event_2.Event.chain(this.enabledDisposables.add(new event_1.DomEmitter(this.view.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).filter((()=>this.automaticKeyboardNavigation||this.triggered)).map((event=>new keyboardEvent_1.StandardKeyboardEvent(event))).filter((e=>this.delegate.mightProducePrintableCharacter(e))).forEach((e=>e.preventDefault())).map((event=>event.browserEvent.key)).event,onClear=event_2.Event.debounce(onChar,(()=>null),800);event_2.Event.reduce(event_2.Event.any(onChar,onClear),((r,i)=>null===i?null:(r||"")+i))(this.onInput,this,this.enabledDisposables),onClear(this.onClear,this,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var _a;const focus=this.list.getFocus();if(focus.length>0&&focus[0]===this.previouslyFocused){const ariaLabel=null===(_a=this.list.options.accessibilityProvider)||void 0===_a?void 0:_a.getAriaLabel(this.list.element(focus[0]));ariaLabel&&(0,aria_1.alert)(ariaLabel)}this.previouslyFocused=-1}onInput(word){if(!word)return this.state=TypeLabelControllerState.Idle,void(this.triggered=!1);const focus=this.list.getFocus(),start=focus.length>0?focus[0]:0,delta=this.state===TypeLabelControllerState.Idle?1:0;this.state=TypeLabelControllerState.Typing;for(let i=0;i<this.list.length;i++){const index=(start+i+delta)%this.list.length,label=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index)),labelStr=label&&label.toString();if(void 0===labelStr||(0,filters_1.matchesPrefix)(word,labelStr))return this.previouslyFocused=start,this.list.setFocus([index]),void this.list.reveal(index)}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class DOMFocusController{constructor(list,view){this.list=list,this.view=view,this.disposables=new lifecycle_1.DisposableStore;event_2.Event.chain(this.disposables.add(new event_1.DomEmitter(view.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e))).filter((e=>!(2!==e.keyCode||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey))).on(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const focus=this.list.getFocus();if(0===focus.length)return;const focusedDomElement=this.view.domElement(focus[0]);if(!focusedDomElement)return;const tabIndexElement=focusedDomElement.querySelector("[tabIndex]");if(!(tabIndexElement&&tabIndexElement instanceof HTMLElement&&-1!==tabIndexElement.tabIndex))return;const style=window.getComputedStyle(tabIndexElement);"hidden"!==style.visibility&&"none"!==style.display&&(e.preventDefault(),e.stopPropagation(),tabIndexElement.focus())}dispose(){this.disposables.dispose()}}function isSelectionSingleChangeEvent(event){return platform.isMacintosh?event.browserEvent.metaKey:event.browserEvent.ctrlKey}function isSelectionRangeChangeEvent(event){return event.browserEvent.shiftKey}exports.isSelectionSingleChangeEvent=isSelectionSingleChangeEvent,exports.isSelectionRangeChangeEvent=isSelectionRangeChangeEvent;const DefaultMultipleSelectionController={isSelectionSingleChangeEvent,isSelectionRangeChangeEvent};class MouseController{constructor(list){this.list=list,this.disposables=new lifecycle_1.DisposableStore,this._onPointer=new event_2.Emitter,this.onPointer=this._onPointer.event,!1!==list.options.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController),this.mouseSupport=void 0===list.options.mouseSupport||!!list.options.mouseSupport,this.mouseSupport&&(list.onMouseDown(this.onMouseDown,this,this.disposables),list.onContextMenu(this.onContextMenu,this,this.disposables),list.onMouseDblClick(this.onDoubleClick,this,this.disposables),list.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(touch_1.Gesture.addTarget(list.getHTMLElement()))),event_2.Event.any(list.onMouseClick,list.onMouseMiddleClick,list.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(optionsUpdate){void 0!==optionsUpdate.multipleSelectionSupport&&(this.multipleSelectionController=void 0,optionsUpdate.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController))}isSelectionSingleChangeEvent(event){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionSingleChangeEvent(event)}isSelectionRangeChangeEvent(event){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionRangeChangeEvent(event)}isSelectionChangeEvent(event){return this.isSelectionSingleChangeEvent(event)||this.isSelectionRangeChangeEvent(event)}onMouseDown(e){isMonacoEditor(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(isMonacoEditor(e.browserEvent.target))return;const focus=void 0===e.index?[]:[e.index];this.list.setFocus(focus,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport)return;if(isInputElement(e.browserEvent.target)||isMonacoEditor(e.browserEvent.target))return;const focus=e.index;return void 0===focus?(this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),void this.list.setAnchor(void 0)):this.isSelectionRangeChangeEvent(e)||this.isSelectionChangeEvent(e)?this.changeSelection(e):(this.list.setFocus([focus],e.browserEvent),this.list.setAnchor(focus),function isMouseRightClick(event){return event instanceof MouseEvent&&2===event.button}(e.browserEvent)||this.list.setSelection([focus],e.browserEvent),void this._onPointer.fire(e))}onDoubleClick(e){if(isInputElement(e.browserEvent.target)||isMonacoEditor(e.browserEvent.target))return;if(this.isSelectionChangeEvent(e))return;const focus=this.list.getFocus();this.list.setSelection(focus,e.browserEvent)}changeSelection(e){const focus=e.index;let anchor=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(void 0===anchor){const currentFocus=this.list.getFocus()[0];anchor=null!=currentFocus?currentFocus:focus,this.list.setAnchor(anchor)}const min=Math.min(anchor,focus),max=Math.max(anchor,focus),rangeSelection=(0,arrays_1.range)(min,max+1),selection=this.list.getSelection(),contiguousRange=function getContiguousRangeContaining(range,value){const index=range.indexOf(value);if(-1===index)return[];const result=[];let i=index-1;for(;i>=0&&range[i]===value-(index-i);)result.push(range[i--]);result.reverse(),i=index;for(;i<range.length&&range[i]===value+(i-index);)result.push(range[i++]);return result}(disjunction(selection,[anchor]),anchor);if(0===contiguousRange.length)return;const newSelection=disjunction(rangeSelection,function relativeComplement(one,other){const result=[];let i=0,j=0;for(;i<one.length||j<other.length;)if(i>=one.length)result.push(other[j++]);else if(j>=other.length)result.push(one[i++]);else{if(one[i]===other[j]){i++,j++;continue}one[i]<other[j]?result.push(one[i++]):j++}return result}(selection,contiguousRange));this.list.setSelection(newSelection,e.browserEvent),this.list.setFocus([focus],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const selection=this.list.getSelection(),newSelection=selection.filter((i=>i!==focus));this.list.setFocus([focus]),this.list.setAnchor(focus),selection.length===newSelection.length?this.list.setSelection([...newSelection,focus],e.browserEvent):this.list.setSelection(newSelection,e.browserEvent)}}dispose(){this.disposables.dispose()}}exports.MouseController=MouseController;class DefaultStyleController{constructor(styleElement,selectorSuffix){this.styleElement=styleElement,this.selectorSuffix=selectorSuffix}style(styles){const suffix=this.selectorSuffix&&`.${this.selectorSuffix}`,content=[];styles.listBackground&&(styles.listBackground.isOpaque()?content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`):platform.isMacintosh||console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`)),styles.listFocusBackground&&(content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`),content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`)),styles.listFocusForeground&&content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`),styles.listActiveSelectionBackground&&(content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`),content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`)),styles.listActiveSelectionForeground&&content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`),styles.listActiveSelectionIconForeground&&content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected .codicon { color: ${styles.listActiveSelectionIconForeground}; }`),styles.listFocusAndSelectionBackground&&content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`),styles.listFocusAndSelectionForeground&&content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`),styles.listInactiveFocusForeground&&(content.push(`.monaco-list${suffix} .monaco-list-row.focused { color:  ${styles.listInactiveFocusForeground}; }`),content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { color:  ${styles.listInactiveFocusForeground}; }`)),styles.listInactiveSelectionIconForeground&&content.push(`.monaco-list${suffix} .monaco-list-row.focused .codicon { color:  ${styles.listInactiveSelectionIconForeground}; }`),styles.listInactiveFocusBackground&&(content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`),content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`)),styles.listInactiveSelectionBackground&&(content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`),content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`)),styles.listInactiveSelectionForeground&&content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`),styles.listHoverBackground&&content.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${styles.listHoverBackground}; }`),styles.listHoverForeground&&content.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`),styles.listSelectionOutline&&content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`),styles.listFocusOutline&&content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${suffix}.last-focused .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`),styles.listInactiveFocusOutline&&content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`),styles.listHoverOutline&&content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`),styles.listDropBackground&&content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`),styles.listFilterWidgetBackground&&content.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`),styles.listFilterWidgetOutline&&content.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`),styles.listFilterWidgetNoMatchesOutline&&content.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`),styles.listMatchesShadow&&content.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`),styles.tableColumnsBorder&&content.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${styles.tableColumnsBorder};\n\t\t\t}`),styles.tableOddRowsBackgroundColor&&content.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${styles.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`),this.styleElement.textContent=content.join("\n")}}exports.DefaultStyleController=DefaultStyleController;const defaultStyles={listFocusBackground:color_1.Color.fromHex("#7FB0D0"),listActiveSelectionBackground:color_1.Color.fromHex("#0E639C"),listActiveSelectionForeground:color_1.Color.fromHex("#FFFFFF"),listActiveSelectionIconForeground:color_1.Color.fromHex("#FFFFFF"),listFocusAndSelectionBackground:color_1.Color.fromHex("#094771"),listFocusAndSelectionForeground:color_1.Color.fromHex("#FFFFFF"),listInactiveSelectionBackground:color_1.Color.fromHex("#3F3F46"),listInactiveSelectionIconForeground:color_1.Color.fromHex("#FFFFFF"),listHoverBackground:color_1.Color.fromHex("#2A2D2E"),listDropBackground:color_1.Color.fromHex("#383B3D"),treeIndentGuidesStroke:color_1.Color.fromHex("#a9a9a9"),tableColumnsBorder:color_1.Color.fromHex("#cccccc").transparent(.2),tableOddRowsBackgroundColor:color_1.Color.fromHex("#cccccc").transparent(.04)},DefaultOptions={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}}};function disjunction(one,other){const result=[];let i=0,j=0;for(;i<one.length||j<other.length;)if(i>=one.length)result.push(other[j++]);else if(j>=other.length)result.push(one[i++]);else{if(one[i]===other[j]){result.push(one[i]),i++,j++;continue}one[i]<other[j]?result.push(one[i++]):result.push(other[j++])}return result}const numericSort=(a,b)=>a-b;class PipelineRenderer{constructor(_templateId,renderers){this._templateId=_templateId,this.renderers=renderers}get templateId(){return this._templateId}renderTemplate(container){return this.renderers.map((r=>r.renderTemplate(container)))}renderElement(element,index,templateData,height){let i=0;for(const renderer of this.renderers)renderer.renderElement(element,index,templateData[i++],height)}disposeElement(element,index,templateData,height){let i=0;for(const renderer of this.renderers)renderer.disposeElement&&renderer.disposeElement(element,index,templateData[i],height),i+=1}disposeTemplate(templateData){let i=0;for(const renderer of this.renderers)renderer.disposeTemplate(templateData[i++])}}class AccessibiltyRenderer{constructor(accessibilityProvider){this.accessibilityProvider=accessibilityProvider,this.templateId="a18n"}renderTemplate(container){return container}renderElement(element,index,container){const ariaLabel=this.accessibilityProvider.getAriaLabel(element);ariaLabel?container.setAttribute("aria-label",ariaLabel):container.removeAttribute("aria-label");const ariaLevel=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(element);"number"==typeof ariaLevel?container.setAttribute("aria-level",`${ariaLevel}`):container.removeAttribute("aria-level")}disposeTemplate(templateData){}}class ListViewDragAndDrop{constructor(list,dnd){this.list=list,this.dnd=dnd}getDragElements(element){const selection=this.list.getSelectedElements();return selection.indexOf(element)>-1?selection:[element]}getDragURI(element){return this.dnd.getDragURI(element)}getDragLabel(elements,originalEvent){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(elements,originalEvent)}onDragStart(data,originalEvent){this.dnd.onDragStart&&this.dnd.onDragStart(data,originalEvent)}onDragOver(data,targetElement,targetIndex,originalEvent){return this.dnd.onDragOver(data,targetElement,targetIndex,originalEvent)}onDragLeave(data,targetElement,targetIndex,originalEvent){var _a,_b;null===(_b=(_a=this.dnd).onDragLeave)||void 0===_b||_b.call(_a,data,targetElement,targetIndex,originalEvent)}onDragEnd(originalEvent){this.dnd.onDragEnd&&this.dnd.onDragEnd(originalEvent)}drop(data,targetElement,targetIndex,originalEvent){this.dnd.drop(data,targetElement,targetIndex,originalEvent)}}class List{constructor(user,container,virtualDelegate,renderers,_options=DefaultOptions){var _a;this.user=user,this._options=_options,this.focus=new Trait("focused"),this.anchor=new Trait("anchor"),this.eventBufferer=new event_2.EventBufferer,this._ariaLabel="",this.disposables=new lifecycle_1.DisposableStore,this._onDidDispose=new event_2.Emitter,this.onDidDispose=this._onDidDispose.event;const role=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?null===(_a=this._options.accessibilityProvider)||void 0===_a?void 0:_a.getWidgetRole():"list";this.selection=new SelectionTrait("listbox"!==role),(0,objects_1.mixin)(_options,defaultStyles,!1);const baseRenderers=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=_options.accessibilityProvider,this.accessibilityProvider&&(baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant&&this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant,this,this.disposables)),renderers=renderers.map((r=>new PipelineRenderer(r.templateId,[...baseRenderers,r])));const viewOptions=Object.assign(Object.assign({},_options),{dnd:_options.dnd&&new ListViewDragAndDrop(this,_options.dnd)});if(this.view=new listView_1.ListView(container,virtualDelegate,renderers,viewOptions),this.view.domNode.setAttribute("role",role),_options.styleController)this.styleController=_options.styleController(this.view.domId);else{const styleElement=(0,dom_1.createStyleSheet)(this.view.domNode);this.styleController=new DefaultStyleController(styleElement,this.view.domId)}if(this.spliceable=new splice_1.CombinedSpliceable([new TraitSpliceable(this.focus,this.view,_options.identityProvider),new TraitSpliceable(this.selection,this.view,_options.identityProvider),new TraitSpliceable(this.anchor,this.view,_options.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new DOMFocusController(this,this.view)),("boolean"!=typeof _options.keyboardSupport||_options.keyboardSupport)&&(this.keyboardController=new KeyboardController(this,this.view,_options),this.disposables.add(this.keyboardController)),_options.keyboardNavigationLabelProvider){const delegate=_options.keyboardNavigationDelegate||exports.DefaultKeyboardNavigationDelegate;this.typeLabelController=new TypeLabelController(this,this.view,_options.keyboardNavigationLabelProvider,delegate),this.disposables.add(this.typeLabelController)}this.mouseController=this.createMouseController(_options),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),!1!==this._options.multipleSelectionSupport&&this.view.domNode.setAttribute("aria-multiselectable","true")}get onDidChangeFocus(){return event_2.Event.map(this.eventBufferer.wrapEvent(this.focus.onChange),(e=>this.toListEvent(e)))}get onDidChangeSelection(){return event_2.Event.map(this.eventBufferer.wrapEvent(this.selection.onChange),(e=>this.toListEvent(e)))}get domId(){return this.view.domId}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let didJustPressContextMenuKey=!1;const fromKeyDown=event_2.Event.chain(this.disposables.add(new event_1.DomEmitter(this.view.domNode,"keydown")).event).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e))).filter((e=>didJustPressContextMenuKey=58===e.keyCode||e.shiftKey&&68===e.keyCode)).map(event_1.stopEvent).filter((()=>!1)).event,fromKeyUp=event_2.Event.chain(this.disposables.add(new event_1.DomEmitter(this.view.domNode,"keyup")).event).forEach((()=>didJustPressContextMenuKey=!1)).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e))).filter((e=>58===e.keyCode||e.shiftKey&&68===e.keyCode)).map(event_1.stopEvent).map((({browserEvent})=>{const focus=this.getFocus(),index=focus.length?focus[0]:void 0;return{index,element:void 0!==index?this.view.element(index):void 0,anchor:void 0!==index?this.view.domElement(index):this.view.domNode,browserEvent}})).event,fromMouse=event_2.Event.chain(this.view.onContextMenu).filter((_=>!didJustPressContextMenuKey)).map((({element,index,browserEvent})=>({element,index,anchor:{x:browserEvent.pageX+1,y:browserEvent.pageY},browserEvent}))).event;return event_2.Event.any(fromKeyDown,fromKeyUp,fromMouse)}get onKeyDown(){return this.disposables.add(new event_1.DomEmitter(this.view.domNode,"keydown")).event}get onDidFocus(){return event_2.Event.signal(this.disposables.add(new event_1.DomEmitter(this.view.domNode,"focus",!0)).event)}createMouseController(options){return new MouseController(this)}updateOptions(optionsUpdate={}){var _a;this._options=Object.assign(Object.assign({},this._options),optionsUpdate),this.typeLabelController&&this.typeLabelController.updateOptions(this._options),void 0!==this._options.multipleSelectionController&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(optionsUpdate),null===(_a=this.keyboardController)||void 0===_a||_a.updateOptions(optionsUpdate),this.view.updateOptions(optionsUpdate)}get options(){return this._options}splice(start,deleteCount,elements=[]){if(start<0||start>this.view.length)throw new list_1.ListError(this.user,`Invalid start index: ${start}`);if(deleteCount<0)throw new list_1.ListError(this.user,`Invalid delete count: ${deleteCount}`);0===deleteCount&&0===elements.length||this.eventBufferer.bufferEvents((()=>this.spliceable.splice(start,deleteCount,elements)))}rerender(){this.view.rerender()}element(index){return this.view.element(index)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(scrollTop){this.view.setScrollTop(scrollTop)}get ariaLabel(){return this._ariaLabel}set ariaLabel(value){this._ariaLabel=value,this.view.domNode.setAttribute("aria-label",value)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(height,width){this.view.layout(height,width)}setSelection(indexes,browserEvent){for(const index of indexes)if(index<0||index>=this.length)throw new list_1.ListError(this.user,`Invalid index ${index}`);this.selection.set(indexes,browserEvent)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map((i=>this.view.element(i)))}setAnchor(index){if(void 0!==index){if(index<0||index>=this.length)throw new list_1.ListError(this.user,`Invalid index ${index}`);this.anchor.set([index])}else this.anchor.set([])}getAnchor(){return(0,arrays_1.firstOrDefault)(this.anchor.get(),void 0)}getAnchorElement(){const anchor=this.getAnchor();return void 0===anchor?void 0:this.element(anchor)}setFocus(indexes,browserEvent){for(const index of indexes)if(index<0||index>=this.length)throw new list_1.ListError(this.user,`Invalid index ${index}`);this.focus.set(indexes,browserEvent)}focusNext(n=1,loop=!1,browserEvent,filter){if(0===this.length)return;const focus=this.focus.get(),index=this.findNextIndex(focus.length>0?focus[0]+n:0,loop,filter);index>-1&&this.setFocus([index],browserEvent)}focusPrevious(n=1,loop=!1,browserEvent,filter){if(0===this.length)return;const focus=this.focus.get(),index=this.findPreviousIndex(focus.length>0?focus[0]-n:0,loop,filter);index>-1&&this.setFocus([index],browserEvent)}focusNextPage(browserEvent,filter){return __awaiter(this,void 0,void 0,(function*(){let lastPageIndex=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);lastPageIndex=0===lastPageIndex?0:lastPageIndex-1;const lastPageElement=this.view.element(lastPageIndex),currentlyFocusedElement=this.getFocusedElements()[0];if(currentlyFocusedElement!==lastPageElement){const lastGoodPageIndex=this.findPreviousIndex(lastPageIndex,!1,filter);lastGoodPageIndex>-1&&currentlyFocusedElement!==this.view.element(lastGoodPageIndex)?this.setFocus([lastGoodPageIndex],browserEvent):this.setFocus([lastPageIndex],browserEvent)}else{const previousScrollTop=this.view.getScrollTop();this.view.setScrollTop(previousScrollTop+this.view.renderHeight-this.view.elementHeight(lastPageIndex)),this.view.getScrollTop()!==previousScrollTop&&(this.setFocus([]),yield(0,async_1.timeout)(0),yield this.focusNextPage(browserEvent,filter))}}))}focusPreviousPage(browserEvent,filter){return __awaiter(this,void 0,void 0,(function*(){let firstPageIndex;const scrollTop=this.view.getScrollTop();firstPageIndex=0===scrollTop?this.view.indexAt(scrollTop):this.view.indexAfter(scrollTop-1);const firstPageElement=this.view.element(firstPageIndex),currentlyFocusedElement=this.getFocusedElements()[0];if(currentlyFocusedElement!==firstPageElement){const firstGoodPageIndex=this.findNextIndex(firstPageIndex,!1,filter);firstGoodPageIndex>-1&&currentlyFocusedElement!==this.view.element(firstGoodPageIndex)?this.setFocus([firstGoodPageIndex],browserEvent):this.setFocus([firstPageIndex],browserEvent)}else{const previousScrollTop=scrollTop;this.view.setScrollTop(scrollTop-this.view.renderHeight),this.view.getScrollTop()!==previousScrollTop&&(this.setFocus([]),yield(0,async_1.timeout)(0),yield this.focusPreviousPage(browserEvent,filter))}}))}focusLast(browserEvent,filter){if(0===this.length)return;const index=this.findPreviousIndex(this.length-1,!1,filter);index>-1&&this.setFocus([index],browserEvent)}focusFirst(browserEvent,filter){this.focusNth(0,browserEvent,filter)}focusNth(n,browserEvent,filter){if(0===this.length)return;const index=this.findNextIndex(n,!1,filter);index>-1&&this.setFocus([index],browserEvent)}findNextIndex(index,loop=!1,filter){for(let i=0;i<this.length;i++){if(index>=this.length&&!loop)return-1;if(index%=this.length,!filter||filter(this.element(index)))return index;index++}return-1}findPreviousIndex(index,loop=!1,filter){for(let i=0;i<this.length;i++){if(index<0&&!loop)return-1;if(index=(this.length+index%this.length)%this.length,!filter||filter(this.element(index)))return index;index--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map((i=>this.view.element(i)))}reveal(index,relativeTop){if(index<0||index>=this.length)throw new list_1.ListError(this.user,`Invalid index ${index}`);const scrollTop=this.view.getScrollTop(),elementTop=this.view.elementTop(index),elementHeight=this.view.elementHeight(index);if((0,types_1.isNumber)(relativeTop)){const m=elementHeight-this.view.renderHeight;this.view.setScrollTop(m*(0,numbers_1.clamp)(relativeTop,0,1)+elementTop)}else{const viewItemBottom=elementTop+elementHeight,scrollBottom=scrollTop+this.view.renderHeight;elementTop<scrollTop&&viewItemBottom>=scrollBottom||(elementTop<scrollTop||viewItemBottom>=scrollBottom&&elementHeight>=this.view.renderHeight?this.view.setScrollTop(elementTop):viewItemBottom>=scrollBottom&&this.view.setScrollTop(viewItemBottom-this.view.renderHeight))}}getRelativeTop(index){if(index<0||index>=this.length)throw new list_1.ListError(this.user,`Invalid index ${index}`);const scrollTop=this.view.getScrollTop(),elementTop=this.view.elementTop(index),elementHeight=this.view.elementHeight(index);if(elementTop<scrollTop||elementTop+elementHeight>scrollTop+this.view.renderHeight)return null;const m=elementHeight-this.view.renderHeight;return Math.abs((scrollTop-elementTop)/m)}getHTMLElement(){return this.view.domNode}style(styles){this.styleController.style(styles)}toListEvent({indexes,browserEvent}){return{indexes,elements:indexes.map((i=>this.view.element(i))),browserEvent}}_onFocusChange(){const focus=this.focus.get();this.view.domNode.classList.toggle("element-focused",focus.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var _a;const focus=this.focus.get();if(focus.length>0){let id;(null===(_a=this.accessibilityProvider)||void 0===_a?void 0:_a.getActiveDescendantId)&&(id=this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]))),this.view.domNode.setAttribute("aria-activedescendant",id||this.view.getElementDomId(focus[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const selection=this.selection.get();this.view.domNode.classList.toggle("selection-none",0===selection.length),this.view.domNode.classList.toggle("selection-single",1===selection.length),this.view.domNode.classList.toggle("selection-multiple",selection.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}__decorate([decorators_1.memoize],List.prototype,"onDidChangeFocus",null),__decorate([decorators_1.memoize],List.prototype,"onDidChangeSelection",null),__decorate([decorators_1.memoize],List.prototype,"onContextMenu",null),__decorate([decorators_1.memoize],List.prototype,"onKeyDown",null),__decorate([decorators_1.memoize],List.prototype,"onDidFocus",null),exports.List=List})),define(__m[348],__M([1,0,18,21,4,2,117,229]),(function(require,exports,arrays_1,cancellation_1,event_1,lifecycle_1,listWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PagedList=void 0;class PagedRenderer{constructor(renderer,modelProvider){this.renderer=renderer,this.modelProvider=modelProvider}get templateId(){return this.renderer.templateId}renderTemplate(container){return{data:this.renderer.renderTemplate(container),disposable:lifecycle_1.Disposable.None}}renderElement(index,_,data,height){if(data.disposable&&data.disposable.dispose(),!data.data)return;const model=this.modelProvider();if(model.isResolved(index))return this.renderer.renderElement(model.get(index),index,data.data,height);const cts=new cancellation_1.CancellationTokenSource,promise=model.resolve(index,cts.token);data.disposable={dispose:()=>cts.cancel()},this.renderer.renderPlaceholder(index,data.data),promise.then((entry=>this.renderer.renderElement(entry,index,data.data,height)))}disposeTemplate(data){data.disposable&&(data.disposable.dispose(),data.disposable=void 0),data.data&&(this.renderer.disposeTemplate(data.data),data.data=void 0)}}class PagedAccessibilityProvider{constructor(modelProvider,accessibilityProvider){this.modelProvider=modelProvider,this.accessibilityProvider=accessibilityProvider}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(index){const model=this.modelProvider();return model.isResolved(index)?this.accessibilityProvider.getAriaLabel(model.get(index)):null}}exports.PagedList=class PagedList{constructor(user,container,virtualDelegate,renderers,options={}){const modelProvider=()=>this.model,pagedRenderers=renderers.map((r=>new PagedRenderer(r,modelProvider)));this.list=new listWidget_1.List(user,container,virtualDelegate,pagedRenderers,function fromPagedListOptions(modelProvider,options){return Object.assign(Object.assign({},options),{accessibilityProvider:options.accessibilityProvider&&new PagedAccessibilityProvider(modelProvider,options.accessibilityProvider)})}(modelProvider,options))}updateOptions(options){this.list.updateOptions(options)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return event_1.Event.map(this.list.onMouseDblClick,(({element,index,browserEvent})=>({element:void 0===element?void 0:this._model.get(element),index,browserEvent})))}get onPointer(){return event_1.Event.map(this.list.onPointer,(({element,index,browserEvent})=>({element:void 0===element?void 0:this._model.get(element),index,browserEvent})))}get onDidChangeSelection(){return event_1.Event.map(this.list.onDidChangeSelection,(({elements,indexes,browserEvent})=>({elements:elements.map((e=>this._model.get(e))),indexes,browserEvent})))}get model(){return this._model}set model(model){this._model=model,this.list.splice(0,this.list.length,(0,arrays_1.range)(model.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map((i=>this.model.get(i)))}style(styles){this.list.style(styles)}dispose(){this.list.dispose()}}})),define(__m[349],__M([12]),{}),define(__m[231],__M([1,0,7,116,69,18,30,4,2,113,140,19,349]),(function(require,exports,dom_1,sash_1,scrollableElement_1,arrays_1,color_1,event_1,lifecycle_1,numbers_1,scrollable_1,types){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SplitView=exports.Sizing=void 0;const defaultStyles={separatorBorder:color_1.Color.transparent};class ViewItem{constructor(container,view,size,disposable){this.container=container,this.view=view,this.disposable=disposable,this._cachedVisibleSize=void 0,"number"==typeof size?(this._size=size,this._cachedVisibleSize=void 0,container.classList.add("visible")):(this._size=0,this._cachedVisibleSize=size.cachedVisibleSize)}set size(size){this._size=size}get size(){return this._size}get visible(){return void 0===this._cachedVisibleSize}setVisible(visible,size){visible!==this.visible&&(visible?(this.size=(0,numbers_1.clamp)(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize="number"==typeof size?size:this.size,this.size=0),this.container.classList.toggle("visible",visible),this.view.setVisible&&this.view.setVisible(visible))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(enabled){this.container.style.pointerEvents=enabled?"":"none"}layout(offset,layoutContext){this.layoutContainer(offset),this.view.layout(this.size,offset,layoutContext)}dispose(){return this.disposable.dispose(),this.view}}class VerticalViewItem extends ViewItem{layoutContainer(offset){this.container.style.top=`${offset}px`,this.container.style.height=`${this.size}px`}}class HorizontalViewItem extends ViewItem{layoutContainer(offset){this.container.style.left=`${offset}px`,this.container.style.width=`${this.size}px`}}var State;!function(State){State[State.Idle=0]="Idle",State[State.Busy=1]="Busy"}(State||(State={})),function(Sizing){Sizing.Distribute={type:"distribute"},Sizing.Split=function Split(index){return{type:"split",index}},Sizing.Invisible=function Invisible(cachedVisibleSize){return{type:"invisible",cachedVisibleSize}}}(exports.Sizing||(exports.Sizing={}));class SplitView extends lifecycle_1.Disposable{constructor(container,options={}){var _a,_b,_c,_d,_e;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=State.Idle,this._onDidSashChange=this._register(new event_1.Emitter),this._onDidSashReset=this._register(new event_1.Emitter),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=null!==(_a=options.orientation)&&void 0!==_a?_a:0,this.inverseAltBehavior=null!==(_b=options.inverseAltBehavior)&&void 0!==_b&&_b,this.proportionalLayout=null===(_c=options.proportionalLayout)||void 0===_c||_c,this.getSashOrthogonalSize=options.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(0===this.orientation?"vertical":"horizontal"),container.appendChild(this.el),this.sashContainer=(0,dom_1.append)(this.el,(0,dom_1.$)(".sash-container")),this.viewContainer=(0,dom_1.$)(".split-view-container"),this.scrollable=new scrollable_1.Scrollable({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:dom_1.scheduleAtNextAnimationFrame}),this.scrollableElement=this._register(new scrollableElement_1.SmoothScrollableElement(this.viewContainer,{vertical:0===this.orientation?null!==(_d=options.scrollbarVisibility)&&void 0!==_d?_d:1:2,horizontal:1===this.orientation?null!==(_e=options.scrollbarVisibility)&&void 0!==_e?_e:1:2},this.scrollable)),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll((e=>{this.viewContainer.scrollTop=e.scrollTop,this.viewContainer.scrollLeft=e.scrollLeft}))),(0,dom_1.append)(this.el,this.scrollableElement.getDomNode()),this.style(options.styles||defaultStyles),options.descriptor&&(this.size=options.descriptor.size,options.descriptor.views.forEach(((viewDescriptor,index)=>{const sizing=types.isUndefined(viewDescriptor.visible)||viewDescriptor.visible?viewDescriptor.size:{type:"invisible",cachedVisibleSize:viewDescriptor.size},view=viewDescriptor.view;this.doAddView(view,sizing,index,!0)})),this.contentSize=this.viewItems.reduce(((r,i)=>r+i.size),0),this.saveProportions())}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(sash){for(const sashItem of this.sashItems)sashItem.sash.orthogonalStartSash=sash;this._orthogonalStartSash=sash}set orthogonalEndSash(sash){for(const sashItem of this.sashItems)sashItem.sash.orthogonalEndSash=sash;this._orthogonalEndSash=sash}set startSnappingEnabled(startSnappingEnabled){this._startSnappingEnabled!==startSnappingEnabled&&(this._startSnappingEnabled=startSnappingEnabled,this.updateSashEnablement())}set endSnappingEnabled(endSnappingEnabled){this._endSnappingEnabled!==endSnappingEnabled&&(this._endSnappingEnabled=endSnappingEnabled,this.updateSashEnablement())}style(styles){styles.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",styles.separatorBorder.toString()))}addView(view,size,index=this.viewItems.length,skipLayout){this.doAddView(view,size,index,skipLayout)}layout(size,layoutContext){const previousSize=Math.max(this.size,this.contentSize);if(this.size=size,this.layoutContext=layoutContext,this.proportions)for(let i=0;i<this.viewItems.length;i++){const item=this.viewItems[i];item.size=(0,numbers_1.clamp)(Math.round(this.proportions[i]*size),item.minimumSize,item.maximumSize)}else{const indexes=(0,arrays_1.range)(this.viewItems.length),lowPriorityIndexes=indexes.filter((i=>1===this.viewItems[i].priority)),highPriorityIndexes=indexes.filter((i=>2===this.viewItems[i].priority));this.resize(this.viewItems.length-1,size-previousSize,void 0,lowPriorityIndexes,highPriorityIndexes)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map((i=>i.size/this.contentSize)))}onSashStart({sash,start,alt}){for(const item of this.viewItems)item.enabled=!1;const index=this.sashItems.findIndex((item=>item.sash===sash)),disposable=(0,lifecycle_1.combinedDisposable)((0,dom_1.addDisposableListener)(document.body,"keydown",(e=>resetSashDragState(this.sashDragState.current,e.altKey))),(0,dom_1.addDisposableListener)(document.body,"keyup",(()=>resetSashDragState(this.sashDragState.current,!1)))),resetSashDragState=(start,alt)=>{const sizes=this.viewItems.map((i=>i.size));let snapBefore,snapAfter,minDelta=Number.NEGATIVE_INFINITY,maxDelta=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(alt=!alt),alt){if(index===this.sashItems.length-1){const viewItem=this.viewItems[index];minDelta=(viewItem.minimumSize-viewItem.size)/2,maxDelta=(viewItem.maximumSize-viewItem.size)/2}else{const viewItem=this.viewItems[index+1];minDelta=(viewItem.size-viewItem.maximumSize)/2,maxDelta=(viewItem.size-viewItem.minimumSize)/2}}if(!alt){const upIndexes=(0,arrays_1.range)(index,-1),downIndexes=(0,arrays_1.range)(index+1,this.viewItems.length),minDeltaUp=upIndexes.reduce(((r,i)=>r+(this.viewItems[i].minimumSize-sizes[i])),0),maxDeltaUp=upIndexes.reduce(((r,i)=>r+(this.viewItems[i].viewMaximumSize-sizes[i])),0),maxDeltaDown=0===downIndexes.length?Number.POSITIVE_INFINITY:downIndexes.reduce(((r,i)=>r+(sizes[i]-this.viewItems[i].minimumSize)),0),minDeltaDown=0===downIndexes.length?Number.NEGATIVE_INFINITY:downIndexes.reduce(((r,i)=>r+(sizes[i]-this.viewItems[i].viewMaximumSize)),0),minDelta=Math.max(minDeltaUp,minDeltaDown),maxDelta=Math.min(maxDeltaDown,maxDeltaUp),snapBeforeIndex=this.findFirstSnapIndex(upIndexes),snapAfterIndex=this.findFirstSnapIndex(downIndexes);if("number"==typeof snapBeforeIndex){const viewItem=this.viewItems[snapBeforeIndex],halfSize=Math.floor(viewItem.viewMinimumSize/2);snapBefore={index:snapBeforeIndex,limitDelta:viewItem.visible?minDelta-halfSize:minDelta+halfSize,size:viewItem.size}}if("number"==typeof snapAfterIndex){const viewItem=this.viewItems[snapAfterIndex],halfSize=Math.floor(viewItem.viewMinimumSize/2);snapAfter={index:snapAfterIndex,limitDelta:viewItem.visible?maxDelta+halfSize:maxDelta-halfSize,size:viewItem.size}}}this.sashDragState={start,current:start,index,sizes,minDelta,maxDelta,alt,snapBefore,snapAfter,disposable}};resetSashDragState(start,alt)}onSashChange({current}){const{index,start,sizes,alt,minDelta,maxDelta,snapBefore,snapAfter}=this.sashDragState;this.sashDragState.current=current;const delta=current-start,newDelta=this.resize(index,delta,sizes,void 0,void 0,minDelta,maxDelta,snapBefore,snapAfter);if(alt){const isLastSash=index===this.sashItems.length-1,newSizes=this.viewItems.map((i=>i.size)),viewItemIndex=isLastSash?index:index+1,viewItem=this.viewItems[viewItemIndex],newMinDelta=viewItem.size-viewItem.maximumSize,newMaxDelta=viewItem.size-viewItem.minimumSize,resizeIndex=isLastSash?index-1:index+1;this.resize(resizeIndex,-newDelta,newSizes,void 0,void 0,newMinDelta,newMaxDelta)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(index){this._onDidSashChange.fire(index),this.sashDragState.disposable.dispose(),this.saveProportions();for(const item of this.viewItems)item.enabled=!0}onViewChange(item,size){const index=this.viewItems.indexOf(item);index<0||index>=this.viewItems.length||(size="number"==typeof size?size:item.size,size=(0,numbers_1.clamp)(size,item.minimumSize,item.maximumSize),this.inverseAltBehavior&&index>0?(this.resize(index-1,Math.floor((item.size-size)/2)),this.distributeEmptySpace(),this.layoutViews()):(item.size=size,this.relayout([index],void 0)))}resizeView(index,size){if(this.state!==State.Idle)throw new Error("Cant modify splitview");if(this.state=State.Busy,index<0||index>=this.viewItems.length)return;const indexes=(0,arrays_1.range)(this.viewItems.length).filter((i=>i!==index)),lowPriorityIndexes=[...indexes.filter((i=>1===this.viewItems[i].priority)),index],highPriorityIndexes=indexes.filter((i=>2===this.viewItems[i].priority)),item=this.viewItems[index];size=Math.round(size),size=(0,numbers_1.clamp)(size,item.minimumSize,Math.min(item.maximumSize,this.size)),item.size=size,this.relayout(lowPriorityIndexes,highPriorityIndexes),this.state=State.Idle}distributeViewSizes(){const flexibleViewItems=[];let flexibleSize=0;for(const item of this.viewItems)item.maximumSize-item.minimumSize>0&&(flexibleViewItems.push(item),flexibleSize+=item.size);const size=Math.floor(flexibleSize/flexibleViewItems.length);for(const item of flexibleViewItems)item.size=(0,numbers_1.clamp)(size,item.minimumSize,item.maximumSize);const indexes=(0,arrays_1.range)(this.viewItems.length),lowPriorityIndexes=indexes.filter((i=>1===this.viewItems[i].priority)),highPriorityIndexes=indexes.filter((i=>2===this.viewItems[i].priority));this.relayout(lowPriorityIndexes,highPriorityIndexes)}getViewSize(index){return index<0||index>=this.viewItems.length?-1:this.viewItems[index].size}doAddView(view,size,index=this.viewItems.length,skipLayout){if(this.state!==State.Idle)throw new Error("Cant modify splitview");this.state=State.Busy;const container=(0,dom_1.$)(".split-view-view");index===this.viewItems.length?this.viewContainer.appendChild(container):this.viewContainer.insertBefore(container,this.viewContainer.children.item(index));const onChangeDisposable=view.onDidChange((size=>this.onViewChange(item,size))),containerDisposable=(0,lifecycle_1.toDisposable)((()=>this.viewContainer.removeChild(container))),disposable=(0,lifecycle_1.combinedDisposable)(onChangeDisposable,containerDisposable);let viewSize;viewSize="number"==typeof size?size:"split"===size.type?this.getViewSize(size.index)/2:"invisible"===size.type?{cachedVisibleSize:size.cachedVisibleSize}:view.minimumSize;const item=0===this.orientation?new VerticalViewItem(container,view,viewSize,disposable):new HorizontalViewItem(container,view,viewSize,disposable);if(this.viewItems.splice(index,0,item),this.viewItems.length>1){let opts={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash};const sash=0===this.orientation?new sash_1.Sash(this.sashContainer,{getHorizontalSashTop:s=>this.getSashPosition(s),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},opts),{orientation:1})):new sash_1.Sash(this.sashContainer,{getVerticalSashLeft:s=>this.getSashPosition(s),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},opts),{orientation:0})),sashEventMapper=0===this.orientation?e=>({sash,start:e.startY,current:e.currentY,alt:e.altKey}):e=>({sash,start:e.startX,current:e.currentX,alt:e.altKey}),onStartDisposable=event_1.Event.map(sash.onDidStart,sashEventMapper)(this.onSashStart,this),onChangeDisposable=event_1.Event.map(sash.onDidChange,sashEventMapper)(this.onSashChange,this),onEnd=event_1.Event.map(sash.onDidEnd,(()=>this.sashItems.findIndex((item=>item.sash===sash)))),onEndDisposable=onEnd(this.onSashEnd,this),onDidResetDisposable=sash.onDidReset((()=>{const index=this.sashItems.findIndex((item=>item.sash===sash)),upIndexes=(0,arrays_1.range)(index,-1),downIndexes=(0,arrays_1.range)(index+1,this.viewItems.length),snapBeforeIndex=this.findFirstSnapIndex(upIndexes),snapAfterIndex=this.findFirstSnapIndex(downIndexes);("number"!=typeof snapBeforeIndex||this.viewItems[snapBeforeIndex].visible)&&("number"!=typeof snapAfterIndex||this.viewItems[snapAfterIndex].visible)&&this._onDidSashReset.fire(index)})),disposable=(0,lifecycle_1.combinedDisposable)(onStartDisposable,onChangeDisposable,onEndDisposable,onDidResetDisposable,sash),sashItem={sash,disposable};this.sashItems.splice(index-1,0,sashItem)}let highPriorityIndexes;container.appendChild(view.element),"number"!=typeof size&&"split"===size.type&&(highPriorityIndexes=[size.index]),skipLayout||this.relayout([index],highPriorityIndexes),this.state=State.Idle,skipLayout||"number"==typeof size||"distribute"!==size.type||this.distributeViewSizes()}relayout(lowPriorityIndexes,highPriorityIndexes){const contentSize=this.viewItems.reduce(((r,i)=>r+i.size),0);this.resize(this.viewItems.length-1,this.size-contentSize,void 0,lowPriorityIndexes,highPriorityIndexes),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(index,delta,sizes=this.viewItems.map((i=>i.size)),lowPriorityIndexes,highPriorityIndexes,overloadMinDelta=Number.NEGATIVE_INFINITY,overloadMaxDelta=Number.POSITIVE_INFINITY,snapBefore,snapAfter){if(index<0||index>=this.viewItems.length)return 0;const upIndexes=(0,arrays_1.range)(index,-1),downIndexes=(0,arrays_1.range)(index+1,this.viewItems.length);if(highPriorityIndexes)for(const index of highPriorityIndexes)(0,arrays_1.pushToStart)(upIndexes,index),(0,arrays_1.pushToStart)(downIndexes,index);if(lowPriorityIndexes)for(const index of lowPriorityIndexes)(0,arrays_1.pushToEnd)(upIndexes,index),(0,arrays_1.pushToEnd)(downIndexes,index);const upItems=upIndexes.map((i=>this.viewItems[i])),upSizes=upIndexes.map((i=>sizes[i])),downItems=downIndexes.map((i=>this.viewItems[i])),downSizes=downIndexes.map((i=>sizes[i])),minDeltaUp=upIndexes.reduce(((r,i)=>r+(this.viewItems[i].minimumSize-sizes[i])),0),maxDeltaUp=upIndexes.reduce(((r,i)=>r+(this.viewItems[i].maximumSize-sizes[i])),0),maxDeltaDown=0===downIndexes.length?Number.POSITIVE_INFINITY:downIndexes.reduce(((r,i)=>r+(sizes[i]-this.viewItems[i].minimumSize)),0),minDeltaDown=0===downIndexes.length?Number.NEGATIVE_INFINITY:downIndexes.reduce(((r,i)=>r+(sizes[i]-this.viewItems[i].maximumSize)),0),minDelta=Math.max(minDeltaUp,minDeltaDown,overloadMinDelta),maxDelta=Math.min(maxDeltaDown,maxDeltaUp,overloadMaxDelta);let snapped=!1;if(snapBefore){const snapView=this.viewItems[snapBefore.index],visible=delta>=snapBefore.limitDelta;snapped=visible!==snapView.visible,snapView.setVisible(visible,snapBefore.size)}if(!snapped&&snapAfter){const snapView=this.viewItems[snapAfter.index],visible=delta<snapAfter.limitDelta;snapped=visible!==snapView.visible,snapView.setVisible(visible,snapAfter.size)}if(snapped)return this.resize(index,delta,sizes,lowPriorityIndexes,highPriorityIndexes,overloadMinDelta,overloadMaxDelta);for(let i=0,deltaUp=delta=(0,numbers_1.clamp)(delta,minDelta,maxDelta);i<upItems.length;i++){const item=upItems[i],size=(0,numbers_1.clamp)(upSizes[i]+deltaUp,item.minimumSize,item.maximumSize);deltaUp-=size-upSizes[i],item.size=size}for(let i=0,deltaDown=delta;i<downItems.length;i++){const item=downItems[i],size=(0,numbers_1.clamp)(downSizes[i]-deltaDown,item.minimumSize,item.maximumSize);deltaDown+=size-downSizes[i],item.size=size}return delta}distributeEmptySpace(lowPriorityIndex){const contentSize=this.viewItems.reduce(((r,i)=>r+i.size),0);let emptyDelta=this.size-contentSize;const indexes=(0,arrays_1.range)(this.viewItems.length-1,-1),lowPriorityIndexes=indexes.filter((i=>1===this.viewItems[i].priority)),highPriorityIndexes=indexes.filter((i=>2===this.viewItems[i].priority));for(const index of highPriorityIndexes)(0,arrays_1.pushToStart)(indexes,index);for(const index of lowPriorityIndexes)(0,arrays_1.pushToEnd)(indexes,index);"number"==typeof lowPriorityIndex&&(0,arrays_1.pushToEnd)(indexes,lowPriorityIndex);for(let i=0;0!==emptyDelta&&i<indexes.length;i++){const item=this.viewItems[indexes[i]],size=(0,numbers_1.clamp)(item.size+emptyDelta,item.minimumSize,item.maximumSize);emptyDelta-=size-item.size,item.size=size}}layoutViews(){this.contentSize=this.viewItems.reduce(((r,i)=>r+i.size),0);let offset=0;for(const viewItem of this.viewItems)viewItem.layout(offset,this.layoutContext),offset+=viewItem.size;this.sashItems.forEach((item=>item.sash.layout())),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){0===this.orientation?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let previous=!1;const collapsesDown=this.viewItems.map((i=>previous=i.size-i.minimumSize>0||previous));previous=!1;const expandsDown=this.viewItems.map((i=>previous=i.maximumSize-i.size>0||previous)),reverseViews=[...this.viewItems].reverse();previous=!1;const collapsesUp=reverseViews.map((i=>previous=i.size-i.minimumSize>0||previous)).reverse();previous=!1;const expandsUp=reverseViews.map((i=>previous=i.maximumSize-i.size>0||previous)).reverse();let position=0;for(let index=0;index<this.sashItems.length;index++){const{sash}=this.sashItems[index];position+=this.viewItems[index].size;const min=!(collapsesDown[index]&&expandsUp[index+1]),max=!(expandsDown[index]&&collapsesUp[index+1]);if(min&&max){const upIndexes=(0,arrays_1.range)(index,-1),downIndexes=(0,arrays_1.range)(index+1,this.viewItems.length),snapBeforeIndex=this.findFirstSnapIndex(upIndexes),snapAfterIndex=this.findFirstSnapIndex(downIndexes),snappedBefore="number"==typeof snapBeforeIndex&&!this.viewItems[snapBeforeIndex].visible,snappedAfter="number"==typeof snapAfterIndex&&!this.viewItems[snapAfterIndex].visible;snappedBefore&&collapsesUp[index]&&(position>0||this.startSnappingEnabled)?sash.state=1:snappedAfter&&collapsesDown[index]&&(position<this.contentSize||this.endSnappingEnabled)?sash.state=2:sash.state=0}else sash.state=min&&!max?1:!min&&max?2:3}}getSashPosition(sash){let position=0;for(let i=0;i<this.sashItems.length;i++)if(position+=this.viewItems[i].size,this.sashItems[i].sash===sash)return position;return 0}findFirstSnapIndex(indexes){for(const index of indexes){const viewItem=this.viewItems[index];if(viewItem.visible&&viewItem.snap)return index}for(const index of indexes){const viewItem=this.viewItems[index];if(viewItem.visible&&viewItem.maximumSize-viewItem.minimumSize>0)return;if(!viewItem.visible&&viewItem.snap)return index}}dispose(){super.dispose(),(0,lifecycle_1.dispose)(this.viewItems),this.viewItems=[],this.sashItems.forEach((i=>i.disposable.dispose())),this.sashItems=[]}}exports.SplitView=SplitView})),define(__m[350],__M([12]),{}),define(__m[351],__M([1,0,7,117,231,4,2,350]),(function(require,exports,dom_1,listWidget_1,splitview_1,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Table=void 0;class TableListRenderer{constructor(columns,renderers,getColumnSize){this.columns=columns,this.getColumnSize=getColumnSize,this.templateId=TableListRenderer.TemplateId,this.renderedTemplates=new Set;const rendererMap=new Map(renderers.map((r=>[r.templateId,r])));this.renderers=[];for(const column of columns){const renderer=rendererMap.get(column.templateId);if(!renderer)throw new Error(`Table cell renderer for template id ${column.templateId} not found.`);this.renderers.push(renderer)}}renderTemplate(container){const rowContainer=(0,dom_1.append)(container,(0,dom_1.$)(".monaco-table-tr")),cellContainers=[],cellTemplateData=[];for(let i=0;i<this.columns.length;i++){const renderer=this.renderers[i],cellContainer=(0,dom_1.append)(rowContainer,(0,dom_1.$)(".monaco-table-td",{"data-col-index":i}));cellContainer.style.width=`${this.getColumnSize(i)}px`,cellContainers.push(cellContainer),cellTemplateData.push(renderer.renderTemplate(cellContainer))}const result={container,cellContainers,cellTemplateData};return this.renderedTemplates.add(result),result}renderElement(element,index,templateData,height){for(let i=0;i<this.columns.length;i++){const cell=this.columns[i].project(element);this.renderers[i].renderElement(cell,index,templateData.cellTemplateData[i],height)}}disposeElement(element,index,templateData,height){for(let i=0;i<this.columns.length;i++){const renderer=this.renderers[i];if(renderer.disposeElement){const cell=this.columns[i].project(element);renderer.disposeElement(cell,index,templateData.cellTemplateData[i],height)}}}disposeTemplate(templateData){for(let i=0;i<this.columns.length;i++){this.renderers[i].disposeTemplate(templateData.cellTemplateData[i])}(0,dom_1.clearNode)(templateData.container),this.renderedTemplates.delete(templateData)}layoutColumn(index,size){for(const{cellContainers}of this.renderedTemplates)cellContainers[index].style.width=`${size}px`}}TableListRenderer.TemplateId="row";class ColumnHeader{constructor(column,index){this.column=column,this.index=index,this._onDidLayout=new event_1.Emitter,this.onDidLayout=this._onDidLayout.event,this.element=(0,dom_1.$)(".monaco-table-th",{"data-col-index":index,title:column.tooltip},column.label)}get minimumSize(){var _a;return null!==(_a=this.column.minimumWidth)&&void 0!==_a?_a:120}get maximumSize(){var _a;return null!==(_a=this.column.maximumWidth)&&void 0!==_a?_a:Number.POSITIVE_INFINITY}get onDidChange(){var _a;return null!==(_a=this.column.onDidChangeWidthConstraints)&&void 0!==_a?_a:event_1.Event.None}layout(size){this._onDidLayout.fire([this.index,size])}}class Table{constructor(user,container,virtualDelegate,columns,renderers,_options){this.virtualDelegate=virtualDelegate,this.domId="table_id_"+ ++Table.InstanceCount,this.disposables=new lifecycle_1.DisposableStore,this.cachedWidth=0,this.cachedHeight=0,this.domNode=(0,dom_1.append)(container,(0,dom_1.$)(`.monaco-table.${this.domId}`));const headers=columns.map(((c,i)=>new ColumnHeader(c,i))),descriptor={size:headers.reduce(((a,b)=>a+b.column.weight),0),views:headers.map((view=>({size:view.column.weight,view})))};this.splitview=this.disposables.add(new splitview_1.SplitView(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor})),this.splitview.el.style.height=`${virtualDelegate.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${virtualDelegate.headerRowHeight}px`;const renderer=new TableListRenderer(columns,renderers,(i=>this.splitview.getViewSize(i)));this.list=this.disposables.add(new listWidget_1.List(user,this.domNode,function asListVirtualDelegate(delegate){return{getHeight:row=>delegate.getHeight(row),getTemplateId:()=>TableListRenderer.TemplateId}}(virtualDelegate),[renderer],_options)),event_1.Event.any(...headers.map((h=>h.onDidLayout)))((([index,size])=>renderer.layoutColumn(index,size)),null,this.disposables),this.splitview.onDidSashReset((index=>{const totalWeight=columns.reduce(((r,c)=>r+c.weight),0),size=columns[index].weight/totalWeight*this.cachedWidth;this.splitview.resizeView(index,size)}),null,this.disposables),this.styleElement=(0,dom_1.createStyleSheet)(this.domNode),this.style({})}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}updateOptions(options){this.list.updateOptions(options)}splice(start,deleteCount,elements=[]){this.list.splice(start,deleteCount,elements)}getHTMLElement(){return this.domNode}style(styles){const content=[];content.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\ttop: ${this.virtualDelegate.headerRowHeight+1}px;\n\t\t\theight: calc(100% - ${this.virtualDelegate.headerRowHeight}px);\n\t\t}`),this.styleElement.textContent=content.join("\n"),this.list.style(styles)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}exports.Table=Table,Table.InstanceCount=0})),define(__m[352],__M([12]),{}),define(__m[145],__M([12]),{}),define(__m[232],__M([1,0,7,136,145]),(function(require,exports,dom,idGenerator_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getIconClass=void 0;const iconPathToClass={},iconClassGenerator=new idGenerator_1.IdGenerator("quick-input-button-icon-");exports.getIconClass=function getIconClass(iconPath){if(!iconPath)return;let iconClass;const key=iconPath.dark.toString();return iconPathToClass[key]?iconClass=iconPathToClass[key]:(iconClass=iconClassGenerator.nextId(),dom.createCSSRule(`.${iconClass}`,`background-image: ${dom.asCSSUrl(iconPath.light||iconPath.dark)}`),dom.createCSSRule(`.vs-dark .${iconClass}, .hc-black .${iconClass}`,`background-image: ${dom.asCSSUrl(iconPath.dark)}`),iconPathToClass[key]=iconClass),iconClass}})),define(__m[353],__M([12]),{}),define(__m[354],__M([12]),{}),define(__m[355],__M([12]),{}),define(__m[356],__M([12]),{}),define(__m[357],__M([12]),{}),define(__m[358],__M([12]),{}),define(__m[359],__M([12]),{}),define(__m[360],__M([12]),{}),define(__m[361],__M([12]),{}),define(__m[362],__M([12]),{}),define(__m[363],__M([12]),{}),define(__m[364],__M([12]),{}),define(__m[365],__M([12]),{}),define(__m[366],__M([12]),{}),define(__m[367],__M([12]),{}),define(__m[368],__M([12]),{}),define(__m[369],__M([12]),{}),define(__m[370],__M([12]),{}),define(__m[371],__M([12]),{}),define(__m[372],__M([12]),{}),define(__m[373],__M([12]),{}),define(__m[374],__M([12]),{}),define(__m[375],__M([12]),{}),define(__m[376],__M([12]),{}),define(__m[377],__M([12]),{}),define(__m[378],__M([12]),{}),define(__m[379],__M([12]),{}),define(__m[380],__M([12]),{}),define(__m[381],__M([12]),{}),define(__m[382],__M([12]),{}),define(__m[383],__M([12]),{}),define(__m[384],__M([12]),{}),define(__m[385],__M([12]),{}),define(__m[386],__M([12]),{}),define(__m[387],__M([12]),{}),define(__m[388],__M([12]),{}),define(__m[389],__M([12]),{}),define(__m[390],__M([12]),{}),define(__m[391],__M([12]),{}),define(__m[392],__M([12]),{}),define(__m[393],__M([12]),{}),define(__m[394],__M([12]),{}),define(__m[395],__M([12]),{}),define(__m[396],__M([12]),{}),define(__m[397],__M([12]),{}),define(__m[398],__M([12]),{}),define(__m[399],__M([12]),{}),define(__m[233],__M([1,0,2,4]),(function(require,exports,lifecycle_1,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ElementSizeObserver=void 0;class ElementSizeObserver extends lifecycle_1.Disposable{constructor(referenceDomElement,dimension){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._referenceDomElement=referenceDomElement,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,dimension)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){!this._resizeObserver&&this._referenceDomElement&&(this._resizeObserver=new ResizeObserver((entries=>{entries&&entries[0]&&entries[0].contentRect?this.observe({width:entries[0].contentRect.width,height:entries[0].contentRect.height}):this.observe()})),this._resizeObserver.observe(this._referenceDomElement))}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(dimension){this.measureReferenceDomElement(!0,dimension)}measureReferenceDomElement(emitEvent,dimension){let observedWidth=0,observedHeight=0;dimension?(observedWidth=dimension.width,observedHeight=dimension.height):this._referenceDomElement&&(observedWidth=this._referenceDomElement.clientWidth,observedHeight=this._referenceDomElement.clientHeight),observedWidth=Math.max(5,observedWidth),observedHeight=Math.max(5,observedHeight),this._width===observedWidth&&this._height===observedHeight||(this._width=observedWidth,this._height=observedHeight,emitEvent&&this._onDidChange.fire())}}exports.ElementSizeObserver=ElementSizeObserver})),define(__m[400],__M([1,0,217]),(function(require,exports,collections_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.migrateOptions=void 0,exports.migrateOptions=function migrateOptions(options){const wordWrap=options.wordWrap;!0===wordWrap?options.wordWrap="on":!1===wordWrap&&(options.wordWrap="off");const lineNumbers=options.lineNumbers;!0===lineNumbers?options.lineNumbers="on":!1===lineNumbers&&(options.lineNumbers="off"),!1===options.autoClosingBrackets&&(options.autoClosingBrackets="never",options.autoClosingQuotes="never",options.autoSurround="never"),"visible"===options.cursorBlinking&&(options.cursorBlinking="solid");const renderWhitespace=options.renderWhitespace;!0===renderWhitespace?options.renderWhitespace="boundary":!1===renderWhitespace&&(options.renderWhitespace="none");const renderLineHighlight=options.renderLineHighlight;!0===renderLineHighlight?options.renderLineHighlight="line":!1===renderLineHighlight&&(options.renderLineHighlight="none");const acceptSuggestionOnEnter=options.acceptSuggestionOnEnter;!0===acceptSuggestionOnEnter?options.acceptSuggestionOnEnter="on":!1===acceptSuggestionOnEnter&&(options.acceptSuggestionOnEnter="off");const tabCompletion=options.tabCompletion;!1===tabCompletion?options.tabCompletion="off":!0===tabCompletion&&(options.tabCompletion="onlySnippets");const suggest=options.suggest;if(suggest&&"object"==typeof suggest.filteredTypes&&suggest.filteredTypes){const mapping={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};(0,collections_1.forEach)(mapping,(entry=>{const value=suggest.filteredTypes[entry.key];!1===value&&(suggest[entry.value]=value)}))}const hover=options.hover;!0===hover?options.hover={enabled:!0}:!1===hover&&(options.hover={enabled:!1});const parameterHints=options.parameterHints;!0===parameterHints?options.parameterHints={enabled:!0}:!1===parameterHints&&(options.parameterHints={enabled:!1});const autoIndent=options.autoIndent;!0===autoIndent?options.autoIndent="full":!1===autoIndent&&(options.autoIndent="advanced");const matchBrackets=options.matchBrackets;!0===matchBrackets?options.matchBrackets="always":!1===matchBrackets&&(options.matchBrackets="never");const{renderIndentGuides,highlightActiveIndentGuide}=options;options.guides||(options.guides={}),void 0!==renderIndentGuides&&(options.guides.indentation=!!renderIndentGuides),void 0!==highlightActiveIndentGuide&&(options.guides.highlightActiveIndentation=!!highlightActiveIndentGuide)}})),define(__m[234],__M([1,0,4]),(function(require,exports,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TabFocus=void 0;exports.TabFocus=new class TabFocusImpl{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new event_1.Emitter,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(tabFocusMode){this._tabFocus!==tabFocusMode&&(this._tabFocus=tabFocusMode,this._onDidChangeTabFocus.fire(this._tabFocus))}}})),define(__m[146],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StableEditorScrollState=void 0;class StableEditorScrollState{constructor(_visiblePosition,_visiblePositionScrollDelta,_cursorPosition){this._visiblePosition=_visiblePosition,this._visiblePositionScrollDelta=_visiblePositionScrollDelta,this._cursorPosition=_cursorPosition}static capture(editor){let visiblePosition=null,visiblePositionScrollDelta=0;if(0!==editor.getScrollTop()){const visibleRanges=editor.getVisibleRanges();if(visibleRanges.length>0){visiblePosition=visibleRanges[0].getStartPosition();const visiblePositionScrollTop=editor.getTopForPosition(visiblePosition.lineNumber,visiblePosition.column);visiblePositionScrollDelta=editor.getScrollTop()-visiblePositionScrollTop}}return new StableEditorScrollState(visiblePosition,visiblePositionScrollDelta,editor.getPosition())}restore(editor){if(this._visiblePosition){const visiblePositionScrollTop=editor.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);editor.setScrollTop(visiblePositionScrollTop+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(editor){const currentCursorPosition=editor.getPosition();if(!this._cursorPosition||!currentCursorPosition)return;const offset=editor.getTopForLineNumber(currentCursorPosition.lineNumber)-editor.getTopForLineNumber(this._cursorPosition.lineNumber);editor.setScrollTop(editor.getScrollTop()+offset)}}exports.StableEditorScrollState=StableEditorScrollState})),define(__m[118],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VisibleRanges=exports.HorizontalPosition=exports.FloatHorizontalRange=exports.HorizontalRange=exports.LineVisibleRanges=exports.RenderingContext=exports.RestrictedRenderingContext=void 0;class RestrictedRenderingContext{constructor(viewLayout,viewportData){this._restrictedRenderingContextBrand=void 0,this._viewLayout=viewLayout,this.viewportData=viewportData,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const vInfo=this._viewLayout.getCurrentViewport();this.scrollTop=vInfo.top,this.scrollLeft=vInfo.left,this.viewportWidth=vInfo.width,this.viewportHeight=vInfo.height}getScrolledTopFromAbsoluteTop(absoluteTop){return absoluteTop-this.scrollTop}getVerticalOffsetForLineNumber(lineNumber){return this._viewLayout.getVerticalOffsetForLineNumber(lineNumber)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}exports.RestrictedRenderingContext=RestrictedRenderingContext;exports.RenderingContext=class RenderingContext extends RestrictedRenderingContext{constructor(viewLayout,viewportData,viewLines){super(viewLayout,viewportData),this._renderingContextBrand=void 0,this._viewLines=viewLines}linesVisibleRangesForRange(range,includeNewLines){return this._viewLines.linesVisibleRangesForRange(range,includeNewLines)}visibleRangeForPosition(position){return this._viewLines.visibleRangeForPosition(position)}};exports.LineVisibleRanges=class LineVisibleRanges{constructor(outsideRenderedLine,lineNumber,ranges){this.outsideRenderedLine=outsideRenderedLine,this.lineNumber=lineNumber,this.ranges=ranges}};class HorizontalRange{constructor(left,width){this._horizontalRangeBrand=void 0,this.left=Math.round(left),this.width=Math.round(width)}static from(ranges){const result=new Array(ranges.length);for(let i=0,len=ranges.length;i<len;i++){const range=ranges[i];result[i]=new HorizontalRange(range.left,range.width)}return result}toString(){return`[${this.left},${this.width}]`}}exports.HorizontalRange=HorizontalRange;exports.FloatHorizontalRange=class FloatHorizontalRange{constructor(left,width){this._floatHorizontalRangeBrand=void 0,this.left=left,this.width=width}toString(){return`[${this.left},${this.width}]`}static compare(a,b){return a.left-b.left}};exports.HorizontalPosition=class HorizontalPosition{constructor(outsideRenderedLine,left){this.outsideRenderedLine=outsideRenderedLine,this.originalLeft=left,this.left=Math.round(this.originalLeft)}};exports.VisibleRanges=class VisibleRanges{constructor(outsideRenderedLine,ranges){this.outsideRenderedLine=outsideRenderedLine,this.ranges=ranges}}})),define(__m[235],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewUserInputEvents=void 0;class ViewUserInputEvents{constructor(coordinatesConverter){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=coordinatesConverter}emitKeyDown(e){this.onKeyDown&&this.onKeyDown(e)}emitKeyUp(e){this.onKeyUp&&this.onKeyUp(e)}emitContextMenu(e){this.onContextMenu&&this.onContextMenu(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove&&this.onMouseMove(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave&&this.onMouseLeave(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown&&this.onMouseDown(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp&&this.onMouseUp(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag&&this.onMouseDrag(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop&&this.onMouseDrop(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled&&this.onMouseDropCanceled()}emitMouseWheel(e){this.onMouseWheel&&this.onMouseWheel(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(target){return ViewUserInputEvents.convertViewToModelMouseTarget(target,this._coordinatesConverter)}static convertViewToModelMouseTarget(target,coordinatesConverter){const result=Object.assign({},target);return result.position&&(result.position=coordinatesConverter.convertViewPositionToModelPosition(result.position)),result.range&&(result.range=coordinatesConverter.convertViewRangeToModelRange(result.range)),result}}exports.ViewUserInputEvents=ViewUserInputEvents})),define(__m[401],__M([1,0,118]),(function(require,exports,renderingContext_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RangeUtil=void 0;exports.RangeUtil=class RangeUtil{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(range,endNode){range.selectNodeContents(endNode)}static _readClientRects(startElement,startOffset,endElement,endOffset,endNode){const range=this._createRange();try{return range.setStart(startElement,startOffset),range.setEnd(endElement,endOffset),range.getClientRects()}catch(e){return null}finally{this._detachRange(range,endNode)}}static _mergeAdjacentRanges(ranges){if(1===ranges.length)return ranges;ranges.sort(renderingContext_1.FloatHorizontalRange.compare);const result=[];let resultLen=0,prev=ranges[0];for(let i=1,len=ranges.length;i<len;i++){const range=ranges[i];prev.left+prev.width+.9>=range.left?prev.width=Math.max(prev.width,range.left+range.width-prev.left):(result[resultLen++]=prev,prev=range)}return result[resultLen++]=prev,result}static _createHorizontalRangesFromClientRects(clientRects,clientRectDeltaLeft,clientRectScale){if(!clientRects||0===clientRects.length)return null;const result=[];for(let i=0,len=clientRects.length;i<len;i++){const clientRect=clientRects[i];result[i]=new renderingContext_1.FloatHorizontalRange(Math.max(0,(clientRect.left-clientRectDeltaLeft)/clientRectScale),clientRect.width/clientRectScale)}return this._mergeAdjacentRanges(result)}static readHorizontalRanges(domNode,startChildIndex,startOffset,endChildIndex,endOffset,clientRectDeltaLeft,clientRectScale,endNode){const max=domNode.children.length-1;if(0>max)return null;if((startChildIndex=Math.min(max,Math.max(0,startChildIndex)))===(endChildIndex=Math.min(max,Math.max(0,endChildIndex)))&&startOffset===endOffset&&0===startOffset&&!domNode.children[startChildIndex].firstChild){const clientRects=domNode.children[startChildIndex].getClientRects();return this._createHorizontalRangesFromClientRects(clientRects,clientRectDeltaLeft,clientRectScale)}startChildIndex!==endChildIndex&&endChildIndex>0&&0===endOffset&&(endChildIndex--,endOffset=1073741824);let startElement=domNode.children[startChildIndex].firstChild,endElement=domNode.children[endChildIndex].firstChild;if(startElement&&endElement||(!startElement&&0===startOffset&&startChildIndex>0&&(startElement=domNode.children[startChildIndex-1].firstChild,startOffset=1073741824),!endElement&&0===endOffset&&endChildIndex>0&&(endElement=domNode.children[endChildIndex-1].firstChild,endOffset=1073741824)),!startElement||!endElement)return null;startOffset=Math.min(startElement.textContent.length,Math.max(0,startOffset)),endOffset=Math.min(endElement.textContent.length,Math.max(0,endOffset));const clientRects=this._readClientRects(startElement,startOffset,endElement,endOffset,endNode);return this._createHorizontalRangesFromClientRects(clientRects,clientRectDeltaLeft,clientRectScale)}}})),define(__m[236],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCharIndex=exports.allCharCodes=void 0,exports.allCharCodes=(()=>{const v=[];for(let i=32;i<=126;i++)v.push(i);return v.push(65533),v})();exports.getCharIndex=(chCode,fontScale)=>(chCode-=32)<0||chCode>96?fontScale<=2?(chCode+96)%96:95:chCode})),define(__m[402],__M([1,0,236,142]),(function(require,exports,minimapCharSheet_1,uint_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MinimapCharRenderer=void 0;class MinimapCharRenderer{constructor(charData,scale){this.scale=scale,this._minimapCharRendererBrand=void 0,this.charDataNormal=MinimapCharRenderer.soften(charData,.8),this.charDataLight=MinimapCharRenderer.soften(charData,50/60)}static soften(input,ratio){const result=new Uint8ClampedArray(input.length);for(let i=0,len=input.length;i<len;i++)result[i]=(0,uint_1.toUint8)(input[i]*ratio);return result}renderChar(target,dx,dy,chCode,color,foregroundAlpha,backgroundColor,backgroundAlpha,fontScale,useLighterFont,force1pxHeight){const charWidth=1*this.scale,charHeight=2*this.scale,renderHeight=force1pxHeight?1:charHeight;if(dx+charWidth>target.width||dy+renderHeight>target.height)return void console.warn("bad render request outside image data");const charData=useLighterFont?this.charDataLight:this.charDataNormal,charIndex=(0,minimapCharSheet_1.getCharIndex)(chCode,fontScale),destWidth=4*target.width,backgroundR=backgroundColor.r,backgroundG=backgroundColor.g,backgroundB=backgroundColor.b,deltaR=color.r-backgroundR,deltaG=color.g-backgroundG,deltaB=color.b-backgroundB,destAlpha=Math.max(foregroundAlpha,backgroundAlpha),dest=target.data;let sourceOffset=charIndex*charWidth*charHeight,row=dy*destWidth+4*dx;for(let y=0;y<renderHeight;y++){let column=row;for(let x=0;x<charWidth;x++){const c=charData[sourceOffset++]/255*(foregroundAlpha/255);dest[column++]=backgroundR+deltaR*c,dest[column++]=backgroundG+deltaG*c,dest[column++]=backgroundB+deltaB*c,dest[column++]=destAlpha}row+=destWidth}}blockRenderChar(target,dx,dy,color,foregroundAlpha,backgroundColor,backgroundAlpha,force1pxHeight){const charWidth=1*this.scale,charHeight=2*this.scale,renderHeight=force1pxHeight?1:charHeight;if(dx+charWidth>target.width||dy+renderHeight>target.height)return void console.warn("bad render request outside image data");const destWidth=4*target.width,c=foregroundAlpha/255*.5,backgroundR=backgroundColor.r,backgroundG=backgroundColor.g,backgroundB=backgroundColor.b,colorR=backgroundR+(color.r-backgroundR)*c,colorG=backgroundG+(color.g-backgroundG)*c,colorB=backgroundB+(color.b-backgroundB)*c,destAlpha=Math.max(foregroundAlpha,backgroundAlpha),dest=target.data;let row=dy*destWidth+4*dx;for(let y=0;y<renderHeight;y++){let column=row;for(let x=0;x<charWidth;x++)dest[column++]=colorR,dest[column++]=colorG,dest[column++]=colorB,dest[column++]=destAlpha;row+=destWidth}}}exports.MinimapCharRenderer=MinimapCharRenderer})),define(__m[403],__M([1,0,91]),(function(require,exports,functional_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.prebakedMiniMaps=void 0;const charTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},decodeData=str=>{const output=new Uint8ClampedArray(str.length/2);for(let i=0;i<str.length;i+=2)output[i>>1]=charTable[str[i]]<<4|15&charTable[str[i+1]];return output};exports.prebakedMiniMaps={1:(0,functional_1.once)((()=>decodeData("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792"))),2:(0,functional_1.once)((()=>decodeData("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126")))}})),define(__m[404],__M([1,0,402,236,403,142]),(function(require,exports,minimapCharRenderer_1,minimapCharSheet_1,minimapPreBaked_1,uint_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MinimapCharRendererFactory=void 0;class MinimapCharRendererFactory{static create(scale,fontFamily){if(this.lastCreated&&scale===this.lastCreated.scale&&fontFamily===this.lastFontFamily)return this.lastCreated;let factory;return factory=minimapPreBaked_1.prebakedMiniMaps[scale]?new minimapCharRenderer_1.MinimapCharRenderer(minimapPreBaked_1.prebakedMiniMaps[scale](),scale):MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(fontFamily).data,scale),this.lastFontFamily=fontFamily,this.lastCreated=factory,factory}static createSampleData(fontFamily){const canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.style.height="16px",canvas.height=16,canvas.width=960,canvas.style.width="960px",ctx.fillStyle="#ffffff",ctx.font=`bold 16px ${fontFamily}`,ctx.textBaseline="middle";let x=0;for(const code of minimapCharSheet_1.allCharCodes)ctx.fillText(String.fromCharCode(code),x,8),x+=10;return ctx.getImageData(0,0,960,16)}static createFromSampleData(source,scale){if(61440!==source.length)throw new Error("Unexpected source in MinimapCharRenderer");const charData=MinimapCharRendererFactory._downsample(source,scale);return new minimapCharRenderer_1.MinimapCharRenderer(charData,scale)}static _downsampleChar(source,sourceOffset,dest,destOffset,scale){const width=1*scale,height=2*scale;let targetIndex=destOffset,brightest=0;for(let y=0;y<height;y++){const sourceY1=y/height*16,sourceY2=(y+1)/height*16;for(let x=0;x<width;x++){const sourceX1=x/width*10,sourceX2=(x+1)/width*10;let value=0,samples=0;for(let sy=sourceY1;sy<sourceY2;sy++){const sourceRow=sourceOffset+3840*Math.floor(sy),yBalance=1-(sy-Math.floor(sy));for(let sx=sourceX1;sx<sourceX2;sx++){const xBalance=1-(sx-Math.floor(sx)),sourceIndex=sourceRow+4*Math.floor(sx),weight=xBalance*yBalance;samples+=weight,value+=source[sourceIndex]*source[sourceIndex+3]/255*weight}}const final=value/samples;brightest=Math.max(brightest,final),dest[targetIndex++]=(0,uint_1.toUint8)(final)}}return brightest}static _downsample(data,scale){const pixelsPerCharacter=2*scale*1*scale,resultLen=96*pixelsPerCharacter,result=new Uint8ClampedArray(resultLen);let resultOffset=0,sourceOffset=0,brightest=0;for(let charIndex=0;charIndex<96;charIndex++)brightest=Math.max(brightest,this._downsampleChar(data,sourceOffset,result,resultOffset,scale)),resultOffset+=pixelsPerCharacter,sourceOffset+=40;if(brightest>0){const adjust=255/brightest;for(let i=0;i<resultLen;i++)result[i]*=adjust}return result}}exports.MinimapCharRendererFactory=MinimapCharRendererFactory})),define(__m[147],__M([1,0,4]),(function(require,exports,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorZoom=void 0,exports.EditorZoom=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new event_1.Emitter,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(zoomLevel){zoomLevel=Math.min(Math.max(-5,zoomLevel),20),this._zoomLevel!==zoomLevel&&(this._zoomLevel=zoomLevel,this._onDidChangeZoomLevel.fire(this._zoomLevel))}}})),define(__m[176],__M([1,0,16,147]),(function(require,exports,platform,editorZoom_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FontInfo=exports.SERIALIZED_FONT_INFO_VERSION=exports.BareFontInfo=void 0;const GOLDEN_LINE_HEIGHT_RATIO=platform.isMacintosh?1.5:1.35;class BareFontInfo{constructor(opts){this._bareFontInfoBrand=void 0,this.pixelRatio=opts.pixelRatio,this.fontFamily=String(opts.fontFamily),this.fontWeight=String(opts.fontWeight),this.fontSize=opts.fontSize,this.fontFeatureSettings=opts.fontFeatureSettings,this.lineHeight=0|opts.lineHeight,this.letterSpacing=opts.letterSpacing}static createFromValidatedSettings(options,pixelRatio,ignoreEditorZoom){const fontFamily=options.get(43),fontWeight=options.get(47),fontSize=options.get(46),fontFeatureSettings=options.get(45),lineHeight=options.get(59),letterSpacing=options.get(56);return BareFontInfo._create(fontFamily,fontWeight,fontSize,fontFeatureSettings,lineHeight,letterSpacing,pixelRatio,ignoreEditorZoom)}static _create(fontFamily,fontWeight,fontSize,fontFeatureSettings,lineHeight,letterSpacing,pixelRatio,ignoreEditorZoom){0===lineHeight?lineHeight=GOLDEN_LINE_HEIGHT_RATIO*fontSize:lineHeight<8&&(lineHeight*=fontSize),(lineHeight=Math.round(lineHeight))<8&&(lineHeight=8);const editorZoomLevelMultiplier=1+(ignoreEditorZoom?0:.1*editorZoom_1.EditorZoom.getZoomLevel());return new BareFontInfo({pixelRatio,fontFamily,fontWeight,fontSize:fontSize*=editorZoomLevelMultiplier,fontFeatureSettings,lineHeight:lineHeight*=editorZoomLevelMultiplier,letterSpacing})}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(fallbackFontFamily){const fontFamily=BareFontInfo._wrapInQuotes(this.fontFamily);return fallbackFontFamily&&this.fontFamily!==fallbackFontFamily?`${fontFamily}, ${fallbackFontFamily}`:fontFamily}static _wrapInQuotes(fontFamily){return/[,"']/.test(fontFamily)?fontFamily:/[+ ]/.test(fontFamily)?`"${fontFamily}"`:fontFamily}}exports.BareFontInfo=BareFontInfo,exports.SERIALIZED_FONT_INFO_VERSION=1;exports.FontInfo=class FontInfo extends BareFontInfo{constructor(opts,isTrusted){super(opts),this._editorStylingBrand=void 0,this.version=exports.SERIALIZED_FONT_INFO_VERSION,this.isTrusted=isTrusted,this.isMonospace=opts.isMonospace,this.typicalHalfwidthCharacterWidth=opts.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=opts.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=opts.canUseHalfwidthRightwardsArrow,this.spaceWidth=opts.spaceWidth,this.middotWidth=opts.middotWidth,this.wsmiddotWidth=opts.wsmiddotWidth,this.maxDigitWidth=opts.maxDigitWidth}equals(other){return this.fontFamily===other.fontFamily&&this.fontWeight===other.fontWeight&&this.fontSize===other.fontSize&&this.fontFeatureSettings===other.fontFeatureSettings&&this.lineHeight===other.lineHeight&&this.letterSpacing===other.letterSpacing&&this.typicalHalfwidthCharacterWidth===other.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===other.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===other.canUseHalfwidthRightwardsArrow&&this.spaceWidth===other.spaceWidth&&this.middotWidth===other.middotWidth&&this.wsmiddotWidth===other.wsmiddotWidth&&this.maxDigitWidth===other.maxDigitWidth}}})),define(__m[99],__M([1,0,142]),(function(require,exports,uint_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CharacterSet=exports.CharacterClassifier=void 0;class CharacterClassifier{constructor(_defaultValue){const defaultValue=(0,uint_1.toUint8)(_defaultValue);this._defaultValue=defaultValue,this._asciiMap=CharacterClassifier._createAsciiMap(defaultValue),this._map=new Map}static _createAsciiMap(defaultValue){const asciiMap=new Uint8Array(256);for(let i=0;i<256;i++)asciiMap[i]=defaultValue;return asciiMap}set(charCode,_value){const value=(0,uint_1.toUint8)(_value);charCode>=0&&charCode<256?this._asciiMap[charCode]=value:this._map.set(charCode,value)}get(charCode){return charCode>=0&&charCode<256?this._asciiMap[charCode]:this._map.get(charCode)||this._defaultValue}}exports.CharacterClassifier=CharacterClassifier;exports.CharacterSet=class CharacterSet{constructor(){this._actual=new CharacterClassifier(0)}add(charCode){this._actual.set(charCode,1)}has(charCode){return 1===this._actual.get(charCode)}}})),define(__m[70],__M([1,0,8]),(function(require,exports,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorColumns=void 0;class CursorColumns{static _nextVisibleColumn(codePoint,visibleColumn,tabSize){return 9===codePoint?CursorColumns.nextRenderTabStop(visibleColumn,tabSize):strings.isFullWidthCharacter(codePoint)||strings.isEmojiImprecise(codePoint)?visibleColumn+2:visibleColumn+1}static visibleColumnFromColumn(lineContent,column,tabSize){const textLen=Math.min(column-1,lineContent.length),text=lineContent.substring(0,textLen),iterator=new strings.GraphemeIterator(text);let result=0;for(;!iterator.eol();){const codePoint=strings.getNextCodePoint(text,textLen,iterator.offset);iterator.nextGraphemeLength(),result=this._nextVisibleColumn(codePoint,result,tabSize)}return result}static columnFromVisibleColumn(lineContent,visibleColumn,tabSize){if(visibleColumn<=0)return 1;const lineContentLength=lineContent.length,iterator=new strings.GraphemeIterator(lineContent);let beforeVisibleColumn=0,beforeColumn=1;for(;!iterator.eol();){const codePoint=strings.getNextCodePoint(lineContent,lineContentLength,iterator.offset);iterator.nextGraphemeLength();const afterVisibleColumn=this._nextVisibleColumn(codePoint,beforeVisibleColumn,tabSize),afterColumn=iterator.offset+1;if(afterVisibleColumn>=visibleColumn){return afterVisibleColumn-visibleColumn<visibleColumn-beforeVisibleColumn?afterColumn:beforeColumn}beforeVisibleColumn=afterVisibleColumn,beforeColumn=afterColumn}return lineContentLength+1}static nextRenderTabStop(visibleColumn,tabSize){return visibleColumn+tabSize-visibleColumn%tabSize}static nextIndentTabStop(visibleColumn,indentSize){return visibleColumn+indentSize-visibleColumn%indentSize}static prevRenderTabStop(column,tabSize){return Math.max(0,column-1-(column-1)%tabSize)}static prevIndentTabStop(column,indentSize){return Math.max(0,column-1-(column-1)%indentSize)}}exports.CursorColumns=CursorColumns})),define(__m[119],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.countEOL=void 0,exports.countEOL=function countEOL(text){let eolCount=0,firstLineLength=0,lastLineStart=0,eol=0;for(let i=0,len=text.length;i<len;i++){const chr=text.charCodeAt(i);13===chr?(0===eolCount&&(firstLineLength=i),eolCount++,i+1<len&&10===text.charCodeAt(i+1)?(eol|=2,i++):eol|=3,lastLineStart=i+1):10===chr&&(eol|=1,0===eolCount&&(firstLineLength=i),eolCount++,lastLineStart=i+1)}return 0===eolCount&&(firstLineLength=text.length),[eolCount,firstLineLength,text.length-lastLineStart,eol]}})),define(__m[177],__M([1,0,8]),(function(require,exports,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeIndentation=void 0,exports.normalizeIndentation=function normalizeIndentation(str,indentSize,insertSpaces){let firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(str);return-1===firstNonWhitespaceIndex&&(firstNonWhitespaceIndex=str.length),function _normalizeIndentationFromWhitespace(str,indentSize,insertSpaces){let spacesCnt=0;for(let i=0;i<str.length;i++)"\t"===str.charAt(i)?spacesCnt+=indentSize:spacesCnt++;let result="";if(!insertSpaces){const tabsCnt=Math.floor(spacesCnt/indentSize);spacesCnt%=indentSize;for(let i=0;i<tabsCnt;i++)result+="\t"}for(let i=0;i<spacesCnt;i++)result+=" ";return result}(str.substring(0,firstNonWhitespaceIndex),indentSize,insertSpaces)+str.substring(firstNonWhitespaceIndex)}})),define(__m[11],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Position=void 0;class Position{constructor(lineNumber,column){this.lineNumber=lineNumber,this.column=column}with(newLineNumber=this.lineNumber,newColumn=this.column){return newLineNumber===this.lineNumber&&newColumn===this.column?this:new Position(newLineNumber,newColumn)}delta(deltaLineNumber=0,deltaColumn=0){return this.with(this.lineNumber+deltaLineNumber,this.column+deltaColumn)}equals(other){return Position.equals(this,other)}static equals(a,b){return!a&&!b||!!a&&!!b&&a.lineNumber===b.lineNumber&&a.column===b.column}isBefore(other){return Position.isBefore(this,other)}static isBefore(a,b){return a.lineNumber<b.lineNumber||!(b.lineNumber<a.lineNumber)&&a.column<b.column}isBeforeOrEqual(other){return Position.isBeforeOrEqual(this,other)}static isBeforeOrEqual(a,b){return a.lineNumber<b.lineNumber||!(b.lineNumber<a.lineNumber)&&a.column<=b.column}static compare(a,b){const aLineNumber=0|a.lineNumber,bLineNumber=0|b.lineNumber;if(aLineNumber===bLineNumber){return(0|a.column)-(0|b.column)}return aLineNumber-bLineNumber}clone(){return new Position(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(pos){return new Position(pos.lineNumber,pos.column)}static isIPosition(obj){return obj&&"number"==typeof obj.lineNumber&&"number"==typeof obj.column}}exports.Position=Position})),define(__m[3],__M([1,0,11]),(function(require,exports,position_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Range=void 0;class Range{constructor(startLineNumber,startColumn,endLineNumber,endColumn){startLineNumber>endLineNumber||startLineNumber===endLineNumber&&startColumn>endColumn?(this.startLineNumber=endLineNumber,this.startColumn=endColumn,this.endLineNumber=startLineNumber,this.endColumn=startColumn):(this.startLineNumber=startLineNumber,this.startColumn=startColumn,this.endLineNumber=endLineNumber,this.endColumn=endColumn)}isEmpty(){return Range.isEmpty(this)}static isEmpty(range){return range.startLineNumber===range.endLineNumber&&range.startColumn===range.endColumn}containsPosition(position){return Range.containsPosition(this,position)}static containsPosition(range,position){return!(position.lineNumber<range.startLineNumber||position.lineNumber>range.endLineNumber)&&(!(position.lineNumber===range.startLineNumber&&position.column<range.startColumn)&&!(position.lineNumber===range.endLineNumber&&position.column>range.endColumn))}static strictContainsPosition(range,position){return!(position.lineNumber<range.startLineNumber||position.lineNumber>range.endLineNumber)&&(!(position.lineNumber===range.startLineNumber&&position.column<=range.startColumn)&&!(position.lineNumber===range.endLineNumber&&position.column>=range.endColumn))}containsRange(range){return Range.containsRange(this,range)}static containsRange(range,otherRange){return!(otherRange.startLineNumber<range.startLineNumber||otherRange.endLineNumber<range.startLineNumber)&&(!(otherRange.startLineNumber>range.endLineNumber||otherRange.endLineNumber>range.endLineNumber)&&(!(otherRange.startLineNumber===range.startLineNumber&&otherRange.startColumn<range.startColumn)&&!(otherRange.endLineNumber===range.endLineNumber&&otherRange.endColumn>range.endColumn)))}strictContainsRange(range){return Range.strictContainsRange(this,range)}static strictContainsRange(range,otherRange){return!(otherRange.startLineNumber<range.startLineNumber||otherRange.endLineNumber<range.startLineNumber)&&(!(otherRange.startLineNumber>range.endLineNumber||otherRange.endLineNumber>range.endLineNumber)&&(!(otherRange.startLineNumber===range.startLineNumber&&otherRange.startColumn<=range.startColumn)&&!(otherRange.endLineNumber===range.endLineNumber&&otherRange.endColumn>=range.endColumn)))}plusRange(range){return Range.plusRange(this,range)}static plusRange(a,b){let startLineNumber,startColumn,endLineNumber,endColumn;return b.startLineNumber<a.startLineNumber?(startLineNumber=b.startLineNumber,startColumn=b.startColumn):b.startLineNumber===a.startLineNumber?(startLineNumber=b.startLineNumber,startColumn=Math.min(b.startColumn,a.startColumn)):(startLineNumber=a.startLineNumber,startColumn=a.startColumn),b.endLineNumber>a.endLineNumber?(endLineNumber=b.endLineNumber,endColumn=b.endColumn):b.endLineNumber===a.endLineNumber?(endLineNumber=b.endLineNumber,endColumn=Math.max(b.endColumn,a.endColumn)):(endLineNumber=a.endLineNumber,endColumn=a.endColumn),new Range(startLineNumber,startColumn,endLineNumber,endColumn)}intersectRanges(range){return Range.intersectRanges(this,range)}static intersectRanges(a,b){let resultStartLineNumber=a.startLineNumber,resultStartColumn=a.startColumn,resultEndLineNumber=a.endLineNumber,resultEndColumn=a.endColumn,otherStartLineNumber=b.startLineNumber,otherStartColumn=b.startColumn,otherEndLineNumber=b.endLineNumber,otherEndColumn=b.endColumn;return resultStartLineNumber<otherStartLineNumber?(resultStartLineNumber=otherStartLineNumber,resultStartColumn=otherStartColumn):resultStartLineNumber===otherStartLineNumber&&(resultStartColumn=Math.max(resultStartColumn,otherStartColumn)),resultEndLineNumber>otherEndLineNumber?(resultEndLineNumber=otherEndLineNumber,resultEndColumn=otherEndColumn):resultEndLineNumber===otherEndLineNumber&&(resultEndColumn=Math.min(resultEndColumn,otherEndColumn)),resultStartLineNumber>resultEndLineNumber||resultStartLineNumber===resultEndLineNumber&&resultStartColumn>resultEndColumn?null:new Range(resultStartLineNumber,resultStartColumn,resultEndLineNumber,resultEndColumn)}equalsRange(other){return Range.equalsRange(this,other)}static equalsRange(a,b){return!!a&&!!b&&a.startLineNumber===b.startLineNumber&&a.startColumn===b.startColumn&&a.endLineNumber===b.endLineNumber&&a.endColumn===b.endColumn}getEndPosition(){return Range.getEndPosition(this)}static getEndPosition(range){return new position_1.Position(range.endLineNumber,range.endColumn)}getStartPosition(){return Range.getStartPosition(this)}static getStartPosition(range){return new position_1.Position(range.startLineNumber,range.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(endLineNumber,endColumn){return new Range(this.startLineNumber,this.startColumn,endLineNumber,endColumn)}setStartPosition(startLineNumber,startColumn){return new Range(startLineNumber,startColumn,this.endLineNumber,this.endColumn)}collapseToStart(){return Range.collapseToStart(this)}static collapseToStart(range){return new Range(range.startLineNumber,range.startColumn,range.startLineNumber,range.startColumn)}static fromPositions(start,end=start){return new Range(start.lineNumber,start.column,end.lineNumber,end.column)}static lift(range){return range?new Range(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn):null}static isIRange(obj){return obj&&"number"==typeof obj.startLineNumber&&"number"==typeof obj.startColumn&&"number"==typeof obj.endLineNumber&&"number"==typeof obj.endColumn}static areIntersectingOrTouching(a,b){return!(a.endLineNumber<b.startLineNumber||a.endLineNumber===b.startLineNumber&&a.endColumn<b.startColumn)&&!(b.endLineNumber<a.startLineNumber||b.endLineNumber===a.startLineNumber&&b.endColumn<a.startColumn)}static areIntersecting(a,b){return!(a.endLineNumber<b.startLineNumber||a.endLineNumber===b.startLineNumber&&a.endColumn<=b.startColumn)&&!(b.endLineNumber<a.startLineNumber||b.endLineNumber===a.startLineNumber&&b.endColumn<=a.startColumn)}static compareRangesUsingStarts(a,b){if(a&&b){const aStartLineNumber=0|a.startLineNumber,bStartLineNumber=0|b.startLineNumber;if(aStartLineNumber===bStartLineNumber){const aStartColumn=0|a.startColumn,bStartColumn=0|b.startColumn;if(aStartColumn===bStartColumn){const aEndLineNumber=0|a.endLineNumber,bEndLineNumber=0|b.endLineNumber;if(aEndLineNumber===bEndLineNumber){return(0|a.endColumn)-(0|b.endColumn)}return aEndLineNumber-bEndLineNumber}return aStartColumn-bStartColumn}return aStartLineNumber-bStartLineNumber}return(a?1:0)-(b?1:0)}static compareRangesUsingEnds(a,b){return a.endLineNumber===b.endLineNumber?a.endColumn===b.endColumn?a.startLineNumber===b.startLineNumber?a.startColumn-b.startColumn:a.startLineNumber-b.startLineNumber:a.endColumn-b.endColumn:a.endLineNumber-b.endLineNumber}static spansMultipleLines(range){return range.endLineNumber>range.startLineNumber}toJSON(){return this}}exports.Range=Range})),define(__m[237],__M([1,0,8,11,3]),(function(require,exports,strings,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PagedScreenReaderStrategy=exports.TextAreaState=exports._debugComposition=void 0,exports._debugComposition=!1;class TextAreaState{constructor(value,selectionStart,selectionEnd,selectionStartPosition,selectionEndPosition){this.value=value,this.selectionStart=selectionStart,this.selectionEnd=selectionEnd,this.selectionStartPosition=selectionStartPosition,this.selectionEndPosition=selectionEndPosition}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(textArea){return new TextAreaState(textArea.getValue(),textArea.getSelectionStart(),textArea.getSelectionEnd(),null,null)}collapseSelection(){return new TextAreaState(this.value,this.value.length,this.value.length,null,null)}writeToTextArea(reason,textArea,select){exports._debugComposition&&console.log(`writeToTextArea ${reason}: ${this.toString()}`),textArea.setValue(reason,this.value),select&&textArea.setSelectionRange(reason,this.selectionStart,this.selectionEnd)}deduceEditorPosition(offset){if(offset<=this.selectionStart){const str=this.value.substring(offset,this.selectionStart);return this._finishDeduceEditorPosition(this.selectionStartPosition,str,-1)}if(offset>=this.selectionEnd){const str=this.value.substring(this.selectionEnd,offset);return this._finishDeduceEditorPosition(this.selectionEndPosition,str,1)}const str1=this.value.substring(this.selectionStart,offset);if(-1===str1.indexOf(String.fromCharCode(8230)))return this._finishDeduceEditorPosition(this.selectionStartPosition,str1,1);const str2=this.value.substring(offset,this.selectionEnd);return this._finishDeduceEditorPosition(this.selectionEndPosition,str2,-1)}_finishDeduceEditorPosition(anchor,deltaText,signum){let lineFeedCnt=0,lastLineFeedIndex=-1;for(;-1!==(lastLineFeedIndex=deltaText.indexOf("\n",lastLineFeedIndex+1));)lineFeedCnt++;return[anchor,signum*deltaText.length,lineFeedCnt]}static deduceInput(previousState,currentState,couldBeEmojiInput){if(!previousState)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};exports._debugComposition&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${previousState.toString()}`),console.log(`CURRENT STATE: ${currentState.toString()}`));const prefixLength=Math.min(strings.commonPrefixLength(previousState.value,currentState.value),previousState.selectionStart,currentState.selectionStart),suffixLength=Math.min(strings.commonSuffixLength(previousState.value,currentState.value),previousState.value.length-previousState.selectionEnd,currentState.value.length-currentState.selectionEnd),previousValue=previousState.value.substring(prefixLength,previousState.value.length-suffixLength),currentValue=currentState.value.substring(prefixLength,currentState.value.length-suffixLength),previousSelectionStart=previousState.selectionStart-prefixLength,previousSelectionEnd=previousState.selectionEnd-prefixLength,currentSelectionStart=currentState.selectionStart-prefixLength,currentSelectionEnd=currentState.selectionEnd-prefixLength;if(exports._debugComposition&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`),console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`)),currentSelectionStart===currentSelectionEnd){const replacePreviousCharacters=previousState.selectionStart-prefixLength;return exports._debugComposition&&console.log(`REMOVE PREVIOUS: ${replacePreviousCharacters} chars`),{text:currentValue,replacePrevCharCnt:replacePreviousCharacters,replaceNextCharCnt:0,positionDelta:0}}return{text:currentValue,replacePrevCharCnt:previousSelectionEnd-previousSelectionStart,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(previousState,currentState){if(!previousState)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(exports._debugComposition&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${previousState.toString()}`),console.log(`CURRENT STATE: ${currentState.toString()}`)),previousState.value===currentState.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:currentState.selectionEnd-previousState.selectionEnd};const prefixLength=Math.min(strings.commonPrefixLength(previousState.value,currentState.value),previousState.selectionEnd),suffixLength=Math.min(strings.commonSuffixLength(previousState.value,currentState.value),previousState.value.length-previousState.selectionEnd),previousValue=previousState.value.substring(prefixLength,previousState.value.length-suffixLength),currentValue=currentState.value.substring(prefixLength,currentState.value.length-suffixLength),previousSelectionStart=previousState.selectionStart-prefixLength,previousSelectionEnd=previousState.selectionEnd-prefixLength,currentSelectionStart=currentState.selectionStart-prefixLength,currentSelectionEnd=currentState.selectionEnd-prefixLength;return exports._debugComposition&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`),console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`)),{text:currentValue,replacePrevCharCnt:previousSelectionEnd,replaceNextCharCnt:previousValue.length-previousSelectionEnd,positionDelta:currentSelectionEnd-currentValue.length}}}exports.TextAreaState=TextAreaState,TextAreaState.EMPTY=new TextAreaState("",0,0,null,null);class PagedScreenReaderStrategy{static _getPageOfLine(lineNumber,linesPerPage){return Math.floor((lineNumber-1)/linesPerPage)}static _getRangeForPage(page,linesPerPage){const offset=page*linesPerPage,startLineNumber=offset+1,endLineNumber=offset+linesPerPage;return new range_1.Range(startLineNumber,1,endLineNumber+1,1)}static fromEditorSelection(previousState,model,selection,linesPerPage,trimLongText){const selectionStartPage=PagedScreenReaderStrategy._getPageOfLine(selection.startLineNumber,linesPerPage),selectionStartPageRange=PagedScreenReaderStrategy._getRangeForPage(selectionStartPage,linesPerPage),selectionEndPage=PagedScreenReaderStrategy._getPageOfLine(selection.endLineNumber,linesPerPage),selectionEndPageRange=PagedScreenReaderStrategy._getRangeForPage(selectionEndPage,linesPerPage),pretextRange=selectionStartPageRange.intersectRanges(new range_1.Range(1,1,selection.startLineNumber,selection.startColumn));let pretext=model.getValueInRange(pretextRange,1);const lastLine=model.getLineCount(),lastLineMaxColumn=model.getLineMaxColumn(lastLine),posttextRange=selectionEndPageRange.intersectRanges(new range_1.Range(selection.endLineNumber,selection.endColumn,lastLine,lastLineMaxColumn));let text,posttext=model.getValueInRange(posttextRange,1);if(selectionStartPage===selectionEndPage||selectionStartPage+1===selectionEndPage)text=model.getValueInRange(selection,1);else{const selectionRange1=selectionStartPageRange.intersectRanges(selection),selectionRange2=selectionEndPageRange.intersectRanges(selection);text=model.getValueInRange(selectionRange1,1)+String.fromCharCode(8230)+model.getValueInRange(selectionRange2,1)}if(trimLongText){const LIMIT_CHARS=500;pretext.length>LIMIT_CHARS&&(pretext=pretext.substring(pretext.length-LIMIT_CHARS,pretext.length)),posttext.length>LIMIT_CHARS&&(posttext=posttext.substring(0,LIMIT_CHARS)),text.length>2*LIMIT_CHARS&&(text=text.substring(0,LIMIT_CHARS)+String.fromCharCode(8230)+text.substring(text.length-LIMIT_CHARS,text.length))}return new TextAreaState(pretext+text+posttext,pretext.length,pretext.length+text.length,new position_1.Position(selection.startLineNumber,selection.startColumn),new position_1.Position(selection.endLineNumber,selection.endColumn))}}exports.PagedScreenReaderStrategy=PagedScreenReaderStrategy})),define(__m[238],__M([1,0,216,4,2,40,3]),(function(require,exports,assert,event_1,lifecycle_1,objects,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DiffNavigator=void 0;const defaultOptions={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0};class DiffNavigator extends lifecycle_1.Disposable{constructor(editor,options={}){super(),this._onDidUpdate=this._register(new event_1.Emitter),this._editor=editor,this._options=objects.mixin(options,defaultOptions,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidDispose((()=>this.dispose()))),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this.nextIdx=-1)}))),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel((e=>{this.revealFirst=!0}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(lineChanges){this.ranges=[],lineChanges&&lineChanges.forEach((lineChange=>{!this._options.ignoreCharChanges&&lineChange.charChanges?lineChange.charChanges.forEach((charChange=>{this.ranges.push({rhs:!0,range:new range_1.Range(charChange.modifiedStartLineNumber,charChange.modifiedStartColumn,charChange.modifiedEndLineNumber,charChange.modifiedEndColumn)})})):0===lineChange.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new range_1.Range(lineChange.modifiedStartLineNumber,1,lineChange.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new range_1.Range(lineChange.modifiedStartLineNumber,1,lineChange.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((left,right)=>range_1.Range.compareRangesUsingStarts(left.range,right.range))),this._onDidUpdate.fire(this)}_initIdx(fwd){let found=!1;const position=this._editor.getPosition();if(position){for(let i=0,len=this.ranges.length;i<len&&!found;i++){const range=this.ranges[i].range;position.isBeforeOrEqual(range.getStartPosition())&&(this.nextIdx=i+(fwd?0:-1),found=!0)}found||(this.nextIdx=fwd?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(fwd,scrollType){if(assert.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(fwd):fwd?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const info=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const pos=info.range.getStartPosition();this._editor.setPosition(pos),this._editor.revealRangeInCenter(info.range,scrollType)}finally{this.ignoreSelectionChange=!1}}canNavigate(){return this.ranges&&this.ranges.length>0}next(scrollType=0){this._move(!0,scrollType)}previous(scrollType=0){this._move(!1,scrollType)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}}exports.DiffNavigator=DiffNavigator})),define(__m[63],__M([1,0,3]),(function(require,exports,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditOperation=void 0;exports.EditOperation=class EditOperation{static insert(position,text){return{range:new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),text,forceMoveMarkers:!0}}static delete(range){return{range,text:null}}static replace(range,text){return{range,text}}static replaceMove(range,text){return{range,text,forceMoveMarkers:!0}}}})),define(__m[405],__M([1,0,8,63,3]),(function(require,exports,strings,editOperation_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.trimTrailingWhitespace=exports.TrimTrailingWhitespaceCommand=void 0;function trimTrailingWhitespace(model,cursors){cursors.sort(((a,b)=>a.lineNumber===b.lineNumber?a.column-b.column:a.lineNumber-b.lineNumber));for(let i=cursors.length-2;i>=0;i--)cursors[i].lineNumber===cursors[i+1].lineNumber&&cursors.splice(i,1);const r=[];let rLen=0,cursorIndex=0;const cursorLen=cursors.length;for(let lineNumber=1,lineCount=model.getLineCount();lineNumber<=lineCount;lineNumber++){const lineContent=model.getLineContent(lineNumber),maxLineColumn=lineContent.length+1;let minEditColumn=0;if(cursorIndex<cursorLen&&cursors[cursorIndex].lineNumber===lineNumber&&(minEditColumn=cursors[cursorIndex].column,cursorIndex++,minEditColumn===maxLineColumn))continue;if(0===lineContent.length)continue;const lastNonWhitespaceIndex=strings.lastNonWhitespaceIndex(lineContent);let fromColumn=0;if(-1===lastNonWhitespaceIndex)fromColumn=1;else{if(lastNonWhitespaceIndex===lineContent.length-1)continue;fromColumn=lastNonWhitespaceIndex+2}fromColumn=Math.max(minEditColumn,fromColumn),r[rLen++]=editOperation_1.EditOperation.delete(new range_1.Range(lineNumber,fromColumn,lineNumber,maxLineColumn))}return r}exports.TrimTrailingWhitespaceCommand=class TrimTrailingWhitespaceCommand{constructor(selection,cursors){this._selection=selection,this._cursors=cursors,this._selectionId=null}getEditOperations(model,builder){const ops=trimTrailingWhitespace(model,this._cursors);for(let i=0,len=ops.length;i<len;i++){const op=ops[i];builder.addEditOperation(op.range,op.text)}this._selectionId=builder.trackSelection(this._selection)}computeCursorState(model,helper){return helper.getTrackedSelection(this._selectionId)}},exports.trimTrailingWhitespace=trimTrailingWhitespace})),define(__m[239],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RGBA8=void 0;class RGBA8{constructor(r,g,b,a){this._rgba8Brand=void 0,this.r=RGBA8._clamp(r),this.g=RGBA8._clamp(g),this.b=RGBA8._clamp(b),this.a=RGBA8._clamp(a)}equals(other){return this.r===other.r&&this.g===other.g&&this.b===other.b&&this.a===other.a}static _clamp(c){return c<0?0:c>255?255:0|c}}exports.RGBA8=RGBA8,RGBA8.Empty=new RGBA8(0,0,0,0)})),define(__m[22],__M([1,0,11,3]),(function(require,exports,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Selection=void 0;class Selection extends range_1.Range{constructor(selectionStartLineNumber,selectionStartColumn,positionLineNumber,positionColumn){super(selectionStartLineNumber,selectionStartColumn,positionLineNumber,positionColumn),this.selectionStartLineNumber=selectionStartLineNumber,this.selectionStartColumn=selectionStartColumn,this.positionLineNumber=positionLineNumber,this.positionColumn=positionColumn}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(other){return Selection.selectionsEqual(this,other)}static selectionsEqual(a,b){return a.selectionStartLineNumber===b.selectionStartLineNumber&&a.selectionStartColumn===b.selectionStartColumn&&a.positionLineNumber===b.positionLineNumber&&a.positionColumn===b.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(endLineNumber,endColumn){return 0===this.getDirection()?new Selection(this.startLineNumber,this.startColumn,endLineNumber,endColumn):new Selection(endLineNumber,endColumn,this.startLineNumber,this.startColumn)}getPosition(){return new position_1.Position(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new position_1.Position(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(startLineNumber,startColumn){return 0===this.getDirection()?new Selection(startLineNumber,startColumn,this.endLineNumber,this.endColumn):new Selection(this.endLineNumber,this.endColumn,startLineNumber,startColumn)}static fromPositions(start,end=start){return new Selection(start.lineNumber,start.column,end.lineNumber,end.column)}static fromRange(range,direction){return 0===direction?new Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn):new Selection(range.endLineNumber,range.endColumn,range.startLineNumber,range.startColumn)}static liftSelection(sel){return new Selection(sel.selectionStartLineNumber,sel.selectionStartColumn,sel.positionLineNumber,sel.positionColumn)}static selectionsArrEqual(a,b){if(a&&!b||!a&&b)return!1;if(!a&&!b)return!0;if(a.length!==b.length)return!1;for(let i=0,len=a.length;i<len;i++)if(!this.selectionsEqual(a[i],b[i]))return!1;return!0}static isISelection(obj){return obj&&"number"==typeof obj.selectionStartLineNumber&&"number"==typeof obj.selectionStartColumn&&"number"==typeof obj.positionLineNumber&&"number"==typeof obj.positionColumn}static createWithDirection(startLineNumber,startColumn,endLineNumber,endColumn,direction){return 0===direction?new Selection(startLineNumber,startColumn,endLineNumber,endColumn):new Selection(endLineNumber,endColumn,startLineNumber,startColumn)}}exports.Selection=Selection})),define(__m[178],__M([1,0,34,7,44,10,4,2,138,8,237,22]),(function(require,exports,browser,dom,keyboardEvent_1,async_1,event_1,lifecycle_1,mime_1,strings,textAreaState_1,selection_1){"use strict";var TextAreaSyntethicEvents;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextAreaWrapper=exports.TextAreaInput=exports.InMemoryClipboardMetadataManager=exports.CopyOptions=exports.TextAreaSyntethicEvents=void 0,function(TextAreaSyntethicEvents){TextAreaSyntethicEvents.Tap="-monaco-textarea-synthetic-tap"}(TextAreaSyntethicEvents=exports.TextAreaSyntethicEvents||(exports.TextAreaSyntethicEvents={})),exports.CopyOptions={forceCopyWithSyntaxHighlighting:!1};class InMemoryClipboardMetadataManager{constructor(){this._lastState=null}set(lastCopiedValue,data){this._lastState={lastCopiedValue,data}}get(pastedText){return this._lastState&&this._lastState.lastCopiedValue===pastedText?this._lastState.data:(this._lastState=null,null)}}exports.InMemoryClipboardMetadataManager=InMemoryClipboardMetadataManager,InMemoryClipboardMetadataManager.INSTANCE=new InMemoryClipboardMetadataManager;class CompositionContext{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(text){const typeInput={text:text=text||"",replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=text.length,typeInput}}class TextAreaInput extends lifecycle_1.Disposable{constructor(_host,_textArea,_OS,_browser){super(),this._host=_host,this._textArea=_textArea,this._OS=_OS,this._browser=_browser,this._onFocus=this._register(new event_1.Emitter),this.onFocus=this._onFocus.event,this._onBlur=this._register(new event_1.Emitter),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new event_1.Emitter),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new event_1.Emitter),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new event_1.Emitter),this.onCut=this._onCut.event,this._onPaste=this._register(new event_1.Emitter),this.onPaste=this._onPaste.event,this._onType=this._register(new event_1.Emitter),this.onType=this._onType.event,this._onCompositionStart=this._register(new event_1.Emitter),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new event_1.Emitter),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new event_1.Emitter),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new event_1.Emitter),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncTriggerCut=this._register(new async_1.RunOnceScheduler((()=>this._onCut.fire()),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new async_1.RunOnceScheduler((()=>this.writeScreenReaderContent("asyncFocusGain")),0)),this._textAreaState=textAreaState_1.TextAreaState.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._currentComposition=null;let lastKeyDown=null;this._register(this._textArea.onKeyDown((_e=>{const e=new keyboardEvent_1.StandardKeyboardEvent(_e);(109===e.keyCode||this._currentComposition&&1===e.keyCode)&&e.stopPropagation(),e.equals(9)&&e.preventDefault(),lastKeyDown=e,this._onKeyDown.fire(e)}))),this._register(this._textArea.onKeyUp((_e=>{const e=new keyboardEvent_1.StandardKeyboardEvent(_e);this._onKeyUp.fire(e)}))),this._register(this._textArea.onCompositionStart((e=>{textAreaState_1._debugComposition&&console.log("[compositionstart]",e);const currentComposition=new CompositionContext;if(this._currentComposition)this._currentComposition=currentComposition;else{if(this._currentComposition=currentComposition,2===this._OS&&lastKeyDown&&lastKeyDown.equals(109)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===e.data&&("ArrowRight"===lastKeyDown.code||"ArrowLeft"===lastKeyDown.code))return textAreaState_1._debugComposition&&console.log("[compositionstart] Handling long press case on macOS + arrow key",e),currentComposition.handleCompositionUpdate("x"),void this._onCompositionStart.fire({data:e.data});this._browser.isAndroid,this._onCompositionStart.fire({data:e.data})}}))),this._register(this._textArea.onCompositionUpdate((e=>{textAreaState_1._debugComposition&&console.log("[compositionupdate]",e);const currentComposition=this._currentComposition;if(!currentComposition)return;if(this._browser.isAndroid){const newState=textAreaState_1.TextAreaState.readFromTextArea(this._textArea),typeInput=textAreaState_1.TextAreaState.deduceAndroidCompositionInput(this._textAreaState,newState);return this._textAreaState=newState,this._onType.fire(typeInput),void this._onCompositionUpdate.fire(e)}const typeInput=currentComposition.handleCompositionUpdate(e.data);this._textAreaState=textAreaState_1.TextAreaState.readFromTextArea(this._textArea),this._onType.fire(typeInput),this._onCompositionUpdate.fire(e)}))),this._register(this._textArea.onCompositionEnd((e=>{textAreaState_1._debugComposition&&console.log("[compositionend]",e);const currentComposition=this._currentComposition;if(!currentComposition)return;if(this._currentComposition=null,this._browser.isAndroid){const newState=textAreaState_1.TextAreaState.readFromTextArea(this._textArea),typeInput=textAreaState_1.TextAreaState.deduceAndroidCompositionInput(this._textAreaState,newState);return this._textAreaState=newState,this._onType.fire(typeInput),void this._onCompositionEnd.fire()}const typeInput=currentComposition.handleCompositionUpdate(e.data);this._textAreaState=textAreaState_1.TextAreaState.readFromTextArea(this._textArea),this._onType.fire(typeInput),this._onCompositionEnd.fire()}))),this._register(this._textArea.onInput((e=>{if(textAreaState_1._debugComposition&&console.log("[input]",e),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const newState=textAreaState_1.TextAreaState.readFromTextArea(this._textArea),typeInput=textAreaState_1.TextAreaState.deduceInput(this._textAreaState,newState,2===this._OS);0===typeInput.replacePrevCharCnt&&1===typeInput.text.length&&strings.isHighSurrogate(typeInput.text.charCodeAt(0))||(this._textAreaState=newState,""===typeInput.text&&0===typeInput.replacePrevCharCnt&&0===typeInput.replaceNextCharCnt&&0===typeInput.positionDelta||this._onType.fire(typeInput))}))),this._register(this._textArea.onCut((e=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(e),this._asyncTriggerCut.schedule()}))),this._register(this._textArea.onCopy((e=>{this._ensureClipboardGetsEditorSelection(e)}))),this._register(this._textArea.onPaste((e=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),e.preventDefault(),!e.clipboardData)return;let[text,metadata]=ClipboardEventUtils.getTextData(e.clipboardData);text&&(metadata=metadata||InMemoryClipboardMetadataManager.INSTANCE.get(text),this._onPaste.fire({text,metadata}))}))),this._register(this._textArea.onFocus((()=>{const hadFocus=this._hasFocus;this._setHasFocus(!0),this._browser.isSafari&&!hadFocus&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()}))),this._register(this._textArea.onBlur((()=>{this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)}))),this._register(this._textArea.onSyntheticTap((()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())})))}_installSelectionChangeListener(){let previousSelectionChangeEventTime=0;return dom.addDisposableListener(document,"selectionchange",(e=>{if(!this._hasFocus)return;if(this._currentComposition)return;if(!this._browser.isChrome)return;const now=Date.now(),delta1=now-previousSelectionChangeEventTime;if(previousSelectionChangeEventTime=now,delta1<5)return;const delta2=now-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),delta2<100)return;if(!this._textAreaState.selectionStartPosition||!this._textAreaState.selectionEndPosition)return;const newValue=this._textArea.getValue();if(this._textAreaState.value!==newValue)return;const newSelectionStart=this._textArea.getSelectionStart(),newSelectionEnd=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===newSelectionStart&&this._textAreaState.selectionEnd===newSelectionEnd)return;const _newSelectionStartPosition=this._textAreaState.deduceEditorPosition(newSelectionStart),newSelectionStartPosition=this._host.deduceModelPosition(_newSelectionStartPosition[0],_newSelectionStartPosition[1],_newSelectionStartPosition[2]),_newSelectionEndPosition=this._textAreaState.deduceEditorPosition(newSelectionEnd),newSelectionEndPosition=this._host.deduceModelPosition(_newSelectionEndPosition[0],_newSelectionEndPosition[1],_newSelectionEndPosition[2]),newSelection=new selection_1.Selection(newSelectionStartPosition.lineNumber,newSelectionStartPosition.column,newSelectionEndPosition.lineNumber,newSelectionEndPosition.column);this._onSelectionChangeRequest.fire(newSelection)}))}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(newHasFocus){this._hasFocus!==newHasFocus&&(this._hasFocus=newHasFocus,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(reason,textAreaState){this._hasFocus||(textAreaState=textAreaState.collapseSelection()),textAreaState.writeToTextArea(reason,this._textArea,this._hasFocus),this._textAreaState=textAreaState}writeScreenReaderContent(reason){this._currentComposition||this._setAndWriteTextAreaState(reason,this._host.getScreenReaderContent(this._textAreaState))}_ensureClipboardGetsEditorSelection(e){const dataToCopy=this._host.getDataToCopy(),storedMetadata={version:1,isFromEmptySelection:dataToCopy.isFromEmptySelection,multicursorText:dataToCopy.multicursorText,mode:dataToCopy.mode};InMemoryClipboardMetadataManager.INSTANCE.set(this._browser.isFirefox?dataToCopy.text.replace(/\r\n/g,"\n"):dataToCopy.text,storedMetadata),e.preventDefault(),e.clipboardData&&ClipboardEventUtils.setTextData(e.clipboardData,dataToCopy.text,dataToCopy.html,storedMetadata)}}exports.TextAreaInput=TextAreaInput;class ClipboardEventUtils{static getTextData(clipboardData){const text=clipboardData.getData(mime_1.Mimes.text);let metadata=null;const rawmetadata=clipboardData.getData("vscode-editor-data");if("string"==typeof rawmetadata)try{metadata=JSON.parse(rawmetadata),1!==metadata.version&&(metadata=null)}catch(err){}return[text,metadata]}static setTextData(clipboardData,text,html,metadata){clipboardData.setData(mime_1.Mimes.text,text),"string"==typeof html&&clipboardData.setData("text/html",html),clipboardData.setData("vscode-editor-data",JSON.stringify(metadata))}}class TextAreaWrapper extends lifecycle_1.Disposable{constructor(_actual){super(),this._actual=_actual,this.onKeyDown=this._register(dom.createEventEmitter(this._actual,"keydown")).event,this.onKeyUp=this._register(dom.createEventEmitter(this._actual,"keyup")).event,this.onCompositionStart=this._register(dom.createEventEmitter(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(dom.createEventEmitter(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(dom.createEventEmitter(this._actual,"compositionend")).event,this.onInput=this._register(dom.createEventEmitter(this._actual,"input")).event,this.onCut=this._register(dom.createEventEmitter(this._actual,"cut")).event,this.onCopy=this._register(dom.createEventEmitter(this._actual,"copy")).event,this.onPaste=this._register(dom.createEventEmitter(this._actual,"paste")).event,this.onFocus=this._register(dom.createEventEmitter(this._actual,"focus")).event,this.onBlur=this._register(dom.createEventEmitter(this._actual,"blur")).event,this._onSyntheticTap=this._register(new event_1.Emitter),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(dom.addDisposableListener(this._actual,TextAreaSyntethicEvents.Tap,(()=>this._onSyntheticTap.fire())))}hasFocus(){const shadowRoot=dom.getShadowRoot(this._actual);return shadowRoot?shadowRoot.activeElement===this._actual:!!dom.isInDOM(this._actual)&&document.activeElement===this._actual}setIgnoreSelectionChangeTime(reason){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(reason,value){const textArea=this._actual;textArea.value!==value&&(this.setIgnoreSelectionChangeTime("setValue"),textArea.value=value)}getSelectionStart(){return"backward"===this._actual.selectionDirection?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return"backward"===this._actual.selectionDirection?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(reason,selectionStart,selectionEnd){const textArea=this._actual;let activeElement=null;const shadowRoot=dom.getShadowRoot(textArea);activeElement=shadowRoot?shadowRoot.activeElement:document.activeElement;const currentIsFocused=activeElement===textArea,currentSelectionStart=textArea.selectionStart,currentSelectionEnd=textArea.selectionEnd;if(currentIsFocused&&currentSelectionStart===selectionStart&&currentSelectionEnd===selectionEnd)browser.isFirefox&&window.parent!==window&&textArea.focus();else{if(currentIsFocused)return this.setIgnoreSelectionChangeTime("setSelectionRange"),textArea.setSelectionRange(selectionStart,selectionEnd),void(browser.isFirefox&&window.parent!==window&&textArea.focus());try{const scrollState=dom.saveParentsScrollTop(textArea);this.setIgnoreSelectionChangeTime("setSelectionRange"),textArea.focus(),textArea.setSelectionRange(selectionStart,selectionEnd),dom.restoreParentsScrollTop(textArea,scrollState)}catch(e){}}}}exports.TextAreaWrapper=TextAreaWrapper})),define(__m[100],__M([1,0,22]),(function(require,exports,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaceCommandThatPreservesSelection=exports.ReplaceCommandWithOffsetCursorState=exports.ReplaceCommandWithoutChangingPosition=exports.ReplaceCommandThatSelectsText=exports.ReplaceCommand=void 0;exports.ReplaceCommand=class ReplaceCommand{constructor(range,text,insertsAutoWhitespace=!1){this._range=range,this._text=text,this.insertsAutoWhitespace=insertsAutoWhitespace}getEditOperations(model,builder){builder.addTrackedEditOperation(this._range,this._text)}computeCursorState(model,helper){const srcRange=helper.getInverseEditOperations()[0].range;return selection_1.Selection.fromPositions(srcRange.getEndPosition())}};exports.ReplaceCommandThatSelectsText=class ReplaceCommandThatSelectsText{constructor(range,text){this._range=range,this._text=text}getEditOperations(model,builder){builder.addTrackedEditOperation(this._range,this._text)}computeCursorState(model,helper){const srcRange=helper.getInverseEditOperations()[0].range;return selection_1.Selection.fromRange(srcRange,0)}};exports.ReplaceCommandWithoutChangingPosition=class ReplaceCommandWithoutChangingPosition{constructor(range,text,insertsAutoWhitespace=!1){this._range=range,this._text=text,this.insertsAutoWhitespace=insertsAutoWhitespace}getEditOperations(model,builder){builder.addTrackedEditOperation(this._range,this._text)}computeCursorState(model,helper){const srcRange=helper.getInverseEditOperations()[0].range;return selection_1.Selection.fromPositions(srcRange.getStartPosition())}};exports.ReplaceCommandWithOffsetCursorState=class ReplaceCommandWithOffsetCursorState{constructor(range,text,lineNumberDeltaOffset,columnDeltaOffset,insertsAutoWhitespace=!1){this._range=range,this._text=text,this._columnDeltaOffset=columnDeltaOffset,this._lineNumberDeltaOffset=lineNumberDeltaOffset,this.insertsAutoWhitespace=insertsAutoWhitespace}getEditOperations(model,builder){builder.addTrackedEditOperation(this._range,this._text)}computeCursorState(model,helper){const srcRange=helper.getInverseEditOperations()[0].range;return selection_1.Selection.fromPositions(srcRange.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}};exports.ReplaceCommandThatPreservesSelection=class ReplaceCommandThatPreservesSelection{constructor(editRange,text,initialSelection,forceMoveMarkers=!1){this._range=editRange,this._text=text,this._initialSelection=initialSelection,this._forceMoveMarkers=forceMoveMarkers,this._selectionId=null}getEditOperations(model,builder){builder.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=builder.trackSelection(this._initialSelection)}computeCursorState(model,helper){return helper.getTrackedSelection(this._selectionId)}}})),define(__m[406],__M([1,0,3,22]),(function(require,exports,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SurroundSelectionCommand=void 0;exports.SurroundSelectionCommand=class SurroundSelectionCommand{constructor(range,charBeforeSelection,charAfterSelection){this._range=range,this._charBeforeSelection=charBeforeSelection,this._charAfterSelection=charAfterSelection}getEditOperations(model,builder){builder.addTrackedEditOperation(new range_1.Range(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),builder.addTrackedEditOperation(new range_1.Range(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(model,helper){const inverseEditOperations=helper.getInverseEditOperations(),firstOperationRange=inverseEditOperations[0].range,secondOperationRange=inverseEditOperations[1].range;return new selection_1.Selection(firstOperationRange.endLineNumber,firstOperationRange.endColumn,secondOperationRange.endLineNumber,secondOperationRange.endColumn-this._charAfterSelection.length)}}})),define(__m[93],__M([1,0,8,16,112]),(function(require,exports,strings,platform,buffer){"use strict";let _utf16LE_TextDecoder,_utf16BE_TextDecoder,_platformTextDecoder;function getUTF16LE_TextDecoder(){return _utf16LE_TextDecoder||(_utf16LE_TextDecoder=new TextDecoder("UTF-16LE")),_utf16LE_TextDecoder}function getPlatformTextDecoder(){return _platformTextDecoder||(_platformTextDecoder=platform.isLittleEndian()?getUTF16LE_TextDecoder():function getUTF16BE_TextDecoder(){return _utf16BE_TextDecoder||(_utf16BE_TextDecoder=new TextDecoder("UTF-16BE")),_utf16BE_TextDecoder}()),_platformTextDecoder}function compatDecodeUTF16LE(source,offset,len){const result=[];let resultLen=0;for(let i=0;i<len;i++){const charCode=buffer.readUInt16LE(source,offset);offset+=2,result[resultLen++]=String.fromCharCode(charCode)}return result.join("")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeUTF16LE=exports.createStringBuilder=exports.hasTextDecoder=exports.getPlatformTextDecoder=void 0,exports.getPlatformTextDecoder=getPlatformTextDecoder,exports.hasTextDecoder="undefined"!=typeof TextDecoder,exports.hasTextDecoder?(exports.createStringBuilder=capacity=>new StringBuilder(capacity),exports.decodeUTF16LE=function standardDecodeUTF16LE(source,offset,len){const view=new Uint16Array(source.buffer,offset,len);if(len>0&&(65279===view[0]||65534===view[0]))return compatDecodeUTF16LE(source,offset,len);return getUTF16LE_TextDecoder().decode(view)}):(exports.createStringBuilder=capacity=>new CompatStringBuilder,exports.decodeUTF16LE=compatDecodeUTF16LE);class StringBuilder{constructor(capacity){this._capacity=0|capacity,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return null!==this._completedStrings?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(0===this._bufferLength)return"";const view=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return getPlatformTextDecoder().decode(view)}_flushBuffer(){const bufferString=this._buildBuffer();this._bufferLength=0,null===this._completedStrings?this._completedStrings=[bufferString]:this._completedStrings[this._completedStrings.length]=bufferString}write1(charCode){const remainingSpace=this._capacity-this._bufferLength;remainingSpace<=1&&(0===remainingSpace||strings.isHighSurrogate(charCode))&&this._flushBuffer(),this._buffer[this._bufferLength++]=charCode}appendASCII(charCode){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=charCode}appendASCIIString(str){const strLen=str.length;if(this._bufferLength+strLen>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=str);for(let i=0;i<strLen;i++)this._buffer[this._bufferLength++]=str.charCodeAt(i)}}class CompatStringBuilder{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(charCode){this._pieces[this._piecesLen++]=String.fromCharCode(charCode)}appendASCII(charCode){this._pieces[this._piecesLen++]=String.fromCharCode(charCode)}appendASCIIString(str){this._pieces[this._piecesLen++]=str}}})),define(__m[179],__M([1,0,31,93]),(function(require,exports,fastDomNode_1,stringBuilder_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.VisibleLinesCollection=exports.RenderedLinesCollection=void 0;class RenderedLinesCollection{constructor(createLine){this._createLine=createLine,this._set(1,[])}flush(){this._set(1,[])}_set(rendLineNumberStart,lines){this._lines=lines,this._rendLineNumberStart=rendLineNumberStart}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(lineNumber){const lineIndex=lineNumber-this._rendLineNumberStart;if(lineIndex<0||lineIndex>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[lineIndex]}onLinesDeleted(deleteFromLineNumber,deleteToLineNumber){if(0===this.getCount())return null;const startLineNumber=this.getStartLineNumber(),endLineNumber=this.getEndLineNumber();if(deleteToLineNumber<startLineNumber){const deleteCnt=deleteToLineNumber-deleteFromLineNumber+1;return this._rendLineNumberStart-=deleteCnt,null}if(deleteFromLineNumber>endLineNumber)return null;let deleteStartIndex=0,deleteCount=0;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const lineIndex=lineNumber-this._rendLineNumberStart;deleteFromLineNumber<=lineNumber&&lineNumber<=deleteToLineNumber&&(0===deleteCount?(deleteStartIndex=lineIndex,deleteCount=1):deleteCount++)}if(deleteFromLineNumber<startLineNumber){let deleteAboveCount=0;deleteAboveCount=deleteToLineNumber<startLineNumber?deleteToLineNumber-deleteFromLineNumber+1:startLineNumber-deleteFromLineNumber,this._rendLineNumberStart-=deleteAboveCount}return this._lines.splice(deleteStartIndex,deleteCount)}onLinesChanged(changeFromLineNumber,changeToLineNumber){if(0===this.getCount())return!1;const startLineNumber=this.getStartLineNumber(),endLineNumber=this.getEndLineNumber();let someoneNotified=!1;for(let changedLineNumber=changeFromLineNumber;changedLineNumber<=changeToLineNumber;changedLineNumber++)changedLineNumber>=startLineNumber&&changedLineNumber<=endLineNumber&&(this._lines[changedLineNumber-this._rendLineNumberStart].onContentChanged(),someoneNotified=!0);return someoneNotified}onLinesInserted(insertFromLineNumber,insertToLineNumber){if(0===this.getCount())return null;const insertCnt=insertToLineNumber-insertFromLineNumber+1,startLineNumber=this.getStartLineNumber(),endLineNumber=this.getEndLineNumber();if(insertFromLineNumber<=startLineNumber)return this._rendLineNumberStart+=insertCnt,null;if(insertFromLineNumber>endLineNumber)return null;if(insertCnt+insertFromLineNumber>endLineNumber){return this._lines.splice(insertFromLineNumber-this._rendLineNumberStart,endLineNumber-insertFromLineNumber+1)}const newLines=[];for(let i=0;i<insertCnt;i++)newLines[i]=this._createLine();const insertIndex=insertFromLineNumber-this._rendLineNumberStart,beforeLines=this._lines.slice(0,insertIndex),afterLines=this._lines.slice(insertIndex,this._lines.length-insertCnt),deletedLines=this._lines.slice(this._lines.length-insertCnt,this._lines.length);return this._lines=beforeLines.concat(newLines).concat(afterLines),deletedLines}onTokensChanged(ranges){if(0===this.getCount())return!1;const startLineNumber=this.getStartLineNumber(),endLineNumber=this.getEndLineNumber();let notifiedSomeone=!1;for(let i=0,len=ranges.length;i<len;i++){const rng=ranges[i];if(rng.toLineNumber<startLineNumber||rng.fromLineNumber>endLineNumber)continue;const from=Math.max(startLineNumber,rng.fromLineNumber),to=Math.min(endLineNumber,rng.toLineNumber);for(let lineNumber=from;lineNumber<=to;lineNumber++){const lineIndex=lineNumber-this._rendLineNumberStart;this._lines[lineIndex].onTokensChanged(),notifiedSomeone=!0}}return notifiedSomeone}}exports.RenderedLinesCollection=RenderedLinesCollection;exports.VisibleLinesCollection=class VisibleLinesCollection{constructor(host){this._host=host,this.domNode=this._createDomNode(),this._linesCollection=new RenderedLinesCollection((()=>this._host.createVisibleLine()))}_createDomNode(){const domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div"));return domNode.setClassName("view-layer"),domNode.setPosition("absolute"),domNode.domNode.setAttribute("role","presentation"),domNode.domNode.setAttribute("aria-hidden","true"),domNode}onConfigurationChanged(e){return!!e.hasChanged(131)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){const deleted=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(deleted)for(let i=0,len=deleted.length;i<len;i++){const lineDomNode=deleted[i].getDomNode();lineDomNode&&this.domNode.domNode.removeChild(lineDomNode)}return!0}onLinesInserted(e){const deleted=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(deleted)for(let i=0,len=deleted.length;i<len;i++){const lineDomNode=deleted[i].getDomNode();lineDomNode&&this.domNode.domNode.removeChild(lineDomNode)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(lineNumber){return this._linesCollection.getLine(lineNumber)}renderLines(viewportData){const inp=this._linesCollection._get(),renderer=new ViewLayerRenderer(this.domNode.domNode,this._host,viewportData),ctx={rendLineNumberStart:inp.rendLineNumberStart,lines:inp.lines,linesLength:inp.lines.length},resCtx=renderer.render(ctx,viewportData.startLineNumber,viewportData.endLineNumber,viewportData.relativeVerticalOffset);this._linesCollection._set(resCtx.rendLineNumberStart,resCtx.lines)}};class ViewLayerRenderer{constructor(domNode,host,viewportData){this.domNode=domNode,this.host=host,this.viewportData=viewportData}render(inContext,startLineNumber,stopLineNumber,deltaTop){const ctx={rendLineNumberStart:inContext.rendLineNumberStart,lines:inContext.lines.slice(0),linesLength:inContext.linesLength};if(ctx.rendLineNumberStart+ctx.linesLength-1<startLineNumber||stopLineNumber<ctx.rendLineNumberStart){ctx.rendLineNumberStart=startLineNumber,ctx.linesLength=stopLineNumber-startLineNumber+1,ctx.lines=[];for(let x=startLineNumber;x<=stopLineNumber;x++)ctx.lines[x-startLineNumber]=this.host.createVisibleLine();return this._finishRendering(ctx,!0,deltaTop),ctx}if(this._renderUntouchedLines(ctx,Math.max(startLineNumber-ctx.rendLineNumberStart,0),Math.min(stopLineNumber-ctx.rendLineNumberStart,ctx.linesLength-1),deltaTop,startLineNumber),ctx.rendLineNumberStart>startLineNumber){const fromLineNumber=startLineNumber,toLineNumber=Math.min(stopLineNumber,ctx.rendLineNumberStart-1);fromLineNumber<=toLineNumber&&(this._insertLinesBefore(ctx,fromLineNumber,toLineNumber,deltaTop,startLineNumber),ctx.linesLength+=toLineNumber-fromLineNumber+1)}else if(ctx.rendLineNumberStart<startLineNumber){const removeCnt=Math.min(ctx.linesLength,startLineNumber-ctx.rendLineNumberStart);removeCnt>0&&(this._removeLinesBefore(ctx,removeCnt),ctx.linesLength-=removeCnt)}if(ctx.rendLineNumberStart=startLineNumber,ctx.rendLineNumberStart+ctx.linesLength-1<stopLineNumber){const fromLineNumber=ctx.rendLineNumberStart+ctx.linesLength,toLineNumber=stopLineNumber;fromLineNumber<=toLineNumber&&(this._insertLinesAfter(ctx,fromLineNumber,toLineNumber,deltaTop,startLineNumber),ctx.linesLength+=toLineNumber-fromLineNumber+1)}else if(ctx.rendLineNumberStart+ctx.linesLength-1>stopLineNumber){const fromLineNumber=Math.max(0,stopLineNumber-ctx.rendLineNumberStart+1),removeCnt=ctx.linesLength-1-fromLineNumber+1;removeCnt>0&&(this._removeLinesAfter(ctx,removeCnt),ctx.linesLength-=removeCnt)}return this._finishRendering(ctx,!1,deltaTop),ctx}_renderUntouchedLines(ctx,startIndex,endIndex,deltaTop,deltaLN){const rendLineNumberStart=ctx.rendLineNumberStart,lines=ctx.lines;for(let i=startIndex;i<=endIndex;i++){const lineNumber=rendLineNumberStart+i;lines[i].layoutLine(lineNumber,deltaTop[lineNumber-deltaLN])}}_insertLinesBefore(ctx,fromLineNumber,toLineNumber,deltaTop,deltaLN){const newLines=[];let newLinesLen=0;for(let lineNumber=fromLineNumber;lineNumber<=toLineNumber;lineNumber++)newLines[newLinesLen++]=this.host.createVisibleLine();ctx.lines=newLines.concat(ctx.lines)}_removeLinesBefore(ctx,removeCount){for(let i=0;i<removeCount;i++){const lineDomNode=ctx.lines[i].getDomNode();lineDomNode&&this.domNode.removeChild(lineDomNode)}ctx.lines.splice(0,removeCount)}_insertLinesAfter(ctx,fromLineNumber,toLineNumber,deltaTop,deltaLN){const newLines=[];let newLinesLen=0;for(let lineNumber=fromLineNumber;lineNumber<=toLineNumber;lineNumber++)newLines[newLinesLen++]=this.host.createVisibleLine();ctx.lines=ctx.lines.concat(newLines)}_removeLinesAfter(ctx,removeCount){const removeIndex=ctx.linesLength-removeCount;for(let i=0;i<removeCount;i++){const lineDomNode=ctx.lines[removeIndex+i].getDomNode();lineDomNode&&this.domNode.removeChild(lineDomNode)}ctx.lines.splice(removeIndex,removeCount)}_finishRenderingNewLines(ctx,domNodeIsEmpty,newLinesHTML,wasNew){ViewLayerRenderer._ttPolicy&&(newLinesHTML=ViewLayerRenderer._ttPolicy.createHTML(newLinesHTML));const lastChild=this.domNode.lastChild;domNodeIsEmpty||!lastChild?this.domNode.innerHTML=newLinesHTML:lastChild.insertAdjacentHTML("afterend",newLinesHTML);let currChild=this.domNode.lastChild;for(let i=ctx.linesLength-1;i>=0;i--){const line=ctx.lines[i];wasNew[i]&&(line.setDomNode(currChild),currChild=currChild.previousSibling)}}_finishRenderingInvalidLines(ctx,invalidLinesHTML,wasInvalid){const hugeDomNode=document.createElement("div");ViewLayerRenderer._ttPolicy&&(invalidLinesHTML=ViewLayerRenderer._ttPolicy.createHTML(invalidLinesHTML)),hugeDomNode.innerHTML=invalidLinesHTML;for(let i=0;i<ctx.linesLength;i++){const line=ctx.lines[i];if(wasInvalid[i]){const source=hugeDomNode.firstChild,lineDomNode=line.getDomNode();lineDomNode.parentNode.replaceChild(source,lineDomNode),line.setDomNode(source)}}}_finishRendering(ctx,domNodeIsEmpty,deltaTop){const sb=ViewLayerRenderer._sb,linesLength=ctx.linesLength,lines=ctx.lines,rendLineNumberStart=ctx.rendLineNumberStart,wasNew=[];{sb.reset();let hadNewLine=!1;for(let i=0;i<linesLength;i++){const line=lines[i];wasNew[i]=!1;if(line.getDomNode())continue;line.renderLine(i+rendLineNumberStart,deltaTop[i],this.viewportData,sb)&&(wasNew[i]=!0,hadNewLine=!0)}hadNewLine&&this._finishRenderingNewLines(ctx,domNodeIsEmpty,sb.build(),wasNew)}{sb.reset();let hadInvalidLine=!1;const wasInvalid=[];for(let i=0;i<linesLength;i++){const line=lines[i];if(wasInvalid[i]=!1,wasNew[i])continue;line.renderLine(i+rendLineNumberStart,deltaTop[i],this.viewportData,sb)&&(wasInvalid[i]=!0,hadInvalidLine=!0)}hadInvalidLine&&this._finishRenderingInvalidLines(ctx,sb.build(),wasInvalid)}}}ViewLayerRenderer._ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("editorViewLayer",{createHTML:value=>value}),ViewLayerRenderer._sb=(0,stringBuilder_1.createStringBuilder)(1e5)})),define(__m[240],__M([1,0,112,93]),(function(require,exports,buffer,stringBuilder_1){"use strict";function escapeNewLine(str){return str.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compressConsecutiveTextChanges=exports.TextChange=void 0;class TextChange{constructor(oldPosition,oldText,newPosition,newText){this.oldPosition=oldPosition,this.oldText=oldText,this.newPosition=newPosition,this.newText=newText}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return 0===this.oldText.length?`(insert@${this.oldPosition} "${escapeNewLine(this.newText)}")`:0===this.newText.length?`(delete@${this.oldPosition} "${escapeNewLine(this.oldText)}")`:`(replace@${this.oldPosition} "${escapeNewLine(this.oldText)}" with "${escapeNewLine(this.newText)}")`}static _writeStringSize(str){return 4+2*str.length}static _writeString(b,str,offset){const len=str.length;buffer.writeUInt32BE(b,len,offset),offset+=4;for(let i=0;i<len;i++)buffer.writeUInt16LE(b,str.charCodeAt(i),offset),offset+=2;return offset}static _readString(b,offset){const len=buffer.readUInt32BE(b,offset);return offset+=4,(0,stringBuilder_1.decodeUTF16LE)(b,offset,len)}writeSize(){return 8+TextChange._writeStringSize(this.oldText)+TextChange._writeStringSize(this.newText)}write(b,offset){return buffer.writeUInt32BE(b,this.oldPosition,offset),offset+=4,buffer.writeUInt32BE(b,this.newPosition,offset),offset+=4,offset=TextChange._writeString(b,this.oldText,offset),offset=TextChange._writeString(b,this.newText,offset)}static read(b,offset,dest){const oldPosition=buffer.readUInt32BE(b,offset);offset+=4;const newPosition=buffer.readUInt32BE(b,offset);offset+=4;const oldText=TextChange._readString(b,offset);offset+=TextChange._writeStringSize(oldText);const newText=TextChange._readString(b,offset);return offset+=TextChange._writeStringSize(newText),dest.push(new TextChange(oldPosition,oldText,newPosition,newText)),offset}}exports.TextChange=TextChange,exports.compressConsecutiveTextChanges=function compressConsecutiveTextChanges(prevEdits,currEdits){return null===prevEdits||0===prevEdits.length?currEdits:new TextChangeCompressor(prevEdits,currEdits).compress()};class TextChangeCompressor{constructor(prevEdits,currEdits){this._prevEdits=prevEdits,this._currEdits=currEdits,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let prevIndex=0,currIndex=0,prevEdit=this._getPrev(prevIndex),currEdit=this._getCurr(currIndex);for(;prevIndex<this._prevLen||currIndex<this._currLen;){if(null===prevEdit){this._acceptCurr(currEdit),currEdit=this._getCurr(++currIndex);continue}if(null===currEdit){this._acceptPrev(prevEdit),prevEdit=this._getPrev(++prevIndex);continue}if(currEdit.oldEnd<=prevEdit.newPosition){this._acceptCurr(currEdit),currEdit=this._getCurr(++currIndex);continue}if(prevEdit.newEnd<=currEdit.oldPosition){this._acceptPrev(prevEdit),prevEdit=this._getPrev(++prevIndex);continue}if(currEdit.oldPosition<prevEdit.newPosition){const[e1,e2]=TextChangeCompressor._splitCurr(currEdit,prevEdit.newPosition-currEdit.oldPosition);this._acceptCurr(e1),currEdit=e2;continue}if(prevEdit.newPosition<currEdit.oldPosition){const[e1,e2]=TextChangeCompressor._splitPrev(prevEdit,currEdit.oldPosition-prevEdit.newPosition);this._acceptPrev(e1),prevEdit=e2;continue}let mergePrev,mergeCurr;if(currEdit.oldEnd===prevEdit.newEnd)mergePrev=prevEdit,mergeCurr=currEdit,prevEdit=this._getPrev(++prevIndex),currEdit=this._getCurr(++currIndex);else if(currEdit.oldEnd<prevEdit.newEnd){const[e1,e2]=TextChangeCompressor._splitPrev(prevEdit,currEdit.oldLength);mergePrev=e1,mergeCurr=currEdit,prevEdit=e2,currEdit=this._getCurr(++currIndex)}else{const[e1,e2]=TextChangeCompressor._splitCurr(currEdit,prevEdit.newLength);mergePrev=prevEdit,mergeCurr=e1,prevEdit=this._getPrev(++prevIndex),currEdit=e2}this._result[this._resultLen++]=new TextChange(mergePrev.oldPosition,mergePrev.oldText,mergeCurr.newPosition,mergeCurr.newText),this._prevDeltaOffset+=mergePrev.newLength-mergePrev.oldLength,this._currDeltaOffset+=mergeCurr.newLength-mergeCurr.oldLength}const merged=TextChangeCompressor._merge(this._result);return TextChangeCompressor._removeNoOps(merged)}_acceptCurr(currEdit){this._result[this._resultLen++]=TextChangeCompressor._rebaseCurr(this._prevDeltaOffset,currEdit),this._currDeltaOffset+=currEdit.newLength-currEdit.oldLength}_getCurr(currIndex){return currIndex<this._currLen?this._currEdits[currIndex]:null}_acceptPrev(prevEdit){this._result[this._resultLen++]=TextChangeCompressor._rebasePrev(this._currDeltaOffset,prevEdit),this._prevDeltaOffset+=prevEdit.newLength-prevEdit.oldLength}_getPrev(prevIndex){return prevIndex<this._prevLen?this._prevEdits[prevIndex]:null}static _rebaseCurr(prevDeltaOffset,currEdit){return new TextChange(currEdit.oldPosition-prevDeltaOffset,currEdit.oldText,currEdit.newPosition,currEdit.newText)}static _rebasePrev(currDeltaOffset,prevEdit){return new TextChange(prevEdit.oldPosition,prevEdit.oldText,prevEdit.newPosition+currDeltaOffset,prevEdit.newText)}static _splitPrev(edit,offset){const preText=edit.newText.substr(0,offset),postText=edit.newText.substr(offset);return[new TextChange(edit.oldPosition,edit.oldText,edit.newPosition,preText),new TextChange(edit.oldEnd,"",edit.newPosition+offset,postText)]}static _splitCurr(edit,offset){const preText=edit.oldText.substr(0,offset),postText=edit.oldText.substr(offset);return[new TextChange(edit.oldPosition,preText,edit.newPosition,edit.newText),new TextChange(edit.oldPosition+offset,postText,edit.newEnd,"")]}static _merge(edits){if(0===edits.length)return edits;const result=[];let resultLen=0,prev=edits[0];for(let i=1;i<edits.length;i++){const curr=edits[i];prev.oldEnd===curr.oldPosition?prev=new TextChange(prev.oldPosition,prev.oldText+curr.oldText,prev.newPosition,prev.newText+curr.newText):(result[resultLen++]=prev,prev=curr)}return result[resultLen++]=prev,result}static _removeNoOps(edits){if(0===edits.length)return edits;const result=[];let resultLen=0;for(let i=0;i<edits.length;i++){const edit=edits[i];edit.oldText!==edit.newText&&(result[resultLen++]=edit)}return result}}})),define(__m[148],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EDITOR_MODEL_DEFAULTS=void 0,exports.EDITOR_MODEL_DEFAULTS={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!1}}})),define(__m[120],__M([1,0,99]),(function(require,exports,characterClassifier_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMapForWordSeparators=exports.WordCharacterClassifier=void 0;class WordCharacterClassifier extends characterClassifier_1.CharacterClassifier{constructor(wordSeparators){super(0);for(let i=0,len=wordSeparators.length;i<len;i++)this.set(wordSeparators.charCodeAt(i),2);this.set(32,1),this.set(9,1)}}exports.WordCharacterClassifier=WordCharacterClassifier,exports.getMapForWordSeparators=function once(computeFn){const cache={};return input=>(cache.hasOwnProperty(input)||(cache[input]=computeFn(input)),cache[input])}((input=>new WordCharacterClassifier(input)))})),define(__m[121],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getWordAtText=exports.ensureValidWordDefinition=exports.DEFAULT_WORD_REGEXP=exports.USUAL_WORD_SEPARATORS=void 0,exports.USUAL_WORD_SEPARATORS="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?",exports.DEFAULT_WORD_REGEXP=function createWordRegExp(allowInWords=""){let source="(-?\\d*\\.\\d\\w*)|([^";for(const sep of exports.USUAL_WORD_SEPARATORS)allowInWords.indexOf(sep)>=0||(source+="\\"+sep);return source+="\\s]+)",new RegExp(source,"g")}(),exports.ensureValidWordDefinition=function ensureValidWordDefinition(wordDefinition){let result=exports.DEFAULT_WORD_REGEXP;if(wordDefinition&&wordDefinition instanceof RegExp)if(wordDefinition.global)result=wordDefinition;else{let flags="g";wordDefinition.ignoreCase&&(flags+="i"),wordDefinition.multiline&&(flags+="m"),wordDefinition.unicode&&(flags+="u"),result=new RegExp(wordDefinition.source,flags)}return result.lastIndex=0,result};const _defaultConfig={maxLen:1e3,windowSize:15,timeBudget:150};function _findRegexMatchEnclosingPosition(wordDefinition,text,pos,stopPos){let match;for(;match=wordDefinition.exec(text);){const matchIndex=match.index||0;if(matchIndex<=pos&&wordDefinition.lastIndex>=pos)return match;if(stopPos>0&&matchIndex>stopPos)return null}return null}exports.getWordAtText=function getWordAtText(column,wordDefinition,text,textOffset,config=_defaultConfig){if(text.length>config.maxLen){let start=column-config.maxLen/2;return start<0?start=0:textOffset+=start,getWordAtText(column,wordDefinition,text=text.substring(start,column+config.maxLen/2),textOffset,config)}const t1=Date.now(),pos=column-1-textOffset;let prevRegexIndex=-1,match=null;for(let i=1;!(Date.now()-t1>=config.timeBudget);i++){const regexIndex=pos-config.windowSize*i;wordDefinition.lastIndex=Math.max(0,regexIndex);const thisMatch=_findRegexMatchEnclosingPosition(wordDefinition,text,pos,prevRegexIndex);if(!thisMatch&&match)break;if(match=thisMatch,regexIndex<=0)break;prevRegexIndex=regexIndex}if(match){const result={word:match[0],startColumn:textOffset+1+match.index,endColumn:textOffset+1+match.index+match[0].length};return wordDefinition.lastIndex=0,result}return null}})),define(__m[241],__M([1,0,70]),(function(require,exports,cursorColumns_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AtomicTabMoveOperations=void 0;class AtomicTabMoveOperations{static whitespaceVisibleColumn(lineContent,position,tabSize){const lineLength=lineContent.length;let visibleColumn=0,prevTabStopPosition=-1,prevTabStopVisibleColumn=-1;for(let i=0;i<lineLength;i++){if(i===position)return[prevTabStopPosition,prevTabStopVisibleColumn,visibleColumn];visibleColumn%tabSize==0&&(prevTabStopPosition=i,prevTabStopVisibleColumn=visibleColumn);switch(lineContent.charCodeAt(i)){case 32:visibleColumn+=1;break;case 9:visibleColumn=cursorColumns_1.CursorColumns.nextRenderTabStop(visibleColumn,tabSize);break;default:return[-1,-1,-1]}}return position===lineLength?[prevTabStopPosition,prevTabStopVisibleColumn,visibleColumn]:[-1,-1,-1]}static atomicPosition(lineContent,position,tabSize,direction){const lineLength=lineContent.length,[prevTabStopPosition,prevTabStopVisibleColumn,visibleColumn]=AtomicTabMoveOperations.whitespaceVisibleColumn(lineContent,position,tabSize);if(-1===visibleColumn)return-1;let left;switch(direction){case 0:left=!0;break;case 1:left=!1;break;case 2:if(visibleColumn%tabSize==0)return position;left=visibleColumn%tabSize<=tabSize/2}if(left){if(-1===prevTabStopPosition)return-1;let currentVisibleColumn=prevTabStopVisibleColumn;for(let i=prevTabStopPosition;i<lineLength;++i){if(currentVisibleColumn===prevTabStopVisibleColumn+tabSize)return prevTabStopPosition;switch(lineContent.charCodeAt(i)){case 32:currentVisibleColumn+=1;break;case 9:currentVisibleColumn=cursorColumns_1.CursorColumns.nextRenderTabStop(currentVisibleColumn,tabSize);break;default:return-1}}return currentVisibleColumn===prevTabStopVisibleColumn+tabSize?prevTabStopPosition:-1}const targetVisibleColumn=cursorColumns_1.CursorColumns.nextRenderTabStop(visibleColumn,tabSize);let currentVisibleColumn=visibleColumn;for(let i=position;i<lineLength;i++){if(currentVisibleColumn===targetVisibleColumn)return i;switch(lineContent.charCodeAt(i)){case 32:currentVisibleColumn+=1;break;case 9:currentVisibleColumn=cursorColumns_1.CursorColumns.nextRenderTabStop(currentVisibleColumn,tabSize);break;default:return-1}}return currentVisibleColumn===targetVisibleColumn?lineLength:-1}}exports.AtomicTabMoveOperations=AtomicTabMoveOperations})),define(__m[407],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorContext=void 0;exports.CursorContext=class CursorContext{constructor(model,viewModel,coordinatesConverter,cursorConfig){this._cursorContextBrand=void 0,this.model=model,this.viewModel=viewModel,this.coordinatesConverter=coordinatesConverter,this.cursorConfig=cursorConfig}}})),define(__m[408],__M([1,0,141,8]),(function(require,exports,diff_1,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DiffComputer=void 0;function computeDiff(originalSequence,modifiedSequence,continueProcessingPredicate,pretty){return new diff_1.LcsDiff(originalSequence,modifiedSequence,continueProcessingPredicate).ComputeDiff(pretty)}class LineSequence{constructor(lines){const startColumns=[],endColumns=[];for(let i=0,length=lines.length;i<length;i++)startColumns[i]=getFirstNonBlankColumn(lines[i],1),endColumns[i]=getLastNonBlankColumn(lines[i],1);this.lines=lines,this._startColumns=startColumns,this._endColumns=endColumns}getElements(){const elements=[];for(let i=0,len=this.lines.length;i<len;i++)elements[i]=this.lines[i].substring(this._startColumns[i]-1,this._endColumns[i]-1);return elements}getStrictElement(index){return this.lines[index]}getStartLineNumber(i){return i+1}getEndLineNumber(i){return i+1}createCharSequence(shouldIgnoreTrimWhitespace,startIndex,endIndex){const charCodes=[],lineNumbers=[],columns=[];let len=0;for(let index=startIndex;index<=endIndex;index++){const lineContent=this.lines[index],startColumn=shouldIgnoreTrimWhitespace?this._startColumns[index]:1,endColumn=shouldIgnoreTrimWhitespace?this._endColumns[index]:lineContent.length+1;for(let col=startColumn;col<endColumn;col++)charCodes[len]=lineContent.charCodeAt(col-1),lineNumbers[len]=index+1,columns[len]=col,len++}return new CharSequence(charCodes,lineNumbers,columns)}}class CharSequence{constructor(charCodes,lineNumbers,columns){this._charCodes=charCodes,this._lineNumbers=lineNumbers,this._columns=columns}getElements(){return this._charCodes}getStartLineNumber(i){return this._lineNumbers[i]}getStartColumn(i){return this._columns[i]}getEndLineNumber(i){return this._lineNumbers[i]}getEndColumn(i){return this._columns[i]+1}}class CharChange{constructor(originalStartLineNumber,originalStartColumn,originalEndLineNumber,originalEndColumn,modifiedStartLineNumber,modifiedStartColumn,modifiedEndLineNumber,modifiedEndColumn){this.originalStartLineNumber=originalStartLineNumber,this.originalStartColumn=originalStartColumn,this.originalEndLineNumber=originalEndLineNumber,this.originalEndColumn=originalEndColumn,this.modifiedStartLineNumber=modifiedStartLineNumber,this.modifiedStartColumn=modifiedStartColumn,this.modifiedEndLineNumber=modifiedEndLineNumber,this.modifiedEndColumn=modifiedEndColumn}static createFromDiffChange(diffChange,originalCharSequence,modifiedCharSequence){let originalStartLineNumber,originalStartColumn,originalEndLineNumber,originalEndColumn,modifiedStartLineNumber,modifiedStartColumn,modifiedEndLineNumber,modifiedEndColumn;return 0===diffChange.originalLength?(originalStartLineNumber=0,originalStartColumn=0,originalEndLineNumber=0,originalEndColumn=0):(originalStartLineNumber=originalCharSequence.getStartLineNumber(diffChange.originalStart),originalStartColumn=originalCharSequence.getStartColumn(diffChange.originalStart),originalEndLineNumber=originalCharSequence.getEndLineNumber(diffChange.originalStart+diffChange.originalLength-1),originalEndColumn=originalCharSequence.getEndColumn(diffChange.originalStart+diffChange.originalLength-1)),0===diffChange.modifiedLength?(modifiedStartLineNumber=0,modifiedStartColumn=0,modifiedEndLineNumber=0,modifiedEndColumn=0):(modifiedStartLineNumber=modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart),modifiedStartColumn=modifiedCharSequence.getStartColumn(diffChange.modifiedStart),modifiedEndLineNumber=modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart+diffChange.modifiedLength-1),modifiedEndColumn=modifiedCharSequence.getEndColumn(diffChange.modifiedStart+diffChange.modifiedLength-1)),new CharChange(originalStartLineNumber,originalStartColumn,originalEndLineNumber,originalEndColumn,modifiedStartLineNumber,modifiedStartColumn,modifiedEndLineNumber,modifiedEndColumn)}}class LineChange{constructor(originalStartLineNumber,originalEndLineNumber,modifiedStartLineNumber,modifiedEndLineNumber,charChanges){this.originalStartLineNumber=originalStartLineNumber,this.originalEndLineNumber=originalEndLineNumber,this.modifiedStartLineNumber=modifiedStartLineNumber,this.modifiedEndLineNumber=modifiedEndLineNumber,this.charChanges=charChanges}static createFromDiffResult(shouldIgnoreTrimWhitespace,diffChange,originalLineSequence,modifiedLineSequence,continueCharDiff,shouldComputeCharChanges,shouldPostProcessCharChanges){let originalStartLineNumber,originalEndLineNumber,modifiedStartLineNumber,modifiedEndLineNumber,charChanges;if(0===diffChange.originalLength?(originalStartLineNumber=originalLineSequence.getStartLineNumber(diffChange.originalStart)-1,originalEndLineNumber=0):(originalStartLineNumber=originalLineSequence.getStartLineNumber(diffChange.originalStart),originalEndLineNumber=originalLineSequence.getEndLineNumber(diffChange.originalStart+diffChange.originalLength-1)),0===diffChange.modifiedLength?(modifiedStartLineNumber=modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart)-1,modifiedEndLineNumber=0):(modifiedStartLineNumber=modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart),modifiedEndLineNumber=modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart+diffChange.modifiedLength-1)),shouldComputeCharChanges&&diffChange.originalLength>0&&diffChange.originalLength<20&&diffChange.modifiedLength>0&&diffChange.modifiedLength<20&&continueCharDiff()){const originalCharSequence=originalLineSequence.createCharSequence(shouldIgnoreTrimWhitespace,diffChange.originalStart,diffChange.originalStart+diffChange.originalLength-1),modifiedCharSequence=modifiedLineSequence.createCharSequence(shouldIgnoreTrimWhitespace,diffChange.modifiedStart,diffChange.modifiedStart+diffChange.modifiedLength-1);let rawChanges=computeDiff(originalCharSequence,modifiedCharSequence,continueCharDiff,!0).changes;shouldPostProcessCharChanges&&(rawChanges=function postProcessCharChanges(rawChanges){if(rawChanges.length<=1)return rawChanges;const result=[rawChanges[0]];let prevChange=result[0];for(let i=1,len=rawChanges.length;i<len;i++){const currChange=rawChanges[i],originalMatchingLength=currChange.originalStart-(prevChange.originalStart+prevChange.originalLength),modifiedMatchingLength=currChange.modifiedStart-(prevChange.modifiedStart+prevChange.modifiedLength);Math.min(originalMatchingLength,modifiedMatchingLength)<3?(prevChange.originalLength=currChange.originalStart+currChange.originalLength-prevChange.originalStart,prevChange.modifiedLength=currChange.modifiedStart+currChange.modifiedLength-prevChange.modifiedStart):(result.push(currChange),prevChange=currChange)}return result}(rawChanges)),charChanges=[];for(let i=0,length=rawChanges.length;i<length;i++)charChanges.push(CharChange.createFromDiffChange(rawChanges[i],originalCharSequence,modifiedCharSequence))}return new LineChange(originalStartLineNumber,originalEndLineNumber,modifiedStartLineNumber,modifiedEndLineNumber,charChanges)}}function getFirstNonBlankColumn(txt,defaultValue){const r=strings.firstNonWhitespaceIndex(txt);return-1===r?defaultValue:r+1}function getLastNonBlankColumn(txt,defaultValue){const r=strings.lastNonWhitespaceIndex(txt);return-1===r?defaultValue:r+2}function createContinueProcessingPredicate(maximumRuntime){if(0===maximumRuntime)return()=>!0;const startTime=Date.now();return()=>Date.now()-startTime<maximumRuntime}exports.DiffComputer=class DiffComputer{constructor(originalLines,modifiedLines,opts){this.shouldComputeCharChanges=opts.shouldComputeCharChanges,this.shouldPostProcessCharChanges=opts.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=opts.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=opts.shouldMakePrettyDiff,this.originalLines=originalLines,this.modifiedLines=modifiedLines,this.original=new LineSequence(originalLines),this.modified=new LineSequence(modifiedLines),this.continueLineDiff=createContinueProcessingPredicate(opts.maxComputationTime),this.continueCharDiff=createContinueProcessingPredicate(0===opts.maxComputationTime?0:Math.min(opts.maxComputationTime,5e3))}computeDiff(){if(1===this.original.lines.length&&0===this.original.lines[0].length)return 1===this.modified.lines.length&&0===this.modified.lines[0].length?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(1===this.modified.lines.length&&0===this.modified.lines[0].length)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const diffResult=computeDiff(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),rawChanges=diffResult.changes,quitEarly=diffResult.quitEarly;if(this.shouldIgnoreTrimWhitespace){const lineChanges=[];for(let i=0,length=rawChanges.length;i<length;i++)lineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,rawChanges[i],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly,changes:lineChanges}}const result=[];let originalLineIndex=0,modifiedLineIndex=0;for(let i=-1,len=rawChanges.length;i<len;i++){const nextChange=i+1<len?rawChanges[i+1]:null,originalStop=nextChange?nextChange.originalStart:this.originalLines.length,modifiedStop=nextChange?nextChange.modifiedStart:this.modifiedLines.length;for(;originalLineIndex<originalStop&&modifiedLineIndex<modifiedStop;){const originalLine=this.originalLines[originalLineIndex],modifiedLine=this.modifiedLines[modifiedLineIndex];if(originalLine!==modifiedLine){{let originalStartColumn=getFirstNonBlankColumn(originalLine,1),modifiedStartColumn=getFirstNonBlankColumn(modifiedLine,1);for(;originalStartColumn>1&&modifiedStartColumn>1;){if(originalLine.charCodeAt(originalStartColumn-2)!==modifiedLine.charCodeAt(modifiedStartColumn-2))break;originalStartColumn--,modifiedStartColumn--}(originalStartColumn>1||modifiedStartColumn>1)&&this._pushTrimWhitespaceCharChange(result,originalLineIndex+1,1,originalStartColumn,modifiedLineIndex+1,1,modifiedStartColumn)}{let originalEndColumn=getLastNonBlankColumn(originalLine,1),modifiedEndColumn=getLastNonBlankColumn(modifiedLine,1);const originalMaxColumn=originalLine.length+1,modifiedMaxColumn=modifiedLine.length+1;for(;originalEndColumn<originalMaxColumn&&modifiedEndColumn<modifiedMaxColumn;){if(originalLine.charCodeAt(originalEndColumn-1)!==originalLine.charCodeAt(modifiedEndColumn-1))break;originalEndColumn++,modifiedEndColumn++}(originalEndColumn<originalMaxColumn||modifiedEndColumn<modifiedMaxColumn)&&this._pushTrimWhitespaceCharChange(result,originalLineIndex+1,originalEndColumn,originalMaxColumn,modifiedLineIndex+1,modifiedEndColumn,modifiedMaxColumn)}}originalLineIndex++,modifiedLineIndex++}nextChange&&(result.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,nextChange,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),originalLineIndex+=nextChange.originalLength,modifiedLineIndex+=nextChange.modifiedLength)}return{quitEarly,changes:result}}_pushTrimWhitespaceCharChange(result,originalLineNumber,originalStartColumn,originalEndColumn,modifiedLineNumber,modifiedStartColumn,modifiedEndColumn){if(this._mergeTrimWhitespaceCharChange(result,originalLineNumber,originalStartColumn,originalEndColumn,modifiedLineNumber,modifiedStartColumn,modifiedEndColumn))return;let charChanges;this.shouldComputeCharChanges&&(charChanges=[new CharChange(originalLineNumber,originalStartColumn,originalLineNumber,originalEndColumn,modifiedLineNumber,modifiedStartColumn,modifiedLineNumber,modifiedEndColumn)]),result.push(new LineChange(originalLineNumber,originalLineNumber,modifiedLineNumber,modifiedLineNumber,charChanges))}_mergeTrimWhitespaceCharChange(result,originalLineNumber,originalStartColumn,originalEndColumn,modifiedLineNumber,modifiedStartColumn,modifiedEndColumn){const len=result.length;if(0===len)return!1;const prevChange=result[len-1];return 0!==prevChange.originalEndLineNumber&&0!==prevChange.modifiedEndLineNumber&&(prevChange.originalEndLineNumber+1===originalLineNumber&&prevChange.modifiedEndLineNumber+1===modifiedLineNumber&&(prevChange.originalEndLineNumber=originalLineNumber,prevChange.modifiedEndLineNumber=modifiedLineNumber,this.shouldComputeCharChanges&&prevChange.charChanges&&prevChange.charChanges.push(new CharChange(originalLineNumber,originalStartColumn,originalLineNumber,originalEndColumn,modifiedLineNumber,modifiedStartColumn,modifiedLineNumber,modifiedEndColumn)),!0))}}})),define(__m[242],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InternalEditorAction=void 0;exports.InternalEditorAction=class InternalEditorAction{constructor(id,label,alias,precondition,run,contextKeyService){this.id=id,this.label=label,this.alias=alias,this._precondition=precondition,this._run=run,this._contextKeyService=contextKeyService}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){return this.isSupported()?this._run():Promise.resolve(void 0)}}})),define(__m[149],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorType=void 0,exports.EditorType={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"}})),define(__m[150],__M([1,0,149]),(function(require,exports,editorCommon){"use strict";function isCodeEditor(thing){return!(!thing||"function"!=typeof thing.getEditorType)&&thing.getEditorType()===editorCommon.EditorType.ICodeEditor}function isDiffEditor(thing){return!(!thing||"function"!=typeof thing.getEditorType)&&thing.getEditorType()===editorCommon.EditorType.IDiffEditor}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCodeEditor=exports.isDiffEditor=exports.isCodeEditor=void 0,exports.isCodeEditor=isCodeEditor,exports.isDiffEditor=isDiffEditor,exports.getCodeEditor=function getCodeEditor(thing){return isCodeEditor(thing)?thing:isDiffEditor(thing)?thing.getModifiedEditor():null}})),define(__m[409],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorTheme=void 0;exports.EditorTheme=class EditorTheme{constructor(theme){this._theme=theme}get type(){return this._theme.type}get value(){return this._theme}update(theme){this._theme=theme}getColor(color){return this._theme.getColor(color)}}})),define(__m[410],__M([1,0,218,84]),(function(require,exports,glob_1,path_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.score=void 0,exports.score=function score(selector,candidateUri,candidateLanguage,candidateIsSynchronized,candidateNotebookType){if(Array.isArray(selector)){let ret=0;for(const filter of selector){const value=score(filter,candidateUri,candidateLanguage,candidateIsSynchronized,candidateNotebookType);if(10===value)return value;value>ret&&(ret=value)}return ret}if("string"==typeof selector)return candidateIsSynchronized?"*"===selector?5:selector===candidateLanguage?10:0:0;if(selector){const{language,pattern,scheme,hasAccessToAllModels,notebookType}=selector;if(!candidateIsSynchronized&&!hasAccessToAllModels)return 0;let ret=0;if(scheme)if(scheme===candidateUri.scheme)ret=10;else{if("*"!==scheme)return 0;ret=5}if(language)if(language===candidateLanguage)ret=10;else{if("*"!==language)return 0;ret=Math.max(ret,5)}if(notebookType)if(notebookType===candidateNotebookType)ret=10;else{if("*"!==notebookType)return 0;ret=Math.max(ret,5)}if(pattern){let normalizedPattern;if(normalizedPattern="string"==typeof pattern?pattern:Object.assign(Object.assign({},pattern),{base:(0,path_1.normalize)(pattern.base)}),normalizedPattern!==candidateUri.fsPath&&!(0,glob_1.match)(normalizedPattern,candidateUri.fsPath))return 0;ret=10}return ret}return 0}})),define(__m[122],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AutoClosingPairs=exports.StandardAutoClosingPairConditional=exports.IndentAction=void 0,function(IndentAction){IndentAction[IndentAction.None=0]="None",IndentAction[IndentAction.Indent=1]="Indent",IndentAction[IndentAction.IndentOutdent=2]="IndentOutdent",IndentAction[IndentAction.Outdent=3]="Outdent"}(exports.IndentAction||(exports.IndentAction={}));exports.StandardAutoClosingPairConditional=class StandardAutoClosingPairConditional{constructor(source){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=source.open,this.close=source.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(source.notIn))for(let i=0,len=source.notIn.length;i<len;i++){switch(source.notIn[i]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1}}}isOK(standardToken){switch(standardToken){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(context,column){if(0===context.getTokenCount())return!0;const tokenIndex=context.findTokenIndexAtOffset(column-2),standardTokenType=context.getStandardTokenType(tokenIndex);return this.isOK(standardTokenType)}_findNeutralCharacterInRange(fromCharCode,toCharCode){for(let charCode=fromCharCode;charCode<=toCharCode;charCode++){const character=String.fromCharCode(charCode);if(!this.open.includes(character)&&!this.close.includes(character))return character}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}};function appendEntry(target,key,value){target.has(key)?target.get(key).push(value):target.set(key,[value])}exports.AutoClosingPairs=class AutoClosingPairs{constructor(autoClosingPairs){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const pair of autoClosingPairs)appendEntry(this.autoClosingPairsOpenByStart,pair.open.charAt(0),pair),appendEntry(this.autoClosingPairsOpenByEnd,pair.open.charAt(pair.open.length-1),pair),appendEntry(this.autoClosingPairsCloseByStart,pair.close.charAt(0),pair),appendEntry(this.autoClosingPairsCloseByEnd,pair.close.charAt(pair.close.length-1),pair),1===pair.close.length&&1===pair.open.length&&appendEntry(this.autoClosingPairsCloseSingleChar,pair.close,pair)}}})),define(__m[411],__M([1,0,99]),(function(require,exports,characterClassifier_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeLinks=exports.LinkComputer=exports.StateMachine=exports.Uint8Matrix=void 0;class Uint8Matrix{constructor(rows,cols,defaultValue){const data=new Uint8Array(rows*cols);for(let i=0,len=rows*cols;i<len;i++)data[i]=defaultValue;this._data=data,this.rows=rows,this.cols=cols}get(row,col){return this._data[row*this.cols+col]}set(row,col,value){this._data[row*this.cols+col]=value}}exports.Uint8Matrix=Uint8Matrix;class StateMachine{constructor(edges){let maxCharCode=0,maxState=0;for(let i=0,len=edges.length;i<len;i++){const[from,chCode,to]=edges[i];chCode>maxCharCode&&(maxCharCode=chCode),from>maxState&&(maxState=from),to>maxState&&(maxState=to)}maxCharCode++,maxState++;const states=new Uint8Matrix(maxState,maxCharCode,0);for(let i=0,len=edges.length;i<len;i++){const[from,chCode,to]=edges[i];states.set(from,chCode,to)}this._states=states,this._maxCharCode=maxCharCode}nextState(currentState,chCode){return chCode<0||chCode>=this._maxCharCode?0:this._states.get(currentState,chCode)}}exports.StateMachine=StateMachine;let _stateMachine=null;let _classifier=null;class LinkComputer{static _createLink(classifier,line,lineNumber,linkBeginIndex,linkEndIndex){let lastIncludedCharIndex=linkEndIndex-1;do{const chCode=line.charCodeAt(lastIncludedCharIndex);if(2!==classifier.get(chCode))break;lastIncludedCharIndex--}while(lastIncludedCharIndex>linkBeginIndex);if(linkBeginIndex>0){const charCodeBeforeLink=line.charCodeAt(linkBeginIndex-1),lastCharCodeInLink=line.charCodeAt(lastIncludedCharIndex);(40===charCodeBeforeLink&&41===lastCharCodeInLink||91===charCodeBeforeLink&&93===lastCharCodeInLink||123===charCodeBeforeLink&&125===lastCharCodeInLink)&&lastIncludedCharIndex--}return{range:{startLineNumber:lineNumber,startColumn:linkBeginIndex+1,endLineNumber:lineNumber,endColumn:lastIncludedCharIndex+2},url:line.substring(linkBeginIndex,lastIncludedCharIndex+1)}}static computeLinks(model,stateMachine=function getStateMachine(){return null===_stateMachine&&(_stateMachine=new StateMachine([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),_stateMachine}()){const classifier=function getClassifier(){if(null===_classifier){_classifier=new characterClassifier_1.CharacterClassifier(0);const FORCE_TERMINATION_CHARACTERS=" \t<>'\"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…";for(let i=0;i<FORCE_TERMINATION_CHARACTERS.length;i++)_classifier.set(FORCE_TERMINATION_CHARACTERS.charCodeAt(i),1);const CANNOT_END_WITH_CHARACTERS=".,;";for(let i=0;i<CANNOT_END_WITH_CHARACTERS.length;i++)_classifier.set(CANNOT_END_WITH_CHARACTERS.charCodeAt(i),2)}return _classifier}(),result=[];for(let i=1,lineCount=model.getLineCount();i<=lineCount;i++){const line=model.getLineContent(i),len=line.length;let j=0,linkBeginIndex=0,linkBeginChCode=0,state=1,hasOpenParens=!1,hasOpenSquareBracket=!1,inSquareBrackets=!1,hasOpenCurlyBracket=!1;for(;j<len;){let resetStateMachine=!1;const chCode=line.charCodeAt(j);if(13===state){let chClass;switch(chCode){case 40:hasOpenParens=!0,chClass=0;break;case 41:chClass=hasOpenParens?0:1;break;case 91:inSquareBrackets=!0,hasOpenSquareBracket=!0,chClass=0;break;case 93:inSquareBrackets=!1,chClass=hasOpenSquareBracket?0:1;break;case 123:hasOpenCurlyBracket=!0,chClass=0;break;case 125:chClass=hasOpenCurlyBracket?0:1;break;case 39:chClass=34===linkBeginChCode||96===linkBeginChCode?0:1;break;case 34:chClass=39===linkBeginChCode||96===linkBeginChCode?0:1;break;case 96:chClass=39===linkBeginChCode||34===linkBeginChCode?0:1;break;case 42:chClass=42===linkBeginChCode?1:0;break;case 124:chClass=124===linkBeginChCode?1:0;break;case 32:chClass=inSquareBrackets?0:1;break;default:chClass=classifier.get(chCode)}1===chClass&&(result.push(LinkComputer._createLink(classifier,line,i,linkBeginIndex,j)),resetStateMachine=!0)}else if(12===state){let chClass;91===chCode?(hasOpenSquareBracket=!0,chClass=0):chClass=classifier.get(chCode),1===chClass?resetStateMachine=!0:state=13}else state=stateMachine.nextState(state,chCode),0===state&&(resetStateMachine=!0);resetStateMachine&&(state=1,hasOpenParens=!1,hasOpenSquareBracket=!1,hasOpenCurlyBracket=!1,linkBeginIndex=j+1,linkBeginChCode=chCode),j++}13===state&&result.push(LinkComputer._createLink(classifier,line,i,linkBeginIndex,len))}return result}}exports.LinkComputer=LinkComputer,exports.computeLinks=function computeLinks(model){return model&&"function"==typeof model.getLineCount&&"function"==typeof model.getLineContent?LinkComputer.computeLinks(model):[]}})),define(__m[123],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ignoreBracketsInToken=exports.ScopedLineTokens=exports.createScopedLineTokens=void 0,exports.createScopedLineTokens=function createScopedLineTokens(context,offset){const tokenCount=context.getCount(),tokenIndex=context.findTokenIndexAtOffset(offset),desiredLanguageId=context.getLanguageId(tokenIndex);let lastTokenIndex=tokenIndex;for(;lastTokenIndex+1<tokenCount&&context.getLanguageId(lastTokenIndex+1)===desiredLanguageId;)lastTokenIndex++;let firstTokenIndex=tokenIndex;for(;firstTokenIndex>0&&context.getLanguageId(firstTokenIndex-1)===desiredLanguageId;)firstTokenIndex--;return new ScopedLineTokens(context,desiredLanguageId,firstTokenIndex,lastTokenIndex+1,context.getStartOffset(firstTokenIndex),context.getEndOffset(lastTokenIndex))};class ScopedLineTokens{constructor(actual,languageId,firstTokenIndex,lastTokenIndex,firstCharOffset,lastCharOffset){this._scopedLineTokensBrand=void 0,this._actual=actual,this.languageId=languageId,this._firstTokenIndex=firstTokenIndex,this._lastTokenIndex=lastTokenIndex,this.firstCharOffset=firstCharOffset,this._lastCharOffset=lastCharOffset}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(offset){return this._actual.getLineContent().substring(0,this.firstCharOffset+offset)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(offset){return this._actual.findTokenIndexAtOffset(offset+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(tokenIndex){return this._actual.getStandardTokenType(tokenIndex+this._firstTokenIndex)}}exports.ScopedLineTokens=ScopedLineTokens,exports.ignoreBracketsInToken=function ignoreBracketsInToken(standardTokenType){return 0!=(3&standardTokenType)}})),define(__m[61],__M([1,0,11,3,22,123,70,177]),(function(require,exports,position_1,range_1,selection_1,supports_1,cursorColumns_1,indentation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isQuote=exports.EditOperationResult=exports.SingleCursorState=exports.PartialViewCursorState=exports.PartialModelCursorState=exports.CursorState=exports.CursorConfiguration=void 0;const autoCloseAlways=()=>!0,autoCloseNever=()=>!1,autoCloseBeforeWhitespace=chr=>" "===chr||"\t"===chr;exports.CursorConfiguration=class CursorConfiguration{constructor(languageId,modelOptions,configuration,languageConfigurationService){this.languageConfigurationService=languageConfigurationService,this._cursorMoveConfigurationBrand=void 0,this._languageId=languageId;const options=configuration.options,layoutInfo=options.get(131);this.readOnly=options.get(81),this.tabSize=modelOptions.tabSize,this.indentSize=modelOptions.indentSize,this.insertSpaces=modelOptions.insertSpaces,this.stickyTabStops=options.get(104),this.lineHeight=options.get(59),this.pageSize=Math.max(1,Math.floor(layoutInfo.height/this.lineHeight)-2),this.useTabStops=options.get(116),this.wordSeparators=options.get(117),this.emptySelectionClipboard=options.get(32),this.copyWithSyntaxHighlighting=options.get(21),this.multiCursorMergeOverlapping=options.get(69),this.multiCursorPaste=options.get(71),this.autoClosingBrackets=options.get(5),this.autoClosingQuotes=options.get(8),this.autoClosingDelete=options.get(6),this.autoClosingOvertype=options.get(7),this.autoSurround=options.get(11),this.autoIndent=options.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(languageId,this.autoClosingQuotes),bracket:this._getShouldAutoClose(languageId,this.autoClosingBrackets)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(languageId).getAutoClosingPairs();const surroundingPairs=this.languageConfigurationService.getLanguageConfiguration(languageId).getSurroundingPairs();if(surroundingPairs)for(const pair of surroundingPairs)this.surroundingPairs[pair.open]=pair.close}static shouldRecreate(e){return e.hasChanged(131)||e.hasChanged(117)||e.hasChanged(32)||e.hasChanged(69)||e.hasChanged(71)||e.hasChanged(5)||e.hasChanged(8)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(116)||e.hasChanged(59)||e.hasChanged(81)}get electricChars(){var _a;if(!this._electricChars){this._electricChars={};const electricChars=null===(_a=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)||void 0===_a?void 0:_a.getElectricCharacters();if(electricChars)for(const char of electricChars)this._electricChars[char]=!0}return this._electricChars}onElectricCharacter(character,context,column){const scopedLineTokens=(0,supports_1.createScopedLineTokens)(context,column-1),electricCharacterSupport=this.languageConfigurationService.getLanguageConfiguration(scopedLineTokens.languageId).electricCharacter;return electricCharacterSupport?electricCharacterSupport.onElectricCharacter(character,scopedLineTokens,column-scopedLineTokens.firstCharOffset):null}normalizeIndentation(str){return(0,indentation_1.normalizeIndentation)(str,this.indentSize,this.insertSpaces)}_getShouldAutoClose(languageId,autoCloseConfig){switch(autoCloseConfig){case"beforeWhitespace":return autoCloseBeforeWhitespace;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(languageId);case"always":return autoCloseAlways;case"never":return autoCloseNever}}_getLanguageDefinedShouldAutoClose(languageId){const autoCloseBeforeSet=this.languageConfigurationService.getLanguageConfiguration(languageId).getAutoCloseBeforeSet();return c=>-1!==autoCloseBeforeSet.indexOf(c)}visibleColumnFromColumn(model,position){return cursorColumns_1.CursorColumns.visibleColumnFromColumn(model.getLineContent(position.lineNumber),position.column,this.tabSize)}columnFromVisibleColumn(model,lineNumber,visibleColumn){const result=cursorColumns_1.CursorColumns.columnFromVisibleColumn(model.getLineContent(lineNumber),visibleColumn,this.tabSize),minColumn=model.getLineMinColumn(lineNumber);if(result<minColumn)return minColumn;const maxColumn=model.getLineMaxColumn(lineNumber);return result>maxColumn?maxColumn:result}};class CursorState{constructor(modelState,viewState){this._cursorStateBrand=void 0,this.modelState=modelState,this.viewState=viewState}static fromModelState(modelState){return new PartialModelCursorState(modelState)}static fromViewState(viewState){return new PartialViewCursorState(viewState)}static fromModelSelection(modelSelection){const selection=selection_1.Selection.liftSelection(modelSelection),modelState=new SingleCursorState(range_1.Range.fromPositions(selection.getSelectionStart()),0,selection.getPosition(),0);return CursorState.fromModelState(modelState)}static fromModelSelections(modelSelections){const states=[];for(let i=0,len=modelSelections.length;i<len;i++)states[i]=this.fromModelSelection(modelSelections[i]);return states}equals(other){return this.viewState.equals(other.viewState)&&this.modelState.equals(other.modelState)}}exports.CursorState=CursorState;class PartialModelCursorState{constructor(modelState){this.modelState=modelState,this.viewState=null}}exports.PartialModelCursorState=PartialModelCursorState;class PartialViewCursorState{constructor(viewState){this.modelState=null,this.viewState=viewState}}exports.PartialViewCursorState=PartialViewCursorState;class SingleCursorState{constructor(selectionStart,selectionStartLeftoverVisibleColumns,position,leftoverVisibleColumns){this._singleCursorStateBrand=void 0,this.selectionStart=selectionStart,this.selectionStartLeftoverVisibleColumns=selectionStartLeftoverVisibleColumns,this.position=position,this.leftoverVisibleColumns=leftoverVisibleColumns,this.selection=SingleCursorState._computeSelection(this.selectionStart,this.position)}equals(other){return this.selectionStartLeftoverVisibleColumns===other.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===other.leftoverVisibleColumns&&this.position.equals(other.position)&&this.selectionStart.equalsRange(other.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(inSelectionMode,lineNumber,column,leftoverVisibleColumns){return inSelectionMode?new SingleCursorState(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new position_1.Position(lineNumber,column),leftoverVisibleColumns):new SingleCursorState(new range_1.Range(lineNumber,column,lineNumber,column),leftoverVisibleColumns,new position_1.Position(lineNumber,column),leftoverVisibleColumns)}static _computeSelection(selectionStart,position){return selectionStart.isEmpty()||!position.isBeforeOrEqual(selectionStart.getStartPosition())?selection_1.Selection.fromPositions(selectionStart.getStartPosition(),position):selection_1.Selection.fromPositions(selectionStart.getEndPosition(),position)}}exports.SingleCursorState=SingleCursorState;exports.EditOperationResult=class EditOperationResult{constructor(type,commands,opts){this._editOperationResultBrand=void 0,this.type=type,this.commands=commands,this.shouldPushStackElementBefore=opts.shouldPushStackElementBefore,this.shouldPushStackElementAfter=opts.shouldPushStackElementAfter}},exports.isQuote=function isQuote(ch){return"'"===ch||'"'===ch||"`"===ch}})),define(__m[412],__M([1,0,61,11,3]),(function(require,exports,cursorCommon_1,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColumnSelection=void 0;class ColumnSelection{static columnSelect(config,model,fromLineNumber,fromVisibleColumn,toLineNumber,toVisibleColumn){const lineCount=Math.abs(toLineNumber-fromLineNumber)+1,reversed=fromLineNumber>toLineNumber,isRTL=fromVisibleColumn>toVisibleColumn,isLTR=fromVisibleColumn<toVisibleColumn,result=[];for(let i=0;i<lineCount;i++){const lineNumber=fromLineNumber+(reversed?-i:i),startColumn=config.columnFromVisibleColumn(model,lineNumber,fromVisibleColumn),endColumn=config.columnFromVisibleColumn(model,lineNumber,toVisibleColumn),visibleStartColumn=config.visibleColumnFromColumn(model,new position_1.Position(lineNumber,startColumn)),visibleEndColumn=config.visibleColumnFromColumn(model,new position_1.Position(lineNumber,endColumn));if(isLTR){if(visibleStartColumn>toVisibleColumn)continue;if(visibleEndColumn<fromVisibleColumn)continue}if(isRTL){if(visibleEndColumn>fromVisibleColumn)continue;if(visibleStartColumn<toVisibleColumn)continue}result.push(new cursorCommon_1.SingleCursorState(new range_1.Range(lineNumber,startColumn,lineNumber,startColumn),0,new position_1.Position(lineNumber,endColumn),0))}if(0===result.length)for(let i=0;i<lineCount;i++){const lineNumber=fromLineNumber+(reversed?-i:i),maxColumn=model.getLineMaxColumn(lineNumber);result.push(new cursorCommon_1.SingleCursorState(new range_1.Range(lineNumber,maxColumn,lineNumber,maxColumn),0,new position_1.Position(lineNumber,maxColumn),0))}return{viewStates:result,reversed,fromLineNumber,fromVisualColumn:fromVisibleColumn,toLineNumber,toVisualColumn:toVisibleColumn}}static columnSelectLeft(config,model,prevColumnSelectData){let toViewVisualColumn=prevColumnSelectData.toViewVisualColumn;return toViewVisualColumn>0&&toViewVisualColumn--,ColumnSelection.columnSelect(config,model,prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.fromViewVisualColumn,prevColumnSelectData.toViewLineNumber,toViewVisualColumn)}static columnSelectRight(config,model,prevColumnSelectData){let maxVisualViewColumn=0;const minViewLineNumber=Math.min(prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.toViewLineNumber),maxViewLineNumber=Math.max(prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.toViewLineNumber);for(let lineNumber=minViewLineNumber;lineNumber<=maxViewLineNumber;lineNumber++){const lineMaxViewColumn=model.getLineMaxColumn(lineNumber),lineMaxVisualViewColumn=config.visibleColumnFromColumn(model,new position_1.Position(lineNumber,lineMaxViewColumn));maxVisualViewColumn=Math.max(maxVisualViewColumn,lineMaxVisualViewColumn)}let toViewVisualColumn=prevColumnSelectData.toViewVisualColumn;return toViewVisualColumn<maxVisualViewColumn&&toViewVisualColumn++,this.columnSelect(config,model,prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.fromViewVisualColumn,prevColumnSelectData.toViewLineNumber,toViewVisualColumn)}static columnSelectUp(config,model,prevColumnSelectData,isPaged){const linesCount=isPaged?config.pageSize:1,toViewLineNumber=Math.max(1,prevColumnSelectData.toViewLineNumber-linesCount);return this.columnSelect(config,model,prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.fromViewVisualColumn,toViewLineNumber,prevColumnSelectData.toViewVisualColumn)}static columnSelectDown(config,model,prevColumnSelectData,isPaged){const linesCount=isPaged?config.pageSize:1,toViewLineNumber=Math.min(model.getLineCount(),prevColumnSelectData.toViewLineNumber+linesCount);return this.columnSelect(config,model,prevColumnSelectData.fromViewLineNumber,prevColumnSelectData.fromViewVisualColumn,toViewLineNumber,prevColumnSelectData.toViewVisualColumn)}}exports.ColumnSelection=ColumnSelection})),define(__m[180],__M([1,0,61,70,11,3,8,241]),(function(require,exports,cursorCommon_1,cursorColumns_1,position_1,range_1,strings,cursorAtomicMoveOperations_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveOperations=exports.CursorPosition=void 0;class CursorPosition{constructor(lineNumber,column,leftoverVisibleColumns){this._cursorPositionBrand=void 0,this.lineNumber=lineNumber,this.column=column,this.leftoverVisibleColumns=leftoverVisibleColumns}}exports.CursorPosition=CursorPosition;class MoveOperations{static leftPosition(model,position){if(position.column>model.getLineMinColumn(position.lineNumber))return position.delta(void 0,-strings.prevCharLength(model.getLineContent(position.lineNumber),position.column-1));if(position.lineNumber>1){const newLineNumber=position.lineNumber-1;return new position_1.Position(newLineNumber,model.getLineMaxColumn(newLineNumber))}return position}static leftPositionAtomicSoftTabs(model,position,tabSize){if(position.column<=model.getLineIndentColumn(position.lineNumber)){const minColumn=model.getLineMinColumn(position.lineNumber),lineContent=model.getLineContent(position.lineNumber),newPosition=cursorAtomicMoveOperations_1.AtomicTabMoveOperations.atomicPosition(lineContent,position.column-1,tabSize,0);if(-1!==newPosition&&newPosition+1>=minColumn)return new position_1.Position(position.lineNumber,newPosition+1)}return this.leftPosition(model,position)}static left(config,model,position){const pos=config.stickyTabStops?MoveOperations.leftPositionAtomicSoftTabs(model,position,config.tabSize):MoveOperations.leftPosition(model,position);return new CursorPosition(pos.lineNumber,pos.column,0)}static moveLeft(config,model,cursor,inSelectionMode,noOfColumns){let lineNumber,column;if(cursor.hasSelection()&&!inSelectionMode)lineNumber=cursor.selection.startLineNumber,column=cursor.selection.startColumn;else{const pos=cursor.position.delta(void 0,-(noOfColumns-1)),normalizedPos=model.normalizePosition(MoveOperations.clipPositionColumn(pos,model),0),p=MoveOperations.left(config,model,normalizedPos);lineNumber=p.lineNumber,column=p.column}return cursor.move(inSelectionMode,lineNumber,column,0)}static clipPositionColumn(position,model){return new position_1.Position(position.lineNumber,MoveOperations.clipRange(position.column,model.getLineMinColumn(position.lineNumber),model.getLineMaxColumn(position.lineNumber)))}static clipRange(value,min,max){return value<min?min:value>max?max:value}static rightPosition(model,lineNumber,column){return column<model.getLineMaxColumn(lineNumber)?column+=strings.nextCharLength(model.getLineContent(lineNumber),column-1):lineNumber<model.getLineCount()&&(lineNumber+=1,column=model.getLineMinColumn(lineNumber)),new position_1.Position(lineNumber,column)}static rightPositionAtomicSoftTabs(model,lineNumber,column,tabSize,indentSize){if(column<model.getLineIndentColumn(lineNumber)){const lineContent=model.getLineContent(lineNumber),newPosition=cursorAtomicMoveOperations_1.AtomicTabMoveOperations.atomicPosition(lineContent,column-1,tabSize,1);if(-1!==newPosition)return new position_1.Position(lineNumber,newPosition+1)}return this.rightPosition(model,lineNumber,column)}static right(config,model,position){const pos=config.stickyTabStops?MoveOperations.rightPositionAtomicSoftTabs(model,position.lineNumber,position.column,config.tabSize,config.indentSize):MoveOperations.rightPosition(model,position.lineNumber,position.column);return new CursorPosition(pos.lineNumber,pos.column,0)}static moveRight(config,model,cursor,inSelectionMode,noOfColumns){let lineNumber,column;if(cursor.hasSelection()&&!inSelectionMode)lineNumber=cursor.selection.endLineNumber,column=cursor.selection.endColumn;else{const pos=cursor.position.delta(void 0,noOfColumns-1),normalizedPos=model.normalizePosition(MoveOperations.clipPositionColumn(pos,model),1),r=MoveOperations.right(config,model,normalizedPos);lineNumber=r.lineNumber,column=r.column}return cursor.move(inSelectionMode,lineNumber,column,0)}static vertical(config,model,lineNumber,column,leftoverVisibleColumns,newLineNumber,allowMoveOnEdgeLine,normalizationAffinity){const currentVisibleColumn=cursorColumns_1.CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber),column,config.tabSize)+leftoverVisibleColumns,lineCount=model.getLineCount(),wasOnFirstPosition=1===lineNumber&&1===column,wasOnLastPosition=lineNumber===lineCount&&column===model.getLineMaxColumn(lineNumber),wasAtEdgePosition=newLineNumber<lineNumber?wasOnFirstPosition:wasOnLastPosition;if((lineNumber=newLineNumber)<1?(lineNumber=1,column=allowMoveOnEdgeLine?model.getLineMinColumn(lineNumber):Math.min(model.getLineMaxColumn(lineNumber),column)):lineNumber>lineCount?(lineNumber=lineCount,column=allowMoveOnEdgeLine?model.getLineMaxColumn(lineNumber):Math.min(model.getLineMaxColumn(lineNumber),column)):column=config.columnFromVisibleColumn(model,lineNumber,currentVisibleColumn),leftoverVisibleColumns=wasAtEdgePosition?0:currentVisibleColumn-cursorColumns_1.CursorColumns.visibleColumnFromColumn(model.getLineContent(lineNumber),column,config.tabSize),void 0!==normalizationAffinity){const position=new position_1.Position(lineNumber,column),newPosition=model.normalizePosition(position,normalizationAffinity);leftoverVisibleColumns+=column-newPosition.column,lineNumber=newPosition.lineNumber,column=newPosition.column}return new CursorPosition(lineNumber,column,leftoverVisibleColumns)}static down(config,model,lineNumber,column,leftoverVisibleColumns,count,allowMoveOnLastLine){return this.vertical(config,model,lineNumber,column,leftoverVisibleColumns,lineNumber+count,allowMoveOnLastLine,1)}static moveDown(config,model,cursor,inSelectionMode,linesCount){let lineNumber,column;cursor.hasSelection()&&!inSelectionMode?(lineNumber=cursor.selection.endLineNumber,column=cursor.selection.endColumn):(lineNumber=cursor.position.lineNumber,column=cursor.position.column);const r=MoveOperations.down(config,model,lineNumber,column,cursor.leftoverVisibleColumns,linesCount,!0);return cursor.move(inSelectionMode,r.lineNumber,r.column,r.leftoverVisibleColumns)}static translateDown(config,model,cursor){const selection=cursor.selection,selectionStart=MoveOperations.down(config,model,selection.selectionStartLineNumber,selection.selectionStartColumn,cursor.selectionStartLeftoverVisibleColumns,1,!1),position=MoveOperations.down(config,model,selection.positionLineNumber,selection.positionColumn,cursor.leftoverVisibleColumns,1,!1);return new cursorCommon_1.SingleCursorState(new range_1.Range(selectionStart.lineNumber,selectionStart.column,selectionStart.lineNumber,selectionStart.column),selectionStart.leftoverVisibleColumns,new position_1.Position(position.lineNumber,position.column),position.leftoverVisibleColumns)}static up(config,model,lineNumber,column,leftoverVisibleColumns,count,allowMoveOnFirstLine){return this.vertical(config,model,lineNumber,column,leftoverVisibleColumns,lineNumber-count,allowMoveOnFirstLine,0)}static moveUp(config,model,cursor,inSelectionMode,linesCount){let lineNumber,column;cursor.hasSelection()&&!inSelectionMode?(lineNumber=cursor.selection.startLineNumber,column=cursor.selection.startColumn):(lineNumber=cursor.position.lineNumber,column=cursor.position.column);const r=MoveOperations.up(config,model,lineNumber,column,cursor.leftoverVisibleColumns,linesCount,!0);return cursor.move(inSelectionMode,r.lineNumber,r.column,r.leftoverVisibleColumns)}static translateUp(config,model,cursor){const selection=cursor.selection,selectionStart=MoveOperations.up(config,model,selection.selectionStartLineNumber,selection.selectionStartColumn,cursor.selectionStartLeftoverVisibleColumns,1,!1),position=MoveOperations.up(config,model,selection.positionLineNumber,selection.positionColumn,cursor.leftoverVisibleColumns,1,!1);return new cursorCommon_1.SingleCursorState(new range_1.Range(selectionStart.lineNumber,selectionStart.column,selectionStart.lineNumber,selectionStart.column),selectionStart.leftoverVisibleColumns,new position_1.Position(position.lineNumber,position.column),position.leftoverVisibleColumns)}static _isBlankLine(model,lineNumber){return 0===model.getLineFirstNonWhitespaceColumn(lineNumber)}static moveToPrevBlankLine(config,model,cursor,inSelectionMode){let lineNumber=cursor.position.lineNumber;for(;lineNumber>1&&this._isBlankLine(model,lineNumber);)lineNumber--;for(;lineNumber>1&&!this._isBlankLine(model,lineNumber);)lineNumber--;return cursor.move(inSelectionMode,lineNumber,model.getLineMinColumn(lineNumber),0)}static moveToNextBlankLine(config,model,cursor,inSelectionMode){const lineCount=model.getLineCount();let lineNumber=cursor.position.lineNumber;for(;lineNumber<lineCount&&this._isBlankLine(model,lineNumber);)lineNumber++;for(;lineNumber<lineCount&&!this._isBlankLine(model,lineNumber);)lineNumber++;return cursor.move(inSelectionMode,lineNumber,model.getLineMinColumn(lineNumber),0)}static moveToBeginningOfLine(config,model,cursor,inSelectionMode){const lineNumber=cursor.position.lineNumber,minColumn=model.getLineMinColumn(lineNumber),firstNonBlankColumn=model.getLineFirstNonWhitespaceColumn(lineNumber)||minColumn;let column;return column=cursor.position.column===firstNonBlankColumn?minColumn:firstNonBlankColumn,cursor.move(inSelectionMode,lineNumber,column,0)}static moveToEndOfLine(config,model,cursor,inSelectionMode,sticky){const lineNumber=cursor.position.lineNumber,maxColumn=model.getLineMaxColumn(lineNumber);return cursor.move(inSelectionMode,lineNumber,maxColumn,sticky?1073741824-maxColumn:0)}static moveToBeginningOfBuffer(config,model,cursor,inSelectionMode){return cursor.move(inSelectionMode,1,1,0)}static moveToEndOfBuffer(config,model,cursor,inSelectionMode){const lastLineNumber=model.getLineCount(),lastColumn=model.getLineMaxColumn(lastLineNumber);return cursor.move(inSelectionMode,lastLineNumber,lastColumn,0)}}exports.MoveOperations=MoveOperations})),define(__m[181],__M([1,0,8,100,61,70,180,3,11]),(function(require,exports,strings,replaceCommand_1,cursorCommon_1,cursorColumns_1,cursorMoveOperations_1,range_1,position_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteOperations=void 0;class DeleteOperations{static deleteRight(prevEditOperationType,config,model,selections){const commands=[];let shouldPushStackElementBefore=3!==prevEditOperationType;for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];let deleteSelection=selection;if(deleteSelection.isEmpty()){const position=selection.getPosition(),rightOfPosition=cursorMoveOperations_1.MoveOperations.right(config,model,position);deleteSelection=new range_1.Range(rightOfPosition.lineNumber,rightOfPosition.column,position.lineNumber,position.column)}deleteSelection.isEmpty()?commands[i]=null:(deleteSelection.startLineNumber!==deleteSelection.endLineNumber&&(shouldPushStackElementBefore=!0),commands[i]=new replaceCommand_1.ReplaceCommand(deleteSelection,""))}return[shouldPushStackElementBefore,commands]}static isAutoClosingPairDelete(autoClosingDelete,autoClosingBrackets,autoClosingQuotes,autoClosingPairsOpen,model,selections,autoClosedCharacters){if("never"===autoClosingBrackets&&"never"===autoClosingQuotes)return!1;if("never"===autoClosingDelete)return!1;for(let i=0,len=selections.length;i<len;i++){const selection=selections[i],position=selection.getPosition();if(!selection.isEmpty())return!1;const lineText=model.getLineContent(position.lineNumber);if(position.column<2||position.column>=lineText.length+1)return!1;const character=lineText.charAt(position.column-2),autoClosingPairCandidates=autoClosingPairsOpen.get(character);if(!autoClosingPairCandidates)return!1;if((0,cursorCommon_1.isQuote)(character)){if("never"===autoClosingQuotes)return!1}else if("never"===autoClosingBrackets)return!1;const afterCharacter=lineText.charAt(position.column-1);let foundAutoClosingPair=!1;for(const autoClosingPairCandidate of autoClosingPairCandidates)autoClosingPairCandidate.open===character&&autoClosingPairCandidate.close===afterCharacter&&(foundAutoClosingPair=!0);if(!foundAutoClosingPair)return!1;if("auto"===autoClosingDelete){let found=!1;for(let j=0,lenJ=autoClosedCharacters.length;j<lenJ;j++){const autoClosedCharacter=autoClosedCharacters[j];if(position.lineNumber===autoClosedCharacter.startLineNumber&&position.column===autoClosedCharacter.startColumn){found=!0;break}}if(!found)return!1}}return!0}static _runAutoClosingPairDelete(config,model,selections){const commands=[];for(let i=0,len=selections.length;i<len;i++){const position=selections[i].getPosition(),deleteSelection=new range_1.Range(position.lineNumber,position.column-1,position.lineNumber,position.column+1);commands[i]=new replaceCommand_1.ReplaceCommand(deleteSelection,"")}return[!0,commands]}static deleteLeft(prevEditOperationType,config,model,selections,autoClosedCharacters){if(this.isAutoClosingPairDelete(config.autoClosingDelete,config.autoClosingBrackets,config.autoClosingQuotes,config.autoClosingPairs.autoClosingPairsOpenByEnd,model,selections,autoClosedCharacters))return this._runAutoClosingPairDelete(config,model,selections);const commands=[];let shouldPushStackElementBefore=2!==prevEditOperationType;for(let i=0,len=selections.length;i<len;i++){const deleteRange=DeleteOperations.getDeleteRange(selections[i],model,config);deleteRange.isEmpty()?commands[i]=null:(deleteRange.startLineNumber!==deleteRange.endLineNumber&&(shouldPushStackElementBefore=!0),commands[i]=new replaceCommand_1.ReplaceCommand(deleteRange,""))}return[shouldPushStackElementBefore,commands]}static getDeleteRange(selection,model,config){if(!selection.isEmpty())return selection;const position=selection.getPosition();if(config.useTabStops&&position.column>1){const lineContent=model.getLineContent(position.lineNumber),firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(lineContent),lastIndentationColumn=-1===firstNonWhitespaceIndex?lineContent.length+1:firstNonWhitespaceIndex+1;if(position.column<=lastIndentationColumn){const fromVisibleColumn=config.visibleColumnFromColumn(model,position),toVisibleColumn=cursorColumns_1.CursorColumns.prevIndentTabStop(fromVisibleColumn,config.indentSize),toColumn=config.columnFromVisibleColumn(model,position.lineNumber,toVisibleColumn);return new range_1.Range(position.lineNumber,toColumn,position.lineNumber,position.column)}}return range_1.Range.fromPositions(DeleteOperations.getPositionAfterDeleteLeft(position,model),position)}static getPositionAfterDeleteLeft(position,model){if(position.column>1){const idx=strings.getLeftDeleteOffset(position.column-1,model.getLineContent(position.lineNumber));return position.with(void 0,idx+1)}if(position.lineNumber>1){const newLine=position.lineNumber-1;return new position_1.Position(newLine,model.getLineMaxColumn(newLine))}return position}static cut(config,model,selections){const commands=[];let lastCutRange=null;selections.sort(((a,b)=>position_1.Position.compare(a.getStartPosition(),b.getEndPosition())));for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];if(selection.isEmpty())if(config.emptySelectionClipboard){const position=selection.getPosition();let startLineNumber,startColumn,endLineNumber,endColumn;position.lineNumber<model.getLineCount()?(startLineNumber=position.lineNumber,startColumn=1,endLineNumber=position.lineNumber+1,endColumn=1):position.lineNumber>1&&(null==lastCutRange?void 0:lastCutRange.endLineNumber)!==position.lineNumber?(startLineNumber=position.lineNumber-1,startColumn=model.getLineMaxColumn(position.lineNumber-1),endLineNumber=position.lineNumber,endColumn=model.getLineMaxColumn(position.lineNumber)):(startLineNumber=position.lineNumber,startColumn=1,endLineNumber=position.lineNumber,endColumn=model.getLineMaxColumn(position.lineNumber));const deleteSelection=new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn);lastCutRange=deleteSelection,deleteSelection.isEmpty()?commands[i]=null:commands[i]=new replaceCommand_1.ReplaceCommand(deleteSelection,"")}else commands[i]=null;else commands[i]=new replaceCommand_1.ReplaceCommand(selection,"")}return new cursorCommon_1.EditOperationResult(0,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}exports.DeleteOperations=DeleteOperations})),define(__m[151],__M([1,0,8,61,181,120,11,3]),(function(require,exports,strings,cursorCommon_1,cursorDeleteOperations_1,wordCharacterClassifier_1,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WordPartOperations=exports.WordOperations=void 0;class WordOperations{static _createWord(lineContent,wordType,nextCharClass,start,end){return{start,end,wordType,nextCharClass}}static _findPreviousWordOnLine(wordSeparators,model,position){const lineContent=model.getLineContent(position.lineNumber);return this._doFindPreviousWordOnLine(lineContent,wordSeparators,position)}static _doFindPreviousWordOnLine(lineContent,wordSeparators,position){let wordType=0;for(let chIndex=position.column-2;chIndex>=0;chIndex--){const chCode=lineContent.charCodeAt(chIndex),chClass=wordSeparators.get(chCode);if(0===chClass){if(2===wordType)return this._createWord(lineContent,wordType,chClass,chIndex+1,this._findEndOfWord(lineContent,wordSeparators,wordType,chIndex+1));wordType=1}else if(2===chClass){if(1===wordType)return this._createWord(lineContent,wordType,chClass,chIndex+1,this._findEndOfWord(lineContent,wordSeparators,wordType,chIndex+1));wordType=2}else if(1===chClass&&0!==wordType)return this._createWord(lineContent,wordType,chClass,chIndex+1,this._findEndOfWord(lineContent,wordSeparators,wordType,chIndex+1))}return 0!==wordType?this._createWord(lineContent,wordType,1,0,this._findEndOfWord(lineContent,wordSeparators,wordType,0)):null}static _findEndOfWord(lineContent,wordSeparators,wordType,startIndex){const len=lineContent.length;for(let chIndex=startIndex;chIndex<len;chIndex++){const chCode=lineContent.charCodeAt(chIndex),chClass=wordSeparators.get(chCode);if(1===chClass)return chIndex;if(1===wordType&&2===chClass)return chIndex;if(2===wordType&&0===chClass)return chIndex}return len}static _findNextWordOnLine(wordSeparators,model,position){const lineContent=model.getLineContent(position.lineNumber);return this._doFindNextWordOnLine(lineContent,wordSeparators,position)}static _doFindNextWordOnLine(lineContent,wordSeparators,position){let wordType=0;const len=lineContent.length;for(let chIndex=position.column-1;chIndex<len;chIndex++){const chCode=lineContent.charCodeAt(chIndex),chClass=wordSeparators.get(chCode);if(0===chClass){if(2===wordType)return this._createWord(lineContent,wordType,chClass,this._findStartOfWord(lineContent,wordSeparators,wordType,chIndex-1),chIndex);wordType=1}else if(2===chClass){if(1===wordType)return this._createWord(lineContent,wordType,chClass,this._findStartOfWord(lineContent,wordSeparators,wordType,chIndex-1),chIndex);wordType=2}else if(1===chClass&&0!==wordType)return this._createWord(lineContent,wordType,chClass,this._findStartOfWord(lineContent,wordSeparators,wordType,chIndex-1),chIndex)}return 0!==wordType?this._createWord(lineContent,wordType,1,this._findStartOfWord(lineContent,wordSeparators,wordType,len-1),len):null}static _findStartOfWord(lineContent,wordSeparators,wordType,startIndex){for(let chIndex=startIndex;chIndex>=0;chIndex--){const chCode=lineContent.charCodeAt(chIndex),chClass=wordSeparators.get(chCode);if(1===chClass)return chIndex+1;if(1===wordType&&2===chClass)return chIndex+1;if(2===wordType&&0===chClass)return chIndex+1}return 0}static moveWordLeft(wordSeparators,model,position,wordNavigationType){let lineNumber=position.lineNumber,column=position.column;1===column&&lineNumber>1&&(lineNumber-=1,column=model.getLineMaxColumn(lineNumber));let prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,column));if(0===wordNavigationType)return new position_1.Position(lineNumber,prevWordOnLine?prevWordOnLine.start+1:1);if(1===wordNavigationType)return prevWordOnLine&&2===prevWordOnLine.wordType&&prevWordOnLine.end-prevWordOnLine.start==1&&0===prevWordOnLine.nextCharClass&&(prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,prevWordOnLine.start+1))),new position_1.Position(lineNumber,prevWordOnLine?prevWordOnLine.start+1:1);if(3===wordNavigationType){for(;prevWordOnLine&&2===prevWordOnLine.wordType;)prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,prevWordOnLine.start+1));return new position_1.Position(lineNumber,prevWordOnLine?prevWordOnLine.start+1:1)}return prevWordOnLine&&column<=prevWordOnLine.end+1&&(prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,prevWordOnLine.start+1))),new position_1.Position(lineNumber,prevWordOnLine?prevWordOnLine.end+1:1)}static _moveWordPartLeft(model,position){const lineNumber=position.lineNumber,maxColumn=model.getLineMaxColumn(lineNumber);if(1===position.column)return lineNumber>1?new position_1.Position(lineNumber-1,model.getLineMaxColumn(lineNumber-1)):position;const lineContent=model.getLineContent(lineNumber);for(let column=position.column-1;column>1;column--){const left=lineContent.charCodeAt(column-2),right=lineContent.charCodeAt(column-1);if(95===left&&95!==right)return new position_1.Position(lineNumber,column);if(strings.isLowerAsciiLetter(left)&&strings.isUpperAsciiLetter(right))return new position_1.Position(lineNumber,column);if(strings.isUpperAsciiLetter(left)&&strings.isUpperAsciiLetter(right)&&column+1<maxColumn){const rightRight=lineContent.charCodeAt(column);if(strings.isLowerAsciiLetter(rightRight))return new position_1.Position(lineNumber,column)}}return new position_1.Position(lineNumber,1)}static moveWordRight(wordSeparators,model,position,wordNavigationType){let lineNumber=position.lineNumber,column=position.column,movedDown=!1;column===model.getLineMaxColumn(lineNumber)&&lineNumber<model.getLineCount()&&(movedDown=!0,lineNumber+=1,column=1);let nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,column));if(2===wordNavigationType)nextWordOnLine&&2===nextWordOnLine.wordType&&nextWordOnLine.end-nextWordOnLine.start==1&&0===nextWordOnLine.nextCharClass&&(nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,nextWordOnLine.end+1))),column=nextWordOnLine?nextWordOnLine.end+1:model.getLineMaxColumn(lineNumber);else if(3===wordNavigationType){for(movedDown&&(column=0);nextWordOnLine&&(2===nextWordOnLine.wordType||nextWordOnLine.start+1<=column);)nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,nextWordOnLine.end+1));column=nextWordOnLine?nextWordOnLine.start+1:model.getLineMaxColumn(lineNumber)}else nextWordOnLine&&!movedDown&&column>=nextWordOnLine.start+1&&(nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,nextWordOnLine.end+1))),column=nextWordOnLine?nextWordOnLine.start+1:model.getLineMaxColumn(lineNumber);return new position_1.Position(lineNumber,column)}static _moveWordPartRight(model,position){const lineNumber=position.lineNumber,maxColumn=model.getLineMaxColumn(lineNumber);if(position.column===maxColumn)return lineNumber<model.getLineCount()?new position_1.Position(lineNumber+1,1):position;const lineContent=model.getLineContent(lineNumber);for(let column=position.column+1;column<maxColumn;column++){const left=lineContent.charCodeAt(column-2),right=lineContent.charCodeAt(column-1);if(95!==left&&95===right)return new position_1.Position(lineNumber,column);if(strings.isLowerAsciiLetter(left)&&strings.isUpperAsciiLetter(right))return new position_1.Position(lineNumber,column);if(strings.isUpperAsciiLetter(left)&&strings.isUpperAsciiLetter(right)&&column+1<maxColumn){const rightRight=lineContent.charCodeAt(column);if(strings.isLowerAsciiLetter(rightRight))return new position_1.Position(lineNumber,column)}}return new position_1.Position(lineNumber,maxColumn)}static _deleteWordLeftWhitespace(model,position){const lineContent=model.getLineContent(position.lineNumber),startIndex=position.column-2,lastNonWhitespace=strings.lastNonWhitespaceIndex(lineContent,startIndex);return lastNonWhitespace+1<startIndex?new range_1.Range(position.lineNumber,lastNonWhitespace+2,position.lineNumber,position.column):null}static deleteWordLeft(ctx,wordNavigationType){const wordSeparators=ctx.wordSeparators,model=ctx.model,selection=ctx.selection,whitespaceHeuristics=ctx.whitespaceHeuristics;if(!selection.isEmpty())return selection;if(cursorDeleteOperations_1.DeleteOperations.isAutoClosingPairDelete(ctx.autoClosingDelete,ctx.autoClosingBrackets,ctx.autoClosingQuotes,ctx.autoClosingPairs.autoClosingPairsOpenByEnd,ctx.model,[ctx.selection],ctx.autoClosedCharacters)){const position=ctx.selection.getPosition();return new range_1.Range(position.lineNumber,position.column-1,position.lineNumber,position.column+1)}const position=new position_1.Position(selection.positionLineNumber,selection.positionColumn);let lineNumber=position.lineNumber,column=position.column;if(1===lineNumber&&1===column)return null;if(whitespaceHeuristics){const r=this._deleteWordLeftWhitespace(model,position);if(r)return r}let prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,position);return 0===wordNavigationType?prevWordOnLine?column=prevWordOnLine.start+1:column>1?column=1:(lineNumber--,column=model.getLineMaxColumn(lineNumber)):(prevWordOnLine&&column<=prevWordOnLine.end+1&&(prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,prevWordOnLine.start+1))),prevWordOnLine?column=prevWordOnLine.end+1:column>1?column=1:(lineNumber--,column=model.getLineMaxColumn(lineNumber))),new range_1.Range(lineNumber,column,position.lineNumber,position.column)}static deleteInsideWord(wordSeparators,model,selection){if(!selection.isEmpty())return selection;const position=new position_1.Position(selection.positionLineNumber,selection.positionColumn),r=this._deleteInsideWordWhitespace(model,position);return r||this._deleteInsideWordDetermineDeleteRange(wordSeparators,model,position)}static _charAtIsWhitespace(str,index){const charCode=str.charCodeAt(index);return 32===charCode||9===charCode}static _deleteInsideWordWhitespace(model,position){const lineContent=model.getLineContent(position.lineNumber),lineContentLength=lineContent.length;if(0===lineContentLength)return null;let leftIndex=Math.max(position.column-2,0);if(!this._charAtIsWhitespace(lineContent,leftIndex))return null;let rightIndex=Math.min(position.column-1,lineContentLength-1);if(!this._charAtIsWhitespace(lineContent,rightIndex))return null;for(;leftIndex>0&&this._charAtIsWhitespace(lineContent,leftIndex-1);)leftIndex--;for(;rightIndex+1<lineContentLength&&this._charAtIsWhitespace(lineContent,rightIndex+1);)rightIndex++;return new range_1.Range(position.lineNumber,leftIndex+1,position.lineNumber,rightIndex+2)}static _deleteInsideWordDetermineDeleteRange(wordSeparators,model,position){const lineContent=model.getLineContent(position.lineNumber),lineLength=lineContent.length;if(0===lineLength)return position.lineNumber>1?new range_1.Range(position.lineNumber-1,model.getLineMaxColumn(position.lineNumber-1),position.lineNumber,1):position.lineNumber<model.getLineCount()?new range_1.Range(position.lineNumber,1,position.lineNumber+1,1):new range_1.Range(position.lineNumber,1,position.lineNumber,1);const touchesWord=word=>word.start+1<=position.column&&position.column<=word.end+1,createRangeWithPosition=(startColumn,endColumn)=>(startColumn=Math.min(startColumn,position.column),endColumn=Math.max(endColumn,position.column),new range_1.Range(position.lineNumber,startColumn,position.lineNumber,endColumn)),deleteWordAndAdjacentWhitespace=word=>{let startColumn=word.start+1,endColumn=word.end+1,expandedToTheRight=!1;for(;endColumn-1<lineLength&&this._charAtIsWhitespace(lineContent,endColumn-1);)expandedToTheRight=!0,endColumn++;if(!expandedToTheRight)for(;startColumn>1&&this._charAtIsWhitespace(lineContent,startColumn-2);)startColumn--;return createRangeWithPosition(startColumn,endColumn)},prevWordOnLine=WordOperations._findPreviousWordOnLine(wordSeparators,model,position);if(prevWordOnLine&&touchesWord(prevWordOnLine))return deleteWordAndAdjacentWhitespace(prevWordOnLine);const nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,position);return nextWordOnLine&&touchesWord(nextWordOnLine)?deleteWordAndAdjacentWhitespace(nextWordOnLine):prevWordOnLine&&nextWordOnLine?createRangeWithPosition(prevWordOnLine.end+1,nextWordOnLine.start+1):prevWordOnLine?createRangeWithPosition(prevWordOnLine.start+1,prevWordOnLine.end+1):nextWordOnLine?createRangeWithPosition(nextWordOnLine.start+1,nextWordOnLine.end+1):createRangeWithPosition(1,lineLength+1)}static _deleteWordPartLeft(model,selection){if(!selection.isEmpty())return selection;const pos=selection.getPosition(),toPosition=WordOperations._moveWordPartLeft(model,pos);return new range_1.Range(pos.lineNumber,pos.column,toPosition.lineNumber,toPosition.column)}static _findFirstNonWhitespaceChar(str,startIndex){const len=str.length;for(let chIndex=startIndex;chIndex<len;chIndex++){const ch=str.charAt(chIndex);if(" "!==ch&&"\t"!==ch)return chIndex}return len}static _deleteWordRightWhitespace(model,position){const lineContent=model.getLineContent(position.lineNumber),startIndex=position.column-1,firstNonWhitespace=this._findFirstNonWhitespaceChar(lineContent,startIndex);return startIndex+1<firstNonWhitespace?new range_1.Range(position.lineNumber,position.column,position.lineNumber,firstNonWhitespace+1):null}static deleteWordRight(ctx,wordNavigationType){const wordSeparators=ctx.wordSeparators,model=ctx.model,selection=ctx.selection,whitespaceHeuristics=ctx.whitespaceHeuristics;if(!selection.isEmpty())return selection;const position=new position_1.Position(selection.positionLineNumber,selection.positionColumn);let lineNumber=position.lineNumber,column=position.column;const lineCount=model.getLineCount(),maxColumn=model.getLineMaxColumn(lineNumber);if(lineNumber===lineCount&&column===maxColumn)return null;if(whitespaceHeuristics){const r=this._deleteWordRightWhitespace(model,position);if(r)return r}let nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,position);return 2===wordNavigationType?nextWordOnLine?column=nextWordOnLine.end+1:column<maxColumn||lineNumber===lineCount?column=maxColumn:(lineNumber++,nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,1)),column=nextWordOnLine?nextWordOnLine.start+1:model.getLineMaxColumn(lineNumber)):(nextWordOnLine&&column>=nextWordOnLine.start+1&&(nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,nextWordOnLine.end+1))),nextWordOnLine?column=nextWordOnLine.start+1:column<maxColumn||lineNumber===lineCount?column=maxColumn:(lineNumber++,nextWordOnLine=WordOperations._findNextWordOnLine(wordSeparators,model,new position_1.Position(lineNumber,1)),column=nextWordOnLine?nextWordOnLine.start+1:model.getLineMaxColumn(lineNumber))),new range_1.Range(lineNumber,column,position.lineNumber,position.column)}static _deleteWordPartRight(model,selection){if(!selection.isEmpty())return selection;const pos=selection.getPosition(),toPosition=WordOperations._moveWordPartRight(model,pos);return new range_1.Range(pos.lineNumber,pos.column,toPosition.lineNumber,toPosition.column)}static _createWordAtPosition(model,lineNumber,word){const range=new range_1.Range(lineNumber,word.start+1,lineNumber,word.end+1);return{word:model.getValueInRange(range),startColumn:range.startColumn,endColumn:range.endColumn}}static getWordAtPosition(model,_wordSeparators,position){const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(_wordSeparators),prevWord=WordOperations._findPreviousWordOnLine(wordSeparators,model,position);if(prevWord&&1===prevWord.wordType&&prevWord.start<=position.column-1&&position.column-1<=prevWord.end)return WordOperations._createWordAtPosition(model,position.lineNumber,prevWord);const nextWord=WordOperations._findNextWordOnLine(wordSeparators,model,position);return nextWord&&1===nextWord.wordType&&nextWord.start<=position.column-1&&position.column-1<=nextWord.end?WordOperations._createWordAtPosition(model,position.lineNumber,nextWord):null}static word(config,model,cursor,inSelectionMode,position){const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(config.wordSeparators),prevWord=WordOperations._findPreviousWordOnLine(wordSeparators,model,position),nextWord=WordOperations._findNextWordOnLine(wordSeparators,model,position);if(!inSelectionMode){let startColumn,endColumn;return prevWord&&1===prevWord.wordType&&prevWord.start<=position.column-1&&position.column-1<=prevWord.end?(startColumn=prevWord.start+1,endColumn=prevWord.end+1):nextWord&&1===nextWord.wordType&&nextWord.start<=position.column-1&&position.column-1<=nextWord.end?(startColumn=nextWord.start+1,endColumn=nextWord.end+1):(startColumn=prevWord?prevWord.end+1:1,endColumn=nextWord?nextWord.start+1:model.getLineMaxColumn(position.lineNumber)),new cursorCommon_1.SingleCursorState(new range_1.Range(position.lineNumber,startColumn,position.lineNumber,endColumn),0,new position_1.Position(position.lineNumber,endColumn),0)}let startColumn,endColumn;prevWord&&1===prevWord.wordType&&prevWord.start<position.column-1&&position.column-1<prevWord.end?(startColumn=prevWord.start+1,endColumn=prevWord.end+1):nextWord&&1===nextWord.wordType&&nextWord.start<position.column-1&&position.column-1<nextWord.end?(startColumn=nextWord.start+1,endColumn=nextWord.end+1):(startColumn=position.column,endColumn=position.column);const lineNumber=position.lineNumber;let column;if(cursor.selectionStart.containsPosition(position))column=cursor.selectionStart.endColumn;else if(position.isBeforeOrEqual(cursor.selectionStart.getStartPosition())){column=startColumn;const possiblePosition=new position_1.Position(lineNumber,column);cursor.selectionStart.containsPosition(possiblePosition)&&(column=cursor.selectionStart.endColumn)}else{column=endColumn;const possiblePosition=new position_1.Position(lineNumber,column);cursor.selectionStart.containsPosition(possiblePosition)&&(column=cursor.selectionStart.startColumn)}return cursor.move(!0,lineNumber,column,0)}}exports.WordOperations=WordOperations;function enforceDefined(arr){return arr.filter((el=>Boolean(el)))}exports.WordPartOperations=class WordPartOperations extends WordOperations{static deleteWordPartLeft(ctx){const candidates=enforceDefined([WordOperations.deleteWordLeft(ctx,0),WordOperations.deleteWordLeft(ctx,2),WordOperations._deleteWordPartLeft(ctx.model,ctx.selection)]);return candidates.sort(range_1.Range.compareRangesUsingEnds),candidates[2]}static deleteWordPartRight(ctx){const candidates=enforceDefined([WordOperations.deleteWordRight(ctx,0),WordOperations.deleteWordRight(ctx,2),WordOperations._deleteWordPartRight(ctx.model,ctx.selection)]);return candidates.sort(range_1.Range.compareRangesUsingStarts),candidates[0]}static moveWordPartLeft(wordSeparators,model,position){const candidates=enforceDefined([WordOperations.moveWordLeft(wordSeparators,model,position,0),WordOperations.moveWordLeft(wordSeparators,model,position,2),WordOperations._moveWordPartLeft(model,position)]);return candidates.sort(position_1.Position.compare),candidates[2]}static moveWordPartRight(wordSeparators,model,position){const candidates=enforceDefined([WordOperations.moveWordRight(wordSeparators,model,position,0),WordOperations.moveWordRight(wordSeparators,model,position,2),WordOperations._moveWordPartRight(model,position)]);return candidates.sort(position_1.Position.compare),candidates[0]}}})),define(__m[182],__M([1,0,19,61,180,151,11,3]),(function(require,exports,types,cursorCommon_1,cursorMoveOperations_1,cursorWordOperations_1,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorMove=exports.CursorMoveCommands=void 0;exports.CursorMoveCommands=class CursorMoveCommands{static addCursorDown(viewModel,cursors,useLogicalLine){const result=[];let resultLen=0;for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[resultLen++]=new cursorCommon_1.CursorState(cursor.modelState,cursor.viewState),result[resultLen++]=useLogicalLine?cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.translateDown(viewModel.cursorConfig,viewModel.model,cursor.modelState)):cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.translateDown(viewModel.cursorConfig,viewModel,cursor.viewState))}return result}static addCursorUp(viewModel,cursors,useLogicalLine){const result=[];let resultLen=0;for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[resultLen++]=new cursorCommon_1.CursorState(cursor.modelState,cursor.viewState),result[resultLen++]=useLogicalLine?cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.translateUp(viewModel.cursorConfig,viewModel.model,cursor.modelState)):cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.translateUp(viewModel.cursorConfig,viewModel,cursor.viewState))}return result}static moveToBeginningOfLine(viewModel,cursors,inSelectionMode){let result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=this._moveToLineStart(viewModel,cursor,inSelectionMode)}return result}static _moveToLineStart(viewModel,cursor,inSelectionMode){const currentViewStateColumn=cursor.viewState.position.column,isFirstLineOfWrappedLine=currentViewStateColumn===cursor.modelState.position.column,currentViewStatelineNumber=cursor.viewState.position.lineNumber,firstNonBlankColumn=viewModel.getLineFirstNonWhitespaceColumn(currentViewStatelineNumber);return isFirstLineOfWrappedLine||currentViewStateColumn===firstNonBlankColumn?this._moveToLineStartByModel(viewModel,cursor,inSelectionMode):this._moveToLineStartByView(viewModel,cursor,inSelectionMode)}static _moveToLineStartByView(viewModel,cursor,inSelectionMode){return cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveToBeginningOfLine(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode))}static _moveToLineStartByModel(viewModel,cursor,inSelectionMode){return cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToBeginningOfLine(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode))}static moveToEndOfLine(viewModel,cursors,inSelectionMode,sticky){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=this._moveToLineEnd(viewModel,cursor,inSelectionMode,sticky)}return result}static _moveToLineEnd(viewModel,cursor,inSelectionMode,sticky){const viewStatePosition=cursor.viewState.position,viewModelMaxColumn=viewModel.getLineMaxColumn(viewStatePosition.lineNumber),isEndOfViewLine=viewStatePosition.column===viewModelMaxColumn,modelStatePosition=cursor.modelState.position,modelMaxColumn=viewModel.model.getLineMaxColumn(modelStatePosition.lineNumber),isEndLineOfWrappedLine=viewModelMaxColumn-viewStatePosition.column==modelMaxColumn-modelStatePosition.column;return isEndOfViewLine||isEndLineOfWrappedLine?this._moveToLineEndByModel(viewModel,cursor,inSelectionMode,sticky):this._moveToLineEndByView(viewModel,cursor,inSelectionMode,sticky)}static _moveToLineEndByView(viewModel,cursor,inSelectionMode,sticky){return cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveToEndOfLine(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,sticky))}static _moveToLineEndByModel(viewModel,cursor,inSelectionMode,sticky){return cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToEndOfLine(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode,sticky))}static expandLineSelection(viewModel,cursors){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],startLineNumber=cursor.modelState.selection.startLineNumber,lineCount=viewModel.model.getLineCount();let endColumn,endLineNumber=cursor.modelState.selection.endLineNumber;endLineNumber===lineCount?endColumn=viewModel.model.getLineMaxColumn(lineCount):(endLineNumber++,endColumn=1),result[i]=cursorCommon_1.CursorState.fromModelState(new cursorCommon_1.SingleCursorState(new range_1.Range(startLineNumber,1,startLineNumber,1),0,new position_1.Position(endLineNumber,endColumn),0))}return result}static moveToBeginningOfBuffer(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToBeginningOfBuffer(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode))}return result}static moveToEndOfBuffer(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToEndOfBuffer(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode))}return result}static selectAll(viewModel,cursor){const lineCount=viewModel.model.getLineCount(),maxColumn=viewModel.model.getLineMaxColumn(lineCount);return cursorCommon_1.CursorState.fromModelState(new cursorCommon_1.SingleCursorState(new range_1.Range(1,1,1,1),0,new position_1.Position(lineCount,maxColumn),0))}static line(viewModel,cursor,inSelectionMode,_position,_viewPosition){const position=viewModel.model.validatePosition(_position),viewPosition=_viewPosition?viewModel.coordinatesConverter.validateViewPosition(new position_1.Position(_viewPosition.lineNumber,_viewPosition.column),position):viewModel.coordinatesConverter.convertModelPositionToViewPosition(position);if(!inSelectionMode||!cursor.modelState.hasSelection()){const lineCount=viewModel.model.getLineCount();let selectToLineNumber=position.lineNumber+1,selectToColumn=1;return selectToLineNumber>lineCount&&(selectToLineNumber=lineCount,selectToColumn=viewModel.model.getLineMaxColumn(selectToLineNumber)),cursorCommon_1.CursorState.fromModelState(new cursorCommon_1.SingleCursorState(new range_1.Range(position.lineNumber,1,selectToLineNumber,selectToColumn),0,new position_1.Position(selectToLineNumber,selectToColumn),0))}const enteringLineNumber=cursor.modelState.selectionStart.getStartPosition().lineNumber;if(position.lineNumber<enteringLineNumber)return cursorCommon_1.CursorState.fromViewState(cursor.viewState.move(cursor.modelState.hasSelection(),viewPosition.lineNumber,1,0));if(position.lineNumber>enteringLineNumber){const lineCount=viewModel.getLineCount();let selectToViewLineNumber=viewPosition.lineNumber+1,selectToViewColumn=1;return selectToViewLineNumber>lineCount&&(selectToViewLineNumber=lineCount,selectToViewColumn=viewModel.getLineMaxColumn(selectToViewLineNumber)),cursorCommon_1.CursorState.fromViewState(cursor.viewState.move(cursor.modelState.hasSelection(),selectToViewLineNumber,selectToViewColumn,0))}{const endPositionOfSelectionStart=cursor.modelState.selectionStart.getEndPosition();return cursorCommon_1.CursorState.fromModelState(cursor.modelState.move(cursor.modelState.hasSelection(),endPositionOfSelectionStart.lineNumber,endPositionOfSelectionStart.column,0))}}static word(viewModel,cursor,inSelectionMode,_position){const position=viewModel.model.validatePosition(_position);return cursorCommon_1.CursorState.fromModelState(cursorWordOperations_1.WordOperations.word(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode,position))}static cancelSelection(viewModel,cursor){if(!cursor.modelState.hasSelection())return new cursorCommon_1.CursorState(cursor.modelState,cursor.viewState);const lineNumber=cursor.viewState.position.lineNumber,column=cursor.viewState.position.column;return cursorCommon_1.CursorState.fromViewState(new cursorCommon_1.SingleCursorState(new range_1.Range(lineNumber,column,lineNumber,column),0,new position_1.Position(lineNumber,column),0))}static moveTo(viewModel,cursor,inSelectionMode,_position,_viewPosition){const position=viewModel.model.validatePosition(_position),viewPosition=_viewPosition?viewModel.coordinatesConverter.validateViewPosition(new position_1.Position(_viewPosition.lineNumber,_viewPosition.column),position):viewModel.coordinatesConverter.convertModelPositionToViewPosition(position);return cursorCommon_1.CursorState.fromViewState(cursor.viewState.move(inSelectionMode,viewPosition.lineNumber,viewPosition.column,0))}static simpleMove(viewModel,cursors,direction,inSelectionMode,value,unit){switch(direction){case 0:return 4===unit?this._moveHalfLineLeft(viewModel,cursors,inSelectionMode):this._moveLeft(viewModel,cursors,inSelectionMode,value);case 1:return 4===unit?this._moveHalfLineRight(viewModel,cursors,inSelectionMode):this._moveRight(viewModel,cursors,inSelectionMode,value);case 2:return 2===unit?this._moveUpByViewLines(viewModel,cursors,inSelectionMode,value):this._moveUpByModelLines(viewModel,cursors,inSelectionMode,value);case 3:return 2===unit?this._moveDownByViewLines(viewModel,cursors,inSelectionMode,value):this._moveDownByModelLines(viewModel,cursors,inSelectionMode,value);case 4:return 2===unit?cursors.map((cursor=>cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveToPrevBlankLine(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode)))):cursors.map((cursor=>cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToPrevBlankLine(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode))));case 5:return 2===unit?cursors.map((cursor=>cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveToNextBlankLine(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode)))):cursors.map((cursor=>cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveToNextBlankLine(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode))));case 6:return this._moveToViewMinColumn(viewModel,cursors,inSelectionMode);case 7:return this._moveToViewFirstNonWhitespaceColumn(viewModel,cursors,inSelectionMode);case 8:return this._moveToViewCenterColumn(viewModel,cursors,inSelectionMode);case 9:return this._moveToViewMaxColumn(viewModel,cursors,inSelectionMode);case 10:return this._moveToViewLastNonWhitespaceColumn(viewModel,cursors,inSelectionMode);default:return null}}static viewportMove(viewModel,cursors,direction,inSelectionMode,value){const visibleViewRange=viewModel.getCompletelyVisibleViewRange(),visibleModelRange=viewModel.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);switch(direction){case 11:{const modelLineNumber=this._firstLineNumberInRange(viewModel.model,visibleModelRange,value),modelColumn=viewModel.model.getLineFirstNonWhitespaceColumn(modelLineNumber);return[this._moveToModelPosition(viewModel,cursors[0],inSelectionMode,modelLineNumber,modelColumn)]}case 13:{const modelLineNumber=this._lastLineNumberInRange(viewModel.model,visibleModelRange,value),modelColumn=viewModel.model.getLineFirstNonWhitespaceColumn(modelLineNumber);return[this._moveToModelPosition(viewModel,cursors[0],inSelectionMode,modelLineNumber,modelColumn)]}case 12:{const modelLineNumber=Math.round((visibleModelRange.startLineNumber+visibleModelRange.endLineNumber)/2),modelColumn=viewModel.model.getLineFirstNonWhitespaceColumn(modelLineNumber);return[this._moveToModelPosition(viewModel,cursors[0],inSelectionMode,modelLineNumber,modelColumn)]}case 14:{const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=this.findPositionInViewportIfOutside(viewModel,cursor,visibleViewRange,inSelectionMode)}return result}default:return null}}static findPositionInViewportIfOutside(viewModel,cursor,visibleViewRange,inSelectionMode){const viewLineNumber=cursor.viewState.position.lineNumber;if(visibleViewRange.startLineNumber<=viewLineNumber&&viewLineNumber<=visibleViewRange.endLineNumber-1)return new cursorCommon_1.CursorState(cursor.modelState,cursor.viewState);{let newViewLineNumber;newViewLineNumber=viewLineNumber>visibleViewRange.endLineNumber-1?visibleViewRange.endLineNumber-1:viewLineNumber<visibleViewRange.startLineNumber?visibleViewRange.startLineNumber:viewLineNumber;const position=cursorMoveOperations_1.MoveOperations.vertical(viewModel.cursorConfig,viewModel,viewLineNumber,cursor.viewState.position.column,cursor.viewState.leftoverVisibleColumns,newViewLineNumber,!1);return cursorCommon_1.CursorState.fromViewState(cursor.viewState.move(inSelectionMode,position.lineNumber,position.column,position.leftoverVisibleColumns))}}static _firstLineNumberInRange(model,range,count){let startLineNumber=range.startLineNumber;return range.startColumn!==model.getLineMinColumn(startLineNumber)&&startLineNumber++,Math.min(range.endLineNumber,startLineNumber+count-1)}static _lastLineNumberInRange(model,range,count){let startLineNumber=range.startLineNumber;return range.startColumn!==model.getLineMinColumn(startLineNumber)&&startLineNumber++,Math.max(startLineNumber,range.endLineNumber-count+1)}static _moveLeft(viewModel,cursors,inSelectionMode,noOfColumns){return cursors.map((cursor=>cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveLeft(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,noOfColumns))))}static _moveHalfLineLeft(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,halfLine=Math.round(viewModel.getLineContent(viewLineNumber).length/2);result[i]=cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveLeft(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,halfLine))}return result}static _moveRight(viewModel,cursors,inSelectionMode,noOfColumns){return cursors.map((cursor=>cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveRight(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,noOfColumns))))}static _moveHalfLineRight(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,halfLine=Math.round(viewModel.getLineContent(viewLineNumber).length/2);result[i]=cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveRight(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,halfLine))}return result}static _moveDownByViewLines(viewModel,cursors,inSelectionMode,linesCount){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveDown(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,linesCount))}return result}static _moveDownByModelLines(viewModel,cursors,inSelectionMode,linesCount){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveDown(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode,linesCount))}return result}static _moveUpByViewLines(viewModel,cursors,inSelectionMode,linesCount){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromViewState(cursorMoveOperations_1.MoveOperations.moveUp(viewModel.cursorConfig,viewModel,cursor.viewState,inSelectionMode,linesCount))}return result}static _moveUpByModelLines(viewModel,cursors,inSelectionMode,linesCount){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i];result[i]=cursorCommon_1.CursorState.fromModelState(cursorMoveOperations_1.MoveOperations.moveUp(viewModel.cursorConfig,viewModel.model,cursor.modelState,inSelectionMode,linesCount))}return result}static _moveToViewPosition(viewModel,cursor,inSelectionMode,toViewLineNumber,toViewColumn){return cursorCommon_1.CursorState.fromViewState(cursor.viewState.move(inSelectionMode,toViewLineNumber,toViewColumn,0))}static _moveToModelPosition(viewModel,cursor,inSelectionMode,toModelLineNumber,toModelColumn){return cursorCommon_1.CursorState.fromModelState(cursor.modelState.move(inSelectionMode,toModelLineNumber,toModelColumn,0))}static _moveToViewMinColumn(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,viewColumn=viewModel.getLineMinColumn(viewLineNumber);result[i]=this._moveToViewPosition(viewModel,cursor,inSelectionMode,viewLineNumber,viewColumn)}return result}static _moveToViewFirstNonWhitespaceColumn(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,viewColumn=viewModel.getLineFirstNonWhitespaceColumn(viewLineNumber);result[i]=this._moveToViewPosition(viewModel,cursor,inSelectionMode,viewLineNumber,viewColumn)}return result}static _moveToViewCenterColumn(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,viewColumn=Math.round((viewModel.getLineMaxColumn(viewLineNumber)+viewModel.getLineMinColumn(viewLineNumber))/2);result[i]=this._moveToViewPosition(viewModel,cursor,inSelectionMode,viewLineNumber,viewColumn)}return result}static _moveToViewMaxColumn(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,viewColumn=viewModel.getLineMaxColumn(viewLineNumber);result[i]=this._moveToViewPosition(viewModel,cursor,inSelectionMode,viewLineNumber,viewColumn)}return result}static _moveToViewLastNonWhitespaceColumn(viewModel,cursors,inSelectionMode){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],viewLineNumber=cursor.viewState.position.lineNumber,viewColumn=viewModel.getLineLastNonWhitespaceColumn(viewLineNumber);result[i]=this._moveToViewPosition(viewModel,cursor,inSelectionMode,viewLineNumber,viewColumn)}return result}},function(CursorMove){CursorMove.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t",constraint:function(arg){if(!types.isObject(arg))return!1;const cursorMoveArg=arg;return!!types.isString(cursorMoveArg.to)&&(!(!types.isUndefined(cursorMoveArg.select)&&!types.isBoolean(cursorMoveArg.select))&&(!(!types.isUndefined(cursorMoveArg.by)&&!types.isString(cursorMoveArg.by))&&!(!types.isUndefined(cursorMoveArg.value)&&!types.isNumber(cursorMoveArg.value))))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},CursorMove.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},CursorMove.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},CursorMove.parse=function parse(args){if(!args.to)return null;let direction;switch(args.to){case CursorMove.RawDirection.Left:direction=0;break;case CursorMove.RawDirection.Right:direction=1;break;case CursorMove.RawDirection.Up:direction=2;break;case CursorMove.RawDirection.Down:direction=3;break;case CursorMove.RawDirection.PrevBlankLine:direction=4;break;case CursorMove.RawDirection.NextBlankLine:direction=5;break;case CursorMove.RawDirection.WrappedLineStart:direction=6;break;case CursorMove.RawDirection.WrappedLineFirstNonWhitespaceCharacter:direction=7;break;case CursorMove.RawDirection.WrappedLineColumnCenter:direction=8;break;case CursorMove.RawDirection.WrappedLineEnd:direction=9;break;case CursorMove.RawDirection.WrappedLineLastNonWhitespaceCharacter:direction=10;break;case CursorMove.RawDirection.ViewPortTop:direction=11;break;case CursorMove.RawDirection.ViewPortBottom:direction=13;break;case CursorMove.RawDirection.ViewPortCenter:direction=12;break;case CursorMove.RawDirection.ViewPortIfOutside:direction=14;break;default:return null}let unit=0;switch(args.by){case CursorMove.RawUnit.Line:unit=1;break;case CursorMove.RawUnit.WrappedLine:unit=2;break;case CursorMove.RawUnit.Character:unit=3;break;case CursorMove.RawUnit.HalfLine:unit=4}return{direction,unit,select:!!args.select,value:args.value||1}}}(exports.CursorMove||(exports.CursorMove={}))})),define(__m[413],__M([1,0,61,11,3,22]),(function(require,exports,cursorCommon_1,position_1,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cursor=void 0;class Cursor{constructor(context){this._selTrackedRange=null,this._trackSelection=!0,this._setState(context,new cursorCommon_1.SingleCursorState(new range_1.Range(1,1,1,1),0,new position_1.Position(1,1),0),new cursorCommon_1.SingleCursorState(new range_1.Range(1,1,1,1),0,new position_1.Position(1,1),0))}dispose(context){this._removeTrackedRange(context)}startTrackingSelection(context){this._trackSelection=!0,this._updateTrackedRange(context)}stopTrackingSelection(context){this._trackSelection=!1,this._removeTrackedRange(context)}_updateTrackedRange(context){this._trackSelection&&(this._selTrackedRange=context.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(context){this._selTrackedRange=context.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new cursorCommon_1.CursorState(this.modelState,this.viewState)}readSelectionFromMarkers(context){const range=context.model._getTrackedRange(this._selTrackedRange);return selection_1.Selection.fromRange(range,this.modelState.selection.getDirection())}ensureValidState(context){this._setState(context,this.modelState,this.viewState)}setState(context,modelState,viewState){this._setState(context,modelState,viewState)}static _validatePositionWithCache(viewModel,position,cacheInput,cacheOutput){return position.equals(cacheInput)?cacheOutput:viewModel.normalizePosition(position,2)}static _validateViewState(viewModel,viewState){const position=viewState.position,sStartPosition=viewState.selectionStart.getStartPosition(),sEndPosition=viewState.selectionStart.getEndPosition(),validPosition=viewModel.normalizePosition(position,2),validSStartPosition=this._validatePositionWithCache(viewModel,sStartPosition,position,validPosition),validSEndPosition=this._validatePositionWithCache(viewModel,sEndPosition,sStartPosition,validSStartPosition);return position.equals(validPosition)&&sStartPosition.equals(validSStartPosition)&&sEndPosition.equals(validSEndPosition)?viewState:new cursorCommon_1.SingleCursorState(range_1.Range.fromPositions(validSStartPosition,validSEndPosition),viewState.selectionStartLeftoverVisibleColumns+sStartPosition.column-validSStartPosition.column,validPosition,viewState.leftoverVisibleColumns+position.column-validPosition.column)}_setState(context,modelState,viewState){if(viewState&&(viewState=Cursor._validateViewState(context.viewModel,viewState)),modelState){const selectionStart=context.model.validateRange(modelState.selectionStart),selectionStartLeftoverVisibleColumns=modelState.selectionStart.equalsRange(selectionStart)?modelState.selectionStartLeftoverVisibleColumns:0,position=context.model.validatePosition(modelState.position),leftoverVisibleColumns=modelState.position.equals(position)?modelState.leftoverVisibleColumns:0;modelState=new cursorCommon_1.SingleCursorState(selectionStart,selectionStartLeftoverVisibleColumns,position,leftoverVisibleColumns)}else{if(!viewState)return;const selectionStart=context.model.validateRange(context.coordinatesConverter.convertViewRangeToModelRange(viewState.selectionStart)),position=context.model.validatePosition(context.coordinatesConverter.convertViewPositionToModelPosition(viewState.position));modelState=new cursorCommon_1.SingleCursorState(selectionStart,viewState.selectionStartLeftoverVisibleColumns,position,viewState.leftoverVisibleColumns)}if(viewState){const viewSelectionStart=context.coordinatesConverter.validateViewRange(viewState.selectionStart,modelState.selectionStart),viewPosition=context.coordinatesConverter.validateViewPosition(viewState.position,modelState.position);viewState=new cursorCommon_1.SingleCursorState(viewSelectionStart,modelState.selectionStartLeftoverVisibleColumns,viewPosition,modelState.leftoverVisibleColumns)}else{const viewSelectionStart1=context.coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelState.selectionStart.startLineNumber,modelState.selectionStart.startColumn)),viewSelectionStart2=context.coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelState.selectionStart.endLineNumber,modelState.selectionStart.endColumn)),viewSelectionStart=new range_1.Range(viewSelectionStart1.lineNumber,viewSelectionStart1.column,viewSelectionStart2.lineNumber,viewSelectionStart2.column),viewPosition=context.coordinatesConverter.convertModelPositionToViewPosition(modelState.position);viewState=new cursorCommon_1.SingleCursorState(viewSelectionStart,modelState.selectionStartLeftoverVisibleColumns,viewPosition,modelState.leftoverVisibleColumns)}this.modelState=modelState,this.viewState=viewState,this._updateTrackedRange(context)}}exports.Cursor=Cursor})),define(__m[414],__M([1,0,18,61,413,11,3,22]),(function(require,exports,arrays_1,cursorCommon_1,oneCursor_1,position_1,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorCollection=void 0;exports.CursorCollection=class CursorCollection{constructor(context){this.context=context,this.cursors=[new oneCursor_1.Cursor(context)],this.lastAddedCursorIndex=0}dispose(){for(const cursor of this.cursors)cursor.dispose(this.context)}startTrackingSelections(){for(const cursor of this.cursors)cursor.startTrackingSelection(this.context)}stopTrackingSelections(){for(const cursor of this.cursors)cursor.stopTrackingSelection(this.context)}updateContext(context){this.context=context}ensureValidState(){for(const cursor of this.cursors)cursor.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map((c=>c.readSelectionFromMarkers(this.context)))}getAll(){return this.cursors.map((c=>c.asCursorState()))}getViewPositions(){return this.cursors.map((c=>c.viewState.position))}getTopMostViewPosition(){return(0,arrays_1.findMinBy)(this.cursors,(0,arrays_1.compareBy)((c=>c.viewState.position),position_1.Position.compare)).viewState.position}getBottomMostViewPosition(){return(0,arrays_1.findLastMaxBy)(this.cursors,(0,arrays_1.compareBy)((c=>c.viewState.position),position_1.Position.compare)).viewState.position}getSelections(){return this.cursors.map((c=>c.modelState.selection))}getViewSelections(){return this.cursors.map((c=>c.viewState.selection))}setSelections(selections){this.setStates(cursorCommon_1.CursorState.fromModelSelections(selections))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(states){null!==states&&(this.cursors[0].setState(this.context,states[0].modelState,states[0].viewState),this._setSecondaryStates(states.slice(1)))}_setSecondaryStates(secondaryStates){const secondaryCursorsLength=this.cursors.length-1,secondaryStatesLength=secondaryStates.length;if(secondaryCursorsLength<secondaryStatesLength){const createCnt=secondaryStatesLength-secondaryCursorsLength;for(let i=0;i<createCnt;i++)this._addSecondaryCursor()}else if(secondaryCursorsLength>secondaryStatesLength){const removeCnt=secondaryCursorsLength-secondaryStatesLength;for(let i=0;i<removeCnt;i++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<secondaryStatesLength;i++)this.cursors[i+1].setState(this.context,secondaryStates[i].modelState,secondaryStates[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new oneCursor_1.Cursor(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return 1===this.cursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(removeIndex){this.lastAddedCursorIndex>=removeIndex+1&&this.lastAddedCursorIndex--,this.cursors[removeIndex+1].dispose(this.context),this.cursors.splice(removeIndex+1,1)}normalize(){if(1===this.cursors.length)return;const cursors=this.cursors.slice(0),sortedCursors=[];for(let i=0,len=cursors.length;i<len;i++)sortedCursors.push({index:i,selection:cursors[i].modelState.selection});sortedCursors.sort((0,arrays_1.compareBy)((s=>s.selection),range_1.Range.compareRangesUsingStarts));for(let sortedCursorIndex=0;sortedCursorIndex<sortedCursors.length-1;sortedCursorIndex++){const current=sortedCursors[sortedCursorIndex],next=sortedCursors[sortedCursorIndex+1],currentSelection=current.selection,nextSelection=next.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let shouldMergeCursors;if(shouldMergeCursors=nextSelection.isEmpty()||currentSelection.isEmpty()?nextSelection.getStartPosition().isBeforeOrEqual(currentSelection.getEndPosition()):nextSelection.getStartPosition().isBefore(currentSelection.getEndPosition()),shouldMergeCursors){const winnerSortedCursorIndex=current.index<next.index?sortedCursorIndex:sortedCursorIndex+1,looserSortedCursorIndex=current.index<next.index?sortedCursorIndex+1:sortedCursorIndex,looserIndex=sortedCursors[looserSortedCursorIndex].index,winnerIndex=sortedCursors[winnerSortedCursorIndex].index,looserSelection=sortedCursors[looserSortedCursorIndex].selection,winnerSelection=sortedCursors[winnerSortedCursorIndex].selection;if(!looserSelection.equalsSelection(winnerSelection)){const resultingRange=looserSelection.plusRange(winnerSelection),looserSelectionIsLTR=looserSelection.selectionStartLineNumber===looserSelection.startLineNumber&&looserSelection.selectionStartColumn===looserSelection.startColumn,winnerSelectionIsLTR=winnerSelection.selectionStartLineNumber===winnerSelection.startLineNumber&&winnerSelection.selectionStartColumn===winnerSelection.startColumn;let resultingSelectionIsLTR,resultingSelection;looserIndex===this.lastAddedCursorIndex?(resultingSelectionIsLTR=looserSelectionIsLTR,this.lastAddedCursorIndex=winnerIndex):resultingSelectionIsLTR=winnerSelectionIsLTR,resultingSelection=resultingSelectionIsLTR?new selection_1.Selection(resultingRange.startLineNumber,resultingRange.startColumn,resultingRange.endLineNumber,resultingRange.endColumn):new selection_1.Selection(resultingRange.endLineNumber,resultingRange.endColumn,resultingRange.startLineNumber,resultingRange.startColumn),sortedCursors[winnerSortedCursorIndex].selection=resultingSelection;const resultingState=cursorCommon_1.CursorState.fromModelSelection(resultingSelection);cursors[winnerIndex].setState(this.context,resultingState.modelState,resultingState.viewState)}for(const sortedCursor of sortedCursors)sortedCursor.index>looserIndex&&sortedCursor.index--;cursors.splice(looserIndex,1),sortedCursors.splice(looserSortedCursorIndex,1),this._removeSecondaryCursor(looserIndex-1),sortedCursorIndex--}}}}})),define(__m[415],__M([1,0,122]),(function(require,exports,languageConfiguration_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CharacterPairSupport=void 0;class CharacterPairSupport{constructor(config){if(config.autoClosingPairs?this._autoClosingPairs=config.autoClosingPairs.map((el=>new languageConfiguration_1.StandardAutoClosingPairConditional(el))):config.brackets?this._autoClosingPairs=config.brackets.map((b=>new languageConfiguration_1.StandardAutoClosingPairConditional({open:b[0],close:b[1]}))):this._autoClosingPairs=[],config.colorizedBracketPairs?this._colorizedBracketPairs=filterValidBrackets(config.colorizedBracketPairs.map((b=>[b[0],b[1]]))):config.brackets?this._colorizedBracketPairs=filterValidBrackets(config.brackets.map((b=>[b[0],b[1]])).filter((p=>!("<"===p[0]&&">"===p[1])))):this._colorizedBracketPairs=[],config.__electricCharacterSupport&&config.__electricCharacterSupport.docComment){const docComment=config.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new languageConfiguration_1.StandardAutoClosingPairConditional({open:docComment.open,close:docComment.close||""}))}this._autoCloseBefore="string"==typeof config.autoCloseBefore?config.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED,this._surroundingPairs=config.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(){return this._autoCloseBefore}getSurroundingPairs(){return this._surroundingPairs}getColorizedBrackets(){return this._colorizedBracketPairs}}function filterValidBrackets(bracketPairs){return bracketPairs.filter((([open,close])=>""!==open&&""!==close))}exports.CharacterPairSupport=CharacterPairSupport,CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED=";:.,=}])> \n\t"})),define(__m[416],__M([1,0]),(function(require,exports){"use strict";function resetGlobalRegex(reg){return reg.global&&(reg.lastIndex=0),!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndentRulesSupport=void 0;exports.IndentRulesSupport=class IndentRulesSupport{constructor(indentationRules){this._indentationRules=indentationRules}shouldIncrease(text){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&resetGlobalRegex(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(text))}shouldDecrease(text){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&resetGlobalRegex(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(text))}shouldIndentNextLine(text){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&resetGlobalRegex(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(text))}shouldIgnore(text){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&resetGlobalRegex(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(text))}getIndentMetadata(text){let ret=0;return this.shouldIncrease(text)&&(ret+=1),this.shouldDecrease(text)&&(ret+=2),this.shouldIndentNextLine(text)&&(ret+=4),this.shouldIgnore(text)&&(ret+=8),ret}}})),define(__m[417],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BasicInplaceReplace=void 0;class BasicInplaceReplace{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(range1,text1,range2,text2,up){if(range1&&text1){const result=this.doNavigateValueSet(text1,up);if(result)return{range:range1,value:result}}if(range2&&text2){const result=this.doNavigateValueSet(text2,up);if(result)return{range:range2,value:result}}return null}doNavigateValueSet(text,up){const numberResult=this.numberReplace(text,up);return null!==numberResult?numberResult:this.textReplace(text,up)}numberReplace(value,up){const precision=Math.pow(10,value.length-(value.lastIndexOf(".")+1));let n1=Number(value),n2=parseFloat(value);return isNaN(n1)||isNaN(n2)||n1!==n2?null:0!==n1||up?(n1=Math.floor(n1*precision),n1+=up?precision:-precision,String(n1/precision)):null}textReplace(value,up){return this.valueSetsReplace(this._defaultValueSet,value,up)}valueSetsReplace(valueSets,value,up){let result=null;for(let i=0,len=valueSets.length;null===result&&i<len;i++)result=this.valueSetReplace(valueSets[i],value,up);return result}valueSetReplace(valueSet,value,up){let idx=valueSet.indexOf(value);return idx>=0?(idx+=up?1:-1,idx<0?idx=valueSet.length-1:idx%=valueSet.length,valueSet[idx]):null}}exports.BasicInplaceReplace=BasicInplaceReplace,BasicInplaceReplace.INSTANCE=new BasicInplaceReplace})),define(__m[418],__M([1,0,13,8,122]),(function(require,exports,errors_1,strings,languageConfiguration_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OnEnterSupport=void 0;class OnEnterSupport{constructor(opts){(opts=opts||{}).brackets=opts.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],opts.brackets.forEach((bracket=>{const openRegExp=OnEnterSupport._createOpenBracketRegExp(bracket[0]),closeRegExp=OnEnterSupport._createCloseBracketRegExp(bracket[1]);openRegExp&&closeRegExp&&this._brackets.push({open:bracket[0],openRegExp,close:bracket[1],closeRegExp})})),this._regExpRules=opts.onEnterRules||[]}onEnter(autoIndent,previousLineText,beforeEnterText,afterEnterText){if(autoIndent>=3)for(let i=0,len=this._regExpRules.length;i<len;i++){const rule=this._regExpRules[i];if([{reg:rule.beforeText,text:beforeEnterText},{reg:rule.afterText,text:afterEnterText},{reg:rule.previousLineText,text:previousLineText}].every((obj=>!obj.reg||(obj.reg.lastIndex=0,obj.reg.test(obj.text)))))return rule.action}if(autoIndent>=2&&beforeEnterText.length>0&&afterEnterText.length>0)for(let i=0,len=this._brackets.length;i<len;i++){const bracket=this._brackets[i];if(bracket.openRegExp.test(beforeEnterText)&&bracket.closeRegExp.test(afterEnterText))return{indentAction:languageConfiguration_1.IndentAction.IndentOutdent}}if(autoIndent>=2&&beforeEnterText.length>0)for(let i=0,len=this._brackets.length;i<len;i++){if(this._brackets[i].openRegExp.test(beforeEnterText))return{indentAction:languageConfiguration_1.IndentAction.Indent}}return null}static _createOpenBracketRegExp(bracket){let str=strings.escapeRegExpCharacters(bracket);return/\B/.test(str.charAt(0))||(str="\\b"+str),str+="\\s*$",OnEnterSupport._safeRegExp(str)}static _createCloseBracketRegExp(bracket){let str=strings.escapeRegExpCharacters(bracket);return/\B/.test(str.charAt(str.length-1))||(str+="\\b"),str="^\\s*"+str,OnEnterSupport._safeRegExp(str)}static _safeRegExp(def){try{return new RegExp(def)}catch(err){return(0,errors_1.onUnexpectedError)(err),null}}}exports.OnEnterSupport=OnEnterSupport})),define(__m[183],__M([1,0,8,93,3]),(function(require,exports,strings,stringBuilder,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketsUtils=exports.RichEditBrackets=exports.RichEditBracket=void 0;class RichEditBracket{constructor(languageId,index,open,close,forwardRegex,reversedRegex){this._richEditBracketBrand=void 0,this.languageId=languageId,this.index=index,this.open=open,this.close=close,this.forwardRegex=forwardRegex,this.reversedRegex=reversedRegex,this._openSet=RichEditBracket._toSet(this.open),this._closeSet=RichEditBracket._toSet(this.close)}isOpen(text){return this._openSet.has(text)}isClose(text){return this._closeSet.has(text)}static _toSet(arr){const result=new Set;for(const element of arr)result.add(element);return result}}exports.RichEditBracket=RichEditBracket;function collectSuperstrings(str,brackets,currentIndex,dest){for(let i=0,len=brackets.length;i<len;i++){if(i===currentIndex)continue;const bracket=brackets[i];for(const open of bracket.open)open.indexOf(str)>=0&&dest.push(open);for(const close of bracket.close)close.indexOf(str)>=0&&dest.push(close)}}function lengthcmp(a,b){return a.length-b.length}function unique(arr){if(arr.length<=1)return arr;const result=[],seen=new Set;for(const element of arr)seen.has(element)||(result.push(element),seen.add(element));return result}function prepareBracketForRegExp(str){const insertWordBoundaries=/^[\w ]+$/.test(str);return str=strings.escapeRegExpCharacters(str),insertWordBoundaries?`\\b${str}\\b`:str}function createBracketOrRegExp(pieces){const regexStr=`(${pieces.map(prepareBracketForRegExp).join(")|(")})`;return strings.createRegExp(regexStr,!0)}exports.RichEditBrackets=class RichEditBrackets{constructor(languageId,_brackets){this._richEditBracketsBrand=void 0;const brackets=function groupFuzzyBrackets(brackets){const N=brackets.length;brackets=brackets.map((b=>[b[0].toLowerCase(),b[1].toLowerCase()]));const group=[];for(let i=0;i<N;i++)group[i]=i;const areOverlapping=(a,b)=>{const[aOpen,aClose]=a,[bOpen,bClose]=b;return aOpen===bOpen||aOpen===bClose||aClose===bOpen||aClose===bClose},mergeGroups=(g1,g2)=>{const newG=Math.min(g1,g2),oldG=Math.max(g1,g2);for(let i=0;i<N;i++)group[i]===oldG&&(group[i]=newG)};for(let i=0;i<N;i++){const a=brackets[i];for(let j=i+1;j<N;j++)areOverlapping(a,brackets[j])&&mergeGroups(group[i],group[j])}const result=[];for(let g=0;g<N;g++){const currentOpen=[],currentClose=[];for(let i=0;i<N;i++)if(group[i]===g){const[open,close]=brackets[i];currentOpen.push(open),currentClose.push(close)}currentOpen.length>0&&result.push({open:currentOpen,close:currentClose})}return result}(_brackets);this.brackets=brackets.map(((b,index)=>new RichEditBracket(languageId,index,b.open,b.close,function getRegexForBracketPair(open,close,brackets,currentIndex){let pieces=[];pieces=pieces.concat(open),pieces=pieces.concat(close);for(let i=0,len=pieces.length;i<len;i++)collectSuperstrings(pieces[i],brackets,currentIndex,pieces);return pieces=unique(pieces),pieces.sort(lengthcmp),pieces.reverse(),createBracketOrRegExp(pieces)}(b.open,b.close,brackets,index),function getReversedRegexForBracketPair(open,close,brackets,currentIndex){let pieces=[];pieces=pieces.concat(open),pieces=pieces.concat(close);for(let i=0,len=pieces.length;i<len;i++)collectSuperstrings(pieces[i],brackets,currentIndex,pieces);return pieces=unique(pieces),pieces.sort(lengthcmp),pieces.reverse(),createBracketOrRegExp(pieces.map(toReversedString))}(b.open,b.close,brackets,index)))),this.forwardRegex=function getRegexForBrackets(brackets){let pieces=[];for(const bracket of brackets){for(const open of bracket.open)pieces.push(open);for(const close of bracket.close)pieces.push(close)}return pieces=unique(pieces),createBracketOrRegExp(pieces)}(this.brackets),this.reversedRegex=function getReversedRegexForBrackets(brackets){let pieces=[];for(const bracket of brackets){for(const open of bracket.open)pieces.push(open);for(const close of bracket.close)pieces.push(close)}return pieces=unique(pieces),createBracketOrRegExp(pieces.map(toReversedString))}(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const bracket of this.brackets){for(const open of bracket.open)this.textIsBracket[open]=bracket,this.textIsOpenBracket[open]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,open.length);for(const close of bracket.close)this.textIsBracket[close]=bracket,this.textIsOpenBracket[close]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,close.length)}}};const toReversedString=function(){let lastInput=null,lastOutput=null;return function toReversedString(str){return lastInput!==str&&(lastInput=str,lastOutput=function reverse(str){if(stringBuilder.hasTextDecoder){const arr=new Uint16Array(str.length);let offset=0;for(let i=str.length-1;i>=0;i--)arr[offset++]=str.charCodeAt(i);return stringBuilder.getPlatformTextDecoder().decode(arr)}{const result=[];let resultLen=0;for(let i=str.length-1;i>=0;i--)result[resultLen++]=str.charAt(i);return result.join("")}}(lastInput)),lastOutput}}();exports.BracketsUtils=class BracketsUtils{static _findPrevBracketInText(reversedBracketRegex,lineNumber,reversedText,offset){const m=reversedText.match(reversedBracketRegex);if(!m)return null;const matchOffset=reversedText.length-(m.index||0),matchLength=m[0].length,absoluteMatchOffset=offset+matchOffset;return new range_1.Range(lineNumber,absoluteMatchOffset-matchLength+1,lineNumber,absoluteMatchOffset+1)}static findPrevBracketInRange(reversedBracketRegex,lineNumber,lineText,startOffset,endOffset){const reversedSubstr=toReversedString(lineText).substring(lineText.length-endOffset,lineText.length-startOffset);return this._findPrevBracketInText(reversedBracketRegex,lineNumber,reversedSubstr,startOffset)}static findNextBracketInText(bracketRegex,lineNumber,text,offset){const m=text.match(bracketRegex);if(!m)return null;const matchOffset=m.index||0,matchLength=m[0].length;if(0===matchLength)return null;const absoluteMatchOffset=offset+matchOffset;return new range_1.Range(lineNumber,absoluteMatchOffset+1,lineNumber,absoluteMatchOffset+1+matchLength)}static findNextBracketInRange(bracketRegex,lineNumber,lineText,startOffset,endOffset){const substr=lineText.substring(startOffset,endOffset);return this.findNextBracketInText(bracketRegex,lineNumber,substr,startOffset)}}})),define(__m[419],__M([1,0,18,123,183]),(function(require,exports,arrays_1,supports_1,richEditBrackets_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketElectricCharacterSupport=void 0;exports.BracketElectricCharacterSupport=class BracketElectricCharacterSupport{constructor(richEditBrackets){this._richEditBrackets=richEditBrackets}getElectricCharacters(){const result=[];if(this._richEditBrackets)for(const bracket of this._richEditBrackets.brackets)for(const close of bracket.close){const lastChar=close.charAt(close.length-1);result.push(lastChar)}return(0,arrays_1.distinct)(result)}onElectricCharacter(character,context,column){if(!this._richEditBrackets||0===this._richEditBrackets.brackets.length)return null;const tokenIndex=context.findTokenIndexAtOffset(column-1);if((0,supports_1.ignoreBracketsInToken)(context.getStandardTokenType(tokenIndex)))return null;const reversedBracketRegex=this._richEditBrackets.reversedRegex,text=context.getLineContent().substring(0,column-1)+character,r=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(reversedBracketRegex,1,text,0,text.length);if(!r)return null;const bracketText=text.substring(r.startColumn-1,r.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[bracketText])return null;const textBeforeBracket=context.getActualLineContentBefore(r.startColumn-1);return/^\s*$/.test(textBeforeBracket)?{matchOpenBracket:bracketText}:null}}})),define(__m[420],__M([1,0,30]),(function(require,exports,color_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateTokensCSSForColorMap=exports.ThemeTrieElement=exports.ThemeTrieElementRule=exports.strcmp=exports.toStandardTokenType=exports.TokenTheme=exports.ColorMap=exports.parseTokenTheme=exports.ParsedTokenThemeRule=void 0;class ParsedTokenThemeRule{constructor(token,index,fontStyle,foreground,background){this._parsedThemeRuleBrand=void 0,this.token=token,this.index=index,this.fontStyle=fontStyle,this.foreground=foreground,this.background=background}}function parseTokenTheme(source){if(!source||!Array.isArray(source))return[];const result=[];let resultLen=0;for(let i=0,len=source.length;i<len;i++){const entry=source[i];let fontStyle=-1;if("string"==typeof entry.fontStyle){fontStyle=0;const segments=entry.fontStyle.split(" ");for(let j=0,lenJ=segments.length;j<lenJ;j++){switch(segments[j]){case"italic":fontStyle|=1;break;case"bold":fontStyle|=2;break;case"underline":fontStyle|=4;break;case"strikethrough":fontStyle|=8}}}let foreground=null;"string"==typeof entry.foreground&&(foreground=entry.foreground);let background=null;"string"==typeof entry.background&&(background=entry.background),result[resultLen++]=new ParsedTokenThemeRule(entry.token||"",i,fontStyle,foreground,background)}return result}exports.ParsedTokenThemeRule=ParsedTokenThemeRule,exports.parseTokenTheme=parseTokenTheme;const colorRegExp=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class ColorMap{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(color){if(null===color)return 0;const match=color.match(colorRegExp);if(!match)throw new Error("Illegal value for token color: "+color);color=match[1].toUpperCase();let value=this._color2id.get(color);return value||(value=++this._lastColorId,this._color2id.set(color,value),this._id2color[value]=color_1.Color.fromHex("#"+color),value)}getColorMap(){return this._id2color.slice(0)}}exports.ColorMap=ColorMap;class TokenTheme{constructor(colorMap,root){this._colorMap=colorMap,this._root=root,this._cache=new Map}static createFromRawTokenTheme(source,customTokenColors){return this.createFromParsedTokenTheme(parseTokenTheme(source),customTokenColors)}static createFromParsedTokenTheme(source,customTokenColors){return function resolveParsedTokenThemeRules(parsedThemeRules,customTokenColors){parsedThemeRules.sort(((a,b)=>{const r=strcmp(a.token,b.token);return 0!==r?r:a.index-b.index}));let defaultFontStyle=0,defaultForeground="000000",defaultBackground="ffffff";for(;parsedThemeRules.length>=1&&""===parsedThemeRules[0].token;){const incomingDefaults=parsedThemeRules.shift();-1!==incomingDefaults.fontStyle&&(defaultFontStyle=incomingDefaults.fontStyle),null!==incomingDefaults.foreground&&(defaultForeground=incomingDefaults.foreground),null!==incomingDefaults.background&&(defaultBackground=incomingDefaults.background)}const colorMap=new ColorMap;for(let color of customTokenColors)colorMap.getId(color);const foregroundColorId=colorMap.getId(defaultForeground),backgroundColorId=colorMap.getId(defaultBackground),defaults=new ThemeTrieElementRule(defaultFontStyle,foregroundColorId,backgroundColorId),root=new ThemeTrieElement(defaults);for(let i=0,len=parsedThemeRules.length;i<len;i++){const rule=parsedThemeRules[i];root.insert(rule.token,rule.fontStyle,colorMap.getId(rule.foreground),colorMap.getId(rule.background))}return new TokenTheme(colorMap,root)}(source,customTokenColors)}getColorMap(){return this._colorMap.getColorMap()}_match(token){return this._root.match(token)}match(languageId,token){let result=this._cache.get(token);if(void 0===result){const rule=this._match(token),standardToken=toStandardTokenType(token);result=(rule.metadata|standardToken<<8)>>>0,this._cache.set(token,result)}return(result|languageId<<0)>>>0}}exports.TokenTheme=TokenTheme;const STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|regexp)\b/;function toStandardTokenType(tokenType){const m=tokenType.match(STANDARD_TOKEN_TYPE_REGEXP);if(!m)return 0;switch(m[1]){case"comment":return 1;case"string":return 2;case"regex":case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function strcmp(a,b){return a<b?-1:a>b?1:0}exports.toStandardTokenType=toStandardTokenType,exports.strcmp=strcmp;class ThemeTrieElementRule{constructor(fontStyle,foreground,background){this._themeTrieElementRuleBrand=void 0,this._fontStyle=fontStyle,this._foreground=foreground,this._background=background,this.metadata=(this._fontStyle<<10|this._foreground<<14|this._background<<23)>>>0}clone(){return new ThemeTrieElementRule(this._fontStyle,this._foreground,this._background)}acceptOverwrite(fontStyle,foreground,background){-1!==fontStyle&&(this._fontStyle=fontStyle),0!==foreground&&(this._foreground=foreground),0!==background&&(this._background=background),this.metadata=(this._fontStyle<<10|this._foreground<<14|this._background<<23)>>>0}}exports.ThemeTrieElementRule=ThemeTrieElementRule;class ThemeTrieElement{constructor(mainRule){this._themeTrieElementBrand=void 0,this._mainRule=mainRule,this._children=new Map}match(token){if(""===token)return this._mainRule;const dotIndex=token.indexOf(".");let head,tail;-1===dotIndex?(head=token,tail=""):(head=token.substring(0,dotIndex),tail=token.substring(dotIndex+1));const child=this._children.get(head);return void 0!==child?child.match(tail):this._mainRule}insert(token,fontStyle,foreground,background){if(""===token)return void this._mainRule.acceptOverwrite(fontStyle,foreground,background);const dotIndex=token.indexOf(".");let head,tail;-1===dotIndex?(head=token,tail=""):(head=token.substring(0,dotIndex),tail=token.substring(dotIndex+1));let child=this._children.get(head);void 0===child&&(child=new ThemeTrieElement(this._mainRule.clone()),this._children.set(head,child)),child.insert(tail,fontStyle,foreground,background)}}exports.ThemeTrieElement=ThemeTrieElement,exports.generateTokensCSSForColorMap=function generateTokensCSSForColorMap(colorMap){const rules=[];for(let i=1,len=colorMap.length;i<len;i++){const color=colorMap[i];rules[i]=`.mtk${i} { color: ${color}; }`}return rules.push(".mtki { font-style: italic; }"),rules.push(".mtkb { font-weight: bold; }"),rules.push(".mtku { text-decoration: underline; text-underline-position: under; }"),rules.push(".mtks { text-decoration: line-through; }"),rules.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),rules.join("\n")}})),define(__m[50],__M([1,0,40]),(function(require,exports,objects_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shouldSynchronizeModel=exports.ApplyEditsResult=exports.SearchData=exports.ValidAnnotatedEditOperation=exports.FindMatch=exports.TextModelResolvedOptions=exports.InjectedTextCursorStops=exports.MinimapPosition=exports.OverviewRulerLane=void 0,function(OverviewRulerLane){OverviewRulerLane[OverviewRulerLane.Left=1]="Left",OverviewRulerLane[OverviewRulerLane.Center=2]="Center",OverviewRulerLane[OverviewRulerLane.Right=4]="Right",OverviewRulerLane[OverviewRulerLane.Full=7]="Full"}(exports.OverviewRulerLane||(exports.OverviewRulerLane={})),function(MinimapPosition){MinimapPosition[MinimapPosition.Inline=1]="Inline",MinimapPosition[MinimapPosition.Gutter=2]="Gutter"}(exports.MinimapPosition||(exports.MinimapPosition={})),function(InjectedTextCursorStops){InjectedTextCursorStops[InjectedTextCursorStops.Both=0]="Both",InjectedTextCursorStops[InjectedTextCursorStops.Right=1]="Right",InjectedTextCursorStops[InjectedTextCursorStops.Left=2]="Left",InjectedTextCursorStops[InjectedTextCursorStops.None=3]="None"}(exports.InjectedTextCursorStops||(exports.InjectedTextCursorStops={}));exports.TextModelResolvedOptions=class TextModelResolvedOptions{constructor(src){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|src.tabSize),this.indentSize=0|src.tabSize,this.insertSpaces=Boolean(src.insertSpaces),this.defaultEOL=0|src.defaultEOL,this.trimAutoWhitespace=Boolean(src.trimAutoWhitespace),this.bracketPairColorizationOptions=src.bracketPairColorizationOptions}equals(other){return this.tabSize===other.tabSize&&this.indentSize===other.indentSize&&this.insertSpaces===other.insertSpaces&&this.defaultEOL===other.defaultEOL&&this.trimAutoWhitespace===other.trimAutoWhitespace&&(0,objects_1.equals)(this.bracketPairColorizationOptions,other.bracketPairColorizationOptions)}createChangeEvent(newOpts){return{tabSize:this.tabSize!==newOpts.tabSize,indentSize:this.indentSize!==newOpts.indentSize,insertSpaces:this.insertSpaces!==newOpts.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==newOpts.trimAutoWhitespace}}};exports.FindMatch=class FindMatch{constructor(range,matches){this._findMatchBrand=void 0,this.range=range,this.matches=matches}};exports.ValidAnnotatedEditOperation=class ValidAnnotatedEditOperation{constructor(identifier,range,text,forceMoveMarkers,isAutoWhitespaceEdit,_isTracked){this.identifier=identifier,this.range=range,this.text=text,this.forceMoveMarkers=forceMoveMarkers,this.isAutoWhitespaceEdit=isAutoWhitespaceEdit,this._isTracked=_isTracked}};exports.SearchData=class SearchData{constructor(regex,wordSeparators,simpleSearch){this.regex=regex,this.wordSeparators=wordSeparators,this.simpleSearch=simpleSearch}};exports.ApplyEditsResult=class ApplyEditsResult{constructor(reverseEdits,changes,trimAutoWhitespaceLineNumbers){this.reverseEdits=reverseEdits,this.changes=changes,this.trimAutoWhitespaceLineNumbers=trimAutoWhitespaceLineNumbers}},exports.shouldSynchronizeModel=function shouldSynchronizeModel(model){return!model.isTooLargeForSyncing()&&!model.isForSimpleWidget}})),define(__m[421],__M([1,0,4,2,50,410]),(function(require,exports,event_1,lifecycle_1,model_1,languageSelector_1){"use strict";function isExclusive(selector){return"string"!=typeof selector&&(Array.isArray(selector)?selector.every(isExclusive):!!selector.exclusive)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguageFeatureRegistry=void 0;class LanguageFeatureRegistry{constructor(_notebookTypeResolver){this._notebookTypeResolver=_notebookTypeResolver,this._clock=0,this._entries=[],this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event}register(selector,provider){let entry={selector,provider,_score:-1,_time:this._clock++};return this._entries.push(entry),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),(0,lifecycle_1.toDisposable)((()=>{if(entry){const idx=this._entries.indexOf(entry);idx>=0&&(this._entries.splice(idx,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),entry=void 0)}}))}has(model){return this.all(model).length>0}all(model){if(!model)return[];this._updateScores(model);const result=[];for(let entry of this._entries)entry._score>0&&result.push(entry.provider);return result}ordered(model){const result=[];return this._orderedForEach(model,(entry=>result.push(entry.provider))),result}orderedGroups(model){const result=[];let lastBucket,lastBucketScore;return this._orderedForEach(model,(entry=>{lastBucket&&lastBucketScore===entry._score?lastBucket.push(entry.provider):(lastBucketScore=entry._score,lastBucket=[entry.provider],result.push(lastBucket))})),result}_orderedForEach(model,callback){if(model){this._updateScores(model);for(const entry of this._entries)entry._score>0&&callback(entry)}}_updateScores(model){var _a;const notebookType=null===(_a=this._notebookTypeResolver)||void 0===_a?void 0:_a.call(this,model.uri),candidate={uri:model.uri.toString(),language:model.getLanguageId(),notebookType};if(!this._lastCandidate||this._lastCandidate.language!==candidate.language||this._lastCandidate.uri!==candidate.uri||this._lastCandidate.notebookType!==candidate.notebookType){this._lastCandidate=candidate;for(let entry of this._entries)if(entry._score=(0,languageSelector_1.score)(entry.selector,model.uri,model.getLanguageId(),(0,model_1.shouldSynchronizeModel)(model),notebookType),isExclusive(entry.selector)&&entry._score>0){for(let entry of this._entries)entry._score=0;entry._score=1e3;break}this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime)}}static _compareByScoreAndTime(a,b){return a._score<b._score?1:a._score>b._score?-1:a._time<b._time?1:a._time>b._time?-1:0}}exports.LanguageFeatureRegistry=LanguageFeatureRegistry})),define(__m[85],__M([1,0,8,3]),(function(require,exports,strings_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lengthOfString=exports.lengthsToRange=exports.positionToLength=exports.lengthGreaterThanEqual=exports.lengthLessThanEqual=exports.lengthLessThan=exports.lengthDiffNonNegative=exports.lengthAdd=exports.lengthGetColumnCountIfZeroLineCount=exports.lengthGetLineCount=exports.lengthToObj=exports.toLength=exports.lengthIsZero=exports.lengthZero=exports.lengthDiff=exports.LengthObj=void 0;class LengthObj{constructor(lineCount,columnCount){this.lineCount=lineCount,this.columnCount=columnCount}toString(){return`${this.lineCount},${this.columnCount}`}}exports.LengthObj=LengthObj,LengthObj.zero=new LengthObj(0,0),exports.lengthDiff=function lengthDiff(startLineCount,startColumnCount,endLineCount,endColumnCount){return startLineCount!==endLineCount?toLength(endLineCount-startLineCount,endColumnCount):toLength(0,endColumnCount-startColumnCount)},exports.lengthZero=0,exports.lengthIsZero=function lengthIsZero(length){return 0===length};const factor=Math.pow(2,26);function toLength(lineCount,columnCount){return lineCount*factor+columnCount}exports.toLength=toLength,exports.lengthToObj=function lengthToObj(length){const l=length,lineCount=Math.floor(l/factor);return new LengthObj(lineCount,l-lineCount*factor)},exports.lengthGetLineCount=function lengthGetLineCount(length){return Math.floor(length/factor)},exports.lengthGetColumnCountIfZeroLineCount=function lengthGetColumnCountIfZeroLineCount(length){return length},exports.lengthAdd=function lengthAdd(l1,l2){return l2<factor?l1+l2:l1-l1%factor+l2},exports.lengthDiffNonNegative=function lengthDiffNonNegative(length1,length2){const l1=length1,l2=length2;if(l2-l1<=0)return exports.lengthZero;const lineCount1=Math.floor(l1/factor),lineCount2=Math.floor(l2/factor),colCount2=l2-lineCount2*factor;if(lineCount1===lineCount2){return toLength(0,colCount2-(l1-lineCount1*factor))}return toLength(lineCount2-lineCount1,colCount2)},exports.lengthLessThan=function lengthLessThan(length1,length2){return length1<length2},exports.lengthLessThanEqual=function lengthLessThanEqual(length1,length2){return length1<=length2},exports.lengthGreaterThanEqual=function lengthGreaterThanEqual(length1,length2){return length1>=length2},exports.positionToLength=function positionToLength(position){return toLength(position.lineNumber-1,position.column-1)},exports.lengthsToRange=function lengthsToRange(lengthStart,lengthEnd){const l=lengthStart,lineCount=Math.floor(l/factor),colCount=l-lineCount*factor,l2=lengthEnd,lineCount2=Math.floor(l2/factor),colCount2=l2-lineCount2*factor;return new range_1.Range(lineCount+1,colCount+1,lineCount2+1,colCount2+1)},exports.lengthOfString=function lengthOfString(str){const lines=(0,strings_1.splitLines)(str);return toLength(lines.length-1,lines[lines.length-1].length)}})),define(__m[243],__M([1,0,85]),(function(require,exports,length_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BeforeEditPositionMapper=exports.TextEditInfo=void 0;exports.TextEditInfo=class TextEditInfo{constructor(startOffset,endOffset,newLength){this.startOffset=startOffset,this.endOffset=endOffset,this.newLength=newLength}};exports.BeforeEditPositionMapper=class BeforeEditPositionMapper{constructor(edits,documentLength){this.documentLength=documentLength,this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=edits.map((edit=>TextEditInfoCache.from(edit)))}getOffsetBeforeChange(offset){return this.adjustNextEdit(offset),this.translateCurToOld(offset)}getDistanceToNextChange(offset){this.adjustNextEdit(offset);const nextEdit=this.edits[this.nextEditIdx],nextChangeOffset=nextEdit?this.translateOldToCur(nextEdit.offsetObj):this.documentLength;return(0,length_1.lengthDiffNonNegative)(offset,nextChangeOffset)}translateOldToCur(oldOffsetObj){return oldOffsetObj.lineCount===this.deltaLineIdxInOld?(0,length_1.toLength)(oldOffsetObj.lineCount+this.deltaOldToNewLineCount,oldOffsetObj.columnCount+this.deltaOldToNewColumnCount):(0,length_1.toLength)(oldOffsetObj.lineCount+this.deltaOldToNewLineCount,oldOffsetObj.columnCount)}translateCurToOld(newOffset){const offsetObj=(0,length_1.lengthToObj)(newOffset);return offsetObj.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?(0,length_1.toLength)(offsetObj.lineCount-this.deltaOldToNewLineCount,offsetObj.columnCount-this.deltaOldToNewColumnCount):(0,length_1.toLength)(offsetObj.lineCount-this.deltaOldToNewLineCount,offsetObj.columnCount)}adjustNextEdit(offset){for(;this.nextEditIdx<this.edits.length;){const nextEdit=this.edits[this.nextEditIdx],nextEditEndOffsetInCur=this.translateOldToCur(nextEdit.endOffsetAfterObj);if(!(0,length_1.lengthLessThanEqual)(nextEditEndOffsetInCur,offset))break;{this.nextEditIdx++;const nextEditEndOffsetInCurObj=(0,length_1.lengthToObj)(nextEditEndOffsetInCur),nextEditEndOffsetBeforeInCurObj=(0,length_1.lengthToObj)(this.translateOldToCur(nextEdit.endOffsetBeforeObj)),lineDelta=nextEditEndOffsetInCurObj.lineCount-nextEditEndOffsetBeforeInCurObj.lineCount;this.deltaOldToNewLineCount+=lineDelta;const previousColumnDelta=this.deltaLineIdxInOld===nextEdit.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,columnDelta=nextEditEndOffsetInCurObj.columnCount-nextEditEndOffsetBeforeInCurObj.columnCount;this.deltaOldToNewColumnCount=previousColumnDelta+columnDelta,this.deltaLineIdxInOld=nextEdit.endOffsetBeforeObj.lineCount}}}};class TextEditInfoCache{constructor(startOffset,endOffset,textLength){this.endOffsetBeforeObj=(0,length_1.lengthToObj)(endOffset),this.endOffsetAfterObj=(0,length_1.lengthToObj)((0,length_1.lengthAdd)(startOffset,textLength)),this.offsetObj=(0,length_1.lengthToObj)(startOffset)}static from(edit){return new TextEditInfoCache(edit.startOffset,edit.endOffset,edit.newLength)}}})),define(__m[422],__M([1,0,85]),(function(require,exports,length_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NodeReader=void 0;function getNextChildIdx(node,curIdx=-1){for(;;){if(++curIdx>=node.childrenLength)return-1;if(node.getChild(curIdx))return curIdx}}function lastOrUndefined(arr){return arr.length>0?arr[arr.length-1]:void 0}exports.NodeReader=class NodeReader{constructor(node){this.lastOffset=length_1.lengthZero,this.nextNodes=[node],this.offsets=[length_1.lengthZero],this.idxs=[]}readLongestNodeAt(offset,predicate){if((0,length_1.lengthLessThan)(offset,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=offset;;){const curNode=lastOrUndefined(this.nextNodes);if(!curNode)return;const curNodeOffset=lastOrUndefined(this.offsets);if((0,length_1.lengthLessThan)(offset,curNodeOffset))return;if((0,length_1.lengthLessThan)(curNodeOffset,offset))if((0,length_1.lengthAdd)(curNodeOffset,curNode.length)<=offset)this.nextNodeAfterCurrent();else{const nextChildIdx=getNextChildIdx(curNode);-1!==nextChildIdx?(this.nextNodes.push(curNode.getChild(nextChildIdx)),this.offsets.push(curNodeOffset),this.idxs.push(nextChildIdx)):this.nextNodeAfterCurrent()}else{if(predicate(curNode))return this.nextNodeAfterCurrent(),curNode;{const nextChildIdx=getNextChildIdx(curNode);if(-1===nextChildIdx)return void this.nextNodeAfterCurrent();this.nextNodes.push(curNode.getChild(nextChildIdx)),this.offsets.push(curNodeOffset),this.idxs.push(nextChildIdx)}}}}nextNodeAfterCurrent(){for(;;){const currentOffset=lastOrUndefined(this.offsets),currentNode=lastOrUndefined(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),0===this.idxs.length)break;const parent=lastOrUndefined(this.nextNodes),nextChildIdx=getNextChildIdx(parent,this.idxs[this.idxs.length-1]);if(-1!==nextChildIdx){this.nextNodes.push(parent.getChild(nextChildIdx)),this.offsets.push((0,length_1.lengthAdd)(currentOffset,currentNode.length)),this.idxs[this.idxs.length-1]=nextChildIdx;break}this.idxs.pop()}}}})),define(__m[101],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DenseKeyProvider=exports.identityKeyProvider=exports.SmallImmutableSet=void 0;const emptyArr=new Array;class SmallImmutableSet{constructor(items,additionalItems){this.items=items,this.additionalItems=additionalItems}static create(items,additionalItems){if(items<=128&&0===additionalItems.length){let cached=SmallImmutableSet.cache[items];return cached||(cached=new SmallImmutableSet(items,additionalItems),SmallImmutableSet.cache[items]=cached),cached}return new SmallImmutableSet(items,additionalItems)}static getEmpty(){return this.empty}add(value,keyProvider){const key=keyProvider.getKey(value);let idx=key>>5;if(0===idx){const newItem=1<<key|this.items;return newItem===this.items?this:SmallImmutableSet.create(newItem,this.additionalItems)}idx--;const newItems=this.additionalItems.slice(0);for(;newItems.length<idx;)newItems.push(0);return newItems[idx]|=1<<(31&key),SmallImmutableSet.create(this.items,newItems)}merge(other){const merged=this.items|other.items;if(this.additionalItems===emptyArr&&other.additionalItems===emptyArr)return merged===this.items?this:merged===other.items?other:SmallImmutableSet.create(merged,emptyArr);const newItems=new Array;for(let i=0;i<Math.max(this.additionalItems.length,other.additionalItems.length);i++){const item1=this.additionalItems[i]||0,item2=other.additionalItems[i]||0;newItems.push(item1|item2)}return SmallImmutableSet.create(merged,newItems)}intersects(other){if(0!=(this.items&other.items))return!0;for(let i=0;i<Math.min(this.additionalItems.length,other.additionalItems.length);i++)if(0!=(this.additionalItems[i]&other.additionalItems[i]))return!0;return!1}}exports.SmallImmutableSet=SmallImmutableSet,SmallImmutableSet.cache=new Array(129),SmallImmutableSet.empty=SmallImmutableSet.create(0,emptyArr),exports.identityKeyProvider={getKey:value=>value};exports.DenseKeyProvider=class DenseKeyProvider{constructor(){this.items=new Map}getKey(value){let existing=this.items.get(value);return void 0===existing&&(existing=this.items.size,this.items.set(value,existing)),existing}}})),define(__m[152],__M([1,0,70,85,101]),(function(require,exports,cursorColumns_1,length_1,smallImmutableSet_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InvalidBracketAstNode=exports.BracketAstNode=exports.TextAstNode=exports.ListAstNode=exports.PairAstNode=void 0;class BaseAstNode{constructor(length){this._length=length}get length(){return this._length}}class PairAstNode extends BaseAstNode{constructor(length,openingBracket,child,closingBracket,missingOpeningBracketIds){super(length),this.openingBracket=openingBracket,this.child=child,this.closingBracket=closingBracket,this.missingOpeningBracketIds=missingOpeningBracketIds}static create(openingBracket,child,closingBracket){let length=openingBracket.length;return child&&(length=(0,length_1.lengthAdd)(length,child.length)),closingBracket&&(length=(0,length_1.lengthAdd)(length,closingBracket.length)),new PairAstNode(length,openingBracket,child,closingBracket,child?child.missingOpeningBracketIds:smallImmutableSet_1.SmallImmutableSet.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(idx){switch(idx){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const result=new Array;return result.push(this.openingBracket),this.child&&result.push(this.child),this.closingBracket&&result.push(this.closingBracket),result}canBeReused(openBracketIds){return null!==this.closingBracket&&!openBracketIds.intersects(this.missingOpeningBracketIds)}deepClone(){return new PairAstNode(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(offset,textModel){return this.child?this.child.computeMinIndentation((0,length_1.lengthAdd)(offset,this.openingBracket.length),textModel):Number.MAX_SAFE_INTEGER}}exports.PairAstNode=PairAstNode;class ListAstNode extends BaseAstNode{constructor(length,listHeight,_missingOpeningBracketIds){super(length),this.listHeight=listHeight,this._missingOpeningBracketIds=_missingOpeningBracketIds,this.cachedMinIndentation=-1}static create23(item1,item2,item3,immutable=!1){let length=item1.length,missingBracketIds=item1.missingOpeningBracketIds;if(item1.listHeight!==item2.listHeight)throw new Error("Invalid list heights");if(length=(0,length_1.lengthAdd)(length,item2.length),missingBracketIds=missingBracketIds.merge(item2.missingOpeningBracketIds),item3){if(item1.listHeight!==item3.listHeight)throw new Error("Invalid list heights");length=(0,length_1.lengthAdd)(length,item3.length),missingBracketIds=missingBracketIds.merge(item3.missingOpeningBracketIds)}return immutable?new Immutable23ListAstNode(length,item1.listHeight+1,item1,item2,item3,missingBracketIds):new TwoThreeListAstNode(length,item1.listHeight+1,item1,item2,item3,missingBracketIds)}static getEmpty(){return new ImmutableArrayListAstNode(length_1.lengthZero,0,[],smallImmutableSet_1.SmallImmutableSet.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const childCount=this.childrenLength;if(0===childCount)return;const lastChild=this.getChild(childCount-1),mutable=4===lastChild.kind?lastChild.toMutable():lastChild;return lastChild!==mutable&&this.setChild(childCount-1,mutable),mutable}makeFirstElementMutable(){this.throwIfImmutable();if(0===this.childrenLength)return;const firstChild=this.getChild(0),mutable=4===firstChild.kind?firstChild.toMutable():firstChild;return firstChild!==mutable&&this.setChild(0,mutable),mutable}canBeReused(openBracketIds){if(openBracketIds.intersects(this.missingOpeningBracketIds))return!1;let lastLength,lastChild=this;for(;4===lastChild.kind&&(lastLength=lastChild.childrenLength)>0;)lastChild=lastChild.getChild(lastLength-1);return lastChild.canBeReused(openBracketIds)}handleChildrenChanged(){this.throwIfImmutable();const count=this.childrenLength;let length=this.getChild(0).length,unopenedBrackets=this.getChild(0).missingOpeningBracketIds;for(let i=1;i<count;i++){const child=this.getChild(i);length=(0,length_1.lengthAdd)(length,child.length),unopenedBrackets=unopenedBrackets.merge(child.missingOpeningBracketIds)}this._length=length,this._missingOpeningBracketIds=unopenedBrackets,this.cachedMinIndentation=-1}computeMinIndentation(offset,textModel){if(-1!==this.cachedMinIndentation)return this.cachedMinIndentation;let minIndentation=Number.MAX_SAFE_INTEGER,childOffset=offset;for(let i=0;i<this.childrenLength;i++){const child=this.getChild(i);child&&(minIndentation=Math.min(minIndentation,child.computeMinIndentation(childOffset,textModel)),childOffset=(0,length_1.lengthAdd)(childOffset,child.length))}return this.cachedMinIndentation=minIndentation,minIndentation}}exports.ListAstNode=ListAstNode;class TwoThreeListAstNode extends ListAstNode{constructor(length,listHeight,_item1,_item2,_item3,missingOpeningBracketIds){super(length,listHeight,missingOpeningBracketIds),this._item1=_item1,this._item2=_item2,this._item3=_item3}get childrenLength(){return null!==this._item3?3:2}getChild(idx){switch(idx){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(idx,node){switch(idx){case 0:return void(this._item1=node);case 1:return void(this._item2=node);case 2:return void(this._item3=node)}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new TwoThreeListAstNode(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(node){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=node,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const result=this._item3;return this._item3=null,this.handleChildrenChanged(),result}prependChildOfSameHeight(node){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=node,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const result=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),result}toMutable(){return this}}class Immutable23ListAstNode extends TwoThreeListAstNode{toMutable(){return new TwoThreeListAstNode(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class ArrayListAstNode extends ListAstNode{constructor(length,listHeight,_children,missingOpeningBracketIds){super(length,listHeight,missingOpeningBracketIds),this._children=_children}get childrenLength(){return this._children.length}getChild(idx){return this._children[idx]}setChild(idx,child){this._children[idx]=child}get children(){return this._children}deepClone(){const children=new Array(this._children.length);for(let i=0;i<this._children.length;i++)children[i]=this._children[i].deepClone();return new ArrayListAstNode(this.length,this.listHeight,children,this.missingOpeningBracketIds)}appendChildOfSameHeight(node){this.throwIfImmutable(),this._children.push(node),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const item=this._children.pop();return this.handleChildrenChanged(),item}prependChildOfSameHeight(node){this.throwIfImmutable(),this._children.unshift(node),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const item=this._children.shift();return this.handleChildrenChanged(),item}toMutable(){return this}}class ImmutableArrayListAstNode extends ArrayListAstNode{toMutable(){return new ArrayListAstNode(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const emptyArray=[];class ImmutableLeafAstNode extends BaseAstNode{get listHeight(){return 0}get childrenLength(){return 0}getChild(idx){return null}get children(){return emptyArray}deepClone(){return this}}exports.TextAstNode=class TextAstNode extends ImmutableLeafAstNode{get kind(){return 0}get missingOpeningBracketIds(){return smallImmutableSet_1.SmallImmutableSet.getEmpty()}canBeReused(_openedBracketIds){return!0}computeMinIndentation(offset,textModel){const start=(0,length_1.lengthToObj)(offset),startLineNumber=(0===start.columnCount?start.lineCount:start.lineCount+1)+1,endLineNumber=(0,length_1.lengthGetLineCount)((0,length_1.lengthAdd)(offset,this.length))+1;let result=Number.MAX_SAFE_INTEGER;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const firstNonWsColumn=textModel.getLineFirstNonWhitespaceColumn(lineNumber),lineContent=textModel.getLineContent(lineNumber);if(0===firstNonWsColumn)continue;const visibleColumn=cursorColumns_1.CursorColumns.visibleColumnFromColumn(lineContent,firstNonWsColumn,textModel.getOptions().tabSize);result=Math.min(result,visibleColumn)}return result}};class BracketAstNode extends ImmutableLeafAstNode{constructor(length,languageId,bracketIds){super(length),this.languageId=languageId,this.bracketIds=bracketIds}static create(length,languageId,bracketIds){return new BracketAstNode(length,languageId,bracketIds)}get kind(){return 1}get missingOpeningBracketIds(){return smallImmutableSet_1.SmallImmutableSet.getEmpty()}canBeReused(_openedBracketIds){return!1}computeMinIndentation(offset,textModel){return Number.MAX_SAFE_INTEGER}}exports.BracketAstNode=BracketAstNode;exports.InvalidBracketAstNode=class InvalidBracketAstNode extends ImmutableLeafAstNode{constructor(closingBrackets,length){super(length),this.missingOpeningBracketIds=closingBrackets}get kind(){return 3}canBeReused(openedBracketIds){return!openedBracketIds.intersects(this.missingOpeningBracketIds)}computeMinIndentation(offset,textModel){return Number.MAX_SAFE_INTEGER}}})),define(__m[423],__M([1,0,152]),(function(require,exports,ast_1){"use strict";function concat23TreesOfSameHeight(items,createImmutableLists=!1){if(0===items.length)return null;if(1===items.length)return items[0];let length=items.length;for(;length>3;){const newLength=length>>1;for(let i=0;i<newLength;i++){const j=i<<1;items[i]=ast_1.ListAstNode.create23(items[j],items[j+1],j+3===length?items[j+2]:null,createImmutableLists)}length=newLength}return ast_1.ListAstNode.create23(items[0],items[1],length>=3?items[2]:null,createImmutableLists)}function heightDiff(node1,node2){return Math.abs(node1.listHeight-node2.listHeight)}function concat(node1,node2){return node1.listHeight===node2.listHeight?ast_1.ListAstNode.create23(node1,node2,null,!1):node1.listHeight>node2.listHeight?function append(list,nodeToAppend){let curNode=list=list.toMutable();const parents=new Array;let nodeToAppendOfCorrectHeight;for(;;){if(nodeToAppend.listHeight===curNode.listHeight){nodeToAppendOfCorrectHeight=nodeToAppend;break}if(4!==curNode.kind)throw new Error("unexpected");parents.push(curNode),curNode=curNode.makeLastElementMutable()}for(let i=parents.length-1;i>=0;i--){const parent=parents[i];nodeToAppendOfCorrectHeight?parent.childrenLength>=3?nodeToAppendOfCorrectHeight=ast_1.ListAstNode.create23(parent.unappendChild(),nodeToAppendOfCorrectHeight,null,!1):(parent.appendChildOfSameHeight(nodeToAppendOfCorrectHeight),nodeToAppendOfCorrectHeight=void 0):parent.handleChildrenChanged()}return nodeToAppendOfCorrectHeight?ast_1.ListAstNode.create23(list,nodeToAppendOfCorrectHeight,null,!1):list}(node1,node2):function prepend(list,nodeToAppend){let curNode=list=list.toMutable();const parents=new Array;for(;nodeToAppend.listHeight!==curNode.listHeight;){if(4!==curNode.kind)throw new Error("unexpected");parents.push(curNode),curNode=curNode.makeFirstElementMutable()}let nodeToPrependOfCorrectHeight=nodeToAppend;for(let i=parents.length-1;i>=0;i--){const parent=parents[i];nodeToPrependOfCorrectHeight?parent.childrenLength>=3?nodeToPrependOfCorrectHeight=ast_1.ListAstNode.create23(nodeToPrependOfCorrectHeight,parent.unprependChild(),null,!1):(parent.prependChildOfSameHeight(nodeToPrependOfCorrectHeight),nodeToPrependOfCorrectHeight=void 0):parent.handleChildrenChanged()}return nodeToPrependOfCorrectHeight?ast_1.ListAstNode.create23(nodeToPrependOfCorrectHeight,list,null,!1):list}(node2,node1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.concat23TreesOfSameHeight=exports.concat23Trees=void 0,exports.concat23Trees=function concat23Trees(items){if(0===items.length)return null;if(1===items.length)return items[0];let i=0;function readNode(){if(i>=items.length)return null;const start=i,height=items[start].listHeight;for(i++;i<items.length&&items[i].listHeight===height;)i++;return i-start>=2?concat23TreesOfSameHeight(0===start&&i===items.length?items:items.slice(start,i),!1):items[start]}let first=readNode(),second=readNode();if(!second)return first;for(let item=readNode();item;item=readNode())heightDiff(first,second)<=heightDiff(second,item)?(first=concat(first,second),second=item):second=concat(second,item);return concat(first,second)},exports.concat23TreesOfSameHeight=concat23TreesOfSameHeight})),define(__m[244],__M([1,0,152,243,101,85,423,422]),(function(require,exports,ast_1,beforeEditPositionMapper_1,smallImmutableSet_1,length_1,concat23Trees_1,nodeReader_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseDocument=void 0,exports.parseDocument=function parseDocument(tokenizer,edits,oldNode,createImmutableLists){return new Parser(tokenizer,edits,oldNode,createImmutableLists).parseDocument()};class Parser{constructor(tokenizer,edits,oldNode,createImmutableLists){if(this.tokenizer=tokenizer,this.createImmutableLists=createImmutableLists,this._itemsConstructed=0,this._itemsFromCache=0,oldNode&&createImmutableLists)throw new Error("Not supported");this.oldNodeReader=oldNode?new nodeReader_1.NodeReader(oldNode):void 0,this.positionMapper=new beforeEditPositionMapper_1.BeforeEditPositionMapper(edits,tokenizer.length)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let result=this.parseList(smallImmutableSet_1.SmallImmutableSet.getEmpty());return result||(result=ast_1.ListAstNode.getEmpty()),result}parseList(openedBracketIds){const items=new Array;for(;;){const token=this.tokenizer.peek();if(!token||2===token.kind&&token.bracketIds.intersects(openedBracketIds))break;const child=this.parseChild(openedBracketIds);4===child.kind&&0===child.childrenLength||items.push(child)}return this.oldNodeReader?(0,concat23Trees_1.concat23Trees)(items):(0,concat23Trees_1.concat23TreesOfSameHeight)(items,this.createImmutableLists)}parseChild(openedBracketIds){if(this.oldNodeReader){const maxCacheableLength=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(!(0,length_1.lengthIsZero)(maxCacheableLength)){const cachedNode=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),(curNode=>{if(!(0,length_1.lengthLessThan)(curNode.length,maxCacheableLength))return!1;return curNode.canBeReused(openedBracketIds)}));if(cachedNode)return this._itemsFromCache++,this.tokenizer.skip(cachedNode.length),cachedNode}}this._itemsConstructed++;const token=this.tokenizer.read();switch(token.kind){case 2:return new ast_1.InvalidBracketAstNode(token.bracketIds,token.length);case 0:return token.astNode;case 1:{const set=openedBracketIds.merge(token.bracketIds),child=this.parseList(set),nextToken=this.tokenizer.peek();return nextToken&&2===nextToken.kind&&(nextToken.bracketId===token.bracketId||nextToken.bracketIds.intersects(token.bracketIds))?(this.tokenizer.read(),ast_1.PairAstNode.create(token.astNode,child,nextToken.astNode)):ast_1.PairAstNode.create(token.astNode,child,null)}default:throw new Error("unexpected")}}}})),define(__m[424],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.guessIndentation=void 0;class SpacesDiffResult{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function spacesDiff(a,aLength,b,bLength,result){let i;for(result.spacesDiff=0,result.looksLikeAlignment=!1,i=0;i<aLength&&i<bLength;i++){if(a.charCodeAt(i)!==b.charCodeAt(i))break}let aSpacesCnt=0,aTabsCount=0;for(let j=i;j<aLength;j++){32===a.charCodeAt(j)?aSpacesCnt++:aTabsCount++}let bSpacesCnt=0,bTabsCount=0;for(let j=i;j<bLength;j++){32===b.charCodeAt(j)?bSpacesCnt++:bTabsCount++}if(aSpacesCnt>0&&aTabsCount>0)return;if(bSpacesCnt>0&&bTabsCount>0)return;const tabsDiff=Math.abs(aTabsCount-bTabsCount),spacesDiff=Math.abs(aSpacesCnt-bSpacesCnt);if(0===tabsDiff)return result.spacesDiff=spacesDiff,void(spacesDiff>0&&0<=bSpacesCnt-1&&bSpacesCnt-1<a.length&&bSpacesCnt<b.length&&32!==b.charCodeAt(bSpacesCnt)&&32===a.charCodeAt(bSpacesCnt-1)&&44===a.charCodeAt(a.length-1)&&(result.looksLikeAlignment=!0));spacesDiff%tabsDiff!=0||(result.spacesDiff=spacesDiff/tabsDiff)}exports.guessIndentation=function guessIndentation(source,defaultTabSize,defaultInsertSpaces){const linesCount=Math.min(source.getLineCount(),1e4);let linesIndentedWithTabsCount=0,linesIndentedWithSpacesCount=0,previousLineText="",previousLineIndentation=0;const ALLOWED_TAB_SIZE_GUESSES=[2,4,6,8,3,5,7],spacesDiffCount=[0,0,0,0,0,0,0,0,0],tmp=new SpacesDiffResult;for(let lineNumber=1;lineNumber<=linesCount;lineNumber++){const currentLineLength=source.getLineLength(lineNumber),currentLineText=source.getLineContent(lineNumber),useCurrentLineText=currentLineLength<=65536;let currentLineHasContent=!1,currentLineIndentation=0,currentLineSpacesCount=0,currentLineTabsCount=0;for(let j=0,lenJ=currentLineLength;j<lenJ;j++){const charCode=useCurrentLineText?currentLineText.charCodeAt(j):source.getLineCharCode(lineNumber,j);if(9===charCode)currentLineTabsCount++;else{if(32!==charCode){currentLineHasContent=!0,currentLineIndentation=j;break}currentLineSpacesCount++}}if(!currentLineHasContent)continue;if(currentLineTabsCount>0?linesIndentedWithTabsCount++:currentLineSpacesCount>1&&linesIndentedWithSpacesCount++,spacesDiff(previousLineText,previousLineIndentation,currentLineText,currentLineIndentation,tmp),tmp.looksLikeAlignment&&(!defaultInsertSpaces||defaultTabSize!==tmp.spacesDiff))continue;const currentSpacesDiff=tmp.spacesDiff;currentSpacesDiff<=8&&spacesDiffCount[currentSpacesDiff]++,previousLineText=currentLineText,previousLineIndentation=currentLineIndentation}let insertSpaces=defaultInsertSpaces;linesIndentedWithTabsCount!==linesIndentedWithSpacesCount&&(insertSpaces=linesIndentedWithTabsCount<linesIndentedWithSpacesCount);let tabSize=defaultTabSize;if(insertSpaces){let tabSizeScore=insertSpaces?0:.1*linesCount;ALLOWED_TAB_SIZE_GUESSES.forEach((possibleTabSize=>{const possibleTabSizeScore=spacesDiffCount[possibleTabSize];possibleTabSizeScore>tabSizeScore&&(tabSizeScore=possibleTabSizeScore,tabSize=possibleTabSize)})),4===tabSize&&spacesDiffCount[4]>0&&spacesDiffCount[2]>0&&spacesDiffCount[2]>=spacesDiffCount[4]/2&&(tabSize=2)}return{insertSpaces,tabSize}}})),define(__m[425],__M([1,0]),(function(require,exports){"use strict";function getNodeColor(node){return(1&node.metadata)>>>0}function setNodeColor(node,color){node.metadata=254&node.metadata|color<<0}function getNodeIsVisited(node){return(2&node.metadata)>>>1==1}function setNodeIsVisited(node,value){node.metadata=253&node.metadata|(value?1:0)<<1}function getNodeIsForValidation(node){return(4&node.metadata)>>>2==1}function setNodeIsForValidation(node,value){node.metadata=251&node.metadata|(value?1:0)<<2}function _setNodeStickiness(node,stickiness){node.metadata=231&node.metadata|stickiness<<3}function setCollapseOnReplaceEdit(node,value){node.metadata=223&node.metadata|(value?1:0)<<5}Object.defineProperty(exports,"__esModule",{value:!0}),exports.intervalCompare=exports.recomputeMaxEnd=exports.nodeAcceptEdit=exports.IntervalTree=exports.SENTINEL=exports.IntervalNode=exports.getNodeColor=void 0,exports.getNodeColor=getNodeColor;class IntervalNode{constructor(id,start,end){this.metadata=0,this.parent=this,this.left=this,this.right=this,setNodeColor(this,1),this.start=start,this.end=end,this.delta=0,this.maxEnd=end,this.id=id,this.ownerId=0,this.options=null,setNodeIsForValidation(this,!1),_setNodeStickiness(this,1),setCollapseOnReplaceEdit(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=start,this.cachedAbsoluteEnd=end,this.range=null,setNodeIsVisited(this,!1)}reset(versionId,start,end,range){this.start=start,this.end=end,this.maxEnd=end,this.cachedVersionId=versionId,this.cachedAbsoluteStart=start,this.cachedAbsoluteEnd=end,this.range=range}setOptions(options){this.options=options;const className=this.options.className;setNodeIsForValidation(this,"squiggly-error"===className||"squiggly-warning"===className||"squiggly-info"===className),_setNodeStickiness(this,this.options.stickiness),setCollapseOnReplaceEdit(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(absoluteStart,absoluteEnd,cachedVersionId){this.cachedVersionId!==cachedVersionId&&(this.range=null),this.cachedVersionId=cachedVersionId,this.cachedAbsoluteStart=absoluteStart,this.cachedAbsoluteEnd=absoluteEnd}detach(){this.parent=null,this.left=null,this.right=null}}exports.IntervalNode=IntervalNode,exports.SENTINEL=new IntervalNode(null,0,0),exports.SENTINEL.parent=exports.SENTINEL,exports.SENTINEL.left=exports.SENTINEL,exports.SENTINEL.right=exports.SENTINEL,setNodeColor(exports.SENTINEL,0);function adjustMarkerBeforeColumn(markerOffset,markerStickToPreviousCharacter,checkOffset,moveSemantics){return markerOffset<checkOffset||!(markerOffset>checkOffset)&&(1!==moveSemantics&&(2===moveSemantics||markerStickToPreviousCharacter))}function nodeAcceptEdit(node,start,end,textLength,forceMoveMarkers){const nodeStickiness=function getNodeStickiness(node){return(24&node.metadata)>>>3}(node),startStickToPreviousCharacter=0===nodeStickiness||2===nodeStickiness,endStickToPreviousCharacter=1===nodeStickiness||2===nodeStickiness,deletingCnt=end-start,insertingCnt=textLength,commonLength=Math.min(deletingCnt,insertingCnt),nodeStart=node.start;let startDone=!1;const nodeEnd=node.end;let endDone=!1;start<=nodeStart&&nodeEnd<=end&&function getCollapseOnReplaceEdit(node){return(32&node.metadata)>>>5==1}(node)&&(node.start=start,startDone=!0,node.end=start,endDone=!0);{const moveSemantics=forceMoveMarkers?1:deletingCnt>0?2:0;!startDone&&adjustMarkerBeforeColumn(nodeStart,startStickToPreviousCharacter,start,moveSemantics)&&(startDone=!0),!endDone&&adjustMarkerBeforeColumn(nodeEnd,endStickToPreviousCharacter,start,moveSemantics)&&(endDone=!0)}if(commonLength>0&&!forceMoveMarkers){const moveSemantics=deletingCnt>insertingCnt?2:0;!startDone&&adjustMarkerBeforeColumn(nodeStart,startStickToPreviousCharacter,start+commonLength,moveSemantics)&&(startDone=!0),!endDone&&adjustMarkerBeforeColumn(nodeEnd,endStickToPreviousCharacter,start+commonLength,moveSemantics)&&(endDone=!0)}{const moveSemantics=forceMoveMarkers?1:0;!startDone&&adjustMarkerBeforeColumn(nodeStart,startStickToPreviousCharacter,end,moveSemantics)&&(node.start=start+insertingCnt,startDone=!0),!endDone&&adjustMarkerBeforeColumn(nodeEnd,endStickToPreviousCharacter,end,moveSemantics)&&(node.end=start+insertingCnt,endDone=!0)}const deltaColumn=insertingCnt-deletingCnt;startDone||(node.start=Math.max(0,nodeStart+deltaColumn)),endDone||(node.end=Math.max(0,nodeEnd+deltaColumn)),node.start>node.end&&(node.end=node.start)}function rbTreeInsert(T,newNode){if(T.root===exports.SENTINEL)return newNode.parent=exports.SENTINEL,newNode.left=exports.SENTINEL,newNode.right=exports.SENTINEL,setNodeColor(newNode,0),T.root=newNode,T.root;!function treeInsert(T,z){let delta=0,x=T.root;const zAbsoluteStart=z.start,zAbsoluteEnd=z.end;for(;;){if(intervalCompare(zAbsoluteStart,zAbsoluteEnd,x.start+delta,x.end+delta)<0){if(x.left===exports.SENTINEL){z.start-=delta,z.end-=delta,z.maxEnd-=delta,x.left=z;break}x=x.left}else{if(x.right===exports.SENTINEL){z.start-=delta+x.delta,z.end-=delta+x.delta,z.maxEnd-=delta+x.delta,x.right=z;break}delta+=x.delta,x=x.right}}z.parent=x,z.left=exports.SENTINEL,z.right=exports.SENTINEL,setNodeColor(z,1)}(T,newNode),recomputeMaxEndWalkToRoot(newNode.parent);let x=newNode;for(;x!==T.root&&1===getNodeColor(x.parent);)if(x.parent===x.parent.parent.left){const y=x.parent.parent.right;1===getNodeColor(y)?(setNodeColor(x.parent,0),setNodeColor(y,0),setNodeColor(x.parent.parent,1),x=x.parent.parent):(x===x.parent.right&&(x=x.parent,leftRotate(T,x)),setNodeColor(x.parent,0),setNodeColor(x.parent.parent,1),rightRotate(T,x.parent.parent))}else{const y=x.parent.parent.left;1===getNodeColor(y)?(setNodeColor(x.parent,0),setNodeColor(y,0),setNodeColor(x.parent.parent,1),x=x.parent.parent):(x===x.parent.left&&(x=x.parent,rightRotate(T,x)),setNodeColor(x.parent,0),setNodeColor(x.parent.parent,1),leftRotate(T,x.parent.parent))}return setNodeColor(T.root,0),newNode}function rbTreeDelete(T,z){let x,y;if(z.left===exports.SENTINEL?(x=z.right,y=z,x.delta+=z.delta,(x.delta<-1073741824||x.delta>1073741824)&&(T.requestNormalizeDelta=!0),x.start+=z.delta,x.end+=z.delta):z.right===exports.SENTINEL?(x=z.left,y=z):(y=function leftest(node){for(;node.left!==exports.SENTINEL;)node=node.left;return node}(z.right),x=y.right,x.start+=y.delta,x.end+=y.delta,x.delta+=y.delta,(x.delta<-1073741824||x.delta>1073741824)&&(T.requestNormalizeDelta=!0),y.start+=z.delta,y.end+=z.delta,y.delta=z.delta,(y.delta<-1073741824||y.delta>1073741824)&&(T.requestNormalizeDelta=!0)),y===T.root)return T.root=x,setNodeColor(x,0),z.detach(),resetSentinel(),recomputeMaxEnd(x),void(T.root.parent=exports.SENTINEL);const yWasRed=1===getNodeColor(y);if(y===y.parent.left?y.parent.left=x:y.parent.right=x,y===z?x.parent=y.parent:(y.parent===z?x.parent=y:x.parent=y.parent,y.left=z.left,y.right=z.right,y.parent=z.parent,setNodeColor(y,getNodeColor(z)),z===T.root?T.root=y:z===z.parent.left?z.parent.left=y:z.parent.right=y,y.left!==exports.SENTINEL&&(y.left.parent=y),y.right!==exports.SENTINEL&&(y.right.parent=y)),z.detach(),yWasRed)return recomputeMaxEndWalkToRoot(x.parent),y!==z&&(recomputeMaxEndWalkToRoot(y),recomputeMaxEndWalkToRoot(y.parent)),void resetSentinel();let w;for(recomputeMaxEndWalkToRoot(x),recomputeMaxEndWalkToRoot(x.parent),y!==z&&(recomputeMaxEndWalkToRoot(y),recomputeMaxEndWalkToRoot(y.parent));x!==T.root&&0===getNodeColor(x);)x===x.parent.left?(w=x.parent.right,1===getNodeColor(w)&&(setNodeColor(w,0),setNodeColor(x.parent,1),leftRotate(T,x.parent),w=x.parent.right),0===getNodeColor(w.left)&&0===getNodeColor(w.right)?(setNodeColor(w,1),x=x.parent):(0===getNodeColor(w.right)&&(setNodeColor(w.left,0),setNodeColor(w,1),rightRotate(T,w),w=x.parent.right),setNodeColor(w,getNodeColor(x.parent)),setNodeColor(x.parent,0),setNodeColor(w.right,0),leftRotate(T,x.parent),x=T.root)):(w=x.parent.left,1===getNodeColor(w)&&(setNodeColor(w,0),setNodeColor(x.parent,1),rightRotate(T,x.parent),w=x.parent.left),0===getNodeColor(w.left)&&0===getNodeColor(w.right)?(setNodeColor(w,1),x=x.parent):(0===getNodeColor(w.left)&&(setNodeColor(w.right,0),setNodeColor(w,1),leftRotate(T,w),w=x.parent.left),setNodeColor(w,getNodeColor(x.parent)),setNodeColor(x.parent,0),setNodeColor(w.left,0),rightRotate(T,x.parent),x=T.root));setNodeColor(x,0),resetSentinel()}function resetSentinel(){exports.SENTINEL.parent=exports.SENTINEL,exports.SENTINEL.delta=0,exports.SENTINEL.start=0,exports.SENTINEL.end=0}function leftRotate(T,x){const y=x.right;y.delta+=x.delta,(y.delta<-1073741824||y.delta>1073741824)&&(T.requestNormalizeDelta=!0),y.start+=x.delta,y.end+=x.delta,x.right=y.left,y.left!==exports.SENTINEL&&(y.left.parent=x),y.parent=x.parent,x.parent===exports.SENTINEL?T.root=y:x===x.parent.left?x.parent.left=y:x.parent.right=y,y.left=x,x.parent=y,recomputeMaxEnd(x),recomputeMaxEnd(y)}function rightRotate(T,y){const x=y.left;y.delta-=x.delta,(y.delta<-1073741824||y.delta>1073741824)&&(T.requestNormalizeDelta=!0),y.start-=x.delta,y.end-=x.delta,y.left=x.right,x.right!==exports.SENTINEL&&(x.right.parent=y),x.parent=y.parent,y.parent===exports.SENTINEL?T.root=x:y===y.parent.right?y.parent.right=x:y.parent.left=x,x.right=y,y.parent=x,recomputeMaxEnd(y),recomputeMaxEnd(x)}function computeMaxEnd(node){let maxEnd=node.end;if(node.left!==exports.SENTINEL){const leftMaxEnd=node.left.maxEnd;leftMaxEnd>maxEnd&&(maxEnd=leftMaxEnd)}if(node.right!==exports.SENTINEL){const rightMaxEnd=node.right.maxEnd+node.delta;rightMaxEnd>maxEnd&&(maxEnd=rightMaxEnd)}return maxEnd}function recomputeMaxEnd(node){node.maxEnd=computeMaxEnd(node)}function recomputeMaxEndWalkToRoot(node){for(;node!==exports.SENTINEL;){const maxEnd=computeMaxEnd(node);if(node.maxEnd===maxEnd)return;node.maxEnd=maxEnd,node=node.parent}}function intervalCompare(aStart,aEnd,bStart,bEnd){return aStart===bStart?aEnd-bEnd:aStart-bStart}exports.IntervalTree=class IntervalTree{constructor(){this.root=exports.SENTINEL,this.requestNormalizeDelta=!1}intervalSearch(start,end,filterOwnerId,filterOutValidation,cachedVersionId){return this.root===exports.SENTINEL?[]:function intervalSearch(T,intervalStart,intervalEnd,filterOwnerId,filterOutValidation,cachedVersionId){let node=T.root,delta=0,nodeMaxEnd=0,nodeStart=0,nodeEnd=0;const result=[];let resultLen=0;for(;node!==exports.SENTINEL;)if(getNodeIsVisited(node))setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node===node.parent.right&&(delta-=node.parent.delta),node=node.parent;else{if(!getNodeIsVisited(node.left)){if(nodeMaxEnd=delta+node.maxEnd,nodeMaxEnd<intervalStart){setNodeIsVisited(node,!0);continue}if(node.left!==exports.SENTINEL){node=node.left;continue}}if(nodeStart=delta+node.start,nodeStart>intervalEnd)setNodeIsVisited(node,!0);else{if(nodeEnd=delta+node.end,nodeEnd>=intervalStart){node.setCachedOffsets(nodeStart,nodeEnd,cachedVersionId);let include=!0;filterOwnerId&&node.ownerId&&node.ownerId!==filterOwnerId&&(include=!1),filterOutValidation&&getNodeIsForValidation(node)&&(include=!1),include&&(result[resultLen++]=node)}setNodeIsVisited(node,!0),node.right===exports.SENTINEL||getNodeIsVisited(node.right)||(delta+=node.delta,node=node.right)}}return setNodeIsVisited(T.root,!1),result}(this,start,end,filterOwnerId,filterOutValidation,cachedVersionId)}search(filterOwnerId,filterOutValidation,cachedVersionId){return this.root===exports.SENTINEL?[]:function search(T,filterOwnerId,filterOutValidation,cachedVersionId){let node=T.root,delta=0,nodeStart=0,nodeEnd=0;const result=[];let resultLen=0;for(;node!==exports.SENTINEL;){if(getNodeIsVisited(node)){setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node===node.parent.right&&(delta-=node.parent.delta),node=node.parent;continue}if(node.left!==exports.SENTINEL&&!getNodeIsVisited(node.left)){node=node.left;continue}nodeStart=delta+node.start,nodeEnd=delta+node.end,node.setCachedOffsets(nodeStart,nodeEnd,cachedVersionId);let include=!0;filterOwnerId&&node.ownerId&&node.ownerId!==filterOwnerId&&(include=!1),filterOutValidation&&getNodeIsForValidation(node)&&(include=!1),include&&(result[resultLen++]=node),setNodeIsVisited(node,!0),node.right===exports.SENTINEL||getNodeIsVisited(node.right)||(delta+=node.delta,node=node.right)}return setNodeIsVisited(T.root,!1),result}(this,filterOwnerId,filterOutValidation,cachedVersionId)}collectNodesFromOwner(ownerId){return function collectNodesFromOwner(T,ownerId){let node=T.root;const result=[];let resultLen=0;for(;node!==exports.SENTINEL;)getNodeIsVisited(node)?(setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node=node.parent):node.left===exports.SENTINEL||getNodeIsVisited(node.left)?(node.ownerId===ownerId&&(result[resultLen++]=node),setNodeIsVisited(node,!0),node.right===exports.SENTINEL||getNodeIsVisited(node.right)||(node=node.right)):node=node.left;return setNodeIsVisited(T.root,!1),result}(this,ownerId)}collectNodesPostOrder(){return function collectNodesPostOrder(T){let node=T.root;const result=[];let resultLen=0;for(;node!==exports.SENTINEL;)getNodeIsVisited(node)?(setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node=node.parent):node.left===exports.SENTINEL||getNodeIsVisited(node.left)?node.right===exports.SENTINEL||getNodeIsVisited(node.right)?(result[resultLen++]=node,setNodeIsVisited(node,!0)):node=node.right:node=node.left;return setNodeIsVisited(T.root,!1),result}(this)}insert(node){rbTreeInsert(this,node),this._normalizeDeltaIfNecessary()}delete(node){rbTreeDelete(this,node),this._normalizeDeltaIfNecessary()}resolveNode(node,cachedVersionId){const initialNode=node;let delta=0;for(;node!==this.root;)node===node.parent.right&&(delta+=node.parent.delta),node=node.parent;const nodeStart=initialNode.start+delta,nodeEnd=initialNode.end+delta;initialNode.setCachedOffsets(nodeStart,nodeEnd,cachedVersionId)}acceptReplace(offset,length,textLength,forceMoveMarkers){const nodesOfInterest=function searchForEditing(T,start,end){let node=T.root,delta=0,nodeMaxEnd=0,nodeStart=0,nodeEnd=0;const result=[];let resultLen=0;for(;node!==exports.SENTINEL;)if(getNodeIsVisited(node))setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node===node.parent.right&&(delta-=node.parent.delta),node=node.parent;else{if(!getNodeIsVisited(node.left)){if(nodeMaxEnd=delta+node.maxEnd,nodeMaxEnd<start){setNodeIsVisited(node,!0);continue}if(node.left!==exports.SENTINEL){node=node.left;continue}}nodeStart=delta+node.start,nodeStart>end?setNodeIsVisited(node,!0):(nodeEnd=delta+node.end,nodeEnd>=start&&(node.setCachedOffsets(nodeStart,nodeEnd,0),result[resultLen++]=node),setNodeIsVisited(node,!0),node.right===exports.SENTINEL||getNodeIsVisited(node.right)||(delta+=node.delta,node=node.right))}return setNodeIsVisited(T.root,!1),result}(this,offset,offset+length);for(let i=0,len=nodesOfInterest.length;i<len;i++){rbTreeDelete(this,nodesOfInterest[i])}this._normalizeDeltaIfNecessary(),function noOverlapReplace(T,start,end,textLength){let node=T.root,delta=0,nodeMaxEnd=0,nodeStart=0;const editDelta=textLength-(end-start);for(;node!==exports.SENTINEL;)if(getNodeIsVisited(node))setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node===node.parent.right&&(delta-=node.parent.delta),recomputeMaxEnd(node),node=node.parent;else{if(!getNodeIsVisited(node.left)){if(nodeMaxEnd=delta+node.maxEnd,nodeMaxEnd<start){setNodeIsVisited(node,!0);continue}if(node.left!==exports.SENTINEL){node=node.left;continue}}nodeStart=delta+node.start,nodeStart>end?(node.start+=editDelta,node.end+=editDelta,node.delta+=editDelta,(node.delta<-1073741824||node.delta>1073741824)&&(T.requestNormalizeDelta=!0),setNodeIsVisited(node,!0)):(setNodeIsVisited(node,!0),node.right===exports.SENTINEL||getNodeIsVisited(node.right)||(delta+=node.delta,node=node.right))}setNodeIsVisited(T.root,!1)}(this,offset,offset+length,textLength),this._normalizeDeltaIfNecessary();for(let i=0,len=nodesOfInterest.length;i<len;i++){const node=nodesOfInterest[i];node.start=node.cachedAbsoluteStart,node.end=node.cachedAbsoluteEnd,nodeAcceptEdit(node,offset,offset+length,textLength,forceMoveMarkers),node.maxEnd=node.end,rbTreeInsert(this,node)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,function normalizeDelta(T){let node=T.root,delta=0;for(;node!==exports.SENTINEL;)node.left===exports.SENTINEL||getNodeIsVisited(node.left)?node.right===exports.SENTINEL||getNodeIsVisited(node.right)?(node.start=delta+node.start,node.end=delta+node.end,node.delta=0,recomputeMaxEnd(node),setNodeIsVisited(node,!0),setNodeIsVisited(node.left,!1),setNodeIsVisited(node.right,!1),node===node.parent.right&&(delta-=node.parent.delta),node=node.parent):(delta+=node.delta,node=node.right):node=node.left;setNodeIsVisited(T.root,!1)}(this))}},exports.nodeAcceptEdit=nodeAcceptEdit,exports.recomputeMaxEnd=recomputeMaxEnd,exports.intervalCompare=intervalCompare})),define(__m[426],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.recomputeTreeMetadata=exports.updateTreeMetadata=exports.fixInsert=exports.rbDelete=exports.rightRotate=exports.leftRotate=exports.resetSentinel=exports.calculateLF=exports.calculateSize=exports.righttest=exports.leftest=exports.SENTINEL=exports.TreeNode=void 0;class TreeNode{constructor(piece,color){this.piece=piece,this.color=color,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==exports.SENTINEL)return leftest(this.right);let node=this;for(;node.parent!==exports.SENTINEL&&node.parent.left!==node;)node=node.parent;return node.parent===exports.SENTINEL?exports.SENTINEL:node.parent}prev(){if(this.left!==exports.SENTINEL)return righttest(this.left);let node=this;for(;node.parent!==exports.SENTINEL&&node.parent.right!==node;)node=node.parent;return node.parent===exports.SENTINEL?exports.SENTINEL:node.parent}detach(){this.parent=null,this.left=null,this.right=null}}function leftest(node){for(;node.left!==exports.SENTINEL;)node=node.left;return node}function righttest(node){for(;node.right!==exports.SENTINEL;)node=node.right;return node}function calculateSize(node){return node===exports.SENTINEL?0:node.size_left+node.piece.length+calculateSize(node.right)}function calculateLF(node){return node===exports.SENTINEL?0:node.lf_left+node.piece.lineFeedCnt+calculateLF(node.right)}function resetSentinel(){exports.SENTINEL.parent=exports.SENTINEL}function leftRotate(tree,x){const y=x.right;y.size_left+=x.size_left+(x.piece?x.piece.length:0),y.lf_left+=x.lf_left+(x.piece?x.piece.lineFeedCnt:0),x.right=y.left,y.left!==exports.SENTINEL&&(y.left.parent=x),y.parent=x.parent,x.parent===exports.SENTINEL?tree.root=y:x.parent.left===x?x.parent.left=y:x.parent.right=y,y.left=x,x.parent=y}function rightRotate(tree,y){const x=y.left;y.left=x.right,x.right!==exports.SENTINEL&&(x.right.parent=y),x.parent=y.parent,y.size_left-=x.size_left+(x.piece?x.piece.length:0),y.lf_left-=x.lf_left+(x.piece?x.piece.lineFeedCnt:0),y.parent===exports.SENTINEL?tree.root=x:y===y.parent.right?y.parent.right=x:y.parent.left=x,x.right=y,y.parent=x}function updateTreeMetadata(tree,x,delta,lineFeedCntDelta){for(;x!==tree.root&&x!==exports.SENTINEL;)x.parent.left===x&&(x.parent.size_left+=delta,x.parent.lf_left+=lineFeedCntDelta),x=x.parent}function recomputeTreeMetadata(tree,x){let delta=0,lf_delta=0;if(x!==tree.root){for(;x!==tree.root&&x===x.parent.right;)x=x.parent;if(x!==tree.root)for(delta=calculateSize((x=x.parent).left)-x.size_left,lf_delta=calculateLF(x.left)-x.lf_left,x.size_left+=delta,x.lf_left+=lf_delta;x!==tree.root&&(0!==delta||0!==lf_delta);)x.parent.left===x&&(x.parent.size_left+=delta,x.parent.lf_left+=lf_delta),x=x.parent}}exports.TreeNode=TreeNode,exports.SENTINEL=new TreeNode(null,0),exports.SENTINEL.parent=exports.SENTINEL,exports.SENTINEL.left=exports.SENTINEL,exports.SENTINEL.right=exports.SENTINEL,exports.SENTINEL.color=0,exports.leftest=leftest,exports.righttest=righttest,exports.calculateSize=calculateSize,exports.calculateLF=calculateLF,exports.resetSentinel=resetSentinel,exports.leftRotate=leftRotate,exports.rightRotate=rightRotate,exports.rbDelete=function rbDelete(tree,z){let x,y;if(z.left===exports.SENTINEL?(y=z,x=y.right):z.right===exports.SENTINEL?(y=z,x=y.left):(y=leftest(z.right),x=y.right),y===tree.root)return tree.root=x,x.color=0,z.detach(),resetSentinel(),void(tree.root.parent=exports.SENTINEL);const yWasRed=1===y.color;if(y===y.parent.left?y.parent.left=x:y.parent.right=x,y===z?(x.parent=y.parent,recomputeTreeMetadata(tree,x)):(y.parent===z?x.parent=y:x.parent=y.parent,recomputeTreeMetadata(tree,x),y.left=z.left,y.right=z.right,y.parent=z.parent,y.color=z.color,z===tree.root?tree.root=y:z===z.parent.left?z.parent.left=y:z.parent.right=y,y.left!==exports.SENTINEL&&(y.left.parent=y),y.right!==exports.SENTINEL&&(y.right.parent=y),y.size_left=z.size_left,y.lf_left=z.lf_left,recomputeTreeMetadata(tree,y)),z.detach(),x.parent.left===x){const newSizeLeft=calculateSize(x),newLFLeft=calculateLF(x);if(newSizeLeft!==x.parent.size_left||newLFLeft!==x.parent.lf_left){const delta=newSizeLeft-x.parent.size_left,lf_delta=newLFLeft-x.parent.lf_left;x.parent.size_left=newSizeLeft,x.parent.lf_left=newLFLeft,updateTreeMetadata(tree,x.parent,delta,lf_delta)}}if(recomputeTreeMetadata(tree,x.parent),yWasRed)return void resetSentinel();let w;for(;x!==tree.root&&0===x.color;)x===x.parent.left?(w=x.parent.right,1===w.color&&(w.color=0,x.parent.color=1,leftRotate(tree,x.parent),w=x.parent.right),0===w.left.color&&0===w.right.color?(w.color=1,x=x.parent):(0===w.right.color&&(w.left.color=0,w.color=1,rightRotate(tree,w),w=x.parent.right),w.color=x.parent.color,x.parent.color=0,w.right.color=0,leftRotate(tree,x.parent),x=tree.root)):(w=x.parent.left,1===w.color&&(w.color=0,x.parent.color=1,rightRotate(tree,x.parent),w=x.parent.left),0===w.left.color&&0===w.right.color?(w.color=1,x=x.parent):(0===w.left.color&&(w.right.color=0,w.color=1,leftRotate(tree,w),w=x.parent.left),w.color=x.parent.color,x.parent.color=0,w.left.color=0,rightRotate(tree,x.parent),x=tree.root));x.color=0,resetSentinel()},exports.fixInsert=function fixInsert(tree,x){for(recomputeTreeMetadata(tree,x);x!==tree.root&&1===x.parent.color;)if(x.parent===x.parent.parent.left){const y=x.parent.parent.right;1===y.color?(x.parent.color=0,y.color=0,x.parent.parent.color=1,x=x.parent.parent):(x===x.parent.right&&leftRotate(tree,x=x.parent),x.parent.color=0,x.parent.parent.color=1,rightRotate(tree,x.parent.parent))}else{const y=x.parent.parent.left;1===y.color?(x.parent.color=0,y.color=0,x.parent.parent.color=1,x=x.parent.parent):(x===x.parent.left&&rightRotate(tree,x=x.parent),x.parent.color=0,x.parent.parent.color=1,leftRotate(tree,x.parent.parent))}tree.root.color=0},exports.updateTreeMetadata=updateTreeMetadata,exports.recomputeTreeMetadata=recomputeTreeMetadata})),define(__m[245],__M([1,0,18,142]),(function(require,exports,arrays_1,uint_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrefixSumIndexOfResult=exports.ConstantTimePrefixSumComputer=exports.PrefixSumComputer=void 0;exports.PrefixSumComputer=class PrefixSumComputer{constructor(values){this.values=values,this.prefixSum=new Uint32Array(values.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(insertIndex,insertValues){insertIndex=(0,uint_1.toUint32)(insertIndex);const oldValues=this.values,oldPrefixSum=this.prefixSum,insertValuesLen=insertValues.length;return 0!==insertValuesLen&&(this.values=new Uint32Array(oldValues.length+insertValuesLen),this.values.set(oldValues.subarray(0,insertIndex),0),this.values.set(oldValues.subarray(insertIndex),insertIndex+insertValuesLen),this.values.set(insertValues,insertIndex),insertIndex-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=insertIndex-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(oldPrefixSum.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(index,value){return index=(0,uint_1.toUint32)(index),value=(0,uint_1.toUint32)(value),this.values[index]!==value&&(this.values[index]=value,index-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=index-1),!0)}removeValues(startIndex,count){startIndex=(0,uint_1.toUint32)(startIndex),count=(0,uint_1.toUint32)(count);const oldValues=this.values,oldPrefixSum=this.prefixSum;if(startIndex>=oldValues.length)return!1;const maxCount=oldValues.length-startIndex;return count>=maxCount&&(count=maxCount),0!==count&&(this.values=new Uint32Array(oldValues.length-count),this.values.set(oldValues.subarray(0,startIndex),0),this.values.set(oldValues.subarray(startIndex+count),startIndex),this.prefixSum=new Uint32Array(this.values.length),startIndex-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=startIndex-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(oldPrefixSum.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return 0===this.values.length?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(index){return index<0?0:(index=(0,uint_1.toUint32)(index),this._getPrefixSum(index))}_getPrefixSum(index){if(index<=this.prefixSumValidIndex[0])return this.prefixSum[index];let startIndex=this.prefixSumValidIndex[0]+1;0===startIndex&&(this.prefixSum[0]=this.values[0],startIndex++),index>=this.values.length&&(index=this.values.length-1);for(let i=startIndex;i<=index;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],index),this.prefixSum[index]}getIndexOf(sum){sum=Math.floor(sum),this.getTotalSum();let low=0,high=this.values.length-1,mid=0,midStop=0,midStart=0;for(;low<=high;)if(mid=low+(high-low)/2|0,midStop=this.prefixSum[mid],midStart=midStop-this.values[mid],sum<midStart)high=mid-1;else{if(!(sum>=midStop))break;low=mid+1}return new PrefixSumIndexOfResult(mid,sum-midStart)}};exports.ConstantTimePrefixSumComputer=class ConstantTimePrefixSumComputer{constructor(values){this._values=values,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(count){return this._ensureValid(),0===count?0:this._prefixSum[count-1]}getIndexOf(sum){this._ensureValid();const idx=this._indexBySum[sum],viewLinesAbove=idx>0?this._prefixSum[idx-1]:0;return new PrefixSumIndexOfResult(idx,sum-viewLinesAbove)}removeValues(start,deleteCount){this._values.splice(start,deleteCount),this._invalidate(start)}insertValues(insertIndex,insertArr){this._values=(0,arrays_1.arrayInsert)(this._values,insertIndex,insertArr),this._invalidate(insertIndex)}_invalidate(index){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,index-1)}_ensureValid(){if(!this._isValid){for(let i=this._validEndIndex+1,len=this._values.length;i<len;i++){const value=this._values[i],sumAbove=i>0?this._prefixSum[i-1]:0;this._prefixSum[i]=sumAbove+value;for(let j=0;j<value;j++)this._indexBySum[sumAbove+j]=i}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(index,value){this._values[index]!==value&&(this._values[index]=value,this._invalidate(index))}};class PrefixSumIndexOfResult{constructor(index,remainder){this.index=index,this.remainder=remainder,this._prefixSumIndexOfResultBrand=void 0,this.index=index,this.remainder=remainder}}exports.PrefixSumIndexOfResult=PrefixSumIndexOfResult})),define(__m[427],__M([1,0,8,11,245]),(function(require,exports,strings_1,position_1,prefixSumComputer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MirrorTextModel=void 0;exports.MirrorTextModel=class MirrorTextModel{constructor(uri,lines,eol,versionId){this._uri=uri,this._lines=lines,this._eol=eol,this._versionId=versionId,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return null===this._cachedTextValue&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const changes=e.changes;for(const change of changes)this._acceptDeleteRange(change.range),this._acceptInsertText(new position_1.Position(change.range.startLineNumber,change.range.startColumn),change.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const eolLength=this._eol.length,linesLength=this._lines.length,lineStartValues=new Uint32Array(linesLength);for(let i=0;i<linesLength;i++)lineStartValues[i]=this._lines[i].length+eolLength;this._lineStarts=new prefixSumComputer_1.PrefixSumComputer(lineStartValues)}}_setLineText(lineIndex,newValue){this._lines[lineIndex]=newValue,this._lineStarts&&this._lineStarts.setValue(lineIndex,this._lines[lineIndex].length+this._eol.length)}_acceptDeleteRange(range){if(range.startLineNumber!==range.endLineNumber)this._setLineText(range.startLineNumber-1,this._lines[range.startLineNumber-1].substring(0,range.startColumn-1)+this._lines[range.endLineNumber-1].substring(range.endColumn-1)),this._lines.splice(range.startLineNumber,range.endLineNumber-range.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(range.startLineNumber,range.endLineNumber-range.startLineNumber);else{if(range.startColumn===range.endColumn)return;this._setLineText(range.startLineNumber-1,this._lines[range.startLineNumber-1].substring(0,range.startColumn-1)+this._lines[range.startLineNumber-1].substring(range.endColumn-1))}}_acceptInsertText(position,insertText){if(0===insertText.length)return;const insertLines=(0,strings_1.splitLines)(insertText);if(1===insertLines.length)return void this._setLineText(position.lineNumber-1,this._lines[position.lineNumber-1].substring(0,position.column-1)+insertLines[0]+this._lines[position.lineNumber-1].substring(position.column-1));insertLines[insertLines.length-1]+=this._lines[position.lineNumber-1].substring(position.column-1),this._setLineText(position.lineNumber-1,this._lines[position.lineNumber-1].substring(0,position.column-1)+insertLines[0]);const newLengths=new Uint32Array(insertLines.length-1);for(let i=1;i<insertLines.length;i++)this._lines.splice(position.lineNumber+i-1,0,insertLines[i]),newLengths[i-1]=insertLines[i].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(position.lineNumber,newLengths)}}})),define(__m[428],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextModelPart=void 0;exports.TextModelPart=class TextModelPart{constructor(){this._isDisposed=!1}dispose(){this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}})),define(__m[153],__M([1,0,8,120,11,3,50]),(function(require,exports,strings,wordCharacterClassifier_1,position_1,range_1,model_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Searcher=exports.isValidMatch=exports.TextModelSearch=exports.createFindMatch=exports.isMultilineRegexSource=exports.SearchParams=void 0;function isMultilineRegexSource(searchString){if(!searchString||0===searchString.length)return!1;for(let i=0,len=searchString.length;i<len;i++){if(92===searchString.charCodeAt(i)){if(i++,i>=len)break;const nextChCode=searchString.charCodeAt(i);if(110===nextChCode||114===nextChCode||87===nextChCode)return!0}}return!1}function createFindMatch(range,rawMatches,captureMatches){if(!captureMatches)return new model_1.FindMatch(range,null);const matches=[];for(let i=0,len=rawMatches.length;i<len;i++)matches[i]=rawMatches[i];return new model_1.FindMatch(range,matches)}exports.SearchParams=class SearchParams{constructor(searchString,isRegex,matchCase,wordSeparators){this.searchString=searchString,this.isRegex=isRegex,this.matchCase=matchCase,this.wordSeparators=wordSeparators}parseSearchRequest(){if(""===this.searchString)return null;let multiline;multiline=this.isRegex?isMultilineRegexSource(this.searchString):this.searchString.indexOf("\n")>=0;let regex=null;try{regex=strings.createRegExp(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline,global:!0,unicode:!0})}catch(err){return null}if(!regex)return null;let canUseSimpleSearch=!this.isRegex&&!multiline;return canUseSimpleSearch&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(canUseSimpleSearch=this.matchCase),new model_1.SearchData(regex,this.wordSeparators?(0,wordCharacterClassifier_1.getMapForWordSeparators)(this.wordSeparators):null,canUseSimpleSearch?this.searchString:null)}},exports.isMultilineRegexSource=isMultilineRegexSource,exports.createFindMatch=createFindMatch;class LineFeedCounter{constructor(text){const lineFeedsOffsets=[];let lineFeedsOffsetsLen=0;for(let i=0,textLen=text.length;i<textLen;i++)10===text.charCodeAt(i)&&(lineFeedsOffsets[lineFeedsOffsetsLen++]=i);this._lineFeedsOffsets=lineFeedsOffsets}findLineFeedCountBeforeOffset(offset){const lineFeedsOffsets=this._lineFeedsOffsets;let min=0,max=lineFeedsOffsets.length-1;if(-1===max)return 0;if(offset<=lineFeedsOffsets[0])return 0;for(;min<max;){const mid=min+((max-min)/2>>0);lineFeedsOffsets[mid]>=offset?max=mid-1:lineFeedsOffsets[mid+1]>=offset?(min=mid,max=mid):min=mid+1}return min+1}}function isValidMatch(wordSeparators,text,textLength,matchStartIndex,matchLength){return function leftIsWordBounday(wordSeparators,text,textLength,matchStartIndex,matchLength){if(0===matchStartIndex)return!0;const charBefore=text.charCodeAt(matchStartIndex-1);if(0!==wordSeparators.get(charBefore))return!0;if(13===charBefore||10===charBefore)return!0;if(matchLength>0){const firstCharInMatch=text.charCodeAt(matchStartIndex);if(0!==wordSeparators.get(firstCharInMatch))return!0}return!1}(wordSeparators,text,0,matchStartIndex,matchLength)&&function rightIsWordBounday(wordSeparators,text,textLength,matchStartIndex,matchLength){if(matchStartIndex+matchLength===textLength)return!0;const charAfter=text.charCodeAt(matchStartIndex+matchLength);if(0!==wordSeparators.get(charAfter))return!0;if(13===charAfter||10===charAfter)return!0;if(matchLength>0){const lastCharInMatch=text.charCodeAt(matchStartIndex+matchLength-1);if(0!==wordSeparators.get(lastCharInMatch))return!0}return!1}(wordSeparators,text,textLength,matchStartIndex,matchLength)}exports.TextModelSearch=class TextModelSearch{static findMatches(model,searchParams,searchRange,captureMatches,limitResultCount){const searchData=searchParams.parseSearchRequest();return searchData?searchData.regex.multiline?this._doFindMatchesMultiline(model,searchRange,new Searcher(searchData.wordSeparators,searchData.regex),captureMatches,limitResultCount):this._doFindMatchesLineByLine(model,searchRange,searchData,captureMatches,limitResultCount):[]}static _getMultilineMatchRange(model,deltaOffset,text,lfCounter,matchIndex,match0){let startOffset,endOffset,lineFeedCountBeforeMatch=0;if(lfCounter?(lineFeedCountBeforeMatch=lfCounter.findLineFeedCountBeforeOffset(matchIndex),startOffset=deltaOffset+matchIndex+lineFeedCountBeforeMatch):startOffset=deltaOffset+matchIndex,lfCounter){const lineFeedCountInMatch=lfCounter.findLineFeedCountBeforeOffset(matchIndex+match0.length)-lineFeedCountBeforeMatch;endOffset=startOffset+match0.length+lineFeedCountInMatch}else endOffset=startOffset+match0.length;const startPosition=model.getPositionAt(startOffset),endPosition=model.getPositionAt(endOffset);return new range_1.Range(startPosition.lineNumber,startPosition.column,endPosition.lineNumber,endPosition.column)}static _doFindMatchesMultiline(model,searchRange,searcher,captureMatches,limitResultCount){const deltaOffset=model.getOffsetAt(searchRange.getStartPosition()),text=model.getValueInRange(searchRange,1),lfCounter="\r\n"===model.getEOL()?new LineFeedCounter(text):null,result=[];let m,counter=0;for(searcher.reset(0);m=searcher.next(text);)if(result[counter++]=createFindMatch(this._getMultilineMatchRange(model,deltaOffset,text,lfCounter,m.index,m[0]),m,captureMatches),counter>=limitResultCount)return result;return result}static _doFindMatchesLineByLine(model,searchRange,searchData,captureMatches,limitResultCount){const result=[];let resultLen=0;if(searchRange.startLineNumber===searchRange.endLineNumber){const text=model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn-1,searchRange.endColumn-1);return resultLen=this._findMatchesInLine(searchData,text,searchRange.startLineNumber,searchRange.startColumn-1,resultLen,result,captureMatches,limitResultCount),result}const text=model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn-1);resultLen=this._findMatchesInLine(searchData,text,searchRange.startLineNumber,searchRange.startColumn-1,resultLen,result,captureMatches,limitResultCount);for(let lineNumber=searchRange.startLineNumber+1;lineNumber<searchRange.endLineNumber&&resultLen<limitResultCount;lineNumber++)resultLen=this._findMatchesInLine(searchData,model.getLineContent(lineNumber),lineNumber,0,resultLen,result,captureMatches,limitResultCount);if(resultLen<limitResultCount){const text=model.getLineContent(searchRange.endLineNumber).substring(0,searchRange.endColumn-1);resultLen=this._findMatchesInLine(searchData,text,searchRange.endLineNumber,0,resultLen,result,captureMatches,limitResultCount)}return result}static _findMatchesInLine(searchData,text,lineNumber,deltaOffset,resultLen,result,captureMatches,limitResultCount){const wordSeparators=searchData.wordSeparators;if(!captureMatches&&searchData.simpleSearch){const searchString=searchData.simpleSearch,searchStringLen=searchString.length,textLength=text.length;let lastMatchIndex=-searchStringLen;for(;-1!==(lastMatchIndex=text.indexOf(searchString,lastMatchIndex+searchStringLen));)if((!wordSeparators||isValidMatch(wordSeparators,text,textLength,lastMatchIndex,searchStringLen))&&(result[resultLen++]=new model_1.FindMatch(new range_1.Range(lineNumber,lastMatchIndex+1+deltaOffset,lineNumber,lastMatchIndex+1+searchStringLen+deltaOffset),null),resultLen>=limitResultCount))return resultLen;return resultLen}const searcher=new Searcher(searchData.wordSeparators,searchData.regex);let m;searcher.reset(0);do{if(m=searcher.next(text),m&&(result[resultLen++]=createFindMatch(new range_1.Range(lineNumber,m.index+1+deltaOffset,lineNumber,m.index+1+m[0].length+deltaOffset),m,captureMatches),resultLen>=limitResultCount))return resultLen}while(m);return resultLen}static findNextMatch(model,searchParams,searchStart,captureMatches){const searchData=searchParams.parseSearchRequest();if(!searchData)return null;const searcher=new Searcher(searchData.wordSeparators,searchData.regex);return searchData.regex.multiline?this._doFindNextMatchMultiline(model,searchStart,searcher,captureMatches):this._doFindNextMatchLineByLine(model,searchStart,searcher,captureMatches)}static _doFindNextMatchMultiline(model,searchStart,searcher,captureMatches){const searchTextStart=new position_1.Position(searchStart.lineNumber,1),deltaOffset=model.getOffsetAt(searchTextStart),lineCount=model.getLineCount(),text=model.getValueInRange(new range_1.Range(searchTextStart.lineNumber,searchTextStart.column,lineCount,model.getLineMaxColumn(lineCount)),1),lfCounter="\r\n"===model.getEOL()?new LineFeedCounter(text):null;searcher.reset(searchStart.column-1);let m=searcher.next(text);return m?createFindMatch(this._getMultilineMatchRange(model,deltaOffset,text,lfCounter,m.index,m[0]),m,captureMatches):1!==searchStart.lineNumber||1!==searchStart.column?this._doFindNextMatchMultiline(model,new position_1.Position(1,1),searcher,captureMatches):null}static _doFindNextMatchLineByLine(model,searchStart,searcher,captureMatches){const lineCount=model.getLineCount(),startLineNumber=searchStart.lineNumber,text=model.getLineContent(startLineNumber),r=this._findFirstMatchInLine(searcher,text,startLineNumber,searchStart.column,captureMatches);if(r)return r;for(let i=1;i<=lineCount;i++){const lineIndex=(startLineNumber+i-1)%lineCount,text=model.getLineContent(lineIndex+1),r=this._findFirstMatchInLine(searcher,text,lineIndex+1,1,captureMatches);if(r)return r}return null}static _findFirstMatchInLine(searcher,text,lineNumber,fromColumn,captureMatches){searcher.reset(fromColumn-1);const m=searcher.next(text);return m?createFindMatch(new range_1.Range(lineNumber,m.index+1,lineNumber,m.index+1+m[0].length),m,captureMatches):null}static findPreviousMatch(model,searchParams,searchStart,captureMatches){const searchData=searchParams.parseSearchRequest();if(!searchData)return null;const searcher=new Searcher(searchData.wordSeparators,searchData.regex);return searchData.regex.multiline?this._doFindPreviousMatchMultiline(model,searchStart,searcher,captureMatches):this._doFindPreviousMatchLineByLine(model,searchStart,searcher,captureMatches)}static _doFindPreviousMatchMultiline(model,searchStart,searcher,captureMatches){const matches=this._doFindMatchesMultiline(model,new range_1.Range(1,1,searchStart.lineNumber,searchStart.column),searcher,captureMatches,9990);if(matches.length>0)return matches[matches.length-1];const lineCount=model.getLineCount();return searchStart.lineNumber!==lineCount||searchStart.column!==model.getLineMaxColumn(lineCount)?this._doFindPreviousMatchMultiline(model,new position_1.Position(lineCount,model.getLineMaxColumn(lineCount)),searcher,captureMatches):null}static _doFindPreviousMatchLineByLine(model,searchStart,searcher,captureMatches){const lineCount=model.getLineCount(),startLineNumber=searchStart.lineNumber,text=model.getLineContent(startLineNumber).substring(0,searchStart.column-1),r=this._findLastMatchInLine(searcher,text,startLineNumber,captureMatches);if(r)return r;for(let i=1;i<=lineCount;i++){const lineIndex=(lineCount+startLineNumber-i-1)%lineCount,text=model.getLineContent(lineIndex+1),r=this._findLastMatchInLine(searcher,text,lineIndex+1,captureMatches);if(r)return r}return null}static _findLastMatchInLine(searcher,text,lineNumber,captureMatches){let m,bestResult=null;for(searcher.reset(0);m=searcher.next(text);)bestResult=createFindMatch(new range_1.Range(lineNumber,m.index+1,lineNumber,m.index+1+m[0].length),m,captureMatches);return bestResult}},exports.isValidMatch=isValidMatch;class Searcher{constructor(wordSeparators,searchRegex){this._wordSeparators=wordSeparators,this._searchRegex=searchRegex,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(lastIndex){this._searchRegex.lastIndex=lastIndex,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(text){const textLength=text.length;let m;do{if(this._prevMatchStartIndex+this._prevMatchLength===textLength)return null;if(m=this._searchRegex.exec(text),!m)return null;const matchStartIndex=m.index,matchLength=m[0].length;if(matchStartIndex===this._prevMatchStartIndex&&matchLength===this._prevMatchLength){if(0===matchLength){strings.getNextCodePoint(text,textLength,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=matchStartIndex,this._prevMatchLength=matchLength,!this._wordSeparators||isValidMatch(this._wordSeparators,text,textLength,matchStartIndex,matchLength))return m}while(m);return null}}exports.Searcher=Searcher})),define(__m[246],__M([1,0,11,3,50,426,153]),(function(require,exports,position_1,range_1,model_1,rbTreeBase_1,textModelSearch_1){"use strict";function createUintArray(arr){let r;return r=arr[arr.length-1]<65536?new Uint16Array(arr.length):new Uint32Array(arr.length),r.set(arr,0),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceTreeBase=exports.StringBuffer=exports.Piece=exports.createLineStarts=exports.createLineStartsFast=exports.LineStarts=exports.createUintArray=exports.AverageBufferSize=void 0,exports.AverageBufferSize=65535,exports.createUintArray=createUintArray;class LineStarts{constructor(lineStarts,cr,lf,crlf,isBasicASCII){this.lineStarts=lineStarts,this.cr=cr,this.lf=lf,this.crlf=crlf,this.isBasicASCII=isBasicASCII}}function createLineStartsFast(str,readonly=!0){const r=[0];let rLength=1;for(let i=0,len=str.length;i<len;i++){const chr=str.charCodeAt(i);13===chr?i+1<len&&10===str.charCodeAt(i+1)?(r[rLength++]=i+2,i++):r[rLength++]=i+1:10===chr&&(r[rLength++]=i+1)}return readonly?createUintArray(r):r}exports.LineStarts=LineStarts,exports.createLineStartsFast=createLineStartsFast,exports.createLineStarts=function createLineStarts(r,str){r.length=0,r[0]=0;let rLength=1,cr=0,lf=0,crlf=0,isBasicASCII=!0;for(let i=0,len=str.length;i<len;i++){const chr=str.charCodeAt(i);13===chr?i+1<len&&10===str.charCodeAt(i+1)?(crlf++,r[rLength++]=i+2,i++):(cr++,r[rLength++]=i+1):10===chr?(lf++,r[rLength++]=i+1):isBasicASCII&&9!==chr&&(chr<32||chr>126)&&(isBasicASCII=!1)}const result=new LineStarts(createUintArray(r),cr,lf,crlf,isBasicASCII);return r.length=0,result};class Piece{constructor(bufferIndex,start,end,lineFeedCnt,length){this.bufferIndex=bufferIndex,this.start=start,this.end=end,this.lineFeedCnt=lineFeedCnt,this.length=length}}exports.Piece=Piece;class StringBuffer{constructor(buffer,lineStarts){this.buffer=buffer,this.lineStarts=lineStarts}}exports.StringBuffer=StringBuffer;class PieceTreeSnapshot{constructor(tree,BOM){this._pieces=[],this._tree=tree,this._BOM=BOM,this._index=0,tree.root!==rbTreeBase_1.SENTINEL&&tree.iterate(tree.root,(node=>(node!==rbTreeBase_1.SENTINEL&&this._pieces.push(node.piece),!0)))}read(){return 0===this._pieces.length?0===this._index?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:0===this._index?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class PieceTreeSearchCache{constructor(limit){this._limit=limit,this._cache=[]}get(offset){for(let i=this._cache.length-1;i>=0;i--){const nodePos=this._cache[i];if(nodePos.nodeStartOffset<=offset&&nodePos.nodeStartOffset+nodePos.node.piece.length>=offset)return nodePos}return null}get2(lineNumber){for(let i=this._cache.length-1;i>=0;i--){const nodePos=this._cache[i];if(nodePos.nodeStartLineNumber&&nodePos.nodeStartLineNumber<lineNumber&&nodePos.nodeStartLineNumber+nodePos.node.piece.lineFeedCnt>=lineNumber)return nodePos}return null}set(nodePosition){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(nodePosition)}validate(offset){let hasInvalidVal=!1;const tmp=this._cache;for(let i=0;i<tmp.length;i++){const nodePos=tmp[i];(null===nodePos.node.parent||nodePos.nodeStartOffset>=offset)&&(tmp[i]=null,hasInvalidVal=!0)}if(hasInvalidVal){const newArr=[];for(const entry of tmp)null!==entry&&newArr.push(entry);this._cache=newArr}}}exports.PieceTreeBase=class PieceTreeBase{constructor(chunks,eol,eolNormalized){this.create(chunks,eol,eolNormalized)}create(chunks,eol,eolNormalized){this._buffers=[new StringBuffer("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=rbTreeBase_1.SENTINEL,this._lineCnt=1,this._length=0,this._EOL=eol,this._EOLLength=eol.length,this._EOLNormalized=eolNormalized;let lastNode=null;for(let i=0,len=chunks.length;i<len;i++)if(chunks[i].buffer.length>0){chunks[i].lineStarts||(chunks[i].lineStarts=createLineStartsFast(chunks[i].buffer));const piece=new Piece(i+1,{line:0,column:0},{line:chunks[i].lineStarts.length-1,column:chunks[i].buffer.length-chunks[i].lineStarts[chunks[i].lineStarts.length-1]},chunks[i].lineStarts.length-1,chunks[i].buffer.length);this._buffers.push(chunks[i]),lastNode=this.rbInsertRight(lastNode,piece)}this._searchCache=new PieceTreeSearchCache(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(eol){const averageBufferSize=exports.AverageBufferSize,min=averageBufferSize-Math.floor(averageBufferSize/3),max=2*min;let tempChunk="",tempChunkLen=0;const chunks=[];if(this.iterate(this.root,(node=>{const str=this.getNodeContent(node),len=str.length;if(tempChunkLen<=min||tempChunkLen+len<max)return tempChunk+=str,tempChunkLen+=len,!0;const text=tempChunk.replace(/\r\n|\r|\n/g,eol);return chunks.push(new StringBuffer(text,createLineStartsFast(text))),tempChunk=str,tempChunkLen=len,!0})),tempChunkLen>0){const text=tempChunk.replace(/\r\n|\r|\n/g,eol);chunks.push(new StringBuffer(text,createLineStartsFast(text)))}this.create(chunks,eol,!0)}getEOL(){return this._EOL}setEOL(newEOL){this._EOL=newEOL,this._EOLLength=this._EOL.length,this.normalizeEOL(newEOL)}createSnapshot(BOM){return new PieceTreeSnapshot(this,BOM)}getOffsetAt(lineNumber,column){let leftLen=0,x=this.root;for(;x!==rbTreeBase_1.SENTINEL;)if(x.left!==rbTreeBase_1.SENTINEL&&x.lf_left+1>=lineNumber)x=x.left;else{if(x.lf_left+x.piece.lineFeedCnt+1>=lineNumber){leftLen+=x.size_left;return leftLen+(this.getAccumulatedValue(x,lineNumber-x.lf_left-2)+column-1)}lineNumber-=x.lf_left+x.piece.lineFeedCnt,leftLen+=x.size_left+x.piece.length,x=x.right}return leftLen}getPositionAt(offset){offset=Math.floor(offset),offset=Math.max(0,offset);let x=this.root,lfCnt=0;const originalOffset=offset;for(;x!==rbTreeBase_1.SENTINEL;)if(0!==x.size_left&&x.size_left>=offset)x=x.left;else{if(x.size_left+x.piece.length>=offset){const out=this.getIndexOf(x,offset-x.size_left);if(lfCnt+=x.lf_left+out.index,0===out.index){const column=originalOffset-this.getOffsetAt(lfCnt+1,1);return new position_1.Position(lfCnt+1,column+1)}return new position_1.Position(lfCnt+1,out.remainder+1)}if(offset-=x.size_left+x.piece.length,lfCnt+=x.lf_left+x.piece.lineFeedCnt,x.right===rbTreeBase_1.SENTINEL){const column=originalOffset-offset-this.getOffsetAt(lfCnt+1,1);return new position_1.Position(lfCnt+1,column+1)}x=x.right}return new position_1.Position(1,1)}getValueInRange(range,eol){if(range.startLineNumber===range.endLineNumber&&range.startColumn===range.endColumn)return"";const startPosition=this.nodeAt2(range.startLineNumber,range.startColumn),endPosition=this.nodeAt2(range.endLineNumber,range.endColumn),value=this.getValueInRange2(startPosition,endPosition);return eol?eol===this._EOL&&this._EOLNormalized&&eol===this.getEOL()&&this._EOLNormalized?value:value.replace(/\r\n|\r|\n/g,eol):value}getValueInRange2(startPosition,endPosition){if(startPosition.node===endPosition.node){const node=startPosition.node,buffer=this._buffers[node.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(node.piece.bufferIndex,node.piece.start);return buffer.substring(startOffset+startPosition.remainder,startOffset+endPosition.remainder)}let x=startPosition.node;const buffer=this._buffers[x.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);let ret=buffer.substring(startOffset+startPosition.remainder,startOffset+x.piece.length);for(x=x.next();x!==rbTreeBase_1.SENTINEL;){const buffer=this._buffers[x.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);if(x===endPosition.node){ret+=buffer.substring(startOffset,startOffset+endPosition.remainder);break}ret+=buffer.substr(startOffset,x.piece.length),x=x.next()}return ret}getLinesContent(){const lines=[];let linesLength=0,currentLine="",danglingCR=!1;return this.iterate(this.root,(node=>{if(node===rbTreeBase_1.SENTINEL)return!0;const piece=node.piece;let pieceLength=piece.length;if(0===pieceLength)return!0;const buffer=this._buffers[piece.bufferIndex].buffer,lineStarts=this._buffers[piece.bufferIndex].lineStarts,pieceStartLine=piece.start.line,pieceEndLine=piece.end.line;let pieceStartOffset=lineStarts[pieceStartLine]+piece.start.column;if(danglingCR&&(10===buffer.charCodeAt(pieceStartOffset)&&(pieceStartOffset++,pieceLength--),lines[linesLength++]=currentLine,currentLine="",danglingCR=!1,0===pieceLength))return!0;if(pieceStartLine===pieceEndLine)return this._EOLNormalized||13!==buffer.charCodeAt(pieceStartOffset+pieceLength-1)?currentLine+=buffer.substr(pieceStartOffset,pieceLength):(danglingCR=!0,currentLine+=buffer.substr(pieceStartOffset,pieceLength-1)),!0;currentLine+=this._EOLNormalized?buffer.substring(pieceStartOffset,Math.max(pieceStartOffset,lineStarts[pieceStartLine+1]-this._EOLLength)):buffer.substring(pieceStartOffset,lineStarts[pieceStartLine+1]).replace(/(\r\n|\r|\n)$/,""),lines[linesLength++]=currentLine;for(let line=pieceStartLine+1;line<pieceEndLine;line++)currentLine=this._EOLNormalized?buffer.substring(lineStarts[line],lineStarts[line+1]-this._EOLLength):buffer.substring(lineStarts[line],lineStarts[line+1]).replace(/(\r\n|\r|\n)$/,""),lines[linesLength++]=currentLine;return this._EOLNormalized||13!==buffer.charCodeAt(lineStarts[pieceEndLine]+piece.end.column-1)?currentLine=buffer.substr(lineStarts[pieceEndLine],piece.end.column):(danglingCR=!0,0===piece.end.column?linesLength--:currentLine=buffer.substr(lineStarts[pieceEndLine],piece.end.column-1)),!0})),danglingCR&&(lines[linesLength++]=currentLine,currentLine=""),lines[linesLength++]=currentLine,lines}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(lineNumber){return this._lastVisitedLine.lineNumber===lineNumber||(this._lastVisitedLine.lineNumber=lineNumber,lineNumber===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(lineNumber):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(lineNumber,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(lineNumber).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(nodePos){if(nodePos.remainder===nodePos.node.piece.length){const matchingNode=nodePos.node.next();if(!matchingNode)return 0;const buffer=this._buffers[matchingNode.piece.bufferIndex],startOffset=this.offsetInBuffer(matchingNode.piece.bufferIndex,matchingNode.piece.start);return buffer.buffer.charCodeAt(startOffset)}{const buffer=this._buffers[nodePos.node.piece.bufferIndex],targetOffset=this.offsetInBuffer(nodePos.node.piece.bufferIndex,nodePos.node.piece.start)+nodePos.remainder;return buffer.buffer.charCodeAt(targetOffset)}}getLineCharCode(lineNumber,index){const nodePos=this.nodeAt2(lineNumber,index+1);return this._getCharCode(nodePos)}getLineLength(lineNumber){if(lineNumber===this.getLineCount()){const startOffset=this.getOffsetAt(lineNumber,1);return this.getLength()-startOffset}return this.getOffsetAt(lineNumber+1,1)-this.getOffsetAt(lineNumber,1)-this._EOLLength}findMatchesInNode(node,searcher,startLineNumber,startColumn,startCursor,endCursor,searchData,captureMatches,limitResultCount,resultLen,result){const buffer=this._buffers[node.piece.bufferIndex],startOffsetInBuffer=this.offsetInBuffer(node.piece.bufferIndex,node.piece.start),start=this.offsetInBuffer(node.piece.bufferIndex,startCursor),end=this.offsetInBuffer(node.piece.bufferIndex,endCursor);let m;const ret={line:0,column:0};let searchText,offsetInBuffer;searcher._wordSeparators?(searchText=buffer.buffer.substring(start,end),offsetInBuffer=offset=>offset+start,searcher.reset(0)):(searchText=buffer.buffer,offsetInBuffer=offset=>offset,searcher.reset(start));do{if(m=searcher.next(searchText),m){if(offsetInBuffer(m.index)>=end)return resultLen;this.positionInBuffer(node,offsetInBuffer(m.index)-startOffsetInBuffer,ret);const lineFeedCnt=this.getLineFeedCnt(node.piece.bufferIndex,startCursor,ret),retStartColumn=ret.line===startCursor.line?ret.column-startCursor.column+startColumn:ret.column+1,retEndColumn=retStartColumn+m[0].length;if(result[resultLen++]=(0,textModelSearch_1.createFindMatch)(new range_1.Range(startLineNumber+lineFeedCnt,retStartColumn,startLineNumber+lineFeedCnt,retEndColumn),m,captureMatches),offsetInBuffer(m.index)+m[0].length>=end)return resultLen;if(resultLen>=limitResultCount)return resultLen}}while(m);return resultLen}findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount){const result=[];let resultLen=0;const searcher=new textModelSearch_1.Searcher(searchData.wordSeparators,searchData.regex);let startPosition=this.nodeAt2(searchRange.startLineNumber,searchRange.startColumn);if(null===startPosition)return[];const endPosition=this.nodeAt2(searchRange.endLineNumber,searchRange.endColumn);if(null===endPosition)return[];let start=this.positionInBuffer(startPosition.node,startPosition.remainder);const end=this.positionInBuffer(endPosition.node,endPosition.remainder);if(startPosition.node===endPosition.node)return this.findMatchesInNode(startPosition.node,searcher,searchRange.startLineNumber,searchRange.startColumn,start,end,searchData,captureMatches,limitResultCount,resultLen,result),result;let startLineNumber=searchRange.startLineNumber,currentNode=startPosition.node;for(;currentNode!==endPosition.node;){const lineBreakCnt=this.getLineFeedCnt(currentNode.piece.bufferIndex,start,currentNode.piece.end);if(lineBreakCnt>=1){const lineStarts=this._buffers[currentNode.piece.bufferIndex].lineStarts,startOffsetInBuffer=this.offsetInBuffer(currentNode.piece.bufferIndex,currentNode.piece.start),nextLineStartOffset=lineStarts[start.line+lineBreakCnt],startColumn=startLineNumber===searchRange.startLineNumber?searchRange.startColumn:1;if(resultLen=this.findMatchesInNode(currentNode,searcher,startLineNumber,startColumn,start,this.positionInBuffer(currentNode,nextLineStartOffset-startOffsetInBuffer),searchData,captureMatches,limitResultCount,resultLen,result),resultLen>=limitResultCount)return result;startLineNumber+=lineBreakCnt}const startColumn=startLineNumber===searchRange.startLineNumber?searchRange.startColumn-1:0;if(startLineNumber===searchRange.endLineNumber){const text=this.getLineContent(startLineNumber).substring(startColumn,searchRange.endColumn-1);return resultLen=this._findMatchesInLine(searchData,searcher,text,searchRange.endLineNumber,startColumn,resultLen,result,captureMatches,limitResultCount),result}if(resultLen=this._findMatchesInLine(searchData,searcher,this.getLineContent(startLineNumber).substr(startColumn),startLineNumber,startColumn,resultLen,result,captureMatches,limitResultCount),resultLen>=limitResultCount)return result;startLineNumber++,startPosition=this.nodeAt2(startLineNumber,1),currentNode=startPosition.node,start=this.positionInBuffer(startPosition.node,startPosition.remainder)}if(startLineNumber===searchRange.endLineNumber){const startColumn=startLineNumber===searchRange.startLineNumber?searchRange.startColumn-1:0,text=this.getLineContent(startLineNumber).substring(startColumn,searchRange.endColumn-1);return resultLen=this._findMatchesInLine(searchData,searcher,text,searchRange.endLineNumber,startColumn,resultLen,result,captureMatches,limitResultCount),result}const startColumn=startLineNumber===searchRange.startLineNumber?searchRange.startColumn:1;return resultLen=this.findMatchesInNode(endPosition.node,searcher,startLineNumber,startColumn,start,end,searchData,captureMatches,limitResultCount,resultLen,result),result}_findMatchesInLine(searchData,searcher,text,lineNumber,deltaOffset,resultLen,result,captureMatches,limitResultCount){const wordSeparators=searchData.wordSeparators;if(!captureMatches&&searchData.simpleSearch){const searchString=searchData.simpleSearch,searchStringLen=searchString.length,textLength=text.length;let lastMatchIndex=-searchStringLen;for(;-1!==(lastMatchIndex=text.indexOf(searchString,lastMatchIndex+searchStringLen));)if((!wordSeparators||(0,textModelSearch_1.isValidMatch)(wordSeparators,text,textLength,lastMatchIndex,searchStringLen))&&(result[resultLen++]=new model_1.FindMatch(new range_1.Range(lineNumber,lastMatchIndex+1+deltaOffset,lineNumber,lastMatchIndex+1+searchStringLen+deltaOffset),null),resultLen>=limitResultCount))return resultLen;return resultLen}let m;searcher.reset(0);do{if(m=searcher.next(text),m&&(result[resultLen++]=(0,textModelSearch_1.createFindMatch)(new range_1.Range(lineNumber,m.index+1+deltaOffset,lineNumber,m.index+1+m[0].length+deltaOffset),m,captureMatches),resultLen>=limitResultCount))return resultLen}while(m);return resultLen}insert(offset,value,eolNormalized=!1){if(this._EOLNormalized=this._EOLNormalized&&eolNormalized,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==rbTreeBase_1.SENTINEL){const{node,remainder,nodeStartOffset}=this.nodeAt(offset),piece=node.piece,bufferIndex=piece.bufferIndex,insertPosInBuffer=this.positionInBuffer(node,remainder);if(0===node.piece.bufferIndex&&piece.end.line===this._lastChangeBufferPos.line&&piece.end.column===this._lastChangeBufferPos.column&&nodeStartOffset+piece.length===offset&&value.length<exports.AverageBufferSize)return this.appendToNode(node,value),void this.computeBufferMetadata();if(nodeStartOffset===offset)this.insertContentToNodeLeft(value,node),this._searchCache.validate(offset);else if(nodeStartOffset+node.piece.length>offset){const nodesToDel=[];let newRightPiece=new Piece(piece.bufferIndex,insertPosInBuffer,piece.end,this.getLineFeedCnt(piece.bufferIndex,insertPosInBuffer,piece.end),this.offsetInBuffer(bufferIndex,piece.end)-this.offsetInBuffer(bufferIndex,insertPosInBuffer));if(this.shouldCheckCRLF()&&this.endWithCR(value)){if(10===this.nodeCharCodeAt(node,remainder)){const newStart={line:newRightPiece.start.line+1,column:0};newRightPiece=new Piece(newRightPiece.bufferIndex,newStart,newRightPiece.end,this.getLineFeedCnt(newRightPiece.bufferIndex,newStart,newRightPiece.end),newRightPiece.length-1),value+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(value)){if(13===this.nodeCharCodeAt(node,remainder-1)){const previousPos=this.positionInBuffer(node,remainder-1);this.deleteNodeTail(node,previousPos),value="\r"+value,0===node.piece.length&&nodesToDel.push(node)}else this.deleteNodeTail(node,insertPosInBuffer)}else this.deleteNodeTail(node,insertPosInBuffer);const newPieces=this.createNewPieces(value);newRightPiece.length>0&&this.rbInsertRight(node,newRightPiece);let tmpNode=node;for(let k=0;k<newPieces.length;k++)tmpNode=this.rbInsertRight(tmpNode,newPieces[k]);this.deleteNodes(nodesToDel)}else this.insertContentToNodeRight(value,node)}else{const pieces=this.createNewPieces(value);let node=this.rbInsertLeft(null,pieces[0]);for(let k=1;k<pieces.length;k++)node=this.rbInsertRight(node,pieces[k])}this.computeBufferMetadata()}delete(offset,cnt){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",cnt<=0||this.root===rbTreeBase_1.SENTINEL)return;const startPosition=this.nodeAt(offset),endPosition=this.nodeAt(offset+cnt),startNode=startPosition.node,endNode=endPosition.node;if(startNode===endNode){const startSplitPosInBuffer=this.positionInBuffer(startNode,startPosition.remainder),endSplitPosInBuffer=this.positionInBuffer(startNode,endPosition.remainder);if(startPosition.nodeStartOffset===offset){if(cnt===startNode.piece.length){const next=startNode.next();return(0,rbTreeBase_1.rbDelete)(this,startNode),this.validateCRLFWithPrevNode(next),void this.computeBufferMetadata()}return this.deleteNodeHead(startNode,endSplitPosInBuffer),this._searchCache.validate(offset),this.validateCRLFWithPrevNode(startNode),void this.computeBufferMetadata()}return startPosition.nodeStartOffset+startNode.piece.length===offset+cnt?(this.deleteNodeTail(startNode,startSplitPosInBuffer),this.validateCRLFWithNextNode(startNode),void this.computeBufferMetadata()):(this.shrinkNode(startNode,startSplitPosInBuffer,endSplitPosInBuffer),void this.computeBufferMetadata())}const nodesToDel=[],startSplitPosInBuffer=this.positionInBuffer(startNode,startPosition.remainder);this.deleteNodeTail(startNode,startSplitPosInBuffer),this._searchCache.validate(offset),0===startNode.piece.length&&nodesToDel.push(startNode);const endSplitPosInBuffer=this.positionInBuffer(endNode,endPosition.remainder);this.deleteNodeHead(endNode,endSplitPosInBuffer),0===endNode.piece.length&&nodesToDel.push(endNode);for(let node=startNode.next();node!==rbTreeBase_1.SENTINEL&&node!==endNode;node=node.next())nodesToDel.push(node);const prev=0===startNode.piece.length?startNode.prev():startNode;this.deleteNodes(nodesToDel),this.validateCRLFWithNextNode(prev),this.computeBufferMetadata()}insertContentToNodeLeft(value,node){const nodesToDel=[];if(this.shouldCheckCRLF()&&this.endWithCR(value)&&this.startWithLF(node)){const piece=node.piece,newStart={line:piece.start.line+1,column:0},nPiece=new Piece(piece.bufferIndex,newStart,piece.end,this.getLineFeedCnt(piece.bufferIndex,newStart,piece.end),piece.length-1);node.piece=nPiece,value+="\n",(0,rbTreeBase_1.updateTreeMetadata)(this,node,-1,-1),0===node.piece.length&&nodesToDel.push(node)}const newPieces=this.createNewPieces(value);let newNode=this.rbInsertLeft(node,newPieces[newPieces.length-1]);for(let k=newPieces.length-2;k>=0;k--)newNode=this.rbInsertLeft(newNode,newPieces[k]);this.validateCRLFWithPrevNode(newNode),this.deleteNodes(nodesToDel)}insertContentToNodeRight(value,node){this.adjustCarriageReturnFromNext(value,node)&&(value+="\n");const newPieces=this.createNewPieces(value),newNode=this.rbInsertRight(node,newPieces[0]);let tmpNode=newNode;for(let k=1;k<newPieces.length;k++)tmpNode=this.rbInsertRight(tmpNode,newPieces[k]);this.validateCRLFWithPrevNode(newNode)}positionInBuffer(node,remainder,ret){const piece=node.piece,bufferIndex=node.piece.bufferIndex,lineStarts=this._buffers[bufferIndex].lineStarts,offset=lineStarts[piece.start.line]+piece.start.column+remainder;let low=piece.start.line,high=piece.end.line,mid=0,midStop=0,midStart=0;for(;low<=high&&(mid=low+(high-low)/2|0,midStart=lineStarts[mid],mid!==high);)if(midStop=lineStarts[mid+1],offset<midStart)high=mid-1;else{if(!(offset>=midStop))break;low=mid+1}return ret?(ret.line=mid,ret.column=offset-midStart,null):{line:mid,column:offset-midStart}}getLineFeedCnt(bufferIndex,start,end){if(0===end.column)return end.line-start.line;const lineStarts=this._buffers[bufferIndex].lineStarts;if(end.line===lineStarts.length-1)return end.line-start.line;const nextLineStartOffset=lineStarts[end.line+1],endOffset=lineStarts[end.line]+end.column;if(nextLineStartOffset>endOffset+1)return end.line-start.line;const previousCharOffset=endOffset-1;return 13===this._buffers[bufferIndex].buffer.charCodeAt(previousCharOffset)?end.line-start.line+1:end.line-start.line}offsetInBuffer(bufferIndex,cursor){return this._buffers[bufferIndex].lineStarts[cursor.line]+cursor.column}deleteNodes(nodes){for(let i=0;i<nodes.length;i++)(0,rbTreeBase_1.rbDelete)(this,nodes[i])}createNewPieces(text){if(text.length>exports.AverageBufferSize){const newPieces=[];for(;text.length>exports.AverageBufferSize;){const lastChar=text.charCodeAt(exports.AverageBufferSize-1);let splitText;13===lastChar||lastChar>=55296&&lastChar<=56319?(splitText=text.substring(0,exports.AverageBufferSize-1),text=text.substring(exports.AverageBufferSize-1)):(splitText=text.substring(0,exports.AverageBufferSize),text=text.substring(exports.AverageBufferSize));const lineStarts=createLineStartsFast(splitText);newPieces.push(new Piece(this._buffers.length,{line:0,column:0},{line:lineStarts.length-1,column:splitText.length-lineStarts[lineStarts.length-1]},lineStarts.length-1,splitText.length)),this._buffers.push(new StringBuffer(splitText,lineStarts))}const lineStarts=createLineStartsFast(text);return newPieces.push(new Piece(this._buffers.length,{line:0,column:0},{line:lineStarts.length-1,column:text.length-lineStarts[lineStarts.length-1]},lineStarts.length-1,text.length)),this._buffers.push(new StringBuffer(text,lineStarts)),newPieces}let startOffset=this._buffers[0].buffer.length;const lineStarts=createLineStartsFast(text,!1);let start=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===startOffset&&0!==startOffset&&this.startWithLF(text)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},start=this._lastChangeBufferPos;for(let i=0;i<lineStarts.length;i++)lineStarts[i]+=startOffset+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(lineStarts.slice(1)),this._buffers[0].buffer+="_"+text,startOffset+=1}else{if(0!==startOffset)for(let i=0;i<lineStarts.length;i++)lineStarts[i]+=startOffset;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(lineStarts.slice(1)),this._buffers[0].buffer+=text}const endOffset=this._buffers[0].buffer.length,endIndex=this._buffers[0].lineStarts.length-1,endPos={line:endIndex,column:endOffset-this._buffers[0].lineStarts[endIndex]},newPiece=new Piece(0,start,endPos,this.getLineFeedCnt(0,start,endPos),endOffset-startOffset);return this._lastChangeBufferPos=endPos,[newPiece]}getLineRawContent(lineNumber,endOffset=0){let x=this.root,ret="";const cache=this._searchCache.get2(lineNumber);if(cache){x=cache.node;const prevAccumulatedValue=this.getAccumulatedValue(x,lineNumber-cache.nodeStartLineNumber-1),buffer=this._buffers[x.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);if(cache.nodeStartLineNumber+x.piece.lineFeedCnt!==lineNumber){const accumulatedValue=this.getAccumulatedValue(x,lineNumber-cache.nodeStartLineNumber);return buffer.substring(startOffset+prevAccumulatedValue,startOffset+accumulatedValue-endOffset)}ret=buffer.substring(startOffset+prevAccumulatedValue,startOffset+x.piece.length)}else{let nodeStartOffset=0;const originalLineNumber=lineNumber;for(;x!==rbTreeBase_1.SENTINEL;)if(x.left!==rbTreeBase_1.SENTINEL&&x.lf_left>=lineNumber-1)x=x.left;else{if(x.lf_left+x.piece.lineFeedCnt>lineNumber-1){const prevAccumulatedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-2),accumulatedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-1),buffer=this._buffers[x.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);return nodeStartOffset+=x.size_left,this._searchCache.set({node:x,nodeStartOffset,nodeStartLineNumber:originalLineNumber-(lineNumber-1-x.lf_left)}),buffer.substring(startOffset+prevAccumulatedValue,startOffset+accumulatedValue-endOffset)}if(x.lf_left+x.piece.lineFeedCnt===lineNumber-1){const prevAccumulatedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-2),buffer=this._buffers[x.piece.bufferIndex].buffer,startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);ret=buffer.substring(startOffset+prevAccumulatedValue,startOffset+x.piece.length);break}lineNumber-=x.lf_left+x.piece.lineFeedCnt,nodeStartOffset+=x.size_left+x.piece.length,x=x.right}}for(x=x.next();x!==rbTreeBase_1.SENTINEL;){const buffer=this._buffers[x.piece.bufferIndex].buffer;if(x.piece.lineFeedCnt>0){const accumulatedValue=this.getAccumulatedValue(x,0),startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);return ret+=buffer.substring(startOffset,startOffset+accumulatedValue-endOffset),ret}{const startOffset=this.offsetInBuffer(x.piece.bufferIndex,x.piece.start);ret+=buffer.substr(startOffset,x.piece.length)}x=x.next()}return ret}computeBufferMetadata(){let x=this.root,lfCnt=1,len=0;for(;x!==rbTreeBase_1.SENTINEL;)lfCnt+=x.lf_left+x.piece.lineFeedCnt,len+=x.size_left+x.piece.length,x=x.right;this._lineCnt=lfCnt,this._length=len,this._searchCache.validate(this._length)}getIndexOf(node,accumulatedValue){const piece=node.piece,pos=this.positionInBuffer(node,accumulatedValue),lineCnt=pos.line-piece.start.line;if(this.offsetInBuffer(piece.bufferIndex,piece.end)-this.offsetInBuffer(piece.bufferIndex,piece.start)===accumulatedValue){const realLineCnt=this.getLineFeedCnt(node.piece.bufferIndex,piece.start,pos);if(realLineCnt!==lineCnt)return{index:realLineCnt,remainder:0}}return{index:lineCnt,remainder:pos.column}}getAccumulatedValue(node,index){if(index<0)return 0;const piece=node.piece,lineStarts=this._buffers[piece.bufferIndex].lineStarts,expectedLineStartIndex=piece.start.line+index+1;return expectedLineStartIndex>piece.end.line?lineStarts[piece.end.line]+piece.end.column-lineStarts[piece.start.line]-piece.start.column:lineStarts[expectedLineStartIndex]-lineStarts[piece.start.line]-piece.start.column}deleteNodeTail(node,pos){const piece=node.piece,originalLFCnt=piece.lineFeedCnt,originalEndOffset=this.offsetInBuffer(piece.bufferIndex,piece.end),newEnd=pos,newEndOffset=this.offsetInBuffer(piece.bufferIndex,newEnd),newLineFeedCnt=this.getLineFeedCnt(piece.bufferIndex,piece.start,newEnd),lf_delta=newLineFeedCnt-originalLFCnt,size_delta=newEndOffset-originalEndOffset,newLength=piece.length+size_delta;node.piece=new Piece(piece.bufferIndex,piece.start,newEnd,newLineFeedCnt,newLength),(0,rbTreeBase_1.updateTreeMetadata)(this,node,size_delta,lf_delta)}deleteNodeHead(node,pos){const piece=node.piece,originalLFCnt=piece.lineFeedCnt,originalStartOffset=this.offsetInBuffer(piece.bufferIndex,piece.start),newStart=pos,newLineFeedCnt=this.getLineFeedCnt(piece.bufferIndex,newStart,piece.end),lf_delta=newLineFeedCnt-originalLFCnt,size_delta=originalStartOffset-this.offsetInBuffer(piece.bufferIndex,newStart),newLength=piece.length+size_delta;node.piece=new Piece(piece.bufferIndex,newStart,piece.end,newLineFeedCnt,newLength),(0,rbTreeBase_1.updateTreeMetadata)(this,node,size_delta,lf_delta)}shrinkNode(node,start,end){const piece=node.piece,originalStartPos=piece.start,originalEndPos=piece.end,oldLength=piece.length,oldLFCnt=piece.lineFeedCnt,newEnd=start,newLineFeedCnt=this.getLineFeedCnt(piece.bufferIndex,piece.start,newEnd),newLength=this.offsetInBuffer(piece.bufferIndex,start)-this.offsetInBuffer(piece.bufferIndex,originalStartPos);node.piece=new Piece(piece.bufferIndex,piece.start,newEnd,newLineFeedCnt,newLength),(0,rbTreeBase_1.updateTreeMetadata)(this,node,newLength-oldLength,newLineFeedCnt-oldLFCnt);const newPiece=new Piece(piece.bufferIndex,end,originalEndPos,this.getLineFeedCnt(piece.bufferIndex,end,originalEndPos),this.offsetInBuffer(piece.bufferIndex,originalEndPos)-this.offsetInBuffer(piece.bufferIndex,end)),newNode=this.rbInsertRight(node,newPiece);this.validateCRLFWithPrevNode(newNode)}appendToNode(node,value){this.adjustCarriageReturnFromNext(value,node)&&(value+="\n");const hitCRLF=this.shouldCheckCRLF()&&this.startWithLF(value)&&this.endWithCR(node),startOffset=this._buffers[0].buffer.length;this._buffers[0].buffer+=value;const lineStarts=createLineStartsFast(value,!1);for(let i=0;i<lineStarts.length;i++)lineStarts[i]+=startOffset;if(hitCRLF){const prevStartOffset=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:startOffset-prevStartOffset}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(lineStarts.slice(1));const endIndex=this._buffers[0].lineStarts.length-1,newEnd={line:endIndex,column:this._buffers[0].buffer.length-this._buffers[0].lineStarts[endIndex]},newLength=node.piece.length+value.length,oldLineFeedCnt=node.piece.lineFeedCnt,newLineFeedCnt=this.getLineFeedCnt(0,node.piece.start,newEnd),lf_delta=newLineFeedCnt-oldLineFeedCnt;node.piece=new Piece(node.piece.bufferIndex,node.piece.start,newEnd,newLineFeedCnt,newLength),this._lastChangeBufferPos=newEnd,(0,rbTreeBase_1.updateTreeMetadata)(this,node,value.length,lf_delta)}nodeAt(offset){let x=this.root;const cache=this._searchCache.get(offset);if(cache)return{node:cache.node,nodeStartOffset:cache.nodeStartOffset,remainder:offset-cache.nodeStartOffset};let nodeStartOffset=0;for(;x!==rbTreeBase_1.SENTINEL;)if(x.size_left>offset)x=x.left;else{if(x.size_left+x.piece.length>=offset){nodeStartOffset+=x.size_left;const ret={node:x,remainder:offset-x.size_left,nodeStartOffset};return this._searchCache.set(ret),ret}offset-=x.size_left+x.piece.length,nodeStartOffset+=x.size_left+x.piece.length,x=x.right}return null}nodeAt2(lineNumber,column){let x=this.root,nodeStartOffset=0;for(;x!==rbTreeBase_1.SENTINEL;)if(x.left!==rbTreeBase_1.SENTINEL&&x.lf_left>=lineNumber-1)x=x.left;else{if(x.lf_left+x.piece.lineFeedCnt>lineNumber-1){const prevAccumualtedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-2),accumulatedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-1);return nodeStartOffset+=x.size_left,{node:x,remainder:Math.min(prevAccumualtedValue+column-1,accumulatedValue),nodeStartOffset}}if(x.lf_left+x.piece.lineFeedCnt===lineNumber-1){const prevAccumualtedValue=this.getAccumulatedValue(x,lineNumber-x.lf_left-2);if(prevAccumualtedValue+column-1<=x.piece.length)return{node:x,remainder:prevAccumualtedValue+column-1,nodeStartOffset};column-=x.piece.length-prevAccumualtedValue;break}lineNumber-=x.lf_left+x.piece.lineFeedCnt,nodeStartOffset+=x.size_left+x.piece.length,x=x.right}for(x=x.next();x!==rbTreeBase_1.SENTINEL;){if(x.piece.lineFeedCnt>0){const accumulatedValue=this.getAccumulatedValue(x,0),nodeStartOffset=this.offsetOfNode(x);return{node:x,remainder:Math.min(column-1,accumulatedValue),nodeStartOffset}}if(x.piece.length>=column-1){return{node:x,remainder:column-1,nodeStartOffset:this.offsetOfNode(x)}}column-=x.piece.length,x=x.next()}return null}nodeCharCodeAt(node,offset){if(node.piece.lineFeedCnt<1)return-1;const buffer=this._buffers[node.piece.bufferIndex],newOffset=this.offsetInBuffer(node.piece.bufferIndex,node.piece.start)+offset;return buffer.buffer.charCodeAt(newOffset)}offsetOfNode(node){if(!node)return 0;let pos=node.size_left;for(;node!==this.root;)node.parent.right===node&&(pos+=node.parent.size_left+node.parent.piece.length),node=node.parent;return pos}shouldCheckCRLF(){return!(this._EOLNormalized&&"\n"===this._EOL)}startWithLF(val){if("string"==typeof val)return 10===val.charCodeAt(0);if(val===rbTreeBase_1.SENTINEL||0===val.piece.lineFeedCnt)return!1;const piece=val.piece,lineStarts=this._buffers[piece.bufferIndex].lineStarts,line=piece.start.line,startOffset=lineStarts[line]+piece.start.column;if(line===lineStarts.length-1)return!1;return!(lineStarts[line+1]>startOffset+1)&&10===this._buffers[piece.bufferIndex].buffer.charCodeAt(startOffset)}endWithCR(val){return"string"==typeof val?13===val.charCodeAt(val.length-1):val!==rbTreeBase_1.SENTINEL&&0!==val.piece.lineFeedCnt&&13===this.nodeCharCodeAt(val,val.piece.length-1)}validateCRLFWithPrevNode(nextNode){if(this.shouldCheckCRLF()&&this.startWithLF(nextNode)){const node=nextNode.prev();this.endWithCR(node)&&this.fixCRLF(node,nextNode)}}validateCRLFWithNextNode(node){if(this.shouldCheckCRLF()&&this.endWithCR(node)){const nextNode=node.next();this.startWithLF(nextNode)&&this.fixCRLF(node,nextNode)}}fixCRLF(prev,next){const nodesToDel=[],lineStarts=this._buffers[prev.piece.bufferIndex].lineStarts;let newEnd;newEnd=0===prev.piece.end.column?{line:prev.piece.end.line-1,column:lineStarts[prev.piece.end.line]-lineStarts[prev.piece.end.line-1]-1}:{line:prev.piece.end.line,column:prev.piece.end.column-1};const prevNewLength=prev.piece.length-1,prevNewLFCnt=prev.piece.lineFeedCnt-1;prev.piece=new Piece(prev.piece.bufferIndex,prev.piece.start,newEnd,prevNewLFCnt,prevNewLength),(0,rbTreeBase_1.updateTreeMetadata)(this,prev,-1,-1),0===prev.piece.length&&nodesToDel.push(prev);const newStart={line:next.piece.start.line+1,column:0},newLength=next.piece.length-1,newLineFeedCnt=this.getLineFeedCnt(next.piece.bufferIndex,newStart,next.piece.end);next.piece=new Piece(next.piece.bufferIndex,newStart,next.piece.end,newLineFeedCnt,newLength),(0,rbTreeBase_1.updateTreeMetadata)(this,next,-1,-1),0===next.piece.length&&nodesToDel.push(next);const pieces=this.createNewPieces("\r\n");this.rbInsertRight(prev,pieces[0]);for(let i=0;i<nodesToDel.length;i++)(0,rbTreeBase_1.rbDelete)(this,nodesToDel[i])}adjustCarriageReturnFromNext(value,node){if(this.shouldCheckCRLF()&&this.endWithCR(value)){const nextNode=node.next();if(this.startWithLF(nextNode)){if(value+="\n",1===nextNode.piece.length)(0,rbTreeBase_1.rbDelete)(this,nextNode);else{const piece=nextNode.piece,newStart={line:piece.start.line+1,column:0},newLength=piece.length-1,newLineFeedCnt=this.getLineFeedCnt(piece.bufferIndex,newStart,piece.end);nextNode.piece=new Piece(piece.bufferIndex,newStart,piece.end,newLineFeedCnt,newLength),(0,rbTreeBase_1.updateTreeMetadata)(this,nextNode,-1,-1)}return!0}}return!1}iterate(node,callback){if(node===rbTreeBase_1.SENTINEL)return callback(rbTreeBase_1.SENTINEL);const leftRet=this.iterate(node.left,callback);return leftRet?callback(node)&&this.iterate(node.right,callback):leftRet}getNodeContent(node){if(node===rbTreeBase_1.SENTINEL)return"";const buffer=this._buffers[node.piece.bufferIndex];let currentContent;const piece=node.piece,startOffset=this.offsetInBuffer(piece.bufferIndex,piece.start),endOffset=this.offsetInBuffer(piece.bufferIndex,piece.end);return currentContent=buffer.buffer.substring(startOffset,endOffset),currentContent}getPieceContent(piece){const buffer=this._buffers[piece.bufferIndex],startOffset=this.offsetInBuffer(piece.bufferIndex,piece.start),endOffset=this.offsetInBuffer(piece.bufferIndex,piece.end);return buffer.buffer.substring(startOffset,endOffset)}rbInsertRight(node,p){const z=new rbTreeBase_1.TreeNode(p,1);z.left=rbTreeBase_1.SENTINEL,z.right=rbTreeBase_1.SENTINEL,z.parent=rbTreeBase_1.SENTINEL,z.size_left=0,z.lf_left=0;if(this.root===rbTreeBase_1.SENTINEL)this.root=z,z.color=0;else if(node.right===rbTreeBase_1.SENTINEL)node.right=z,z.parent=node;else{const nextNode=(0,rbTreeBase_1.leftest)(node.right);nextNode.left=z,z.parent=nextNode}return(0,rbTreeBase_1.fixInsert)(this,z),z}rbInsertLeft(node,p){const z=new rbTreeBase_1.TreeNode(p,1);if(z.left=rbTreeBase_1.SENTINEL,z.right=rbTreeBase_1.SENTINEL,z.parent=rbTreeBase_1.SENTINEL,z.size_left=0,z.lf_left=0,this.root===rbTreeBase_1.SENTINEL)this.root=z,z.color=0;else if(node.left===rbTreeBase_1.SENTINEL)node.left=z,z.parent=node;else{const prevNode=(0,rbTreeBase_1.righttest)(node.left);prevNode.right=z,z.parent=prevNode}return(0,rbTreeBase_1.fixInsert)(this,z),z}}})),define(__m[247],__M([1,0,4,8,3,50,246,119,240,2]),(function(require,exports,event_1,strings,range_1,model_1,pieceTreeBase_1,eolCounter_1,textChange_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceTreeTextBuffer=void 0;class PieceTreeTextBuffer extends lifecycle_1.Disposable{constructor(chunks,BOM,eol,containsRTL,containsUnusualLineTerminators,isBasicASCII,eolNormalized){super(),this._onDidChangeContent=this._register(new event_1.Emitter),this._BOM=BOM,this._mightContainNonBasicASCII=!isBasicASCII,this._mightContainRTL=containsRTL,this._mightContainUnusualLineTerminators=containsUnusualLineTerminators,this._pieceTree=new pieceTreeBase_1.PieceTreeBase(chunks,eol,eolNormalized)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(preserveBOM){return this._pieceTree.createSnapshot(preserveBOM?this._BOM:"")}getOffsetAt(lineNumber,column){return this._pieceTree.getOffsetAt(lineNumber,column)}getPositionAt(offset){return this._pieceTree.getPositionAt(offset)}getRangeAt(start,length){const end=start+length,startPosition=this.getPositionAt(start),endPosition=this.getPositionAt(end);return new range_1.Range(startPosition.lineNumber,startPosition.column,endPosition.lineNumber,endPosition.column)}getValueInRange(range,eol=0){if(range.isEmpty())return"";const lineEnding=this._getEndOfLine(eol);return this._pieceTree.getValueInRange(range,lineEnding)}getValueLengthInRange(range,eol=0){if(range.isEmpty())return 0;if(range.startLineNumber===range.endLineNumber)return range.endColumn-range.startColumn;const startOffset=this.getOffsetAt(range.startLineNumber,range.startColumn);return this.getOffsetAt(range.endLineNumber,range.endColumn)-startOffset}getCharacterCountInRange(range,eol=0){if(this._mightContainNonBasicASCII){let result=0;const fromLineNumber=range.startLineNumber,toLineNumber=range.endLineNumber;for(let lineNumber=fromLineNumber;lineNumber<=toLineNumber;lineNumber++){const lineContent=this.getLineContent(lineNumber),fromOffset=lineNumber===fromLineNumber?range.startColumn-1:0,toOffset=lineNumber===toLineNumber?range.endColumn-1:lineContent.length;for(let offset=fromOffset;offset<toOffset;offset++)strings.isHighSurrogate(lineContent.charCodeAt(offset))?(result+=1,offset+=1):result+=1}return result+=this._getEndOfLine(eol).length*(toLineNumber-fromLineNumber),result}return this.getValueLengthInRange(range,eol)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(lineNumber){return this._pieceTree.getLineContent(lineNumber)}getLineCharCode(lineNumber,index){return this._pieceTree.getLineCharCode(lineNumber,index)}getLineLength(lineNumber){return this._pieceTree.getLineLength(lineNumber)}getLineFirstNonWhitespaceColumn(lineNumber){const result=strings.firstNonWhitespaceIndex(this.getLineContent(lineNumber));return-1===result?0:result+1}getLineLastNonWhitespaceColumn(lineNumber){const result=strings.lastNonWhitespaceIndex(this.getLineContent(lineNumber));return-1===result?0:result+2}_getEndOfLine(eol){switch(eol){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(newEOL){this._pieceTree.setEOL(newEOL)}applyEdits(rawOperations,recordTrimAutoWhitespace,computeUndoEdits){let mightContainRTL=this._mightContainRTL,mightContainUnusualLineTerminators=this._mightContainUnusualLineTerminators,mightContainNonBasicASCII=this._mightContainNonBasicASCII,canReduceOperations=!0,operations=[];for(let i=0;i<rawOperations.length;i++){const op=rawOperations[i];canReduceOperations&&op._isTracked&&(canReduceOperations=!1);const validatedRange=op.range;if(op.text){let textMightContainNonBasicASCII=!0;mightContainNonBasicASCII||(textMightContainNonBasicASCII=!strings.isBasicASCII(op.text),mightContainNonBasicASCII=textMightContainNonBasicASCII),!mightContainRTL&&textMightContainNonBasicASCII&&(mightContainRTL=strings.containsRTL(op.text)),!mightContainUnusualLineTerminators&&textMightContainNonBasicASCII&&(mightContainUnusualLineTerminators=strings.containsUnusualLineTerminators(op.text))}let validText="",eolCount=0,firstLineLength=0,lastLineLength=0;if(op.text){let strEOL;[eolCount,firstLineLength,lastLineLength,strEOL]=(0,eolCounter_1.countEOL)(op.text);const bufferEOL=this.getEOL(),expectedStrEOL="\r\n"===bufferEOL?2:1;validText=0===strEOL||strEOL===expectedStrEOL?op.text:op.text.replace(/\r\n|\r|\n/g,bufferEOL)}operations[i]={sortIndex:i,identifier:op.identifier||null,range:validatedRange,rangeOffset:this.getOffsetAt(validatedRange.startLineNumber,validatedRange.startColumn),rangeLength:this.getValueLengthInRange(validatedRange),text:validText,eolCount,firstLineLength,lastLineLength,forceMoveMarkers:Boolean(op.forceMoveMarkers),isAutoWhitespaceEdit:op.isAutoWhitespaceEdit||!1}}operations.sort(PieceTreeTextBuffer._sortOpsAscending);let hasTouchingRanges=!1;for(let i=0,count=operations.length-1;i<count;i++){const rangeEnd=operations[i].range.getEndPosition(),nextRangeStart=operations[i+1].range.getStartPosition();if(nextRangeStart.isBeforeOrEqual(rangeEnd)){if(nextRangeStart.isBefore(rangeEnd))throw new Error("Overlapping ranges are not allowed!");hasTouchingRanges=!0}}canReduceOperations&&(operations=this._reduceOperations(operations));const reverseRanges=computeUndoEdits||recordTrimAutoWhitespace?PieceTreeTextBuffer._getInverseEditRanges(operations):[],newTrimAutoWhitespaceCandidates=[];if(recordTrimAutoWhitespace)for(let i=0;i<operations.length;i++){const op=operations[i],reverseRange=reverseRanges[i];if(op.isAutoWhitespaceEdit&&op.range.isEmpty())for(let lineNumber=reverseRange.startLineNumber;lineNumber<=reverseRange.endLineNumber;lineNumber++){let currentLineContent="";lineNumber===reverseRange.startLineNumber&&(currentLineContent=this.getLineContent(op.range.startLineNumber),-1!==strings.firstNonWhitespaceIndex(currentLineContent))||newTrimAutoWhitespaceCandidates.push({lineNumber,oldContent:currentLineContent})}}let reverseOperations=null;if(computeUndoEdits){let reverseRangeDeltaOffset=0;reverseOperations=[];for(let i=0;i<operations.length;i++){const op=operations[i],reverseRange=reverseRanges[i],bufferText=this.getValueInRange(op.range),reverseRangeOffset=op.rangeOffset+reverseRangeDeltaOffset;reverseRangeDeltaOffset+=op.text.length-bufferText.length,reverseOperations[i]={sortIndex:op.sortIndex,identifier:op.identifier,range:reverseRange,text:bufferText,textChange:new textChange_1.TextChange(op.rangeOffset,bufferText,reverseRangeOffset,op.text)}}hasTouchingRanges||reverseOperations.sort(((a,b)=>a.sortIndex-b.sortIndex))}this._mightContainRTL=mightContainRTL,this._mightContainUnusualLineTerminators=mightContainUnusualLineTerminators,this._mightContainNonBasicASCII=mightContainNonBasicASCII;const contentChanges=this._doApplyEdits(operations);let trimAutoWhitespaceLineNumbers=null;if(recordTrimAutoWhitespace&&newTrimAutoWhitespaceCandidates.length>0){newTrimAutoWhitespaceCandidates.sort(((a,b)=>b.lineNumber-a.lineNumber)),trimAutoWhitespaceLineNumbers=[];for(let i=0,len=newTrimAutoWhitespaceCandidates.length;i<len;i++){const lineNumber=newTrimAutoWhitespaceCandidates[i].lineNumber;if(i>0&&newTrimAutoWhitespaceCandidates[i-1].lineNumber===lineNumber)continue;const prevContent=newTrimAutoWhitespaceCandidates[i].oldContent,lineContent=this.getLineContent(lineNumber);0!==lineContent.length&&lineContent!==prevContent&&-1===strings.firstNonWhitespaceIndex(lineContent)&&trimAutoWhitespaceLineNumbers.push(lineNumber)}}return this._onDidChangeContent.fire(),new model_1.ApplyEditsResult(reverseOperations,contentChanges,trimAutoWhitespaceLineNumbers)}_reduceOperations(operations){return operations.length<1e3?operations:[this._toSingleEditOperation(operations)]}_toSingleEditOperation(operations){let forceMoveMarkers=!1;const firstEditRange=operations[0].range,lastEditRange=operations[operations.length-1].range,entireEditRange=new range_1.Range(firstEditRange.startLineNumber,firstEditRange.startColumn,lastEditRange.endLineNumber,lastEditRange.endColumn);let lastEndLineNumber=firstEditRange.startLineNumber,lastEndColumn=firstEditRange.startColumn;const result=[];for(let i=0,len=operations.length;i<len;i++){const operation=operations[i],range=operation.range;forceMoveMarkers=forceMoveMarkers||operation.forceMoveMarkers,result.push(this.getValueInRange(new range_1.Range(lastEndLineNumber,lastEndColumn,range.startLineNumber,range.startColumn))),operation.text.length>0&&result.push(operation.text),lastEndLineNumber=range.endLineNumber,lastEndColumn=range.endColumn}const text=result.join(""),[eolCount,firstLineLength,lastLineLength]=(0,eolCounter_1.countEOL)(text);return{sortIndex:0,identifier:operations[0].identifier,range:entireEditRange,rangeOffset:this.getOffsetAt(entireEditRange.startLineNumber,entireEditRange.startColumn),rangeLength:this.getValueLengthInRange(entireEditRange,0),text,eolCount,firstLineLength,lastLineLength,forceMoveMarkers,isAutoWhitespaceEdit:!1}}_doApplyEdits(operations){operations.sort(PieceTreeTextBuffer._sortOpsDescending);const contentChanges=[];for(let i=0;i<operations.length;i++){const op=operations[i],startLineNumber=op.range.startLineNumber,startColumn=op.range.startColumn,endLineNumber=op.range.endLineNumber,endColumn=op.range.endColumn;if(startLineNumber===endLineNumber&&startColumn===endColumn&&0===op.text.length)continue;op.text?(this._pieceTree.delete(op.rangeOffset,op.rangeLength),this._pieceTree.insert(op.rangeOffset,op.text,!0)):this._pieceTree.delete(op.rangeOffset,op.rangeLength);const contentChangeRange=new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn);contentChanges.push({range:contentChangeRange,rangeLength:op.rangeLength,text:op.text,rangeOffset:op.rangeOffset,forceMoveMarkers:op.forceMoveMarkers})}return contentChanges}findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount){return this._pieceTree.findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount)}static _getInverseEditRanges(operations){const result=[];let prevOpEndLineNumber=0,prevOpEndColumn=0,prevOp=null;for(let i=0,len=operations.length;i<len;i++){const op=operations[i];let startLineNumber,startColumn,resultRange;if(prevOp?prevOp.range.endLineNumber===op.range.startLineNumber?(startLineNumber=prevOpEndLineNumber,startColumn=prevOpEndColumn+(op.range.startColumn-prevOp.range.endColumn)):(startLineNumber=prevOpEndLineNumber+(op.range.startLineNumber-prevOp.range.endLineNumber),startColumn=op.range.startColumn):(startLineNumber=op.range.startLineNumber,startColumn=op.range.startColumn),op.text.length>0){const lineCount=op.eolCount+1;resultRange=1===lineCount?new range_1.Range(startLineNumber,startColumn,startLineNumber,startColumn+op.firstLineLength):new range_1.Range(startLineNumber,startColumn,startLineNumber+lineCount-1,op.lastLineLength+1)}else resultRange=new range_1.Range(startLineNumber,startColumn,startLineNumber,startColumn);prevOpEndLineNumber=resultRange.endLineNumber,prevOpEndColumn=resultRange.endColumn,result.push(resultRange),prevOp=op}return result}static _sortOpsAscending(a,b){const r=range_1.Range.compareRangesUsingEnds(a.range,b.range);return 0===r?a.sortIndex-b.sortIndex:r}static _sortOpsDescending(a,b){const r=range_1.Range.compareRangesUsingEnds(a.range,b.range);return 0===r?b.sortIndex-a.sortIndex:-r}}exports.PieceTreeTextBuffer=PieceTreeTextBuffer})),define(__m[429],__M([1,0,8,246,247]),(function(require,exports,strings,pieceTreeBase_1,pieceTreeTextBuffer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceTreeTextBufferBuilder=exports.PieceTreeTextBufferFactory=void 0;class PieceTreeTextBufferFactory{constructor(_chunks,_bom,_cr,_lf,_crlf,_containsRTL,_containsUnusualLineTerminators,_isBasicASCII,_normalizeEOL){this._chunks=_chunks,this._bom=_bom,this._cr=_cr,this._lf=_lf,this._crlf=_crlf,this._containsRTL=_containsRTL,this._containsUnusualLineTerminators=_containsUnusualLineTerminators,this._isBasicASCII=_isBasicASCII,this._normalizeEOL=_normalizeEOL}_getEOL(defaultEOL){const totalEOLCount=this._cr+this._lf+this._crlf,totalCRCount=this._cr+this._crlf;return 0===totalEOLCount?1===defaultEOL?"\n":"\r\n":totalCRCount>totalEOLCount/2?"\r\n":"\n"}create(defaultEOL){const eol=this._getEOL(defaultEOL),chunks=this._chunks;if(this._normalizeEOL&&("\r\n"===eol&&(this._cr>0||this._lf>0)||"\n"===eol&&(this._cr>0||this._crlf>0)))for(let i=0,len=chunks.length;i<len;i++){const str=chunks[i].buffer.replace(/\r\n|\r|\n/g,eol),newLineStart=(0,pieceTreeBase_1.createLineStartsFast)(str);chunks[i]=new pieceTreeBase_1.StringBuffer(str,newLineStart)}const textBuffer=new pieceTreeTextBuffer_1.PieceTreeTextBuffer(chunks,this._bom,eol,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer,disposable:textBuffer}}}exports.PieceTreeTextBufferFactory=PieceTreeTextBufferFactory;exports.PieceTreeTextBufferBuilder=class PieceTreeTextBufferBuilder{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(chunk){if(0===chunk.length)return;0===this.chunks.length&&strings.startsWithUTF8BOM(chunk)&&(this.BOM=strings.UTF8_BOM_CHARACTER,chunk=chunk.substr(1));const lastChar=chunk.charCodeAt(chunk.length-1);13===lastChar||lastChar>=55296&&lastChar<=56319?(this._acceptChunk1(chunk.substr(0,chunk.length-1),!1),this._hasPreviousChar=!0,this._previousChar=lastChar):(this._acceptChunk1(chunk,!1),this._hasPreviousChar=!1,this._previousChar=lastChar)}_acceptChunk1(chunk,allowEmptyStrings){(allowEmptyStrings||0!==chunk.length)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+chunk):this._acceptChunk2(chunk))}_acceptChunk2(chunk){const lineStarts=(0,pieceTreeBase_1.createLineStarts)(this._tmpLineStarts,chunk);this.chunks.push(new pieceTreeBase_1.StringBuffer(chunk,lineStarts.lineStarts)),this.cr+=lineStarts.cr,this.lf+=lineStarts.lf,this.crlf+=lineStarts.crlf,this.isBasicASCII&&(this.isBasicASCII=lineStarts.isBasicASCII),this.isBasicASCII||this.containsRTL||(this.containsRTL=strings.containsRTL(chunk)),this.isBasicASCII||this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=strings.containsUnusualLineTerminators(chunk))}finish(normalizeEOL=!0){return this._finish(),new PieceTreeTextBufferFactory(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,normalizeEOL)}_finish(){if(0===this.chunks.length&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const lastChunk=this.chunks[this.chunks.length-1];lastChunk.buffer+=String.fromCharCode(this._previousChar);const newLineStarts=(0,pieceTreeBase_1.createLineStartsFast)(lastChunk.buffer);lastChunk.lineStarts=newLineStarts,13===this._previousChar&&this.cr++}}}})),define(__m[184],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeIndentLevel=void 0,exports.computeIndentLevel=function computeIndentLevel(line,tabSize){let indent=0,i=0;const len=line.length;for(;i<len;){const chCode=line.charCodeAt(i);if(32===chCode)indent++;else{if(9!==chCode)break;indent=indent-indent%tabSize+tabSize}i++}return i===len?-1:indent}})),define(__m[248],__M([1,0,19,11,50]),(function(require,exports,types_1,position_1,model_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutputPosition=exports.InjectedText=exports.ModelLineProjectionData=void 0;function hasRightCursorStop(cursorStop){return null==cursorStop||(cursorStop===model_1.InjectedTextCursorStops.Right||cursorStop===model_1.InjectedTextCursorStops.Both)}function hasLeftCursorStop(cursorStop){return null==cursorStop||(cursorStop===model_1.InjectedTextCursorStops.Left||cursorStop===model_1.InjectedTextCursorStops.Both)}exports.ModelLineProjectionData=class ModelLineProjectionData{constructor(injectionOffsets,injectionOptions,breakOffsets,breakOffsetsVisibleColumn,wrappedTextIndentLength){this.injectionOffsets=injectionOffsets,this.injectionOptions=injectionOptions,this.breakOffsets=breakOffsets,this.breakOffsetsVisibleColumn=breakOffsetsVisibleColumn,this.wrappedTextIndentLength=wrappedTextIndentLength}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(outputLineIndex){return outputLineIndex>0?this.wrappedTextIndentLength:0}getLineLength(outputLineIndex){const startOffset=outputLineIndex>0?this.breakOffsets[outputLineIndex-1]:0;let lineLength=this.breakOffsets[outputLineIndex]-startOffset;return outputLineIndex>0&&(lineLength+=this.wrappedTextIndentLength),lineLength}getMaxOutputOffset(outputLineIndex){return this.getLineLength(outputLineIndex)}translateToInputOffset(outputLineIndex,outputOffset){outputLineIndex>0&&(outputOffset=Math.max(0,outputOffset-this.wrappedTextIndentLength));let offsetInInput=0===outputLineIndex?outputOffset:this.breakOffsets[outputLineIndex-1]+outputOffset;if(null!==this.injectionOffsets)for(let i=0;i<this.injectionOffsets.length&&offsetInInput>this.injectionOffsets[i];i++)offsetInInput<this.injectionOffsets[i]+this.injectionOptions[i].content.length?offsetInInput=this.injectionOffsets[i]:offsetInInput-=this.injectionOptions[i].content.length;return offsetInInput}translateToOutputPosition(inputOffset,affinity=2){let inputOffsetInInputWithInjection=inputOffset;if(null!==this.injectionOffsets)for(let i=0;i<this.injectionOffsets.length&&!(inputOffset<this.injectionOffsets[i])&&(1===affinity||inputOffset!==this.injectionOffsets[i]);i++)inputOffsetInInputWithInjection+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(inputOffsetInInputWithInjection,affinity)}offsetInInputWithInjectionsToOutputPosition(offsetInInputWithInjections,affinity=2){let low=0,high=this.breakOffsets.length-1,mid=0,midStart=0;for(;low<=high;){mid=low+(high-low)/2|0;const midStop=this.breakOffsets[mid];if(midStart=mid>0?this.breakOffsets[mid-1]:0,0===affinity)if(offsetInInputWithInjections<=midStart)high=mid-1;else{if(!(offsetInInputWithInjections>midStop))break;low=mid+1}else if(offsetInInputWithInjections<midStart)high=mid-1;else{if(!(offsetInInputWithInjections>=midStop))break;low=mid+1}}let outputOffset=offsetInInputWithInjections-midStart;return mid>0&&(outputOffset+=this.wrappedTextIndentLength),new OutputPosition(mid,outputOffset)}normalizeOutputPosition(outputLineIndex,outputOffset,affinity){if(null!==this.injectionOffsets){const offsetInInputWithInjections=this.outputPositionToOffsetInInputWithInjections(outputLineIndex,outputOffset),normalizedOffsetInUnwrappedLine=this.normalizeOffsetInInputWithInjectionsAroundInjections(offsetInInputWithInjections,affinity);if(normalizedOffsetInUnwrappedLine!==offsetInInputWithInjections)return this.offsetInInputWithInjectionsToOutputPosition(normalizedOffsetInUnwrappedLine,affinity)}if(0===affinity){if(outputLineIndex>0&&outputOffset===this.getMinOutputOffset(outputLineIndex))return new OutputPosition(outputLineIndex-1,this.getMaxOutputOffset(outputLineIndex-1))}else if(1===affinity){if(outputLineIndex<this.getOutputLineCount()-1&&outputOffset===this.getMaxOutputOffset(outputLineIndex))return new OutputPosition(outputLineIndex+1,this.getMinOutputOffset(outputLineIndex+1))}return new OutputPosition(outputLineIndex,outputOffset)}outputPositionToOffsetInInputWithInjections(outputLineIndex,outputOffset){outputLineIndex>0&&(outputOffset=Math.max(0,outputOffset-this.wrappedTextIndentLength));return(outputLineIndex>0?this.breakOffsets[outputLineIndex-1]:0)+outputOffset}normalizeOffsetInInputWithInjectionsAroundInjections(offsetInInputWithInjections,affinity){const injectedText=this.getInjectedTextAtOffset(offsetInInputWithInjections);if(!injectedText)return offsetInInputWithInjections;if(2===affinity){if(offsetInInputWithInjections===injectedText.offsetInInputWithInjections+injectedText.length&&hasRightCursorStop(this.injectionOptions[injectedText.injectedTextIndex].cursorStops))return injectedText.offsetInInputWithInjections+injectedText.length;{let result=injectedText.offsetInInputWithInjections;if(hasLeftCursorStop(this.injectionOptions[injectedText.injectedTextIndex].cursorStops))return result;let index=injectedText.injectedTextIndex-1;for(;index>=0&&this.injectionOffsets[index]===this.injectionOffsets[injectedText.injectedTextIndex]&&!hasRightCursorStop(this.injectionOptions[index].cursorStops)&&(result-=this.injectionOptions[index].content.length,!hasLeftCursorStop(this.injectionOptions[index].cursorStops));)index--;return result}}if(1===affinity){let result=injectedText.offsetInInputWithInjections+injectedText.length,index=injectedText.injectedTextIndex;for(;index+1<this.injectionOffsets.length&&this.injectionOffsets[index+1]===this.injectionOffsets[index];)result+=this.injectionOptions[index+1].content.length,index++;return result}if(0===affinity){let result=injectedText.offsetInInputWithInjections,index=injectedText.injectedTextIndex;for(;index-1>=0&&this.injectionOffsets[index-1]===this.injectionOffsets[index];)result-=this.injectionOptions[index-1].content.length,index--;return result}(0,types_1.assertNever)(affinity)}getInjectedText(outputLineIndex,outputOffset){const offset=this.outputPositionToOffsetInInputWithInjections(outputLineIndex,outputOffset),injectedText=this.getInjectedTextAtOffset(offset);return injectedText?{options:this.injectionOptions[injectedText.injectedTextIndex]}:null}getInjectedTextAtOffset(offsetInInputWithInjections){const injectionOffsets=this.injectionOffsets,injectionOptions=this.injectionOptions;if(null!==injectionOffsets){let totalInjectedTextLengthBefore=0;for(let i=0;i<injectionOffsets.length;i++){const length=injectionOptions[i].content.length,injectedTextStartOffsetInInputWithInjections=injectionOffsets[i]+totalInjectedTextLengthBefore,injectedTextEndOffsetInInputWithInjections=injectionOffsets[i]+totalInjectedTextLengthBefore+length;if(injectedTextStartOffsetInInputWithInjections>offsetInInputWithInjections)break;if(offsetInInputWithInjections<=injectedTextEndOffsetInInputWithInjections)return{injectedTextIndex:i,offsetInInputWithInjections:injectedTextStartOffsetInInputWithInjections,length};totalInjectedTextLengthBefore+=length}}}};exports.InjectedText=class InjectedText{constructor(options){this.options=options}};class OutputPosition{constructor(outputLineIndex,outputOffset){this.outputLineIndex=outputLineIndex,this.outputOffset=outputOffset}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(baseLineNumber){return new position_1.Position(baseLineNumber+this.outputLineIndex,this.outputOffset+1)}}exports.OutputPosition=OutputPosition})),define(__m[430],__M([1,0,218,138,45,84,42,8]),(function(require,exports,glob_1,mime_1,network_1,path_1,resources_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMimeTypes=exports.clearPlatformLanguageAssociations=exports.registerPlatformLanguageAssociation=void 0;let registeredAssociations=[],nonUserRegisteredAssociations=[],userRegisteredAssociations=[];function getMimeByPath(path,filename,associations){var _a;let filenameMatch,patternMatch,extensionMatch;for(let i=associations.length-1;i>=0;i--){const association=associations[i];if(filename===association.filenameLowercase){filenameMatch=association;break}if(association.filepattern&&(!patternMatch||association.filepattern.length>patternMatch.filepattern.length)){const target=association.filepatternOnPath?path:filename;(null===(_a=association.filepatternLowercase)||void 0===_a?void 0:_a.call(association,target))&&(patternMatch=association)}association.extension&&(!extensionMatch||association.extension.length>extensionMatch.extension.length)&&filename.endsWith(association.extensionLowercase)&&(extensionMatch=association)}return filenameMatch?filenameMatch.mime:patternMatch?patternMatch.mime:extensionMatch?extensionMatch.mime:void 0}exports.registerPlatformLanguageAssociation=function registerPlatformLanguageAssociation(association,warnOnOverwrite=!1){!function _registerLanguageAssociation(association,userConfigured,warnOnOverwrite){const associationItem=function toLanguageAssociationItem(association,userConfigured){return{id:association.id,mime:association.mime,filename:association.filename,extension:association.extension,filepattern:association.filepattern,firstline:association.firstline,userConfigured,filenameLowercase:association.filename?association.filename.toLowerCase():void 0,extensionLowercase:association.extension?association.extension.toLowerCase():void 0,filepatternLowercase:association.filepattern?(0,glob_1.parse)(association.filepattern.toLowerCase()):void 0,filepatternOnPath:!!association.filepattern&&association.filepattern.indexOf(path_1.posix.sep)>=0}}(association,userConfigured);registeredAssociations.push(associationItem),associationItem.userConfigured?userRegisteredAssociations.push(associationItem):nonUserRegisteredAssociations.push(associationItem);warnOnOverwrite&&!associationItem.userConfigured&&registeredAssociations.forEach((a=>{a.mime===associationItem.mime||a.userConfigured||(associationItem.extension&&a.extension===associationItem.extension&&console.warn(`Overwriting extension <<${associationItem.extension}>> to now point to mime <<${associationItem.mime}>>`),associationItem.filename&&a.filename===associationItem.filename&&console.warn(`Overwriting filename <<${associationItem.filename}>> to now point to mime <<${associationItem.mime}>>`),associationItem.filepattern&&a.filepattern===associationItem.filepattern&&console.warn(`Overwriting filepattern <<${associationItem.filepattern}>> to now point to mime <<${associationItem.mime}>>`),associationItem.firstline&&a.firstline===associationItem.firstline&&console.warn(`Overwriting firstline <<${associationItem.firstline}>> to now point to mime <<${associationItem.mime}>>`))}))}(association,!1,warnOnOverwrite)},exports.clearPlatformLanguageAssociations=function clearPlatformLanguageAssociations(){registeredAssociations=registeredAssociations.filter((a=>a.userConfigured)),nonUserRegisteredAssociations=[]},exports.getMimeTypes=function getMimeTypes(resource,firstLine){let path;if(resource)switch(resource.scheme){case network_1.Schemas.file:path=resource.fsPath;break;case network_1.Schemas.data:path=resources_1.DataUri.parseMetaData(resource).get(resources_1.DataUri.META_DATA_LABEL);break;default:path=resource.path}if(!path)return[mime_1.Mimes.unknown];path=path.toLowerCase();const filename=(0,path_1.basename)(path),configuredLanguage=getMimeByPath(path,filename,userRegisteredAssociations);if(configuredLanguage)return[configuredLanguage,mime_1.Mimes.text];const registeredLanguage=getMimeByPath(path,filename,nonUserRegisteredAssociations);if(registeredLanguage)return[registeredLanguage,mime_1.Mimes.text];if(firstLine){const firstlineLanguage=function getMimeByFirstline(firstLine){(0,strings_1.startsWithUTF8BOM)(firstLine)&&(firstLine=firstLine.substr(1));if(firstLine.length>0)for(let i=registeredAssociations.length-1;i>=0;i--){const association=registeredAssociations[i];if(!association.firstline)continue;const matches=firstLine.match(association.firstline);if(matches&&matches.length>0)return association.mime}return}(firstLine);if(firstlineLanguage)return[firstlineLanguage,mime_1.Mimes.text]}return[mime_1.Mimes.unknown]}})),define(__m[431],__M([1,0,112,16]),(function(require,exports,buffer_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encodeSemanticTokensDto=void 0,exports.encodeSemanticTokensDto=function encodeSemanticTokensDto(semanticTokens){const dest=new Uint32Array(function encodeSemanticTokensDtoSize(semanticTokens){let result=0;if(result+=2,"full"===semanticTokens.type)result+=1+semanticTokens.data.length;else{result+=1,result+=3*semanticTokens.deltas.length;for(const delta of semanticTokens.deltas)delta.data&&(result+=delta.data.length)}return result}(semanticTokens));let offset=0;if(dest[offset++]=semanticTokens.id,"full"===semanticTokens.type)dest[offset++]=1,dest[offset++]=semanticTokens.data.length,dest.set(semanticTokens.data,offset),offset+=semanticTokens.data.length;else{dest[offset++]=2,dest[offset++]=semanticTokens.deltas.length;for(const delta of semanticTokens.deltas)dest[offset++]=delta.start,dest[offset++]=delta.deleteCount,delta.data?(dest[offset++]=delta.data.length,dest.set(delta.data,offset),offset+=delta.data.length):dest[offset++]=0}return function toLittleEndianBuffer(arr){const uint8Arr=new Uint8Array(arr.buffer,arr.byteOffset,4*arr.length);return platform.isLittleEndian()||function reverseEndianness(arr){for(let i=0,len=arr.length;i<len;i+=4){const b0=arr[i+0],b1=arr[i+1],b2=arr[i+2],b3=arr[i+3];arr[i+0]=b3,arr[i+1]=b2,arr[i+2]=b1,arr[i+3]=b0}}(uint8Arr),buffer_1.VSBuffer.wrap(uint8Arr)}(dest)}})),define(__m[249],__M([1,0,3,153,8,19,121]),(function(require,exports,range_1,textModelSearch_1,strings,types_1,wordHelper_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnicodeTextModelHighlighter=void 0;exports.UnicodeTextModelHighlighter=class UnicodeTextModelHighlighter{static computeUnicodeHighlights(model,options,range){const startLine=range?range.startLineNumber:1,endLine=range?range.endLineNumber:model.getLineCount(),codePointHighlighter=new CodePointHighlighter(options),candidates=codePointHighlighter.getCandidateCodePoints();let regex;regex="allNonBasicAscii"===candidates?new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):new RegExp(`${function buildRegExpCharClassExpr(codePoints,flags){return`[${strings.escapeRegExpCharacters(codePoints.map((i=>String.fromCodePoint(i))).join(""))}]`}(Array.from(candidates))}`,"g");const searcher=new textModelSearch_1.Searcher(null,regex),ranges=[];let m,hasMore=!1,ambiguousCharacterCount=0,invisibleCharacterCount=0,nonBasicAsciiCharacterCount=0;forLoop:for(let lineNumber=startLine,lineCount=endLine;lineNumber<=lineCount;lineNumber++){const lineContent=model.getLineContent(lineNumber),lineLength=lineContent.length;searcher.reset(0);do{if(m=searcher.next(lineContent),m){let startIndex=m.index,endIndex=m.index+m[0].length;if(startIndex>0){const charCodeBefore=lineContent.charCodeAt(startIndex-1);strings.isHighSurrogate(charCodeBefore)&&startIndex--}if(endIndex+1<lineLength){const charCodeBefore=lineContent.charCodeAt(endIndex-1);strings.isHighSurrogate(charCodeBefore)&&endIndex++}const str=lineContent.substring(startIndex,endIndex),word=(0,wordHelper_1.getWordAtText)(startIndex+1,wordHelper_1.DEFAULT_WORD_REGEXP,lineContent,0),highlightReason=codePointHighlighter.shouldHighlightNonBasicASCII(str,word?word.word:null);if(0!==highlightReason){3===highlightReason?ambiguousCharacterCount++:2===highlightReason?invisibleCharacterCount++:1===highlightReason?nonBasicAsciiCharacterCount++:(0,types_1.assertNever)(highlightReason);const MAX_RESULT_LENGTH=1e3;if(ranges.length>=MAX_RESULT_LENGTH){hasMore=!0;break forLoop}ranges.push(new range_1.Range(lineNumber,startIndex+1,lineNumber,endIndex+1))}}}while(m)}return{ranges,hasMore,ambiguousCharacterCount,invisibleCharacterCount,nonBasicAsciiCharacterCount}}static computeUnicodeHighlightReason(char,options){const codePointHighlighter=new CodePointHighlighter(options);switch(codePointHighlighter.shouldHighlightNonBasicASCII(char,null)){case 0:return null;case 2:return{kind:1};case 3:{const codePoint=char.codePointAt(0),primaryConfusable=codePointHighlighter.ambiguousCharacters.getPrimaryConfusable(codePoint),notAmbiguousInLocales=strings.AmbiguousCharacters.getLocales().filter((l=>!strings.AmbiguousCharacters.getInstance(new Set([...options.allowedLocales,l])).isAmbiguous(codePoint)));return{kind:0,confusableWith:String.fromCodePoint(primaryConfusable),notAmbiguousInLocales}}case 1:return{kind:2}}}};class CodePointHighlighter{constructor(options){this.options=options,this.allowedCodePoints=new Set(options.allowedCodePoints),this.ambiguousCharacters=strings.AmbiguousCharacters.getInstance(new Set(options.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const set=new Set;if(this.options.invisibleCharacters)for(const cp of strings.InvisibleCharacters.codePoints)isAllowedInvisibleCharacter(String.fromCodePoint(cp))||set.add(cp);if(this.options.ambiguousCharacters)for(const cp of this.ambiguousCharacters.getConfusableCodePoints())set.add(cp);for(const cp of this.allowedCodePoints)set.delete(cp);return set}shouldHighlightNonBasicASCII(character,wordContext){const codePoint=character.codePointAt(0);if(this.allowedCodePoints.has(codePoint))return 0;if(this.options.nonBasicASCII)return 1;let hasBasicASCIICharacters=!1,hasNonConfusableNonBasicAsciiCharacter=!1;if(wordContext)for(let char of wordContext){const codePoint=char.codePointAt(0),isBasicASCII=strings.isBasicASCII(char);hasBasicASCIICharacters=hasBasicASCIICharacters||isBasicASCII,isBasicASCII||this.ambiguousCharacters.isAmbiguous(codePoint)||strings.InvisibleCharacters.isInvisibleCharacter(codePoint)||(hasNonConfusableNonBasicAsciiCharacter=!0)}return!hasBasicASCIICharacters&&hasNonConfusableNonBasicAsciiCharacter?0:this.options.invisibleCharacters&&!isAllowedInvisibleCharacter(character)&&strings.InvisibleCharacters.isInvisibleCharacter(codePoint)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(codePoint)?3:0}}function isAllowedInvisibleCharacter(character){return" "===character||"\n"===character||"\t"===character}})),define(__m[185],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WrappingIndent=exports.TrackedRangeStickiness=exports.TextEditorCursorStyle=exports.TextEditorCursorBlinkingStyle=exports.SymbolTag=exports.SymbolKind=exports.SignatureHelpTriggerKind=exports.SelectionDirection=exports.ScrollbarVisibility=exports.ScrollType=exports.RenderMinimap=exports.RenderLineNumbersType=exports.PositionAffinity=exports.OverviewRulerLane=exports.OverlayWidgetPositionPreference=exports.MouseTargetType=exports.MinimapPosition=exports.MarkerTag=exports.MarkerSeverity=exports.KeyCode=exports.InlineCompletionTriggerKind=exports.InlayHintKind=exports.InjectedTextCursorStops=exports.IndentAction=exports.EndOfLineSequence=exports.EndOfLinePreference=exports.EditorOption=exports.EditorAutoIndentStrategy=exports.DocumentHighlightKind=exports.DefaultEndOfLine=exports.CursorChangeReason=exports.ContentWidgetPositionPreference=exports.CompletionTriggerKind=exports.CompletionItemTag=exports.CompletionItemKind=exports.CompletionItemInsertTextRule=exports.AccessibilitySupport=void 0,function(AccessibilitySupport){AccessibilitySupport[AccessibilitySupport.Unknown=0]="Unknown",AccessibilitySupport[AccessibilitySupport.Disabled=1]="Disabled",AccessibilitySupport[AccessibilitySupport.Enabled=2]="Enabled"}(exports.AccessibilitySupport||(exports.AccessibilitySupport={})),function(CompletionItemInsertTextRule){CompletionItemInsertTextRule[CompletionItemInsertTextRule.KeepWhitespace=1]="KeepWhitespace",CompletionItemInsertTextRule[CompletionItemInsertTextRule.InsertAsSnippet=4]="InsertAsSnippet"}(exports.CompletionItemInsertTextRule||(exports.CompletionItemInsertTextRule={})),function(CompletionItemKind){CompletionItemKind[CompletionItemKind.Method=0]="Method",CompletionItemKind[CompletionItemKind.Function=1]="Function",CompletionItemKind[CompletionItemKind.Constructor=2]="Constructor",CompletionItemKind[CompletionItemKind.Field=3]="Field",CompletionItemKind[CompletionItemKind.Variable=4]="Variable",CompletionItemKind[CompletionItemKind.Class=5]="Class",CompletionItemKind[CompletionItemKind.Struct=6]="Struct",CompletionItemKind[CompletionItemKind.Interface=7]="Interface",CompletionItemKind[CompletionItemKind.Module=8]="Module",CompletionItemKind[CompletionItemKind.Property=9]="Property",CompletionItemKind[CompletionItemKind.Event=10]="Event",CompletionItemKind[CompletionItemKind.Operator=11]="Operator",CompletionItemKind[CompletionItemKind.Unit=12]="Unit",CompletionItemKind[CompletionItemKind.Value=13]="Value",CompletionItemKind[CompletionItemKind.Constant=14]="Constant",CompletionItemKind[CompletionItemKind.Enum=15]="Enum",CompletionItemKind[CompletionItemKind.EnumMember=16]="EnumMember",CompletionItemKind[CompletionItemKind.Keyword=17]="Keyword",CompletionItemKind[CompletionItemKind.Text=18]="Text",CompletionItemKind[CompletionItemKind.Color=19]="Color",CompletionItemKind[CompletionItemKind.File=20]="File",CompletionItemKind[CompletionItemKind.Reference=21]="Reference",CompletionItemKind[CompletionItemKind.Customcolor=22]="Customcolor",CompletionItemKind[CompletionItemKind.Folder=23]="Folder",CompletionItemKind[CompletionItemKind.TypeParameter=24]="TypeParameter",CompletionItemKind[CompletionItemKind.User=25]="User",CompletionItemKind[CompletionItemKind.Issue=26]="Issue",CompletionItemKind[CompletionItemKind.Snippet=27]="Snippet"}(exports.CompletionItemKind||(exports.CompletionItemKind={})),function(CompletionItemTag){CompletionItemTag[CompletionItemTag.Deprecated=1]="Deprecated"}(exports.CompletionItemTag||(exports.CompletionItemTag={})),function(CompletionTriggerKind){CompletionTriggerKind[CompletionTriggerKind.Invoke=0]="Invoke",CompletionTriggerKind[CompletionTriggerKind.TriggerCharacter=1]="TriggerCharacter",CompletionTriggerKind[CompletionTriggerKind.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"}(exports.CompletionTriggerKind||(exports.CompletionTriggerKind={})),function(ContentWidgetPositionPreference){ContentWidgetPositionPreference[ContentWidgetPositionPreference.EXACT=0]="EXACT",ContentWidgetPositionPreference[ContentWidgetPositionPreference.ABOVE=1]="ABOVE",ContentWidgetPositionPreference[ContentWidgetPositionPreference.BELOW=2]="BELOW"}(exports.ContentWidgetPositionPreference||(exports.ContentWidgetPositionPreference={})),function(CursorChangeReason){CursorChangeReason[CursorChangeReason.NotSet=0]="NotSet",CursorChangeReason[CursorChangeReason.ContentFlush=1]="ContentFlush",CursorChangeReason[CursorChangeReason.RecoverFromMarkers=2]="RecoverFromMarkers",CursorChangeReason[CursorChangeReason.Explicit=3]="Explicit",CursorChangeReason[CursorChangeReason.Paste=4]="Paste",CursorChangeReason[CursorChangeReason.Undo=5]="Undo",CursorChangeReason[CursorChangeReason.Redo=6]="Redo"}(exports.CursorChangeReason||(exports.CursorChangeReason={})),function(DefaultEndOfLine){DefaultEndOfLine[DefaultEndOfLine.LF=1]="LF",DefaultEndOfLine[DefaultEndOfLine.CRLF=2]="CRLF"}(exports.DefaultEndOfLine||(exports.DefaultEndOfLine={})),function(DocumentHighlightKind){DocumentHighlightKind[DocumentHighlightKind.Text=0]="Text",DocumentHighlightKind[DocumentHighlightKind.Read=1]="Read",DocumentHighlightKind[DocumentHighlightKind.Write=2]="Write"}(exports.DocumentHighlightKind||(exports.DocumentHighlightKind={})),function(EditorAutoIndentStrategy){EditorAutoIndentStrategy[EditorAutoIndentStrategy.None=0]="None",EditorAutoIndentStrategy[EditorAutoIndentStrategy.Keep=1]="Keep",EditorAutoIndentStrategy[EditorAutoIndentStrategy.Brackets=2]="Brackets",EditorAutoIndentStrategy[EditorAutoIndentStrategy.Advanced=3]="Advanced",EditorAutoIndentStrategy[EditorAutoIndentStrategy.Full=4]="Full"}(exports.EditorAutoIndentStrategy||(exports.EditorAutoIndentStrategy={})),function(EditorOption){EditorOption[EditorOption.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",EditorOption[EditorOption.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",EditorOption[EditorOption.accessibilitySupport=2]="accessibilitySupport",EditorOption[EditorOption.accessibilityPageSize=3]="accessibilityPageSize",EditorOption[EditorOption.ariaLabel=4]="ariaLabel",EditorOption[EditorOption.autoClosingBrackets=5]="autoClosingBrackets",EditorOption[EditorOption.autoClosingDelete=6]="autoClosingDelete",EditorOption[EditorOption.autoClosingOvertype=7]="autoClosingOvertype",EditorOption[EditorOption.autoClosingQuotes=8]="autoClosingQuotes",EditorOption[EditorOption.autoIndent=9]="autoIndent",EditorOption[EditorOption.automaticLayout=10]="automaticLayout",EditorOption[EditorOption.autoSurround=11]="autoSurround",EditorOption[EditorOption.bracketPairColorization=12]="bracketPairColorization",EditorOption[EditorOption.guides=13]="guides",EditorOption[EditorOption.codeLens=14]="codeLens",EditorOption[EditorOption.codeLensFontFamily=15]="codeLensFontFamily",EditorOption[EditorOption.codeLensFontSize=16]="codeLensFontSize",EditorOption[EditorOption.colorDecorators=17]="colorDecorators",EditorOption[EditorOption.columnSelection=18]="columnSelection",EditorOption[EditorOption.comments=19]="comments",EditorOption[EditorOption.contextmenu=20]="contextmenu",EditorOption[EditorOption.copyWithSyntaxHighlighting=21]="copyWithSyntaxHighlighting",EditorOption[EditorOption.cursorBlinking=22]="cursorBlinking",EditorOption[EditorOption.cursorSmoothCaretAnimation=23]="cursorSmoothCaretAnimation",EditorOption[EditorOption.cursorStyle=24]="cursorStyle",EditorOption[EditorOption.cursorSurroundingLines=25]="cursorSurroundingLines",EditorOption[EditorOption.cursorSurroundingLinesStyle=26]="cursorSurroundingLinesStyle",EditorOption[EditorOption.cursorWidth=27]="cursorWidth",EditorOption[EditorOption.disableLayerHinting=28]="disableLayerHinting",EditorOption[EditorOption.disableMonospaceOptimizations=29]="disableMonospaceOptimizations",EditorOption[EditorOption.domReadOnly=30]="domReadOnly",EditorOption[EditorOption.dragAndDrop=31]="dragAndDrop",EditorOption[EditorOption.emptySelectionClipboard=32]="emptySelectionClipboard",EditorOption[EditorOption.extraEditorClassName=33]="extraEditorClassName",EditorOption[EditorOption.fastScrollSensitivity=34]="fastScrollSensitivity",EditorOption[EditorOption.find=35]="find",EditorOption[EditorOption.fixedOverflowWidgets=36]="fixedOverflowWidgets",EditorOption[EditorOption.folding=37]="folding",EditorOption[EditorOption.foldingStrategy=38]="foldingStrategy",EditorOption[EditorOption.foldingHighlight=39]="foldingHighlight",EditorOption[EditorOption.foldingImportsByDefault=40]="foldingImportsByDefault",EditorOption[EditorOption.foldingMaximumRegions=41]="foldingMaximumRegions",EditorOption[EditorOption.unfoldOnClickAfterEndOfLine=42]="unfoldOnClickAfterEndOfLine",EditorOption[EditorOption.fontFamily=43]="fontFamily",EditorOption[EditorOption.fontInfo=44]="fontInfo",EditorOption[EditorOption.fontLigatures=45]="fontLigatures",EditorOption[EditorOption.fontSize=46]="fontSize",EditorOption[EditorOption.fontWeight=47]="fontWeight",EditorOption[EditorOption.formatOnPaste=48]="formatOnPaste",EditorOption[EditorOption.formatOnType=49]="formatOnType",EditorOption[EditorOption.glyphMargin=50]="glyphMargin",EditorOption[EditorOption.gotoLocation=51]="gotoLocation",EditorOption[EditorOption.hideCursorInOverviewRuler=52]="hideCursorInOverviewRuler",EditorOption[EditorOption.hover=53]="hover",EditorOption[EditorOption.inDiffEditor=54]="inDiffEditor",EditorOption[EditorOption.inlineSuggest=55]="inlineSuggest",EditorOption[EditorOption.letterSpacing=56]="letterSpacing",EditorOption[EditorOption.lightbulb=57]="lightbulb",EditorOption[EditorOption.lineDecorationsWidth=58]="lineDecorationsWidth",EditorOption[EditorOption.lineHeight=59]="lineHeight",EditorOption[EditorOption.lineNumbers=60]="lineNumbers",EditorOption[EditorOption.lineNumbersMinChars=61]="lineNumbersMinChars",EditorOption[EditorOption.linkedEditing=62]="linkedEditing",EditorOption[EditorOption.links=63]="links",EditorOption[EditorOption.matchBrackets=64]="matchBrackets",EditorOption[EditorOption.minimap=65]="minimap",EditorOption[EditorOption.mouseStyle=66]="mouseStyle",EditorOption[EditorOption.mouseWheelScrollSensitivity=67]="mouseWheelScrollSensitivity",EditorOption[EditorOption.mouseWheelZoom=68]="mouseWheelZoom",EditorOption[EditorOption.multiCursorMergeOverlapping=69]="multiCursorMergeOverlapping",EditorOption[EditorOption.multiCursorModifier=70]="multiCursorModifier",EditorOption[EditorOption.multiCursorPaste=71]="multiCursorPaste",EditorOption[EditorOption.occurrencesHighlight=72]="occurrencesHighlight",EditorOption[EditorOption.overviewRulerBorder=73]="overviewRulerBorder",EditorOption[EditorOption.overviewRulerLanes=74]="overviewRulerLanes",EditorOption[EditorOption.padding=75]="padding",EditorOption[EditorOption.parameterHints=76]="parameterHints",EditorOption[EditorOption.peekWidgetDefaultFocus=77]="peekWidgetDefaultFocus",EditorOption[EditorOption.definitionLinkOpensInPeek=78]="definitionLinkOpensInPeek",EditorOption[EditorOption.quickSuggestions=79]="quickSuggestions",EditorOption[EditorOption.quickSuggestionsDelay=80]="quickSuggestionsDelay",EditorOption[EditorOption.readOnly=81]="readOnly",EditorOption[EditorOption.renameOnType=82]="renameOnType",EditorOption[EditorOption.renderControlCharacters=83]="renderControlCharacters",EditorOption[EditorOption.renderFinalNewline=84]="renderFinalNewline",EditorOption[EditorOption.renderLineHighlight=85]="renderLineHighlight",EditorOption[EditorOption.renderLineHighlightOnlyWhenFocus=86]="renderLineHighlightOnlyWhenFocus",EditorOption[EditorOption.renderValidationDecorations=87]="renderValidationDecorations",EditorOption[EditorOption.renderWhitespace=88]="renderWhitespace",EditorOption[EditorOption.revealHorizontalRightPadding=89]="revealHorizontalRightPadding",EditorOption[EditorOption.roundedSelection=90]="roundedSelection",EditorOption[EditorOption.rulers=91]="rulers",EditorOption[EditorOption.scrollbar=92]="scrollbar",EditorOption[EditorOption.scrollBeyondLastColumn=93]="scrollBeyondLastColumn",EditorOption[EditorOption.scrollBeyondLastLine=94]="scrollBeyondLastLine",EditorOption[EditorOption.scrollPredominantAxis=95]="scrollPredominantAxis",EditorOption[EditorOption.selectionClipboard=96]="selectionClipboard",EditorOption[EditorOption.selectionHighlight=97]="selectionHighlight",EditorOption[EditorOption.selectOnLineNumbers=98]="selectOnLineNumbers",EditorOption[EditorOption.showFoldingControls=99]="showFoldingControls",EditorOption[EditorOption.showUnused=100]="showUnused",EditorOption[EditorOption.snippetSuggestions=101]="snippetSuggestions",EditorOption[EditorOption.smartSelect=102]="smartSelect",EditorOption[EditorOption.smoothScrolling=103]="smoothScrolling",EditorOption[EditorOption.stickyTabStops=104]="stickyTabStops",EditorOption[EditorOption.stopRenderingLineAfter=105]="stopRenderingLineAfter",EditorOption[EditorOption.suggest=106]="suggest",EditorOption[EditorOption.suggestFontSize=107]="suggestFontSize",EditorOption[EditorOption.suggestLineHeight=108]="suggestLineHeight",EditorOption[EditorOption.suggestOnTriggerCharacters=109]="suggestOnTriggerCharacters",EditorOption[EditorOption.suggestSelection=110]="suggestSelection",EditorOption[EditorOption.tabCompletion=111]="tabCompletion",EditorOption[EditorOption.tabIndex=112]="tabIndex",EditorOption[EditorOption.unicodeHighlighting=113]="unicodeHighlighting",EditorOption[EditorOption.unusualLineTerminators=114]="unusualLineTerminators",EditorOption[EditorOption.useShadowDOM=115]="useShadowDOM",EditorOption[EditorOption.useTabStops=116]="useTabStops",EditorOption[EditorOption.wordSeparators=117]="wordSeparators",EditorOption[EditorOption.wordWrap=118]="wordWrap",EditorOption[EditorOption.wordWrapBreakAfterCharacters=119]="wordWrapBreakAfterCharacters",EditorOption[EditorOption.wordWrapBreakBeforeCharacters=120]="wordWrapBreakBeforeCharacters",EditorOption[EditorOption.wordWrapColumn=121]="wordWrapColumn",EditorOption[EditorOption.wordWrapOverride1=122]="wordWrapOverride1",EditorOption[EditorOption.wordWrapOverride2=123]="wordWrapOverride2",EditorOption[EditorOption.wrappingIndent=124]="wrappingIndent",EditorOption[EditorOption.wrappingStrategy=125]="wrappingStrategy",EditorOption[EditorOption.showDeprecated=126]="showDeprecated",EditorOption[EditorOption.inlayHints=127]="inlayHints",EditorOption[EditorOption.editorClassName=128]="editorClassName",EditorOption[EditorOption.pixelRatio=129]="pixelRatio",EditorOption[EditorOption.tabFocusMode=130]="tabFocusMode",EditorOption[EditorOption.layoutInfo=131]="layoutInfo",EditorOption[EditorOption.wrappingInfo=132]="wrappingInfo"}(exports.EditorOption||(exports.EditorOption={})),function(EndOfLinePreference){EndOfLinePreference[EndOfLinePreference.TextDefined=0]="TextDefined",EndOfLinePreference[EndOfLinePreference.LF=1]="LF",EndOfLinePreference[EndOfLinePreference.CRLF=2]="CRLF"}(exports.EndOfLinePreference||(exports.EndOfLinePreference={})),function(EndOfLineSequence){EndOfLineSequence[EndOfLineSequence.LF=0]="LF",EndOfLineSequence[EndOfLineSequence.CRLF=1]="CRLF"}(exports.EndOfLineSequence||(exports.EndOfLineSequence={})),function(IndentAction){IndentAction[IndentAction.None=0]="None",IndentAction[IndentAction.Indent=1]="Indent",IndentAction[IndentAction.IndentOutdent=2]="IndentOutdent",IndentAction[IndentAction.Outdent=3]="Outdent"}(exports.IndentAction||(exports.IndentAction={})),function(InjectedTextCursorStops){InjectedTextCursorStops[InjectedTextCursorStops.Both=0]="Both",InjectedTextCursorStops[InjectedTextCursorStops.Right=1]="Right",InjectedTextCursorStops[InjectedTextCursorStops.Left=2]="Left",InjectedTextCursorStops[InjectedTextCursorStops.None=3]="None"}(exports.InjectedTextCursorStops||(exports.InjectedTextCursorStops={})),function(InlayHintKind){InlayHintKind[InlayHintKind.Type=1]="Type",InlayHintKind[InlayHintKind.Parameter=2]="Parameter"}(exports.InlayHintKind||(exports.InlayHintKind={})),function(InlineCompletionTriggerKind){InlineCompletionTriggerKind[InlineCompletionTriggerKind.Automatic=0]="Automatic",InlineCompletionTriggerKind[InlineCompletionTriggerKind.Explicit=1]="Explicit"}(exports.InlineCompletionTriggerKind||(exports.InlineCompletionTriggerKind={})),function(KeyCode){KeyCode[KeyCode.DependsOnKbLayout=-1]="DependsOnKbLayout",KeyCode[KeyCode.Unknown=0]="Unknown",KeyCode[KeyCode.Backspace=1]="Backspace",KeyCode[KeyCode.Tab=2]="Tab",KeyCode[KeyCode.Enter=3]="Enter",KeyCode[KeyCode.Shift=4]="Shift",KeyCode[KeyCode.Ctrl=5]="Ctrl",KeyCode[KeyCode.Alt=6]="Alt",KeyCode[KeyCode.PauseBreak=7]="PauseBreak",KeyCode[KeyCode.CapsLock=8]="CapsLock",KeyCode[KeyCode.Escape=9]="Escape",KeyCode[KeyCode.Space=10]="Space",KeyCode[KeyCode.PageUp=11]="PageUp",KeyCode[KeyCode.PageDown=12]="PageDown",KeyCode[KeyCode.End=13]="End",KeyCode[KeyCode.Home=14]="Home",KeyCode[KeyCode.LeftArrow=15]="LeftArrow",KeyCode[KeyCode.UpArrow=16]="UpArrow",KeyCode[KeyCode.RightArrow=17]="RightArrow",KeyCode[KeyCode.DownArrow=18]="DownArrow",KeyCode[KeyCode.Insert=19]="Insert",KeyCode[KeyCode.Delete=20]="Delete",KeyCode[KeyCode.Digit0=21]="Digit0",KeyCode[KeyCode.Digit1=22]="Digit1",KeyCode[KeyCode.Digit2=23]="Digit2",KeyCode[KeyCode.Digit3=24]="Digit3",KeyCode[KeyCode.Digit4=25]="Digit4",KeyCode[KeyCode.Digit5=26]="Digit5",KeyCode[KeyCode.Digit6=27]="Digit6",KeyCode[KeyCode.Digit7=28]="Digit7",KeyCode[KeyCode.Digit8=29]="Digit8",KeyCode[KeyCode.Digit9=30]="Digit9",KeyCode[KeyCode.KeyA=31]="KeyA",KeyCode[KeyCode.KeyB=32]="KeyB",KeyCode[KeyCode.KeyC=33]="KeyC",KeyCode[KeyCode.KeyD=34]="KeyD",KeyCode[KeyCode.KeyE=35]="KeyE",KeyCode[KeyCode.KeyF=36]="KeyF",KeyCode[KeyCode.KeyG=37]="KeyG",KeyCode[KeyCode.KeyH=38]="KeyH",KeyCode[KeyCode.KeyI=39]="KeyI",KeyCode[KeyCode.KeyJ=40]="KeyJ",KeyCode[KeyCode.KeyK=41]="KeyK",KeyCode[KeyCode.KeyL=42]="KeyL",KeyCode[KeyCode.KeyM=43]="KeyM",KeyCode[KeyCode.KeyN=44]="KeyN",KeyCode[KeyCode.KeyO=45]="KeyO",KeyCode[KeyCode.KeyP=46]="KeyP",KeyCode[KeyCode.KeyQ=47]="KeyQ",KeyCode[KeyCode.KeyR=48]="KeyR",KeyCode[KeyCode.KeyS=49]="KeyS",KeyCode[KeyCode.KeyT=50]="KeyT",KeyCode[KeyCode.KeyU=51]="KeyU",KeyCode[KeyCode.KeyV=52]="KeyV",KeyCode[KeyCode.KeyW=53]="KeyW",KeyCode[KeyCode.KeyX=54]="KeyX",KeyCode[KeyCode.KeyY=55]="KeyY",KeyCode[KeyCode.KeyZ=56]="KeyZ",KeyCode[KeyCode.Meta=57]="Meta",KeyCode[KeyCode.ContextMenu=58]="ContextMenu",KeyCode[KeyCode.F1=59]="F1",KeyCode[KeyCode.F2=60]="F2",KeyCode[KeyCode.F3=61]="F3",KeyCode[KeyCode.F4=62]="F4",KeyCode[KeyCode.F5=63]="F5",KeyCode[KeyCode.F6=64]="F6",KeyCode[KeyCode.F7=65]="F7",KeyCode[KeyCode.F8=66]="F8",KeyCode[KeyCode.F9=67]="F9",KeyCode[KeyCode.F10=68]="F10",KeyCode[KeyCode.F11=69]="F11",KeyCode[KeyCode.F12=70]="F12",KeyCode[KeyCode.F13=71]="F13",KeyCode[KeyCode.F14=72]="F14",KeyCode[KeyCode.F15=73]="F15",KeyCode[KeyCode.F16=74]="F16",KeyCode[KeyCode.F17=75]="F17",KeyCode[KeyCode.F18=76]="F18",KeyCode[KeyCode.F19=77]="F19",KeyCode[KeyCode.NumLock=78]="NumLock",KeyCode[KeyCode.ScrollLock=79]="ScrollLock",KeyCode[KeyCode.Semicolon=80]="Semicolon",KeyCode[KeyCode.Equal=81]="Equal",KeyCode[KeyCode.Comma=82]="Comma",KeyCode[KeyCode.Minus=83]="Minus",KeyCode[KeyCode.Period=84]="Period",KeyCode[KeyCode.Slash=85]="Slash",KeyCode[KeyCode.Backquote=86]="Backquote",KeyCode[KeyCode.BracketLeft=87]="BracketLeft",KeyCode[KeyCode.Backslash=88]="Backslash",KeyCode[KeyCode.BracketRight=89]="BracketRight",KeyCode[KeyCode.Quote=90]="Quote",KeyCode[KeyCode.OEM_8=91]="OEM_8",KeyCode[KeyCode.IntlBackslash=92]="IntlBackslash",KeyCode[KeyCode.Numpad0=93]="Numpad0",KeyCode[KeyCode.Numpad1=94]="Numpad1",KeyCode[KeyCode.Numpad2=95]="Numpad2",KeyCode[KeyCode.Numpad3=96]="Numpad3",KeyCode[KeyCode.Numpad4=97]="Numpad4",KeyCode[KeyCode.Numpad5=98]="Numpad5",KeyCode[KeyCode.Numpad6=99]="Numpad6",KeyCode[KeyCode.Numpad7=100]="Numpad7",KeyCode[KeyCode.Numpad8=101]="Numpad8",KeyCode[KeyCode.Numpad9=102]="Numpad9",KeyCode[KeyCode.NumpadMultiply=103]="NumpadMultiply",KeyCode[KeyCode.NumpadAdd=104]="NumpadAdd",KeyCode[KeyCode.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",KeyCode[KeyCode.NumpadSubtract=106]="NumpadSubtract",KeyCode[KeyCode.NumpadDecimal=107]="NumpadDecimal",KeyCode[KeyCode.NumpadDivide=108]="NumpadDivide",KeyCode[KeyCode.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",KeyCode[KeyCode.ABNT_C1=110]="ABNT_C1",KeyCode[KeyCode.ABNT_C2=111]="ABNT_C2",KeyCode[KeyCode.AudioVolumeMute=112]="AudioVolumeMute",KeyCode[KeyCode.AudioVolumeUp=113]="AudioVolumeUp",KeyCode[KeyCode.AudioVolumeDown=114]="AudioVolumeDown",KeyCode[KeyCode.BrowserSearch=115]="BrowserSearch",KeyCode[KeyCode.BrowserHome=116]="BrowserHome",KeyCode[KeyCode.BrowserBack=117]="BrowserBack",KeyCode[KeyCode.BrowserForward=118]="BrowserForward",KeyCode[KeyCode.MediaTrackNext=119]="MediaTrackNext",KeyCode[KeyCode.MediaTrackPrevious=120]="MediaTrackPrevious",KeyCode[KeyCode.MediaStop=121]="MediaStop",KeyCode[KeyCode.MediaPlayPause=122]="MediaPlayPause",KeyCode[KeyCode.LaunchMediaPlayer=123]="LaunchMediaPlayer",KeyCode[KeyCode.LaunchMail=124]="LaunchMail",KeyCode[KeyCode.LaunchApp2=125]="LaunchApp2",KeyCode[KeyCode.Clear=126]="Clear",KeyCode[KeyCode.MAX_VALUE=127]="MAX_VALUE"}(exports.KeyCode||(exports.KeyCode={})),function(MarkerSeverity){MarkerSeverity[MarkerSeverity.Hint=1]="Hint",MarkerSeverity[MarkerSeverity.Info=2]="Info",MarkerSeverity[MarkerSeverity.Warning=4]="Warning",MarkerSeverity[MarkerSeverity.Error=8]="Error"}(exports.MarkerSeverity||(exports.MarkerSeverity={})),function(MarkerTag){MarkerTag[MarkerTag.Unnecessary=1]="Unnecessary",MarkerTag[MarkerTag.Deprecated=2]="Deprecated"}(exports.MarkerTag||(exports.MarkerTag={})),function(MinimapPosition){MinimapPosition[MinimapPosition.Inline=1]="Inline",MinimapPosition[MinimapPosition.Gutter=2]="Gutter"}(exports.MinimapPosition||(exports.MinimapPosition={})),function(MouseTargetType){MouseTargetType[MouseTargetType.UNKNOWN=0]="UNKNOWN",MouseTargetType[MouseTargetType.TEXTAREA=1]="TEXTAREA",MouseTargetType[MouseTargetType.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",MouseTargetType[MouseTargetType.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",MouseTargetType[MouseTargetType.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",MouseTargetType[MouseTargetType.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",MouseTargetType[MouseTargetType.CONTENT_TEXT=6]="CONTENT_TEXT",MouseTargetType[MouseTargetType.CONTENT_EMPTY=7]="CONTENT_EMPTY",MouseTargetType[MouseTargetType.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",MouseTargetType[MouseTargetType.CONTENT_WIDGET=9]="CONTENT_WIDGET",MouseTargetType[MouseTargetType.OVERVIEW_RULER=10]="OVERVIEW_RULER",MouseTargetType[MouseTargetType.SCROLLBAR=11]="SCROLLBAR",MouseTargetType[MouseTargetType.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",MouseTargetType[MouseTargetType.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"}(exports.MouseTargetType||(exports.MouseTargetType={})),function(OverlayWidgetPositionPreference){OverlayWidgetPositionPreference[OverlayWidgetPositionPreference.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",OverlayWidgetPositionPreference[OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",OverlayWidgetPositionPreference[OverlayWidgetPositionPreference.TOP_CENTER=2]="TOP_CENTER"}(exports.OverlayWidgetPositionPreference||(exports.OverlayWidgetPositionPreference={})),function(OverviewRulerLane){OverviewRulerLane[OverviewRulerLane.Left=1]="Left",OverviewRulerLane[OverviewRulerLane.Center=2]="Center",OverviewRulerLane[OverviewRulerLane.Right=4]="Right",OverviewRulerLane[OverviewRulerLane.Full=7]="Full"}(exports.OverviewRulerLane||(exports.OverviewRulerLane={})),function(PositionAffinity){PositionAffinity[PositionAffinity.Left=0]="Left",PositionAffinity[PositionAffinity.Right=1]="Right",PositionAffinity[PositionAffinity.None=2]="None"}(exports.PositionAffinity||(exports.PositionAffinity={})),function(RenderLineNumbersType){RenderLineNumbersType[RenderLineNumbersType.Off=0]="Off",RenderLineNumbersType[RenderLineNumbersType.On=1]="On",RenderLineNumbersType[RenderLineNumbersType.Relative=2]="Relative",RenderLineNumbersType[RenderLineNumbersType.Interval=3]="Interval",RenderLineNumbersType[RenderLineNumbersType.Custom=4]="Custom"}(exports.RenderLineNumbersType||(exports.RenderLineNumbersType={})),function(RenderMinimap){RenderMinimap[RenderMinimap.None=0]="None",RenderMinimap[RenderMinimap.Text=1]="Text",RenderMinimap[RenderMinimap.Blocks=2]="Blocks"}(exports.RenderMinimap||(exports.RenderMinimap={})),function(ScrollType){ScrollType[ScrollType.Smooth=0]="Smooth",ScrollType[ScrollType.Immediate=1]="Immediate"}(exports.ScrollType||(exports.ScrollType={})),function(ScrollbarVisibility){ScrollbarVisibility[ScrollbarVisibility.Auto=1]="Auto",ScrollbarVisibility[ScrollbarVisibility.Hidden=2]="Hidden",ScrollbarVisibility[ScrollbarVisibility.Visible=3]="Visible"}(exports.ScrollbarVisibility||(exports.ScrollbarVisibility={})),function(SelectionDirection){SelectionDirection[SelectionDirection.LTR=0]="LTR",SelectionDirection[SelectionDirection.RTL=1]="RTL"}(exports.SelectionDirection||(exports.SelectionDirection={})),function(SignatureHelpTriggerKind){SignatureHelpTriggerKind[SignatureHelpTriggerKind.Invoke=1]="Invoke",SignatureHelpTriggerKind[SignatureHelpTriggerKind.TriggerCharacter=2]="TriggerCharacter",SignatureHelpTriggerKind[SignatureHelpTriggerKind.ContentChange=3]="ContentChange"}(exports.SignatureHelpTriggerKind||(exports.SignatureHelpTriggerKind={})),function(SymbolKind){SymbolKind[SymbolKind.File=0]="File",SymbolKind[SymbolKind.Module=1]="Module",SymbolKind[SymbolKind.Namespace=2]="Namespace",SymbolKind[SymbolKind.Package=3]="Package",SymbolKind[SymbolKind.Class=4]="Class",SymbolKind[SymbolKind.Method=5]="Method",SymbolKind[SymbolKind.Property=6]="Property",SymbolKind[SymbolKind.Field=7]="Field",SymbolKind[SymbolKind.Constructor=8]="Constructor",SymbolKind[SymbolKind.Enum=9]="Enum",SymbolKind[SymbolKind.Interface=10]="Interface",SymbolKind[SymbolKind.Function=11]="Function",SymbolKind[SymbolKind.Variable=12]="Variable",SymbolKind[SymbolKind.Constant=13]="Constant",SymbolKind[SymbolKind.String=14]="String",SymbolKind[SymbolKind.Number=15]="Number",SymbolKind[SymbolKind.Boolean=16]="Boolean",SymbolKind[SymbolKind.Array=17]="Array",SymbolKind[SymbolKind.Object=18]="Object",SymbolKind[SymbolKind.Key=19]="Key",SymbolKind[SymbolKind.Null=20]="Null",SymbolKind[SymbolKind.EnumMember=21]="EnumMember",SymbolKind[SymbolKind.Struct=22]="Struct",SymbolKind[SymbolKind.Event=23]="Event",SymbolKind[SymbolKind.Operator=24]="Operator",SymbolKind[SymbolKind.TypeParameter=25]="TypeParameter"}(exports.SymbolKind||(exports.SymbolKind={})),function(SymbolTag){SymbolTag[SymbolTag.Deprecated=1]="Deprecated"}(exports.SymbolTag||(exports.SymbolTag={})),function(TextEditorCursorBlinkingStyle){TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Hidden=0]="Hidden",TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Blink=1]="Blink",TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Smooth=2]="Smooth",TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Phase=3]="Phase",TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Expand=4]="Expand",TextEditorCursorBlinkingStyle[TextEditorCursorBlinkingStyle.Solid=5]="Solid"}(exports.TextEditorCursorBlinkingStyle||(exports.TextEditorCursorBlinkingStyle={})),function(TextEditorCursorStyle){TextEditorCursorStyle[TextEditorCursorStyle.Line=1]="Line",TextEditorCursorStyle[TextEditorCursorStyle.Block=2]="Block",TextEditorCursorStyle[TextEditorCursorStyle.Underline=3]="Underline",TextEditorCursorStyle[TextEditorCursorStyle.LineThin=4]="LineThin",TextEditorCursorStyle[TextEditorCursorStyle.BlockOutline=5]="BlockOutline",TextEditorCursorStyle[TextEditorCursorStyle.UnderlineThin=6]="UnderlineThin"}(exports.TextEditorCursorStyle||(exports.TextEditorCursorStyle={})),function(TrackedRangeStickiness){TrackedRangeStickiness[TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",TrackedRangeStickiness[TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",TrackedRangeStickiness[TrackedRangeStickiness.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",TrackedRangeStickiness[TrackedRangeStickiness.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"}(exports.TrackedRangeStickiness||(exports.TrackedRangeStickiness={})),function(WrappingIndent){WrappingIndent[WrappingIndent.None=0]="None",WrappingIndent[WrappingIndent.Same=1]="Same",WrappingIndent[WrappingIndent.Indent=2]="Indent",WrappingIndent[WrappingIndent.DeepIndent=3]="DeepIndent"}(exports.WrappingIndent||(exports.WrappingIndent={}))})),define(__m[432],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketPairWithMinIndentationInfo=exports.BracketPairInfo=exports.BracketInfo=void 0;exports.BracketInfo=class BracketInfo{constructor(range,nestingLevel,isInvalid){this.range=range,this.nestingLevel=nestingLevel,this.isInvalid=isInvalid}};class BracketPairInfo{constructor(range,openingBracketRange,closingBracketRange,nestingLevel){this.range=range,this.openingBracketRange=openingBracketRange,this.closingBracketRange=closingBracketRange,this.nestingLevel=nestingLevel}}exports.BracketPairInfo=BracketPairInfo;exports.BracketPairWithMinIndentationInfo=class BracketPairWithMinIndentationInfo extends BracketPairInfo{constructor(range,openingBracketRange,closingBracketRange,nestingLevel,minVisibleColumnIndentation){super(range,openingBracketRange,closingBracketRange,nestingLevel),this.minVisibleColumnIndentation=minVisibleColumnIndentation}}})),define(__m[94],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InternalModelContentChangeEvent=exports.ModelInjectedTextChangedEvent=exports.ModelRawContentChangedEvent=exports.ModelRawEOLChanged=exports.ModelRawLinesInserted=exports.ModelRawLinesDeleted=exports.ModelRawLineChanged=exports.LineInjectedText=exports.ModelRawFlush=void 0;exports.ModelRawFlush=class ModelRawFlush{constructor(){this.changeType=1}};class LineInjectedText{constructor(ownerId,lineNumber,column,options,order){this.ownerId=ownerId,this.lineNumber=lineNumber,this.column=column,this.options=options,this.order=order}static applyInjectedText(lineText,injectedTexts){if(!injectedTexts||0===injectedTexts.length)return lineText;let result="",lastOriginalOffset=0;for(const injectedText of injectedTexts)result+=lineText.substring(lastOriginalOffset,injectedText.column-1),lastOriginalOffset=injectedText.column-1,result+=injectedText.options.content;return result+=lineText.substring(lastOriginalOffset),result}static fromDecorations(decorations){const result=[];for(const decoration of decorations)decoration.options.before&&decoration.options.before.content.length>0&&result.push(new LineInjectedText(decoration.ownerId,decoration.range.startLineNumber,decoration.range.startColumn,decoration.options.before,0)),decoration.options.after&&decoration.options.after.content.length>0&&result.push(new LineInjectedText(decoration.ownerId,decoration.range.endLineNumber,decoration.range.endColumn,decoration.options.after,1));return result.sort(((a,b)=>a.lineNumber===b.lineNumber?a.column===b.column?a.order-b.order:a.column-b.column:a.lineNumber-b.lineNumber)),result}}exports.LineInjectedText=LineInjectedText;exports.ModelRawLineChanged=class ModelRawLineChanged{constructor(lineNumber,detail,injectedText){this.changeType=2,this.lineNumber=lineNumber,this.detail=detail,this.injectedText=injectedText}};exports.ModelRawLinesDeleted=class ModelRawLinesDeleted{constructor(fromLineNumber,toLineNumber){this.changeType=3,this.fromLineNumber=fromLineNumber,this.toLineNumber=toLineNumber}};exports.ModelRawLinesInserted=class ModelRawLinesInserted{constructor(fromLineNumber,toLineNumber,detail,injectedTexts){this.changeType=4,this.injectedTexts=injectedTexts,this.fromLineNumber=fromLineNumber,this.toLineNumber=toLineNumber,this.detail=detail}};exports.ModelRawEOLChanged=class ModelRawEOLChanged{constructor(){this.changeType=5}};class ModelRawContentChangedEvent{constructor(changes,versionId,isUndoing,isRedoing){this.changes=changes,this.versionId=versionId,this.isUndoing=isUndoing,this.isRedoing=isRedoing,this.resultingSelection=null}containsEvent(type){for(let i=0,len=this.changes.length;i<len;i++){if(this.changes[i].changeType===type)return!0}return!1}static merge(a,b){const changes=[].concat(a.changes).concat(b.changes),versionId=b.versionId,isUndoing=a.isUndoing||b.isUndoing,isRedoing=a.isRedoing||b.isRedoing;return new ModelRawContentChangedEvent(changes,versionId,isUndoing,isRedoing)}}exports.ModelRawContentChangedEvent=ModelRawContentChangedEvent;exports.ModelInjectedTextChangedEvent=class ModelInjectedTextChangedEvent{constructor(changes){this.changes=changes}};class InternalModelContentChangeEvent{constructor(rawContentChangedEvent,contentChangedEvent){this.rawContentChangedEvent=rawContentChangedEvent,this.contentChangedEvent=contentChangedEvent}merge(other){const rawContentChangedEvent=ModelRawContentChangedEvent.merge(this.rawContentChangedEvent,other.rawContentChangedEvent),contentChangedEvent=InternalModelContentChangeEvent._mergeChangeEvents(this.contentChangedEvent,other.contentChangedEvent);return new InternalModelContentChangeEvent(rawContentChangedEvent,contentChangedEvent)}static _mergeChangeEvents(a,b){return{changes:[].concat(a.changes).concat(b.changes),eol:b.eol,versionId:b.versionId,isUndoing:a.isUndoing||b.isUndoing,isRedoing:a.isRedoing||b.isRedoing,isFlush:a.isFlush||b.isFlush}}}exports.InternalModelContentChangeEvent=InternalModelContentChangeEvent})),define(__m[186],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndentGuideHorizontalLine=exports.IndentGuide=exports.HorizontalGuidesState=void 0,function(HorizontalGuidesState){HorizontalGuidesState[HorizontalGuidesState.Disabled=0]="Disabled",HorizontalGuidesState[HorizontalGuidesState.EnabledForActive=1]="EnabledForActive",HorizontalGuidesState[HorizontalGuidesState.Enabled=2]="Enabled"}(exports.HorizontalGuidesState||(exports.HorizontalGuidesState={}));exports.IndentGuide=class IndentGuide{constructor(visibleColumn,className,horizontalLine){this.visibleColumn=visibleColumn,this.className=className,this.horizontalLine=horizontalLine}};exports.IndentGuideHorizontalLine=class IndentGuideHorizontalLine{constructor(top,endColumn){this.top=top,this.endColumn=endColumn}}})),define(__m[250],__M([1,0,18,8,70,3,428,184,186]),(function(require,exports,arrays_1,strings,cursorColumns_1,range_1,textModelPart_1,utils_1,textModelGuides_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketPairGuidesClassNames=exports.GuidesTextModelPart=void 0;class GuidesTextModelPart extends textModelPart_1.TextModelPart{constructor(textModel,languageConfigurationService){super(),this.textModel=textModel,this.languageConfigurationService=languageConfigurationService}getLanguageConfiguration(languageId){return this.languageConfigurationService.getLanguageConfiguration(languageId)}_computeIndentLevel(lineIndex){return(0,utils_1.computeIndentLevel)(this.textModel.getLineContent(lineIndex+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(lineNumber,minLineNumber,maxLineNumber){this.assertNotDisposed();const lineCount=this.textModel.getLineCount();if(lineNumber<1||lineNumber>lineCount)throw new Error("Illegal value for lineNumber");const foldingRules=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,offSide=Boolean(foldingRules&&foldingRules.offSide);let up_aboveContentLineIndex=-2,up_aboveContentLineIndent=-1,up_belowContentLineIndex=-2,up_belowContentLineIndent=-1;const up_resolveIndents=lineNumber=>{if(-1!==up_aboveContentLineIndex&&(-2===up_aboveContentLineIndex||up_aboveContentLineIndex>lineNumber-1)){up_aboveContentLineIndex=-1,up_aboveContentLineIndent=-1;for(let lineIndex=lineNumber-2;lineIndex>=0;lineIndex--){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){up_aboveContentLineIndex=lineIndex,up_aboveContentLineIndent=indent;break}}}if(-2===up_belowContentLineIndex){up_belowContentLineIndex=-1,up_belowContentLineIndent=-1;for(let lineIndex=lineNumber;lineIndex<lineCount;lineIndex++){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){up_belowContentLineIndex=lineIndex,up_belowContentLineIndent=indent;break}}}};let down_aboveContentLineIndex=-2,down_aboveContentLineIndent=-1,down_belowContentLineIndex=-2,down_belowContentLineIndent=-1;const down_resolveIndents=lineNumber=>{if(-2===down_aboveContentLineIndex){down_aboveContentLineIndex=-1,down_aboveContentLineIndent=-1;for(let lineIndex=lineNumber-2;lineIndex>=0;lineIndex--){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){down_aboveContentLineIndex=lineIndex,down_aboveContentLineIndent=indent;break}}}if(-1!==down_belowContentLineIndex&&(-2===down_belowContentLineIndex||down_belowContentLineIndex<lineNumber-1)){down_belowContentLineIndex=-1,down_belowContentLineIndent=-1;for(let lineIndex=lineNumber;lineIndex<lineCount;lineIndex++){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){down_belowContentLineIndex=lineIndex,down_belowContentLineIndent=indent;break}}}};let startLineNumber=0,goUp=!0,endLineNumber=0,goDown=!0,indent=0,initialIndent=0;for(let distance=0;goUp||goDown;distance++){const upLineNumber=lineNumber-distance,downLineNumber=lineNumber+distance;distance>1&&(upLineNumber<1||upLineNumber<minLineNumber)&&(goUp=!1),distance>1&&(downLineNumber>lineCount||downLineNumber>maxLineNumber)&&(goDown=!1),distance>5e4&&(goUp=!1,goDown=!1);let upLineIndentLevel=-1;if(goUp&&upLineNumber>=1){const currentIndent=this._computeIndentLevel(upLineNumber-1);currentIndent>=0?(up_belowContentLineIndex=upLineNumber-1,up_belowContentLineIndent=currentIndent,upLineIndentLevel=Math.ceil(currentIndent/this.textModel.getOptions().indentSize)):(up_resolveIndents(upLineNumber),upLineIndentLevel=this._getIndentLevelForWhitespaceLine(offSide,up_aboveContentLineIndent,up_belowContentLineIndent))}let downLineIndentLevel=-1;if(goDown&&downLineNumber<=lineCount){const currentIndent=this._computeIndentLevel(downLineNumber-1);currentIndent>=0?(down_aboveContentLineIndex=downLineNumber-1,down_aboveContentLineIndent=currentIndent,downLineIndentLevel=Math.ceil(currentIndent/this.textModel.getOptions().indentSize)):(down_resolveIndents(downLineNumber),downLineIndentLevel=this._getIndentLevelForWhitespaceLine(offSide,down_aboveContentLineIndent,down_belowContentLineIndent))}if(0!==distance){if(1===distance){if(downLineNumber<=lineCount&&downLineIndentLevel>=0&&initialIndent+1===downLineIndentLevel){goUp=!1,startLineNumber=downLineNumber,endLineNumber=downLineNumber,indent=downLineIndentLevel;continue}if(upLineNumber>=1&&upLineIndentLevel>=0&&upLineIndentLevel-1===initialIndent){goDown=!1,startLineNumber=upLineNumber,endLineNumber=upLineNumber,indent=upLineIndentLevel;continue}if(startLineNumber=lineNumber,endLineNumber=lineNumber,indent=initialIndent,0===indent)return{startLineNumber,endLineNumber,indent}}goUp&&(upLineIndentLevel>=indent?startLineNumber=upLineNumber:goUp=!1),goDown&&(downLineIndentLevel>=indent?endLineNumber=downLineNumber:goDown=!1)}else initialIndent=upLineIndentLevel}return{startLineNumber,endLineNumber,indent}}getLinesBracketGuides(startLineNumber,endLineNumber,activePosition,options){var _a,_b,_c,_d,_e;const result=[],bracketPairs=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new range_1.Range(startLineNumber,1,endLineNumber,this.textModel.getLineMaxColumn(endLineNumber)));let activeBracketPairRange;if(activePosition&&bracketPairs.length>0){const bracketsContainingActivePosition=startLineNumber<=activePosition.lineNumber&&activePosition.lineNumber<=endLineNumber?bracketPairs.filter((bp=>range_1.Range.strictContainsPosition(bp.range,activePosition))):this.textModel.bracketPairs.getBracketPairsInRange(range_1.Range.fromPositions(activePosition));activeBracketPairRange=null===(_a=(0,arrays_1.findLast)(bracketsContainingActivePosition,(i=>i.range.startLineNumber!==i.range.endLineNumber)))||void 0===_a?void 0:_a.range}const queue=new arrays_1.ArrayQueue(bracketPairs),activeGuides=new Array,nextGuides=new Array,colorProvider=new BracketPairGuidesClassNames;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){let guides=new Array;nextGuides.length>0&&(guides=guides.concat(nextGuides),nextGuides.length=0),result.push(guides);for(const pair of queue.takeWhile((b=>b.openingBracketRange.startLineNumber<=lineNumber))||[]){if(pair.range.startLineNumber===pair.range.endLineNumber)continue;const guideVisibleColumn=Math.min(this.getVisibleColumnFromPosition(pair.openingBracketRange.getStartPosition()),this.getVisibleColumnFromPosition(null!==(_c=null===(_b=pair.closingBracketRange)||void 0===_b?void 0:_b.getStartPosition())&&void 0!==_c?_c:pair.range.getEndPosition()),pair.minVisibleColumnIndentation+1);let renderHorizontalEndLineAtTheBottom=!1;if(pair.closingBracketRange){strings.firstNonWhitespaceIndex(this.textModel.getLineContent(pair.closingBracketRange.startLineNumber))<pair.closingBracketRange.startColumn-1&&(renderHorizontalEndLineAtTheBottom=!0)}const start=pair.openingBracketRange.getStartPosition(),end=null!==(_e=null===(_d=pair.closingBracketRange)||void 0===_d?void 0:_d.getStartPosition())&&void 0!==_e?_e:pair.range.getEndPosition();void 0===pair.closingBracketRange?activeGuides[pair.nestingLevel]=null:activeGuides[pair.nestingLevel]={nestingLevel:pair.nestingLevel,guideVisibleColumn,start,visibleStartColumn:this.getVisibleColumnFromPosition(start),end,visibleEndColumn:this.getVisibleColumnFromPosition(end),bracketPair:pair,renderHorizontalEndLineAtTheBottom}}for(const line of activeGuides){if(!line)continue;const isActive=activeBracketPairRange&&line.bracketPair.range.equalsRange(activeBracketPairRange),className=colorProvider.getInlineClassNameOfLevel(line.nestingLevel)+(options.highlightActive&&isActive?" "+colorProvider.activeClassName:"");(isActive&&options.horizontalGuides!==textModelGuides_1.HorizontalGuidesState.Disabled||options.includeInactive&&options.horizontalGuides===textModelGuides_1.HorizontalGuidesState.Enabled)&&(line.start.lineNumber===lineNumber&&line.guideVisibleColumn<line.visibleStartColumn&&guides.push(new textModelGuides_1.IndentGuide(line.guideVisibleColumn,className,new textModelGuides_1.IndentGuideHorizontalLine(!1,line.start.column))),line.end.lineNumber===lineNumber+1&&line.guideVisibleColumn<line.visibleEndColumn&&nextGuides.push(new textModelGuides_1.IndentGuide(line.guideVisibleColumn,className,new textModelGuides_1.IndentGuideHorizontalLine(!line.renderHorizontalEndLineAtTheBottom,line.end.column))))}let lastVisibleColumnCount=Number.MAX_SAFE_INTEGER;for(let i=activeGuides.length-1;i>=0;i--){const line=activeGuides[i];if(!line)continue;const isActive=options.highlightActive&&activeBracketPairRange&&line.bracketPair.range.equalsRange(activeBracketPairRange),className=colorProvider.getInlineClassNameOfLevel(line.nestingLevel)+(isActive?" "+colorProvider.activeClassName:"");(isActive||options.includeInactive)&&line.renderHorizontalEndLineAtTheBottom&&line.end.lineNumber===lineNumber+1&&nextGuides.push(new textModelGuides_1.IndentGuide(line.guideVisibleColumn,className,null)),line.end.lineNumber<=lineNumber||line.start.lineNumber>=lineNumber||(line.guideVisibleColumn>=lastVisibleColumnCount&&!isActive||(lastVisibleColumnCount=line.guideVisibleColumn,(isActive||options.includeInactive)&&guides.push(new textModelGuides_1.IndentGuide(line.guideVisibleColumn,className,null))))}guides.sort(((a,b)=>a.visibleColumn-b.visibleColumn))}return result}getVisibleColumnFromPosition(position){return cursorColumns_1.CursorColumns.visibleColumnFromColumn(this.textModel.getLineContent(position.lineNumber),position.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(startLineNumber,endLineNumber){this.assertNotDisposed();const lineCount=this.textModel.getLineCount();if(startLineNumber<1||startLineNumber>lineCount)throw new Error("Illegal value for startLineNumber");if(endLineNumber<1||endLineNumber>lineCount)throw new Error("Illegal value for endLineNumber");const options=this.textModel.getOptions(),foldingRules=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,offSide=Boolean(foldingRules&&foldingRules.offSide),result=new Array(endLineNumber-startLineNumber+1);let aboveContentLineIndex=-2,aboveContentLineIndent=-1,belowContentLineIndex=-2,belowContentLineIndent=-1;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const resultIndex=lineNumber-startLineNumber,currentIndent=this._computeIndentLevel(lineNumber-1);if(currentIndent>=0)aboveContentLineIndex=lineNumber-1,aboveContentLineIndent=currentIndent,result[resultIndex]=Math.ceil(currentIndent/options.indentSize);else{if(-2===aboveContentLineIndex){aboveContentLineIndex=-1,aboveContentLineIndent=-1;for(let lineIndex=lineNumber-2;lineIndex>=0;lineIndex--){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){aboveContentLineIndex=lineIndex,aboveContentLineIndent=indent;break}}}if(-1!==belowContentLineIndex&&(-2===belowContentLineIndex||belowContentLineIndex<lineNumber-1)){belowContentLineIndex=-1,belowContentLineIndent=-1;for(let lineIndex=lineNumber;lineIndex<lineCount;lineIndex++){const indent=this._computeIndentLevel(lineIndex);if(indent>=0){belowContentLineIndex=lineIndex,belowContentLineIndent=indent;break}}}result[resultIndex]=this._getIndentLevelForWhitespaceLine(offSide,aboveContentLineIndent,belowContentLineIndent)}}return result}_getIndentLevelForWhitespaceLine(offSide,aboveContentLineIndent,belowContentLineIndent){const options=this.textModel.getOptions();return-1===aboveContentLineIndent||-1===belowContentLineIndent?0:aboveContentLineIndent<belowContentLineIndent?1+Math.floor(aboveContentLineIndent/options.indentSize):aboveContentLineIndent===belowContentLineIndent||offSide?Math.ceil(belowContentLineIndent/options.indentSize):1+Math.floor(belowContentLineIndent/options.indentSize)}}exports.GuidesTextModelPart=GuidesTextModelPart;class BracketPairGuidesClassNames{constructor(){this.activeClassName="indent-active"}getInlineClassNameOfLevel(level){return"bracket-indent-guide lvl-"+level%30}}exports.BracketPairGuidesClassNames=BracketPairGuidesClassNames})),define(__m[433],__M([1,0,4,2]),(function(require,exports,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TokenizationRegistry=void 0;exports.TokenizationRegistry=class TokenizationRegistry{constructor(){this._map=new Map,this._factories=new Map,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._colorMap=null}fire(languages){this._onDidChange.fire({changedLanguages:languages,changedColorMap:!1})}register(language,support){return this._map.set(language,support),this.fire([language]),(0,lifecycle_1.toDisposable)((()=>{this._map.get(language)===support&&(this._map.delete(language),this.fire([language]))}))}registerFactory(languageId,factory){var _a;null===(_a=this._factories.get(languageId))||void 0===_a||_a.dispose();const myData=new TokenizationSupportFactoryData(this,languageId,factory);return this._factories.set(languageId,myData),(0,lifecycle_1.toDisposable)((()=>{const v=this._factories.get(languageId);v&&v===myData&&(this._factories.delete(languageId),v.dispose())}))}getOrCreate(languageId){return __awaiter(this,void 0,void 0,(function*(){const tokenizationSupport=this.get(languageId);if(tokenizationSupport)return tokenizationSupport;const factory=this._factories.get(languageId);return!factory||factory.isResolved?null:(yield factory.resolve(),this.get(languageId))}))}get(language){return this._map.get(language)||null}isResolved(languageId){if(this.get(languageId))return!0;const factory=this._factories.get(languageId);return!(factory&&!factory.isResolved)}setColorMap(colorMap){this._colorMap=colorMap,this._onDidChange.fire({changedLanguages:Array.from(this._map.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class TokenizationSupportFactoryData extends lifecycle_1.Disposable{constructor(_registry,_languageId,_factory){super(),this._registry=_registry,this._languageId=_languageId,this._factory=_factory,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}resolve(){return __awaiter(this,void 0,void 0,(function*(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}))}_create(){return __awaiter(this,void 0,void 0,(function*(){const value=yield Promise.resolve(this._factory.createTokenizationSupport());this._isResolved=!0,value&&!this._isDisposed&&this._register(this._registry.register(this._languageId,value))}))}}})),define(__m[27],__M([1,0,25,3,433,28]),(function(require,exports,uri_1,range_1,tokenizationRegistry_1,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TokenizationRegistry=exports.InlayHintKind=exports.Command=exports.FoldingRangeKind=exports.SymbolKinds=exports.isLocationLink=exports.DocumentHighlightKind=exports.SignatureHelpTriggerKind=exports.InlineCompletionTriggerKind=exports.CompletionItemKinds=exports.EncodedTokenizationResult=exports.TokenizationResult=exports.Token=exports.TokenMetadata=void 0;exports.TokenMetadata=class TokenMetadata{static getLanguageId(metadata){return(255&metadata)>>>0}static getTokenType(metadata){return(768&metadata)>>>8}static getFontStyle(metadata){return(15360&metadata)>>>10}static getForeground(metadata){return(8372224&metadata)>>>14}static getBackground(metadata){return(4286578688&metadata)>>>23}static getClassNameFromMetadata(metadata){let className="mtk"+this.getForeground(metadata);const fontStyle=this.getFontStyle(metadata);return 1&fontStyle&&(className+=" mtki"),2&fontStyle&&(className+=" mtkb"),4&fontStyle&&(className+=" mtku"),8&fontStyle&&(className+=" mtks"),className}static getInlineStyleFromMetadata(metadata,colorMap){const foreground=this.getForeground(metadata),fontStyle=this.getFontStyle(metadata);let result=`color: ${colorMap[foreground]};`;1&fontStyle&&(result+="font-style: italic;"),2&fontStyle&&(result+="font-weight: bold;");let textDecoration="";return 4&fontStyle&&(textDecoration+=" underline"),8&fontStyle&&(textDecoration+=" line-through"),textDecoration&&(result+=`text-decoration:${textDecoration};`),result}static getPresentationFromMetadata(metadata){const foreground=this.getForeground(metadata),fontStyle=this.getFontStyle(metadata);return{foreground,italic:Boolean(1&fontStyle),bold:Boolean(2&fontStyle),underline:Boolean(4&fontStyle),strikethrough:Boolean(8&fontStyle)}}};exports.Token=class Token{constructor(offset,type,language){this._tokenBrand=void 0,this.offset=offset,this.type=type,this.language=language}toString(){return"("+this.offset+", "+this.type+")"}};exports.TokenizationResult=class TokenizationResult{constructor(tokens,endState){this._tokenizationResultBrand=void 0,this.tokens=tokens,this.endState=endState}};exports.EncodedTokenizationResult=class EncodedTokenizationResult{constructor(tokens,endState){this._encodedTokenizationResultBrand=void 0,this.tokens=tokens,this.endState=endState}},function(CompletionItemKinds){const byKind=new Map;byKind.set(0,codicons_1.Codicon.symbolMethod),byKind.set(1,codicons_1.Codicon.symbolFunction),byKind.set(2,codicons_1.Codicon.symbolConstructor),byKind.set(3,codicons_1.Codicon.symbolField),byKind.set(4,codicons_1.Codicon.symbolVariable),byKind.set(5,codicons_1.Codicon.symbolClass),byKind.set(6,codicons_1.Codicon.symbolStruct),byKind.set(7,codicons_1.Codicon.symbolInterface),byKind.set(8,codicons_1.Codicon.symbolModule),byKind.set(9,codicons_1.Codicon.symbolProperty),byKind.set(10,codicons_1.Codicon.symbolEvent),byKind.set(11,codicons_1.Codicon.symbolOperator),byKind.set(12,codicons_1.Codicon.symbolUnit),byKind.set(13,codicons_1.Codicon.symbolValue),byKind.set(15,codicons_1.Codicon.symbolEnum),byKind.set(14,codicons_1.Codicon.symbolConstant),byKind.set(15,codicons_1.Codicon.symbolEnum),byKind.set(16,codicons_1.Codicon.symbolEnumMember),byKind.set(17,codicons_1.Codicon.symbolKeyword),byKind.set(27,codicons_1.Codicon.symbolSnippet),byKind.set(18,codicons_1.Codicon.symbolText),byKind.set(19,codicons_1.Codicon.symbolColor),byKind.set(20,codicons_1.Codicon.symbolFile),byKind.set(21,codicons_1.Codicon.symbolReference),byKind.set(22,codicons_1.Codicon.symbolCustomColor),byKind.set(23,codicons_1.Codicon.symbolFolder),byKind.set(24,codicons_1.Codicon.symbolTypeParameter),byKind.set(25,codicons_1.Codicon.account),byKind.set(26,codicons_1.Codicon.issues),CompletionItemKinds.toIcon=function toIcon(kind){let codicon=byKind.get(kind);return codicon||(console.info("No codicon found for CompletionItemKind "+kind),codicon=codicons_1.Codicon.symbolProperty),codicon};const data=new Map;data.set("method",0),data.set("function",1),data.set("constructor",2),data.set("field",3),data.set("variable",4),data.set("class",5),data.set("struct",6),data.set("interface",7),data.set("module",8),data.set("property",9),data.set("event",10),data.set("operator",11),data.set("unit",12),data.set("value",13),data.set("constant",14),data.set("enum",15),data.set("enum-member",16),data.set("enumMember",16),data.set("keyword",17),data.set("snippet",27),data.set("text",18),data.set("color",19),data.set("file",20),data.set("reference",21),data.set("customcolor",22),data.set("folder",23),data.set("type-parameter",24),data.set("typeParameter",24),data.set("account",25),data.set("issue",26),CompletionItemKinds.fromString=function fromString(value,strict){let res=data.get(value);return void 0!==res||strict||(res=9),res}}(exports.CompletionItemKinds||(exports.CompletionItemKinds={})),function(InlineCompletionTriggerKind){InlineCompletionTriggerKind[InlineCompletionTriggerKind.Automatic=0]="Automatic",InlineCompletionTriggerKind[InlineCompletionTriggerKind.Explicit=1]="Explicit"}(exports.InlineCompletionTriggerKind||(exports.InlineCompletionTriggerKind={})),function(SignatureHelpTriggerKind){SignatureHelpTriggerKind[SignatureHelpTriggerKind.Invoke=1]="Invoke",SignatureHelpTriggerKind[SignatureHelpTriggerKind.TriggerCharacter=2]="TriggerCharacter",SignatureHelpTriggerKind[SignatureHelpTriggerKind.ContentChange=3]="ContentChange"}(exports.SignatureHelpTriggerKind||(exports.SignatureHelpTriggerKind={})),function(DocumentHighlightKind){DocumentHighlightKind[DocumentHighlightKind.Text=0]="Text",DocumentHighlightKind[DocumentHighlightKind.Read=1]="Read",DocumentHighlightKind[DocumentHighlightKind.Write=2]="Write"}(exports.DocumentHighlightKind||(exports.DocumentHighlightKind={})),exports.isLocationLink=function isLocationLink(thing){return thing&&uri_1.URI.isUri(thing.uri)&&range_1.Range.isIRange(thing.range)&&(range_1.Range.isIRange(thing.originSelectionRange)||range_1.Range.isIRange(thing.targetSelectionRange))},function(SymbolKinds){const byKind=new Map;byKind.set(0,codicons_1.Codicon.symbolFile),byKind.set(1,codicons_1.Codicon.symbolModule),byKind.set(2,codicons_1.Codicon.symbolNamespace),byKind.set(3,codicons_1.Codicon.symbolPackage),byKind.set(4,codicons_1.Codicon.symbolClass),byKind.set(5,codicons_1.Codicon.symbolMethod),byKind.set(6,codicons_1.Codicon.symbolProperty),byKind.set(7,codicons_1.Codicon.symbolField),byKind.set(8,codicons_1.Codicon.symbolConstructor),byKind.set(9,codicons_1.Codicon.symbolEnum),byKind.set(10,codicons_1.Codicon.symbolInterface),byKind.set(11,codicons_1.Codicon.symbolFunction),byKind.set(12,codicons_1.Codicon.symbolVariable),byKind.set(13,codicons_1.Codicon.symbolConstant),byKind.set(14,codicons_1.Codicon.symbolString),byKind.set(15,codicons_1.Codicon.symbolNumber),byKind.set(16,codicons_1.Codicon.symbolBoolean),byKind.set(17,codicons_1.Codicon.symbolArray),byKind.set(18,codicons_1.Codicon.symbolObject),byKind.set(19,codicons_1.Codicon.symbolKey),byKind.set(20,codicons_1.Codicon.symbolNull),byKind.set(21,codicons_1.Codicon.symbolEnumMember),byKind.set(22,codicons_1.Codicon.symbolStruct),byKind.set(23,codicons_1.Codicon.symbolEvent),byKind.set(24,codicons_1.Codicon.symbolOperator),byKind.set(25,codicons_1.Codicon.symbolTypeParameter),SymbolKinds.toIcon=function toIcon(kind){let icon=byKind.get(kind);return icon||(console.info("No codicon found for SymbolKind "+kind),icon=codicons_1.Codicon.symbolProperty),icon}}(exports.SymbolKinds||(exports.SymbolKinds={}));class FoldingRangeKind{constructor(value){this.value=value}}exports.FoldingRangeKind=FoldingRangeKind,FoldingRangeKind.Comment=new FoldingRangeKind("comment"),FoldingRangeKind.Imports=new FoldingRangeKind("imports"),FoldingRangeKind.Region=new FoldingRangeKind("region"),function(Command){Command.is=function is(obj){return!(!obj||"object"!=typeof obj)&&("string"==typeof obj.id&&"string"==typeof obj.title)}}(exports.Command||(exports.Command={})),function(InlayHintKind){InlayHintKind[InlayHintKind.Type=1]="Type",InlayHintKind[InlayHintKind.Parameter=2]="Parameter"}(exports.InlayHintKind||(exports.InlayHintKind={})),exports.TokenizationRegistry=new tokenizationRegistry_1.TokenizationRegistry})),define(__m[124],__M([1,0,27]),(function(require,exports,languages_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.nullTokenizeEncoded=exports.nullTokenize=exports.NullState=void 0,exports.NullState=new class{clone(){return this}equals(other){return this===other}},exports.nullTokenize=function nullTokenize(languageId,state){return new languages_1.TokenizationResult([new languages_1.Token(0,"",languageId)],state)},exports.nullTokenizeEncoded=function nullTokenizeEncoded(languageId,state){const tokens=new Uint32Array(2);return tokens[0]=0,tokens[1]=(16384|languageId<<0|2<<23)>>>0,new languages_1.EncodedTokenizationResult(tokens,null===state?exports.NullState:state)}})),define(__m[187],__M([1,0,13,27,152,85,101]),(function(require,exports,errors_1,languages_1,ast_1,length_1,smallImmutableSet_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FastTokenizer=exports.TextBufferTokenizer=exports.Token=void 0;class Token{constructor(length,kind,bracketId,bracketIds,astNode){this.length=length,this.kind=kind,this.bracketId=bracketId,this.bracketIds=bracketIds,this.astNode=astNode}}exports.Token=Token;exports.TextBufferTokenizer=class TextBufferTokenizer{constructor(textModel,bracketTokens){this.textModel=textModel,this.bracketTokens=bracketTokens,this.reader=new NonPeekableTextBufferTokenizer(this.textModel,this.bracketTokens),this._offset=length_1.lengthZero,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=textModel.getLineCount(),this.textBufferLastLineLength=textModel.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return(0,length_1.toLength)(this.textBufferLineCount,this.textBufferLastLineLength)}skip(length){this.didPeek=!1,this._offset=(0,length_1.lengthAdd)(this._offset,length);const obj=(0,length_1.lengthToObj)(this._offset);this.reader.setPosition(obj.lineCount,obj.columnCount)}read(){let token;return this.peeked?(this.didPeek=!1,token=this.peeked):token=this.reader.read(),token&&(this._offset=(0,length_1.lengthAdd)(this._offset,token.length)),token}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}};class NonPeekableTextBufferTokenizer{constructor(textModel,bracketTokens){this.textModel=textModel,this.bracketTokens=bracketTokens,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=textModel.getLineCount(),this.textBufferLastLineLength=textModel.getLineLength(this.textBufferLineCount)}setPosition(lineIdx,column){lineIdx===this.lineIdx?(this.lineCharOffset=column,this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset)):(this.lineIdx=lineIdx,this.lineCharOffset=column,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const token=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=(0,length_1.lengthGetColumnCountIfZeroLineCount)(token.length),token}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;null===this.line&&(this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const startLineIdx=this.lineIdx,startLineCharOffset=this.lineCharOffset;let lengthHeuristic=0;for(;;){const lineTokens=this.lineTokens,tokenCount=lineTokens.getCount();let peekedBracketToken=null;if(this.lineTokenOffset<tokenCount){const tokenMetadata=lineTokens.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<tokenCount&&tokenMetadata===lineTokens.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const isOther=0===languages_1.TokenMetadata.getTokenType(tokenMetadata),endOffset=lineTokens.getEndOffset(this.lineTokenOffset);if(isOther&&endOffset!==this.lineCharOffset){const languageId=lineTokens.getLanguageId(this.lineTokenOffset),text=this.line.substring(this.lineCharOffset,endOffset),brackets=this.bracketTokens.getSingleLanguageBracketTokens(languageId),regexp=brackets.regExpGlobal;if(regexp){regexp.lastIndex=0;const match=regexp.exec(text);match&&(peekedBracketToken=brackets.getToken(match[0]),peekedBracketToken&&(this.lineCharOffset+=match.index))}}if(lengthHeuristic+=endOffset-this.lineCharOffset,peekedBracketToken){if(startLineIdx!==this.lineIdx||startLineCharOffset!==this.lineCharOffset){this.peekedToken=peekedBracketToken;break}return this.lineCharOffset+=(0,length_1.lengthGetColumnCountIfZeroLineCount)(peekedBracketToken.length),peekedBracketToken}this.lineTokenOffset++,this.lineCharOffset=endOffset}else{if(this.lineIdx===this.textBufferLineCount-1)break;if(this.lineIdx++,this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,lengthHeuristic+=33,lengthHeuristic>1e3)break}if(lengthHeuristic>1500)break}const length=(0,length_1.lengthDiff)(startLineIdx,startLineCharOffset,this.lineIdx,this.lineCharOffset);return new Token(length,0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode(length))}}exports.FastTokenizer=class FastTokenizer{constructor(text,brackets){this.text=text,this._offset=length_1.lengthZero,this.idx=0;const regexp=brackets.getRegExpStr()?new RegExp(brackets.getRegExpStr()+"|\n","g"):null,tokens=[];let match,curLineCount=0,lastLineBreakOffset=0,lastTokenEndOffset=0,lastTokenEndLine=0;const smallTextTokens0Line=new Array;for(let i=0;i<60;i++)smallTextTokens0Line.push(new Token((0,length_1.toLength)(0,i),0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode((0,length_1.toLength)(0,i))));const smallTextTokens1Line=new Array;for(let i=0;i<60;i++)smallTextTokens1Line.push(new Token((0,length_1.toLength)(1,i),0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode((0,length_1.toLength)(1,i))));if(regexp)for(regexp.lastIndex=0;null!==(match=regexp.exec(text));){const curOffset=match.index,value=match[0];if("\n"===value)curLineCount++,lastLineBreakOffset=curOffset+1;else{if(lastTokenEndOffset!==curOffset){let token;if(lastTokenEndLine===curLineCount){const colCount=curOffset-lastTokenEndOffset;if(colCount<smallTextTokens0Line.length)token=smallTextTokens0Line[colCount];else{const length=(0,length_1.toLength)(0,colCount);token=new Token(length,0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode(length))}}else{const lineCount=curLineCount-lastTokenEndLine,colCount=curOffset-lastLineBreakOffset;if(1===lineCount&&colCount<smallTextTokens1Line.length)token=smallTextTokens1Line[colCount];else{const length=(0,length_1.toLength)(lineCount,colCount);token=new Token(length,0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode(length))}}tokens.push(token)}tokens.push(brackets.getToken(value)),lastTokenEndOffset=curOffset+value.length,lastTokenEndLine=curLineCount}}const offset=text.length;if(lastTokenEndOffset!==offset){const length=lastTokenEndLine===curLineCount?(0,length_1.toLength)(0,offset-lastTokenEndOffset):(0,length_1.toLength)(curLineCount-lastTokenEndLine,offset-lastLineBreakOffset);tokens.push(new Token(length,0,-1,smallImmutableSet_1.SmallImmutableSet.getEmpty(),new ast_1.TextAstNode(length)))}this.length=(0,length_1.toLength)(curLineCount,offset-lastLineBreakOffset),this.tokens=tokens}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(length){throw new errors_1.NotSupportedError}}})),define(__m[251],__M([1,0,8,152,85,101,187]),(function(require,exports,strings_1,ast_1,length_1,smallImmutableSet_1,tokenizer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguageAgnosticBracketTokens=exports.BracketTokens=void 0;class BracketTokens{constructor(map){this.map=map,this.hasRegExp=!1,this._regExpGlobal=null}static createFromLanguage(configuration,denseKeyProvider){function getId(languageId,openingText){return denseKeyProvider.getKey(`${languageId}:::${openingText}`)}const brackets=configuration.characterPair.getColorizedBrackets(),closingBrackets=new Map,openingBrackets=new Set;for(const[openingText,closingText]of brackets){openingBrackets.add(openingText);let info=closingBrackets.get(closingText);const openingTextId=getId(configuration.languageId,openingText);info||(info={openingBrackets:smallImmutableSet_1.SmallImmutableSet.getEmpty(),first:openingTextId},closingBrackets.set(closingText,info)),info.openingBrackets=info.openingBrackets.add(openingTextId,smallImmutableSet_1.identityKeyProvider)}const map=new Map;for(const[closingText,info]of closingBrackets){const length=(0,length_1.toLength)(0,closingText.length);map.set(closingText,new tokenizer_1.Token(length,2,info.first,info.openingBrackets,ast_1.BracketAstNode.create(length,configuration.languageId,info.openingBrackets)))}for(const openingText of openingBrackets){const length=(0,length_1.toLength)(0,openingText.length),openingTextId=getId(configuration.languageId,openingText),bracketIds=smallImmutableSet_1.SmallImmutableSet.getEmpty().add(openingTextId,smallImmutableSet_1.identityKeyProvider);map.set(openingText,new tokenizer_1.Token(length,1,openingTextId,bracketIds,ast_1.BracketAstNode.create(length,configuration.languageId,bracketIds)))}return new BracketTokens(map)}getRegExpStr(){if(this.isEmpty)return null;{const keys=[...this.map.keys()];return keys.sort(),keys.reverse(),keys.map((k=>function prepareBracketForRegExp(str){const escaped=(0,strings_1.escapeRegExpCharacters)(str);return/^[\w ]+$/.test(str)?`\\b${escaped}\\b`:escaped}(k))).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const regExpStr=this.getRegExpStr();this._regExpGlobal=regExpStr?new RegExp(regExpStr,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(value){return this.map.get(value)}findClosingTokenText(openingBracketIds){for(const[closingText,info]of this.map)if(info.bracketIds.intersects(openingBracketIds))return closingText}get isEmpty(){return 0===this.map.size}}exports.BracketTokens=BracketTokens;exports.LanguageAgnosticBracketTokens=class LanguageAgnosticBracketTokens{constructor(denseKeyProvider,getLanguageConfiguration){this.denseKeyProvider=denseKeyProvider,this.getLanguageConfiguration=getLanguageConfiguration,this.languageIdToBracketTokens=new Map}didLanguageChange(languageId){const existing=this.languageIdToBracketTokens.get(languageId);if(!existing)return!1;const newRegExpStr=BracketTokens.createFromLanguage(this.getLanguageConfiguration(languageId),this.denseKeyProvider).getRegExpStr();return existing.getRegExpStr()!==newRegExpStr}getSingleLanguageBracketTokens(languageId){let singleLanguageBracketTokens=this.languageIdToBracketTokens.get(languageId);return singleLanguageBracketTokens||(singleLanguageBracketTokens=BracketTokens.createFromLanguage(this.getLanguageConfiguration(languageId),this.denseKeyProvider),this.languageIdToBracketTokens.set(languageId,singleLanguageBracketTokens)),singleLanguageBracketTokens}}})),define(__m[434],__M([1,0,4,2,3,432,243,251,85,244,101,187]),(function(require,exports,event_1,lifecycle_1,range_1,textModelBracketPairs_1,beforeEditPositionMapper_1,brackets_1,length_1,parser_1,smallImmutableSet_1,tokenizer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketPairsTree=void 0;class BracketPairsTree extends lifecycle_1.Disposable{constructor(textModel,getLanguageConfiguration){if(super(),this.textModel=textModel,this.getLanguageConfiguration=getLanguageConfiguration,this.didChangeEmitter=new event_1.Emitter,this.denseKeyProvider=new smallImmutableSet_1.DenseKeyProvider,this.brackets=new brackets_1.LanguageAgnosticBracketTokens(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,0===textModel.backgroundTokenizationState){const brackets=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),tokenizer=new tokenizer_1.FastTokenizer(this.textModel.getValue(),brackets);this.initialAstWithoutTokens=(0,parser_1.parseDocument)(tokenizer,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}else 2===textModel.backgroundTokenizationState?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):1===textModel.backgroundTokenizationState&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens)}didLanguageChange(languageId){return this.brackets.didLanguageChange(languageId)}handleDidChangeBackgroundTokenizationState(){if(2===this.textModel.backgroundTokenizationState){const wasUndefined=void 0===this.initialAstWithoutTokens;this.initialAstWithoutTokens=void 0,wasUndefined||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges}){const edits=ranges.map((r=>new beforeEditPositionMapper_1.TextEditInfo((0,length_1.toLength)(r.fromLineNumber-1,0),(0,length_1.toLength)(r.toLineNumber,0),(0,length_1.toLength)(r.toLineNumber-r.fromLineNumber+1,0))));this.astWithTokens=this.parseDocumentFromTextBuffer(edits,this.astWithTokens,!1),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(change){const edits=change.changes.map((c=>{const range=range_1.Range.lift(c.range);return new beforeEditPositionMapper_1.TextEditInfo((0,length_1.positionToLength)(range.getStartPosition()),(0,length_1.positionToLength)(range.getEndPosition()),(0,length_1.lengthOfString)(c.text))})).reverse();this.astWithTokens=this.parseDocumentFromTextBuffer(edits,this.astWithTokens,!1),this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(edits,this.initialAstWithoutTokens,!1))}parseDocumentFromTextBuffer(edits,previousAst,immutable){const previousAstClone=previousAst,tokenizer=new tokenizer_1.TextBufferTokenizer(this.textModel,this.brackets);return(0,parser_1.parseDocument)(tokenizer,edits,previousAstClone,immutable)}getBracketsInRange(range){const startOffset=(0,length_1.toLength)(range.startLineNumber-1,range.startColumn-1),endOffset=(0,length_1.toLength)(range.endLineNumber-1,range.endColumn-1),result=new Array,node=this.initialAstWithoutTokens||this.astWithTokens;return collectBrackets(node,length_1.lengthZero,node.length,startOffset,endOffset,result),result}getBracketPairsInRange(range,includeMinIndentation){const result=new Array,startLength=(0,length_1.positionToLength)(range.getStartPosition()),endLength=(0,length_1.positionToLength)(range.getEndPosition()),node=this.initialAstWithoutTokens||this.astWithTokens,context=new CollectBracketPairsContext(result,includeMinIndentation,this.textModel);return collectBracketPairs(node,length_1.lengthZero,node.length,startLength,endLength,context),result}}function collectBrackets(node,nodeOffsetStart,nodeOffsetEnd,startOffset,endOffset,result,level=0){if(4===node.kind)for(const child of node.children)nodeOffsetEnd=(0,length_1.lengthAdd)(nodeOffsetStart,child.length),(0,length_1.lengthLessThanEqual)(nodeOffsetStart,endOffset)&&(0,length_1.lengthGreaterThanEqual)(nodeOffsetEnd,startOffset)&&collectBrackets(child,nodeOffsetStart,nodeOffsetEnd,startOffset,endOffset,result,level),nodeOffsetStart=nodeOffsetEnd;else if(2===node.kind){level++;{const child=node.openingBracket;if(nodeOffsetEnd=(0,length_1.lengthAdd)(nodeOffsetStart,child.length),(0,length_1.lengthLessThanEqual)(nodeOffsetStart,endOffset)&&(0,length_1.lengthGreaterThanEqual)(nodeOffsetEnd,startOffset)){const range=(0,length_1.lengthsToRange)(nodeOffsetStart,nodeOffsetEnd);result.push(new textModelBracketPairs_1.BracketInfo(range,level-1,!node.closingBracket))}nodeOffsetStart=nodeOffsetEnd}if(node.child){const child=node.child;nodeOffsetEnd=(0,length_1.lengthAdd)(nodeOffsetStart,child.length),(0,length_1.lengthLessThanEqual)(nodeOffsetStart,endOffset)&&(0,length_1.lengthGreaterThanEqual)(nodeOffsetEnd,startOffset)&&collectBrackets(child,nodeOffsetStart,nodeOffsetEnd,startOffset,endOffset,result,level),nodeOffsetStart=nodeOffsetEnd}if(node.closingBracket){const child=node.closingBracket;if(nodeOffsetEnd=(0,length_1.lengthAdd)(nodeOffsetStart,child.length),(0,length_1.lengthLessThanEqual)(nodeOffsetStart,endOffset)&&(0,length_1.lengthGreaterThanEqual)(nodeOffsetEnd,startOffset)){const range=(0,length_1.lengthsToRange)(nodeOffsetStart,nodeOffsetEnd);result.push(new textModelBracketPairs_1.BracketInfo(range,level-1,!1))}nodeOffsetStart=nodeOffsetEnd}}else if(3===node.kind){const range=(0,length_1.lengthsToRange)(nodeOffsetStart,nodeOffsetEnd);result.push(new textModelBracketPairs_1.BracketInfo(range,level-1,!0))}else if(1===node.kind){const range=(0,length_1.lengthsToRange)(nodeOffsetStart,nodeOffsetEnd);result.push(new textModelBracketPairs_1.BracketInfo(range,level-1,!1))}}exports.BracketPairsTree=BracketPairsTree;class CollectBracketPairsContext{constructor(result,includeMinIndentation,textModel){this.result=result,this.includeMinIndentation=includeMinIndentation,this.textModel=textModel}}function collectBracketPairs(node,nodeOffset,nodeOffsetEnd,startOffset,endOffset,context,level=0){var _a;if(2===node.kind){const openingBracketEnd=(0,length_1.lengthAdd)(nodeOffset,node.openingBracket.length);let minIndentation=-1;context.includeMinIndentation&&(minIndentation=node.computeMinIndentation(nodeOffset,context.textModel)),context.result.push(new textModelBracketPairs_1.BracketPairWithMinIndentationInfo((0,length_1.lengthsToRange)(nodeOffset,nodeOffsetEnd),(0,length_1.lengthsToRange)(nodeOffset,openingBracketEnd),node.closingBracket?(0,length_1.lengthsToRange)((0,length_1.lengthAdd)(openingBracketEnd,(null===(_a=node.child)||void 0===_a?void 0:_a.length)||length_1.lengthZero),nodeOffsetEnd):void 0,level,minIndentation)),level++}let curOffset=nodeOffset;for(const child of node.children){const childOffset=curOffset;curOffset=(0,length_1.lengthAdd)(curOffset,child.length),(0,length_1.lengthLessThanEqual)(childOffset,endOffset)&&(0,length_1.lengthLessThanEqual)(startOffset,curOffset)&&collectBracketPairs(child,childOffset,curOffset,startOffset,endOffset,context,level)}}})),define(__m[435],__M([1,0,4,2,434,123,183]),(function(require,exports,event_1,lifecycle_1,bracketPairsTree_1,supports_1,richEditBrackets_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketPairsTextModelPart=void 0;class BracketPairsTextModelPart extends lifecycle_1.Disposable{constructor(textModel,languageConfigurationService){super(),this.textModel=textModel,this.languageConfigurationService=languageConfigurationService,this.bracketPairsTree=this._register(new lifecycle_1.MutableDisposable),this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange((e=>{var _a;e.languageId&&!(null===(_a=this.bracketPairsTree.value)||void 0===_a?void 0:_a.object.didLanguageChange(e.languageId))||(this.bracketPairsTree.clear(),this.updateBracketPairsTree())})))}get isDocumentSupported(){return this.textModel.getValueLength()<=5e6}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(change){var _a;null===(_a=this.bracketPairsTree.value)||void 0===_a||_a.object.handleContentChanged(change)}handleDidChangeBackgroundTokenizationState(){var _a;null===(_a=this.bracketPairsTree.value)||void 0===_a||_a.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var _a;null===(_a=this.bracketPairsTree.value)||void 0===_a||_a.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.isDocumentSupported){if(!this.bracketPairsTree.value){const store=new lifecycle_1.DisposableStore;this.bracketPairsTree.value=function createDisposableRef(object,disposable){return{object,dispose:()=>null==disposable?void 0:disposable.dispose()}}(store.add(new bracketPairsTree_1.BracketPairsTree(this.textModel,(languageId=>this.languageConfigurationService.getLanguageConfiguration(languageId)))),store),store.add(this.bracketPairsTree.value.object.onDidChange((e=>this.onDidChangeEmitter.fire(e)))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(range){var _a;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(_a=this.bracketPairsTree.value)||void 0===_a?void 0:_a.object.getBracketPairsInRange(range,!1))||[]}getBracketPairsInRangeWithMinIndentation(range){var _a;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(_a=this.bracketPairsTree.value)||void 0===_a?void 0:_a.object.getBracketPairsInRange(range,!0))||[]}getBracketsInRange(range){var _a;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(_a=this.bracketPairsTree.value)||void 0===_a?void 0:_a.object.getBracketsInRange(range))||[]}findMatchingBracketUp(_bracket,_position,maxDuration){const bracket=_bracket.toLowerCase(),position=this.textModel.validatePosition(_position),languageId=this.textModel.getLanguageIdAtPosition(position.lineNumber,position.column),bracketsSupport=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets;if(!bracketsSupport)return null;const data=bracketsSupport.textIsBracket[bracket];return data?stripBracketSearchCanceled(this._findMatchingBracketUp(data,position,createTimeBasedContinueBracketSearchPredicate(maxDuration))):null}matchBracket(position,maxDuration){const continueSearchPredicate=createTimeBasedContinueBracketSearchPredicate(maxDuration);return this._matchBracket(this.textModel.validatePosition(position),continueSearchPredicate)}_establishBracketSearchOffsets(position,lineTokens,modeBrackets,tokenIndex){const tokenCount=lineTokens.getCount(),currentLanguageId=lineTokens.getLanguageId(tokenIndex);let searchStartOffset=Math.max(0,position.column-1-modeBrackets.maxBracketLength);for(let i=tokenIndex-1;i>=0;i--){const tokenEndOffset=lineTokens.getEndOffset(i);if(tokenEndOffset<=searchStartOffset)break;if((0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(i))||lineTokens.getLanguageId(i)!==currentLanguageId){searchStartOffset=tokenEndOffset;break}}let searchEndOffset=Math.min(lineTokens.getLineContent().length,position.column-1+modeBrackets.maxBracketLength);for(let i=tokenIndex+1;i<tokenCount;i++){const tokenStartOffset=lineTokens.getStartOffset(i);if(tokenStartOffset>=searchEndOffset)break;if((0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(i))||lineTokens.getLanguageId(i)!==currentLanguageId){searchEndOffset=tokenStartOffset;break}}return{searchStartOffset,searchEndOffset}}_matchBracket(position,continueSearchPredicate){const lineNumber=position.lineNumber,lineTokens=this.textModel.getLineTokens(lineNumber),lineText=this.textModel.getLineContent(lineNumber),tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1);if(tokenIndex<0)return null;const currentModeBrackets=this.languageConfigurationService.getLanguageConfiguration(lineTokens.getLanguageId(tokenIndex)).brackets;if(currentModeBrackets&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex))){let{searchStartOffset,searchEndOffset}=this._establishBracketSearchOffsets(position,lineTokens,currentModeBrackets,tokenIndex),bestResult=null;for(;;){const foundBracket=richEditBrackets_1.BracketsUtils.findNextBracketInRange(currentModeBrackets.forwardRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(!foundBracket)break;if(foundBracket.startColumn<=position.column&&position.column<=foundBracket.endColumn){const foundBracketText=lineText.substring(foundBracket.startColumn-1,foundBracket.endColumn-1).toLowerCase(),r=this._matchFoundBracket(foundBracket,currentModeBrackets.textIsBracket[foundBracketText],currentModeBrackets.textIsOpenBracket[foundBracketText],continueSearchPredicate);if(r){if(r instanceof BracketSearchCanceled)return null;bestResult=r}}searchStartOffset=foundBracket.endColumn-1}if(bestResult)return bestResult}if(tokenIndex>0&&lineTokens.getStartOffset(tokenIndex)===position.column-1){const prevTokenIndex=tokenIndex-1,prevModeBrackets=this.languageConfigurationService.getLanguageConfiguration(lineTokens.getLanguageId(prevTokenIndex)).brackets;if(prevModeBrackets&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(prevTokenIndex))){const{searchStartOffset,searchEndOffset}=this._establishBracketSearchOffsets(position,lineTokens,prevModeBrackets,prevTokenIndex),foundBracket=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(prevModeBrackets.reversedRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(foundBracket&&foundBracket.startColumn<=position.column&&position.column<=foundBracket.endColumn){const foundBracketText=lineText.substring(foundBracket.startColumn-1,foundBracket.endColumn-1).toLowerCase(),r=this._matchFoundBracket(foundBracket,prevModeBrackets.textIsBracket[foundBracketText],prevModeBrackets.textIsOpenBracket[foundBracketText],continueSearchPredicate);if(r)return r instanceof BracketSearchCanceled?null:r}}}return null}_matchFoundBracket(foundBracket,data,isOpen,continueSearchPredicate){if(!data)return null;const matched=isOpen?this._findMatchingBracketDown(data,foundBracket.getEndPosition(),continueSearchPredicate):this._findMatchingBracketUp(data,foundBracket.getStartPosition(),continueSearchPredicate);return matched?matched instanceof BracketSearchCanceled?matched:[foundBracket,matched]:null}_findMatchingBracketUp(bracket,position,continueSearchPredicate){const languageId=bracket.languageId,reversedBracketRegex=bracket.reversedRegex;let count=-1,totalCallCount=0;const searchPrevMatchingBracketInRange=(lineNumber,lineText,searchStartOffset,searchEndOffset)=>{for(;;){if(continueSearchPredicate&&++totalCallCount%100==0&&!continueSearchPredicate())return BracketSearchCanceled.INSTANCE;const r=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(reversedBracketRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(!r)break;const hitText=lineText.substring(r.startColumn-1,r.endColumn-1).toLowerCase();if(bracket.isOpen(hitText)?count++:bracket.isClose(hitText)&&count--,0===count)return r;searchEndOffset=r.startColumn-1}return null};for(let lineNumber=position.lineNumber;lineNumber>=1;lineNumber--){const lineTokens=this.textModel.getLineTokens(lineNumber),tokenCount=lineTokens.getCount(),lineText=this.textModel.getLineContent(lineNumber);let tokenIndex=tokenCount-1,searchStartOffset=lineText.length,searchEndOffset=lineText.length;lineNumber===position.lineNumber&&(tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),searchStartOffset=position.column-1,searchEndOffset=position.column-1);let prevSearchInToken=!0;for(;tokenIndex>=0;tokenIndex--){const searchInToken=lineTokens.getLanguageId(tokenIndex)===languageId&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex));if(searchInToken)prevSearchInToken?searchStartOffset=lineTokens.getStartOffset(tokenIndex):(searchStartOffset=lineTokens.getStartOffset(tokenIndex),searchEndOffset=lineTokens.getEndOffset(tokenIndex));else if(prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchPrevMatchingBracketInRange(lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return r}prevSearchInToken=searchInToken}if(prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchPrevMatchingBracketInRange(lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return r}}return null}_findMatchingBracketDown(bracket,position,continueSearchPredicate){const languageId=bracket.languageId,bracketRegex=bracket.forwardRegex;let count=1,totalCallCount=0;const searchNextMatchingBracketInRange=(lineNumber,lineText,searchStartOffset,searchEndOffset)=>{for(;;){if(continueSearchPredicate&&++totalCallCount%100==0&&!continueSearchPredicate())return BracketSearchCanceled.INSTANCE;const r=richEditBrackets_1.BracketsUtils.findNextBracketInRange(bracketRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(!r)break;const hitText=lineText.substring(r.startColumn-1,r.endColumn-1).toLowerCase();if(bracket.isOpen(hitText)?count++:bracket.isClose(hitText)&&count--,0===count)return r;searchStartOffset=r.endColumn-1}return null},lineCount=this.textModel.getLineCount();for(let lineNumber=position.lineNumber;lineNumber<=lineCount;lineNumber++){const lineTokens=this.textModel.getLineTokens(lineNumber),tokenCount=lineTokens.getCount(),lineText=this.textModel.getLineContent(lineNumber);let tokenIndex=0,searchStartOffset=0,searchEndOffset=0;lineNumber===position.lineNumber&&(tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),searchStartOffset=position.column-1,searchEndOffset=position.column-1);let prevSearchInToken=!0;for(;tokenIndex<tokenCount;tokenIndex++){const searchInToken=lineTokens.getLanguageId(tokenIndex)===languageId&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex));if(searchInToken)prevSearchInToken||(searchStartOffset=lineTokens.getStartOffset(tokenIndex)),searchEndOffset=lineTokens.getEndOffset(tokenIndex);else if(prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchNextMatchingBracketInRange(lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return r}prevSearchInToken=searchInToken}if(prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchNextMatchingBracketInRange(lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return r}}return null}findPrevBracket(_position){const position=this.textModel.validatePosition(_position);let languageId=null,modeBrackets=null;for(let lineNumber=position.lineNumber;lineNumber>=1;lineNumber--){const lineTokens=this.textModel.getLineTokens(lineNumber),tokenCount=lineTokens.getCount(),lineText=this.textModel.getLineContent(lineNumber);let tokenIndex=tokenCount-1,searchStartOffset=lineText.length,searchEndOffset=lineText.length;if(lineNumber===position.lineNumber){tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),searchStartOffset=position.column-1,searchEndOffset=position.column-1;const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);languageId!==tokenLanguageId&&(languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets)}let prevSearchInToken=!0;for(;tokenIndex>=0;tokenIndex--){const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);if(languageId!==tokenLanguageId){if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(modeBrackets.reversedRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r);prevSearchInToken=!1}languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets}const searchInToken=!!modeBrackets&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex));if(searchInToken)prevSearchInToken?searchStartOffset=lineTokens.getStartOffset(tokenIndex):(searchStartOffset=lineTokens.getStartOffset(tokenIndex),searchEndOffset=lineTokens.getEndOffset(tokenIndex));else if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(modeBrackets.reversedRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r)}prevSearchInToken=searchInToken}if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findPrevBracketInRange(modeBrackets.reversedRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r)}}return null}findNextBracket(_position){const position=this.textModel.validatePosition(_position),lineCount=this.textModel.getLineCount();let languageId=null,modeBrackets=null;for(let lineNumber=position.lineNumber;lineNumber<=lineCount;lineNumber++){const lineTokens=this.textModel.getLineTokens(lineNumber),tokenCount=lineTokens.getCount(),lineText=this.textModel.getLineContent(lineNumber);let tokenIndex=0,searchStartOffset=0,searchEndOffset=0;if(lineNumber===position.lineNumber){tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),searchStartOffset=position.column-1,searchEndOffset=position.column-1;const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);languageId!==tokenLanguageId&&(languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets)}let prevSearchInToken=!0;for(;tokenIndex<tokenCount;tokenIndex++){const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);if(languageId!==tokenLanguageId){if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findNextBracketInRange(modeBrackets.forwardRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r);prevSearchInToken=!1}languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets}const searchInToken=!!modeBrackets&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex));if(searchInToken)prevSearchInToken||(searchStartOffset=lineTokens.getStartOffset(tokenIndex)),searchEndOffset=lineTokens.getEndOffset(tokenIndex);else if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findNextBracketInRange(modeBrackets.forwardRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r)}prevSearchInToken=searchInToken}if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=richEditBrackets_1.BracketsUtils.findNextBracketInRange(modeBrackets.forwardRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return this._toFoundBracket(modeBrackets,r)}}return null}findEnclosingBrackets(_position,maxDuration){const continueSearchPredicate=createTimeBasedContinueBracketSearchPredicate(maxDuration),position=this.textModel.validatePosition(_position),lineCount=this.textModel.getLineCount(),savedCounts=new Map;let counts=[];const resetCounts=(languageId,modeBrackets)=>{if(!savedCounts.has(languageId)){const tmp=[];for(let i=0,len=modeBrackets?modeBrackets.brackets.length:0;i<len;i++)tmp[i]=0;savedCounts.set(languageId,tmp)}counts=savedCounts.get(languageId)};let totalCallCount=0;const searchInRange=(modeBrackets,lineNumber,lineText,searchStartOffset,searchEndOffset)=>{for(;;){if(continueSearchPredicate&&++totalCallCount%100==0&&!continueSearchPredicate())return BracketSearchCanceled.INSTANCE;const r=richEditBrackets_1.BracketsUtils.findNextBracketInRange(modeBrackets.forwardRegex,lineNumber,lineText,searchStartOffset,searchEndOffset);if(!r)break;const hitText=lineText.substring(r.startColumn-1,r.endColumn-1).toLowerCase(),bracket=modeBrackets.textIsBracket[hitText];if(bracket&&(bracket.isOpen(hitText)?counts[bracket.index]++:bracket.isClose(hitText)&&counts[bracket.index]--,-1===counts[bracket.index]))return this._matchFoundBracket(r,bracket,!1,continueSearchPredicate);searchStartOffset=r.endColumn-1}return null};let languageId=null,modeBrackets=null;for(let lineNumber=position.lineNumber;lineNumber<=lineCount;lineNumber++){const lineTokens=this.textModel.getLineTokens(lineNumber),tokenCount=lineTokens.getCount(),lineText=this.textModel.getLineContent(lineNumber);let tokenIndex=0,searchStartOffset=0,searchEndOffset=0;if(lineNumber===position.lineNumber){tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),searchStartOffset=position.column-1,searchEndOffset=position.column-1;const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);languageId!==tokenLanguageId&&(languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets,resetCounts(languageId,modeBrackets))}let prevSearchInToken=!0;for(;tokenIndex<tokenCount;tokenIndex++){const tokenLanguageId=lineTokens.getLanguageId(tokenIndex);if(languageId!==tokenLanguageId){if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchInRange(modeBrackets,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return stripBracketSearchCanceled(r);prevSearchInToken=!1}languageId=tokenLanguageId,modeBrackets=this.languageConfigurationService.getLanguageConfiguration(languageId).brackets,resetCounts(languageId,modeBrackets)}const searchInToken=!!modeBrackets&&!(0,supports_1.ignoreBracketsInToken)(lineTokens.getStandardTokenType(tokenIndex));if(searchInToken)prevSearchInToken||(searchStartOffset=lineTokens.getStartOffset(tokenIndex)),searchEndOffset=lineTokens.getEndOffset(tokenIndex);else if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchInRange(modeBrackets,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return stripBracketSearchCanceled(r)}prevSearchInToken=searchInToken}if(modeBrackets&&prevSearchInToken&&searchStartOffset!==searchEndOffset){const r=searchInRange(modeBrackets,lineNumber,lineText,searchStartOffset,searchEndOffset);if(r)return stripBracketSearchCanceled(r)}}return null}_toFoundBracket(modeBrackets,r){if(!r)return null;let text=this.textModel.getValueInRange(r);text=text.toLowerCase();const data=modeBrackets.textIsBracket[text];return data?{range:r,open:data.open,close:data.close,isOpen:modeBrackets.textIsOpenBracket[text]}:null}}function createTimeBasedContinueBracketSearchPredicate(maxDuration){if(void 0===maxDuration)return()=>!0;{const startTime=Date.now();return()=>Date.now()-startTime<=maxDuration}}exports.BracketPairsTextModelPart=BracketPairsTextModelPart;class BracketSearchCanceled{constructor(){this._searchCanceledBrand=void 0}}function stripBracketSearchCanceled(result){return result instanceof BracketSearchCanceled?null:result}BracketSearchCanceled.INSTANCE=new BracketSearchCanceled})),define(__m[436],__M([1,0,251,85,244,101,187]),(function(require,exports,brackets_1,length_1,parser_1,smallImmutableSet_1,tokenizer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fixBracketsInLine=void 0,exports.fixBracketsInLine=function fixBracketsInLine(tokens,languageConfigurationService){const denseKeyProvider=new smallImmutableSet_1.DenseKeyProvider,bracketTokens=new brackets_1.LanguageAgnosticBracketTokens(denseKeyProvider,(languageId=>languageConfigurationService.getLanguageConfiguration(languageId))),tokenizer=new tokenizer_1.TextBufferTokenizer(new StaticTokenizerSource([tokens]),bracketTokens),node=(0,parser_1.parseDocument)(tokenizer,[],void 0,!0);let str="";const line=tokens.getLineContent();return function processNode(node,offset){if(2===node.kind)if(processNode(node.openingBracket,offset),offset=(0,length_1.lengthAdd)(offset,node.openingBracket.length),node.child&&(processNode(node.child,offset),offset=(0,length_1.lengthAdd)(offset,node.child.length)),node.closingBracket)processNode(node.closingBracket,offset),offset=(0,length_1.lengthAdd)(offset,node.closingBracket.length);else{const closingTokenText=bracketTokens.getSingleLanguageBracketTokens(node.openingBracket.languageId).findClosingTokenText(node.openingBracket.bracketIds);str+=closingTokenText}else if(3===node.kind);else if(0===node.kind||1===node.kind)str+=line.substring((0,length_1.lengthGetColumnCountIfZeroLineCount)(offset),(0,length_1.lengthGetColumnCountIfZeroLineCount)((0,length_1.lengthAdd)(offset,node.length)));else if(4===node.kind)for(const child of node.children)processNode(child,offset),offset=(0,length_1.lengthAdd)(offset,child.length)}(node,length_1.lengthZero),str};class StaticTokenizerSource{constructor(lines){this.lines=lines}getLineCount(){return this.lines.length}getLineLength(lineNumber){return this.lines[lineNumber-1].getLineContent().length}getLineTokens(lineNumber){return this.lines[lineNumber-1]}}})),define(__m[252],__M([1,0,21,4,58,25,11,3,22,27,185]),(function(require,exports,cancellation_1,event_1,keyCodes_1,uri_1,position_1,range_1,selection_1,languages_1,standaloneEnums){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMonacoBaseAPI=exports.KeyMod=void 0;class KeyMod{static chord(firstPart,secondPart){return(0,keyCodes_1.KeyChord)(firstPart,secondPart)}}exports.KeyMod=KeyMod,KeyMod.CtrlCmd=2048,KeyMod.Shift=1024,KeyMod.Alt=512,KeyMod.WinCtrl=256,exports.createMonacoBaseAPI=function createMonacoBaseAPI(){return{editor:void 0,languages:void 0,CancellationTokenSource:cancellation_1.CancellationTokenSource,Emitter:event_1.Emitter,KeyCode:standaloneEnums.KeyCode,KeyMod,Position:position_1.Position,Range:range_1.Range,Selection:selection_1.Selection,SelectionDirection:standaloneEnums.SelectionDirection,MarkerSeverity:standaloneEnums.MarkerSeverity,MarkerTag:standaloneEnums.MarkerTag,Uri:uri_1.URI,Token:languages_1.Token}}})),define(__m[437],__M([1,0,141,16,25,11,3,408,427,121,411,417,252,19,55,249]),(function(require,exports,diff_1,platform_1,uri_1,position_1,range_1,diffComputer_1,mirrorTextModel_1,wordHelper_1,linkComputer_1,inplaceReplaceSupport_1,editorBaseApi_1,types,stopwatch_1,unicodeTextModelHighlighter_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=exports.EditorSimpleWorker=exports.MirrorModel=void 0;class MirrorModel extends mirrorTextModel_1.MirrorTextModel{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(lineNumber){return this._lines[lineNumber-1]}getWordAtPosition(position,wordDefinition){const wordAtText=(0,wordHelper_1.getWordAtText)(position.column,(0,wordHelper_1.ensureValidWordDefinition)(wordDefinition),this._lines[position.lineNumber-1],0);return wordAtText?new range_1.Range(position.lineNumber,wordAtText.startColumn,position.lineNumber,wordAtText.endColumn):null}words(wordDefinition){const lines=this._lines,wordenize=this._wordenize.bind(this);let lineNumber=0,lineText="",wordRangesIdx=0,wordRanges=[];return{*[Symbol.iterator](){for(;;)if(wordRangesIdx<wordRanges.length){const value=lineText.substring(wordRanges[wordRangesIdx].start,wordRanges[wordRangesIdx].end);wordRangesIdx+=1,yield value}else{if(!(lineNumber<lines.length))break;lineText=lines[lineNumber],wordRanges=wordenize(lineText,wordDefinition),wordRangesIdx=0,lineNumber+=1}}}}getLineWords(lineNumber,wordDefinition){const content=this._lines[lineNumber-1],ranges=this._wordenize(content,wordDefinition),words=[];for(const range of ranges)words.push({word:content.substring(range.start,range.end),startColumn:range.start+1,endColumn:range.end+1});return words}_wordenize(content,wordDefinition){const result=[];let match;for(wordDefinition.lastIndex=0;(match=wordDefinition.exec(content))&&0!==match[0].length;)result.push({start:match.index,end:match.index+match[0].length});return result}getValueInRange(range){if((range=this._validateRange(range)).startLineNumber===range.endLineNumber)return this._lines[range.startLineNumber-1].substring(range.startColumn-1,range.endColumn-1);const lineEnding=this._eol,startLineIndex=range.startLineNumber-1,endLineIndex=range.endLineNumber-1,resultLines=[];resultLines.push(this._lines[startLineIndex].substring(range.startColumn-1));for(let i=startLineIndex+1;i<endLineIndex;i++)resultLines.push(this._lines[i]);return resultLines.push(this._lines[endLineIndex].substring(0,range.endColumn-1)),resultLines.join(lineEnding)}offsetAt(position){return position=this._validatePosition(position),this._ensureLineStarts(),this._lineStarts.getPrefixSum(position.lineNumber-2)+(position.column-1)}positionAt(offset){offset=Math.floor(offset),offset=Math.max(0,offset),this._ensureLineStarts();const out=this._lineStarts.getIndexOf(offset),lineLength=this._lines[out.index].length;return{lineNumber:1+out.index,column:1+Math.min(out.remainder,lineLength)}}_validateRange(range){const start=this._validatePosition({lineNumber:range.startLineNumber,column:range.startColumn}),end=this._validatePosition({lineNumber:range.endLineNumber,column:range.endColumn});return start.lineNumber!==range.startLineNumber||start.column!==range.startColumn||end.lineNumber!==range.endLineNumber||end.column!==range.endColumn?{startLineNumber:start.lineNumber,startColumn:start.column,endLineNumber:end.lineNumber,endColumn:end.column}:range}_validatePosition(position){if(!position_1.Position.isIPosition(position))throw new Error("bad position");let{lineNumber,column}=position,hasChanged=!1;if(lineNumber<1)lineNumber=1,column=1,hasChanged=!0;else if(lineNumber>this._lines.length)lineNumber=this._lines.length,column=this._lines[lineNumber-1].length+1,hasChanged=!0;else{const maxCharacter=this._lines[lineNumber-1].length+1;column<1?(column=1,hasChanged=!0):column>maxCharacter&&(column=maxCharacter,hasChanged=!0)}return hasChanged?{lineNumber,column}:position}}exports.MirrorModel=MirrorModel;class EditorSimpleWorker{constructor(host,foreignModuleFactory){this._host=host,this._models=Object.create(null),this._foreignModuleFactory=foreignModuleFactory,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(uri){return this._models[uri]}_getModels(){const all=[];return Object.keys(this._models).forEach((key=>all.push(this._models[key]))),all}acceptNewModel(data){this._models[data.url]=new MirrorModel(uri_1.URI.parse(data.url),data.lines,data.EOL,data.versionId)}acceptModelChanged(strURL,e){if(!this._models[strURL])return;this._models[strURL].onEvents(e)}acceptRemovedModel(strURL){this._models[strURL]&&delete this._models[strURL]}computeUnicodeHighlights(url,options,range){return __awaiter(this,void 0,void 0,(function*(){const model=this._getModel(url);return model?unicodeTextModelHighlighter_1.UnicodeTextModelHighlighter.computeUnicodeHighlights(model,options,range):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}))}computeDiff(originalUrl,modifiedUrl,ignoreTrimWhitespace,maxComputationTime){return __awaiter(this,void 0,void 0,(function*(){const original=this._getModel(originalUrl),modified=this._getModel(modifiedUrl);if(!original||!modified)return null;const originalLines=original.getLinesContent(),modifiedLines=modified.getLinesContent(),diffResult=new diffComputer_1.DiffComputer(originalLines,modifiedLines,{shouldComputeCharChanges:!0,shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:ignoreTrimWhitespace,shouldMakePrettyDiff:!0,maxComputationTime}).computeDiff(),identical=!(diffResult.changes.length>0)&&this._modelsAreIdentical(original,modified);return{quitEarly:diffResult.quitEarly,identical,changes:diffResult.changes}}))}_modelsAreIdentical(original,modified){const originalLineCount=original.getLineCount();if(originalLineCount!==modified.getLineCount())return!1;for(let line=1;line<=originalLineCount;line++){if(original.getLineContent(line)!==modified.getLineContent(line))return!1}return!0}computeMoreMinimalEdits(modelUrl,edits){return __awaiter(this,void 0,void 0,(function*(){const model=this._getModel(modelUrl);if(!model)return edits;const result=[];let lastEol;edits=edits.slice(0).sort(((a,b)=>{if(a.range&&b.range)return range_1.Range.compareRangesUsingStarts(a.range,b.range);return(a.range?0:1)-(b.range?0:1)}));for(let{range,text,eol}of edits){if("number"==typeof eol&&(lastEol=eol),range_1.Range.isEmpty(range)&&!text)continue;const original=model.getValueInRange(range);if(text=text.replace(/\r\n|\n|\r/g,model.eol),original===text)continue;if(Math.max(text.length,original.length)>EditorSimpleWorker._diffLimit){result.push({range,text});continue}const changes=(0,diff_1.stringDiff)(original,text,!1),editOffset=model.offsetAt(range_1.Range.lift(range).getStartPosition());for(const change of changes){const start=model.positionAt(editOffset+change.originalStart),end=model.positionAt(editOffset+change.originalStart+change.originalLength),newEdit={text:text.substr(change.modifiedStart,change.modifiedLength),range:{startLineNumber:start.lineNumber,startColumn:start.column,endLineNumber:end.lineNumber,endColumn:end.column}};model.getValueInRange(newEdit.range)!==newEdit.text&&result.push(newEdit)}}return"number"==typeof lastEol&&result.push({eol:lastEol,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),result}))}computeLinks(modelUrl){return __awaiter(this,void 0,void 0,(function*(){const model=this._getModel(modelUrl);return model?(0,linkComputer_1.computeLinks)(model):null}))}textualSuggest(modelUrls,leadingWord,wordDef,wordDefFlags){return __awaiter(this,void 0,void 0,(function*(){const sw=new stopwatch_1.StopWatch(!0),wordDefRegExp=new RegExp(wordDef,wordDefFlags),seen=new Set;outer:for(let url of modelUrls){const model=this._getModel(url);if(model)for(let word of model.words(wordDefRegExp))if(word!==leadingWord&&isNaN(Number(word))&&(seen.add(word),seen.size>EditorSimpleWorker._suggestionsLimit))break outer}return{words:Array.from(seen),duration:sw.elapsed()}}))}computeWordRanges(modelUrl,range,wordDef,wordDefFlags){return __awaiter(this,void 0,void 0,(function*(){const model=this._getModel(modelUrl);if(!model)return Object.create(null);const wordDefRegExp=new RegExp(wordDef,wordDefFlags),result=Object.create(null);for(let line=range.startLineNumber;line<range.endLineNumber;line++){const words=model.getLineWords(line,wordDefRegExp);for(const word of words){if(!isNaN(Number(word.word)))continue;let array=result[word.word];array||(array=[],result[word.word]=array),array.push({startLineNumber:line,startColumn:word.startColumn,endLineNumber:line,endColumn:word.endColumn})}}return result}))}navigateValueSet(modelUrl,range,up,wordDef,wordDefFlags){return __awaiter(this,void 0,void 0,(function*(){const model=this._getModel(modelUrl);if(!model)return null;const wordDefRegExp=new RegExp(wordDef,wordDefFlags);range.startColumn===range.endColumn&&(range={startLineNumber:range.startLineNumber,startColumn:range.startColumn,endLineNumber:range.endLineNumber,endColumn:range.endColumn+1});const selectionText=model.getValueInRange(range),wordRange=model.getWordAtPosition({lineNumber:range.startLineNumber,column:range.startColumn},wordDefRegExp);if(!wordRange)return null;const word=model.getValueInRange(wordRange);return inplaceReplaceSupport_1.BasicInplaceReplace.INSTANCE.navigateValueSet(range,selectionText,wordRange,word,up)}))}loadForeignModule(moduleId,createData,foreignHostMethods){const ctx={host:types.createProxyObject(foreignHostMethods,((method,args)=>this._host.fhr(method,args))),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(ctx,createData),Promise.resolve(types.getAllMethodNames(this._foreignModule))):new Promise(((resolve,reject)=>{require([moduleId],(foreignModule=>{this._foreignModule=foreignModule.create(ctx,createData),resolve(types.getAllMethodNames(this._foreignModule))}),reject)}))}fmr(method,args){if(!this._foreignModule||"function"!=typeof this._foreignModule[method])return Promise.reject(new Error("Missing requestHandler or method: "+method));try{return Promise.resolve(this._foreignModule[method].apply(this._foreignModule,args))}catch(e){return Promise.reject(e)}}}exports.EditorSimpleWorker=EditorSimpleWorker,EditorSimpleWorker._diffLimit=1e5,EditorSimpleWorker._suggestionsLimit=1e4,exports.create=function create(host){return new EditorSimpleWorker(host,null)},"function"==typeof importScripts&&(platform_1.globals.monaco=(0,editorBaseApi_1.createMonacoBaseAPI)())})),define(__m[438],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContiguousMultilineTokens=void 0;exports.ContiguousMultilineTokens=class ContiguousMultilineTokens{constructor(startLineNumber,tokens){this._startLineNumber=startLineNumber,this._tokens=tokens}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}getLineTokens(lineNumber){return this._tokens[lineNumber-this._startLineNumber]}appendLineTokens(lineTokens){this._tokens.push(lineTokens)}}})),define(__m[439],__M([1,0,438]),(function(require,exports,contiguousMultilineTokens_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContiguousMultilineTokensBuilder=void 0;exports.ContiguousMultilineTokensBuilder=class ContiguousMultilineTokensBuilder{constructor(){this._tokens=[]}add(lineNumber,lineTokens){if(this._tokens.length>0){const last=this._tokens[this._tokens.length-1];if(last.endLineNumber+1===lineNumber)return void last.appendLineTokens(lineTokens)}this._tokens.push(new contiguousMultilineTokens_1.ContiguousMultilineTokens(lineNumber,[lineTokens]))}finalize(){return this._tokens}}})),define(__m[77],__M([1,0,27]),(function(require,exports,languages_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LineTokens=void 0;class LineTokens{constructor(tokens,text,decoder){this._lineTokensBrand=void 0,this._tokens=tokens,this._tokensCount=this._tokens.length>>>1,this._text=text,this._languageIdCodec=decoder}static createEmpty(lineContent,decoder){const defaultMetadata=LineTokens.defaultTokenMetadata,tokens=new Uint32Array(2);return tokens[0]=lineContent.length,tokens[1]=defaultMetadata,new LineTokens(tokens,lineContent,decoder)}equals(other){return other instanceof LineTokens&&this.slicedEquals(other,0,this._tokensCount)}slicedEquals(other,sliceFromTokenIndex,sliceTokenCount){if(this._text!==other._text)return!1;if(this._tokensCount!==other._tokensCount)return!1;const from=sliceFromTokenIndex<<1,to=from+(sliceTokenCount<<1);for(let i=from;i<to;i++)if(this._tokens[i]!==other._tokens[i])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(tokenIndex){return tokenIndex>0?this._tokens[tokenIndex-1<<1]:0}getMetadata(tokenIndex){return this._tokens[1+(tokenIndex<<1)]}getLanguageId(tokenIndex){const metadata=this._tokens[1+(tokenIndex<<1)],languageId=languages_1.TokenMetadata.getLanguageId(metadata);return this._languageIdCodec.decodeLanguageId(languageId)}getStandardTokenType(tokenIndex){const metadata=this._tokens[1+(tokenIndex<<1)];return languages_1.TokenMetadata.getTokenType(metadata)}getForeground(tokenIndex){const metadata=this._tokens[1+(tokenIndex<<1)];return languages_1.TokenMetadata.getForeground(metadata)}getClassName(tokenIndex){const metadata=this._tokens[1+(tokenIndex<<1)];return languages_1.TokenMetadata.getClassNameFromMetadata(metadata)}getInlineStyle(tokenIndex,colorMap){const metadata=this._tokens[1+(tokenIndex<<1)];return languages_1.TokenMetadata.getInlineStyleFromMetadata(metadata,colorMap)}getPresentation(tokenIndex){const metadata=this._tokens[1+(tokenIndex<<1)];return languages_1.TokenMetadata.getPresentationFromMetadata(metadata)}getEndOffset(tokenIndex){return this._tokens[tokenIndex<<1]}findTokenIndexAtOffset(offset){return LineTokens.findIndexInTokensArray(this._tokens,offset)}inflate(){return this}sliceAndInflate(startOffset,endOffset,deltaOffset){return new SliceLineTokens(this,startOffset,endOffset,deltaOffset)}static convertToEndOffset(tokens,lineTextLength){const lastTokenIndex=(tokens.length>>>1)-1;for(let tokenIndex=0;tokenIndex<lastTokenIndex;tokenIndex++)tokens[tokenIndex<<1]=tokens[tokenIndex+1<<1];tokens[lastTokenIndex<<1]=lineTextLength}static findIndexInTokensArray(tokens,desiredIndex){if(tokens.length<=2)return 0;let low=0,high=(tokens.length>>>1)-1;for(;low<high;){const mid=low+Math.floor((high-low)/2),endOffset=tokens[mid<<1];if(endOffset===desiredIndex)return mid+1;endOffset<desiredIndex?low=mid+1:endOffset>desiredIndex&&(high=mid)}return low}withInserted(insertTokens){if(0===insertTokens.length)return this;let nextOriginalTokenIdx=0,nextInsertTokenIdx=0,text="";const newTokens=new Array;let originalEndOffset=0;for(;;){const nextOriginalTokenEndOffset=nextOriginalTokenIdx<this._tokensCount?this._tokens[nextOriginalTokenIdx<<1]:-1,nextInsertToken=nextInsertTokenIdx<insertTokens.length?insertTokens[nextInsertTokenIdx]:null;if(-1!==nextOriginalTokenEndOffset&&(null===nextInsertToken||nextOriginalTokenEndOffset<=nextInsertToken.offset)){text+=this._text.substring(originalEndOffset,nextOriginalTokenEndOffset);const metadata=this._tokens[1+(nextOriginalTokenIdx<<1)];newTokens.push(text.length,metadata),nextOriginalTokenIdx++,originalEndOffset=nextOriginalTokenEndOffset}else{if(!nextInsertToken)break;if(nextInsertToken.offset>originalEndOffset){text+=this._text.substring(originalEndOffset,nextInsertToken.offset);const metadata=this._tokens[1+(nextOriginalTokenIdx<<1)];newTokens.push(text.length,metadata),originalEndOffset=nextInsertToken.offset}text+=nextInsertToken.text,newTokens.push(text.length,nextInsertToken.tokenMetadata),nextInsertTokenIdx++}}return new LineTokens(new Uint32Array(newTokens),text,this._languageIdCodec)}}exports.LineTokens=LineTokens,LineTokens.defaultTokenMetadata=16793600;class SliceLineTokens{constructor(source,startOffset,endOffset,deltaOffset){this._source=source,this._startOffset=startOffset,this._endOffset=endOffset,this._deltaOffset=deltaOffset,this._firstTokenIndex=source.findTokenIndexAtOffset(startOffset),this._tokensCount=0;for(let i=this._firstTokenIndex,len=source.getCount();i<len;i++){if(source.getStartOffset(i)>=endOffset)break;this._tokensCount++}}getMetadata(tokenIndex){return this._source.getMetadata(this._firstTokenIndex+tokenIndex)}getLanguageId(tokenIndex){return this._source.getLanguageId(this._firstTokenIndex+tokenIndex)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(other){return other instanceof SliceLineTokens&&(this._startOffset===other._startOffset&&this._endOffset===other._endOffset&&this._deltaOffset===other._deltaOffset&&this._source.slicedEquals(other._source,this._firstTokenIndex,this._tokensCount))}getCount(){return this._tokensCount}getForeground(tokenIndex){return this._source.getForeground(this._firstTokenIndex+tokenIndex)}getEndOffset(tokenIndex){const tokenEndOffset=this._source.getEndOffset(this._firstTokenIndex+tokenIndex);return Math.min(this._endOffset,tokenEndOffset)-this._startOffset+this._deltaOffset}getClassName(tokenIndex){return this._source.getClassName(this._firstTokenIndex+tokenIndex)}getInlineStyle(tokenIndex,colorMap){return this._source.getInlineStyle(this._firstTokenIndex+tokenIndex,colorMap)}getPresentation(tokenIndex){return this._source.getPresentation(this._firstTokenIndex+tokenIndex)}findTokenIndexAtOffset(offset){return this._source.findTokenIndexAtOffset(offset+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}})),define(__m[253],__M([1,0,8,77,27,124]),(function(require,exports,strings,lineTokens_1,languages_1,nullTokenize_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._tokenizeToString=exports.tokenizeLineToHTML=exports.tokenizeToString=void 0;const fallback={getInitialState:()=>nullTokenize_1.NullState,tokenizeEncoded:(buffer,hasEOL,state)=>(0,nullTokenize_1.nullTokenizeEncoded)(0,state)};function _tokenizeToString(text,languageIdCodec,tokenizationSupport){let result='<div class="monaco-tokenized-source">';const lines=strings.splitLines(text);let currentState=tokenizationSupport.getInitialState();for(let i=0,len=lines.length;i<len;i++){const line=lines[i];i>0&&(result+="<br/>");const tokenizationResult=tokenizationSupport.tokenizeEncoded(line,!0,currentState);lineTokens_1.LineTokens.convertToEndOffset(tokenizationResult.tokens,line.length);const viewLineTokens=new lineTokens_1.LineTokens(tokenizationResult.tokens,line,languageIdCodec).inflate();let startOffset=0;for(let j=0,lenJ=viewLineTokens.getCount();j<lenJ;j++){const type=viewLineTokens.getClassName(j),endIndex=viewLineTokens.getEndOffset(j);result+=`<span class="${type}">${strings.escape(line.substring(startOffset,endIndex))}</span>`,startOffset=endIndex}currentState=tokenizationResult.endState}return result+="</div>",result}exports.tokenizeToString=function tokenizeToString(languageService,text,languageId){return __awaiter(this,void 0,void 0,(function*(){if(!languageId)return _tokenizeToString(text,languageService.languageIdCodec,fallback);const tokenizationSupport=yield languages_1.TokenizationRegistry.getOrCreate(languageId);return _tokenizeToString(text,languageService.languageIdCodec,tokenizationSupport||fallback)}))},exports.tokenizeLineToHTML=function tokenizeLineToHTML(text,viewLineTokens,colorMap,startOffset,endOffset,tabSize,useNbsp){let result="<div>",charIndex=startOffset,tabsCharDelta=0,prevIsSpace=!0;for(let tokenIndex=0,tokenCount=viewLineTokens.getCount();tokenIndex<tokenCount;tokenIndex++){const tokenEndIndex=viewLineTokens.getEndOffset(tokenIndex);if(tokenEndIndex<=startOffset)continue;let partContent="";for(;charIndex<tokenEndIndex&&charIndex<endOffset;charIndex++){const charCode=text.charCodeAt(charIndex);switch(charCode){case 9:{let insertSpacesCount=tabSize-(charIndex+tabsCharDelta)%tabSize;for(tabsCharDelta+=insertSpacesCount-1;insertSpacesCount>0;)useNbsp&&prevIsSpace?(partContent+="&#160;",prevIsSpace=!1):(partContent+=" ",prevIsSpace=!0),insertSpacesCount--;break}case 60:partContent+="&lt;",prevIsSpace=!1;break;case 62:partContent+="&gt;",prevIsSpace=!1;break;case 38:partContent+="&amp;",prevIsSpace=!1;break;case 0:partContent+="&#00;",prevIsSpace=!1;break;case 65279:case 8232:case 8233:case 133:partContent+="�",prevIsSpace=!1;break;case 13:partContent+="&#8203",prevIsSpace=!1;break;case 32:useNbsp&&prevIsSpace?(partContent+="&#160;",prevIsSpace=!1):(partContent+=" ",prevIsSpace=!0);break;default:partContent+=String.fromCharCode(charCode),prevIsSpace=!1}}if(result+=`<span style="${viewLineTokens.getInlineStyle(tokenIndex,colorMap)}">${partContent}</span>`,tokenEndIndex>endOffset||charIndex>=endOffset)break}return result+="</div>",result},exports._tokenizeToString=_tokenizeToString})),define(__m[440],__M([1,0,18,13,77,27,124,2,55,119,439,10,16]),(function(require,exports,arrays,errors_1,lineTokens_1,languages_1,nullTokenize_1,lifecycle_1,stopwatch_1,eolCounter_1,contiguousMultilineTokensBuilder_1,async_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextModelTokenization=exports.TokenizationStateStore=void 0;class ContiguousGrowingArray{constructor(_default){this._default=_default,this._store=[]}get(index){return index<this._store.length?this._store[index]:this._default}set(index,value){for(;index>=this._store.length;)this._store[this._store.length]=this._default;this._store[index]=value}delete(deleteIndex,deleteCount){0===deleteCount||deleteIndex>=this._store.length||this._store.splice(deleteIndex,deleteCount)}insert(insertIndex,insertCount){if(0===insertCount||insertIndex>=this._store.length)return;const arr=[];for(let i=0;i<insertCount;i++)arr[i]=this._default;this._store=arrays.arrayInsert(this._store,insertIndex,arr)}}class TokenizationStateStore{constructor(tokenizationSupport,initialState){this.tokenizationSupport=tokenizationSupport,this.initialState=initialState,this._lineBeginState=new ContiguousGrowingArray(null),this._lineNeedsTokenization=new ContiguousGrowingArray(!0),this._firstLineNeedsTokenization=0,this._lineBeginState.set(0,this.initialState)}get invalidLineStartIndex(){return this._firstLineNeedsTokenization}markMustBeTokenized(lineIndex){this._lineNeedsTokenization.set(lineIndex,!0),this._firstLineNeedsTokenization=Math.min(this._firstLineNeedsTokenization,lineIndex)}getBeginState(lineIndex){return this._lineBeginState.get(lineIndex)}setEndState(linesLength,lineIndex,endState){if(this._lineNeedsTokenization.set(lineIndex,!1),this._firstLineNeedsTokenization=lineIndex+1,lineIndex===linesLength-1)return;const previousEndState=this._lineBeginState.get(lineIndex+1);if(null===previousEndState||!endState.equals(previousEndState))return this._lineBeginState.set(lineIndex+1,endState),void this.markMustBeTokenized(lineIndex+1);let i=lineIndex+1;for(;i<linesLength&&!this._lineNeedsTokenization.get(i);)i++;this._firstLineNeedsTokenization=i}applyEdits(range,eolCount){this.markMustBeTokenized(range.startLineNumber-1),this._lineBeginState.delete(range.startLineNumber,range.endLineNumber-range.startLineNumber),this._lineNeedsTokenization.delete(range.startLineNumber,range.endLineNumber-range.startLineNumber),this._lineBeginState.insert(range.startLineNumber,eolCount),this._lineNeedsTokenization.insert(range.startLineNumber,eolCount)}}exports.TokenizationStateStore=TokenizationStateStore;class TextModelTokenization extends lifecycle_1.Disposable{constructor(_textModel,_languageIdCodec){super(),this._textModel=_textModel,this._languageIdCodec=_languageIdCodec,this._isScheduled=!1,this._isDisposed=!1,this._tokenizationStateStore=null,this._register(languages_1.TokenizationRegistry.onDidChange((e=>{const languageId=this._textModel.getLanguageId();-1!==e.changedLanguages.indexOf(languageId)&&(this._resetTokenizationState(),this._textModel.clearTokens())}))),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}handleDidChangeContent(e){if(e.isFlush)this._resetTokenizationState();else{if(this._tokenizationStateStore)for(let i=0,len=e.changes.length;i<len;i++){const change=e.changes[i],[eolCount]=(0,eolCounter_1.countEOL)(change.text);this._tokenizationStateStore.applyEdits(change.range,eolCount)}this._beginBackgroundTokenization()}}handleDidChangeAttached(){this._beginBackgroundTokenization()}handleDidChangeLanguage(e){this._resetTokenizationState(),this._textModel.clearTokens()}_resetTokenizationState(){const[tokenizationSupport,initialState]=function initializeTokenization(textModel){if(textModel.isTooLargeForTokenization())return[null,null];const tokenizationSupport=languages_1.TokenizationRegistry.get(textModel.getLanguageId());if(!tokenizationSupport)return[null,null];let initialState;try{initialState=tokenizationSupport.getInitialState()}catch(e){return(0,errors_1.onUnexpectedError)(e),[null,null]}return[tokenizationSupport,initialState]}(this._textModel);this._tokenizationStateStore=tokenizationSupport&&initialState?new TokenizationStateStore(tokenizationSupport,initialState):null,this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,(0,async_1.runWhenIdle)((deadline=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(deadline)})))}_backgroundTokenizeWithDeadline(deadline){const endTime=Date.now()+deadline.timeRemaining(),execute=()=>{!this._isDisposed&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<endTime?(0,platform_1.setTimeout0)(execute):this._beginBackgroundTokenization())};execute()}_backgroundTokenizeForAtLeast1ms(){const lineCount=this._textModel.getLineCount(),builder=new contiguousMultilineTokensBuilder_1.ContiguousMultilineTokensBuilder,sw=stopwatch_1.StopWatch.create(!1);do{if(sw.elapsed()>1)break;if(this._tokenizeOneInvalidLine(builder)>=lineCount)break}while(this._hasLinesToTokenize());this._textModel.setTokens(builder.finalize(),!this._hasLinesToTokenize())}tokenizeViewport(startLineNumber,endLineNumber){const builder=new contiguousMultilineTokensBuilder_1.ContiguousMultilineTokensBuilder;this._tokenizeViewport(builder,startLineNumber,endLineNumber),this._textModel.setTokens(builder.finalize(),!this._hasLinesToTokenize())}reset(){this._resetTokenizationState(),this._textModel.clearTokens()}forceTokenization(lineNumber){const builder=new contiguousMultilineTokensBuilder_1.ContiguousMultilineTokensBuilder;this._updateTokensUntilLine(builder,lineNumber),this._textModel.setTokens(builder.finalize(),!this._hasLinesToTokenize())}getTokenTypeIfInsertingCharacter(position,character){if(!this._tokenizationStateStore)return 0;this.forceTokenization(position.lineNumber);const lineStartState=this._tokenizationStateStore.getBeginState(position.lineNumber-1);if(!lineStartState)return 0;const languageId=this._textModel.getLanguageId(),lineContent=this._textModel.getLineContent(position.lineNumber),text=lineContent.substring(0,position.column-1)+character+lineContent.substring(position.column-1),r=safeTokenize(this._languageIdCodec,languageId,this._tokenizationStateStore.tokenizationSupport,text,!0,lineStartState),lineTokens=new lineTokens_1.LineTokens(r.tokens,text,this._languageIdCodec);if(0===lineTokens.getCount())return 0;const tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1);return lineTokens.getStandardTokenType(tokenIndex)}tokenizeLineWithEdit(position,length,newText){const lineNumber=position.lineNumber,column=position.column;if(!this._tokenizationStateStore)return null;this.forceTokenization(lineNumber);const lineStartState=this._tokenizationStateStore.getBeginState(lineNumber-1);if(!lineStartState)return null;const curLineContent=this._textModel.getLineContent(lineNumber),newLineContent=curLineContent.substring(0,column-1)+newText+curLineContent.substring(column-1+length),languageId=this._textModel.getLanguageIdAtPosition(lineNumber,0),result=safeTokenize(this._languageIdCodec,languageId,this._tokenizationStateStore.tokenizationSupport,newLineContent,!0,lineStartState);return new lineTokens_1.LineTokens(result.tokens,newLineContent,this._languageIdCodec)}isCheapToTokenize(lineNumber){if(!this._tokenizationStateStore)return!0;const firstInvalidLineNumber=this._tokenizationStateStore.invalidLineStartIndex+1;return!(lineNumber>firstInvalidLineNumber)&&(lineNumber<firstInvalidLineNumber||this._textModel.getLineLength(lineNumber)<2048)}_hasLinesToTokenize(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_tokenizeOneInvalidLine(builder){if(!this._tokenizationStateStore||!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const lineNumber=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(builder,lineNumber),lineNumber}_updateTokensUntilLine(builder,lineNumber){if(!this._tokenizationStateStore)return;const languageId=this._textModel.getLanguageId(),linesLength=this._textModel.getLineCount(),endLineIndex=lineNumber-1;for(let lineIndex=this._tokenizationStateStore.invalidLineStartIndex;lineIndex<=endLineIndex;lineIndex++){const text=this._textModel.getLineContent(lineIndex+1),lineStartState=this._tokenizationStateStore.getBeginState(lineIndex),r=safeTokenize(this._languageIdCodec,languageId,this._tokenizationStateStore.tokenizationSupport,text,!0,lineStartState);builder.add(lineIndex+1,r.tokens),this._tokenizationStateStore.setEndState(linesLength,lineIndex,r.endState),lineIndex=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(builder,startLineNumber,endLineNumber){if(!this._tokenizationStateStore)return;if(endLineNumber<=this._tokenizationStateStore.invalidLineStartIndex)return;if(startLineNumber<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(builder,endLineNumber);let nonWhitespaceColumn=this._textModel.getLineFirstNonWhitespaceColumn(startLineNumber);const fakeLines=[];let initialState=null;for(let i=startLineNumber-1;nonWhitespaceColumn>1&&i>=1;i--){const newNonWhitespaceIndex=this._textModel.getLineFirstNonWhitespaceColumn(i);if(0!==newNonWhitespaceIndex&&newNonWhitespaceIndex<nonWhitespaceColumn){if(initialState=this._tokenizationStateStore.getBeginState(i-1),initialState)break;fakeLines.push(this._textModel.getLineContent(i)),nonWhitespaceColumn=newNonWhitespaceIndex}}initialState||(initialState=this._tokenizationStateStore.initialState);const languageId=this._textModel.getLanguageId();let state=initialState;for(let i=fakeLines.length-1;i>=0;i--){state=safeTokenize(this._languageIdCodec,languageId,this._tokenizationStateStore.tokenizationSupport,fakeLines[i],!1,state).endState}for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const text=this._textModel.getLineContent(lineNumber),r=safeTokenize(this._languageIdCodec,languageId,this._tokenizationStateStore.tokenizationSupport,text,!0,state);builder.add(lineNumber,r.tokens),this._tokenizationStateStore.markMustBeTokenized(lineNumber-1),state=r.endState}}}function safeTokenize(languageIdCodec,languageId,tokenizationSupport,text,hasEOL,state){let r=null;if(tokenizationSupport)try{r=tokenizationSupport.tokenizeEncoded(text,hasEOL,state.clone())}catch(e){(0,errors_1.onUnexpectedError)(e)}return r||(r=(0,nullTokenize_1.nullTokenizeEncoded)(languageIdCodec.encodeLanguageId(languageId),state)),lineTokens_1.LineTokens.convertToEndOffset(r.tokens,text.length),r}exports.TextModelTokenization=TextModelTokenization})),define(__m[441],__M([1,0,77]),(function(require,exports,lineTokens_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toUint32Array=exports.ContiguousTokensEditing=exports.EMPTY_LINE_TOKENS=void 0,exports.EMPTY_LINE_TOKENS=new Uint32Array(0).buffer;class ContiguousTokensEditing{static deleteBeginning(lineTokens,toChIndex){return null===lineTokens||lineTokens===exports.EMPTY_LINE_TOKENS?lineTokens:ContiguousTokensEditing.delete(lineTokens,0,toChIndex)}static deleteEnding(lineTokens,fromChIndex){if(null===lineTokens||lineTokens===exports.EMPTY_LINE_TOKENS)return lineTokens;const tokens=toUint32Array(lineTokens),lineTextLength=tokens[tokens.length-2];return ContiguousTokensEditing.delete(lineTokens,fromChIndex,lineTextLength)}static delete(lineTokens,fromChIndex,toChIndex){if(null===lineTokens||lineTokens===exports.EMPTY_LINE_TOKENS||fromChIndex===toChIndex)return lineTokens;const tokens=toUint32Array(lineTokens),tokensCount=tokens.length>>>1;if(0===fromChIndex&&tokens[tokens.length-2]===toChIndex)return exports.EMPTY_LINE_TOKENS;const fromTokenIndex=lineTokens_1.LineTokens.findIndexInTokensArray(tokens,fromChIndex),fromTokenStartOffset=fromTokenIndex>0?tokens[fromTokenIndex-1<<1]:0;if(toChIndex<tokens[fromTokenIndex<<1]){const delta=toChIndex-fromChIndex;for(let i=fromTokenIndex;i<tokensCount;i++)tokens[i<<1]-=delta;return lineTokens}let dest,lastEnd;fromTokenStartOffset!==fromChIndex?(tokens[fromTokenIndex<<1]=fromChIndex,dest=fromTokenIndex+1<<1,lastEnd=fromChIndex):(dest=fromTokenIndex<<1,lastEnd=fromTokenStartOffset);const delta=toChIndex-fromChIndex;for(let tokenIndex=fromTokenIndex+1;tokenIndex<tokensCount;tokenIndex++){const tokenEndOffset=tokens[tokenIndex<<1]-delta;tokenEndOffset>lastEnd&&(tokens[dest++]=tokenEndOffset,tokens[dest++]=tokens[1+(tokenIndex<<1)],lastEnd=tokenEndOffset)}if(dest===tokens.length)return lineTokens;const tmp=new Uint32Array(dest);return tmp.set(tokens.subarray(0,dest),0),tmp.buffer}static append(lineTokens,_otherTokens){if(_otherTokens===exports.EMPTY_LINE_TOKENS)return lineTokens;if(lineTokens===exports.EMPTY_LINE_TOKENS)return _otherTokens;if(null===lineTokens)return lineTokens;if(null===_otherTokens)return null;const myTokens=toUint32Array(lineTokens),otherTokens=toUint32Array(_otherTokens),otherTokensCount=otherTokens.length>>>1,result=new Uint32Array(myTokens.length+otherTokens.length);result.set(myTokens,0);let dest=myTokens.length;const delta=myTokens[myTokens.length-2];for(let i=0;i<otherTokensCount;i++)result[dest++]=otherTokens[i<<1]+delta,result[dest++]=otherTokens[1+(i<<1)];return result.buffer}static insert(lineTokens,chIndex,textLength){if(null===lineTokens||lineTokens===exports.EMPTY_LINE_TOKENS)return lineTokens;const tokens=toUint32Array(lineTokens),tokensCount=tokens.length>>>1;let fromTokenIndex=lineTokens_1.LineTokens.findIndexInTokensArray(tokens,chIndex);if(fromTokenIndex>0){tokens[fromTokenIndex-1<<1]===chIndex&&fromTokenIndex--}for(let tokenIndex=fromTokenIndex;tokenIndex<tokensCount;tokenIndex++)tokens[tokenIndex<<1]+=textLength;return lineTokens}}function toUint32Array(arr){return arr instanceof Uint32Array?arr:new Uint32Array(arr)}exports.ContiguousTokensEditing=ContiguousTokensEditing,exports.toUint32Array=toUint32Array})),define(__m[442],__M([1,0,18,11,441,77,27]),(function(require,exports,arrays,position_1,contiguousTokensEditing_1,lineTokens_1,languages_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContiguousTokensStore=void 0;class ContiguousTokensStore{constructor(languageIdCodec){this._lineTokens=[],this._len=0,this._languageIdCodec=languageIdCodec}flush(){this._lineTokens=[],this._len=0}getTokens(topLevelLanguageId,lineIndex,lineText){let rawLineTokens=null;if(lineIndex<this._len&&(rawLineTokens=this._lineTokens[lineIndex]),null!==rawLineTokens&&rawLineTokens!==contiguousTokensEditing_1.EMPTY_LINE_TOKENS)return new lineTokens_1.LineTokens((0,contiguousTokensEditing_1.toUint32Array)(rawLineTokens),lineText,this._languageIdCodec);const lineTokens=new Uint32Array(2);return lineTokens[0]=lineText.length,lineTokens[1]=getDefaultMetadata(this._languageIdCodec.encodeLanguageId(topLevelLanguageId)),new lineTokens_1.LineTokens(lineTokens,lineText,this._languageIdCodec)}static _massageTokens(topLevelLanguageId,lineTextLength,_tokens){const tokens=_tokens?(0,contiguousTokensEditing_1.toUint32Array)(_tokens):null;if(0===lineTextLength){let hasDifferentLanguageId=!1;if(tokens&&tokens.length>1&&(hasDifferentLanguageId=languages_1.TokenMetadata.getLanguageId(tokens[1])!==topLevelLanguageId),!hasDifferentLanguageId)return contiguousTokensEditing_1.EMPTY_LINE_TOKENS}if(!tokens||0===tokens.length){const tokens=new Uint32Array(2);return tokens[0]=lineTextLength,tokens[1]=getDefaultMetadata(topLevelLanguageId),tokens.buffer}return tokens[tokens.length-2]=lineTextLength,0===tokens.byteOffset&&tokens.byteLength===tokens.buffer.byteLength?tokens.buffer:tokens}_ensureLine(lineIndex){for(;lineIndex>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(start,deleteCount){0!==deleteCount&&(start+deleteCount>this._len&&(deleteCount=this._len-start),this._lineTokens.splice(start,deleteCount),this._len-=deleteCount)}_insertLines(insertIndex,insertCount){if(0===insertCount)return;const lineTokens=[];for(let i=0;i<insertCount;i++)lineTokens[i]=null;this._lineTokens=arrays.arrayInsert(this._lineTokens,insertIndex,lineTokens),this._len+=insertCount}setTokens(topLevelLanguageId,lineIndex,lineTextLength,_tokens,checkEquality){const tokens=ContiguousTokensStore._massageTokens(this._languageIdCodec.encodeLanguageId(topLevelLanguageId),lineTextLength,_tokens);this._ensureLine(lineIndex);const oldTokens=this._lineTokens[lineIndex];return this._lineTokens[lineIndex]=tokens,!!checkEquality&&!ContiguousTokensStore._equals(oldTokens,tokens)}static _equals(_a,_b){if(!_a||!_b)return!_a&&!_b;const a=(0,contiguousTokensEditing_1.toUint32Array)(_a),b=(0,contiguousTokensEditing_1.toUint32Array)(_b);if(a.length!==b.length)return!1;for(let i=0,len=a.length;i<len;i++)if(a[i]!==b[i])return!1;return!0}acceptEdit(range,eolCount,firstLineLength){this._acceptDeleteRange(range),this._acceptInsertText(new position_1.Position(range.startLineNumber,range.startColumn),eolCount,firstLineLength)}_acceptDeleteRange(range){const firstLineIndex=range.startLineNumber-1;if(firstLineIndex>=this._len)return;if(range.startLineNumber===range.endLineNumber){if(range.startColumn===range.endColumn)return;return void(this._lineTokens[firstLineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.delete(this._lineTokens[firstLineIndex],range.startColumn-1,range.endColumn-1))}this._lineTokens[firstLineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.deleteEnding(this._lineTokens[firstLineIndex],range.startColumn-1);const lastLineIndex=range.endLineNumber-1;let lastLineTokens=null;lastLineIndex<this._len&&(lastLineTokens=contiguousTokensEditing_1.ContiguousTokensEditing.deleteBeginning(this._lineTokens[lastLineIndex],range.endColumn-1)),this._lineTokens[firstLineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.append(this._lineTokens[firstLineIndex],lastLineTokens),this._deleteLines(range.startLineNumber,range.endLineNumber-range.startLineNumber)}_acceptInsertText(position,eolCount,firstLineLength){if(0===eolCount&&0===firstLineLength)return;const lineIndex=position.lineNumber-1;lineIndex>=this._len||(0!==eolCount?(this._lineTokens[lineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.deleteEnding(this._lineTokens[lineIndex],position.column-1),this._lineTokens[lineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.insert(this._lineTokens[lineIndex],position.column-1,firstLineLength),this._insertLines(position.lineNumber,eolCount)):this._lineTokens[lineIndex]=contiguousTokensEditing_1.ContiguousTokensEditing.insert(this._lineTokens[lineIndex],position.column-1,firstLineLength))}}function getDefaultMetadata(topLevelLanguageId){return(16384|topLevelLanguageId<<0|2<<23)>>>0}exports.ContiguousTokensStore=ContiguousTokensStore})),define(__m[443],__M([1,0,11,3,119]),(function(require,exports,position_1,range_1,eolCounter_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SparseLineTokens=exports.SparseMultilineTokens=void 0;class SparseMultilineTokens{constructor(startLineNumber,tokens){this._startLineNumber=startLineNumber,this._tokens=tokens,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}static create(startLineNumber,tokens){return new SparseMultilineTokens(startLineNumber,new SparseMultilineTokensStorage(tokens))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(lineNumber){return this._startLineNumber<=lineNumber&&lineNumber<=this._endLineNumber?this._tokens.getLineTokens(lineNumber-this._startLineNumber):null}getRange(){const deltaRange=this._tokens.getRange();return deltaRange?new range_1.Range(this._startLineNumber+deltaRange.startLineNumber,deltaRange.startColumn,this._startLineNumber+deltaRange.endLineNumber,deltaRange.endColumn):deltaRange}removeTokens(range){const startLineIndex=range.startLineNumber-this._startLineNumber,endLineIndex=range.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(startLineIndex,range.startColumn-1,endLineIndex,range.endColumn-1),this._updateEndLineNumber()}split(range){const startLineIndex=range.startLineNumber-this._startLineNumber,endLineIndex=range.endLineNumber-this._startLineNumber,[a,b,bDeltaLine]=this._tokens.split(startLineIndex,range.startColumn-1,endLineIndex,range.endColumn-1);return[new SparseMultilineTokens(this._startLineNumber,a),new SparseMultilineTokens(this._startLineNumber+bDeltaLine,b)]}applyEdit(range,text){const[eolCount,firstLineLength,lastLineLength]=(0,eolCounter_1.countEOL)(text);this.acceptEdit(range,eolCount,firstLineLength,lastLineLength,text.length>0?text.charCodeAt(0):0)}acceptEdit(range,eolCount,firstLineLength,lastLineLength,firstCharCode){this._acceptDeleteRange(range),this._acceptInsertText(new position_1.Position(range.startLineNumber,range.startColumn),eolCount,firstLineLength,lastLineLength,firstCharCode),this._updateEndLineNumber()}_acceptDeleteRange(range){if(range.startLineNumber===range.endLineNumber&&range.startColumn===range.endColumn)return;const firstLineIndex=range.startLineNumber-this._startLineNumber,lastLineIndex=range.endLineNumber-this._startLineNumber;if(lastLineIndex<0){const deletedLinesCount=lastLineIndex-firstLineIndex;return void(this._startLineNumber-=deletedLinesCount)}const tokenMaxDeltaLine=this._tokens.getMaxDeltaLine();if(!(firstLineIndex>=tokenMaxDeltaLine+1)){if(firstLineIndex<0&&lastLineIndex>=tokenMaxDeltaLine+1)return this._startLineNumber=0,void this._tokens.clear();if(firstLineIndex<0){const deletedBefore=-firstLineIndex;this._startLineNumber-=deletedBefore,this._tokens.acceptDeleteRange(range.startColumn-1,0,0,lastLineIndex,range.endColumn-1)}else this._tokens.acceptDeleteRange(0,firstLineIndex,range.startColumn-1,lastLineIndex,range.endColumn-1)}}_acceptInsertText(position,eolCount,firstLineLength,lastLineLength,firstCharCode){if(0===eolCount&&0===firstLineLength)return;const lineIndex=position.lineNumber-this._startLineNumber;if(lineIndex<0)return void(this._startLineNumber+=eolCount);lineIndex>=this._tokens.getMaxDeltaLine()+1||this._tokens.acceptInsertText(lineIndex,position.column-1,eolCount,firstLineLength,lastLineLength,firstCharCode)}}exports.SparseMultilineTokens=SparseMultilineTokens;class SparseMultilineTokensStorage{constructor(tokens){this._tokens=tokens,this._tokenCount=tokens.length/4}toString(startLineNumber){const pieces=[];for(let i=0;i<this._tokenCount;i++)pieces.push(`(${this._getDeltaLine(i)+startLineNumber},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${pieces.join(",")}]`}getMaxDeltaLine(){const tokenCount=this._getTokenCount();return 0===tokenCount?-1:this._getDeltaLine(tokenCount-1)}getRange(){const tokenCount=this._getTokenCount();if(0===tokenCount)return null;const startChar=this._getStartCharacter(0),maxDeltaLine=this._getDeltaLine(tokenCount-1),endChar=this._getEndCharacter(tokenCount-1);return new range_1.Range(0,startChar+1,maxDeltaLine,endChar+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(tokenIndex){return this._tokens[4*tokenIndex]}_getStartCharacter(tokenIndex){return this._tokens[4*tokenIndex+1]}_getEndCharacter(tokenIndex){return this._tokens[4*tokenIndex+2]}isEmpty(){return 0===this._getTokenCount()}getLineTokens(deltaLine){let low=0,high=this._getTokenCount()-1;for(;low<high;){const mid=low+Math.floor((high-low)/2),midDeltaLine=this._getDeltaLine(mid);if(midDeltaLine<deltaLine)low=mid+1;else{if(!(midDeltaLine>deltaLine)){let min=mid;for(;min>low&&this._getDeltaLine(min-1)===deltaLine;)min--;let max=mid;for(;max<high&&this._getDeltaLine(max+1)===deltaLine;)max++;return new SparseLineTokens(this._tokens.subarray(4*min,4*max+4))}high=mid-1}}return this._getDeltaLine(low)===deltaLine?new SparseLineTokens(this._tokens.subarray(4*low,4*low+4)):null}clear(){this._tokenCount=0}removeTokens(startDeltaLine,startChar,endDeltaLine,endChar){const tokens=this._tokens,tokenCount=this._tokenCount;let newTokenCount=0,hasDeletedTokens=!1,firstDeltaLine=0;for(let i=0;i<tokenCount;i++){const srcOffset=4*i,tokenDeltaLine=tokens[srcOffset],tokenStartCharacter=tokens[srcOffset+1],tokenEndCharacter=tokens[srcOffset+2],tokenMetadata=tokens[srcOffset+3];if((tokenDeltaLine>startDeltaLine||tokenDeltaLine===startDeltaLine&&tokenEndCharacter>=startChar)&&(tokenDeltaLine<endDeltaLine||tokenDeltaLine===endDeltaLine&&tokenStartCharacter<=endChar))hasDeletedTokens=!0;else{if(0===newTokenCount&&(firstDeltaLine=tokenDeltaLine),hasDeletedTokens){const destOffset=4*newTokenCount;tokens[destOffset]=tokenDeltaLine-firstDeltaLine,tokens[destOffset+1]=tokenStartCharacter,tokens[destOffset+2]=tokenEndCharacter,tokens[destOffset+3]=tokenMetadata}newTokenCount++}}return this._tokenCount=newTokenCount,firstDeltaLine}split(startDeltaLine,startChar,endDeltaLine,endChar){const tokens=this._tokens,tokenCount=this._tokenCount,aTokens=[],bTokens=[];let destTokens=aTokens,destOffset=0,destFirstDeltaLine=0;for(let i=0;i<tokenCount;i++){const srcOffset=4*i,tokenDeltaLine=tokens[srcOffset],tokenStartCharacter=tokens[srcOffset+1],tokenEndCharacter=tokens[srcOffset+2],tokenMetadata=tokens[srcOffset+3];if(tokenDeltaLine>startDeltaLine||tokenDeltaLine===startDeltaLine&&tokenEndCharacter>=startChar){if(tokenDeltaLine<endDeltaLine||tokenDeltaLine===endDeltaLine&&tokenStartCharacter<=endChar)continue;destTokens!==bTokens&&(destTokens=bTokens,destOffset=0,destFirstDeltaLine=tokenDeltaLine)}destTokens[destOffset++]=tokenDeltaLine-destFirstDeltaLine,destTokens[destOffset++]=tokenStartCharacter,destTokens[destOffset++]=tokenEndCharacter,destTokens[destOffset++]=tokenMetadata}return[new SparseMultilineTokensStorage(new Uint32Array(aTokens)),new SparseMultilineTokensStorage(new Uint32Array(bTokens)),destFirstDeltaLine]}acceptDeleteRange(horizontalShiftForFirstLineTokens,startDeltaLine,startCharacter,endDeltaLine,endCharacter){const tokens=this._tokens,tokenCount=this._tokenCount,deletedLineCount=endDeltaLine-startDeltaLine;let newTokenCount=0,hasDeletedTokens=!1;for(let i=0;i<tokenCount;i++){const srcOffset=4*i;let tokenDeltaLine=tokens[srcOffset],tokenStartCharacter=tokens[srcOffset+1],tokenEndCharacter=tokens[srcOffset+2];const tokenMetadata=tokens[srcOffset+3];if(tokenDeltaLine<startDeltaLine||tokenDeltaLine===startDeltaLine&&tokenEndCharacter<=startCharacter){newTokenCount++;continue}if(tokenDeltaLine===startDeltaLine&&tokenStartCharacter<startCharacter)tokenDeltaLine===endDeltaLine&&tokenEndCharacter>endCharacter?tokenEndCharacter-=endCharacter-startCharacter:tokenEndCharacter=startCharacter;else if(tokenDeltaLine===startDeltaLine&&tokenStartCharacter===startCharacter){if(!(tokenDeltaLine===endDeltaLine&&tokenEndCharacter>endCharacter)){hasDeletedTokens=!0;continue}tokenEndCharacter-=endCharacter-startCharacter}else if(tokenDeltaLine<endDeltaLine||tokenDeltaLine===endDeltaLine&&tokenStartCharacter<endCharacter){if(!(tokenDeltaLine===endDeltaLine&&tokenEndCharacter>endCharacter)){hasDeletedTokens=!0;continue}tokenDeltaLine===startDeltaLine?(tokenStartCharacter=startCharacter,tokenEndCharacter=tokenStartCharacter+(tokenEndCharacter-endCharacter)):(tokenStartCharacter=0,tokenEndCharacter=tokenStartCharacter+(tokenEndCharacter-endCharacter))}else if(tokenDeltaLine>endDeltaLine){if(0===deletedLineCount&&!hasDeletedTokens){newTokenCount=tokenCount;break}tokenDeltaLine-=deletedLineCount}else{if(!(tokenDeltaLine===endDeltaLine&&tokenStartCharacter>=endCharacter))throw new Error("Not possible!");horizontalShiftForFirstLineTokens&&0===tokenDeltaLine&&(tokenStartCharacter+=horizontalShiftForFirstLineTokens,tokenEndCharacter+=horizontalShiftForFirstLineTokens),tokenDeltaLine-=deletedLineCount,tokenStartCharacter-=endCharacter-startCharacter,tokenEndCharacter-=endCharacter-startCharacter}const destOffset=4*newTokenCount;tokens[destOffset]=tokenDeltaLine,tokens[destOffset+1]=tokenStartCharacter,tokens[destOffset+2]=tokenEndCharacter,tokens[destOffset+3]=tokenMetadata,newTokenCount++}this._tokenCount=newTokenCount}acceptInsertText(deltaLine,character,eolCount,firstLineLength,lastLineLength,firstCharCode){const isInsertingPreciselyOneWordCharacter=0===eolCount&&1===firstLineLength&&(firstCharCode>=48&&firstCharCode<=57||firstCharCode>=65&&firstCharCode<=90||firstCharCode>=97&&firstCharCode<=122),tokens=this._tokens,tokenCount=this._tokenCount;for(let i=0;i<tokenCount;i++){const offset=4*i;let tokenDeltaLine=tokens[offset],tokenStartCharacter=tokens[offset+1],tokenEndCharacter=tokens[offset+2];if(!(tokenDeltaLine<deltaLine||tokenDeltaLine===deltaLine&&tokenEndCharacter<character)){if(tokenDeltaLine===deltaLine&&tokenEndCharacter===character){if(!isInsertingPreciselyOneWordCharacter)continue;tokenEndCharacter+=1}else if(tokenDeltaLine===deltaLine&&tokenStartCharacter<character&&character<tokenEndCharacter)0===eolCount?tokenEndCharacter+=firstLineLength:tokenEndCharacter=character;else{if(tokenDeltaLine===deltaLine&&tokenStartCharacter===character&&isInsertingPreciselyOneWordCharacter)continue;if(tokenDeltaLine===deltaLine)if(tokenDeltaLine+=eolCount,0===eolCount)tokenStartCharacter+=firstLineLength,tokenEndCharacter+=firstLineLength;else{const tokenLength=tokenEndCharacter-tokenStartCharacter;tokenStartCharacter=lastLineLength+(tokenStartCharacter-character),tokenEndCharacter=tokenStartCharacter+tokenLength}else tokenDeltaLine+=eolCount}tokens[offset]=tokenDeltaLine,tokens[offset+1]=tokenStartCharacter,tokens[offset+2]=tokenEndCharacter}}}}class SparseLineTokens{constructor(tokens){this._tokens=tokens}getCount(){return this._tokens.length/4}getStartCharacter(tokenIndex){return this._tokens[4*tokenIndex+1]}getEndCharacter(tokenIndex){return this._tokens[4*tokenIndex+2]}getMetadata(tokenIndex){return this._tokens[4*tokenIndex+3]}}exports.SparseLineTokens=SparseLineTokens})),define(__m[444],__M([1,0,18,77]),(function(require,exports,arrays,lineTokens_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SparseTokensStore=void 0;class SparseTokensStore{constructor(languageIdCodec){this._pieces=[],this._isComplete=!1,this._languageIdCodec=languageIdCodec}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return 0===this._pieces.length}set(pieces,isComplete){this._pieces=pieces||[],this._isComplete=isComplete}setPartial(_range,pieces){let range=_range;if(pieces.length>0){const _firstRange=pieces[0].getRange(),_lastRange=pieces[pieces.length-1].getRange();if(!_firstRange||!_lastRange)return _range;range=_range.plusRange(_firstRange).plusRange(_lastRange)}let insertPosition=null;for(let i=0,len=this._pieces.length;i<len;i++){const piece=this._pieces[i];if(piece.endLineNumber<range.startLineNumber)continue;if(piece.startLineNumber>range.endLineNumber){insertPosition=insertPosition||{index:i};break}if(piece.removeTokens(range),piece.isEmpty()){this._pieces.splice(i,1),i--,len--;continue}if(piece.endLineNumber<range.startLineNumber)continue;if(piece.startLineNumber>range.endLineNumber){insertPosition=insertPosition||{index:i};continue}const[a,b]=piece.split(range);a.isEmpty()?insertPosition=insertPosition||{index:i}:b.isEmpty()||(this._pieces.splice(i,1,a,b),i++,len++,insertPosition=insertPosition||{index:i})}return insertPosition=insertPosition||{index:this._pieces.length},pieces.length>0&&(this._pieces=arrays.arrayInsert(this._pieces,insertPosition.index,pieces)),range}isComplete(){return this._isComplete}addSparseTokens(lineNumber,aTokens){const pieces=this._pieces;if(0===pieces.length)return aTokens;const bTokens=pieces[SparseTokensStore._findFirstPieceWithLine(pieces,lineNumber)].getLineTokens(lineNumber);if(!bTokens)return aTokens;const aLen=aTokens.getCount(),bLen=bTokens.getCount();let aIndex=0;const result=[];let resultLen=0,lastEndOffset=0;const emitToken=(endOffset,metadata)=>{endOffset!==lastEndOffset&&(lastEndOffset=endOffset,result[resultLen++]=endOffset,result[resultLen++]=metadata)};for(let bIndex=0;bIndex<bLen;bIndex++){const bStartCharacter=bTokens.getStartCharacter(bIndex),bEndCharacter=bTokens.getEndCharacter(bIndex),bMetadata=bTokens.getMetadata(bIndex),bMask=((1&bMetadata?1024:0)|(2&bMetadata?2048:0)|(4&bMetadata?4096:0)|(8&bMetadata?8192:0)|(16&bMetadata?8372224:0)|(32&bMetadata?4286578688:0))>>>0,aMask=~bMask>>>0;for(;aIndex<aLen&&aTokens.getEndOffset(aIndex)<=bStartCharacter;)emitToken(aTokens.getEndOffset(aIndex),aTokens.getMetadata(aIndex)),aIndex++;for(aIndex<aLen&&aTokens.getStartOffset(aIndex)<bStartCharacter&&emitToken(bStartCharacter,aTokens.getMetadata(aIndex));aIndex<aLen&&aTokens.getEndOffset(aIndex)<bEndCharacter;)emitToken(aTokens.getEndOffset(aIndex),aTokens.getMetadata(aIndex)&aMask|bMetadata&bMask),aIndex++;if(aIndex<aLen)emitToken(bEndCharacter,aTokens.getMetadata(aIndex)&aMask|bMetadata&bMask),aTokens.getEndOffset(aIndex)===bEndCharacter&&aIndex++;else{const aMergeIndex=Math.min(Math.max(0,aIndex-1),aLen-1);emitToken(bEndCharacter,aTokens.getMetadata(aMergeIndex)&aMask|bMetadata&bMask)}}for(;aIndex<aLen;)emitToken(aTokens.getEndOffset(aIndex),aTokens.getMetadata(aIndex)),aIndex++;return new lineTokens_1.LineTokens(new Uint32Array(result),aTokens.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(pieces,lineNumber){let low=0,high=pieces.length-1;for(;low<high;){let mid=low+Math.floor((high-low)/2);if(pieces[mid].endLineNumber<lineNumber)low=mid+1;else{if(!(pieces[mid].startLineNumber>lineNumber)){for(;mid>low&&pieces[mid-1].startLineNumber<=lineNumber&&lineNumber<=pieces[mid-1].endLineNumber;)mid--;return mid}high=mid-1}}return low}acceptEdit(range,eolCount,firstLineLength,lastLineLength,firstCharCode){for(const piece of this._pieces)piece.acceptEdit(range,eolCount,firstLineLength,lastLineLength,firstCharCode)}}exports.SparseTokensStore=SparseTokensStore})),define(__m[125],__M([1,0,2]),(function(require,exports,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewEventHandler=void 0;class ViewEventHandler extends lifecycle_1.Disposable{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(events){let shouldRender=!1;for(let i=0,len=events.length;i<len;i++){const e=events[i];switch(e.type){case 0:this.onCompositionStart(e)&&(shouldRender=!0);break;case 1:this.onCompositionEnd(e)&&(shouldRender=!0);break;case 2:this.onConfigurationChanged(e)&&(shouldRender=!0);break;case 3:this.onCursorStateChanged(e)&&(shouldRender=!0);break;case 4:this.onDecorationsChanged(e)&&(shouldRender=!0);break;case 5:this.onFlushed(e)&&(shouldRender=!0);break;case 6:this.onFocusChanged(e)&&(shouldRender=!0);break;case 7:this.onLanguageConfigurationChanged(e)&&(shouldRender=!0);break;case 8:this.onLineMappingChanged(e)&&(shouldRender=!0);break;case 9:this.onLinesChanged(e)&&(shouldRender=!0);break;case 10:this.onLinesDeleted(e)&&(shouldRender=!0);break;case 11:this.onLinesInserted(e)&&(shouldRender=!0);break;case 12:this.onRevealRangeRequest(e)&&(shouldRender=!0);break;case 13:this.onScrollChanged(e)&&(shouldRender=!0);break;case 15:this.onTokensChanged(e)&&(shouldRender=!0);break;case 14:this.onThemeChanged(e)&&(shouldRender=!0);break;case 16:this.onTokensColorsChanged(e)&&(shouldRender=!0);break;case 17:this.onZonesChanged(e)&&(shouldRender=!0);break;default:console.info("View received unknown event: "),console.info(e)}}shouldRender&&(this._shouldRender=!0)}}exports.ViewEventHandler=ViewEventHandler})),define(__m[102],__M([1,0,125]),(function(require,exports,viewEventHandler_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicViewOverlay=void 0;class DynamicViewOverlay extends viewEventHandler_1.ViewEventHandler{}exports.DynamicViewOverlay=DynamicViewOverlay})),define(__m[51],__M([1,0,125]),(function(require,exports,viewEventHandler_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PartFingerprints=exports.ViewPart=void 0;class ViewPart extends viewEventHandler_1.ViewEventHandler{constructor(context){super(),this._context=context,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}exports.ViewPart=ViewPart;exports.PartFingerprints=class PartFingerprints{static write(target,partId){target.setAttribute("data-mprt",String(partId))}static read(target){const r=target.getAttribute("data-mprt");return null===r?0:parseInt(r,10)}static collect(child,stopAt){const result=[];let resultLen=0;for(;child&&child!==document.body&&child!==stopAt;)child.nodeType===child.ELEMENT_NODE&&(result[resultLen++]=this.read(child)),child=child.parentElement;const r=new Uint8Array(resultLen);for(let i=0;i<resultLen;i++)r[i]=result[resultLen-i-1];return r}}})),define(__m[445],__M([1,0,7,31,51]),(function(require,exports,dom,fastDomNode_1,viewPart_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewContentWidgets=void 0;class Coordinate{constructor(top,left){this._coordinateBrand=void 0,this.top=top,this.left=left}}class ViewContentWidgets extends viewPart_1.ViewPart{constructor(context,viewDomNode){super(context),this._viewDomNode=viewDomNode,this._widgets={},this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),viewPart_1.PartFingerprints.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),viewPart_1.PartFingerprints.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const keys=Object.keys(this._widgets);for(const widgetId of keys)this._widgets[widgetId].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){const keys=Object.keys(this._widgets);for(const widgetId of keys)this._widgets[widgetId].onLineMappingChanged(e);return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}addWidget(_widget){const myWidget=new Widget(this._context,this._viewDomNode,_widget);this._widgets[myWidget.id]=myWidget,myWidget.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode):this.domNode.appendChild(myWidget.domNode),this.setShouldRender()}setWidgetPosition(widget,range,preference){this._widgets[widget.getId()].setPosition(range,preference),this.setShouldRender()}removeWidget(widget){const widgetId=widget.getId();if(this._widgets.hasOwnProperty(widgetId)){const myWidget=this._widgets[widgetId];delete this._widgets[widgetId];const domNode=myWidget.domNode.domNode;domNode.parentNode.removeChild(domNode),domNode.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(widgetId){return!!this._widgets.hasOwnProperty(widgetId)&&this._widgets[widgetId].suppressMouseDown}onBeforeRender(viewportData){const keys=Object.keys(this._widgets);for(const widgetId of keys)this._widgets[widgetId].onBeforeRender(viewportData)}prepareRender(ctx){const keys=Object.keys(this._widgets);for(const widgetId of keys)this._widgets[widgetId].prepareRender(ctx)}render(ctx){const keys=Object.keys(this._widgets);for(const widgetId of keys)this._widgets[widgetId].render(ctx)}}exports.ViewContentWidgets=ViewContentWidgets;class Widget{constructor(context,viewDomNode,actual){this._context=context,this._viewDomNode=viewDomNode,this._actual=actual,this.domNode=(0,fastDomNode_1.createFastDomNode)(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const options=this._context.configuration.options,layoutInfo=options.get(131);this._fixedOverflowWidgets=options.get(36),this._contentWidth=layoutInfo.contentWidth,this._contentLeft=layoutInfo.contentLeft,this._lineHeight=options.get(59),this._range=null,this._viewRange=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const options=this._context.configuration.options;if(this._lineHeight=options.get(59),e.hasChanged(131)){const layoutInfo=options.get(131);this._contentLeft=layoutInfo.contentLeft,this._contentWidth=layoutInfo.contentWidth,this._maxWidth=this._getMaxWidth()}}onLineMappingChanged(e){this._setPosition(this._range)}_setPosition(range){if(this._range=range,this._viewRange=null,this._range){const validModelRange=this._context.viewModel.model.validateRange(this._range);(this._context.viewModel.coordinatesConverter.modelPositionIsVisible(validModelRange.getStartPosition())||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(validModelRange.getEndPosition()))&&(this._viewRange=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(validModelRange))}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth:this._contentWidth}setPosition(range,preference){this._setPosition(range),this._preference=preference,this._viewRange&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(topLeft,bottomLeft,width,height,ctx){const aboveLineTop=topLeft.top,heightAboveLine=aboveLineTop,underLineTop=bottomLeft.top+this._lineHeight,aboveTop=aboveLineTop-height,fitsAbove=heightAboveLine>=height,belowTop=underLineTop,fitsBelow=ctx.viewportHeight-underLineTop>=height;let actualAboveLeft=topLeft.left,actualBelowLeft=bottomLeft.left;return actualAboveLeft+width>ctx.scrollLeft+ctx.viewportWidth&&(actualAboveLeft=ctx.scrollLeft+ctx.viewportWidth-width),actualBelowLeft+width>ctx.scrollLeft+ctx.viewportWidth&&(actualBelowLeft=ctx.scrollLeft+ctx.viewportWidth-width),actualAboveLeft<ctx.scrollLeft&&(actualAboveLeft=ctx.scrollLeft),actualBelowLeft<ctx.scrollLeft&&(actualBelowLeft=ctx.scrollLeft),{fitsAbove,aboveTop,aboveLeft:actualAboveLeft,fitsBelow,belowTop,belowLeft:actualBelowLeft}}_layoutHorizontalSegmentInPage(windowSize,domNodePosition,left,width){const MIN_LIMIT=Math.max(0,domNodePosition.left-width),MAX_LIMIT=Math.min(domNodePosition.left+domNodePosition.width+width,windowSize.width);let absoluteLeft=domNodePosition.left+left-dom.StandardWindow.scrollX;if(absoluteLeft+width>MAX_LIMIT){const delta=absoluteLeft-(MAX_LIMIT-width);absoluteLeft-=delta,left-=delta}if(absoluteLeft<MIN_LIMIT){const delta=absoluteLeft-MIN_LIMIT;absoluteLeft-=delta,left-=delta}return[left,absoluteLeft]}_layoutBoxInPage(topLeft,bottomLeft,width,height,ctx){const aboveTop=topLeft.top-height,belowTop=bottomLeft.top+this._lineHeight,domNodePosition=dom.getDomNodePagePosition(this._viewDomNode.domNode),absoluteAboveTop=domNodePosition.top+aboveTop-dom.StandardWindow.scrollY,absoluteBelowTop=domNodePosition.top+belowTop-dom.StandardWindow.scrollY,windowSize=dom.getClientArea(document.body),[aboveLeft,absoluteAboveLeft]=this._layoutHorizontalSegmentInPage(windowSize,domNodePosition,topLeft.left-ctx.scrollLeft+this._contentLeft,width),[belowLeft,absoluteBelowLeft]=this._layoutHorizontalSegmentInPage(windowSize,domNodePosition,bottomLeft.left-ctx.scrollLeft+this._contentLeft,width),fitsAbove=absoluteAboveTop>=22,fitsBelow=absoluteBelowTop+height<=windowSize.height-22;return this._fixedOverflowWidgets?{fitsAbove,aboveTop:Math.max(absoluteAboveTop,22),aboveLeft:absoluteAboveLeft,fitsBelow,belowTop:absoluteBelowTop,belowLeft:absoluteBelowLeft}:{fitsAbove,aboveTop,aboveLeft,fitsBelow,belowTop,belowLeft}}_prepareRenderWidgetAtExactPositionOverflowing(topLeft){return new Coordinate(topLeft.top,topLeft.left+this._contentLeft)}_getTopAndBottomLeft(ctx){if(!this._viewRange)return[null,null];const visibleRangesForRange=ctx.linesVisibleRangesForRange(this._viewRange,!1);if(!visibleRangesForRange||0===visibleRangesForRange.length)return[null,null];let firstLine=visibleRangesForRange[0],lastLine=visibleRangesForRange[0];for(const visibleRangesForLine of visibleRangesForRange)visibleRangesForLine.lineNumber<firstLine.lineNumber&&(firstLine=visibleRangesForLine),visibleRangesForLine.lineNumber>lastLine.lineNumber&&(lastLine=visibleRangesForLine);let firstLineMinLeft=1073741824;for(const visibleRange of firstLine.ranges)visibleRange.left<firstLineMinLeft&&(firstLineMinLeft=visibleRange.left);let lastLineMinLeft=1073741824;for(const visibleRange of lastLine.ranges)visibleRange.left<lastLineMinLeft&&(lastLineMinLeft=visibleRange.left);const topForPosition=ctx.getVerticalOffsetForLineNumber(firstLine.lineNumber)-ctx.scrollTop,topLeft=new Coordinate(topForPosition,firstLineMinLeft),topForBottomLine=ctx.getVerticalOffsetForLineNumber(lastLine.lineNumber)-ctx.scrollTop;return[topLeft,new Coordinate(topForBottomLine,lastLineMinLeft)]}_prepareRenderWidget(ctx){if(!this._preference||0===this._preference.length)return null;const[topLeft,bottomLeft]=this._getTopAndBottomLeft(ctx);if(!topLeft||!bottomLeft)return null;if(-1===this._cachedDomNodeOffsetWidth||-1===this._cachedDomNodeOffsetHeight){let preferredDimensions=null;if("function"==typeof this._actual.beforeRender&&(preferredDimensions=safeInvoke(this._actual.beforeRender,this._actual)),preferredDimensions)this._cachedDomNodeOffsetWidth=preferredDimensions.width,this._cachedDomNodeOffsetHeight=preferredDimensions.height;else{const domNode=this.domNode.domNode;this._cachedDomNodeOffsetWidth=domNode.offsetWidth,this._cachedDomNodeOffsetHeight=domNode.offsetHeight}}let placement;placement=this.allowEditorOverflow?this._layoutBoxInPage(topLeft,bottomLeft,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,ctx):this._layoutBoxInViewport(topLeft,bottomLeft,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,ctx);for(let pass=1;pass<=2;pass++)for(const pref of this._preference)if(1===pref){if(!placement)return null;if(2===pass||placement.fitsAbove)return{coordinate:new Coordinate(placement.aboveTop,placement.aboveLeft),position:1}}else{if(2!==pref)return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(topLeft),position:0}:{coordinate:topLeft,position:0};if(!placement)return null;if(2===pass||placement.fitsBelow)return{coordinate:new Coordinate(placement.belowTop,placement.belowLeft),position:2}}return null}onBeforeRender(viewportData){this._viewRange&&this._preference&&(this._viewRange.endLineNumber<viewportData.startLineNumber||this._viewRange.startLineNumber>viewportData.endLineNumber||this.domNode.setMaxWidth(this._maxWidth))}prepareRender(ctx){this._renderData=this._prepareRenderWidget(ctx)}render(ctx){if(!this._renderData)return this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),void("function"==typeof this._actual.afterRender&&safeInvoke(this._actual.afterRender,this._actual,null));this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+ctx.scrollTop-ctx.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),"function"==typeof this._actual.afterRender&&safeInvoke(this._actual.afterRender,this._actual,this._renderData.position)}}function safeInvoke(fn,thisArg,...args){try{return fn.call(thisArg,...args)}catch(_a){return null}}})),define(__m[446],__M([1,0,102,3,118,355]),(function(require,exports,dynamicViewOverlay_1,range_1,renderingContext_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DecorationsOverlay=void 0;class DecorationsOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{constructor(context){super(),this._context=context;const options=this._context.configuration.options;this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options;return this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(ctx){const _decorations=ctx.getDecorationsInViewport();let decorations=[],decorationsLen=0;for(let i=0,len=_decorations.length;i<len;i++){const d=_decorations[i];d.options.className&&(decorations[decorationsLen++]=d)}decorations=decorations.sort(((a,b)=>{if(a.options.zIndex<b.options.zIndex)return-1;if(a.options.zIndex>b.options.zIndex)return 1;const aClassName=a.options.className,bClassName=b.options.className;return aClassName<bClassName?-1:aClassName>bClassName?1:range_1.Range.compareRangesUsingStarts(a.range,b.range)}));const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){output[lineNumber-visibleStartLineNumber]=""}this._renderWholeLineDecorations(ctx,decorations,output),this._renderNormalDecorations(ctx,decorations,output),this._renderResult=output}_renderWholeLineDecorations(ctx,decorations,output){const lineHeight=String(this._lineHeight),visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber;for(let i=0,lenI=decorations.length;i<lenI;i++){const d=decorations[i];if(!d.options.isWholeLine)continue;const decorationOutput='<div class="cdr '+d.options.className+'" style="left:0;width:100%;height:'+lineHeight+'px;"></div>',startLineNumber=Math.max(d.range.startLineNumber,visibleStartLineNumber),endLineNumber=Math.min(d.range.endLineNumber,visibleEndLineNumber);for(let j=startLineNumber;j<=endLineNumber;j++){output[j-visibleStartLineNumber]+=decorationOutput}}}_renderNormalDecorations(ctx,decorations,output){const lineHeight=String(this._lineHeight),visibleStartLineNumber=ctx.visibleRange.startLineNumber;let prevClassName=null,prevShowIfCollapsed=!1,prevRange=null;for(let i=0,lenI=decorations.length;i<lenI;i++){const d=decorations[i];if(d.options.isWholeLine)continue;const className=d.options.className,showIfCollapsed=Boolean(d.options.showIfCollapsed);let range=d.range;showIfCollapsed&&1===range.endColumn&&range.endLineNumber!==range.startLineNumber&&(range=new range_1.Range(range.startLineNumber,range.startColumn,range.endLineNumber-1,this._context.viewModel.getLineMaxColumn(range.endLineNumber-1))),prevClassName===className&&prevShowIfCollapsed===showIfCollapsed&&range_1.Range.areIntersectingOrTouching(prevRange,range)?prevRange=range_1.Range.plusRange(prevRange,range):(null!==prevClassName&&this._renderNormalDecoration(ctx,prevRange,prevClassName,prevShowIfCollapsed,lineHeight,visibleStartLineNumber,output),prevClassName=className,prevShowIfCollapsed=showIfCollapsed,prevRange=range)}null!==prevClassName&&this._renderNormalDecoration(ctx,prevRange,prevClassName,prevShowIfCollapsed,lineHeight,visibleStartLineNumber,output)}_renderNormalDecoration(ctx,range,className,showIfCollapsed,lineHeight,visibleStartLineNumber,output){const linesVisibleRanges=ctx.linesVisibleRangesForRange(range,"findMatch"===className);if(linesVisibleRanges)for(let j=0,lenJ=linesVisibleRanges.length;j<lenJ;j++){const lineVisibleRanges=linesVisibleRanges[j];if(lineVisibleRanges.outsideRenderedLine)continue;const lineIndex=lineVisibleRanges.lineNumber-visibleStartLineNumber;if(showIfCollapsed&&1===lineVisibleRanges.ranges.length){const singleVisibleRange=lineVisibleRanges.ranges[0];if(singleVisibleRange.width<this._typicalHalfwidthCharacterWidth){const center=Math.round(singleVisibleRange.left+singleVisibleRange.width/2),left=Math.max(0,Math.round(center-this._typicalHalfwidthCharacterWidth/2));lineVisibleRanges.ranges[0]=new renderingContext_1.HorizontalRange(left,this._typicalHalfwidthCharacterWidth)}}for(let k=0,lenK=lineVisibleRanges.ranges.length;k<lenK;k++){const visibleRange=lineVisibleRanges.ranges[k],decorationOutput='<div class="cdr '+className+'" style="left:'+String(visibleRange.left)+"px;width:"+String(visibleRange.width)+"px;height:"+lineHeight+'px;"></div>';output[lineIndex]+=decorationOutput}}}render(startLineNumber,lineNumber){if(!this._renderResult)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex<0||lineIndex>=this._renderResult.length?"":this._renderResult[lineIndex]}}exports.DecorationsOverlay=DecorationsOverlay})),define(__m[188],__M([1,0,102,356]),(function(require,exports,dynamicViewOverlay_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlyphMarginOverlay=exports.DedupOverlay=exports.DecorationToRender=void 0;class DecorationToRender{constructor(startLineNumber,endLineNumber,className){this._decorationToRenderBrand=void 0,this.startLineNumber=+startLineNumber,this.endLineNumber=+endLineNumber,this.className=String(className)}}exports.DecorationToRender=DecorationToRender;class DedupOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{_render(visibleStartLineNumber,visibleEndLineNumber,decorations){const output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){output[lineNumber-visibleStartLineNumber]=[]}if(0===decorations.length)return output;decorations.sort(((a,b)=>a.className===b.className?a.startLineNumber===b.startLineNumber?a.endLineNumber-b.endLineNumber:a.startLineNumber-b.startLineNumber:a.className<b.className?-1:1));let prevClassName=null,prevEndLineIndex=0;for(let i=0,len=decorations.length;i<len;i++){const d=decorations[i],className=d.className;let startLineIndex=Math.max(d.startLineNumber,visibleStartLineNumber)-visibleStartLineNumber;const endLineIndex=Math.min(d.endLineNumber,visibleEndLineNumber)-visibleStartLineNumber;prevClassName===className?(startLineIndex=Math.max(prevEndLineIndex+1,startLineIndex),prevEndLineIndex=Math.max(prevEndLineIndex,endLineIndex)):(prevClassName=className,prevEndLineIndex=endLineIndex);for(let i=startLineIndex;i<=prevEndLineIndex;i++)output[i].push(prevClassName)}return output}}exports.DedupOverlay=DedupOverlay;exports.GlyphMarginOverlay=class GlyphMarginOverlay extends DedupOverlay{constructor(context){super(),this._context=context;const options=this._context.configuration.options,layoutInfo=options.get(131);this._lineHeight=options.get(59),this._glyphMargin=options.get(50),this._glyphMarginLeft=layoutInfo.glyphMarginLeft,this._glyphMarginWidth=layoutInfo.glyphMarginWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options,layoutInfo=options.get(131);return this._lineHeight=options.get(59),this._glyphMargin=options.get(50),this._glyphMarginLeft=layoutInfo.glyphMarginLeft,this._glyphMarginWidth=layoutInfo.glyphMarginWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(ctx){const decorations=ctx.getDecorationsInViewport(),r=[];let rLen=0;for(let i=0,len=decorations.length;i<len;i++){const d=decorations[i],glyphMarginClassName=d.options.glyphMarginClassName;glyphMarginClassName&&(r[rLen++]=new DecorationToRender(d.range.startLineNumber,d.range.endLineNumber,glyphMarginClassName))}return r}prepareRender(ctx){if(!this._glyphMargin)return void(this._renderResult=null);const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,toRender=this._render(visibleStartLineNumber,visibleEndLineNumber,this._getDecorations(ctx)),lineHeight=this._lineHeight.toString(),common='" style="left:'+this._glyphMarginLeft.toString()+"px;width:"+this._glyphMarginWidth.toString()+"px;height:"+lineHeight+'px;"></div>',output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber,classNames=toRender[lineIndex];0===classNames.length?output[lineIndex]="":output[lineIndex]='<div class="cgmr codicon '+classNames.join(" ")+common}this._renderResult=output}render(startLineNumber,lineNumber){if(!this._renderResult)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex<0||lineIndex>=this._renderResult.length?"":this._renderResult[lineIndex]}}})),define(__m[447],__M([1,0,188,360]),(function(require,exports,glyphMargin_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LinesDecorationsOverlay=void 0;class LinesDecorationsOverlay extends glyphMargin_1.DedupOverlay{constructor(context){super(),this._context=context;const layoutInfo=this._context.configuration.options.get(131);this._decorationsLeft=layoutInfo.decorationsLeft,this._decorationsWidth=layoutInfo.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const layoutInfo=this._context.configuration.options.get(131);return this._decorationsLeft=layoutInfo.decorationsLeft,this._decorationsWidth=layoutInfo.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(ctx){const decorations=ctx.getDecorationsInViewport(),r=[];let rLen=0;for(let i=0,len=decorations.length;i<len;i++){const d=decorations[i],linesDecorationsClassName=d.options.linesDecorationsClassName;linesDecorationsClassName&&(r[rLen++]=new glyphMargin_1.DecorationToRender(d.range.startLineNumber,d.range.endLineNumber,linesDecorationsClassName));const firstLineDecorationClassName=d.options.firstLineDecorationClassName;firstLineDecorationClassName&&(r[rLen++]=new glyphMargin_1.DecorationToRender(d.range.startLineNumber,d.range.startLineNumber,firstLineDecorationClassName))}return r}prepareRender(ctx){const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,toRender=this._render(visibleStartLineNumber,visibleEndLineNumber,this._getDecorations(ctx)),common='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber,classNames=toRender[lineIndex];let lineOutput="";for(let i=0,len=classNames.length;i<len;i++)lineOutput+='<div class="cldr '+classNames[i]+common;output[lineIndex]=lineOutput}this._renderResult=output}render(startLineNumber,lineNumber){return this._renderResult?this._renderResult[lineNumber-startLineNumber]:""}}exports.LinesDecorationsOverlay=LinesDecorationsOverlay})),define(__m[254],__M([1,0,31,51]),(function(require,exports,fastDomNode_1,viewPart_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Margin=void 0;class Margin extends viewPart_1.ViewPart{constructor(context){super(context);const options=this._context.configuration.options,layoutInfo=options.get(131);this._canUseLayerHinting=!options.get(28),this._contentLeft=layoutInfo.contentLeft,this._glyphMarginLeft=layoutInfo.glyphMarginLeft,this._glyphMarginWidth=layoutInfo.glyphMarginWidth,this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._domNode.setClassName(Margin.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const options=this._context.configuration.options,layoutInfo=options.get(131);return this._canUseLayerHinting=!options.get(28),this._contentLeft=layoutInfo.contentLeft,this._glyphMarginLeft=layoutInfo.glyphMarginLeft,this._glyphMarginWidth=layoutInfo.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(ctx){}render(ctx){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const adjustedScrollTop=ctx.scrollTop-ctx.bigNumbersDelta;this._domNode.setTop(-adjustedScrollTop);const height=Math.min(ctx.scrollHeight,1e6);this._domNode.setHeight(height),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(height)}}exports.Margin=Margin,Margin.CLASS_NAME="glyph-margin",Margin.OUTER_CLASS_NAME="margin"})),define(__m[448],__M([1,0,188,361]),(function(require,exports,glyphMargin_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarginViewLineDecorationsOverlay=void 0;class MarginViewLineDecorationsOverlay extends glyphMargin_1.DedupOverlay{constructor(context){super(),this._context=context,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(ctx){const decorations=ctx.getDecorationsInViewport(),r=[];let rLen=0;for(let i=0,len=decorations.length;i<len;i++){const d=decorations[i],marginClassName=d.options.marginClassName;marginClassName&&(r[rLen++]=new glyphMargin_1.DecorationToRender(d.range.startLineNumber,d.range.endLineNumber,marginClassName))}return r}prepareRender(ctx){const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,toRender=this._render(visibleStartLineNumber,visibleEndLineNumber,this._getDecorations(ctx)),output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber,classNames=toRender[lineIndex];let lineOutput="";for(let i=0,len=classNames.length;i<len;i++)lineOutput+='<div class="cmdr '+classNames[i]+'" style=""></div>';output[lineIndex]=lineOutput}this._renderResult=output}render(startLineNumber,lineNumber){return this._renderResult?this._renderResult[lineNumber-startLineNumber]:""}}exports.MarginViewLineDecorationsOverlay=MarginViewLineDecorationsOverlay})),define(__m[449],__M([1,0,31,51,363]),(function(require,exports,fastDomNode_1,viewPart_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewOverlayWidgets=void 0;class ViewOverlayWidgets extends viewPart_1.ViewPart{constructor(context){super(context);const layoutInfo=this._context.configuration.options.get(131);this._widgets={},this._verticalScrollbarWidth=layoutInfo.verticalScrollbarWidth,this._minimapWidth=layoutInfo.minimap.minimapWidth,this._horizontalScrollbarHeight=layoutInfo.horizontalScrollbarHeight,this._editorHeight=layoutInfo.height,this._editorWidth=layoutInfo.width,this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),viewPart_1.PartFingerprints.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const layoutInfo=this._context.configuration.options.get(131);return this._verticalScrollbarWidth=layoutInfo.verticalScrollbarWidth,this._minimapWidth=layoutInfo.minimap.minimapWidth,this._horizontalScrollbarHeight=layoutInfo.horizontalScrollbarHeight,this._editorHeight=layoutInfo.height,this._editorWidth=layoutInfo.width,!0}addWidget(widget){const domNode=(0,fastDomNode_1.createFastDomNode)(widget.getDomNode());this._widgets[widget.getId()]={widget,preference:null,domNode},domNode.setPosition("absolute"),domNode.setAttribute("widgetId",widget.getId()),this._domNode.appendChild(domNode),this.setShouldRender()}setWidgetPosition(widget,preference){const widgetData=this._widgets[widget.getId()];return widgetData.preference!==preference&&(widgetData.preference=preference,this.setShouldRender(),!0)}removeWidget(widget){const widgetId=widget.getId();if(this._widgets.hasOwnProperty(widgetId)){const domNode=this._widgets[widgetId].domNode.domNode;delete this._widgets[widgetId],domNode.parentNode.removeChild(domNode),this.setShouldRender()}}_renderWidget(widgetData){const domNode=widgetData.domNode;if(null!==widgetData.preference)if(0===widgetData.preference)domNode.setTop(0),domNode.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(1===widgetData.preference){const widgetHeight=domNode.domNode.clientHeight;domNode.setTop(this._editorHeight-widgetHeight-2*this._horizontalScrollbarHeight),domNode.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else 2===widgetData.preference&&(domNode.setTop(0),domNode.domNode.style.right="50%");else domNode.unsetTop()}prepareRender(ctx){}render(ctx){this._domNode.setWidth(this._editorWidth);const keys=Object.keys(this._widgets);for(let i=0,len=keys.length;i<len;i++){const widgetId=keys[i];this._renderWidget(this._widgets[widgetId])}}}exports.ViewOverlayWidgets=ViewOverlayWidgets})),define(__m[450],__M([1,0,31,13,51,11]),(function(require,exports,fastDomNode_1,errors_1,viewPart_1,position_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewZones=void 0;const invalidFunc=()=>{throw new Error("Invalid change accessor")};class ViewZones extends viewPart_1.ViewPart{constructor(context){super(context);const options=this._context.configuration.options,layoutInfo=options.get(131);this._lineHeight=options.get(59),this._contentWidth=layoutInfo.contentWidth,this._contentLeft=layoutInfo.contentLeft,this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const whitespaces=this._context.viewLayout.getWhitespaces(),oldWhitespaces=new Map;for(const whitespace of whitespaces)oldWhitespaces.set(whitespace.id,whitespace);let hadAChange=!1;return this._context.viewModel.changeWhitespace((whitespaceAccessor=>{const keys=Object.keys(this._zones);for(let i=0,len=keys.length;i<len;i++){const id=keys[i],zone=this._zones[id],props=this._computeWhitespaceProps(zone.delegate);zone.isInHiddenArea=props.isInHiddenArea;const oldWhitespace=oldWhitespaces.get(id);!oldWhitespace||oldWhitespace.afterLineNumber===props.afterViewLineNumber&&oldWhitespace.height===props.heightInPx||(whitespaceAccessor.changeOneWhitespace(id,props.afterViewLineNumber,props.heightInPx),this._safeCallOnComputedHeight(zone.delegate,props.heightInPx),hadAChange=!0)}})),hadAChange}onConfigurationChanged(e){const options=this._context.configuration.options,layoutInfo=options.get(131);return this._lineHeight=options.get(59),this._contentWidth=layoutInfo.contentWidth,this._contentLeft=layoutInfo.contentLeft,e.hasChanged(59)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(zone){return void 0!==zone.afterColumn?zone.afterColumn:1e4}_computeWhitespaceProps(zone){if(0===zone.afterLineNumber)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(zone),minWidthInPx:this._minWidthInPixels(zone)};let zoneAfterModelPosition,zoneBeforeModelPosition;if(void 0!==zone.afterColumn)zoneAfterModelPosition=this._context.viewModel.model.validatePosition({lineNumber:zone.afterLineNumber,column:zone.afterColumn});else{const validAfterLineNumber=this._context.viewModel.model.validatePosition({lineNumber:zone.afterLineNumber,column:1}).lineNumber;zoneAfterModelPosition=new position_1.Position(validAfterLineNumber,this._context.viewModel.model.getLineMaxColumn(validAfterLineNumber))}zoneBeforeModelPosition=zoneAfterModelPosition.column===this._context.viewModel.model.getLineMaxColumn(zoneAfterModelPosition.lineNumber)?this._context.viewModel.model.validatePosition({lineNumber:zoneAfterModelPosition.lineNumber+1,column:1}):this._context.viewModel.model.validatePosition({lineNumber:zoneAfterModelPosition.lineNumber,column:zoneAfterModelPosition.column+1});const viewPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(zoneAfterModelPosition,zone.afterColumnAffinity),isVisible=this._context.viewModel.coordinatesConverter.modelPositionIsVisible(zoneBeforeModelPosition);return{isInHiddenArea:!isVisible,afterViewLineNumber:viewPosition.lineNumber,heightInPx:isVisible?this._heightInPixels(zone):0,minWidthInPx:this._minWidthInPixels(zone)}}changeViewZones(callback){let zonesHaveChanged=!1;return this._context.viewModel.changeWhitespace((whitespaceAccessor=>{const changeAccessor={addZone:zone=>(zonesHaveChanged=!0,this._addZone(whitespaceAccessor,zone)),removeZone:id=>{id&&(zonesHaveChanged=this._removeZone(whitespaceAccessor,id)||zonesHaveChanged)},layoutZone:id=>{id&&(zonesHaveChanged=this._layoutZone(whitespaceAccessor,id)||zonesHaveChanged)}};!function safeInvoke1Arg(func,arg1){try{return func(arg1)}catch(e){(0,errors_1.onUnexpectedError)(e)}}(callback,changeAccessor),changeAccessor.addZone=invalidFunc,changeAccessor.removeZone=invalidFunc,changeAccessor.layoutZone=invalidFunc})),zonesHaveChanged}_addZone(whitespaceAccessor,zone){const props=this._computeWhitespaceProps(zone),myZone={whitespaceId:whitespaceAccessor.insertWhitespace(props.afterViewLineNumber,this._getZoneOrdinal(zone),props.heightInPx,props.minWidthInPx),delegate:zone,isInHiddenArea:props.isInHiddenArea,isVisible:!1,domNode:(0,fastDomNode_1.createFastDomNode)(zone.domNode),marginDomNode:zone.marginDomNode?(0,fastDomNode_1.createFastDomNode)(zone.marginDomNode):null};return this._safeCallOnComputedHeight(myZone.delegate,props.heightInPx),myZone.domNode.setPosition("absolute"),myZone.domNode.domNode.style.width="100%",myZone.domNode.setDisplay("none"),myZone.domNode.setAttribute("monaco-view-zone",myZone.whitespaceId),this.domNode.appendChild(myZone.domNode),myZone.marginDomNode&&(myZone.marginDomNode.setPosition("absolute"),myZone.marginDomNode.domNode.style.width="100%",myZone.marginDomNode.setDisplay("none"),myZone.marginDomNode.setAttribute("monaco-view-zone",myZone.whitespaceId),this.marginDomNode.appendChild(myZone.marginDomNode)),this._zones[myZone.whitespaceId]=myZone,this.setShouldRender(),myZone.whitespaceId}_removeZone(whitespaceAccessor,id){if(this._zones.hasOwnProperty(id)){const zone=this._zones[id];return delete this._zones[id],whitespaceAccessor.removeWhitespace(zone.whitespaceId),zone.domNode.removeAttribute("monaco-visible-view-zone"),zone.domNode.removeAttribute("monaco-view-zone"),zone.domNode.domNode.parentNode.removeChild(zone.domNode.domNode),zone.marginDomNode&&(zone.marginDomNode.removeAttribute("monaco-visible-view-zone"),zone.marginDomNode.removeAttribute("monaco-view-zone"),zone.marginDomNode.domNode.parentNode.removeChild(zone.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(whitespaceAccessor,id){if(this._zones.hasOwnProperty(id)){const zone=this._zones[id],props=this._computeWhitespaceProps(zone.delegate);return zone.isInHiddenArea=props.isInHiddenArea,whitespaceAccessor.changeOneWhitespace(zone.whitespaceId,props.afterViewLineNumber,props.heightInPx),this._safeCallOnComputedHeight(zone.delegate,props.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(id){if(this._zones.hasOwnProperty(id)){const zone=this._zones[id];return Boolean(zone.delegate.suppressMouseDown)}return!1}_heightInPixels(zone){return"number"==typeof zone.heightInPx?zone.heightInPx:"number"==typeof zone.heightInLines?this._lineHeight*zone.heightInLines:this._lineHeight}_minWidthInPixels(zone){return"number"==typeof zone.minWidthInPx?zone.minWidthInPx:0}_safeCallOnComputedHeight(zone,height){if("function"==typeof zone.onComputedHeight)try{zone.onComputedHeight(height)}catch(e){(0,errors_1.onUnexpectedError)(e)}}_safeCallOnDomNodeTop(zone,top){if("function"==typeof zone.onDomNodeTop)try{zone.onDomNodeTop(top)}catch(e){(0,errors_1.onUnexpectedError)(e)}}prepareRender(ctx){}render(ctx){const visibleWhitespaces=ctx.viewportData.whitespaceViewportData,visibleZones={};let hasVisibleZone=!1;for(const visibleWhitespace of visibleWhitespaces)this._zones[visibleWhitespace.id].isInHiddenArea||(visibleZones[visibleWhitespace.id]=visibleWhitespace,hasVisibleZone=!0);const keys=Object.keys(this._zones);for(let i=0,len=keys.length;i<len;i++){const id=keys[i],zone=this._zones[id];let newTop=0,newHeight=0,newDisplay="none";visibleZones.hasOwnProperty(id)?(newTop=visibleZones[id].verticalOffset-ctx.bigNumbersDelta,newHeight=visibleZones[id].height,newDisplay="block",zone.isVisible||(zone.domNode.setAttribute("monaco-visible-view-zone","true"),zone.isVisible=!0),this._safeCallOnDomNodeTop(zone.delegate,ctx.getScrolledTopFromAbsoluteTop(visibleZones[id].verticalOffset))):(zone.isVisible&&(zone.domNode.removeAttribute("monaco-visible-view-zone"),zone.isVisible=!1),this._safeCallOnDomNodeTop(zone.delegate,ctx.getScrolledTopFromAbsoluteTop(-1e6))),zone.domNode.setTop(newTop),zone.domNode.setHeight(newHeight),zone.domNode.setDisplay(newDisplay),zone.marginDomNode&&(zone.marginDomNode.setTop(newTop),zone.marginDomNode.setHeight(newHeight),zone.marginDomNode.setDisplay(newDisplay))}hasVisibleZone&&(this.domNode.setWidth(Math.max(ctx.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}exports.ViewZones=ViewZones})),define(__m[189],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewZonesChangedEvent=exports.ViewTokensColorsChangedEvent=exports.ViewTokensChangedEvent=exports.ViewThemeChangedEvent=exports.ViewScrollChangedEvent=exports.ViewRevealRangeRequestEvent=exports.ViewLinesInsertedEvent=exports.ViewLinesDeletedEvent=exports.ViewLinesChangedEvent=exports.ViewLineMappingChangedEvent=exports.ViewLanguageConfigurationEvent=exports.ViewFocusChangedEvent=exports.ViewFlushedEvent=exports.ViewDecorationsChangedEvent=exports.ViewCursorStateChangedEvent=exports.ViewConfigurationChangedEvent=exports.ViewCompositionEndEvent=exports.ViewCompositionStartEvent=void 0;exports.ViewCompositionStartEvent=class ViewCompositionStartEvent{constructor(){this.type=0}};exports.ViewCompositionEndEvent=class ViewCompositionEndEvent{constructor(){this.type=1}};exports.ViewConfigurationChangedEvent=class ViewConfigurationChangedEvent{constructor(source){this.type=2,this._source=source}hasChanged(id){return this._source.hasChanged(id)}};exports.ViewCursorStateChangedEvent=class ViewCursorStateChangedEvent{constructor(selections,modelSelections){this.type=3,this.selections=selections,this.modelSelections=modelSelections}};exports.ViewDecorationsChangedEvent=class ViewDecorationsChangedEvent{constructor(source){this.type=4,source?(this.affectsMinimap=source.affectsMinimap,this.affectsOverviewRuler=source.affectsOverviewRuler):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0)}};exports.ViewFlushedEvent=class ViewFlushedEvent{constructor(){this.type=5}};exports.ViewFocusChangedEvent=class ViewFocusChangedEvent{constructor(isFocused){this.type=6,this.isFocused=isFocused}};exports.ViewLanguageConfigurationEvent=class ViewLanguageConfigurationEvent{constructor(){this.type=7}};exports.ViewLineMappingChangedEvent=class ViewLineMappingChangedEvent{constructor(){this.type=8}};exports.ViewLinesChangedEvent=class ViewLinesChangedEvent{constructor(fromLineNumber,toLineNumber){this.type=9,this.fromLineNumber=fromLineNumber,this.toLineNumber=toLineNumber}};exports.ViewLinesDeletedEvent=class ViewLinesDeletedEvent{constructor(fromLineNumber,toLineNumber){this.type=10,this.fromLineNumber=fromLineNumber,this.toLineNumber=toLineNumber}};exports.ViewLinesInsertedEvent=class ViewLinesInsertedEvent{constructor(fromLineNumber,toLineNumber){this.type=11,this.fromLineNumber=fromLineNumber,this.toLineNumber=toLineNumber}};exports.ViewRevealRangeRequestEvent=class ViewRevealRangeRequestEvent{constructor(source,minimalReveal,range,selections,verticalType,revealHorizontal,scrollType){this.source=source,this.minimalReveal=minimalReveal,this.range=range,this.selections=selections,this.verticalType=verticalType,this.revealHorizontal=revealHorizontal,this.scrollType=scrollType,this.type=12}};exports.ViewScrollChangedEvent=class ViewScrollChangedEvent{constructor(source){this.type=13,this.scrollWidth=source.scrollWidth,this.scrollLeft=source.scrollLeft,this.scrollHeight=source.scrollHeight,this.scrollTop=source.scrollTop,this.scrollWidthChanged=source.scrollWidthChanged,this.scrollLeftChanged=source.scrollLeftChanged,this.scrollHeightChanged=source.scrollHeightChanged,this.scrollTopChanged=source.scrollTopChanged}};exports.ViewThemeChangedEvent=class ViewThemeChangedEvent{constructor(theme){this.theme=theme,this.type=14}};exports.ViewTokensChangedEvent=class ViewTokensChangedEvent{constructor(ranges){this.type=15,this.ranges=ranges}};exports.ViewTokensColorsChangedEvent=class ViewTokensColorsChangedEvent{constructor(){this.type=16}};exports.ViewZonesChangedEvent=class ViewZonesChangedEvent{constructor(){this.type=17}}})),define(__m[154],__M([1,0,8]),(function(require,exports,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LineDecorationsNormalizer=exports.DecorationSegment=exports.LineDecoration=void 0;class LineDecoration{constructor(startColumn,endColumn,className,type){this.startColumn=startColumn,this.endColumn=endColumn,this.className=className,this.type=type,this._lineDecorationBrand=void 0}static _equals(a,b){return a.startColumn===b.startColumn&&a.endColumn===b.endColumn&&a.className===b.className&&a.type===b.type}static equalsArr(a,b){const aLen=a.length;if(aLen!==b.length)return!1;for(let i=0;i<aLen;i++)if(!LineDecoration._equals(a[i],b[i]))return!1;return!0}static extractWrapped(arr,startOffset,endOffset){if(0===arr.length)return arr;const startColumn=startOffset+1,endColumn=endOffset+1,lineLength=endOffset-startOffset,r=[];let rLength=0;for(const dec of arr)dec.endColumn<=startColumn||dec.startColumn>=endColumn||(r[rLength++]=new LineDecoration(Math.max(1,dec.startColumn-startColumn+1),Math.min(lineLength+1,dec.endColumn-startColumn+1),dec.className,dec.type));return r}static filter(lineDecorations,lineNumber,minLineColumn,maxLineColumn){if(0===lineDecorations.length)return[];const result=[];let resultLen=0;for(let i=0,len=lineDecorations.length;i<len;i++){const d=lineDecorations[i],range=d.range;if(range.endLineNumber<lineNumber||range.startLineNumber>lineNumber)continue;if(range.isEmpty()&&(0===d.type||3===d.type))continue;const startColumn=range.startLineNumber===lineNumber?range.startColumn:minLineColumn,endColumn=range.endLineNumber===lineNumber?range.endColumn:maxLineColumn;result[resultLen++]=new LineDecoration(startColumn,endColumn,d.inlineClassName,d.type)}return result}static _typeCompare(a,b){const ORDER=[2,0,1,3];return ORDER[a]-ORDER[b]}static compare(a,b){if(a.startColumn!==b.startColumn)return a.startColumn-b.startColumn;if(a.endColumn!==b.endColumn)return a.endColumn-b.endColumn;const typeCmp=LineDecoration._typeCompare(a.type,b.type);return 0!==typeCmp?typeCmp:a.className!==b.className?a.className<b.className?-1:1:0}}exports.LineDecoration=LineDecoration;class DecorationSegment{constructor(startOffset,endOffset,className,metadata){this.startOffset=startOffset,this.endOffset=endOffset,this.className=className,this.metadata=metadata}}exports.DecorationSegment=DecorationSegment;class Stack{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(metadata){let result=0;for(let i=0,len=metadata.length;i<len;i++)result|=metadata[i];return result}consumeLowerThan(maxStopOffset,nextStartOffset,result){for(;this.count>0&&this.stopOffsets[0]<maxStopOffset;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;result.push(new DecorationSegment(nextStartOffset,this.stopOffsets[i],this.classNames.join(" "),Stack._metadata(this.metadata))),nextStartOffset=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&nextStartOffset<maxStopOffset&&(result.push(new DecorationSegment(nextStartOffset,maxStopOffset-1,this.classNames.join(" "),Stack._metadata(this.metadata))),nextStartOffset=maxStopOffset),nextStartOffset}insert(stopOffset,className,metadata){if(0===this.count||this.stopOffsets[this.count-1]<=stopOffset)this.stopOffsets.push(stopOffset),this.classNames.push(className),this.metadata.push(metadata);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=stopOffset){this.stopOffsets.splice(i,0,stopOffset),this.classNames.splice(i,0,className),this.metadata.splice(i,0,metadata);break}this.count++}}exports.LineDecorationsNormalizer=class LineDecorationsNormalizer{static normalize(lineContent,lineDecorations){if(0===lineDecorations.length)return[];const result=[],stack=new Stack;let nextStartOffset=0;for(let i=0,len=lineDecorations.length;i<len;i++){const d=lineDecorations[i];let startColumn=d.startColumn,endColumn=d.endColumn;const className=d.className,metadata=1===d.type?2:2===d.type?4:0;if(startColumn>1){const charCodeBefore=lineContent.charCodeAt(startColumn-2);strings.isHighSurrogate(charCodeBefore)&&startColumn--}if(endColumn>1){const charCodeBefore=lineContent.charCodeAt(endColumn-2);strings.isHighSurrogate(charCodeBefore)&&endColumn--}const currentStartOffset=startColumn-1,currentEndOffset=endColumn-2;nextStartOffset=stack.consumeLowerThan(currentStartOffset,nextStartOffset,result),0===stack.count&&(nextStartOffset=currentStartOffset),stack.insert(currentEndOffset,className,metadata)}return stack.consumeLowerThan(1073741824,nextStartOffset,result),result}}})),define(__m[451],__M([1,0,8]),(function(require,exports,strings){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LinesLayout=exports.EditorWhitespace=void 0;class PendingChanges{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(x){this._hasPending=!0,this._inserts.push(x)}change(x){this._hasPending=!0,this._changes.push(x)}remove(x){this._hasPending=!0,this._removes.push(x)}mustCommit(){return this._hasPending}commit(linesLayout){if(!this._hasPending)return;const inserts=this._inserts,changes=this._changes,removes=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],linesLayout._commitPendingChanges(inserts,changes,removes)}}class EditorWhitespace{constructor(id,afterLineNumber,ordinal,height,minWidth){this.id=id,this.afterLineNumber=afterLineNumber,this.ordinal=ordinal,this.height=height,this.minWidth=minWidth,this.prefixSum=0}}exports.EditorWhitespace=EditorWhitespace;class LinesLayout{constructor(lineCount,lineHeight,paddingTop,paddingBottom){this._instanceId=strings.singleLetterHash(++LinesLayout.INSTANCE_COUNT),this._pendingChanges=new PendingChanges,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=lineCount,this._lineHeight=lineHeight,this._paddingTop=paddingTop,this._paddingBottom=paddingBottom}static findInsertionIndex(arr,afterLineNumber,ordinal){let low=0,high=arr.length;for(;low<high;){const mid=low+high>>>1;afterLineNumber===arr[mid].afterLineNumber?ordinal<arr[mid].ordinal?high=mid:low=mid+1:afterLineNumber<arr[mid].afterLineNumber?high=mid:low=mid+1}return low}setLineHeight(lineHeight){this._checkPendingChanges(),this._lineHeight=lineHeight}setPadding(paddingTop,paddingBottom){this._paddingTop=paddingTop,this._paddingBottom=paddingBottom}onFlushed(lineCount){this._checkPendingChanges(),this._lineCount=lineCount}changeWhitespace(callback){let hadAChange=!1;try{callback({insertWhitespace:(afterLineNumber,ordinal,heightInPx,minWidth)=>{hadAChange=!0,afterLineNumber|=0,ordinal|=0,heightInPx|=0,minWidth|=0;const id=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new EditorWhitespace(id,afterLineNumber,ordinal,heightInPx,minWidth)),id},changeOneWhitespace:(id,newAfterLineNumber,newHeight)=>{hadAChange=!0,newAfterLineNumber|=0,newHeight|=0,this._pendingChanges.change({id,newAfterLineNumber,newHeight})},removeWhitespace:id=>{hadAChange=!0,this._pendingChanges.remove({id})}})}finally{this._pendingChanges.commit(this)}return hadAChange}_commitPendingChanges(inserts,changes,removes){if((inserts.length>0||removes.length>0)&&(this._minWidth=-1),inserts.length+changes.length+removes.length<=1){for(const insert of inserts)this._insertWhitespace(insert);for(const change of changes)this._changeOneWhitespace(change.id,change.newAfterLineNumber,change.newHeight);for(const remove of removes){const index=this._findWhitespaceIndex(remove.id);-1!==index&&this._removeWhitespace(index)}return}const toRemove=new Set;for(const remove of removes)toRemove.add(remove.id);const toChange=new Map;for(const change of changes)toChange.set(change.id,change);const applyRemoveAndChange=whitespaces=>{const result=[];for(const whitespace of whitespaces)if(!toRemove.has(whitespace.id)){if(toChange.has(whitespace.id)){const change=toChange.get(whitespace.id);whitespace.afterLineNumber=change.newAfterLineNumber,whitespace.height=change.newHeight}result.push(whitespace)}return result},result=applyRemoveAndChange(this._arr).concat(applyRemoveAndChange(inserts));result.sort(((a,b)=>a.afterLineNumber===b.afterLineNumber?a.ordinal-b.ordinal:a.afterLineNumber-b.afterLineNumber)),this._arr=result,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(whitespace){const insertIndex=LinesLayout.findInsertionIndex(this._arr,whitespace.afterLineNumber,whitespace.ordinal);this._arr.splice(insertIndex,0,whitespace),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,insertIndex-1)}_findWhitespaceIndex(id){const arr=this._arr;for(let i=0,len=arr.length;i<len;i++)if(arr[i].id===id)return i;return-1}_changeOneWhitespace(id,newAfterLineNumber,newHeight){const index=this._findWhitespaceIndex(id);if(-1!==index&&(this._arr[index].height!==newHeight&&(this._arr[index].height=newHeight,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,index-1)),this._arr[index].afterLineNumber!==newAfterLineNumber)){const whitespace=this._arr[index];this._removeWhitespace(index),whitespace.afterLineNumber=newAfterLineNumber,this._insertWhitespace(whitespace)}}_removeWhitespace(removeIndex){this._arr.splice(removeIndex,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,removeIndex-1)}onLinesDeleted(fromLineNumber,toLineNumber){this._checkPendingChanges(),fromLineNumber|=0,toLineNumber|=0,this._lineCount-=toLineNumber-fromLineNumber+1;for(let i=0,len=this._arr.length;i<len;i++){const afterLineNumber=this._arr[i].afterLineNumber;fromLineNumber<=afterLineNumber&&afterLineNumber<=toLineNumber?this._arr[i].afterLineNumber=fromLineNumber-1:afterLineNumber>toLineNumber&&(this._arr[i].afterLineNumber-=toLineNumber-fromLineNumber+1)}}onLinesInserted(fromLineNumber,toLineNumber){this._checkPendingChanges(),fromLineNumber|=0,toLineNumber|=0,this._lineCount+=toLineNumber-fromLineNumber+1;for(let i=0,len=this._arr.length;i<len;i++){fromLineNumber<=this._arr[i].afterLineNumber&&(this._arr[i].afterLineNumber+=toLineNumber-fromLineNumber+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),0===this._arr.length?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(index){this._checkPendingChanges(),index|=0;let startIndex=Math.max(0,this._prefixSumValidIndex+1);0===startIndex&&(this._arr[0].prefixSum=this._arr[0].height,startIndex++);for(let i=startIndex;i<=index;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,index),this._arr[index].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();return this._lineHeight*this._lineCount+this.getWhitespacesTotalHeight()+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(lineNumber){this._checkPendingChanges(),lineNumber|=0;const lastWhitespaceBeforeLineNumber=this._findLastWhitespaceBeforeLineNumber(lineNumber);return-1===lastWhitespaceBeforeLineNumber?0:this.getWhitespacesAccumulatedHeight(lastWhitespaceBeforeLineNumber)}_findLastWhitespaceBeforeLineNumber(lineNumber){lineNumber|=0;const arr=this._arr;let low=0,high=arr.length-1;for(;low<=high;){const mid=low+((high-low|0)/2|0)|0;if(arr[mid].afterLineNumber<lineNumber){if(mid+1>=arr.length||arr[mid+1].afterLineNumber>=lineNumber)return mid;low=mid+1|0}else high=mid-1|0}return-1}_findFirstWhitespaceAfterLineNumber(lineNumber){lineNumber|=0;const firstWhitespaceAfterLineNumber=this._findLastWhitespaceBeforeLineNumber(lineNumber)+1;return firstWhitespaceAfterLineNumber<this._arr.length?firstWhitespaceAfterLineNumber:-1}getFirstWhitespaceIndexAfterLineNumber(lineNumber){return this._checkPendingChanges(),lineNumber|=0,this._findFirstWhitespaceAfterLineNumber(lineNumber)}getVerticalOffsetForLineNumber(lineNumber){let previousLinesHeight;this._checkPendingChanges(),previousLinesHeight=(lineNumber|=0)>1?this._lineHeight*(lineNumber-1):0;return previousLinesHeight+this.getWhitespaceAccumulatedHeightBeforeLineNumber(lineNumber)+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),-1===this._minWidth){let minWidth=0;for(let i=0,len=this._arr.length;i<len;i++)minWidth=Math.max(minWidth,this._arr[i].minWidth);this._minWidth=minWidth}return this._minWidth}isAfterLines(verticalOffset){this._checkPendingChanges();return verticalOffset>this.getLinesTotalHeight()}isInTopPadding(verticalOffset){return 0!==this._paddingTop&&(this._checkPendingChanges(),verticalOffset<this._paddingTop)}isInBottomPadding(verticalOffset){if(0===this._paddingBottom)return!1;this._checkPendingChanges();return verticalOffset>=this.getLinesTotalHeight()-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(verticalOffset){if(this._checkPendingChanges(),(verticalOffset|=0)<0)return 1;const linesCount=0|this._lineCount,lineHeight=this._lineHeight;let minLineNumber=1,maxLineNumber=linesCount;for(;minLineNumber<maxLineNumber;){const midLineNumber=(minLineNumber+maxLineNumber)/2|0,midLineNumberVerticalOffset=0|this.getVerticalOffsetForLineNumber(midLineNumber);if(verticalOffset>=midLineNumberVerticalOffset+lineHeight)minLineNumber=midLineNumber+1;else{if(verticalOffset>=midLineNumberVerticalOffset)return midLineNumber;maxLineNumber=midLineNumber}}return minLineNumber>linesCount?linesCount:minLineNumber}getLinesViewportData(verticalOffset1,verticalOffset2){this._checkPendingChanges(),verticalOffset1|=0,verticalOffset2|=0;const lineHeight=this._lineHeight,startLineNumber=0|this.getLineNumberAtOrAfterVerticalOffset(verticalOffset1),startLineNumberVerticalOffset=0|this.getVerticalOffsetForLineNumber(startLineNumber);let endLineNumber=0|this._lineCount,whitespaceIndex=0|this.getFirstWhitespaceIndexAfterLineNumber(startLineNumber);const whitespaceCount=0|this.getWhitespacesCount();let currentWhitespaceHeight,currentWhitespaceAfterLineNumber;-1===whitespaceIndex?(whitespaceIndex=whitespaceCount,currentWhitespaceAfterLineNumber=endLineNumber+1,currentWhitespaceHeight=0):(currentWhitespaceAfterLineNumber=0|this.getAfterLineNumberForWhitespaceIndex(whitespaceIndex),currentWhitespaceHeight=0|this.getHeightForWhitespaceIndex(whitespaceIndex));let currentVerticalOffset=startLineNumberVerticalOffset,currentLineRelativeOffset=currentVerticalOffset;let bigNumbersDelta=0;startLineNumberVerticalOffset>=5e5&&(bigNumbersDelta=5e5*Math.floor(startLineNumberVerticalOffset/5e5),bigNumbersDelta=Math.floor(bigNumbersDelta/lineHeight)*lineHeight,currentLineRelativeOffset-=bigNumbersDelta);const linesOffsets=[],verticalCenter=verticalOffset1+(verticalOffset2-verticalOffset1)/2;let centeredLineNumber=-1;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){if(-1===centeredLineNumber){const currentLineTop=currentVerticalOffset,currentLineBottom=currentVerticalOffset+lineHeight;(currentLineTop<=verticalCenter&&verticalCenter<currentLineBottom||currentLineTop>verticalCenter)&&(centeredLineNumber=lineNumber)}for(currentVerticalOffset+=lineHeight,linesOffsets[lineNumber-startLineNumber]=currentLineRelativeOffset,currentLineRelativeOffset+=lineHeight;currentWhitespaceAfterLineNumber===lineNumber;)currentLineRelativeOffset+=currentWhitespaceHeight,currentVerticalOffset+=currentWhitespaceHeight,whitespaceIndex++,whitespaceIndex>=whitespaceCount?currentWhitespaceAfterLineNumber=endLineNumber+1:(currentWhitespaceAfterLineNumber=0|this.getAfterLineNumberForWhitespaceIndex(whitespaceIndex),currentWhitespaceHeight=0|this.getHeightForWhitespaceIndex(whitespaceIndex));if(currentVerticalOffset>=verticalOffset2){endLineNumber=lineNumber;break}}-1===centeredLineNumber&&(centeredLineNumber=endLineNumber);const endLineNumberVerticalOffset=0|this.getVerticalOffsetForLineNumber(endLineNumber);let completelyVisibleStartLineNumber=startLineNumber,completelyVisibleEndLineNumber=endLineNumber;return completelyVisibleStartLineNumber<completelyVisibleEndLineNumber&&startLineNumberVerticalOffset<verticalOffset1&&completelyVisibleStartLineNumber++,completelyVisibleStartLineNumber<completelyVisibleEndLineNumber&&endLineNumberVerticalOffset+lineHeight>verticalOffset2&&completelyVisibleEndLineNumber--,{bigNumbersDelta,startLineNumber,endLineNumber,relativeVerticalOffset:linesOffsets,centeredLineNumber,completelyVisibleStartLineNumber,completelyVisibleEndLineNumber}}getVerticalOffsetForWhitespaceIndex(whitespaceIndex){this._checkPendingChanges(),whitespaceIndex|=0;const afterLineNumber=this.getAfterLineNumberForWhitespaceIndex(whitespaceIndex);let previousLinesHeight,previousWhitespacesHeight;return previousLinesHeight=afterLineNumber>=1?this._lineHeight*afterLineNumber:0,previousWhitespacesHeight=whitespaceIndex>0?this.getWhitespacesAccumulatedHeight(whitespaceIndex-1):0,previousLinesHeight+previousWhitespacesHeight+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(verticalOffset){this._checkPendingChanges(),verticalOffset|=0;let minWhitespaceIndex=0,maxWhitespaceIndex=this.getWhitespacesCount()-1;if(maxWhitespaceIndex<0)return-1;if(verticalOffset>=this.getVerticalOffsetForWhitespaceIndex(maxWhitespaceIndex)+this.getHeightForWhitespaceIndex(maxWhitespaceIndex))return-1;for(;minWhitespaceIndex<maxWhitespaceIndex;){const midWhitespaceIndex=Math.floor((minWhitespaceIndex+maxWhitespaceIndex)/2),midWhitespaceVerticalOffset=this.getVerticalOffsetForWhitespaceIndex(midWhitespaceIndex);if(verticalOffset>=midWhitespaceVerticalOffset+this.getHeightForWhitespaceIndex(midWhitespaceIndex))minWhitespaceIndex=midWhitespaceIndex+1;else{if(verticalOffset>=midWhitespaceVerticalOffset)return midWhitespaceIndex;maxWhitespaceIndex=midWhitespaceIndex}}return minWhitespaceIndex}getWhitespaceAtVerticalOffset(verticalOffset){this._checkPendingChanges(),verticalOffset|=0;const candidateIndex=this.getWhitespaceIndexAtOrAfterVerticallOffset(verticalOffset);if(candidateIndex<0)return null;if(candidateIndex>=this.getWhitespacesCount())return null;const candidateTop=this.getVerticalOffsetForWhitespaceIndex(candidateIndex);if(candidateTop>verticalOffset)return null;const candidateHeight=this.getHeightForWhitespaceIndex(candidateIndex);return{id:this.getIdForWhitespaceIndex(candidateIndex),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(candidateIndex),verticalOffset:candidateTop,height:candidateHeight}}getWhitespaceViewportData(verticalOffset1,verticalOffset2){this._checkPendingChanges(),verticalOffset1|=0,verticalOffset2|=0;const startIndex=this.getWhitespaceIndexAtOrAfterVerticallOffset(verticalOffset1),endIndex=this.getWhitespacesCount()-1;if(startIndex<0)return[];const result=[];for(let i=startIndex;i<=endIndex;i++){const top=this.getVerticalOffsetForWhitespaceIndex(i),height=this.getHeightForWhitespaceIndex(i);if(top>=verticalOffset2)break;result.push({id:this.getIdForWhitespaceIndex(i),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(i),verticalOffset:top,height})}return result}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(index){return this._checkPendingChanges(),index|=0,this._arr[index].id}getAfterLineNumberForWhitespaceIndex(index){return this._checkPendingChanges(),index|=0,this._arr[index].afterLineNumber}getHeightForWhitespaceIndex(index){return this._checkPendingChanges(),index|=0,this._arr[index].height}}exports.LinesLayout=LinesLayout,LinesLayout.INSTANCE_COUNT=0})),define(__m[126],__M([1,0,8,93,154]),(function(require,exports,strings,stringBuilder_1,lineDecorations_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderViewLine2=exports.RenderLineOutput2=exports.renderViewLine=exports.RenderLineOutput=exports.CharacterMapping=exports.DomPosition=exports.RenderLineInput=exports.LineRange=void 0;class LinePart{constructor(endIndex,type,metadata){this._linePartBrand=void 0,this.endIndex=endIndex,this.type=type,this.metadata=metadata}isWhitespace(){return!!(1&this.metadata)}isPseudoAfter(){return!!(4&this.metadata)}}exports.LineRange=class LineRange{constructor(startIndex,endIndex){this.startOffset=startIndex,this.endOffset=endIndex}equals(otherLineRange){return this.startOffset===otherLineRange.startOffset&&this.endOffset===otherLineRange.endOffset}};exports.RenderLineInput=class RenderLineInput{constructor(useMonospaceOptimizations,canUseHalfwidthRightwardsArrow,lineContent,continuesWithWrappedLine,isBasicASCII,containsRTL,fauxIndentLength,lineTokens,lineDecorations,tabSize,startVisibleColumn,spaceWidth,middotWidth,wsmiddotWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures,selectionsOnLine){this.useMonospaceOptimizations=useMonospaceOptimizations,this.canUseHalfwidthRightwardsArrow=canUseHalfwidthRightwardsArrow,this.lineContent=lineContent,this.continuesWithWrappedLine=continuesWithWrappedLine,this.isBasicASCII=isBasicASCII,this.containsRTL=containsRTL,this.fauxIndentLength=fauxIndentLength,this.lineTokens=lineTokens,this.lineDecorations=lineDecorations.sort(lineDecorations_1.LineDecoration.compare),this.tabSize=tabSize,this.startVisibleColumn=startVisibleColumn,this.spaceWidth=spaceWidth,this.stopRenderingLineAfter=stopRenderingLineAfter,this.renderWhitespace="all"===renderWhitespace?4:"boundary"===renderWhitespace?1:"selection"===renderWhitespace?2:"trailing"===renderWhitespace?3:0,this.renderControlCharacters=renderControlCharacters,this.fontLigatures=fontLigatures,this.selectionsOnLine=selectionsOnLine&&selectionsOnLine.sort(((a,b)=>a.startOffset<b.startOffset?-1:1));Math.abs(wsmiddotWidth-spaceWidth)<Math.abs(middotWidth-spaceWidth)?(this.renderSpaceWidth=wsmiddotWidth,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=middotWidth,this.renderSpaceCharCode=183)}sameSelection(otherSelections){if(null===this.selectionsOnLine)return null===otherSelections;if(null===otherSelections)return!1;if(otherSelections.length!==this.selectionsOnLine.length)return!1;for(let i=0;i<this.selectionsOnLine.length;i++)if(!this.selectionsOnLine[i].equals(otherSelections[i]))return!1;return!0}equals(other){return this.useMonospaceOptimizations===other.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===other.canUseHalfwidthRightwardsArrow&&this.lineContent===other.lineContent&&this.continuesWithWrappedLine===other.continuesWithWrappedLine&&this.isBasicASCII===other.isBasicASCII&&this.containsRTL===other.containsRTL&&this.fauxIndentLength===other.fauxIndentLength&&this.tabSize===other.tabSize&&this.startVisibleColumn===other.startVisibleColumn&&this.spaceWidth===other.spaceWidth&&this.renderSpaceWidth===other.renderSpaceWidth&&this.renderSpaceCharCode===other.renderSpaceCharCode&&this.stopRenderingLineAfter===other.stopRenderingLineAfter&&this.renderWhitespace===other.renderWhitespace&&this.renderControlCharacters===other.renderControlCharacters&&this.fontLigatures===other.fontLigatures&&lineDecorations_1.LineDecoration.equalsArr(this.lineDecorations,other.lineDecorations)&&this.lineTokens.equals(other.lineTokens)&&this.sameSelection(other.selectionsOnLine)}};class DomPosition{constructor(partIndex,charIndex){this.partIndex=partIndex,this.charIndex=charIndex}}exports.DomPosition=DomPosition;class CharacterMapping{constructor(length,partCount){this.length=length,this._data=new Uint32Array(this.length),this._absoluteOffsets=new Uint32Array(this.length)}static getPartIndex(partData){return(4294901760&partData)>>>16}static getCharIndex(partData){return(65535&partData)>>>0}setColumnInfo(column,partIndex,charIndex,partAbsoluteOffset){const partData=(partIndex<<16|charIndex<<0)>>>0;this._data[column-1]=partData,this._absoluteOffsets[column-1]=partAbsoluteOffset+charIndex}getAbsoluteOffset(column){return 0===this._absoluteOffsets.length?0:this._absoluteOffsets[column-1]}charOffsetToPartData(charOffset){return 0===this.length?0:charOffset<0?this._data[0]:charOffset>=this.length?this._data[this.length-1]:this._data[charOffset]}getDomPosition(column){const partData=this.charOffsetToPartData(column-1),partIndex=CharacterMapping.getPartIndex(partData),charIndex=CharacterMapping.getCharIndex(partData);return new DomPosition(partIndex,charIndex)}getColumn(domPosition,partLength){return this.partDataToCharOffset(domPosition.partIndex,partLength,domPosition.charIndex)+1}partDataToCharOffset(partIndex,partLength,charIndex){if(0===this.length)return 0;const searchEntry=(partIndex<<16|charIndex<<0)>>>0;let min=0,max=this.length-1;for(;min+1<max;){const mid=min+max>>>1,midEntry=this._data[mid];if(midEntry===searchEntry)return mid;midEntry>searchEntry?max=mid:min=mid}if(min===max)return min;const minEntry=this._data[min],maxEntry=this._data[max];if(minEntry===searchEntry)return min;if(maxEntry===searchEntry)return max;const minPartIndex=CharacterMapping.getPartIndex(minEntry),minCharIndex=CharacterMapping.getCharIndex(minEntry);let maxCharIndex;maxCharIndex=minPartIndex!==CharacterMapping.getPartIndex(maxEntry)?partLength:CharacterMapping.getCharIndex(maxEntry);return charIndex-minCharIndex<=maxCharIndex-charIndex?min:max}}exports.CharacterMapping=CharacterMapping;class RenderLineOutput{constructor(characterMapping,containsRTL,containsForeignElements){this._renderLineOutputBrand=void 0,this.characterMapping=characterMapping,this.containsRTL=containsRTL,this.containsForeignElements=containsForeignElements}}function renderViewLine(input,sb){if(0===input.lineContent.length){if(input.lineDecorations.length>0){sb.appendASCIIString("<span>");let beforeCount=0,afterCount=0,containsForeignElements=0;for(const lineDecoration of input.lineDecorations)1!==lineDecoration.type&&2!==lineDecoration.type||(sb.appendASCIIString('<span class="'),sb.appendASCIIString(lineDecoration.className),sb.appendASCIIString('"></span>'),1===lineDecoration.type&&(containsForeignElements|=1,beforeCount++),2===lineDecoration.type&&(containsForeignElements|=2,afterCount++));sb.appendASCIIString("</span>");const characterMapping=new CharacterMapping(1,beforeCount+afterCount);return characterMapping.setColumnInfo(1,beforeCount,0,0),new RenderLineOutput(characterMapping,!1,containsForeignElements)}return sb.appendASCIIString("<span><span></span></span>"),new RenderLineOutput(new CharacterMapping(0,0),!1,0)}return function _renderLine(input,sb){const fontIsMonospace=input.fontIsMonospace,canUseHalfwidthRightwardsArrow=input.canUseHalfwidthRightwardsArrow,containsForeignElements=input.containsForeignElements,lineContent=input.lineContent,len=input.len,isOverflowing=input.isOverflowing,parts=input.parts,fauxIndentLength=input.fauxIndentLength,tabSize=input.tabSize,startVisibleColumn=input.startVisibleColumn,containsRTL=input.containsRTL,spaceWidth=input.spaceWidth,renderSpaceCharCode=input.renderSpaceCharCode,renderWhitespace=input.renderWhitespace,renderControlCharacters=input.renderControlCharacters,characterMapping=new CharacterMapping(len+1,parts.length);let lastCharacterMappingDefined=!1,charIndex=0,visibleColumn=startVisibleColumn,charOffsetInPart=0,partDisplacement=0,prevPartContentCnt=0,partAbsoluteOffset=0;containsRTL?sb.appendASCIIString('<span dir="ltr">'):sb.appendASCIIString("<span>");for(let partIndex=0,tokensLen=parts.length;partIndex<tokensLen;partIndex++){partAbsoluteOffset+=prevPartContentCnt;const part=parts[partIndex],partEndIndex=part.endIndex,partType=part.type,partRendersWhitespace=0!==renderWhitespace&&part.isWhitespace(),partRendersWhitespaceWithWidth=partRendersWhitespace&&!fontIsMonospace&&("mtkw"===partType||!containsForeignElements),partIsEmptyAndHasPseudoAfter=charIndex===partEndIndex&&part.isPseudoAfter();if(charOffsetInPart=0,sb.appendASCIIString('<span class="'),sb.appendASCIIString(partRendersWhitespaceWithWidth?"mtkz":partType),sb.appendASCII(34),partRendersWhitespace){let partContentCnt=0;{let _charIndex=charIndex,_visibleColumn=visibleColumn;for(;_charIndex<partEndIndex;_charIndex++){const charWidth=0|(9===lineContent.charCodeAt(_charIndex)?tabSize-_visibleColumn%tabSize:1);partContentCnt+=charWidth,_charIndex>=fauxIndentLength&&(_visibleColumn+=charWidth)}}for(partRendersWhitespaceWithWidth&&(sb.appendASCIIString(' style="width:'),sb.appendASCIIString(String(spaceWidth*partContentCnt)),sb.appendASCIIString('px"')),sb.appendASCII(62);charIndex<partEndIndex;charIndex++){characterMapping.setColumnInfo(charIndex+1,partIndex-partDisplacement,charOffsetInPart,partAbsoluteOffset),partDisplacement=0;let charWidth;if(9===lineContent.charCodeAt(charIndex)){charWidth=tabSize-visibleColumn%tabSize|0,!canUseHalfwidthRightwardsArrow||charWidth>1?sb.write1(8594):sb.write1(65515);for(let space=2;space<=charWidth;space++)sb.write1(160)}else charWidth=1,sb.write1(renderSpaceCharCode);charOffsetInPart+=charWidth,charIndex>=fauxIndentLength&&(visibleColumn+=charWidth)}prevPartContentCnt=partContentCnt}else{let partContentCnt=0;for(sb.appendASCII(62);charIndex<partEndIndex;charIndex++){characterMapping.setColumnInfo(charIndex+1,partIndex-partDisplacement,charOffsetInPart,partAbsoluteOffset),partDisplacement=0;const charCode=lineContent.charCodeAt(charIndex);let producedCharacters=1,charWidth=1;switch(charCode){case 9:producedCharacters=tabSize-visibleColumn%tabSize,charWidth=producedCharacters;for(let space=1;space<=producedCharacters;space++)sb.write1(160);break;case 32:sb.write1(160);break;case 60:sb.appendASCIIString("&lt;");break;case 62:sb.appendASCIIString("&gt;");break;case 38:sb.appendASCIIString("&amp;");break;case 0:renderControlCharacters?sb.write1(9216):sb.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:sb.write1(65533);break;default:strings.isFullWidthCharacter(charCode)&&charWidth++,renderControlCharacters&&charCode<32?sb.write1(9216+charCode):renderControlCharacters&&127===charCode?sb.write1(9249):renderControlCharacters&&isControlCharacter(charCode)?(sb.appendASCIIString("[U+"),sb.appendASCIIString(to4CharHex(charCode)),sb.appendASCIIString("]"),producedCharacters=8):sb.write1(charCode)}charOffsetInPart+=producedCharacters,partContentCnt+=producedCharacters,charIndex>=fauxIndentLength&&(visibleColumn+=charWidth)}prevPartContentCnt=partContentCnt}partIsEmptyAndHasPseudoAfter?partDisplacement++:partDisplacement=0,charIndex>=len&&!lastCharacterMappingDefined&&part.isPseudoAfter()&&(lastCharacterMappingDefined=!0,characterMapping.setColumnInfo(charIndex+1,partIndex,charOffsetInPart,partAbsoluteOffset)),sb.appendASCIIString("</span>")}lastCharacterMappingDefined||characterMapping.setColumnInfo(len+1,parts.length-1,charOffsetInPart,partAbsoluteOffset);isOverflowing&&sb.appendASCIIString("<span>&hellip;</span>");return sb.appendASCIIString("</span>"),new RenderLineOutput(characterMapping,containsRTL,containsForeignElements)}(function resolveRenderLineInput(input){const lineContent=input.lineContent;let isOverflowing,len;-1!==input.stopRenderingLineAfter&&input.stopRenderingLineAfter<lineContent.length?(isOverflowing=!0,len=input.stopRenderingLineAfter):(isOverflowing=!1,len=lineContent.length);let tokens=function transformAndRemoveOverflowing(tokens,fauxIndentLength,len){const result=[];let resultLen=0;fauxIndentLength>0&&(result[resultLen++]=new LinePart(fauxIndentLength,"",0));for(let tokenIndex=0,tokensLen=tokens.getCount();tokenIndex<tokensLen;tokenIndex++){const endIndex=tokens.getEndOffset(tokenIndex);if(endIndex<=fauxIndentLength)continue;const type=tokens.getClassName(tokenIndex);if(endIndex>=len){result[resultLen++]=new LinePart(len,type,0);break}result[resultLen++]=new LinePart(endIndex,type,0)}return result}(input.lineTokens,input.fauxIndentLength,len);input.renderControlCharacters&&!input.isBasicASCII&&(tokens=function extractControlCharacters(lineContent,tokens){const result=[];let lastLinePart=new LinePart(0,"",0),charOffset=0;for(const token of tokens){const tokenEndIndex=token.endIndex;for(;charOffset<tokenEndIndex;charOffset++){isControlCharacter(lineContent.charCodeAt(charOffset))&&(charOffset>lastLinePart.endIndex&&(lastLinePart=new LinePart(charOffset,token.type,token.metadata),result.push(lastLinePart)),lastLinePart=new LinePart(charOffset+1,"mtkcontrol",token.metadata),result.push(lastLinePart))}charOffset>lastLinePart.endIndex&&(lastLinePart=new LinePart(tokenEndIndex,token.type,token.metadata),result.push(lastLinePart))}return result}(lineContent,tokens));(4===input.renderWhitespace||1===input.renderWhitespace||2===input.renderWhitespace&&input.selectionsOnLine||3===input.renderWhitespace)&&(tokens=function _applyRenderWhitespace(input,lineContent,len,tokens){const continuesWithWrappedLine=input.continuesWithWrappedLine,fauxIndentLength=input.fauxIndentLength,tabSize=input.tabSize,startVisibleColumn=input.startVisibleColumn,useMonospaceOptimizations=input.useMonospaceOptimizations,selections=input.selectionsOnLine,onlyBoundary=1===input.renderWhitespace,onlyTrailing=3===input.renderWhitespace,generateLinePartForEachWhitespace=input.renderSpaceWidth!==input.spaceWidth,result=[];let resultLen=0,tokenIndex=0,tokenType=tokens[tokenIndex].type,tokenEndIndex=tokens[tokenIndex].endIndex;const tokensLength=tokens.length;let lastNonWhitespaceIndex,lineIsEmptyOrWhitespace=!1,firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(lineContent);-1===firstNonWhitespaceIndex?(lineIsEmptyOrWhitespace=!0,firstNonWhitespaceIndex=len,lastNonWhitespaceIndex=len):lastNonWhitespaceIndex=strings.lastNonWhitespaceIndex(lineContent);let wasInWhitespace=!1,currentSelectionIndex=0,currentSelection=selections&&selections[currentSelectionIndex],tmpIndent=startVisibleColumn%tabSize;for(let charIndex=fauxIndentLength;charIndex<len;charIndex++){const chCode=lineContent.charCodeAt(charIndex);let isInWhitespace;if(currentSelection&&charIndex>=currentSelection.endOffset&&(currentSelectionIndex++,currentSelection=selections&&selections[currentSelectionIndex]),charIndex<firstNonWhitespaceIndex||charIndex>lastNonWhitespaceIndex)isInWhitespace=!0;else if(9===chCode)isInWhitespace=!0;else if(32===chCode)if(onlyBoundary)if(wasInWhitespace)isInWhitespace=!0;else{const nextChCode=charIndex+1<len?lineContent.charCodeAt(charIndex+1):0;isInWhitespace=32===nextChCode||9===nextChCode}else isInWhitespace=!0;else isInWhitespace=!1;if(isInWhitespace&&selections&&(isInWhitespace=!!currentSelection&&currentSelection.startOffset<=charIndex&&currentSelection.endOffset>charIndex),isInWhitespace&&onlyTrailing&&(isInWhitespace=lineIsEmptyOrWhitespace||charIndex>lastNonWhitespaceIndex),wasInWhitespace){if(!isInWhitespace||!useMonospaceOptimizations&&tmpIndent>=tabSize){if(generateLinePartForEachWhitespace){for(let i=(resultLen>0?result[resultLen-1].endIndex:fauxIndentLength)+1;i<=charIndex;i++)result[resultLen++]=new LinePart(i,"mtkw",1)}else result[resultLen++]=new LinePart(charIndex,"mtkw",1);tmpIndent%=tabSize}}else(charIndex===tokenEndIndex||isInWhitespace&&charIndex>fauxIndentLength)&&(result[resultLen++]=new LinePart(charIndex,tokenType,0),tmpIndent%=tabSize);for(9===chCode?tmpIndent=tabSize:strings.isFullWidthCharacter(chCode)?tmpIndent+=2:tmpIndent++,wasInWhitespace=isInWhitespace;charIndex===tokenEndIndex&&(tokenIndex++,tokenIndex<tokensLength);)tokenType=tokens[tokenIndex].type,tokenEndIndex=tokens[tokenIndex].endIndex}let generateWhitespace=!1;if(wasInWhitespace)if(continuesWithWrappedLine&&onlyBoundary){const lastCharCode=len>0?lineContent.charCodeAt(len-1):0,prevCharCode=len>1?lineContent.charCodeAt(len-2):0;32===lastCharCode&&32!==prevCharCode&&9!==prevCharCode||(generateWhitespace=!0)}else generateWhitespace=!0;if(generateWhitespace)if(generateLinePartForEachWhitespace){for(let i=(resultLen>0?result[resultLen-1].endIndex:fauxIndentLength)+1;i<=len;i++)result[resultLen++]=new LinePart(i,"mtkw",1)}else result[resultLen++]=new LinePart(len,"mtkw",1);else result[resultLen++]=new LinePart(len,tokenType,0);return result}(input,lineContent,len,tokens));let containsForeignElements=0;if(input.lineDecorations.length>0){for(let i=0,len=input.lineDecorations.length;i<len;i++){const lineDecoration=input.lineDecorations[i];3===lineDecoration.type||1===lineDecoration.type?containsForeignElements|=1:2===lineDecoration.type&&(containsForeignElements|=2)}tokens=function _applyInlineDecorations(lineContent,len,tokens,_lineDecorations){_lineDecorations.sort(lineDecorations_1.LineDecoration.compare);const lineDecorations=lineDecorations_1.LineDecorationsNormalizer.normalize(lineContent,_lineDecorations),lineDecorationsLen=lineDecorations.length;let lineDecorationIndex=0;const result=[];let resultLen=0,lastResultEndIndex=0;for(let tokenIndex=0,len=tokens.length;tokenIndex<len;tokenIndex++){const token=tokens[tokenIndex],tokenEndIndex=token.endIndex,tokenType=token.type,tokenMetadata=token.metadata;for(;lineDecorationIndex<lineDecorationsLen&&lineDecorations[lineDecorationIndex].startOffset<tokenEndIndex;){const lineDecoration=lineDecorations[lineDecorationIndex];if(lineDecoration.startOffset>lastResultEndIndex&&(lastResultEndIndex=lineDecoration.startOffset,result[resultLen++]=new LinePart(lastResultEndIndex,tokenType,tokenMetadata)),!(lineDecoration.endOffset+1<=tokenEndIndex)){lastResultEndIndex=tokenEndIndex,result[resultLen++]=new LinePart(lastResultEndIndex,tokenType+" "+lineDecoration.className,tokenMetadata|lineDecoration.metadata);break}lastResultEndIndex=lineDecoration.endOffset+1,result[resultLen++]=new LinePart(lastResultEndIndex,tokenType+" "+lineDecoration.className,tokenMetadata|lineDecoration.metadata),lineDecorationIndex++}tokenEndIndex>lastResultEndIndex&&(lastResultEndIndex=tokenEndIndex,result[resultLen++]=new LinePart(lastResultEndIndex,tokenType,tokenMetadata))}const lastTokenEndIndex=tokens[tokens.length-1].endIndex;if(lineDecorationIndex<lineDecorationsLen&&lineDecorations[lineDecorationIndex].startOffset===lastTokenEndIndex)for(;lineDecorationIndex<lineDecorationsLen&&lineDecorations[lineDecorationIndex].startOffset===lastTokenEndIndex;){const lineDecoration=lineDecorations[lineDecorationIndex];result[resultLen++]=new LinePart(lastResultEndIndex,lineDecoration.className,lineDecoration.metadata),lineDecorationIndex++}return result}(lineContent,0,tokens,input.lineDecorations)}input.containsRTL||(tokens=function splitLargeTokens(lineContent,tokens,onlyAtSpaces){let lastTokenEndIndex=0;const result=[];let resultLen=0;if(onlyAtSpaces)for(let i=0,len=tokens.length;i<len;i++){const token=tokens[i],tokenEndIndex=token.endIndex;if(lastTokenEndIndex+50<tokenEndIndex){const tokenType=token.type,tokenMetadata=token.metadata;let lastSpaceOffset=-1,currTokenStart=lastTokenEndIndex;for(let j=lastTokenEndIndex;j<tokenEndIndex;j++)32===lineContent.charCodeAt(j)&&(lastSpaceOffset=j),-1!==lastSpaceOffset&&j-currTokenStart>=50&&(result[resultLen++]=new LinePart(lastSpaceOffset+1,tokenType,tokenMetadata),currTokenStart=lastSpaceOffset+1,lastSpaceOffset=-1);currTokenStart!==tokenEndIndex&&(result[resultLen++]=new LinePart(tokenEndIndex,tokenType,tokenMetadata))}else result[resultLen++]=token;lastTokenEndIndex=tokenEndIndex}else for(let i=0,len=tokens.length;i<len;i++){const token=tokens[i],tokenEndIndex=token.endIndex,diff=tokenEndIndex-lastTokenEndIndex;if(diff>50){const tokenType=token.type,tokenMetadata=token.metadata,piecesCount=Math.ceil(diff/50);for(let j=1;j<piecesCount;j++){const pieceEndIndex=lastTokenEndIndex+50*j;result[resultLen++]=new LinePart(pieceEndIndex,tokenType,tokenMetadata)}result[resultLen++]=new LinePart(tokenEndIndex,tokenType,tokenMetadata)}else result[resultLen++]=token;lastTokenEndIndex=tokenEndIndex}return result}(lineContent,tokens,!input.isBasicASCII||input.fontLigatures));return new ResolvedRenderLineInput(input.useMonospaceOptimizations,input.canUseHalfwidthRightwardsArrow,lineContent,len,isOverflowing,tokens,containsForeignElements,input.fauxIndentLength,input.tabSize,input.startVisibleColumn,input.containsRTL,input.spaceWidth,input.renderSpaceCharCode,input.renderWhitespace,input.renderControlCharacters)}(input),sb)}exports.RenderLineOutput=RenderLineOutput,exports.renderViewLine=renderViewLine;class RenderLineOutput2{constructor(characterMapping,html,containsRTL,containsForeignElements){this.characterMapping=characterMapping,this.html=html,this.containsRTL=containsRTL,this.containsForeignElements=containsForeignElements}}exports.RenderLineOutput2=RenderLineOutput2,exports.renderViewLine2=function renderViewLine2(input){const sb=(0,stringBuilder_1.createStringBuilder)(1e4),out=renderViewLine(input,sb);return new RenderLineOutput2(out.characterMapping,sb.build(),out.containsRTL,out.containsForeignElements)};class ResolvedRenderLineInput{constructor(fontIsMonospace,canUseHalfwidthRightwardsArrow,lineContent,len,isOverflowing,parts,containsForeignElements,fauxIndentLength,tabSize,startVisibleColumn,containsRTL,spaceWidth,renderSpaceCharCode,renderWhitespace,renderControlCharacters){this.fontIsMonospace=fontIsMonospace,this.canUseHalfwidthRightwardsArrow=canUseHalfwidthRightwardsArrow,this.lineContent=lineContent,this.len=len,this.isOverflowing=isOverflowing,this.parts=parts,this.containsForeignElements=containsForeignElements,this.fauxIndentLength=fauxIndentLength,this.tabSize=tabSize,this.startVisibleColumn=startVisibleColumn,this.containsRTL=containsRTL,this.spaceWidth=spaceWidth,this.renderSpaceCharCode=renderSpaceCharCode,this.renderWhitespace=renderWhitespace,this.renderControlCharacters=renderControlCharacters}}function isControlCharacter(charCode){return charCode<32?9!==charCode:127===charCode||(charCode>=8234&&charCode<=8238||charCode>=8294&&charCode<=8297||charCode>=8206&&charCode<=8207||1564===charCode)}function to4CharHex(n){return n.toString(16).toUpperCase().padStart(4,"0")}})),define(__m[452],__M([1,0,3]),(function(require,exports,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewportData=void 0;exports.ViewportData=class ViewportData{constructor(selections,partialData,whitespaceViewportData,model){this.selections=selections,this.startLineNumber=0|partialData.startLineNumber,this.endLineNumber=0|partialData.endLineNumber,this.relativeVerticalOffset=partialData.relativeVerticalOffset,this.bigNumbersDelta=0|partialData.bigNumbersDelta,this.whitespaceViewportData=whitespaceViewportData,this._model=model,this.visibleRange=new range_1.Range(partialData.startLineNumber,this._model.getLineMinColumn(partialData.startLineNumber),partialData.endLineNumber,this._model.getLineMaxColumn(partialData.endLineNumber))}getViewLineRenderingData(lineNumber){return this._model.getViewLineRenderingData(this.visibleRange,lineNumber)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}})),define(__m[71],__M([1,0,8,3]),(function(require,exports,strings,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverviewRulerDecorationsGroup=exports.ViewModelDecoration=exports.SingleLineInlineDecoration=exports.InlineDecoration=exports.ViewLineRenderingData=exports.ViewLineData=exports.MinimapLinesRenderingData=exports.Viewport=void 0;exports.Viewport=class Viewport{constructor(top,left,width,height){this._viewportBrand=void 0,this.top=0|top,this.left=0|left,this.width=0|width,this.height=0|height}};exports.MinimapLinesRenderingData=class MinimapLinesRenderingData{constructor(tabSize,data){this.tabSize=tabSize,this.data=data}};exports.ViewLineData=class ViewLineData{constructor(content,continuesWithWrappedLine,minColumn,maxColumn,startVisibleColumn,tokens,inlineDecorations){this._viewLineDataBrand=void 0,this.content=content,this.continuesWithWrappedLine=continuesWithWrappedLine,this.minColumn=minColumn,this.maxColumn=maxColumn,this.startVisibleColumn=startVisibleColumn,this.tokens=tokens,this.inlineDecorations=inlineDecorations}};class ViewLineRenderingData{constructor(minColumn,maxColumn,content,continuesWithWrappedLine,mightContainRTL,mightContainNonBasicASCII,tokens,inlineDecorations,tabSize,startVisibleColumn){this.minColumn=minColumn,this.maxColumn=maxColumn,this.content=content,this.continuesWithWrappedLine=continuesWithWrappedLine,this.isBasicASCII=ViewLineRenderingData.isBasicASCII(content,mightContainNonBasicASCII),this.containsRTL=ViewLineRenderingData.containsRTL(content,this.isBasicASCII,mightContainRTL),this.tokens=tokens,this.inlineDecorations=inlineDecorations,this.tabSize=tabSize,this.startVisibleColumn=startVisibleColumn}static isBasicASCII(lineContent,mightContainNonBasicASCII){return!mightContainNonBasicASCII||strings.isBasicASCII(lineContent)}static containsRTL(lineContent,isBasicASCII,mightContainRTL){return!(isBasicASCII||!mightContainRTL)&&strings.containsRTL(lineContent)}}exports.ViewLineRenderingData=ViewLineRenderingData;class InlineDecoration{constructor(range,inlineClassName,type){this.range=range,this.inlineClassName=inlineClassName,this.type=type}}exports.InlineDecoration=InlineDecoration;exports.SingleLineInlineDecoration=class SingleLineInlineDecoration{constructor(startOffset,endOffset,inlineClassName,inlineClassNameAffectsLetterSpacing){this.startOffset=startOffset,this.endOffset=endOffset,this.inlineClassName=inlineClassName,this.inlineClassNameAffectsLetterSpacing=inlineClassNameAffectsLetterSpacing}toInlineDecoration(lineNumber){return new InlineDecoration(new range_1.Range(lineNumber,this.startOffset+1,lineNumber,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}};exports.ViewModelDecoration=class ViewModelDecoration{constructor(range,options){this._viewModelDecorationBrand=void 0,this.range=range,this.options=options}};exports.OverviewRulerDecorationsGroup=class OverviewRulerDecorationsGroup{constructor(color,zIndex,data){this.color=color,this.zIndex=zIndex,this.data=data}static cmp(a,b){return a.zIndex===b.zIndex?a.color<b.color?-1:a.color>b.color?1:0:a.zIndex-b.zIndex}}})),define(__m[255],__M([1,0,4,2,239,27]),(function(require,exports,event_1,lifecycle_1,rgba_1,languages_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MinimapTokensColorTracker=void 0;class MinimapTokensColorTracker extends lifecycle_1.Disposable{constructor(){super(),this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(languages_1.TokenizationRegistry.onDidChange((e=>{e.changedColorMap&&this._updateColorMap()})))}static getInstance(){return this._INSTANCE||(this._INSTANCE=(0,lifecycle_1.markAsSingleton)(new MinimapTokensColorTracker)),this._INSTANCE}_updateColorMap(){const colorMap=languages_1.TokenizationRegistry.getColorMap();if(!colorMap)return this._colors=[rgba_1.RGBA8.Empty],void(this._backgroundIsLight=!0);this._colors=[rgba_1.RGBA8.Empty];for(let colorId=1;colorId<colorMap.length;colorId++){const source=colorMap[colorId].rgba;this._colors[colorId]=new rgba_1.RGBA8(source.r,source.g,source.b,Math.round(255*source.a))}const backgroundLuminosity=colorMap[2].getRelativeLuminance();this._backgroundIsLight=backgroundLuminosity>=.5,this._onDidChange.fire(void 0)}getColor(colorId){return(colorId<1||colorId>=this._colors.length)&&(colorId=2),this._colors[colorId]}backgroundIsLight(){return this._backgroundIsLight}}exports.MinimapTokensColorTracker=MinimapTokensColorTracker,MinimapTokensColorTracker._INSTANCE=null})),define(__m[453],__M([1,0,77,11,94,71]),(function(require,exports,lineTokens_1,position_1,textModelEvents_1,viewModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createModelLineProjection=void 0,exports.createModelLineProjection=function createModelLineProjection(lineBreakData,isVisible){return null===lineBreakData?isVisible?IdentityModelLineProjection.INSTANCE:HiddenModelLineProjection.INSTANCE:new ModelLineProjection(lineBreakData,isVisible)};class ModelLineProjection{constructor(lineBreakData,isVisible){this._projectionData=lineBreakData,this._isVisible=isVisible}isVisible(){return this._isVisible}setVisible(isVisible){return this._isVisible=isVisible,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(model,modelLineNumber,outputLineIndex){this._assertVisible();const startOffsetInInputWithInjections=outputLineIndex>0?this._projectionData.breakOffsets[outputLineIndex-1]:0,endOffsetInInputWithInjections=this._projectionData.breakOffsets[outputLineIndex];let r;if(null!==this._projectionData.injectionOffsets){const injectedTexts=this._projectionData.injectionOffsets.map(((offset,idx)=>new textModelEvents_1.LineInjectedText(0,0,offset+1,this._projectionData.injectionOptions[idx],0)));r=textModelEvents_1.LineInjectedText.applyInjectedText(model.getLineContent(modelLineNumber),injectedTexts).substring(startOffsetInInputWithInjections,endOffsetInInputWithInjections)}else r=model.getValueInRange({startLineNumber:modelLineNumber,startColumn:startOffsetInInputWithInjections+1,endLineNumber:modelLineNumber,endColumn:endOffsetInInputWithInjections+1});return outputLineIndex>0&&(r=spaces(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(model,modelLineNumber,outputLineIndex){return this._assertVisible(),this._projectionData.getLineLength(outputLineIndex)}getViewLineMinColumn(_model,_modelLineNumber,outputLineIndex){return this._assertVisible(),this._projectionData.getMinOutputOffset(outputLineIndex)+1}getViewLineMaxColumn(model,modelLineNumber,outputLineIndex){return this._assertVisible(),this._projectionData.getMaxOutputOffset(outputLineIndex)+1}getViewLineData(model,modelLineNumber,outputLineIndex){const arr=new Array;return this.getViewLinesData(model,modelLineNumber,outputLineIndex,1,0,[!0],arr),arr[0]}getViewLinesData(model,modelLineNumber,outputLineIdx,lineCount,globalStartIndex,needed,result){this._assertVisible();const lineBreakData=this._projectionData,injectionOffsets=lineBreakData.injectionOffsets,injectionOptions=lineBreakData.injectionOptions;let lineWithInjections,inlineDecorationsPerOutputLine=null;if(injectionOffsets){inlineDecorationsPerOutputLine=[];let totalInjectedTextLengthBefore=0,currentInjectedOffset=0;for(let outputLineIndex=0;outputLineIndex<lineBreakData.getOutputLineCount();outputLineIndex++){const inlineDecorations=new Array;inlineDecorationsPerOutputLine[outputLineIndex]=inlineDecorations;const lineStartOffsetInInputWithInjections=outputLineIndex>0?lineBreakData.breakOffsets[outputLineIndex-1]:0,lineEndOffsetInInputWithInjections=lineBreakData.breakOffsets[outputLineIndex];for(;currentInjectedOffset<injectionOffsets.length;){const length=injectionOptions[currentInjectedOffset].content.length,injectedTextStartOffsetInInputWithInjections=injectionOffsets[currentInjectedOffset]+totalInjectedTextLengthBefore,injectedTextEndOffsetInInputWithInjections=injectedTextStartOffsetInInputWithInjections+length;if(injectedTextStartOffsetInInputWithInjections>lineEndOffsetInInputWithInjections)break;if(lineStartOffsetInInputWithInjections<injectedTextEndOffsetInInputWithInjections){const options=injectionOptions[currentInjectedOffset];if(options.inlineClassName){const offset=outputLineIndex>0?lineBreakData.wrappedTextIndentLength:0,start=offset+Math.max(injectedTextStartOffsetInInputWithInjections-lineStartOffsetInInputWithInjections,0),end=offset+Math.min(injectedTextEndOffsetInInputWithInjections-lineStartOffsetInInputWithInjections,lineEndOffsetInInputWithInjections);start!==end&&inlineDecorations.push(new viewModel_1.SingleLineInlineDecoration(start,end,options.inlineClassName,options.inlineClassNameAffectsLetterSpacing))}}if(!(injectedTextEndOffsetInInputWithInjections<=lineEndOffsetInInputWithInjections))break;totalInjectedTextLengthBefore+=length,currentInjectedOffset++}}}lineWithInjections=injectionOffsets?model.getLineTokens(modelLineNumber).withInserted(injectionOffsets.map(((offset,idx)=>({offset,text:injectionOptions[idx].content,tokenMetadata:lineTokens_1.LineTokens.defaultTokenMetadata})))):model.getLineTokens(modelLineNumber);for(let outputLineIndex=outputLineIdx;outputLineIndex<outputLineIdx+lineCount;outputLineIndex++){const globalIndex=globalStartIndex+outputLineIndex-outputLineIdx;needed[globalIndex]?result[globalIndex]=this._getViewLineData(lineWithInjections,inlineDecorationsPerOutputLine?inlineDecorationsPerOutputLine[outputLineIndex]:null,outputLineIndex):result[globalIndex]=null}}_getViewLineData(lineWithInjections,inlineDecorations,outputLineIndex){this._assertVisible();const lineBreakData=this._projectionData,deltaStartIndex=outputLineIndex>0?lineBreakData.wrappedTextIndentLength:0,lineStartOffsetInInputWithInjections=outputLineIndex>0?lineBreakData.breakOffsets[outputLineIndex-1]:0,lineEndOffsetInInputWithInjections=lineBreakData.breakOffsets[outputLineIndex],tokens=lineWithInjections.sliceAndInflate(lineStartOffsetInInputWithInjections,lineEndOffsetInInputWithInjections,deltaStartIndex);let lineContent=tokens.getLineContent();outputLineIndex>0&&(lineContent=spaces(lineBreakData.wrappedTextIndentLength)+lineContent);const minColumn=this._projectionData.getMinOutputOffset(outputLineIndex)+1,maxColumn=lineContent.length+1,continuesWithWrappedLine=outputLineIndex+1<this.getViewLineCount(),startVisibleColumn=0===outputLineIndex?0:lineBreakData.breakOffsetsVisibleColumn[outputLineIndex-1];return new viewModel_1.ViewLineData(lineContent,continuesWithWrappedLine,minColumn,maxColumn,startVisibleColumn,tokens,inlineDecorations)}getModelColumnOfViewPosition(outputLineIndex,outputColumn){return this._assertVisible(),this._projectionData.translateToInputOffset(outputLineIndex,outputColumn-1)+1}getViewPositionOfModelPosition(deltaLineNumber,inputColumn,affinity=2){this._assertVisible();return this._projectionData.translateToOutputPosition(inputColumn-1,affinity).toPosition(deltaLineNumber)}getViewLineNumberOfModelPosition(deltaLineNumber,inputColumn){this._assertVisible();return deltaLineNumber+this._projectionData.translateToOutputPosition(inputColumn-1).outputLineIndex}normalizePosition(outputLineIndex,outputPosition,affinity){const baseViewLineNumber=outputPosition.lineNumber-outputLineIndex;return this._projectionData.normalizeOutputPosition(outputLineIndex,outputPosition.column-1,affinity).toPosition(baseViewLineNumber)}getInjectedTextAt(outputLineIndex,outputColumn){return this._projectionData.getInjectedText(outputLineIndex,outputColumn-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class IdentityModelLineProjection{constructor(){}isVisible(){return!0}setVisible(isVisible){return isVisible?this:HiddenModelLineProjection.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(model,modelLineNumber,_outputLineIndex){return model.getLineContent(modelLineNumber)}getViewLineLength(model,modelLineNumber,_outputLineIndex){return model.getLineLength(modelLineNumber)}getViewLineMinColumn(model,modelLineNumber,_outputLineIndex){return model.getLineMinColumn(modelLineNumber)}getViewLineMaxColumn(model,modelLineNumber,_outputLineIndex){return model.getLineMaxColumn(modelLineNumber)}getViewLineData(model,modelLineNumber,_outputLineIndex){const lineTokens=model.getLineTokens(modelLineNumber),lineContent=lineTokens.getLineContent();return new viewModel_1.ViewLineData(lineContent,!1,1,lineContent.length+1,0,lineTokens.inflate(),null)}getViewLinesData(model,modelLineNumber,_fromOuputLineIndex,_toOutputLineIndex,globalStartIndex,needed,result){needed[globalStartIndex]?result[globalStartIndex]=this.getViewLineData(model,modelLineNumber,0):result[globalStartIndex]=null}getModelColumnOfViewPosition(_outputLineIndex,outputColumn){return outputColumn}getViewPositionOfModelPosition(deltaLineNumber,inputColumn){return new position_1.Position(deltaLineNumber,inputColumn)}getViewLineNumberOfModelPosition(deltaLineNumber,_inputColumn){return deltaLineNumber}normalizePosition(outputLineIndex,outputPosition,affinity){return outputPosition}getInjectedTextAt(_outputLineIndex,_outputColumn){return null}}IdentityModelLineProjection.INSTANCE=new IdentityModelLineProjection;class HiddenModelLineProjection{constructor(){}isVisible(){return!1}setVisible(isVisible){return isVisible?IdentityModelLineProjection.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(_model,_modelLineNumber,_outputLineIndex){throw new Error("Not supported")}getViewLineLength(_model,_modelLineNumber,_outputLineIndex){throw new Error("Not supported")}getViewLineMinColumn(_model,_modelLineNumber,_outputLineIndex){throw new Error("Not supported")}getViewLineMaxColumn(_model,_modelLineNumber,_outputLineIndex){throw new Error("Not supported")}getViewLineData(_model,_modelLineNumber,_outputLineIndex){throw new Error("Not supported")}getViewLinesData(_model,_modelLineNumber,_fromOuputLineIndex,_toOutputLineIndex,_globalStartIndex,_needed,_result){throw new Error("Not supported")}getModelColumnOfViewPosition(_outputLineIndex,_outputColumn){throw new Error("Not supported")}getViewPositionOfModelPosition(_deltaLineNumber,_inputColumn){throw new Error("Not supported")}getViewLineNumberOfModelPosition(_deltaLineNumber,_inputColumn){throw new Error("Not supported")}normalizePosition(outputLineIndex,outputPosition,affinity){throw new Error("Not supported")}getInjectedTextAt(_outputLineIndex,_outputColumn){throw new Error("Not supported")}}HiddenModelLineProjection.INSTANCE=new HiddenModelLineProjection;let _spaces=[""];function spaces(count){if(count>=_spaces.length)for(let i=1;i<=count;i++)_spaces[i]=_makeSpaces(i);return _spaces[count]}function _makeSpaces(count){return new Array(count+1).join(" ")}})),define(__m[454],__M([1,0,8,99,94,248]),(function(require,exports,strings,characterClassifier_1,textModelEvents_1,modelLineProjectionData_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MonospaceLineBreaksComputerFactory=void 0;class MonospaceLineBreaksComputerFactory{constructor(breakBeforeChars,breakAfterChars){this.classifier=new WrappingCharacterClassifier(breakBeforeChars,breakAfterChars)}static create(options){return new MonospaceLineBreaksComputerFactory(options.get(120),options.get(119))}createLineBreaksComputer(fontInfo,tabSize,wrappingColumn,wrappingIndent){const requests=[],injectedTexts=[],previousBreakingData=[];return{addRequest:(lineText,injectedText,previousLineBreakData)=>{requests.push(lineText),injectedTexts.push(injectedText),previousBreakingData.push(previousLineBreakData)},finalize:()=>{const columnsForFullWidthChar=fontInfo.typicalFullwidthCharacterWidth/fontInfo.typicalHalfwidthCharacterWidth,result=[];for(let i=0,len=requests.length;i<len;i++){const injectedText=injectedTexts[i],previousLineBreakData=previousBreakingData[i];!previousLineBreakData||previousLineBreakData.injectionOptions||injectedText?result[i]=createLineBreaks(this.classifier,requests[i],injectedText,tabSize,wrappingColumn,columnsForFullWidthChar,wrappingIndent):result[i]=createLineBreaksFromPreviousLineBreaks(this.classifier,previousLineBreakData,requests[i],tabSize,wrappingColumn,columnsForFullWidthChar,wrappingIndent)}return arrPool1.length=0,arrPool2.length=0,result}}}}exports.MonospaceLineBreaksComputerFactory=MonospaceLineBreaksComputerFactory;class WrappingCharacterClassifier extends characterClassifier_1.CharacterClassifier{constructor(BREAK_BEFORE,BREAK_AFTER){super(0);for(let i=0;i<BREAK_BEFORE.length;i++)this.set(BREAK_BEFORE.charCodeAt(i),1);for(let i=0;i<BREAK_AFTER.length;i++)this.set(BREAK_AFTER.charCodeAt(i),2)}get(charCode){return charCode>=0&&charCode<256?this._asciiMap[charCode]:charCode>=12352&&charCode<=12543||charCode>=13312&&charCode<=19903||charCode>=19968&&charCode<=40959?3:this._map.get(charCode)||this._defaultValue}}let arrPool1=[],arrPool2=[];function createLineBreaksFromPreviousLineBreaks(classifier,previousBreakingData,lineText,tabSize,firstLineBreakColumn,columnsForFullWidthChar,wrappingIndent){if(-1===firstLineBreakColumn)return null;const len=lineText.length;if(len<=1)return null;const prevBreakingOffsets=previousBreakingData.breakOffsets,prevBreakingOffsetsVisibleColumn=previousBreakingData.breakOffsetsVisibleColumn,wrappedTextIndentLength=computeWrappedTextIndentLength(lineText,tabSize,firstLineBreakColumn,columnsForFullWidthChar,wrappingIndent),wrappedLineBreakColumn=firstLineBreakColumn-wrappedTextIndentLength,breakingOffsets=arrPool1,breakingOffsetsVisibleColumn=arrPool2;let breakingOffsetsCount=0,lastBreakingOffset=0,lastBreakingOffsetVisibleColumn=0,breakingColumn=firstLineBreakColumn;const prevLen=prevBreakingOffsets.length;let prevIndex=0;if(prevIndex>=0){let bestDistance=Math.abs(prevBreakingOffsetsVisibleColumn[prevIndex]-breakingColumn);for(;prevIndex+1<prevLen;){const distance=Math.abs(prevBreakingOffsetsVisibleColumn[prevIndex+1]-breakingColumn);if(distance>=bestDistance)break;bestDistance=distance,prevIndex++}}for(;prevIndex<prevLen;){let prevBreakOffset=prevIndex<0?0:prevBreakingOffsets[prevIndex],prevBreakOffsetVisibleColumn=prevIndex<0?0:prevBreakingOffsetsVisibleColumn[prevIndex];lastBreakingOffset>prevBreakOffset&&(prevBreakOffset=lastBreakingOffset,prevBreakOffsetVisibleColumn=lastBreakingOffsetVisibleColumn);let breakOffset=0,breakOffsetVisibleColumn=0,forcedBreakOffset=0,forcedBreakOffsetVisibleColumn=0;if(prevBreakOffsetVisibleColumn<=breakingColumn){let visibleColumn=prevBreakOffsetVisibleColumn,prevCharCode=0===prevBreakOffset?0:lineText.charCodeAt(prevBreakOffset-1),prevCharCodeClass=0===prevBreakOffset?0:classifier.get(prevCharCode),entireLineFits=!0;for(let i=prevBreakOffset;i<len;i++){const charStartOffset=i,charCode=lineText.charCodeAt(i);let charCodeClass,charWidth;if(strings.isHighSurrogate(charCode)?(i++,charCodeClass=0,charWidth=2):(charCodeClass=classifier.get(charCode),charWidth=computeCharWidth(charCode,visibleColumn,tabSize,columnsForFullWidthChar)),charStartOffset>lastBreakingOffset&&canBreak(prevCharCode,prevCharCodeClass,charCode,charCodeClass)&&(breakOffset=charStartOffset,breakOffsetVisibleColumn=visibleColumn),visibleColumn+=charWidth,visibleColumn>breakingColumn){charStartOffset>lastBreakingOffset?(forcedBreakOffset=charStartOffset,forcedBreakOffsetVisibleColumn=visibleColumn-charWidth):(forcedBreakOffset=i+1,forcedBreakOffsetVisibleColumn=visibleColumn),visibleColumn-breakOffsetVisibleColumn>wrappedLineBreakColumn&&(breakOffset=0),entireLineFits=!1;break}prevCharCode=charCode,prevCharCodeClass=charCodeClass}if(entireLineFits){breakingOffsetsCount>0&&(breakingOffsets[breakingOffsetsCount]=prevBreakingOffsets[prevBreakingOffsets.length-1],breakingOffsetsVisibleColumn[breakingOffsetsCount]=prevBreakingOffsetsVisibleColumn[prevBreakingOffsets.length-1],breakingOffsetsCount++);break}}if(0===breakOffset){let visibleColumn=prevBreakOffsetVisibleColumn,charCode=lineText.charCodeAt(prevBreakOffset),charCodeClass=classifier.get(charCode),hitATabCharacter=!1;for(let i=prevBreakOffset-1;i>=lastBreakingOffset;i--){const charStartOffset=i+1,prevCharCode=lineText.charCodeAt(i);if(9===prevCharCode){hitATabCharacter=!0;break}let prevCharCodeClass,prevCharWidth;if(strings.isLowSurrogate(prevCharCode)?(i--,prevCharCodeClass=0,prevCharWidth=2):(prevCharCodeClass=classifier.get(prevCharCode),prevCharWidth=strings.isFullWidthCharacter(prevCharCode)?columnsForFullWidthChar:1),visibleColumn<=breakingColumn){if(0===forcedBreakOffset&&(forcedBreakOffset=charStartOffset,forcedBreakOffsetVisibleColumn=visibleColumn),visibleColumn<=breakingColumn-wrappedLineBreakColumn)break;if(canBreak(prevCharCode,prevCharCodeClass,charCode,charCodeClass)){breakOffset=charStartOffset,breakOffsetVisibleColumn=visibleColumn;break}}visibleColumn-=prevCharWidth,charCode=prevCharCode,charCodeClass=prevCharCodeClass}if(0!==breakOffset){const remainingWidthOfNextLine=wrappedLineBreakColumn-(forcedBreakOffsetVisibleColumn-breakOffsetVisibleColumn);if(remainingWidthOfNextLine<=tabSize){const charCodeAtForcedBreakOffset=lineText.charCodeAt(forcedBreakOffset);let charWidth;charWidth=strings.isHighSurrogate(charCodeAtForcedBreakOffset)?2:computeCharWidth(charCodeAtForcedBreakOffset,forcedBreakOffsetVisibleColumn,tabSize,columnsForFullWidthChar),remainingWidthOfNextLine-charWidth<0&&(breakOffset=0)}}if(hitATabCharacter){prevIndex--;continue}}if(0===breakOffset&&(breakOffset=forcedBreakOffset,breakOffsetVisibleColumn=forcedBreakOffsetVisibleColumn),breakOffset<=lastBreakingOffset){const charCode=lineText.charCodeAt(lastBreakingOffset);strings.isHighSurrogate(charCode)?(breakOffset=lastBreakingOffset+2,breakOffsetVisibleColumn=lastBreakingOffsetVisibleColumn+2):(breakOffset=lastBreakingOffset+1,breakOffsetVisibleColumn=lastBreakingOffsetVisibleColumn+computeCharWidth(charCode,lastBreakingOffsetVisibleColumn,tabSize,columnsForFullWidthChar))}for(lastBreakingOffset=breakOffset,breakingOffsets[breakingOffsetsCount]=breakOffset,lastBreakingOffsetVisibleColumn=breakOffsetVisibleColumn,breakingOffsetsVisibleColumn[breakingOffsetsCount]=breakOffsetVisibleColumn,breakingOffsetsCount++,breakingColumn=breakOffsetVisibleColumn+wrappedLineBreakColumn;prevIndex<0||prevIndex<prevLen&&prevBreakingOffsetsVisibleColumn[prevIndex]<breakOffsetVisibleColumn;)prevIndex++;let bestDistance=Math.abs(prevBreakingOffsetsVisibleColumn[prevIndex]-breakingColumn);for(;prevIndex+1<prevLen;){const distance=Math.abs(prevBreakingOffsetsVisibleColumn[prevIndex+1]-breakingColumn);if(distance>=bestDistance)break;bestDistance=distance,prevIndex++}}return 0===breakingOffsetsCount?null:(breakingOffsets.length=breakingOffsetsCount,breakingOffsetsVisibleColumn.length=breakingOffsetsCount,arrPool1=previousBreakingData.breakOffsets,arrPool2=previousBreakingData.breakOffsetsVisibleColumn,previousBreakingData.breakOffsets=breakingOffsets,previousBreakingData.breakOffsetsVisibleColumn=breakingOffsetsVisibleColumn,previousBreakingData.wrappedTextIndentLength=wrappedTextIndentLength,previousBreakingData)}function createLineBreaks(classifier,_lineText,injectedTexts,tabSize,firstLineBreakColumn,columnsForFullWidthChar,wrappingIndent){const lineText=textModelEvents_1.LineInjectedText.applyInjectedText(_lineText,injectedTexts);let injectionOptions,injectionOffsets;if(injectedTexts&&injectedTexts.length>0?(injectionOptions=injectedTexts.map((t=>t.options)),injectionOffsets=injectedTexts.map((text=>text.column-1))):(injectionOptions=null,injectionOffsets=null),-1===firstLineBreakColumn)return injectionOptions?new modelLineProjectionData_1.ModelLineProjectionData(injectionOffsets,injectionOptions,[lineText.length],[],0):null;const len=lineText.length;if(len<=1)return injectionOptions?new modelLineProjectionData_1.ModelLineProjectionData(injectionOffsets,injectionOptions,[lineText.length],[],0):null;const wrappedTextIndentLength=computeWrappedTextIndentLength(lineText,tabSize,firstLineBreakColumn,columnsForFullWidthChar,wrappingIndent),wrappedLineBreakColumn=firstLineBreakColumn-wrappedTextIndentLength,breakingOffsets=[],breakingOffsetsVisibleColumn=[];let breakingOffsetsCount=0,breakOffset=0,breakOffsetVisibleColumn=0,breakingColumn=firstLineBreakColumn,prevCharCode=lineText.charCodeAt(0),prevCharCodeClass=classifier.get(prevCharCode),visibleColumn=computeCharWidth(prevCharCode,0,tabSize,columnsForFullWidthChar),startOffset=1;strings.isHighSurrogate(prevCharCode)&&(visibleColumn+=1,prevCharCode=lineText.charCodeAt(1),prevCharCodeClass=classifier.get(prevCharCode),startOffset++);for(let i=startOffset;i<len;i++){const charStartOffset=i,charCode=lineText.charCodeAt(i);let charCodeClass,charWidth;strings.isHighSurrogate(charCode)?(i++,charCodeClass=0,charWidth=2):(charCodeClass=classifier.get(charCode),charWidth=computeCharWidth(charCode,visibleColumn,tabSize,columnsForFullWidthChar)),canBreak(prevCharCode,prevCharCodeClass,charCode,charCodeClass)&&(breakOffset=charStartOffset,breakOffsetVisibleColumn=visibleColumn),visibleColumn+=charWidth,visibleColumn>breakingColumn&&((0===breakOffset||visibleColumn-breakOffsetVisibleColumn>wrappedLineBreakColumn)&&(breakOffset=charStartOffset,breakOffsetVisibleColumn=visibleColumn-charWidth),breakingOffsets[breakingOffsetsCount]=breakOffset,breakingOffsetsVisibleColumn[breakingOffsetsCount]=breakOffsetVisibleColumn,breakingOffsetsCount++,breakingColumn=breakOffsetVisibleColumn+wrappedLineBreakColumn,breakOffset=0),prevCharCode=charCode,prevCharCodeClass=charCodeClass}return 0!==breakingOffsetsCount||injectedTexts&&0!==injectedTexts.length?(breakingOffsets[breakingOffsetsCount]=len,breakingOffsetsVisibleColumn[breakingOffsetsCount]=visibleColumn,new modelLineProjectionData_1.ModelLineProjectionData(injectionOffsets,injectionOptions,breakingOffsets,breakingOffsetsVisibleColumn,wrappedTextIndentLength)):null}function computeCharWidth(charCode,visibleColumn,tabSize,columnsForFullWidthChar){return 9===charCode?tabSize-visibleColumn%tabSize:strings.isFullWidthCharacter(charCode)||charCode<32?columnsForFullWidthChar:1}function tabCharacterWidth(visibleColumn,tabSize){return tabSize-visibleColumn%tabSize}function canBreak(prevCharCode,prevCharCodeClass,charCode,charCodeClass){return 32!==charCode&&(2===prevCharCodeClass||3===prevCharCodeClass&&2!==charCodeClass||1===charCodeClass||3===charCodeClass&&1!==prevCharCodeClass)}function computeWrappedTextIndentLength(lineText,tabSize,firstLineBreakColumn,columnsForFullWidthChar,wrappingIndent){let wrappedTextIndentLength=0;if(0!==wrappingIndent){const firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(lineText);if(-1!==firstNonWhitespaceIndex){for(let i=0;i<firstNonWhitespaceIndex;i++){wrappedTextIndentLength+=9===lineText.charCodeAt(i)?tabCharacterWidth(wrappedTextIndentLength,tabSize):1}const numberOfAdditionalTabs=3===wrappingIndent?2:2===wrappingIndent?1:0;for(let i=0;i<numberOfAdditionalTabs;i++){wrappedTextIndentLength+=tabCharacterWidth(wrappedTextIndentLength,tabSize)}wrappedTextIndentLength+columnsForFullWidthChar>firstLineBreakColumn&&(wrappedTextIndentLength=0)}}return wrappedTextIndentLength}})),define(__m[256],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverviewZoneManager=exports.OverviewRulerZone=exports.ColorZone=void 0;class ColorZone{constructor(from,to,colorId){this._colorZoneBrand=void 0,this.from=0|from,this.to=0|to,this.colorId=0|colorId}static compare(a,b){return a.colorId===b.colorId?a.from===b.from?a.to-b.to:a.from-b.from:a.colorId-b.colorId}}exports.ColorZone=ColorZone;class OverviewRulerZone{constructor(startLineNumber,endLineNumber,heightInLines,color){this._overviewRulerZoneBrand=void 0,this.startLineNumber=startLineNumber,this.endLineNumber=endLineNumber,this.heightInLines=heightInLines,this.color=color,this._colorZone=null}static compare(a,b){return a.color===b.color?a.startLineNumber===b.startLineNumber?a.heightInLines===b.heightInLines?a.endLineNumber-b.endLineNumber:a.heightInLines-b.heightInLines:a.startLineNumber-b.startLineNumber:a.color<b.color?-1:1}setColorZone(colorZone){this._colorZone=colorZone}getColorZones(){return this._colorZone}}exports.OverviewRulerZone=OverviewRulerZone;exports.OverviewZoneManager=class OverviewZoneManager{constructor(getVerticalOffsetForLine){this._getVerticalOffsetForLine=getVerticalOffsetForLine,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(newZones){this._zones=newZones,this._zones.sort(OverviewRulerZone.compare)}setLineHeight(lineHeight){return this._lineHeight!==lineHeight&&(this._lineHeight=lineHeight,this._colorZonesInvalid=!0,!0)}setPixelRatio(pixelRatio){this._pixelRatio=pixelRatio,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(width){return this._domWidth!==width&&(this._domWidth=width,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(height){return this._domHeight!==height&&(this._domHeight=height,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(outerHeight){return this._outerHeight!==outerHeight&&(this._outerHeight=outerHeight,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const colorZonesInvalid=this._colorZonesInvalid,lineHeight=Math.floor(this._lineHeight),totalHeight=Math.floor(this.getCanvasHeight()),heightRatio=totalHeight/Math.floor(this._outerHeight),halfMinimumHeight=Math.floor(4*this._pixelRatio/2),allColorZones=[];for(let i=0,len=this._zones.length;i<len;i++){const zone=this._zones[i];if(!colorZonesInvalid){const colorZone=zone.getColorZones();if(colorZone){allColorZones.push(colorZone);continue}}const offset1=this._getVerticalOffsetForLine(zone.startLineNumber),offset2=0===zone.heightInLines?this._getVerticalOffsetForLine(zone.endLineNumber)+lineHeight:offset1+zone.heightInLines*lineHeight,y1=Math.floor(heightRatio*offset1),y2=Math.floor(heightRatio*offset2);let ycenter=Math.floor((y1+y2)/2),halfHeight=y2-ycenter;halfHeight<halfMinimumHeight&&(halfHeight=halfMinimumHeight),ycenter-halfHeight<0&&(ycenter=halfHeight),ycenter+halfHeight>totalHeight&&(ycenter=totalHeight-halfHeight);const color=zone.color;let colorId=this._color2Id[color];colorId||(colorId=++this._lastAssignedId,this._color2Id[color]=colorId,this._id2Color[colorId]=color);const colorZone=new ColorZone(ycenter-halfHeight,ycenter+halfHeight,colorId);zone.setColorZone(colorZone),allColorZones.push(colorZone)}return this._colorZonesInvalid=!1,allColorZones.sort(ColorZone.compare),allColorZones}}})),define(__m[455],__M([1,0,31,256,125]),(function(require,exports,fastDomNode_1,overviewZoneManager_1,viewEventHandler_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverviewRuler=void 0;class OverviewRuler extends viewEventHandler_1.ViewEventHandler{constructor(context,cssClassName){super(),this._context=context;const options=this._context.configuration.options;this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("canvas")),this._domNode.setClassName(cssClassName),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new overviewZoneManager_1.OverviewZoneManager((lineNumber=>this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber))),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(options.get(59)),this._zoneManager.setPixelRatio(options.get(129)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options;return e.hasChanged(59)&&(this._zoneManager.setLineHeight(options.get(59)),this._render()),e.hasChanged(129)&&(this._zoneManager.setPixelRatio(options.get(129)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(position){this._domNode.setTop(position.top),this._domNode.setRight(position.right);let hasChanged=!1;hasChanged=this._zoneManager.setDOMWidth(position.width)||hasChanged,hasChanged=this._zoneManager.setDOMHeight(position.height)||hasChanged,hasChanged&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(zones){this._zoneManager.setZones(zones),this._render()}_render(){if(0===this._zoneManager.getOuterHeight())return!1;const width=this._zoneManager.getCanvasWidth(),height=this._zoneManager.getCanvasHeight(),colorZones=this._zoneManager.resolveColorZones(),id2Color=this._zoneManager.getId2Color(),ctx=this._domNode.domNode.getContext("2d");return ctx.clearRect(0,0,width,height),colorZones.length>0&&this._renderOneLane(ctx,colorZones,id2Color,width),!0}_renderOneLane(ctx,colorZones,id2Color,width){let currentColorId=0,currentFrom=0,currentTo=0;for(const zone of colorZones){const zoneColorId=zone.colorId,zoneFrom=zone.from,zoneTo=zone.to;zoneColorId!==currentColorId?(ctx.fillRect(0,currentFrom,width,currentTo-currentFrom),currentColorId=zoneColorId,ctx.fillStyle=id2Color[currentColorId],currentFrom=zoneFrom,currentTo=zoneTo):currentTo>=zoneFrom?currentTo=Math.max(currentTo,zoneTo):(ctx.fillRect(0,currentFrom,width,currentTo-currentFrom),currentFrom=zoneFrom,currentTo=zoneTo)}ctx.fillRect(0,currentFrom,width,currentTo-currentFrom)}}exports.OverviewRuler=OverviewRuler})),define(__m[456],__M([1,0,409]),(function(require,exports,editorTheme_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewContext=void 0;exports.ViewContext=class ViewContext{constructor(configuration,theme,model){this.configuration=configuration,this.theme=new editorTheme_1.EditorTheme(theme),this.viewModel=model,this.viewLayout=model.viewLayout}addEventHandler(eventHandler){this.viewModel.addViewEventHandler(eventHandler)}removeEventHandler(eventHandler){this.viewModel.removeViewEventHandler(eventHandler)}}})),define(__m[190],__M([1,0,4,2]),(function(require,exports,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReadOnlyEditAttemptEvent=exports.CursorStateChangedEvent=exports.HiddenAreasChangedEvent=exports.ViewZonesChangedEvent=exports.ScrollChangedEvent=exports.FocusChangedEvent=exports.ContentSizeChangedEvent=exports.ViewModelEventsCollector=exports.ViewModelEventDispatcher=void 0;class ViewModelEventDispatcher extends lifecycle_1.Disposable{constructor(){super(),this._onEvent=this._register(new event_1.Emitter),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let i=0,len=this._outgoingEvents.length;i<len;i++)if(this._outgoingEvents[i].kind===e.kind)return void(this._outgoingEvents[i]=this._outgoingEvents[i].merge(e));this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const event=this._outgoingEvents.shift();event.isNoOp()||this._onEvent.fire(event)}}addViewEventHandler(eventHandler){for(let i=0,len=this._eventHandlers.length;i<len;i++)this._eventHandlers[i]===eventHandler&&console.warn("Detected duplicate listener in ViewEventDispatcher",eventHandler);this._eventHandlers.push(eventHandler)}removeViewEventHandler(eventHandler){for(let i=0;i<this._eventHandlers.length;i++)if(this._eventHandlers[i]===eventHandler){this._eventHandlers.splice(i,1);break}}beginEmitViewEvents(){return this._collectorCnt++,1===this._collectorCnt&&(this._collector=new ViewModelEventsCollector),this._collector}endEmitViewEvents(){if(this._collectorCnt--,0===this._collectorCnt){const outgoingEvents=this._collector.outgoingEvents,viewEvents=this._collector.viewEvents;this._collector=null;for(const outgoingEvent of outgoingEvents)this._addOutgoingEvent(outgoingEvent);viewEvents.length>0&&this._emitMany(viewEvents)}this._emitOutgoingEvents()}emitSingleViewEvent(event){try{this.beginEmitViewEvents().emitViewEvent(event)}finally{this.endEmitViewEvents()}}_emitMany(events){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(events):this._viewEventQueue=events,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const events=this._viewEventQueue;this._viewEventQueue=null;const eventHandlers=this._eventHandlers.slice(0);for(const eventHandler of eventHandlers)eventHandler.handleEvents(events)}}}exports.ViewModelEventDispatcher=ViewModelEventDispatcher;class ViewModelEventsCollector{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(event){this.viewEvents.push(event)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}exports.ViewModelEventsCollector=ViewModelEventsCollector;class ContentSizeChangedEvent{constructor(oldContentWidth,oldContentHeight,contentWidth,contentHeight){this.kind=0,this._oldContentWidth=oldContentWidth,this._oldContentHeight=oldContentHeight,this.contentWidth=contentWidth,this.contentHeight=contentHeight,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}merge(other){return 0!==other.kind?this:new ContentSizeChangedEvent(this._oldContentWidth,this._oldContentHeight,other.contentWidth,other.contentHeight)}}exports.ContentSizeChangedEvent=ContentSizeChangedEvent;class FocusChangedEvent{constructor(oldHasFocus,hasFocus){this.kind=1,this.oldHasFocus=oldHasFocus,this.hasFocus=hasFocus}isNoOp(){return this.oldHasFocus===this.hasFocus}merge(other){return 1!==other.kind?this:new FocusChangedEvent(this.oldHasFocus,other.hasFocus)}}exports.FocusChangedEvent=FocusChangedEvent;class ScrollChangedEvent{constructor(oldScrollWidth,oldScrollLeft,oldScrollHeight,oldScrollTop,scrollWidth,scrollLeft,scrollHeight,scrollTop){this.kind=2,this._oldScrollWidth=oldScrollWidth,this._oldScrollLeft=oldScrollLeft,this._oldScrollHeight=oldScrollHeight,this._oldScrollTop=oldScrollTop,this.scrollWidth=scrollWidth,this.scrollLeft=scrollLeft,this.scrollHeight=scrollHeight,this.scrollTop=scrollTop,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!(this.scrollWidthChanged||this.scrollLeftChanged||this.scrollHeightChanged||this.scrollTopChanged)}merge(other){return 2!==other.kind?this:new ScrollChangedEvent(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,other.scrollWidth,other.scrollLeft,other.scrollHeight,other.scrollTop)}}exports.ScrollChangedEvent=ScrollChangedEvent;exports.ViewZonesChangedEvent=class ViewZonesChangedEvent{constructor(){this.kind=3}isNoOp(){return!1}merge(other){return this}};exports.HiddenAreasChangedEvent=class HiddenAreasChangedEvent{constructor(){this.kind=4}isNoOp(){return!1}merge(other){return this}};class CursorStateChangedEvent{constructor(oldSelections,selections,oldModelVersionId,modelVersionId,source,reason,reachedMaxCursorCount){this.kind=6,this.oldSelections=oldSelections,this.selections=selections,this.oldModelVersionId=oldModelVersionId,this.modelVersionId=modelVersionId,this.source=source,this.reason=reason,this.reachedMaxCursorCount=reachedMaxCursorCount}static _selectionsAreEqual(a,b){if(!a&&!b)return!0;if(!a||!b)return!1;const aLen=a.length;if(aLen!==b.length)return!1;for(let i=0;i<aLen;i++)if(!a[i].equalsSelection(b[i]))return!1;return!0}isNoOp(){return CursorStateChangedEvent._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}merge(other){return 6!==other.kind?this:new CursorStateChangedEvent(this.oldSelections,other.selections,this.oldModelVersionId,other.modelVersionId,other.source,other.reason,this.reachedMaxCursorCount||other.reachedMaxCursorCount)}}exports.CursorStateChangedEvent=CursorStateChangedEvent;exports.ReadOnlyEditAttemptEvent=class ReadOnlyEditAttemptEvent{constructor(){this.kind=5}isNoOp(){return!1}merge(other){return this}}})),define(__m[457],__M([1,0,4,2,140,451,71,190]),(function(require,exports,event_1,lifecycle_1,scrollable_1,linesLayout_1,viewModel_1,viewModelEventDispatcher_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewLayout=void 0;class EditorScrollDimensions{constructor(width,contentWidth,height,contentHeight){(width|=0)<0&&(width=0),(contentWidth|=0)<0&&(contentWidth=0),(height|=0)<0&&(height=0),(contentHeight|=0)<0&&(contentHeight=0),this.width=width,this.contentWidth=contentWidth,this.scrollWidth=Math.max(width,contentWidth),this.height=height,this.contentHeight=contentHeight,this.scrollHeight=Math.max(height,contentHeight)}equals(other){return this.width===other.width&&this.contentWidth===other.contentWidth&&this.height===other.height&&this.contentHeight===other.contentHeight}}class EditorScrollable extends lifecycle_1.Disposable{constructor(smoothScrollDuration,scheduleAtNextAnimationFrame){super(),this._onDidContentSizeChange=this._register(new event_1.Emitter),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new EditorScrollDimensions(0,0,0,0),this._scrollable=this._register(new scrollable_1.Scrollable({forceIntegerValues:!0,smoothScrollDuration,scheduleAtNextAnimationFrame})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(smoothScrollDuration){this._scrollable.setSmoothScrollDuration(smoothScrollDuration)}validateScrollPosition(scrollPosition){return this._scrollable.validateScrollPosition(scrollPosition)}getScrollDimensions(){return this._dimensions}setScrollDimensions(dimensions){if(this._dimensions.equals(dimensions))return;const oldDimensions=this._dimensions;this._dimensions=dimensions,this._scrollable.setScrollDimensions({width:dimensions.width,scrollWidth:dimensions.scrollWidth,height:dimensions.height,scrollHeight:dimensions.scrollHeight},!0);const contentWidthChanged=oldDimensions.contentWidth!==dimensions.contentWidth,contentHeightChanged=oldDimensions.contentHeight!==dimensions.contentHeight;(contentWidthChanged||contentHeightChanged)&&this._onDidContentSizeChange.fire(new viewModelEventDispatcher_1.ContentSizeChangedEvent(oldDimensions.contentWidth,oldDimensions.contentHeight,dimensions.contentWidth,dimensions.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(update){this._scrollable.setScrollPositionNow(update)}setScrollPositionSmooth(update){this._scrollable.setScrollPositionSmooth(update)}}class ViewLayout extends lifecycle_1.Disposable{constructor(configuration,lineCount,scheduleAtNextAnimationFrame){super(),this._configuration=configuration;const options=this._configuration.options,layoutInfo=options.get(131),padding=options.get(75);this._linesLayout=new linesLayout_1.LinesLayout(lineCount,options.get(59),padding.top,padding.bottom),this._scrollable=this._register(new EditorScrollable(0,scheduleAtNextAnimationFrame)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new EditorScrollDimensions(layoutInfo.contentWidth,0,layoutInfo.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(103)?125:0)}onConfigurationChanged(e){const options=this._configuration.options;if(e.hasChanged(59)&&this._linesLayout.setLineHeight(options.get(59)),e.hasChanged(75)){const padding=options.get(75);this._linesLayout.setPadding(padding.top,padding.bottom)}if(e.hasChanged(131)){const layoutInfo=options.get(131),width=layoutInfo.contentWidth,height=layoutInfo.height,scrollDimensions=this._scrollable.getScrollDimensions(),contentWidth=scrollDimensions.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(width,scrollDimensions.contentWidth,height,this._getContentHeight(width,height,contentWidth)))}else this._updateHeight();e.hasChanged(103)&&this._configureSmoothScrollDuration()}onFlushed(lineCount){this._linesLayout.onFlushed(lineCount)}onLinesDeleted(fromLineNumber,toLineNumber){this._linesLayout.onLinesDeleted(fromLineNumber,toLineNumber)}onLinesInserted(fromLineNumber,toLineNumber){this._linesLayout.onLinesInserted(fromLineNumber,toLineNumber)}_getHorizontalScrollbarHeight(width,scrollWidth){const scrollbar=this._configuration.options.get(92);return 2===scrollbar.horizontal||width>=scrollWidth?0:scrollbar.horizontalScrollbarSize}_getContentHeight(width,height,contentWidth){const options=this._configuration.options;let result=this._linesLayout.getLinesTotalHeight();return options.get(94)?result+=Math.max(0,height-options.get(59)-options.get(75).bottom):result+=this._getHorizontalScrollbarHeight(width,contentWidth),result}_updateHeight(){const scrollDimensions=this._scrollable.getScrollDimensions(),width=scrollDimensions.width,height=scrollDimensions.height,contentWidth=scrollDimensions.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(width,scrollDimensions.contentWidth,height,this._getContentHeight(width,height,contentWidth)))}getCurrentViewport(){const scrollDimensions=this._scrollable.getScrollDimensions(),currentScrollPosition=this._scrollable.getCurrentScrollPosition();return new viewModel_1.Viewport(currentScrollPosition.scrollTop,currentScrollPosition.scrollLeft,scrollDimensions.width,scrollDimensions.height)}getFutureViewport(){const scrollDimensions=this._scrollable.getScrollDimensions(),currentScrollPosition=this._scrollable.getFutureScrollPosition();return new viewModel_1.Viewport(currentScrollPosition.scrollTop,currentScrollPosition.scrollLeft,scrollDimensions.width,scrollDimensions.height)}_computeContentWidth(maxLineWidth){const options=this._configuration.options,wrappingInfo=options.get(132),fontInfo=options.get(44);if(wrappingInfo.isViewportWrapping){const layoutInfo=options.get(131),minimap=options.get(65);return maxLineWidth>layoutInfo.contentWidth+fontInfo.typicalHalfwidthCharacterWidth&&minimap.enabled&&"right"===minimap.side?maxLineWidth+layoutInfo.verticalScrollbarWidth:maxLineWidth}{const extraHorizontalSpace=options.get(93)*fontInfo.typicalHalfwidthCharacterWidth,whitespaceMinWidth=this._linesLayout.getWhitespaceMinWidth();return Math.max(maxLineWidth+extraHorizontalSpace,whitespaceMinWidth)}}setMaxLineWidth(maxLineWidth){const scrollDimensions=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new EditorScrollDimensions(scrollDimensions.width,this._computeContentWidth(maxLineWidth),scrollDimensions.height,scrollDimensions.contentHeight)),this._updateHeight()}saveState(){const currentScrollPosition=this._scrollable.getFutureScrollPosition(),scrollTop=currentScrollPosition.scrollTop,firstLineNumberInViewport=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(scrollTop);return{scrollTop,scrollTopWithoutViewZones:scrollTop-this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(firstLineNumberInViewport),scrollLeft:currentScrollPosition.scrollLeft}}changeWhitespace(callback){const hadAChange=this._linesLayout.changeWhitespace(callback);return hadAChange&&this.onHeightMaybeChanged(),hadAChange}getVerticalOffsetForLineNumber(lineNumber){return this._linesLayout.getVerticalOffsetForLineNumber(lineNumber)}isAfterLines(verticalOffset){return this._linesLayout.isAfterLines(verticalOffset)}isInTopPadding(verticalOffset){return this._linesLayout.isInTopPadding(verticalOffset)}isInBottomPadding(verticalOffset){return this._linesLayout.isInBottomPadding(verticalOffset)}getLineNumberAtVerticalOffset(verticalOffset){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(verticalOffset)}getWhitespaceAtVerticalOffset(verticalOffset){return this._linesLayout.getWhitespaceAtVerticalOffset(verticalOffset)}getLinesViewportData(){const visibleBox=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(visibleBox.top,visibleBox.top+visibleBox.height)}getLinesViewportDataAtScrollTop(scrollTop){const scrollDimensions=this._scrollable.getScrollDimensions();return scrollTop+scrollDimensions.height>scrollDimensions.scrollHeight&&(scrollTop=scrollDimensions.scrollHeight-scrollDimensions.height),scrollTop<0&&(scrollTop=0),this._linesLayout.getLinesViewportData(scrollTop,scrollTop+scrollDimensions.height)}getWhitespaceViewportData(){const visibleBox=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(visibleBox.top,visibleBox.top+visibleBox.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(scrollPosition){return this._scrollable.validateScrollPosition(scrollPosition)}setScrollPosition(position,type){1===type?this._scrollable.setScrollPositionNow(position):this._scrollable.setScrollPositionSmooth(position)}deltaScrollNow(deltaScrollLeft,deltaScrollTop){const currentScrollPosition=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:currentScrollPosition.scrollLeft+deltaScrollLeft,scrollTop:currentScrollPosition.scrollTop+deltaScrollTop})}}exports.ViewLayout=ViewLayout})),define(__m[458],__M([1,0,3,22]),(function(require,exports,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveCaretCommand=void 0;exports.MoveCaretCommand=class MoveCaretCommand{constructor(selection,isMovingLeft){this._selection=selection,this._isMovingLeft=isMovingLeft}getEditOperations(model,builder){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const lineNumber=this._selection.startLineNumber,startColumn=this._selection.startColumn,endColumn=this._selection.endColumn;if((!this._isMovingLeft||1!==startColumn)&&(this._isMovingLeft||endColumn!==model.getLineMaxColumn(lineNumber)))if(this._isMovingLeft){const rangeBefore=new range_1.Range(lineNumber,startColumn-1,lineNumber,startColumn),charBefore=model.getValueInRange(rangeBefore);builder.addEditOperation(rangeBefore,null),builder.addEditOperation(new range_1.Range(lineNumber,endColumn,lineNumber,endColumn),charBefore)}else{const rangeAfter=new range_1.Range(lineNumber,endColumn,lineNumber,endColumn+1),charAfter=model.getValueInRange(rangeAfter);builder.addEditOperation(rangeAfter,null),builder.addEditOperation(new range_1.Range(lineNumber,startColumn,lineNumber,startColumn),charAfter)}}computeCursorState(model,helper){return this._isMovingLeft?new selection_1.Selection(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new selection_1.Selection(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}})),define(__m[155],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeActionCommandArgs=exports.filtersAction=exports.mayIncludeActionsOfKind=exports.CodeActionKind=void 0;class CodeActionKind{constructor(value){this.value=value}equals(other){return this.value===other.value}contains(other){return this.equals(other)||""===this.value||other.value.startsWith(this.value+CodeActionKind.sep)}intersects(other){return this.contains(other)||other.contains(this)}append(part){return new CodeActionKind(this.value+CodeActionKind.sep+part)}}function excludesAction(providedKind,exclude,include){return!!exclude.contains(providedKind)&&(!include||!exclude.contains(include))}exports.CodeActionKind=CodeActionKind,CodeActionKind.sep=".",CodeActionKind.None=new CodeActionKind("@@none@@"),CodeActionKind.Empty=new CodeActionKind(""),CodeActionKind.QuickFix=new CodeActionKind("quickfix"),CodeActionKind.Refactor=new CodeActionKind("refactor"),CodeActionKind.Source=new CodeActionKind("source"),CodeActionKind.SourceOrganizeImports=CodeActionKind.Source.append("organizeImports"),CodeActionKind.SourceFixAll=CodeActionKind.Source.append("fixAll"),exports.mayIncludeActionsOfKind=function mayIncludeActionsOfKind(filter,providedKind){return!(filter.include&&!filter.include.intersects(providedKind))&&((!filter.excludes||!filter.excludes.some((exclude=>excludesAction(providedKind,exclude,filter.include))))&&!(!filter.includeSourceActions&&CodeActionKind.Source.contains(providedKind)))},exports.filtersAction=function filtersAction(filter,action){const actionKind=action.kind?new CodeActionKind(action.kind):void 0;return!!(!filter.include||actionKind&&filter.include.contains(actionKind))&&(!(filter.excludes&&actionKind&&filter.excludes.some((exclude=>excludesAction(actionKind,exclude,filter.include))))&&(!(!filter.includeSourceActions&&actionKind&&CodeActionKind.Source.contains(actionKind))&&!(filter.onlyIncludePreferredActions&&!action.isPreferred)))};class CodeActionCommandArgs{constructor(kind,apply,preferred){this.kind=kind,this.apply=apply,this.preferred=preferred}static fromUser(arg,defaults){return arg&&"object"==typeof arg?new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg,defaults.kind),CodeActionCommandArgs.getApplyFromUser(arg,defaults.apply),CodeActionCommandArgs.getPreferredUser(arg)):new CodeActionCommandArgs(defaults.kind,defaults.apply,!1)}static getApplyFromUser(arg,defaultAutoApply){switch("string"==typeof arg.apply?arg.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return defaultAutoApply}}static getKindFromUser(arg,defaultKind){return"string"==typeof arg.kind?new CodeActionKind(arg.kind):defaultKind}static getPreferredUser(arg){return"boolean"==typeof arg.preferred&&arg.preferred}}exports.CodeActionCommandArgs=CodeActionCommandArgs})),define(__m[459],__M([1,0,4]),(function(require,exports,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorPickerModel=void 0;exports.ColorPickerModel=class ColorPickerModel{constructor(color,availableColorPresentations,presentationIndex){this.presentationIndex=presentationIndex,this._onColorFlushed=new event_1.Emitter,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new event_1.Emitter,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new event_1.Emitter,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=color,this._color=color,this._colorPresentations=availableColorPresentations}get color(){return this._color}set color(color){this._color.equals(color)||(this._color=color,this._onDidChangeColor.fire(color))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(colorPresentations){this._colorPresentations=colorPresentations,this.presentationIndex>colorPresentations.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(color,originalText){for(let i=0;i<this.colorPresentations.length;i++)if(originalText.toLowerCase()===this.colorPresentations[i].label){this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation);break}}flushColor(){this._onColorFlushed.fire(this._color)}}})),define(__m[257],__M([1,0,63,11,3,22]),(function(require,exports,editOperation_1,position_1,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlockCommentCommand=void 0;class BlockCommentCommand{constructor(selection,insertSpace,languageConfigurationService){this.languageConfigurationService=languageConfigurationService,this._selection=selection,this._insertSpace=insertSpace,this._usedEndToken=null}static _haystackHasNeedleAtOffset(haystack,needle,offset){if(offset<0)return!1;const needleLength=needle.length;if(offset+needleLength>haystack.length)return!1;for(let i=0;i<needleLength;i++){const codeA=haystack.charCodeAt(offset+i),codeB=needle.charCodeAt(i);if(codeA!==codeB&&!(codeA>=65&&codeA<=90&&codeA+32===codeB||codeB>=65&&codeB<=90&&codeB+32===codeA))return!1}return!0}_createOperationsForBlockComment(selection,startToken,endToken,insertSpace,model,builder){const startLineNumber=selection.startLineNumber,startColumn=selection.startColumn,endLineNumber=selection.endLineNumber,endColumn=selection.endColumn,startLineText=model.getLineContent(startLineNumber),endLineText=model.getLineContent(endLineNumber);let ops,startTokenIndex=startLineText.lastIndexOf(startToken,startColumn-1+startToken.length),endTokenIndex=endLineText.indexOf(endToken,endColumn-1-endToken.length);if(-1!==startTokenIndex&&-1!==endTokenIndex)if(startLineNumber===endLineNumber){startLineText.substring(startTokenIndex+startToken.length,endTokenIndex).indexOf(endToken)>=0&&(startTokenIndex=-1,endTokenIndex=-1)}else{const startLineAfterStartToken=startLineText.substring(startTokenIndex+startToken.length),endLineBeforeEndToken=endLineText.substring(0,endTokenIndex);(startLineAfterStartToken.indexOf(endToken)>=0||endLineBeforeEndToken.indexOf(endToken)>=0)&&(startTokenIndex=-1,endTokenIndex=-1)}-1!==startTokenIndex&&-1!==endTokenIndex?(insertSpace&&startTokenIndex+startToken.length<startLineText.length&&32===startLineText.charCodeAt(startTokenIndex+startToken.length)&&(startToken+=" "),insertSpace&&endTokenIndex>0&&32===endLineText.charCodeAt(endTokenIndex-1)&&(endToken=" "+endToken,endTokenIndex-=1),ops=BlockCommentCommand._createRemoveBlockCommentOperations(new range_1.Range(startLineNumber,startTokenIndex+startToken.length+1,endLineNumber,endTokenIndex+1),startToken,endToken)):(ops=BlockCommentCommand._createAddBlockCommentOperations(selection,startToken,endToken,this._insertSpace),this._usedEndToken=1===ops.length?endToken:null);for(const op of ops)builder.addTrackedEditOperation(op.range,op.text)}static _createRemoveBlockCommentOperations(r,startToken,endToken){let res=[];return range_1.Range.isEmpty(r)?res.push(editOperation_1.EditOperation.delete(new range_1.Range(r.startLineNumber,r.startColumn-startToken.length,r.endLineNumber,r.endColumn+endToken.length))):(res.push(editOperation_1.EditOperation.delete(new range_1.Range(r.startLineNumber,r.startColumn-startToken.length,r.startLineNumber,r.startColumn))),res.push(editOperation_1.EditOperation.delete(new range_1.Range(r.endLineNumber,r.endColumn,r.endLineNumber,r.endColumn+endToken.length)))),res}static _createAddBlockCommentOperations(r,startToken,endToken,insertSpace){let res=[];return range_1.Range.isEmpty(r)?res.push(editOperation_1.EditOperation.replace(new range_1.Range(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn),startToken+"  "+endToken)):(res.push(editOperation_1.EditOperation.insert(new position_1.Position(r.startLineNumber,r.startColumn),startToken+(insertSpace?" ":""))),res.push(editOperation_1.EditOperation.insert(new position_1.Position(r.endLineNumber,r.endColumn),(insertSpace?" ":"")+endToken))),res}getEditOperations(model,builder){const startLineNumber=this._selection.startLineNumber,startColumn=this._selection.startColumn;model.tokenizeIfCheap(startLineNumber);const languageId=model.getLanguageIdAtPosition(startLineNumber,startColumn),config=this.languageConfigurationService.getLanguageConfiguration(languageId).comments;config&&config.blockCommentStartToken&&config.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,config.blockCommentStartToken,config.blockCommentEndToken,this._insertSpace,model,builder)}computeCursorState(model,helper){const inverseEditOperations=helper.getInverseEditOperations();if(2===inverseEditOperations.length){const startTokenEditOperation=inverseEditOperations[0],endTokenEditOperation=inverseEditOperations[1];return new selection_1.Selection(startTokenEditOperation.range.endLineNumber,startTokenEditOperation.range.endColumn,endTokenEditOperation.range.startLineNumber,endTokenEditOperation.range.startColumn)}{const srcRange=inverseEditOperations[0].range,deltaColumn=this._usedEndToken?-this._usedEndToken.length-1:0;return new selection_1.Selection(srcRange.endLineNumber,srcRange.endColumn+deltaColumn,srcRange.endLineNumber,srcRange.endColumn+deltaColumn)}}}exports.BlockCommentCommand=BlockCommentCommand})),define(__m[460],__M([1,0,3,22]),(function(require,exports,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DragAndDropCommand=void 0;exports.DragAndDropCommand=class DragAndDropCommand{constructor(selection,targetPosition,copy){this.selection=selection,this.targetPosition=targetPosition,this.copy=copy,this.targetSelection=null}getEditOperations(model,builder){let text=model.getValueInRange(this.selection);this.copy||builder.addEditOperation(this.selection,null),builder.addEditOperation(new range_1.Range(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),text),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new selection_1.Selection(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new selection_1.Selection(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new selection_1.Selection(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new selection_1.Selection(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new selection_1.Selection(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(model,helper){return this.targetSelection}}})),define(__m[461],__M([1,0,3]),(function(require,exports,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaceAllCommand=void 0;exports.ReplaceAllCommand=class ReplaceAllCommand{constructor(editorSelection,ranges,replaceStrings){this._editorSelection=editorSelection,this._ranges=ranges,this._replaceStrings=replaceStrings,this._trackedEditorSelectionId=null}getEditOperations(model,builder){if(this._ranges.length>0){let ops=[];for(let i=0;i<this._ranges.length;i++)ops.push({range:this._ranges[i],text:this._replaceStrings[i]});ops.sort(((o1,o2)=>range_1.Range.compareRangesUsingStarts(o1.range,o2.range)));let resultOps=[],previousOp=ops[0];for(let i=1;i<ops.length;i++)previousOp.range.endLineNumber===ops[i].range.startLineNumber&&previousOp.range.endColumn===ops[i].range.startColumn?(previousOp.range=previousOp.range.plusRange(ops[i].range),previousOp.text=previousOp.text+ops[i].text):(resultOps.push(previousOp),previousOp=ops[i]);resultOps.push(previousOp);for(const op of resultOps)builder.addEditOperation(op.range,op.text)}this._trackedEditorSelectionId=builder.trackSelection(this._editorSelection)}computeCursorState(model,helper){return helper.getTrackedSelection(this._trackedEditorSelectionId)}}})),define(__m[462],__M([1,0,323]),(function(require,exports,search_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseReplaceString=exports.ReplacePiece=exports.ReplacePattern=void 0;class StaticValueReplacePattern{constructor(staticValue){this.staticValue=staticValue,this.kind=0}}class DynamicPiecesReplacePattern{constructor(pieces){this.pieces=pieces,this.kind=1}}class ReplacePattern{constructor(pieces){pieces&&0!==pieces.length?1===pieces.length&&null!==pieces[0].staticValue?this._state=new StaticValueReplacePattern(pieces[0].staticValue):this._state=new DynamicPiecesReplacePattern(pieces):this._state=new StaticValueReplacePattern("")}static fromStaticValue(value){return new ReplacePattern([ReplacePiece.staticValue(value)])}get hasReplacementPatterns(){return 1===this._state.kind}buildReplaceString(matches,preserveCase){if(0===this._state.kind)return preserveCase?(0,search_1.buildReplaceStringWithCasePreserved)(matches,this._state.staticValue):this._state.staticValue;let result="";for(let i=0,len=this._state.pieces.length;i<len;i++){let piece=this._state.pieces[i];if(null!==piece.staticValue){result+=piece.staticValue;continue}let match=ReplacePattern._substitute(piece.matchIndex,matches);if(null!==piece.caseOps&&piece.caseOps.length>0){let repl=[],lenOps=piece.caseOps.length,opIdx=0;for(let idx=0,len=match.length;idx<len;idx++){if(opIdx>=lenOps){repl.push(match.slice(idx));break}switch(piece.caseOps[opIdx]){case"U":repl.push(match[idx].toUpperCase());break;case"u":repl.push(match[idx].toUpperCase()),opIdx++;break;case"L":repl.push(match[idx].toLowerCase());break;case"l":repl.push(match[idx].toLowerCase()),opIdx++;break;default:repl.push(match[idx])}}match=repl.join("")}result+=match}return result}static _substitute(matchIndex,matches){if(null===matches)return"";if(0===matchIndex)return matches[0];let remainder="";for(;matchIndex>0;){if(matchIndex<matches.length){return(matches[matchIndex]||"")+remainder}remainder=String(matchIndex%10)+remainder,matchIndex=Math.floor(matchIndex/10)}return"$"+remainder}}exports.ReplacePattern=ReplacePattern;class ReplacePiece{constructor(staticValue,matchIndex,caseOps){this.staticValue=staticValue,this.matchIndex=matchIndex,caseOps&&0!==caseOps.length?this.caseOps=caseOps.slice(0):this.caseOps=null}static staticValue(value){return new ReplacePiece(value,-1,null)}static caseOps(index,caseOps){return new ReplacePiece(null,index,caseOps)}}exports.ReplacePiece=ReplacePiece;class ReplacePieceBuilder{constructor(source){this._source=source,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(toCharIndex){this._emitStatic(this._source.substring(this._lastCharIndex,toCharIndex)),this._lastCharIndex=toCharIndex}emitStatic(value,toCharIndex){this._emitStatic(value),this._lastCharIndex=toCharIndex}_emitStatic(value){0!==value.length&&(this._currentStaticPiece+=value)}emitMatchIndex(index,toCharIndex,caseOps){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=ReplacePiece.caseOps(index,caseOps),this._lastCharIndex=toCharIndex}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new ReplacePattern(this._result)}}exports.parseReplaceString=function parseReplaceString(replaceString){if(!replaceString||0===replaceString.length)return new ReplacePattern(null);let caseOps=[],result=new ReplacePieceBuilder(replaceString);for(let i=0,len=replaceString.length;i<len;i++){let chCode=replaceString.charCodeAt(i);if(92!==chCode){if(36===chCode){if(i++,i>=len)break;let nextChCode=replaceString.charCodeAt(i);if(36===nextChCode){result.emitUnchanged(i-1),result.emitStatic("$",i+1);continue}if(48===nextChCode||38===nextChCode){result.emitUnchanged(i-1),result.emitMatchIndex(0,i+1,caseOps),caseOps.length=0;continue}if(49<=nextChCode&&nextChCode<=57){let matchIndex=nextChCode-48;if(i+1<len){let nextNextChCode=replaceString.charCodeAt(i+1);if(48<=nextNextChCode&&nextNextChCode<=57){i++,matchIndex=10*matchIndex+(nextNextChCode-48),result.emitUnchanged(i-2),result.emitMatchIndex(matchIndex,i+1,caseOps),caseOps.length=0;continue}}result.emitUnchanged(i-1),result.emitMatchIndex(matchIndex,i+1,caseOps),caseOps.length=0;continue}}}else{if(i++,i>=len)break;let nextChCode=replaceString.charCodeAt(i);switch(nextChCode){case 92:result.emitUnchanged(i-1),result.emitStatic("\\",i+1);break;case 110:result.emitUnchanged(i-1),result.emitStatic("\n",i+1);break;case 116:result.emitUnchanged(i-1),result.emitStatic("\t",i+1);break;case 117:case 85:case 108:case 76:result.emitUnchanged(i-1),result.emitStatic("",i+1),caseOps.push(String.fromCharCode(nextChCode))}}}return result.finalize()}})),define(__m[191],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FoldingRegion=exports.FoldingRegions=exports.MAX_LINE_NUMBER=exports.MAX_FOLDING_REGIONS=void 0,exports.MAX_FOLDING_REGIONS=65535,exports.MAX_LINE_NUMBER=16777215;exports.FoldingRegions=class FoldingRegions{constructor(startIndexes,endIndexes,types){if(startIndexes.length!==endIndexes.length||startIndexes.length>exports.MAX_FOLDING_REGIONS)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=startIndexes,this._endIndexes=endIndexes,this._collapseStates=new Uint32Array(Math.ceil(startIndexes.length/32)),this._types=types,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let parentIndexes=[],isInsideLast=(startLineNumber,endLineNumber)=>{let index=parentIndexes[parentIndexes.length-1];return this.getStartLineNumber(index)<=startLineNumber&&this.getEndLineNumber(index)>=endLineNumber};for(let i=0,len=this._startIndexes.length;i<len;i++){let startLineNumber=this._startIndexes[i],endLineNumber=this._endIndexes[i];if(startLineNumber>exports.MAX_LINE_NUMBER||endLineNumber>exports.MAX_LINE_NUMBER)throw new Error("startLineNumber or endLineNumber must not exceed "+exports.MAX_LINE_NUMBER);for(;parentIndexes.length>0&&!isInsideLast(startLineNumber,endLineNumber);)parentIndexes.pop();let parentIndex=parentIndexes.length>0?parentIndexes[parentIndexes.length-1]:-1;parentIndexes.push(i),this._startIndexes[i]=startLineNumber+((255&parentIndex)<<24),this._endIndexes[i]=endLineNumber+((65280&parentIndex)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(index){return this._startIndexes[index]&exports.MAX_LINE_NUMBER}getEndLineNumber(index){return this._endIndexes[index]&exports.MAX_LINE_NUMBER}getType(index){return this._types?this._types[index]:void 0}hasTypes(){return!!this._types}isCollapsed(index){let arrayIndex=index/32|0,bit=index%32;return 0!=(this._collapseStates[arrayIndex]&1<<bit)}setCollapsed(index,newState){let arrayIndex=index/32|0,bit=index%32,value=this._collapseStates[arrayIndex];this._collapseStates[arrayIndex]=newState?value|1<<bit:value&~(1<<bit)}setCollapsedAllOfType(type,newState){let hasChanged=!1;if(this._types)for(let i=0;i<this._types.length;i++)this._types[i]===type&&(this.setCollapsed(i,newState),hasChanged=!0);return hasChanged}toRegion(index){return new FoldingRegion(this,index)}getParentIndex(index){this.ensureParentIndices();let parent=((4278190080&this._startIndexes[index])>>>24)+((4278190080&this._endIndexes[index])>>>16);return parent===exports.MAX_FOLDING_REGIONS?-1:parent}contains(index,line){return this.getStartLineNumber(index)<=line&&this.getEndLineNumber(index)>=line}findIndex(line){let low=0,high=this._startIndexes.length;if(0===high)return-1;for(;low<high;){let mid=Math.floor((low+high)/2);line<this.getStartLineNumber(mid)?high=mid:low=mid+1}return low-1}findRange(line){let index=this.findIndex(line);if(index>=0){if(this.getEndLineNumber(index)>=line)return index;for(index=this.getParentIndex(index);-1!==index;){if(this.contains(index,line))return index;index=this.getParentIndex(index)}}return-1}toString(){let res=[];for(let i=0;i<this.length;i++)res[i]=`[${this.isCollapsed(i)?"+":"-"}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;return res.join(", ")}};class FoldingRegion{constructor(ranges,index){this.ranges=ranges,this.index=index}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(range){return range.startLineNumber<=this.startLineNumber&&range.endLineNumber>=this.endLineNumber}containsLine(lineNumber){return this.startLineNumber<=lineNumber&&lineNumber<=this.endLineNumber}}exports.FoldingRegion=FoldingRegion})),define(__m[463],__M([1,0,4,191]),(function(require,exports,event_1,foldingRanges_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNextFoldLine=exports.getPreviousFoldLine=exports.getParentFoldLine=exports.setCollapseStateForType=exports.setCollapseStateForMatchingLines=exports.setCollapseStateForRest=exports.setCollapseStateAtLevel=exports.setCollapseStateUp=exports.setCollapseStateLevelsUp=exports.setCollapseStateLevelsDown=exports.toggleCollapseState=exports.FoldingModel=void 0;exports.FoldingModel=class FoldingModel{constructor(textModel,decorationProvider){this._updateEventEmitter=new event_1.Emitter,this.onDidChange=this._updateEventEmitter.event,this._textModel=textModel,this._decorationProvider=decorationProvider,this._regions=new foldingRanges_1.FoldingRegions(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(toggledRegions){if(!toggledRegions.length)return;toggledRegions=toggledRegions.sort(((r1,r2)=>r1.regionIndex-r2.regionIndex));const processed={};this._decorationProvider.changeDecorations((accessor=>{let k=0,dirtyRegionEndLine=-1,lastHiddenLine=-1;const updateDecorationsUntil=index=>{for(;k<index;){const endLineNumber=this._regions.getEndLineNumber(k),isCollapsed=this._regions.isCollapsed(k);endLineNumber<=dirtyRegionEndLine&&accessor.changeDecorationOptions(this._editorDecorationIds[k],this._decorationProvider.getDecorationOption(isCollapsed,endLineNumber<=lastHiddenLine)),isCollapsed&&endLineNumber>lastHiddenLine&&(lastHiddenLine=endLineNumber),k++}};for(let region of toggledRegions){let index=region.regionIndex,editorDecorationId=this._editorDecorationIds[index];if(editorDecorationId&&!processed[editorDecorationId]){processed[editorDecorationId]=!0,updateDecorationsUntil(index);let newCollapseState=!this._regions.isCollapsed(index);this._regions.setCollapsed(index,newCollapseState),dirtyRegionEndLine=Math.max(dirtyRegionEndLine,this._regions.getEndLineNumber(index))}}updateDecorationsUntil(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:toggledRegions})}update(newRegions,blockedLineNumers=[]){let newEditorDecorations=[],lastHiddenLine=-1,initRange=(index,isCollapsed)=>{const startLineNumber=newRegions.getStartLineNumber(index),endLineNumber=newRegions.getEndLineNumber(index);isCollapsed||(isCollapsed=newRegions.isCollapsed(index)),isCollapsed&&((startLineNumber,endLineNumber)=>{for(let blockedLineNumber of blockedLineNumers)if(startLineNumber<blockedLineNumber&&blockedLineNumber<=endLineNumber)return!0;return!1})(startLineNumber,endLineNumber)&&(isCollapsed=!1),newRegions.setCollapsed(index,isCollapsed);const maxColumn=this._textModel.getLineMaxColumn(startLineNumber),decorationRange={startLineNumber,startColumn:Math.max(maxColumn-1,1),endLineNumber:startLineNumber,endColumn:maxColumn};newEditorDecorations.push({range:decorationRange,options:this._decorationProvider.getDecorationOption(isCollapsed,endLineNumber<=lastHiddenLine)}),isCollapsed&&endLineNumber>lastHiddenLine&&(lastHiddenLine=endLineNumber)},i=0,nextCollapsed=()=>{for(;i<this._regions.length;){let isCollapsed=this._regions.isCollapsed(i);if(i++,isCollapsed)return i-1}return-1},k=0,collapsedIndex=nextCollapsed();for(;-1!==collapsedIndex&&k<newRegions.length;){let decRange=this._textModel.getDecorationRange(this._editorDecorationIds[collapsedIndex]);if(decRange){let collapsedStartLineNumber=decRange.startLineNumber;if(decRange.startColumn===Math.max(decRange.endColumn-1,1)&&this._textModel.getLineMaxColumn(collapsedStartLineNumber)===decRange.endColumn)for(;k<newRegions.length;){let startLineNumber=newRegions.getStartLineNumber(k);if(!(collapsedStartLineNumber>=startLineNumber))break;initRange(k,collapsedStartLineNumber===startLineNumber),k++}}collapsedIndex=nextCollapsed()}for(;k<newRegions.length;)initRange(k,!1),k++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,newEditorDecorations),this._regions=newRegions,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let collapsedRanges=[];for(let i=0;i<this._regions.length;i++)if(this._regions.isCollapsed(i)){let range=this._textModel.getDecorationRange(this._editorDecorationIds[i]);if(range){let startLineNumber=range.startLineNumber,endLineNumber=range.endLineNumber+this._regions.getEndLineNumber(i)-this._regions.getStartLineNumber(i);collapsedRanges.push({startLineNumber,endLineNumber})}}if(collapsedRanges.length>0)return collapsedRanges}applyMemento(state){if(!Array.isArray(state))return;let toToogle=[];for(let range of state){let region=this.getRegionAtLine(range.startLineNumber);region&&!region.isCollapsed&&toToogle.push(region)}this.toggleCollapseState(toToogle)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(lineNumber,filter){let result=[];if(this._regions){let index=this._regions.findRange(lineNumber),level=1;for(;index>=0;){let current=this._regions.toRegion(index);filter&&!filter(current,level)||result.push(current),level++,index=current.parentIndex}}return result}getRegionAtLine(lineNumber){if(this._regions){let index=this._regions.findRange(lineNumber);if(index>=0)return this._regions.toRegion(index)}return null}getRegionsInside(region,filter){let result=[],index=region?region.regionIndex+1:0,endLineNumber=region?region.endLineNumber:Number.MAX_VALUE;if(filter&&2===filter.length){const levelStack=[];for(let i=index,len=this._regions.length;i<len;i++){let current=this._regions.toRegion(i);if(!(this._regions.getStartLineNumber(i)<endLineNumber))break;for(;levelStack.length>0&&!current.containedBy(levelStack[levelStack.length-1]);)levelStack.pop();levelStack.push(current),filter(current,levelStack.length)&&result.push(current)}}else for(let i=index,len=this._regions.length;i<len;i++){let current=this._regions.toRegion(i);if(!(this._regions.getStartLineNumber(i)<endLineNumber))break;filter&&!filter(current)||result.push(current)}return result}},exports.toggleCollapseState=function toggleCollapseState(foldingModel,levels,lineNumbers){let toToggle=[];for(let lineNumber of lineNumbers){let region=foldingModel.getRegionAtLine(lineNumber);if(region){const doCollapse=!region.isCollapsed;if(toToggle.push(region),levels>1){let regionsInside=foldingModel.getRegionsInside(region,((r,level)=>r.isCollapsed!==doCollapse&&level<levels));toToggle.push(...regionsInside)}}}foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateLevelsDown=function setCollapseStateLevelsDown(foldingModel,doCollapse,levels=Number.MAX_VALUE,lineNumbers){let toToggle=[];if(lineNumbers&&lineNumbers.length>0)for(let lineNumber of lineNumbers){let region=foldingModel.getRegionAtLine(lineNumber);if(region&&(region.isCollapsed!==doCollapse&&toToggle.push(region),levels>1)){let regionsInside=foldingModel.getRegionsInside(region,((r,level)=>r.isCollapsed!==doCollapse&&level<levels));toToggle.push(...regionsInside)}}else{let regionsInside=foldingModel.getRegionsInside(null,((r,level)=>r.isCollapsed!==doCollapse&&level<levels));toToggle.push(...regionsInside)}foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateLevelsUp=function setCollapseStateLevelsUp(foldingModel,doCollapse,levels,lineNumbers){let toToggle=[];for(let lineNumber of lineNumbers){let regions=foldingModel.getAllRegionsAtLine(lineNumber,((region,level)=>region.isCollapsed!==doCollapse&&level<=levels));toToggle.push(...regions)}foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateUp=function setCollapseStateUp(foldingModel,doCollapse,lineNumbers){let toToggle=[];for(let lineNumber of lineNumbers){let regions=foldingModel.getAllRegionsAtLine(lineNumber,(region=>region.isCollapsed!==doCollapse));regions.length>0&&toToggle.push(regions[0])}foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateAtLevel=function setCollapseStateAtLevel(foldingModel,foldLevel,doCollapse,blockedLineNumbers){let toToggle=foldingModel.getRegionsInside(null,((region,level)=>level===foldLevel&&region.isCollapsed!==doCollapse&&!blockedLineNumbers.some((line=>region.containsLine(line)))));foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateForRest=function setCollapseStateForRest(foldingModel,doCollapse,blockedLineNumbers){let filteredRegions=[];for(let lineNumber of blockedLineNumbers){const regions=foldingModel.getAllRegionsAtLine(lineNumber,void 0);regions.length>0&&filteredRegions.push(regions[0])}let toToggle=foldingModel.getRegionsInside(null,(region=>filteredRegions.every((filteredRegion=>!filteredRegion.containedBy(region)&&!region.containedBy(filteredRegion)))&&region.isCollapsed!==doCollapse));foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateForMatchingLines=function setCollapseStateForMatchingLines(foldingModel,regExp,doCollapse){let editorModel=foldingModel.textModel,regions=foldingModel.regions,toToggle=[];for(let i=regions.length-1;i>=0;i--)if(doCollapse!==regions.isCollapsed(i)){let startLineNumber=regions.getStartLineNumber(i);regExp.test(editorModel.getLineContent(startLineNumber))&&toToggle.push(regions.toRegion(i))}foldingModel.toggleCollapseState(toToggle)},exports.setCollapseStateForType=function setCollapseStateForType(foldingModel,type,doCollapse){let regions=foldingModel.regions,toToggle=[];for(let i=regions.length-1;i>=0;i--)doCollapse!==regions.isCollapsed(i)&&type===regions.getType(i)&&toToggle.push(regions.toRegion(i));foldingModel.toggleCollapseState(toToggle)},exports.getParentFoldLine=function getParentFoldLine(lineNumber,foldingModel){let startLineNumber=null,foldingRegion=foldingModel.getRegionAtLine(lineNumber);if(null!==foldingRegion&&(startLineNumber=foldingRegion.startLineNumber,lineNumber===startLineNumber)){let parentFoldingIdx=foldingRegion.parentIndex;startLineNumber=-1!==parentFoldingIdx?foldingModel.regions.getStartLineNumber(parentFoldingIdx):null}return startLineNumber},exports.getPreviousFoldLine=function getPreviousFoldLine(lineNumber,foldingModel){let foldingRegion=foldingModel.getRegionAtLine(lineNumber);if(null!==foldingRegion&&foldingRegion.startLineNumber===lineNumber){if(lineNumber!==foldingRegion.startLineNumber)return foldingRegion.startLineNumber;{let expectedParentIndex=foldingRegion.parentIndex,minLineNumber=0;for(-1!==expectedParentIndex&&(minLineNumber=foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex));null!==foldingRegion;){if(!(foldingRegion.regionIndex>0))return null;if(foldingRegion=foldingModel.regions.toRegion(foldingRegion.regionIndex-1),foldingRegion.startLineNumber<=minLineNumber)return null;if(foldingRegion.parentIndex===expectedParentIndex)return foldingRegion.startLineNumber}}}else if(foldingModel.regions.length>0)for(foldingRegion=foldingModel.regions.toRegion(foldingModel.regions.length-1);null!==foldingRegion;){if(foldingRegion.startLineNumber<lineNumber)return foldingRegion.startLineNumber;foldingRegion=foldingRegion.regionIndex>0?foldingModel.regions.toRegion(foldingRegion.regionIndex-1):null}return null},exports.getNextFoldLine=function getNextFoldLine(lineNumber,foldingModel){let foldingRegion=foldingModel.getRegionAtLine(lineNumber);if(null!==foldingRegion&&foldingRegion.startLineNumber===lineNumber){let expectedParentIndex=foldingRegion.parentIndex,maxLineNumber=0;if(-1!==expectedParentIndex)maxLineNumber=foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);else{if(0===foldingModel.regions.length)return null;maxLineNumber=foldingModel.regions.getEndLineNumber(foldingModel.regions.length-1)}for(;null!==foldingRegion;){if(!(foldingRegion.regionIndex<foldingModel.regions.length))return null;if(foldingRegion=foldingModel.regions.toRegion(foldingRegion.regionIndex+1),foldingRegion.startLineNumber>=maxLineNumber)return null;if(foldingRegion.parentIndex===expectedParentIndex)return foldingRegion.startLineNumber}}else if(foldingModel.regions.length>0)for(foldingRegion=foldingModel.regions.toRegion(0);null!==foldingRegion;){if(foldingRegion.startLineNumber>lineNumber)return foldingRegion.startLineNumber;foldingRegion=foldingRegion.regionIndex<foldingModel.regions.length?foldingModel.regions.toRegion(foldingRegion.regionIndex+1):null}return null}})),define(__m[464],__M([1,0,18,4,3,119]),(function(require,exports,arrays_1,event_1,range_1,eolCounter_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HiddenRangeModel=void 0;function findRange(ranges,line){let i=(0,arrays_1.findFirstInSorted)(ranges,(r=>line<r.startLineNumber))-1;return i>=0&&ranges[i].endLineNumber>=line?ranges[i]:null}exports.HiddenRangeModel=class HiddenRangeModel{constructor(model){this._updateEventEmitter=new event_1.Emitter,this._hasLineChanges=!1,this._foldingModel=model,this._foldingModelListener=model.onDidChange((_=>this.updateHiddenRanges())),this._hiddenRanges=[],model.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some((change=>change.range.endLineNumber!==change.range.startLineNumber||0!==(0,eolCounter_1.countEOL)(change.text)[0])))}updateHiddenRanges(){let updateHiddenAreas=!1,newHiddenAreas=[],i=0,k=0,lastCollapsedStart=Number.MAX_VALUE,lastCollapsedEnd=-1,ranges=this._foldingModel.regions;for(;i<ranges.length;i++){if(!ranges.isCollapsed(i))continue;let startLineNumber=ranges.getStartLineNumber(i)+1,endLineNumber=ranges.getEndLineNumber(i);lastCollapsedStart<=startLineNumber&&endLineNumber<=lastCollapsedEnd||(!updateHiddenAreas&&k<this._hiddenRanges.length&&this._hiddenRanges[k].startLineNumber===startLineNumber&&this._hiddenRanges[k].endLineNumber===endLineNumber?(newHiddenAreas.push(this._hiddenRanges[k]),k++):(updateHiddenAreas=!0,newHiddenAreas.push(new range_1.Range(startLineNumber,1,endLineNumber,1))),lastCollapsedStart=startLineNumber,lastCollapsedEnd=endLineNumber)}(this._hasLineChanges||updateHiddenAreas||k<this._hiddenRanges.length)&&this.applyHiddenRanges(newHiddenAreas)}applyMemento(state){if(!Array.isArray(state)||0===state.length)return!1;let hiddenRanges=[];for(let r of state){if(!r.startLineNumber||!r.endLineNumber)return!1;hiddenRanges.push(new range_1.Range(r.startLineNumber+1,1,r.endLineNumber,1))}return this.applyHiddenRanges(hiddenRanges),!0}getMemento(){return this._hiddenRanges.map((r=>({startLineNumber:r.startLineNumber-1,endLineNumber:r.endLineNumber})))}applyHiddenRanges(newHiddenAreas){this._hiddenRanges=newHiddenAreas,this._hasLineChanges=!1,this._updateEventEmitter.fire(newHiddenAreas)}hasRanges(){return this._hiddenRanges.length>0}isHidden(line){return null!==findRange(this._hiddenRanges,line)}adjustSelections(selections){let hasChanges=!1,editorModel=this._foldingModel.textModel,lastRange=null,adjustLine=line=>(lastRange&&function isInside(line,range){return line>=range.startLineNumber&&line<=range.endLineNumber}(line,lastRange)||(lastRange=findRange(this._hiddenRanges,line)),lastRange?lastRange.startLineNumber-1:null);for(let i=0,len=selections.length;i<len;i++){let selection=selections[i],adjustedStartLine=adjustLine(selection.startLineNumber);adjustedStartLine&&(selection=selection.setStartPosition(adjustedStartLine,editorModel.getLineMaxColumn(adjustedStartLine)),hasChanges=!0);let adjustedEndLine=adjustLine(selection.endLineNumber);adjustedEndLine&&(selection=selection.setEndPosition(adjustedEndLine,editorModel.getLineMaxColumn(adjustedEndLine)),hasChanges=!0),selections[i]=selection}return hasChanges}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}})),define(__m[465],__M([1,0,184,191]),(function(require,exports,utils_1,foldingRanges_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeRanges=exports.RangesCollector=exports.IndentRangeProvider=exports.ID_INDENT_PROVIDER=void 0;exports.ID_INDENT_PROVIDER="indent";exports.IndentRangeProvider=class IndentRangeProvider{constructor(editorModel,languageConfigurationService,maxFoldingRegions){this.editorModel=editorModel,this.languageConfigurationService=languageConfigurationService,this.maxFoldingRegions=maxFoldingRegions,this.id=exports.ID_INDENT_PROVIDER}dispose(){}compute(cancelationToken,notifyTooManyRegions){let foldingRules=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,offSide=foldingRules&&!!foldingRules.offSide,markers=foldingRules&&foldingRules.markers;return Promise.resolve(computeRanges(this.editorModel,offSide,markers,this.maxFoldingRegions,notifyTooManyRegions))}};class RangesCollector{constructor(foldingRangesLimit,_notifyTooManyRegions){this._notifyTooManyRegions=_notifyTooManyRegions,this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=foldingRangesLimit}insertFirst(startLineNumber,endLineNumber,indent){if(startLineNumber>foldingRanges_1.MAX_LINE_NUMBER||endLineNumber>foldingRanges_1.MAX_LINE_NUMBER)return;let index=this._length;this._startIndexes[index]=startLineNumber,this._endIndexes[index]=endLineNumber,this._length++,indent<1e3&&(this._indentOccurrences[indent]=(this._indentOccurrences[indent]||0)+1)}toIndentRanges(model){if(this._length<=this._foldingRangesLimit){let startIndexes=new Uint32Array(this._length),endIndexes=new Uint32Array(this._length);for(let i=this._length-1,k=0;i>=0;i--,k++)startIndexes[k]=this._startIndexes[i],endIndexes[k]=this._endIndexes[i];return new foldingRanges_1.FoldingRegions(startIndexes,endIndexes)}{this._notifyTooManyRegions&&this._notifyTooManyRegions(this._foldingRangesLimit);let entries=0,maxIndent=this._indentOccurrences.length;for(let i=0;i<this._indentOccurrences.length;i++){let n=this._indentOccurrences[i];if(n){if(n+entries>this._foldingRangesLimit){maxIndent=i;break}entries+=n}}const tabSize=model.getOptions().tabSize;let startIndexes=new Uint32Array(this._foldingRangesLimit),endIndexes=new Uint32Array(this._foldingRangesLimit);for(let i=this._length-1,k=0;i>=0;i--){let startIndex=this._startIndexes[i],lineContent=model.getLineContent(startIndex),indent=(0,utils_1.computeIndentLevel)(lineContent,tabSize);(indent<maxIndent||indent===maxIndent&&entries++<this._foldingRangesLimit)&&(startIndexes[k]=startIndex,endIndexes[k]=this._endIndexes[i],k++)}return new foldingRanges_1.FoldingRegions(startIndexes,endIndexes)}}}function computeRanges(model,offSide,markers,foldingRangesLimit,notifyTooManyRegions){const tabSize=model.getOptions().tabSize;let pattern,result=new RangesCollector(foldingRangesLimit=null!=foldingRangesLimit?foldingRangesLimit:5e3,notifyTooManyRegions);markers&&(pattern=new RegExp(`(${markers.start.source})|(?:${markers.end.source})`));let previousRegions=[],line=model.getLineCount()+1;previousRegions.push({indent:-1,endAbove:line,line});for(let line=model.getLineCount();line>0;line--){let m,lineContent=model.getLineContent(line),indent=(0,utils_1.computeIndentLevel)(lineContent,tabSize),previous=previousRegions[previousRegions.length-1];if(-1!==indent){if(pattern&&(m=lineContent.match(pattern))){if(!m[1]){previousRegions.push({indent:-2,endAbove:line,line});continue}{let i=previousRegions.length-1;for(;i>0&&-2!==previousRegions[i].indent;)i--;if(i>0){previousRegions.length=i+1,previous=previousRegions[i],result.insertFirst(line,previous.line,indent),previous.line=line,previous.indent=indent,previous.endAbove=line;continue}}}if(previous.indent>indent){do{previousRegions.pop(),previous=previousRegions[previousRegions.length-1]}while(previous.indent>indent);let endLineNumber=previous.endAbove-1;endLineNumber-line>=1&&result.insertFirst(line,endLineNumber,indent)}previous.indent===indent?previous.endAbove=line:previousRegions.push({indent,endAbove:line,line})}else offSide&&(previous.endAbove=line)}return result.toIndentRanges(model)}exports.RangesCollector=RangesCollector,exports.computeRanges=computeRanges})),define(__m[258],__M([1,0,13,2,191]),(function(require,exports,errors_1,lifecycle_1,foldingRanges_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sanitizeRanges=exports.RangesCollector=exports.SyntaxRangeProvider=exports.ID_SYNTAX_PROVIDER=void 0;const foldingContext={};exports.ID_SYNTAX_PROVIDER="syntax";exports.SyntaxRangeProvider=class SyntaxRangeProvider{constructor(editorModel,providers,handleFoldingRangesChange,limit){this.editorModel=editorModel,this.providers=providers,this.limit=limit,this.id=exports.ID_SYNTAX_PROVIDER;for(const provider of providers)"function"==typeof provider.onDidChange&&(this.disposables||(this.disposables=new lifecycle_1.DisposableStore),this.disposables.add(provider.onDidChange(handleFoldingRangesChange)))}compute(cancellationToken,notifyTooManyRegions){return function collectSyntaxRanges(providers,model,cancellationToken){let rangeData=null,promises=providers.map(((provider,i)=>Promise.resolve(provider.provideFoldingRanges(model,foldingContext,cancellationToken)).then((ranges=>{if(!cancellationToken.isCancellationRequested&&Array.isArray(ranges)){Array.isArray(rangeData)||(rangeData=[]);let nLines=model.getLineCount();for(let r of ranges)r.start>0&&r.end>r.start&&r.end<=nLines&&rangeData.push({start:r.start,end:r.end,rank:i,kind:r.kind})}}),errors_1.onUnexpectedExternalError)));return Promise.all(promises).then((_=>rangeData))}(this.providers,this.editorModel,cancellationToken).then((ranges=>{if(ranges){return sanitizeRanges(ranges,this.limit,notifyTooManyRegions)}return null}))}dispose(){var _a;null===(_a=this.disposables)||void 0===_a||_a.dispose()}};class RangesCollector{constructor(foldingRangesLimit,_notifyTooManyRegions){this._notifyTooManyRegions=_notifyTooManyRegions,this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=foldingRangesLimit}add(startLineNumber,endLineNumber,type,nestingLevel){if(startLineNumber>foldingRanges_1.MAX_LINE_NUMBER||endLineNumber>foldingRanges_1.MAX_LINE_NUMBER)return;let index=this._length;this._startIndexes[index]=startLineNumber,this._endIndexes[index]=endLineNumber,this._nestingLevels[index]=nestingLevel,this._types[index]=type,this._length++,nestingLevel<30&&(this._nestingLevelCounts[nestingLevel]=(this._nestingLevelCounts[nestingLevel]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let startIndexes=new Uint32Array(this._length),endIndexes=new Uint32Array(this._length);for(let i=0;i<this._length;i++)startIndexes[i]=this._startIndexes[i],endIndexes[i]=this._endIndexes[i];return new foldingRanges_1.FoldingRegions(startIndexes,endIndexes,this._types)}{this._notifyTooManyRegions&&this._notifyTooManyRegions(this._foldingRangesLimit);let entries=0,maxLevel=this._nestingLevelCounts.length;for(let i=0;i<this._nestingLevelCounts.length;i++){let n=this._nestingLevelCounts[i];if(n){if(n+entries>this._foldingRangesLimit){maxLevel=i;break}entries+=n}}let startIndexes=new Uint32Array(this._foldingRangesLimit),endIndexes=new Uint32Array(this._foldingRangesLimit),types=[];for(let i=0,k=0;i<this._length;i++){let level=this._nestingLevels[i];(level<maxLevel||level===maxLevel&&entries++<this._foldingRangesLimit)&&(startIndexes[k]=this._startIndexes[i],endIndexes[k]=this._endIndexes[i],types[k]=this._types[i],k++)}return new foldingRanges_1.FoldingRegions(startIndexes,endIndexes,types)}}}function sanitizeRanges(rangeData,limit,notifyTooManyRegions){let top,sorted=rangeData.sort(((d1,d2)=>{let diff=d1.start-d2.start;return 0===diff&&(diff=d1.rank-d2.rank),diff})),collector=new RangesCollector(limit,notifyTooManyRegions),previous=[];for(let entry of sorted)if(top){if(entry.start>top.start)if(entry.end<=top.end)previous.push(top),top=entry,collector.add(entry.start,entry.end,entry.kind&&entry.kind.value,previous.length);else{if(entry.start>top.end){do{top=previous.pop()}while(top&&entry.start>top.end);top&&previous.push(top),top=entry}collector.add(entry.start,entry.end,entry.kind&&entry.kind.value,previous.length)}}else top=entry,collector.add(entry.start,entry.end,entry.kind&&entry.kind.value,previous.length);return collector.toIndentRanges()}exports.RangesCollector=RangesCollector,exports.sanitizeRanges=sanitizeRanges})),define(__m[466],__M([1,0,258]),(function(require,exports,syntaxRangeProvider_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InitializingRangeProvider=exports.ID_INIT_PROVIDER=void 0,exports.ID_INIT_PROVIDER="init";exports.InitializingRangeProvider=class InitializingRangeProvider{constructor(editorModel,initialRanges,onTimeout,timeoutTime){if(this.editorModel=editorModel,this.id=exports.ID_INIT_PROVIDER,initialRanges.length){let toDecorationRange=range=>({range:{startLineNumber:range.startLineNumber,startColumn:0,endLineNumber:range.endLineNumber,endColumn:editorModel.getLineLength(range.endLineNumber)},options:{description:"folding-initializing-range-provider",stickiness:1}});this.decorationIds=editorModel.deltaDecorations([],initialRanges.map(toDecorationRange)),this.timeout=setTimeout(onTimeout,timeoutTime)}}dispose(){this.decorationIds&&(this.editorModel.deltaDecorations(this.decorationIds,[]),this.decorationIds=void 0),"number"==typeof this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(cancelationToken){let foldingRangeData=[];if(this.decorationIds)for(let id of this.decorationIds){let range=this.editorModel.getDecorationRange(id);range&&foldingRangeData.push({start:range.startLineNumber,end:range.endLineNumber,rank:1})}return Promise.resolve((0,syntaxRangeProvider_1.sanitizeRanges)(foldingRangeData,Number.MAX_VALUE))}}})),define(__m[259],__M([1,0,63,3]),(function(require,exports,editOperation_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FormattingEdit=void 0;class FormattingEdit{static _handleEolEdits(editor,edits){let newEol,singleEdits=[];for(let edit of edits)"number"==typeof edit.eol&&(newEol=edit.eol),edit.range&&"string"==typeof edit.text&&singleEdits.push(edit);return"number"==typeof newEol&&editor.hasModel()&&editor.getModel().pushEOL(newEol),singleEdits}static _isFullModelReplaceEdit(editor,edit){if(!editor.hasModel())return!1;const model=editor.getModel(),editRange=model.validateRange(edit.range);return model.getFullModelRange().equalsRange(editRange)}static execute(editor,_edits,addUndoStops){addUndoStops&&editor.pushUndoStop();const edits=FormattingEdit._handleEolEdits(editor,_edits);1===edits.length&&FormattingEdit._isFullModelReplaceEdit(editor,edits[0])?editor.executeEdits("formatEditsCommand",edits.map((edit=>editOperation_1.EditOperation.replace(range_1.Range.lift(edit.range),edit.text)))):editor.executeEdits("formatEditsCommand",edits.map((edit=>editOperation_1.EditOperation.replaceMove(range_1.Range.lift(edit.range),edit.text)))),addUndoStops&&editor.pushUndoStop()}}exports.FormattingEdit=FormattingEdit})),define(__m[192],__M([1,0,4,2,16]),(function(require,exports,event_1,lifecycle_1,platform){"use strict";function hasModifier(e,modifier){return!!e[modifier]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClickLinkGesture=exports.ClickLinkOptions=exports.ClickLinkKeyboardEvent=exports.ClickLinkMouseEvent=void 0;class ClickLinkMouseEvent{constructor(source,opts){this.target=source.target,this.hasTriggerModifier=hasModifier(source.event,opts.triggerModifier),this.hasSideBySideModifier=hasModifier(source.event,opts.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=source.event.detail<=1}}exports.ClickLinkMouseEvent=ClickLinkMouseEvent;class ClickLinkKeyboardEvent{constructor(source,opts){this.keyCodeIsTriggerKey=source.keyCode===opts.triggerKey,this.keyCodeIsSideBySideKey=source.keyCode===opts.triggerSideBySideKey,this.hasTriggerModifier=hasModifier(source,opts.triggerModifier)}}exports.ClickLinkKeyboardEvent=ClickLinkKeyboardEvent;class ClickLinkOptions{constructor(triggerKey,triggerModifier,triggerSideBySideKey,triggerSideBySideModifier){this.triggerKey=triggerKey,this.triggerModifier=triggerModifier,this.triggerSideBySideKey=triggerSideBySideKey,this.triggerSideBySideModifier=triggerSideBySideModifier}equals(other){return this.triggerKey===other.triggerKey&&this.triggerModifier===other.triggerModifier&&this.triggerSideBySideKey===other.triggerSideBySideKey&&this.triggerSideBySideModifier===other.triggerSideBySideModifier}}function createOptions(multiCursorModifier){return"altKey"===multiCursorModifier?platform.isMacintosh?new ClickLinkOptions(57,"metaKey",6,"altKey"):new ClickLinkOptions(5,"ctrlKey",6,"altKey"):platform.isMacintosh?new ClickLinkOptions(6,"altKey",57,"metaKey"):new ClickLinkOptions(6,"altKey",5,"ctrlKey")}exports.ClickLinkOptions=ClickLinkOptions;class ClickLinkGesture extends lifecycle_1.Disposable{constructor(editor){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new event_1.Emitter),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new event_1.Emitter),this.onExecute=this._onExecute.event,this._onCancel=this._register(new event_1.Emitter),this.onCancel=this._onCancel.event,this._editor=editor,this._opts=createOptions(this._editor.getOption(70)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((e=>{if(e.hasChanged(70)){const newOpts=createOptions(this._editor.getOption(70));if(this._opts.equals(newOpts))return;this._opts=newOpts,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((e=>this._onEditorMouseMove(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onKeyDown((e=>this._onEditorKeyDown(new ClickLinkKeyboardEvent(e,this._opts))))),this._register(this._editor.onKeyUp((e=>this._onEditorKeyUp(new ClickLinkKeyboardEvent(e,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((e=>this._onDidChangeCursorSelection(e)))),this._register(this._editor.onDidChangeModel((e=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(mouseEvent){this._lastMouseMoveEvent=mouseEvent,this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent,null])}_onEditorMouseDown(mouseEvent){this._hasTriggerKeyOnMouseDown=mouseEvent.hasTriggerModifier,this._lineNumberOnMouseDown=mouseEvent.target.position?mouseEvent.target.position.lineNumber:0}_onEditorMouseUp(mouseEvent){const currentLineNumber=mouseEvent.target.position?mouseEvent.target.position.lineNumber:0;this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===currentLineNumber&&this._onExecute.fire(mouseEvent)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}exports.ClickLinkGesture=ClickLinkGesture}));__asyncValues=this&&this.__asyncValues||function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,m=o[Symbol.asyncIterator];return m?m.call(o):(o="function"==typeof __values?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){(function settle(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)})(resolve,reject,(v=o[n](v)).done,v.value)}))}}};define(__m[260],__M([1,0,10,13,4,2]),(function(require,exports,async_1,errors_1,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HoverOperation=exports.HoverResult=void 0;class HoverResult{constructor(value,isComplete,hasLoadingMessage){this.value=value,this.isComplete=isComplete,this.hasLoadingMessage=hasLoadingMessage}}exports.HoverResult=HoverResult;class HoverOperation extends lifecycle_1.Disposable{constructor(_editor,_computer){super(),this._editor=_editor,this._computer=_computer,this._onResult=this._register(new event_1.Emitter),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new async_1.RunOnceScheduler((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new async_1.RunOnceScheduler((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new async_1.RunOnceScheduler((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(53).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(state,fireResult=!0){this._state=state,fireResult&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=(0,async_1.createCancelableAsyncIterable)((token=>this._computer.computeAsync(token))),(()=>{__awaiter(this,void 0,void 0,(function*(){var e_1,_a;try{try{for(var _c,_b=__asyncValues(this._asyncIterable);!(_c=yield _b.next()).done;){const item=_c.value;item&&(this._result.push(item),this._fireResult())}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&(yield _a.call(_b))}finally{if(e_1)throw e_1.error}}this._asyncIterableDone=!0,3!==this._state&&4!==this._state||this._setState(0)}catch(e){(0,errors_1.onUnexpectedError)(e)}}))})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){3===this._state&&this._setState(4)}_fireResult(){if(1===this._state||2===this._state)return;const isComplete=0===this._state,hasLoadingMessage=4===this._state;this._onResult.fire(new HoverResult(this._result.slice(0),isComplete,hasLoadingMessage))}start(mode){if(0===mode)0===this._state&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}exports.HoverOperation=HoverOperation})),define(__m[86],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HoverParticipantRegistry=exports.HoverForeignElementAnchor=exports.HoverRangeAnchor=void 0;exports.HoverRangeAnchor=class HoverRangeAnchor{constructor(priority,range){this.priority=priority,this.range=range,this.type=1}equals(other){return 1===other.type&&this.range.equalsRange(other.range)}canAdoptVisibleHover(lastAnchor,showAtPosition){return 1===lastAnchor.type&&showAtPosition.lineNumber===this.range.startLineNumber}};exports.HoverForeignElementAnchor=class HoverForeignElementAnchor{constructor(priority,owner,range){this.priority=priority,this.owner=owner,this.range=range,this.type=2}equals(other){return 2===other.type&&this.owner===other.owner}canAdoptVisibleHover(lastAnchor,showAtPosition){return 2===lastAnchor.type&&this.owner===lastAnchor.owner}},exports.HoverParticipantRegistry=new class HoverParticipantRegistry{constructor(){this._participants=[]}register(ctor){this._participants.push(ctor)}getAll(){return this._participants}}})),define(__m[467],__M([1,0,22]),(function(require,exports,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InPlaceReplaceCommand=void 0;exports.InPlaceReplaceCommand=class InPlaceReplaceCommand{constructor(editRange,originalSelection,text){this._editRange=editRange,this._originalSelection=originalSelection,this._text=text}getEditOperations(model,builder){builder.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(model,helper){const srcRange=helper.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new selection_1.Selection(srcRange.endLineNumber,Math.min(this._originalSelection.positionColumn,srcRange.endColumn),srcRange.endLineNumber,Math.min(this._originalSelection.positionColumn,srcRange.endColumn)):new selection_1.Selection(srcRange.endLineNumber,srcRange.endColumn-this._text.length,srcRange.endLineNumber,srcRange.endColumn)}}})),define(__m[261],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateIndent=exports.getSpaceCnt=void 0,exports.getSpaceCnt=function getSpaceCnt(str,tabSize){let spacesCnt=0;for(let i=0;i<str.length;i++)"\t"===str.charAt(i)?spacesCnt+=tabSize:spacesCnt++;return spacesCnt},exports.generateIndent=function generateIndent(spacesCnt,tabSize,insertSpaces){spacesCnt=spacesCnt<0?0:spacesCnt;let result="";if(!insertSpaces){let tabsCnt=Math.floor(spacesCnt/tabSize);spacesCnt%=tabSize;for(let i=0;i<tabsCnt;i++)result+="\t"}for(let i=0;i<spacesCnt;i++)result+=" ";return result}})),define(__m[262],__M([1,0,13,2,11,3,45,25]),(function(require,exports,errors_1,lifecycle_1,position_1,range_1,network_1,uri_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asCommandLink=exports.InlayHintsFragments=exports.InlayHintItem=exports.InlayHintAnchor=void 0;class InlayHintAnchor{constructor(range,direction){this.range=range,this.direction=direction}}exports.InlayHintAnchor=InlayHintAnchor;class InlayHintItem{constructor(hint,anchor,provider){this.hint=hint,this.anchor=anchor,this.provider=provider,this._isResolved=!1}with(delta){const result=new InlayHintItem(this.hint,delta.anchor,this.provider);return result._isResolved=this._isResolved,result._currentResolve=this._currentResolve,result}resolve(token){return __awaiter(this,void 0,void 0,(function*(){if("function"==typeof this.provider.resolveInlayHint){if(this._currentResolve){if(yield this._currentResolve,token.isCancellationRequested)return;return this.resolve(token)}this._isResolved||(this._currentResolve=this._doResolve(token).finally((()=>this._currentResolve=void 0))),yield this._currentResolve}}))}_doResolve(token){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){try{const newHint=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,token));this.hint.tooltip=null!==(_a=null==newHint?void 0:newHint.tooltip)&&void 0!==_a?_a:this.hint.tooltip,this.hint.label=null!==(_b=null==newHint?void 0:newHint.label)&&void 0!==_b?_b:this.hint.label,this._isResolved=!0}catch(err){(0,errors_1.onUnexpectedExternalError)(err),this._isResolved=!1}}))}}exports.InlayHintItem=InlayHintItem;class InlayHintsFragments{constructor(ranges,data,model){this._disposables=new lifecycle_1.DisposableStore,this.ranges=ranges,this.provider=new Set;const items=[];for(const[list,provider]of data){this._disposables.add(list),this.provider.add(provider);for(const hint of list.hints){let position=model.validatePosition(hint.position),direction="before";const wordRange=InlayHintsFragments._getRangeAtPosition(model,position);let range;wordRange.getStartPosition().isBefore(position)?(range=range_1.Range.fromPositions(wordRange.getStartPosition(),position),direction="after"):(range=range_1.Range.fromPositions(position,wordRange.getEndPosition()),direction="before"),items.push(new InlayHintItem(hint,new InlayHintAnchor(range,direction),provider))}}this.items=items.sort(((a,b)=>position_1.Position.compare(a.hint.position,b.hint.position)))}static create(registry,model,ranges,token){return __awaiter(this,void 0,void 0,(function*(){const data=[],promises=registry.ordered(model).reverse().map((provider=>ranges.map((range=>__awaiter(this,void 0,void 0,(function*(){try{const result=yield provider.provideInlayHints(model,range,token);(null==result?void 0:result.hints.length)&&data.push([result,provider])}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}}))))));if(yield Promise.all(promises.flat()),token.isCancellationRequested||model.isDisposed())throw new errors_1.CancellationError;return new InlayHintsFragments(ranges,data,model)}))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(model,position){const line=position.lineNumber,word=model.getWordAtPosition(position);if(word)return new range_1.Range(line,word.startColumn,line,word.endColumn);model.tokenizeIfCheap(line);const tokens=model.getLineTokens(line),offset=position.column-1,idx=tokens.findTokenIndexAtOffset(offset);let start=tokens.getStartOffset(idx),end=tokens.getEndOffset(idx);return end-start==1&&(start===offset&&idx>1?(start=tokens.getStartOffset(idx-1),end=tokens.getEndOffset(idx-1)):end===offset&&idx<tokens.getCount()-1&&(start=tokens.getStartOffset(idx+1),end=tokens.getEndOffset(idx+1))),new range_1.Range(line,start+1,line,end+1)}}exports.InlayHintsFragments=InlayHintsFragments,exports.asCommandLink=function asCommandLink(command){return uri_1.URI.from({scheme:network_1.Schemas.command,path:command.id,query:command.arguments&&encodeURIComponent(JSON.stringify(command.arguments))}).toString()}})),define(__m[263],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.inlineSuggestCommitId=void 0,exports.inlineSuggestCommitId="editor.action.inlineSuggest.commit"})),define(__m[193],__M([1,0,4,2,3]),(function(require,exports,event_1,lifecycle_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseGhostTextWidgetModel=exports.GhostTextPart=exports.GhostText=void 0;exports.GhostText=class GhostText{constructor(lineNumber,parts,additionalReservedLineCount=0){this.lineNumber=lineNumber,this.parts=parts,this.additionalReservedLineCount=additionalReservedLineCount}renderForScreenReader(lineText){if(0===this.parts.length)return"";const lastPart=this.parts[this.parts.length-1];return function applyEdits(text,edits){const transformer=new PositionOffsetTransformer(text),offsetEdits=edits.map((e=>{const range=range_1.Range.lift(e.range);return{startOffset:transformer.getOffset(range.getStartPosition()),endOffset:transformer.getOffset(range.getEndPosition()),text:e.text}}));offsetEdits.sort(((a,b)=>b.startOffset-a.startOffset));for(const edit of offsetEdits)text=text.substring(0,edit.startOffset)+edit.text+text.substring(edit.endOffset);return text}(lineText.substr(0,lastPart.column-1),this.parts.map((p=>({range:{startLineNumber:1,endLineNumber:1,startColumn:p.column,endColumn:p.column},text:p.lines.join("\n")})))).substring(this.parts[0].column-1)}};class PositionOffsetTransformer{constructor(text){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let i=0;i<text.length;i++)"\n"===text.charAt(i)&&this.lineStartOffsetByLineIdx.push(i+1)}getOffset(position){return this.lineStartOffsetByLineIdx[position.lineNumber-1]+position.column-1}}exports.GhostTextPart=class GhostTextPart{constructor(column,lines,preview){this.column=column,this.lines=lines,this.preview=preview}};class BaseGhostTextWidgetModel extends lifecycle_1.Disposable{constructor(editor){super(),this.editor=editor,this._expanded=void 0,this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this._register(editor.onDidChangeConfiguration((e=>{e.hasChanged(106)&&void 0===this._expanded&&this.onDidChangeEmitter.fire()})))}setExpanded(expanded){this._expanded=!0,this.onDidChangeEmitter.fire()}}exports.BaseGhostTextWidgetModel=BaseGhostTextWidgetModel})),define(__m[194],__M([1,0,141,8,3,193]),(function(require,exports,diff_1,strings,range_1,ghostText_1){"use strict";let lastRequest;Object.defineProperty(exports,"__esModule",{value:!0}),exports.inlineCompletionToGhostText=exports.normalizedInlineCompletionsEquals=void 0,exports.normalizedInlineCompletionsEquals=function normalizedInlineCompletionsEquals(a,b){return a===b||!(!a||!b)&&(a.range.equalsRange(b.range)&&a.text===b.text&&a.command===b.command)},exports.inlineCompletionToGhostText=function inlineCompletionToGhostText(inlineCompletion,textModel,mode,cursorPosition,previewSuffixLength=0){if(inlineCompletion.range.startLineNumber!==inlineCompletion.range.endLineNumber)return;const sourceLine=textModel.getLineContent(inlineCompletion.range.startLineNumber),sourceIndentationLength=strings.getLeadingWhitespace(sourceLine).length;if(inlineCompletion.range.startColumn-1<=sourceIndentationLength){const suggestionAddedIndentationLength=strings.getLeadingWhitespace(inlineCompletion.text).length,replacedIndentation=sourceLine.substring(inlineCompletion.range.startColumn-1,sourceIndentationLength),rangeThatDoesNotReplaceIndentation=range_1.Range.fromPositions(inlineCompletion.range.getStartPosition().delta(0,replacedIndentation.length),inlineCompletion.range.getEndPosition()),suggestionWithoutIndentationChange=inlineCompletion.text.startsWith(replacedIndentation)?inlineCompletion.text.substring(replacedIndentation.length):inlineCompletion.text.substring(suggestionAddedIndentationLength);inlineCompletion={range:rangeThatDoesNotReplaceIndentation,text:suggestionWithoutIndentationChange,command:inlineCompletion.command}}const valueToBeReplaced=textModel.getValueInRange(inlineCompletion.range),changes=function cachingDiff(originalValue,newValue){if((null==lastRequest?void 0:lastRequest.originalValue)===originalValue&&(null==lastRequest?void 0:lastRequest.newValue)===newValue)return null==lastRequest?void 0:lastRequest.changes;{const changes=function smartDiff(originalValue,newValue){if(originalValue.length>5e3||newValue.length>5e3)return;function getMaxCharCode(val){let maxCharCode=0;for(let i=0,len=val.length;i<len;i++){const charCode=val.charCodeAt(i);charCode>maxCharCode&&(maxCharCode=charCode)}return maxCharCode}const maxCharCode=Math.max(getMaxCharCode(originalValue),getMaxCharCode(newValue));function getUniqueCharCode(id){if(id<0)throw new Error("unexpected");return maxCharCode+id+1}function getElements(source){let level=0,group=0;const characters=new Int32Array(source.length);for(let i=0,len=source.length;i<len;i++){const id=100*group+level;"("===source[i]?(characters[i]=getUniqueCharCode(2*id),level++):")"===source[i]?(characters[i]=getUniqueCharCode(2*id+1),1===level&&group++,level=Math.max(level-1,0)):characters[i]=source.charCodeAt(i)}return characters}const elements1=getElements(originalValue),elements2=getElements(newValue);return new diff_1.LcsDiff({getElements:()=>elements1},{getElements:()=>elements2}).ComputeDiff(!1).changes}(originalValue,newValue);return lastRequest={originalValue,newValue,changes},changes}}(valueToBeReplaced,inlineCompletion.text);if(!changes)return;const lineNumber=inlineCompletion.range.startLineNumber,parts=new Array;if("prefix"===mode){const filteredChanges=changes.filter((c=>0===c.originalLength));if(filteredChanges.length>1||1===filteredChanges.length&&filteredChanges[0].originalStart!==valueToBeReplaced.length)return}const previewStartInCompletionText=inlineCompletion.text.length-previewSuffixLength;for(const c of changes){const insertColumn=inlineCompletion.range.startColumn+c.originalStart+c.originalLength;if("subwordSmart"===mode&&cursorPosition&&cursorPosition.lineNumber===inlineCompletion.range.startLineNumber&&insertColumn<cursorPosition.column)return;if(c.originalLength>0)return;if(0===c.modifiedLength)continue;const modifiedEnd=c.modifiedStart+c.modifiedLength,nonPreviewTextEnd=Math.max(c.modifiedStart,Math.min(modifiedEnd,previewStartInCompletionText)),nonPreviewText=inlineCompletion.text.substring(c.modifiedStart,nonPreviewTextEnd),italicText=inlineCompletion.text.substring(nonPreviewTextEnd,Math.max(c.modifiedStart,modifiedEnd));if(nonPreviewText.length>0){const lines=strings.splitLines(nonPreviewText);parts.push(new ghostText_1.GhostTextPart(insertColumn,lines,!1))}if(italicText.length>0){const lines=strings.splitLines(italicText);parts.push(new ghostText_1.GhostTextPart(insertColumn,lines,!0))}}return new ghostText_1.GhostText(lineNumber,parts,0)}})),define(__m[468],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDisposableRef=void 0,exports.createDisposableRef=function createDisposableRef(object,disposable){return{object,dispose:()=>null==disposable?void 0:disposable.dispose()}}})),define(__m[469],__M([1,0,3,22]),(function(require,exports,range_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CopyLinesCommand=void 0;exports.CopyLinesCommand=class CopyLinesCommand{constructor(selection,isCopyingDown,noop){this._selection=selection,this._isCopyingDown=isCopyingDown,this._noop=noop||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(model,builder){let s=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,s.startLineNumber<s.endLineNumber&&1===s.endColumn&&(this._endLineNumberDelta=1,s=s.setEndPosition(s.endLineNumber-1,model.getLineMaxColumn(s.endLineNumber-1)));let sourceLines=[];for(let i=s.startLineNumber;i<=s.endLineNumber;i++)sourceLines.push(model.getLineContent(i));const sourceText=sourceLines.join("\n");""===sourceText&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?builder.addEditOperation(new range_1.Range(s.endLineNumber,model.getLineMaxColumn(s.endLineNumber),s.endLineNumber+1,1),s.endLineNumber===model.getLineCount()?"":"\n"):this._isCopyingDown?builder.addEditOperation(new range_1.Range(s.startLineNumber,1,s.startLineNumber,1),sourceText+"\n"):builder.addEditOperation(new range_1.Range(s.endLineNumber,model.getLineMaxColumn(s.endLineNumber),s.endLineNumber,model.getLineMaxColumn(s.endLineNumber)),"\n"+sourceText),this._selectionId=builder.trackSelection(s),this._selectionDirection=this._selection.getDirection()}computeCursorState(model,helper){let result=helper.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let startLineNumber=result.startLineNumber,startColumn=result.startColumn,endLineNumber=result.endLineNumber,endColumn=result.endColumn;0!==this._startLineNumberDelta&&(startLineNumber+=this._startLineNumberDelta,startColumn=1),0!==this._endLineNumberDelta&&(endLineNumber+=this._endLineNumberDelta,endColumn=1),result=selection_1.Selection.createWithDirection(startLineNumber,startColumn,endLineNumber,endColumn,this._selectionDirection)}return result}}})),define(__m[470],__M([1,0,63,3]),(function(require,exports,editOperation_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SortLinesCommand=void 0;class SortLinesCommand{constructor(selection,descending){this.selection=selection,this.descending=descending,this.selectionId=null}static getCollator(){return SortLinesCommand._COLLATOR||(SortLinesCommand._COLLATOR=new Intl.Collator),SortLinesCommand._COLLATOR}getEditOperations(model,builder){let op=function sortLines(model,selection,descending){let data=getSortData(model,selection,descending);if(!data)return null;return editOperation_1.EditOperation.replace(new range_1.Range(data.startLineNumber,1,data.endLineNumber,model.getLineMaxColumn(data.endLineNumber)),data.after.join("\n"))}(model,this.selection,this.descending);op&&builder.addEditOperation(op.range,op.text),this.selectionId=builder.trackSelection(this.selection)}computeCursorState(model,helper){return helper.getTrackedSelection(this.selectionId)}static canRun(model,selection,descending){if(null===model)return!1;let data=getSortData(model,selection,descending);if(!data)return!1;for(let i=0,len=data.before.length;i<len;i++)if(data.before[i]!==data.after[i])return!0;return!1}}function getSortData(model,selection,descending){let startLineNumber=selection.startLineNumber,endLineNumber=selection.endLineNumber;if(1===selection.endColumn&&endLineNumber--,startLineNumber>=endLineNumber)return null;let linesToSort=[];for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++)linesToSort.push(model.getLineContent(lineNumber));let sorted=linesToSort.slice(0);return sorted.sort(SortLinesCommand.getCollator().compare),!0===descending&&(sorted=sorted.reverse()),{startLineNumber,endLineNumber,before:linesToSort,after:sorted}}exports.SortLinesCommand=SortLinesCommand,SortLinesCommand._COLLATOR=null})),define(__m[264],__M([1,0,83,11,3]),(function(require,exports,linkedList_1,position_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketSelectionRangeProvider=void 0;class BracketSelectionRangeProvider{provideSelectionRanges(model,positions){return __awaiter(this,void 0,void 0,(function*(){const result=[];for(const position of positions){const bucket=[];result.push(bucket);const ranges=new Map;yield new Promise((resolve=>BracketSelectionRangeProvider._bracketsRightYield(resolve,0,model,position,ranges))),yield new Promise((resolve=>BracketSelectionRangeProvider._bracketsLeftYield(resolve,0,model,position,ranges,bucket)))}return result}))}static _bracketsRightYield(resolve,round,model,pos,ranges){const counts=new Map,t1=Date.now();for(;;){if(round>=BracketSelectionRangeProvider._maxRounds){resolve();break}if(!pos){resolve();break}let bracket=model.bracketPairs.findNextBracket(pos);if(!bracket){resolve();break}if(Date.now()-t1>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsRightYield(resolve,round+1,model,pos,ranges)));break}const key=bracket.close[0];if(bracket.isOpen){let val=counts.has(key)?counts.get(key):0;counts.set(key,val+1)}else{let val=counts.has(key)?counts.get(key):0;if(val-=1,counts.set(key,Math.max(0,val)),val<0){let list=ranges.get(key);list||(list=new linkedList_1.LinkedList,ranges.set(key,list)),list.push(bracket.range)}}pos=bracket.range.getEndPosition()}}static _bracketsLeftYield(resolve,round,model,pos,ranges,bucket){const counts=new Map,t1=Date.now();for(;;){if(round>=BracketSelectionRangeProvider._maxRounds&&0===ranges.size){resolve();break}if(!pos){resolve();break}let bracket=model.bracketPairs.findPrevBracket(pos);if(!bracket){resolve();break}if(Date.now()-t1>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsLeftYield(resolve,round+1,model,pos,ranges,bucket)));break}const key=bracket.close[0];if(bracket.isOpen){let val=counts.has(key)?counts.get(key):0;if(val-=1,counts.set(key,Math.max(0,val)),val<0){let list=ranges.get(key);if(list){let closing=list.shift();0===list.size&&ranges.delete(key);const innerBracket=range_1.Range.fromPositions(bracket.range.getEndPosition(),closing.getStartPosition()),outerBracket=range_1.Range.fromPositions(bracket.range.getStartPosition(),closing.getEndPosition());bucket.push({range:innerBracket}),bucket.push({range:outerBracket}),BracketSelectionRangeProvider._addBracketLeading(model,outerBracket,bucket)}}}else{let val=counts.has(key)?counts.get(key):0;counts.set(key,val+1)}pos=bracket.range.getStartPosition()}}static _addBracketLeading(model,bracket,bucket){if(bracket.startLineNumber===bracket.endLineNumber)return;const startLine=bracket.startLineNumber,column=model.getLineFirstNonWhitespaceColumn(startLine);0!==column&&column!==bracket.startColumn&&(bucket.push({range:range_1.Range.fromPositions(new position_1.Position(startLine,column),bracket.getEndPosition())}),bucket.push({range:range_1.Range.fromPositions(new position_1.Position(startLine,1),bracket.getEndPosition())}));const aboveLine=startLine-1;if(aboveLine>0){const column=model.getLineFirstNonWhitespaceColumn(aboveLine);column===bracket.startColumn&&column!==model.getLineLastNonWhitespaceColumn(aboveLine)&&(bucket.push({range:range_1.Range.fromPositions(new position_1.Position(aboveLine,column),bracket.getEndPosition())}),bucket.push({range:range_1.Range.fromPositions(new position_1.Position(aboveLine,1),bracket.getEndPosition())}))}}}exports.BracketSelectionRangeProvider=BracketSelectionRangeProvider,BracketSelectionRangeProvider._maxDuration=30,BracketSelectionRangeProvider._maxRounds=2})),define(__m[471],__M([1,0,8,3]),(function(require,exports,strings_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WordSelectionRangeProvider=void 0;exports.WordSelectionRangeProvider=class WordSelectionRangeProvider{provideSelectionRanges(model,positions){const result=[];for(const position of positions){const bucket=[];result.push(bucket),this._addInWordRanges(bucket,model,position),this._addWordRanges(bucket,model,position),this._addWhitespaceLine(bucket,model,position),bucket.push({range:model.getFullModelRange()})}return result}_addInWordRanges(bucket,model,pos){const obj=model.getWordAtPosition(pos);if(!obj)return;let{word,startColumn}=obj,offset=pos.column-startColumn,start=offset,end=offset,lastCh=0;for(;start>=0;start--){let ch=word.charCodeAt(start);if(start!==offset&&(95===ch||45===ch))break;if((0,strings_1.isLowerAsciiLetter)(ch)&&(0,strings_1.isUpperAsciiLetter)(lastCh))break;lastCh=ch}for(start+=1;end<word.length;end++){let ch=word.charCodeAt(end);if((0,strings_1.isUpperAsciiLetter)(ch)&&(0,strings_1.isLowerAsciiLetter)(lastCh))break;if(95===ch||45===ch)break;lastCh=ch}start<end&&bucket.push({range:new range_1.Range(pos.lineNumber,startColumn+start,pos.lineNumber,startColumn+end)})}_addWordRanges(bucket,model,pos){const word=model.getWordAtPosition(pos);word&&bucket.push({range:new range_1.Range(pos.lineNumber,word.startColumn,pos.lineNumber,word.endColumn)})}_addWhitespaceLine(bucket,model,pos){model.getLineLength(pos.lineNumber)>0&&0===model.getLineFirstNonWhitespaceColumn(pos.lineNumber)&&0===model.getLineLastNonWhitespaceColumn(pos.lineNumber)&&bucket.push({range:new range_1.Range(pos.lineNumber,1,pos.lineNumber,model.getLineMaxColumn(pos.lineNumber))})}}})),define(__m[127],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SnippetParser=exports.TextmateSnippet=exports.Variable=exports.FormatString=exports.Transform=exports.Choice=exports.Placeholder=exports.TransformableMarker=exports.Text=exports.Marker=exports.Scanner=void 0;class Scanner{constructor(){this.value="",this.pos=0}static isDigitCharacter(ch){return ch>=48&&ch<=57}static isVariableCharacter(ch){return 95===ch||ch>=97&&ch<=122||ch>=65&&ch<=90}text(value){this.value=value,this.pos=0}tokenText(token){return this.value.substr(token.pos,token.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let type,pos=this.pos,len=0,ch=this.value.charCodeAt(pos);if(type=Scanner._table[ch],"number"==typeof type)return this.pos+=1,{type,pos,len:1};if(Scanner.isDigitCharacter(ch)){type=8;do{len+=1,ch=this.value.charCodeAt(pos+len)}while(Scanner.isDigitCharacter(ch));return this.pos+=len,{type,pos,len}}if(Scanner.isVariableCharacter(ch)){type=9;do{ch=this.value.charCodeAt(pos+ ++len)}while(Scanner.isVariableCharacter(ch)||Scanner.isDigitCharacter(ch));return this.pos+=len,{type,pos,len}}type=10;do{len+=1,ch=this.value.charCodeAt(pos+len)}while(!isNaN(ch)&&void 0===Scanner._table[ch]&&!Scanner.isDigitCharacter(ch)&&!Scanner.isVariableCharacter(ch));return this.pos+=len,{type,pos,len}}}exports.Scanner=Scanner,Scanner._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};class Marker{constructor(){this._children=[]}appendChild(child){return child instanceof Text&&this._children[this._children.length-1]instanceof Text?this._children[this._children.length-1].value+=child.value:(child.parent=this,this._children.push(child)),this}replace(child,others){const{parent}=child,idx=parent.children.indexOf(child),newChildren=parent.children.slice(0);newChildren.splice(idx,1,...others),parent._children=newChildren,function _fixParent(children,parent){for(const child of children)child.parent=parent,_fixParent(child.children,child)}(others,parent)}get children(){return this._children}get snippet(){let candidate=this;for(;;){if(!candidate)return;if(candidate instanceof TextmateSnippet)return candidate;candidate=candidate.parent}}toString(){return this.children.reduce(((prev,cur)=>prev+cur.toString()),"")}len(){return 0}}exports.Marker=Marker;class Text extends Marker{constructor(value){super(),this.value=value}toString(){return this.value}len(){return this.value.length}clone(){return new Text(this.value)}}exports.Text=Text;class TransformableMarker extends Marker{}exports.TransformableMarker=TransformableMarker;class Placeholder extends TransformableMarker{constructor(index){super(),this.index=index}static compareByIndex(a,b){return a.index===b.index?0:a.isFinalTabstop?1:b.isFinalTabstop||a.index<b.index?-1:a.index>b.index?1:0}get isFinalTabstop(){return 0===this.index}get choice(){return 1===this._children.length&&this._children[0]instanceof Choice?this._children[0]:void 0}clone(){let ret=new Placeholder(this.index);return this.transform&&(ret.transform=this.transform.clone()),ret._children=this.children.map((child=>child.clone())),ret}}exports.Placeholder=Placeholder;class Choice extends Marker{constructor(){super(...arguments),this.options=[]}appendChild(marker){return marker instanceof Text&&(marker.parent=this,this.options.push(marker)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){let ret=new Choice;return this.options.forEach(ret.appendChild,ret),ret}}exports.Choice=Choice;class Transform extends Marker{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(value){const _this=this;let didMatch=!1,ret=value.replace(this.regexp,(function(){return didMatch=!0,_this._replace(Array.prototype.slice.call(arguments,0,-2))}));return!didMatch&&this._children.some((child=>child instanceof FormatString&&Boolean(child.elseValue)))&&(ret=this._replace([])),ret}_replace(groups){let ret="";for(const marker of this._children)if(marker instanceof FormatString){let value=groups[marker.index]||"";value=marker.resolve(value),ret+=value}else ret+=marker.toString();return ret}toString(){return""}clone(){let ret=new Transform;return ret.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),ret._children=this.children.map((child=>child.clone())),ret}}exports.Transform=Transform;class FormatString extends Marker{constructor(index,shorthandName,ifValue,elseValue){super(),this.index=index,this.shorthandName=shorthandName,this.ifValue=ifValue,this.elseValue=elseValue}resolve(value){return"upcase"===this.shorthandName?value?value.toLocaleUpperCase():"":"downcase"===this.shorthandName?value?value.toLocaleLowerCase():"":"capitalize"===this.shorthandName?value?value[0].toLocaleUpperCase()+value.substr(1):"":"pascalcase"===this.shorthandName?value?this._toPascalCase(value):"":"camelcase"===this.shorthandName?value?this._toCamelCase(value):"":Boolean(value)&&"string"==typeof this.ifValue?this.ifValue:Boolean(value)||"string"!=typeof this.elseValue?value||"":this.elseValue}_toPascalCase(value){const match=value.match(/[a-z0-9]+/gi);return match?match.map((word=>word.charAt(0).toUpperCase()+word.substr(1).toLowerCase())).join(""):value}_toCamelCase(value){const match=value.match(/[a-z0-9]+/gi);return match?match.map(((word,index)=>0===index?word.toLowerCase():word.charAt(0).toUpperCase()+word.substr(1).toLowerCase())).join(""):value}clone(){return new FormatString(this.index,this.shorthandName,this.ifValue,this.elseValue)}}exports.FormatString=FormatString;class Variable extends TransformableMarker{constructor(name){super(),this.name=name}resolve(resolver){let value=resolver.resolve(this);return this.transform&&(value=this.transform.resolve(value||"")),void 0!==value&&(this._children=[new Text(value)],!0)}clone(){const ret=new Variable(this.name);return this.transform&&(ret.transform=this.transform.clone()),ret._children=this.children.map((child=>child.clone())),ret}}function walk(marker,visitor){const stack=[...marker];for(;stack.length>0;){const marker=stack.shift();if(!visitor(marker))break;stack.unshift(...marker.children)}}exports.Variable=Variable;class TextmateSnippet extends Marker{get placeholderInfo(){if(!this._placeholders){let last,all=[];this.walk((function(candidate){return candidate instanceof Placeholder&&(all.push(candidate),last=!last||last.index<candidate.index?candidate:last),!0})),this._placeholders={all,last}}return this._placeholders}get placeholders(){const{all}=this.placeholderInfo;return all}offset(marker){let pos=0,found=!1;return this.walk((candidate=>candidate===marker?(found=!0,!1):(pos+=candidate.len(),!0))),found?pos:-1}fullLen(marker){let ret=0;return walk([marker],(marker=>(ret+=marker.len(),!0))),ret}enclosingPlaceholders(placeholder){let ret=[],{parent}=placeholder;for(;parent;)parent instanceof Placeholder&&ret.push(parent),parent=parent.parent;return ret}resolveVariables(resolver){return this.walk((candidate=>(candidate instanceof Variable&&candidate.resolve(resolver)&&(this._placeholders=void 0),!0))),this}appendChild(child){return this._placeholders=void 0,super.appendChild(child)}replace(child,others){return this._placeholders=void 0,super.replace(child,others)}clone(){let ret=new TextmateSnippet;return this._children=this.children.map((child=>child.clone())),ret}walk(visitor){walk(this.children,visitor)}}exports.TextmateSnippet=TextmateSnippet;exports.SnippetParser=class SnippetParser{constructor(){this._scanner=new Scanner,this._token={type:14,pos:0,len:0}}static escape(value){return value.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(template){return/\${?CLIPBOARD/.test(template)}parse(value,insertFinalTabstop,enforceFinalTabstop){this._scanner.text(value),this._token=this._scanner.next();const snippet=new TextmateSnippet;for(;this._parse(snippet););const placeholderDefaultValues=new Map,incompletePlaceholders=[];let placeholderCount=0;snippet.walk((marker=>(marker instanceof Placeholder&&(placeholderCount+=1,marker.isFinalTabstop?placeholderDefaultValues.set(0,void 0):!placeholderDefaultValues.has(marker.index)&&marker.children.length>0?placeholderDefaultValues.set(marker.index,marker.children):incompletePlaceholders.push(marker)),!0)));for(const placeholder of incompletePlaceholders){const defaultValues=placeholderDefaultValues.get(placeholder.index);if(defaultValues){const clone=new Placeholder(placeholder.index);clone.transform=placeholder.transform;for(const child of defaultValues)clone.appendChild(child.clone());snippet.replace(placeholder,[clone])}}return enforceFinalTabstop||(enforceFinalTabstop=placeholderCount>0&&insertFinalTabstop),!placeholderDefaultValues.has(0)&&enforceFinalTabstop&&snippet.appendChild(new Placeholder(0)),snippet}_accept(type,value){if(void 0===type||this._token.type===type){let ret=!value||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),ret}return!1}_backTo(token){return this._scanner.pos=token.pos+token.len,this._token=token,!1}_until(type){const start=this._token;for(;this._token.type!==type;){if(14===this._token.type)return!1;if(5===this._token.type){const nextToken=this._scanner.next();if(0!==nextToken.type&&4!==nextToken.type&&5!==nextToken.type)return!1}this._token=this._scanner.next()}const value=this._scanner.value.substring(start.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),value}_parse(marker){return this._parseEscaped(marker)||this._parseTabstopOrVariableName(marker)||this._parseComplexPlaceholder(marker)||this._parseComplexVariable(marker)||this._parseAnything(marker)}_parseEscaped(marker){let value;return!!(value=this._accept(5,!0))&&(value=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||value,marker.appendChild(new Text(value)),!0)}_parseTabstopOrVariableName(parent){let value;const token=this._token;return this._accept(0)&&(value=this._accept(9,!0)||this._accept(8,!0))?(parent.appendChild(/^\d+$/.test(value)?new Placeholder(Number(value)):new Variable(value)),!0):this._backTo(token)}_parseComplexPlaceholder(parent){let index;const token=this._token;if(!(this._accept(0)&&this._accept(3)&&(index=this._accept(8,!0))))return this._backTo(token);const placeholder=new Placeholder(Number(index));if(this._accept(1))for(;;){if(this._accept(4))return parent.appendChild(placeholder),!0;if(!this._parse(placeholder))return parent.appendChild(new Text("${"+index+":")),placeholder.children.forEach(parent.appendChild,parent),!0}else{if(!(placeholder.index>0&&this._accept(7)))return this._accept(6)?this._parseTransform(placeholder)?(parent.appendChild(placeholder),!0):(this._backTo(token),!1):this._accept(4)?(parent.appendChild(placeholder),!0):this._backTo(token);{const choice=new Choice;for(;;){if(this._parseChoiceElement(choice)){if(this._accept(2))continue;if(this._accept(7)&&(placeholder.appendChild(choice),this._accept(4)))return parent.appendChild(placeholder),!0}return this._backTo(token),!1}}}}_parseChoiceElement(parent){const token=this._token,values=[];for(;2!==this._token.type&&7!==this._token.type;){let value;if(value=(value=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||value:this._accept(void 0,!0),!value)return this._backTo(token),!1;values.push(value)}return 0===values.length?(this._backTo(token),!1):(parent.appendChild(new Text(values.join(""))),!0)}_parseComplexVariable(parent){let name;const token=this._token;if(!(this._accept(0)&&this._accept(3)&&(name=this._accept(9,!0))))return this._backTo(token);const variable=new Variable(name);if(!this._accept(1))return this._accept(6)?this._parseTransform(variable)?(parent.appendChild(variable),!0):(this._backTo(token),!1):this._accept(4)?(parent.appendChild(variable),!0):this._backTo(token);for(;;){if(this._accept(4))return parent.appendChild(variable),!0;if(!this._parse(variable))return parent.appendChild(new Text("${"+name+":")),variable.children.forEach(parent.appendChild,parent),!0}}_parseTransform(parent){let transform=new Transform,regexValue="",regexOptions="";for(;!this._accept(6);){let escaped;if(escaped=this._accept(5,!0))escaped=this._accept(6,!0)||escaped,regexValue+=escaped;else{if(14===this._token.type)return!1;regexValue+=this._accept(void 0,!0)}}for(;!this._accept(6);){let escaped;if(escaped=this._accept(5,!0))escaped=this._accept(5,!0)||this._accept(6,!0)||escaped,transform.appendChild(new Text(escaped));else if(!this._parseFormatString(transform)&&!this._parseAnything(transform))return!1}for(;!this._accept(4);){if(14===this._token.type)return!1;regexOptions+=this._accept(void 0,!0)}try{transform.regexp=new RegExp(regexValue,regexOptions)}catch(e){return!1}return parent.transform=transform,!0}_parseFormatString(parent){const token=this._token;if(!this._accept(0))return!1;let complex=!1;this._accept(3)&&(complex=!0);let index=this._accept(8,!0);if(!index)return this._backTo(token),!1;if(!complex)return parent.appendChild(new FormatString(Number(index))),!0;if(this._accept(4))return parent.appendChild(new FormatString(Number(index))),!0;if(!this._accept(1))return this._backTo(token),!1;if(this._accept(6)){let shorthand=this._accept(9,!0);return shorthand&&this._accept(4)?(parent.appendChild(new FormatString(Number(index),shorthand)),!0):(this._backTo(token),!1)}if(this._accept(11)){let ifValue=this._until(4);if(ifValue)return parent.appendChild(new FormatString(Number(index),void 0,ifValue,void 0)),!0}else if(this._accept(12)){let elseValue=this._until(4);if(elseValue)return parent.appendChild(new FormatString(Number(index),void 0,void 0,elseValue)),!0}else if(this._accept(13)){let ifValue=this._until(1);if(ifValue){let elseValue=this._until(4);if(elseValue)return parent.appendChild(new FormatString(Number(index),void 0,ifValue,elseValue)),!0}}else{let elseValue=this._until(4);if(elseValue)return parent.appendChild(new FormatString(Number(index),void 0,void 0,elseValue)),!0}return this._backTo(token),!1}_parseAnything(marker){return 14!==this._token.type&&(marker.appendChild(new Text(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}})),define(__m[472],__M([1,0,18,75,8]),(function(require,exports,arrays_1,filters_1,strings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompletionModel=exports.LineContext=void 0;exports.LineContext=class LineContext{constructor(leadingLineContent,characterCountDelta){this.leadingLineContent=leadingLineContent,this.characterCountDelta=characterCountDelta}};class CompletionModel{constructor(items,column,lineContext,wordDistance,options,snippetSuggestions,clipboardText){this.clipboardText=clipboardText,this._snippetCompareFn=CompletionModel._compareCompletionItems,this._items=items,this._column=column,this._wordDistance=wordDistance,this._options=options,this._refilterKind=1,this._lineContext=lineContext,"top"===snippetSuggestions?this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsUp:"bottom"===snippetSuggestions&&(this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(value){this._lineContext.leadingLineContent===value.leadingLineContent&&this._lineContext.characterCountDelta===value.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<value.characterCountDelta&&this._filteredItems?2:1,this._lineContext=value)}get items(){return this._ensureCachedState(),this._filteredItems}get allProvider(){return this._ensureCachedState(),this._providerInfo.keys()}get incomplete(){this._ensureCachedState();const result=new Set;for(let[provider,incomplete]of this._providerInfo)incomplete&&result.add(provider);return result}adopt(except){let res=[];for(let i=0;i<this._items.length;)except.has(this._items[i].provider)?i++:(res.push(this._items[i]),this._items[i]=this._items[this._items.length-1],this._items.pop());return this._refilterKind=1,res}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){0!==this._refilterKind&&this._createCachedState()}_createCachedState(){this._providerInfo=new Map;const labelLengths=[],{leadingLineContent,characterCountDelta}=this._lineContext;let word="",wordLow="";const source=1===this._refilterKind?this._items:this._filteredItems,target=[],scoreFn=!this._options.filterGraceful||source.length>2e3?filters_1.fuzzyScore:filters_1.fuzzyScoreGracefulAggressive;for(let i=0;i<source.length;i++){const item=source[i];if(item.isInvalid)continue;this._providerInfo.set(item.provider,Boolean(item.container.incomplete));const overwriteBefore=item.position.column-item.editStart.column,wordLen=overwriteBefore+characterCountDelta-(item.position.column-this._column);if(word.length!==wordLen&&(word=0===wordLen?"":leadingLineContent.slice(-wordLen),wordLow=word.toLowerCase()),item.word=word,0===wordLen)item.score=filters_1.FuzzyScore.Default;else{let wordPos=0;for(;wordPos<overwriteBefore;){const ch=word.charCodeAt(wordPos);if(32!==ch&&9!==ch)break;wordPos+=1}if(wordPos>=wordLen)item.score=filters_1.FuzzyScore.Default;else if("string"==typeof item.completion.filterText){let match=scoreFn(word,wordLow,wordPos,item.completion.filterText,item.filterTextLow,0,!1);if(!match)continue;0===(0,strings_1.compareIgnoreCase)(item.completion.filterText,item.textLabel)?item.score=match:(item.score=(0,filters_1.anyScore)(word,wordLow,wordPos,item.textLabel,item.labelLow,0),item.score[0]=match[0])}else{let match=scoreFn(word,wordLow,wordPos,item.textLabel,item.labelLow,0,!1);if(!match)continue;item.score=match}}item.idx=i,item.distance=this._wordDistance.distance(item.position,item.completion),target.push(item),labelLengths.push(item.textLabel.length)}this._filteredItems=target.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:labelLengths.length?(0,arrays_1.quickSelect)(labelLengths.length-.85,labelLengths,((a,b)=>a-b)):0}}static _compareCompletionItems(a,b){return a.score[0]>b.score[0]?-1:a.score[0]<b.score[0]?1:a.distance<b.distance?-1:a.distance>b.distance?1:a.idx<b.idx?-1:a.idx>b.idx?1:0}static _compareCompletionItemsSnippetsDown(a,b){if(a.completion.kind!==b.completion.kind){if(27===a.completion.kind)return 1;if(27===b.completion.kind)return-1}return CompletionModel._compareCompletionItems(a,b)}static _compareCompletionItemsSnippetsUp(a,b){if(a.completion.kind!==b.completion.kind){if(27===a.completion.kind)return-1;if(27===b.completion.kind)return 1}return CompletionModel._compareCompletionItems(a,b)}}exports.CompletionModel=CompletionModel})),define(__m[265],__M([1,0,7,116,4,2]),(function(require,exports,dom_1,sash_1,event_1,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResizableHTMLElement=void 0;exports.ResizableHTMLElement=class ResizableHTMLElement{constructor(){let currentSize;this._onDidWillResize=new event_1.Emitter,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new event_1.Emitter,this.onDidResize=this._onDidResize.event,this._sashListener=new lifecycle_1.DisposableStore,this._size=new dom_1.Dimension(0,0),this._minSize=new dom_1.Dimension(0,0),this._maxSize=new dom_1.Dimension(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new sash_1.Sash(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new sash_1.Sash(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new sash_1.Sash(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:sash_1.OrthogonalEdge.North}),this._southSash=new sash_1.Sash(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:sash_1.OrthogonalEdge.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let deltaY=0,deltaX=0;this._sashListener.add(event_1.Event.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)((()=>{void 0===currentSize&&(this._onDidWillResize.fire(),currentSize=this._size,deltaY=0,deltaX=0)}))),this._sashListener.add(event_1.Event.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)((()=>{void 0!==currentSize&&(currentSize=void 0,deltaY=0,deltaX=0,this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(this._eastSash.onDidChange((e=>{currentSize&&(deltaX=e.currentX-e.startX,this.layout(currentSize.height+deltaY,currentSize.width+deltaX),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))}))),this._sashListener.add(this._westSash.onDidChange((e=>{currentSize&&(deltaX=-(e.currentX-e.startX),this.layout(currentSize.height+deltaY,currentSize.width+deltaX),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))}))),this._sashListener.add(this._northSash.onDidChange((e=>{currentSize&&(deltaY=-(e.currentY-e.startY),this.layout(currentSize.height+deltaY,currentSize.width+deltaX),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))}))),this._sashListener.add(this._southSash.onDidChange((e=>{currentSize&&(deltaY=e.currentY-e.startY,this.layout(currentSize.height+deltaY,currentSize.width+deltaX),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))}))),this._sashListener.add(event_1.Event.any(this._eastSash.onDidReset,this._westSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(event_1.Event.any(this._northSash.onDidReset,this._southSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))})))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(north,east,south,west){this._northSash.state=north?3:0,this._eastSash.state=east?3:0,this._southSash.state=south?3:0,this._westSash.state=west?3:0}layout(height=this.size.height,width=this.size.width){const{height:minHeight,width:minWidth}=this._minSize,{height:maxHeight,width:maxWidth}=this._maxSize;height=Math.max(minHeight,Math.min(maxHeight,height)),width=Math.max(minWidth,Math.min(maxWidth,width));const newSize=new dom_1.Dimension(width,height);dom_1.Dimension.equals(newSize,this._size)||(this.domNode.style.height=height+"px",this.domNode.style.width=width+"px",this._size=newSize,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(value){this._maxSize=value}get maxSize(){return this._maxSize}set minSize(value){this._minSize=value}get minSize(){return this._minSize}set preferredSize(value){this._preferredSize=value}get preferredSize(){return this._preferredSize}}})),define(__m[473],__M([1,0,18,2,99]),(function(require,exports,arrays_1,lifecycle_1,characterClassifier_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CommitCharacterController=void 0;exports.CommitCharacterController=class CommitCharacterController{constructor(editor,widget,accept){this._disposables=new lifecycle_1.DisposableStore,this._disposables.add(widget.onDidShow((()=>this._onItem(widget.getFocusedItem())))),this._disposables.add(widget.onDidFocus(this._onItem,this)),this._disposables.add(widget.onDidHide(this.reset,this)),this._disposables.add(editor.onWillType((text=>{if(this._active&&!widget.isFrozen()){const ch=text.charCodeAt(text.length-1);this._active.acceptCharacters.has(ch)&&editor.getOption(0)&&accept(this._active.item)}})))}_onItem(selected){if(!selected||!(0,arrays_1.isNonEmptyArray)(selected.item.completion.commitCharacters))return void this.reset();if(this._active&&this._active.item.item===selected.item)return;const acceptCharacters=new characterClassifier_1.CharacterSet;for(const ch of selected.item.completion.commitCharacters)ch.length>0&&acceptCharacters.add(ch.charCodeAt(0));this._active={acceptCharacters,item:selected}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}})),define(__m[474],__M([1,0,2]),(function(require,exports,lifecycle_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OvertypingCapturer=void 0;class OvertypingCapturer{constructor(editor,suggestModel){this._disposables=new lifecycle_1.DisposableStore,this._lastOvertyped=[],this._empty=!0,this._disposables.add(editor.onWillType((()=>{if(!this._empty)return;if(!editor.hasModel())return;const selections=editor.getSelections(),selectionsLength=selections.length;let willOvertype=!1;for(let i=0;i<selectionsLength;i++)if(!selections[i].isEmpty()){willOvertype=!0;break}if(!willOvertype)return;this._lastOvertyped=[];const model=editor.getModel();for(let i=0;i<selectionsLength;i++){const selection=selections[i];if(model.getValueLengthInRange(selection)>OvertypingCapturer._maxSelectionLength)return;this._lastOvertyped[i]={value:model.getValueInRange(selection),multiline:selection.startLineNumber!==selection.endLineNumber}}this._empty=!1}))),this._disposables.add(suggestModel.onDidCancel((e=>{this._empty||e.retrigger||(this._empty=!0)})))}getLastOvertypedInfo(idx){if(!this._empty&&idx>=0&&idx<this._lastOvertyped.length)return this._lastOvertyped[idx]}dispose(){this._disposables.dispose()}}exports.OvertypingCapturer=OvertypingCapturer,OvertypingCapturer._maxSelectionLength=51200})),define(__m[475],__M([1,0,18,3,264]),(function(require,exports,arrays_1,range_1,bracketSelections_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WordDistance=void 0;class WordDistance{static create(service,editor){return __awaiter(this,void 0,void 0,(function*(){if(!editor.getOption(106).localityBonus)return WordDistance.None;if(!editor.hasModel())return WordDistance.None;const model=editor.getModel(),position=editor.getPosition();if(!service.canComputeWordRanges(model.uri))return WordDistance.None;const[ranges]=yield(new bracketSelections_1.BracketSelectionRangeProvider).provideSelectionRanges(model,[position]);if(0===ranges.length)return WordDistance.None;const wordRanges=yield service.computeWordRanges(model.uri,ranges[0].range);if(!wordRanges)return WordDistance.None;const wordUntilPos=model.getWordUntilPosition(position);return delete wordRanges[wordUntilPos.word],new class extends WordDistance{distance(anchor,item){if(!position.equals(editor.getPosition()))return 0;if(17===item.kind)return 2<<20;let word="string"==typeof item.label?item.label:item.label.label,wordLines=wordRanges[word];if((0,arrays_1.isFalsyOrEmpty)(wordLines))return 2<<20;let idx=(0,arrays_1.binarySearch)(wordLines,range_1.Range.fromPositions(anchor),range_1.Range.compareRangesUsingStarts),bestWordRange=idx>=0?wordLines[idx]:wordLines[Math.max(0,~idx-1)],blockDistance=ranges.length;for(const range of ranges){if(!range_1.Range.containsRange(range.range,bestWordRange))break;blockDistance-=1}return blockDistance}}}))}}exports.WordDistance=WordDistance,WordDistance.None=new class extends WordDistance{distance(){return 0}}})),define(__m[266],__M([1,0]),(function(require,exports){"use strict";function isFuzzyActionArr(what){return Array.isArray(what)}function isString(what){return"string"==typeof what}function empty(s){return!s}function fixCase(lexer,str){return lexer.ignoreCase&&str?str.toLowerCase():str}Object.defineProperty(exports,"__esModule",{value:!0}),exports.stateExists=exports.findRules=exports.substituteMatches=exports.createError=exports.log=exports.sanitize=exports.fixCase=exports.empty=exports.isIAction=exports.isString=exports.isFuzzyAction=exports.isFuzzyActionArr=void 0,exports.isFuzzyActionArr=isFuzzyActionArr,exports.isFuzzyAction=function isFuzzyAction(what){return!isFuzzyActionArr(what)},exports.isString=isString,exports.isIAction=function isIAction(what){return!isString(what)},exports.empty=empty,exports.fixCase=fixCase,exports.sanitize=function sanitize(s){return s.replace(/[&<>'"_]/g,"-")},exports.log=function log(lexer,msg){console.log(`${lexer.languageId}: ${msg}`)},exports.createError=function createError(lexer,msg){return new Error(`${lexer.languageId}: ${msg}`)},exports.substituteMatches=function substituteMatches(lexer,str,id,matches,state){let stateMatches=null;return str.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,(function(full,sub,dollar,hash,n,s,attr,ofs,total){return empty(dollar)?empty(hash)?!empty(n)&&n<matches.length?fixCase(lexer,matches[n]):!empty(attr)&&lexer&&"string"==typeof lexer[attr]?lexer[attr]:(null===stateMatches&&(stateMatches=state.split("."),stateMatches.unshift(state)),!empty(s)&&s<stateMatches.length?fixCase(lexer,stateMatches[s]):""):fixCase(lexer,id):"$"}))},exports.findRules=function findRules(lexer,inState){let state=inState;for(;state&&state.length>0;){const rules=lexer.tokenizer[state];if(rules)return rules;const idx=state.lastIndexOf(".");state=idx<0?null:state.substr(0,idx)}return null},exports.stateExists=function stateExists(lexer,inState){let state=inState;for(;state&&state.length>0;){if(lexer.stateNames[state])return!0;const idx=state.lastIndexOf(".");state=idx<0?null:state.substr(0,idx)}return!1}})),define(__m[476],__M([1,0,266]),(function(require,exports,monarchCommon){"use strict";function bool(prop,defValue){return"boolean"==typeof prop?prop:defValue}function string(prop,defValue){return"string"==typeof prop?prop:defValue}function createKeywordMatcher(arr,caseInsensitive=!1){caseInsensitive&&(arr=arr.map((function(x){return x.toLowerCase()})));const hash=function arrayToHash(array){const result={};for(const e of array)result[e]=!0;return result}(arr);return caseInsensitive?function(word){return void 0!==hash[word.toLowerCase()]&&hash.hasOwnProperty(word.toLowerCase())}:function(word){return void 0!==hash[word]&&hash.hasOwnProperty(word)}}function compileRegExp(lexer,str){str=str.replace(/@@/g,"");let hadExpansion,n=0;do{hadExpansion=!1,str=str.replace(/@(\w+)/g,(function(s,attr){hadExpansion=!0;let sub="";if("string"==typeof lexer[attr])sub=lexer[attr];else{if(!(lexer[attr]&&lexer[attr]instanceof RegExp))throw void 0===lexer[attr]?monarchCommon.createError(lexer,"language definition does not contain attribute '"+attr+"', used at: "+str):monarchCommon.createError(lexer,"attribute reference '"+attr+"' must be a string, used at: "+str);sub=lexer[attr].source}return monarchCommon.empty(sub)?"":"(?:"+sub+")"})),n++}while(hadExpansion&&n<5);str=str.replace(/\x01/g,"@");const flags=(lexer.ignoreCase?"i":"")+(lexer.unicode?"u":"");return new RegExp(str,flags)}function createGuard(lexer,ruleName,tkey,val){let scrut=-1,oppat=tkey,matches=tkey.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);matches&&(matches[3]&&(scrut=parseInt(matches[3]),matches[2]&&(scrut+=100)),oppat=matches[4]);let tester,op="~",pat=oppat;if(oppat&&0!==oppat.length?/^\w*$/.test(pat)?op="==":(matches=oppat.match(/^(@|!@|~|!~|==|!=)(.*)$/),matches&&(op=matches[1],pat=matches[2])):(op="!=",pat=""),"~"!==op&&"!~"!==op||!/^(\w|\|)*$/.test(pat))if("@"===op||"!@"===op){const words=lexer[pat];if(!words)throw monarchCommon.createError(lexer,"the @ match target '"+pat+"' is not defined, in rule: "+ruleName);if(!function isArrayOf(elemType,obj){if(!obj)return!1;if(!Array.isArray(obj))return!1;for(const el of obj)if(!elemType(el))return!1;return!0}((function(elem){return"string"==typeof elem}),words))throw monarchCommon.createError(lexer,"the @ match target '"+pat+"' must be an array of strings, in rule: "+ruleName);const inWords=createKeywordMatcher(words,lexer.ignoreCase);tester=function(s){return"@"===op?inWords(s):!inWords(s)}}else if("~"===op||"!~"===op)if(pat.indexOf("$")<0){const re=compileRegExp(lexer,"^"+pat+"$");tester=function(s){return"~"===op?re.test(s):!re.test(s)}}else tester=function(s,id,matches,state){return compileRegExp(lexer,"^"+monarchCommon.substituteMatches(lexer,pat,id,matches,state)+"$").test(s)};else if(pat.indexOf("$")<0){const patx=monarchCommon.fixCase(lexer,pat);tester=function(s){return"=="===op?s===patx:s!==patx}}else{const patx=monarchCommon.fixCase(lexer,pat);tester=function(s,id,matches,state,eos){const patexp=monarchCommon.substituteMatches(lexer,patx,id,matches,state);return"=="===op?s===patexp:s!==patexp}}else{const inWords=createKeywordMatcher(pat.split("|"),lexer.ignoreCase);tester=function(s){return"~"===op?inWords(s):!inWords(s)}}return-1===scrut?{name:tkey,value:val,test:function(id,matches,state,eos){return tester(id,id,matches,state,eos)}}:{name:tkey,value:val,test:function(id,matches,state,eos){const scrutinee=function selectScrutinee(id,matches,state,num){if(num<0)return id;if(num<matches.length)return matches[num];if(num>=100){num-=100;const parts=state.split(".");if(parts.unshift(state),num<parts.length)return parts[num]}return null}(id,matches,state,scrut);return tester(scrutinee||"",id,matches,state,eos)}}}function compileAction(lexer,ruleName,action){if(action){if("string"==typeof action)return action;if(action.token||""===action.token){if("string"!=typeof action.token)throw monarchCommon.createError(lexer,"a 'token' attribute must be of type string, in rule: "+ruleName);{const newAction={token:action.token};if(action.token.indexOf("$")>=0&&(newAction.tokenSubst=!0),"string"==typeof action.bracket)if("@open"===action.bracket)newAction.bracket=1;else{if("@close"!==action.bracket)throw monarchCommon.createError(lexer,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+ruleName);newAction.bracket=-1}if(action.next){if("string"!=typeof action.next)throw monarchCommon.createError(lexer,"the next state must be a string value in rule: "+ruleName);{let next=action.next;if(!/^(@pop|@push|@popall)$/.test(next)&&("@"===next[0]&&(next=next.substr(1)),next.indexOf("$")<0&&!monarchCommon.stateExists(lexer,monarchCommon.substituteMatches(lexer,next,"",[],""))))throw monarchCommon.createError(lexer,"the next state '"+action.next+"' is not defined in rule: "+ruleName);newAction.next=next}}return"number"==typeof action.goBack&&(newAction.goBack=action.goBack),"string"==typeof action.switchTo&&(newAction.switchTo=action.switchTo),"string"==typeof action.log&&(newAction.log=action.log),"string"==typeof action.nextEmbedded&&(newAction.nextEmbedded=action.nextEmbedded,lexer.usesEmbedded=!0),newAction}}if(Array.isArray(action)){const results=[];for(let i=0,len=action.length;i<len;i++)results[i]=compileAction(lexer,ruleName,action[i]);return{group:results}}if(action.cases){const cases=[];for(let tkey in action.cases)if(action.cases.hasOwnProperty(tkey)){const val=compileAction(lexer,ruleName,action.cases[tkey]);"@default"===tkey||"@"===tkey||""===tkey?cases.push({test:void 0,value:val,name:tkey}):"@eos"===tkey?cases.push({test:function(id,matches,state,eos){return eos},value:val,name:tkey}):cases.push(createGuard(lexer,ruleName,tkey,val))}const def=lexer.defaultToken;return{test:function(id,matches,state,eos){for(const _case of cases){if(!_case.test||_case.test(id,matches,state,eos))return _case.value}return def}}}throw monarchCommon.createError(lexer,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+ruleName)}return{token:""}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compile=void 0;class Rule{constructor(name){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=name}setRegex(lexer,re){let sregex;if("string"==typeof re)sregex=re;else{if(!(re instanceof RegExp))throw monarchCommon.createError(lexer,"rules must start with a match string or regular expression: "+this.name);sregex=re.source}this.matchOnlyAtLineStart=sregex.length>0&&"^"===sregex[0],this.name=this.name+": "+sregex,this.regex=compileRegExp(lexer,"^(?:"+(this.matchOnlyAtLineStart?sregex.substr(1):sregex)+")")}setAction(lexer,act){this.action=compileAction(lexer,this.name,act)}}exports.compile=function compile(languageId,json){if(!json||"object"!=typeof json)throw new Error("Monarch: expecting a language definition object");const lexer={};lexer.languageId=languageId,lexer.includeLF=bool(json.includeLF,!1),lexer.noThrow=!1,lexer.maxStack=100,lexer.start="string"==typeof json.start?json.start:null,lexer.ignoreCase=bool(json.ignoreCase,!1),lexer.unicode=bool(json.unicode,!1),lexer.tokenPostfix=string(json.tokenPostfix,"."+lexer.languageId),lexer.defaultToken=string(json.defaultToken,"source"),lexer.usesEmbedded=!1;const lexerMin=json;function addRules(state,newrules,rules){for(const rule of rules){let include=rule.include;if(include){if("string"!=typeof include)throw monarchCommon.createError(lexer,"an 'include' attribute must be a string at: "+state);if("@"===include[0]&&(include=include.substr(1)),!json.tokenizer[include])throw monarchCommon.createError(lexer,"include target '"+include+"' is not defined at: "+state);addRules(state+"."+include,newrules,json.tokenizer[include])}else{const newrule=new Rule(state);if(Array.isArray(rule)&&rule.length>=1&&rule.length<=3)if(newrule.setRegex(lexerMin,rule[0]),rule.length>=3)if("string"==typeof rule[1])newrule.setAction(lexerMin,{token:rule[1],next:rule[2]});else{if("object"!=typeof rule[1])throw monarchCommon.createError(lexer,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+state);{const rule1=rule[1];rule1.next=rule[2],newrule.setAction(lexerMin,rule1)}}else newrule.setAction(lexerMin,rule[1]);else{if(!rule.regex)throw monarchCommon.createError(lexer,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+state);rule.name&&"string"==typeof rule.name&&(newrule.name=rule.name),rule.matchOnlyAtStart&&(newrule.matchOnlyAtLineStart=bool(rule.matchOnlyAtLineStart,!1)),newrule.setRegex(lexerMin,rule.regex),newrule.setAction(lexerMin,rule.action)}newrules.push(newrule)}}}if(lexerMin.languageId=languageId,lexerMin.includeLF=lexer.includeLF,lexerMin.ignoreCase=lexer.ignoreCase,lexerMin.unicode=lexer.unicode,lexerMin.noThrow=lexer.noThrow,lexerMin.usesEmbedded=lexer.usesEmbedded,lexerMin.stateNames=json.tokenizer,lexerMin.defaultToken=lexer.defaultToken,!json.tokenizer||"object"!=typeof json.tokenizer)throw monarchCommon.createError(lexer,"a language definition must define the 'tokenizer' attribute as an object");lexer.tokenizer=[];for(let key in json.tokenizer)if(json.tokenizer.hasOwnProperty(key)){lexer.start||(lexer.start=key);const rules=json.tokenizer[key];lexer.tokenizer[key]=new Array,addRules("tokenizer."+key,lexer.tokenizer[key],rules)}if(lexer.usesEmbedded=lexerMin.usesEmbedded,json.brackets){if(!Array.isArray(json.brackets))throw monarchCommon.createError(lexer,"the 'brackets' attribute must be defined as an array")}else json.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const brackets=[];for(let el of json.brackets){let desc=el;if(desc&&Array.isArray(desc)&&3===desc.length&&(desc={token:desc[2],open:desc[0],close:desc[1]}),desc.open===desc.close)throw monarchCommon.createError(lexer,"open and close brackets in a 'brackets' attribute must be different: "+desc.open+"\n hint: use the 'bracket' attribute if matching on equal brackets is required.");if("string"!=typeof desc.open||"string"!=typeof desc.token||"string"!=typeof desc.close)throw monarchCommon.createError(lexer,"every element in the 'brackets' array must be a '{open,close,token}' object or array");brackets.push({token:desc.token+lexer.tokenPostfix,open:monarchCommon.fixCase(lexer,desc.open),close:monarchCommon.fixCase(lexer,desc.close)})}return lexer.brackets=brackets,lexer.noThrow=!0,lexer}})),define(__m[267],__M([1,0,27,124,266]),(function(require,exports,languages,nullTokenize_1,monarchCommon){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MonarchTokenizer=void 0;class MonarchStackElementFactory{constructor(maxCacheDepth){this._maxCacheDepth=maxCacheDepth,this._entries=Object.create(null)}static create(parent,state){return this._INSTANCE.create(parent,state)}create(parent,state){if(null!==parent&&parent.depth>=this._maxCacheDepth)return new MonarchStackElement(parent,state);let stackElementId=MonarchStackElement.getStackElementId(parent);stackElementId.length>0&&(stackElementId+="|"),stackElementId+=state;let result=this._entries[stackElementId];return result||(result=new MonarchStackElement(parent,state),this._entries[stackElementId]=result,result)}}MonarchStackElementFactory._INSTANCE=new MonarchStackElementFactory(5);class MonarchStackElement{constructor(parent,state){this.parent=parent,this.state=state,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(element){let result="";for(;null!==element;)result.length>0&&(result+="|"),result+=element.state,element=element.parent;return result}static _equals(a,b){for(;null!==a&&null!==b;){if(a===b)return!0;if(a.state!==b.state)return!1;a=a.parent,b=b.parent}return null===a&&null===b}equals(other){return MonarchStackElement._equals(this,other)}push(state){return MonarchStackElementFactory.create(this,state)}pop(){return this.parent}popall(){let result=this;for(;result.parent;)result=result.parent;return result}switchTo(state){return MonarchStackElementFactory.create(this.parent,state)}}class EmbeddedLanguageData{constructor(languageId,state){this.languageId=languageId,this.state=state}equals(other){return this.languageId===other.languageId&&this.state.equals(other.state)}clone(){return this.state.clone()===this.state?this:new EmbeddedLanguageData(this.languageId,this.state)}}class MonarchLineStateFactory{constructor(maxCacheDepth){this._maxCacheDepth=maxCacheDepth,this._entries=Object.create(null)}static create(stack,embeddedLanguageData){return this._INSTANCE.create(stack,embeddedLanguageData)}create(stack,embeddedLanguageData){if(null!==embeddedLanguageData)return new MonarchLineState(stack,embeddedLanguageData);if(null!==stack&&stack.depth>=this._maxCacheDepth)return new MonarchLineState(stack,embeddedLanguageData);const stackElementId=MonarchStackElement.getStackElementId(stack);let result=this._entries[stackElementId];return result||(result=new MonarchLineState(stack,null),this._entries[stackElementId]=result,result)}}MonarchLineStateFactory._INSTANCE=new MonarchLineStateFactory(5);class MonarchLineState{constructor(stack,embeddedLanguageData){this.stack=stack,this.embeddedLanguageData=embeddedLanguageData}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:MonarchLineStateFactory.create(this.stack,this.embeddedLanguageData)}equals(other){return other instanceof MonarchLineState&&(!!this.stack.equals(other.stack)&&(null===this.embeddedLanguageData&&null===other.embeddedLanguageData||null!==this.embeddedLanguageData&&null!==other.embeddedLanguageData&&this.embeddedLanguageData.equals(other.embeddedLanguageData)))}}class MonarchClassicTokensCollector{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(languageId){this._languageId=languageId}emit(startOffset,type){this._lastTokenType===type&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=type,this._lastTokenLanguage=this._languageId,this._tokens.push(new languages.Token(startOffset,type,this._languageId)))}nestedLanguageTokenize(embeddedLanguageLine,hasEOL,embeddedLanguageData,offsetDelta){const nestedLanguageId=embeddedLanguageData.languageId,embeddedModeState=embeddedLanguageData.state,nestedLanguageTokenizationSupport=languages.TokenizationRegistry.get(nestedLanguageId);if(!nestedLanguageTokenizationSupport)return this.enterLanguage(nestedLanguageId),this.emit(offsetDelta,""),embeddedModeState;const nestedResult=nestedLanguageTokenizationSupport.tokenize(embeddedLanguageLine,hasEOL,embeddedModeState);if(0!==offsetDelta)for(const token of nestedResult.tokens)this._tokens.push(new languages.Token(token.offset+offsetDelta,token.type,token.language));else this._tokens=this._tokens.concat(nestedResult.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,nestedResult.endState}finalize(endState){return new languages.TokenizationResult(this._tokens,endState)}}class MonarchModernTokensCollector{constructor(languageService,theme){this._languageService=languageService,this._theme=theme,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(languageId){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(languageId)}emit(startOffset,type){const metadata=this._theme.match(this._currentLanguageId,type);this._lastTokenMetadata!==metadata&&(this._lastTokenMetadata=metadata,this._tokens.push(startOffset),this._tokens.push(metadata))}static _merge(a,b,c){const aLen=null!==a?a.length:0,bLen=b.length,cLen=null!==c?c.length:0;if(0===aLen&&0===bLen&&0===cLen)return new Uint32Array(0);if(0===aLen&&0===bLen)return c;if(0===bLen&&0===cLen)return a;const result=new Uint32Array(aLen+bLen+cLen);null!==a&&result.set(a);for(let i=0;i<bLen;i++)result[aLen+i]=b[i];return null!==c&&result.set(c,aLen+bLen),result}nestedLanguageTokenize(embeddedLanguageLine,hasEOL,embeddedLanguageData,offsetDelta){const nestedLanguageId=embeddedLanguageData.languageId,embeddedModeState=embeddedLanguageData.state,nestedLanguageTokenizationSupport=languages.TokenizationRegistry.get(nestedLanguageId);if(!nestedLanguageTokenizationSupport)return this.enterLanguage(nestedLanguageId),this.emit(offsetDelta,""),embeddedModeState;const nestedResult=nestedLanguageTokenizationSupport.tokenizeEncoded(embeddedLanguageLine,hasEOL,embeddedModeState);if(0!==offsetDelta)for(let i=0,len=nestedResult.tokens.length;i<len;i+=2)nestedResult.tokens[i]+=offsetDelta;return this._prependTokens=MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,nestedResult.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,nestedResult.endState}finalize(endState){return new languages.EncodedTokenizationResult(MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,null),endState)}}class MonarchTokenizer{constructor(languageService,standaloneThemeService,languageId,lexer){this._languageService=languageService,this._standaloneThemeService=standaloneThemeService,this._languageId=languageId,this._lexer=lexer,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let emitting=!1;this._tokenizationRegistryListener=languages.TokenizationRegistry.onDidChange((e=>{if(emitting)return;let isOneOfMyEmbeddedModes=!1;for(let i=0,len=e.changedLanguages.length;i<len;i++){const language=e.changedLanguages[i];if(this._embeddedLanguages[language]){isOneOfMyEmbeddedModes=!0;break}}isOneOfMyEmbeddedModes&&(emitting=!0,languages.TokenizationRegistry.fire([this._languageId]),emitting=!1)}))}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){const promises=[];for(let nestedLanguageId in this._embeddedLanguages){const tokenizationSupport=languages.TokenizationRegistry.get(nestedLanguageId);if(tokenizationSupport){if(tokenizationSupport instanceof MonarchTokenizer){const nestedModeStatus=tokenizationSupport.getLoadStatus();!1===nestedModeStatus.loaded&&promises.push(nestedModeStatus.promise)}}else languages.TokenizationRegistry.isResolved(nestedLanguageId)||promises.push(languages.TokenizationRegistry.getOrCreate(nestedLanguageId))}return 0===promises.length?{loaded:!0}:{loaded:!1,promise:Promise.all(promises).then((_=>{}))}}getInitialState(){const rootState=MonarchStackElementFactory.create(null,this._lexer.start);return MonarchLineStateFactory.create(rootState,null)}tokenize(line,hasEOL,lineState){const tokensCollector=new MonarchClassicTokensCollector,endLineState=this._tokenize(line,hasEOL,lineState,tokensCollector);return tokensCollector.finalize(endLineState)}tokenizeEncoded(line,hasEOL,lineState){const tokensCollector=new MonarchModernTokensCollector(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),endLineState=this._tokenize(line,hasEOL,lineState,tokensCollector);return tokensCollector.finalize(endLineState)}_tokenize(line,hasEOL,lineState,collector){return lineState.embeddedLanguageData?this._nestedTokenize(line,hasEOL,lineState,0,collector):this._myTokenize(line,hasEOL,lineState,0,collector)}_findLeavingNestedLanguageOffset(line,state){let rules=this._lexer.tokenizer[state.stack.state];if(!rules&&(rules=monarchCommon.findRules(this._lexer,state.stack.state),!rules))throw monarchCommon.createError(this._lexer,"tokenizer state is not defined: "+state.stack.state);let popOffset=-1,hasEmbeddedPopRule=!1;for(const rule of rules){if(!monarchCommon.isIAction(rule.action)||"@pop"!==rule.action.nextEmbedded)continue;hasEmbeddedPopRule=!0;let regex=rule.regex;const regexSource=rule.regex.source;if("^(?:"===regexSource.substr(0,4)&&")"===regexSource.substr(regexSource.length-1,1)){const flags=(regex.ignoreCase?"i":"")+(regex.unicode?"u":"");regex=new RegExp(regexSource.substr(4,regexSource.length-5),flags)}const result=line.search(regex);-1===result||0!==result&&rule.matchOnlyAtLineStart||(-1===popOffset||result<popOffset)&&(popOffset=result)}if(!hasEmbeddedPopRule)throw monarchCommon.createError(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+state.stack.state);return popOffset}_nestedTokenize(line,hasEOL,lineState,offsetDelta,tokensCollector){const popOffset=this._findLeavingNestedLanguageOffset(line,lineState);if(-1===popOffset){const nestedEndState=tokensCollector.nestedLanguageTokenize(line,hasEOL,lineState.embeddedLanguageData,offsetDelta);return MonarchLineStateFactory.create(lineState.stack,new EmbeddedLanguageData(lineState.embeddedLanguageData.languageId,nestedEndState))}const nestedLanguageLine=line.substring(0,popOffset);nestedLanguageLine.length>0&&tokensCollector.nestedLanguageTokenize(nestedLanguageLine,!1,lineState.embeddedLanguageData,offsetDelta);const restOfTheLine=line.substring(popOffset);return this._myTokenize(restOfTheLine,hasEOL,lineState,offsetDelta+popOffset,tokensCollector)}_safeRuleName(rule){return rule?rule.name:"(unknown)"}_myTokenize(lineWithoutLF,hasEOL,lineState,offsetDelta,tokensCollector){tokensCollector.enterLanguage(this._languageId);const lineWithoutLFLength=lineWithoutLF.length,line=hasEOL&&this._lexer.includeLF?lineWithoutLF+"\n":lineWithoutLF,lineLength=line.length;let embeddedLanguageData=lineState.embeddedLanguageData,stack=lineState.stack,pos=0,groupMatching=null,forceEvaluation=!0;for(;forceEvaluation||pos<lineLength;){const pos0=pos,stackLen0=stack.depth,groupLen0=groupMatching?groupMatching.groups.length:0,state=stack.state;let matches=null,matched=null,action=null,rule=null,enteringEmbeddedLanguage=null;if(groupMatching){matches=groupMatching.matches;const groupEntry=groupMatching.groups.shift();matched=groupEntry.matched,action=groupEntry.action,rule=groupMatching.rule,0===groupMatching.groups.length&&(groupMatching=null)}else{if(!forceEvaluation&&pos>=lineLength)break;forceEvaluation=!1;let rules=this._lexer.tokenizer[state];if(!rules&&(rules=monarchCommon.findRules(this._lexer,state),!rules))throw monarchCommon.createError(this._lexer,"tokenizer state is not defined: "+state);let restOfLine=line.substr(pos);for(const rule of rules)if((0===pos||!rule.matchOnlyAtLineStart)&&(matches=restOfLine.match(rule.regex),matches)){matched=matches[0],action=rule.action;break}}if(matches||(matches=[""],matched=""),action||(pos<lineLength&&(matches=[line.charAt(pos)],matched=matches[0]),action=this._lexer.defaultToken),null===matched)break;for(pos+=matched.length;monarchCommon.isFuzzyAction(action)&&monarchCommon.isIAction(action)&&action.test;)action=action.test(matched,matches,state,pos===lineLength);let result=null;if("string"==typeof action||Array.isArray(action))result=action;else if(action.group)result=action.group;else if(null!==action.token&&void 0!==action.token){if(result=action.tokenSubst?monarchCommon.substituteMatches(this._lexer,action.token,matched,matches,state):action.token,action.nextEmbedded)if("@pop"===action.nextEmbedded){if(!embeddedLanguageData)throw monarchCommon.createError(this._lexer,"cannot pop embedded language if not inside one");embeddedLanguageData=null}else{if(embeddedLanguageData)throw monarchCommon.createError(this._lexer,"cannot enter embedded language from within an embedded language");enteringEmbeddedLanguage=monarchCommon.substituteMatches(this._lexer,action.nextEmbedded,matched,matches,state)}if(action.goBack&&(pos=Math.max(0,pos-action.goBack)),action.switchTo&&"string"==typeof action.switchTo){let nextState=monarchCommon.substituteMatches(this._lexer,action.switchTo,matched,matches,state);if("@"===nextState[0]&&(nextState=nextState.substr(1)),!monarchCommon.findRules(this._lexer,nextState))throw monarchCommon.createError(this._lexer,"trying to switch to a state '"+nextState+"' that is undefined in rule: "+this._safeRuleName(rule));stack=stack.switchTo(nextState)}else{if(action.transform&&"function"==typeof action.transform)throw monarchCommon.createError(this._lexer,"action.transform not supported");if(action.next)if("@push"===action.next){if(stack.depth>=this._lexer.maxStack)throw monarchCommon.createError(this._lexer,"maximum tokenizer stack size reached: ["+stack.state+","+stack.parent.state+",...]");stack=stack.push(state)}else if("@pop"===action.next){if(stack.depth<=1)throw monarchCommon.createError(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(rule));stack=stack.pop()}else if("@popall"===action.next)stack=stack.popall();else{let nextState=monarchCommon.substituteMatches(this._lexer,action.next,matched,matches,state);if("@"===nextState[0]&&(nextState=nextState.substr(1)),!monarchCommon.findRules(this._lexer,nextState))throw monarchCommon.createError(this._lexer,"trying to set a next state '"+nextState+"' that is undefined in rule: "+this._safeRuleName(rule));stack=stack.push(nextState)}}action.log&&"string"==typeof action.log&&monarchCommon.log(this._lexer,this._lexer.languageId+": "+monarchCommon.substituteMatches(this._lexer,action.log,matched,matches,state))}if(null===result)throw monarchCommon.createError(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(rule));const computeNewStateForEmbeddedLanguage=enteringEmbeddedLanguage=>{const languageId=this._languageService.getLanguageIdByLanguageName(enteringEmbeddedLanguage)||this._languageService.getLanguageIdByMimeType(enteringEmbeddedLanguage)||enteringEmbeddedLanguage,embeddedLanguageData=this._getNestedEmbeddedLanguageData(languageId);if(pos<lineLength){const restOfLine=lineWithoutLF.substr(pos);return this._nestedTokenize(restOfLine,hasEOL,MonarchLineStateFactory.create(stack,embeddedLanguageData),offsetDelta+pos,tokensCollector)}return MonarchLineStateFactory.create(stack,embeddedLanguageData)};if(Array.isArray(result)){if(groupMatching&&groupMatching.groups.length>0)throw monarchCommon.createError(this._lexer,"groups cannot be nested: "+this._safeRuleName(rule));if(matches.length!==result.length+1)throw monarchCommon.createError(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(rule));let totalLen=0;for(let i=1;i<matches.length;i++)totalLen+=matches[i].length;if(totalLen!==matched.length)throw monarchCommon.createError(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(rule));groupMatching={rule,matches,groups:[]};for(let i=0;i<result.length;i++)groupMatching.groups[i]={action:result[i],matched:matches[i+1]};pos-=matched.length}else{{if("@rematch"===result&&(pos-=matched.length,matched="",matches=null,result="",null!==enteringEmbeddedLanguage))return computeNewStateForEmbeddedLanguage(enteringEmbeddedLanguage);if(0===matched.length){if(0===lineLength||stackLen0!==stack.depth||state!==stack.state||(groupMatching?groupMatching.groups.length:0)!==groupLen0)continue;throw monarchCommon.createError(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(rule))}let tokenType=null;if(monarchCommon.isString(result)&&0===result.indexOf("@brackets")){const rest=result.substr("@brackets".length),bracket=findBracket(this._lexer,matched);if(!bracket)throw monarchCommon.createError(this._lexer,"@brackets token returned but no bracket defined as: "+matched);tokenType=monarchCommon.sanitize(bracket.token+rest)}else{const token=""===result?"":result+this._lexer.tokenPostfix;tokenType=monarchCommon.sanitize(token)}pos0<lineWithoutLFLength&&tokensCollector.emit(pos0+offsetDelta,tokenType)}if(null!==enteringEmbeddedLanguage)return computeNewStateForEmbeddedLanguage(enteringEmbeddedLanguage)}}return MonarchLineStateFactory.create(stack,embeddedLanguageData)}_getNestedEmbeddedLanguageData(languageId){if(!this._languageService.isRegisteredLanguageId(languageId))return new EmbeddedLanguageData(languageId,nullTokenize_1.NullState);languageId!==this._languageId&&(languages.TokenizationRegistry.getOrCreate(languageId),this._embeddedLanguages[languageId]=!0);const tokenizationSupport=languages.TokenizationRegistry.get(languageId);return new EmbeddedLanguageData(languageId,tokenizationSupport?tokenizationSupport.getInitialState():nullTokenize_1.NullState)}}function findBracket(lexer,matched){if(!matched)return null;matched=monarchCommon.fixCase(lexer,matched);const brackets=lexer.brackets;for(const bracket of brackets){if(bracket.open===matched)return{token:bracket.token,bracketType:1};if(bracket.close===matched)return{token:bracket.token,bracketType:-1}}return null}exports.MonarchTokenizer=MonarchTokenizer})),define(__m[477],__M([1,0,8,77,27,126,71,267]),(function(require,exports,strings,lineTokens_1,languages_1,viewLineRenderer_1,viewModel_1,monarchLexer_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Colorizer=void 0;const ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("standaloneColorizer",{createHTML:value=>value});function _fakeColorize(lines,tabSize,languageIdCodec){let html=[];const tokens=new Uint32Array(2);tokens[0]=0,tokens[1]=16793600;for(let i=0,length=lines.length;i<length;i++){const line=lines[i];tokens[0]=line.length;const lineTokens=new lineTokens_1.LineTokens(tokens,line,languageIdCodec),isBasicASCII=viewModel_1.ViewLineRenderingData.isBasicASCII(line,!0),containsRTL=viewModel_1.ViewLineRenderingData.containsRTL(line,isBasicASCII,!0),renderResult=(0,viewLineRenderer_1.renderViewLine2)(new viewLineRenderer_1.RenderLineInput(!1,!0,line,!1,isBasicASCII,containsRTL,0,lineTokens,[],tabSize,0,0,0,0,-1,"none",!1,!1,null));html=html.concat(renderResult.html),html.push("<br/>")}return html.join("")}exports.Colorizer=class Colorizer{static colorizeElement(themeService,languageService,domNode,options){const theme=(options=options||{}).theme||"vs",mimeType=options.mimeType||domNode.getAttribute("lang")||domNode.getAttribute("data-lang");if(!mimeType)return console.error("Mode not detected"),Promise.resolve();const languageId=languageService.getLanguageIdByMimeType(mimeType)||mimeType;themeService.setTheme(theme);const text=domNode.firstChild?domNode.firstChild.nodeValue:"";domNode.className+=" "+theme;return this.colorize(languageService,text||"",languageId,options).then((str=>{var _a;const trustedhtml=null!==(_a=null==ttPolicy?void 0:ttPolicy.createHTML(str))&&void 0!==_a?_a:str;domNode.innerHTML=trustedhtml}),(err=>console.error(err)))}static colorize(languageService,text,languageId,options){return __awaiter(this,void 0,void 0,(function*(){const languageIdCodec=languageService.languageIdCodec;let tabSize=4;options&&"number"==typeof options.tabSize&&(tabSize=options.tabSize),strings.startsWithUTF8BOM(text)&&(text=text.substr(1));const lines=strings.splitLines(text);if(!languageService.isRegisteredLanguageId(languageId))return _fakeColorize(lines,tabSize,languageIdCodec);const tokenizationSupport=yield languages_1.TokenizationRegistry.getOrCreate(languageId);return tokenizationSupport?function _colorize(lines,tabSize,tokenizationSupport,languageIdCodec){return new Promise(((c,e)=>{const execute=()=>{const result=function _actualColorize(lines,tabSize,tokenizationSupport,languageIdCodec){let html=[],state=tokenizationSupport.getInitialState();for(let i=0,length=lines.length;i<length;i++){const line=lines[i],tokenizeResult=tokenizationSupport.tokenizeEncoded(line,!0,state);lineTokens_1.LineTokens.convertToEndOffset(tokenizeResult.tokens,line.length);const lineTokens=new lineTokens_1.LineTokens(tokenizeResult.tokens,line,languageIdCodec),isBasicASCII=viewModel_1.ViewLineRenderingData.isBasicASCII(line,!0),containsRTL=viewModel_1.ViewLineRenderingData.containsRTL(line,isBasicASCII,!0),renderResult=(0,viewLineRenderer_1.renderViewLine2)(new viewLineRenderer_1.RenderLineInput(!1,!0,line,!1,isBasicASCII,containsRTL,0,lineTokens.inflate(),[],tabSize,0,0,0,0,-1,"none",!1,!1,null));html=html.concat(renderResult.html),html.push("<br/>"),state=tokenizeResult.endState}return html.join("")}(lines,tabSize,tokenizationSupport,languageIdCodec);if(tokenizationSupport instanceof monarchLexer_1.MonarchTokenizer){const status=tokenizationSupport.getLoadStatus();if(!1===status.loaded)return void status.promise.then(execute,e)}c(result)};execute()}))}(lines,tabSize,tokenizationSupport,languageIdCodec):_fakeColorize(lines,tabSize,languageIdCodec)}))}static colorizeLine(line,mightContainNonBasicASCII,mightContainRTL,tokens,tabSize=4){const isBasicASCII=viewModel_1.ViewLineRenderingData.isBasicASCII(line,mightContainNonBasicASCII),containsRTL=viewModel_1.ViewLineRenderingData.containsRTL(line,isBasicASCII,mightContainRTL);return(0,viewLineRenderer_1.renderViewLine2)(new viewLineRenderer_1.RenderLineInput(!1,!0,line,!1,isBasicASCII,containsRTL,0,tokens,[],tabSize,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(model,lineNumber,tabSize=4){const content=model.getLineContent(lineNumber);model.forceTokenization(lineNumber);const inflatedTokens=model.getLineTokens(lineNumber).inflate();return this.colorizeLine(content,model.mightContainNonBasicASCII(),model.mightContainRTL(),inflatedTokens,tabSize)}}})),define(__m[478],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/actionbar/actionViewItems",data)})),define(__m[479],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/findinput/findInput",data)})),define(__m[480],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/findinput/findInputCheckboxes",data)})),define(__m[268],__M([1,0,174,28,480]),(function(require,exports,checkbox_1,codicons_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RegexCheckbox=exports.WholeWordsCheckbox=exports.CaseSensitiveCheckbox=void 0;const NLS_CASE_SENSITIVE_CHECKBOX_LABEL=nls.localize(0,null),NLS_WHOLE_WORD_CHECKBOX_LABEL=nls.localize(1,null),NLS_REGEX_CHECKBOX_LABEL=nls.localize(2,null);class CaseSensitiveCheckbox extends checkbox_1.Checkbox{constructor(opts){super({icon:codicons_1.Codicon.caseSensitive,title:NLS_CASE_SENSITIVE_CHECKBOX_LABEL+opts.appendTitle,isChecked:opts.isChecked,inputActiveOptionBorder:opts.inputActiveOptionBorder,inputActiveOptionForeground:opts.inputActiveOptionForeground,inputActiveOptionBackground:opts.inputActiveOptionBackground})}}exports.CaseSensitiveCheckbox=CaseSensitiveCheckbox;class WholeWordsCheckbox extends checkbox_1.Checkbox{constructor(opts){super({icon:codicons_1.Codicon.wholeWord,title:NLS_WHOLE_WORD_CHECKBOX_LABEL+opts.appendTitle,isChecked:opts.isChecked,inputActiveOptionBorder:opts.inputActiveOptionBorder,inputActiveOptionForeground:opts.inputActiveOptionForeground,inputActiveOptionBackground:opts.inputActiveOptionBackground})}}exports.WholeWordsCheckbox=WholeWordsCheckbox;class RegexCheckbox extends checkbox_1.Checkbox{constructor(opts){super({icon:codicons_1.Codicon.regex,title:NLS_REGEX_CHECKBOX_LABEL+opts.appendTitle,isChecked:opts.isChecked,inputActiveOptionBorder:opts.inputActiveOptionBorder,inputActiveOptionForeground:opts.inputActiveOptionForeground,inputActiveOptionBackground:opts.inputActiveOptionBackground})}}exports.RegexCheckbox=RegexCheckbox})),define(__m[481],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/findinput/replaceInput",data)})),define(__m[482],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/iconLabel/iconLabelHover",data)})),define(__m[483],__M([1,0,7,10,21,68,97,2,19,482]),(function(require,exports,dom,async_1,cancellation_1,htmlContent_1,iconLabels_1,lifecycle_1,types_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupCustomHover=exports.setupNativeHover=void 0,exports.setupNativeHover=function setupNativeHover(htmlElement,tooltip){(0,types_1.isString)(tooltip)?htmlElement.title=(0,iconLabels_1.stripIcons)(tooltip):(null==tooltip?void 0:tooltip.markdownNotSupportedFallback)?htmlElement.title=tooltip.markdownNotSupportedFallback:htmlElement.removeAttribute("title")};class UpdatableHoverWidget{constructor(hoverDelegate,target,fadeInAnimation){this.hoverDelegate=hoverDelegate,this.target=target,this.fadeInAnimation=fadeInAnimation}update(content,focus){var _a;return __awaiter(this,void 0,void 0,(function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let resolvedContent;if(void 0===content||(0,types_1.isString)(content)||content instanceof HTMLElement)resolvedContent=content;else if((0,types_1.isFunction)(content.markdown)){this._hoverWidget||this.show((0,nls_1.localize)(0,null),focus),this._cancellationTokenSource=new cancellation_1.CancellationTokenSource;const token=this._cancellationTokenSource.token;if(resolvedContent=yield content.markdown(token),void 0===resolvedContent&&(resolvedContent=content.markdownNotSupportedFallback),this.isDisposed||token.isCancellationRequested)return}else resolvedContent=null!==(_a=content.markdown)&&void 0!==_a?_a:content.markdownNotSupportedFallback;this.show(resolvedContent,focus)}))}show(content,focus){const oldHoverWidget=this._hoverWidget;if(this.hasContent(content)){const hoverOptions={content,target:this.target,showPointer:"element"===this.hoverDelegate.placement,hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!oldHoverWidget};this._hoverWidget=this.hoverDelegate.showHover(hoverOptions,focus)}null==oldHoverWidget||oldHoverWidget.dispose()}hasContent(content){return!!content&&(!(0,htmlContent_1.isMarkdownString)(content)||!!content.value)}get isDisposed(){var _a;return null===(_a=this._hoverWidget)||void 0===_a?void 0:_a.isDisposed}dispose(){var _a,_b;null===(_a=this._hoverWidget)||void 0===_a||_a.dispose(),null===(_b=this._cancellationTokenSource)||void 0===_b||_b.dispose(!0),this._cancellationTokenSource=void 0}}exports.setupCustomHover=function setupCustomHover(hoverDelegate,htmlElement,content){let hoverPreparation,hoverWidget;const hideHover=(disposeWidget,disposePreparation)=>{var _a;disposeWidget&&(null==hoverWidget||hoverWidget.dispose(),hoverWidget=void 0),disposePreparation&&(null==hoverPreparation||hoverPreparation.dispose(),hoverPreparation=void 0),null===(_a=hoverDelegate.onDidHideHover)||void 0===_a||_a.call(hoverDelegate)},triggerShowHover=(delay,focus,target)=>new async_1.TimeoutTimer((()=>__awaiter(this,void 0,void 0,(function*(){hoverWidget&&!hoverWidget.isDisposed||(hoverWidget=new UpdatableHoverWidget(hoverDelegate,target||htmlElement,delay>0),yield hoverWidget.update(content,focus))}))),delay),mouseOverDomEmitter=dom.addDisposableListener(htmlElement,dom.EventType.MOUSE_OVER,(()=>{if(hoverPreparation)return;const toDispose=new lifecycle_1.DisposableStore;toDispose.add(dom.addDisposableListener(htmlElement,dom.EventType.MOUSE_LEAVE,(e=>hideHover(!1,e.fromElement===htmlElement)),!0));toDispose.add(dom.addDisposableListener(htmlElement,dom.EventType.MOUSE_DOWN,(()=>hideHover(!0,!0)),!0));const target={targetElements:[htmlElement],dispose:()=>{}};if(void 0===hoverDelegate.placement||"mouse"===hoverDelegate.placement){const onMouseMove=e=>target.x=e.x+10;toDispose.add(dom.addDisposableListener(htmlElement,dom.EventType.MOUSE_MOVE,onMouseMove,!0))}toDispose.add(triggerShowHover(hoverDelegate.delay,!1,target)),hoverPreparation=toDispose}),!0);return{show:focus=>{hideHover(!1,!0),triggerShowHover(0,focus)},hide:()=>{hideHover(!0,!0)},update:newContent=>__awaiter(this,void 0,void 0,(function*(){content=newContent,yield null==hoverWidget?void 0:hoverWidget.update(content)})),dispose:()=>{mouseOverDomEmitter.dispose(),hideHover(!0,!0)}}}})),define(__m[195],__M([1,0,7,220,483,2,40,139,340]),(function(require,exports,dom,highlightedLabel_1,iconLabelHover_1,lifecycle_1,objects_1,range_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IconLabel=void 0;class FastLabelNode{constructor(_element){this._element=_element}get element(){return this._element}set textContent(content){this.disposed||content===this._textContent||(this._textContent=content,this._element.textContent=content)}set className(className){this.disposed||className===this._className||(this._className=className,this._element.className=className)}set empty(empty){this.disposed||empty===this._empty||(this._empty=empty,this._element.style.marginLeft=empty?"0":"")}dispose(){this.disposed=!0}}class IconLabel extends lifecycle_1.Disposable{constructor(container,options){super(),this.customHovers=new Map,this.domNode=this._register(new FastLabelNode(dom.append(container,dom.$(".monaco-icon-label")))),this.labelContainer=dom.append(this.domNode.element,dom.$(".monaco-icon-label-container"));const nameContainer=dom.append(this.labelContainer,dom.$("span.monaco-icon-name-container"));this.descriptionContainer=this._register(new FastLabelNode(dom.append(this.labelContainer,dom.$("span.monaco-icon-description-container")))),(null==options?void 0:options.supportHighlights)||(null==options?void 0:options.supportIcons)?this.nameNode=new LabelWithHighlights(nameContainer,!!options.supportIcons):this.nameNode=new Label(nameContainer),(null==options?void 0:options.supportDescriptionHighlights)?this.descriptionNodeFactory=()=>new highlightedLabel_1.HighlightedLabel(dom.append(this.descriptionContainer.element,dom.$("span.label-description")),{supportIcons:!!options.supportIcons}):this.descriptionNodeFactory=()=>this._register(new FastLabelNode(dom.append(this.descriptionContainer.element,dom.$("span.label-description")))),this.hoverDelegate=null==options?void 0:options.hoverDelegate}get element(){return this.domNode.element}setLabel(label,description,options){const classes=["monaco-icon-label"];options&&(options.extraClasses&&classes.push(...options.extraClasses),options.italic&&classes.push("italic"),options.strikethrough&&classes.push("strikethrough")),this.domNode.className=classes.join(" "),this.setupHover((null==options?void 0:options.descriptionTitle)?this.labelContainer:this.element,null==options?void 0:options.title),this.nameNode.setLabel(label,options),(description||this.descriptionNode)&&(this.descriptionNode||(this.descriptionNode=this.descriptionNodeFactory()),this.descriptionNode instanceof highlightedLabel_1.HighlightedLabel?(this.descriptionNode.set(description||"",options?options.descriptionMatches:void 0),this.setupHover(this.descriptionNode.element,null==options?void 0:options.descriptionTitle)):(this.descriptionNode.textContent=description||"",this.setupHover(this.descriptionNode.element,(null==options?void 0:options.descriptionTitle)||""),this.descriptionNode.empty=!description))}setupHover(htmlElement,tooltip){const previousCustomHover=this.customHovers.get(htmlElement);if(previousCustomHover&&(previousCustomHover.dispose(),this.customHovers.delete(htmlElement)),tooltip)if(this.hoverDelegate){const hoverDisposable=(0,iconLabelHover_1.setupCustomHover)(this.hoverDelegate,htmlElement,tooltip);hoverDisposable&&this.customHovers.set(htmlElement,hoverDisposable)}else(0,iconLabelHover_1.setupNativeHover)(htmlElement,tooltip);else htmlElement.removeAttribute("title")}dispose(){super.dispose();for(const disposable of this.customHovers.values())disposable.dispose();this.customHovers.clear()}}exports.IconLabel=IconLabel;class Label{constructor(container){this.container=container,this.label=void 0,this.singleLabel=void 0}setLabel(label,options){if(this.label!==label||!(0,objects_1.equals)(this.options,options))if(this.label=label,this.options=options,"string"==typeof label)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=dom.append(this.container,dom.$("a.label-name",{id:null==options?void 0:options.domId}))),this.singleLabel.textContent=label;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<label.length;i++){const l=label[i],id=(null==options?void 0:options.domId)&&`${null==options?void 0:options.domId}_${i}`;dom.append(this.container,dom.$("a.label-name",{id,"data-icon-label-count":label.length,"data-icon-label-index":i,role:"treeitem"},l)),i<label.length-1&&dom.append(this.container,dom.$("span.label-separator",void 0,(null==options?void 0:options.separator)||"/"))}}}}class LabelWithHighlights{constructor(container,supportIcons){this.container=container,this.supportIcons=supportIcons,this.label=void 0,this.singleLabel=void 0}setLabel(label,options){if(this.label!==label||!(0,objects_1.equals)(this.options,options))if(this.label=label,this.options=options,"string"==typeof label)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new highlightedLabel_1.HighlightedLabel(dom.append(this.container,dom.$("a.label-name",{id:null==options?void 0:options.domId})),{supportIcons:this.supportIcons})),this.singleLabel.set(label,null==options?void 0:options.matches,void 0,null==options?void 0:options.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const separator=(null==options?void 0:options.separator)||"/",matches=function splitMatches(labels,separator,matches){if(!matches)return;let labelStart=0;return labels.map((label=>{const labelRange={start:labelStart,end:labelStart+label.length},result=matches.map((match=>range_1.Range.intersect(labelRange,match))).filter((range=>!range_1.Range.isEmpty(range))).map((({start,end})=>({start:start-labelStart,end:end-labelStart})));return labelStart=labelRange.end+separator.length,result}))}(label,separator,null==options?void 0:options.matches);for(let i=0;i<label.length;i++){const l=label[i],m=matches?matches[i]:void 0,id=(null==options?void 0:options.domId)&&`${null==options?void 0:options.domId}_${i}`,name=dom.$("a.label-name",{id,"data-icon-label-count":label.length,"data-icon-label-index":i,role:"treeitem"});new highlightedLabel_1.HighlightedLabel(dom.append(this.container,name),{supportIcons:this.supportIcons}).set(l,m,void 0,null==options?void 0:options.labelEscapeNewLines),i<label.length-1&&dom.append(name,dom.$("span.label-separator",void 0,separator))}}}}})),define(__m[484],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/inputbox/inputBox",data)})),define(__m[485],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/keybindingLabel/keybindingLabel",data)})),define(__m[486],__M([5,6]),(function(nls,data){return nls.create("vs/base/browser/ui/tree/abstractTree",data)})),define(__m[196],__M([1,0,166,7,92,44,175,117,169,111,18,10,28,217,4,75,2,113,16,486,352]),(function(require,exports,dnd_1,dom_1,event_1,keyboardEvent_1,listView_1,listWidget_1,indexTreeModel_1,tree_1,arrays_1,async_1,codicons_1,collections_1,event_2,filters_1,lifecycle_1,numbers_1,platform_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractTree=exports.RenderIndentGuides=exports.ComposedTreeDelegate=void 0;class TreeElementsDragAndDropData extends listView_1.ElementsDragAndDropData{constructor(data){super(data.elements.map((node=>node.element))),this.data=data}}function asTreeDragAndDropData(data){return data instanceof listView_1.ElementsDragAndDropData?new TreeElementsDragAndDropData(data):data}class TreeNodeListDragAndDrop{constructor(modelProvider,dnd){this.modelProvider=modelProvider,this.dnd=dnd,this.autoExpandDisposable=lifecycle_1.Disposable.None}getDragURI(node){return this.dnd.getDragURI(node.element)}getDragLabel(nodes,originalEvent){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(nodes.map((node=>node.element)),originalEvent)}onDragStart(data,originalEvent){this.dnd.onDragStart&&this.dnd.onDragStart(asTreeDragAndDropData(data),originalEvent)}onDragOver(data,targetNode,targetIndex,originalEvent,raw=!0){const result=this.dnd.onDragOver(asTreeDragAndDropData(data),targetNode&&targetNode.element,targetIndex,originalEvent),didChangeAutoExpandNode=this.autoExpandNode!==targetNode;if(didChangeAutoExpandNode&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=targetNode),void 0===targetNode)return result;if(didChangeAutoExpandNode&&"boolean"!=typeof result&&result.autoExpand&&(this.autoExpandDisposable=(0,async_1.disposableTimeout)((()=>{const model=this.modelProvider(),ref=model.getNodeLocation(targetNode);model.isCollapsed(ref)&&model.setCollapsed(ref,!1),this.autoExpandNode=void 0}),500)),"boolean"==typeof result||!result.accept||void 0===result.bubble||result.feedback){if(!raw){return{accept:"boolean"==typeof result?result:result.accept,effect:"boolean"==typeof result?void 0:result.effect,feedback:[targetIndex]}}return result}if(1===result.bubble){const model=this.modelProvider(),ref=model.getNodeLocation(targetNode),parentRef=model.getParentNodeLocation(ref),parentNode=model.getNode(parentRef),parentIndex=parentRef&&model.getListIndex(parentRef);return this.onDragOver(data,parentNode,parentIndex,originalEvent,!1)}const model=this.modelProvider(),ref=model.getNodeLocation(targetNode),start=model.getListIndex(ref),length=model.getListRenderCount(ref);return Object.assign(Object.assign({},result),{feedback:(0,arrays_1.range)(start,start+length)})}drop(data,targetNode,targetIndex,originalEvent){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(asTreeDragAndDropData(data),targetNode&&targetNode.element,targetIndex,originalEvent)}onDragEnd(originalEvent){this.dnd.onDragEnd&&this.dnd.onDragEnd(originalEvent)}}class ComposedTreeDelegate{constructor(delegate){this.delegate=delegate}getHeight(element){return this.delegate.getHeight(element.element)}getTemplateId(element){return this.delegate.getTemplateId(element.element)}hasDynamicHeight(element){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(element.element)}setDynamicHeight(element,height){this.delegate.setDynamicHeight&&this.delegate.setDynamicHeight(element.element,height)}}var RenderIndentGuides;exports.ComposedTreeDelegate=ComposedTreeDelegate,function(RenderIndentGuides){RenderIndentGuides.None="none",RenderIndentGuides.OnHover="onHover",RenderIndentGuides.Always="always"}(RenderIndentGuides=exports.RenderIndentGuides||(exports.RenderIndentGuides={}));class EventCollection{constructor(onDidChange,_elements=[]){this._elements=_elements,this.onDidChange=event_2.Event.forEach(onDidChange,(elements=>this._elements=elements))}get elements(){return this._elements}}class TreeRenderer{constructor(renderer,modelProvider,onDidChangeCollapseState,activeNodes,options={}){this.renderer=renderer,this.modelProvider=modelProvider,this.activeNodes=activeNodes,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=TreeRenderer.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.renderedIndentGuides=new collections_1.SetMap,this.activeIndentNodes=new Set,this.indentGuidesDisposable=lifecycle_1.Disposable.None,this.disposables=new lifecycle_1.DisposableStore,this.templateId=renderer.templateId,this.updateOptions(options),event_2.Event.map(onDidChangeCollapseState,(e=>e.node))(this.onDidChangeNodeTwistieState,this,this.disposables),renderer.onDidChangeTwistieState&&renderer.onDidChangeTwistieState(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(options={}){if(void 0!==options.indent&&(this.indent=(0,numbers_1.clamp)(options.indent,0,40)),void 0!==options.renderIndentGuides){const shouldRenderIndentGuides=options.renderIndentGuides!==RenderIndentGuides.None;if(shouldRenderIndentGuides!==this.shouldRenderIndentGuides&&(this.shouldRenderIndentGuides=shouldRenderIndentGuides,this.indentGuidesDisposable.dispose(),shouldRenderIndentGuides)){const disposables=new lifecycle_1.DisposableStore;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,disposables),this.indentGuidesDisposable=disposables,this._onDidChangeActiveNodes(this.activeNodes.elements)}}void 0!==options.hideTwistiesOfChildlessElements&&(this.hideTwistiesOfChildlessElements=options.hideTwistiesOfChildlessElements)}renderTemplate(container){const el=(0,dom_1.append)(container,(0,dom_1.$)(".monaco-tl-row")),indent=(0,dom_1.append)(el,(0,dom_1.$)(".monaco-tl-indent")),twistie=(0,dom_1.append)(el,(0,dom_1.$)(".monaco-tl-twistie")),contents=(0,dom_1.append)(el,(0,dom_1.$)(".monaco-tl-contents")),templateData=this.renderer.renderTemplate(contents);return{container,indent,twistie,indentGuidesDisposable:lifecycle_1.Disposable.None,templateData}}renderElement(node,index,templateData,height){"number"==typeof height&&(this.renderedNodes.set(node,{templateData,height}),this.renderedElements.set(node.element,node));const indent=TreeRenderer.DefaultIndent+(node.depth-1)*this.indent;templateData.twistie.style.paddingLeft=`${indent}px`,templateData.indent.style.width=indent+this.indent-16+"px",this.renderTwistie(node,templateData),"number"==typeof height&&this.renderIndentGuides(node,templateData),this.renderer.renderElement(node,index,templateData.templateData,height)}disposeElement(node,index,templateData,height){templateData.indentGuidesDisposable.dispose(),this.renderer.disposeElement&&this.renderer.disposeElement(node,index,templateData.templateData,height),"number"==typeof height&&(this.renderedNodes.delete(node),this.renderedElements.delete(node.element))}disposeTemplate(templateData){this.renderer.disposeTemplate(templateData.templateData)}onDidChangeTwistieState(element){const node=this.renderedElements.get(element);node&&this.onDidChangeNodeTwistieState(node)}onDidChangeNodeTwistieState(node){const data=this.renderedNodes.get(node);data&&(this.renderTwistie(node,data.templateData),this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderIndentGuides(node,data.templateData))}renderTwistie(node,templateData){templateData.twistie.classList.remove(...codicons_1.Codicon.treeItemExpanded.classNamesArray);let twistieRendered=!1;this.renderer.renderTwistie&&(twistieRendered=this.renderer.renderTwistie(node.element,templateData.twistie)),node.collapsible&&(!this.hideTwistiesOfChildlessElements||node.visibleChildrenCount>0)?(twistieRendered||templateData.twistie.classList.add(...codicons_1.Codicon.treeItemExpanded.classNamesArray),templateData.twistie.classList.add("collapsible"),templateData.twistie.classList.toggle("collapsed",node.collapsed)):templateData.twistie.classList.remove("collapsible","collapsed"),node.collapsible?templateData.container.setAttribute("aria-expanded",String(!node.collapsed)):templateData.container.removeAttribute("aria-expanded")}renderIndentGuides(target,templateData){if((0,dom_1.clearNode)(templateData.indent),templateData.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const disposableStore=new lifecycle_1.DisposableStore,model=this.modelProvider();let node=target;for(;;){const ref=model.getNodeLocation(node),parentRef=model.getParentNodeLocation(ref);if(!parentRef)break;const parent=model.getNode(parentRef),guide=(0,dom_1.$)(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(parent)&&guide.classList.add("active"),0===templateData.indent.childElementCount?templateData.indent.appendChild(guide):templateData.indent.insertBefore(guide,templateData.indent.firstElementChild),this.renderedIndentGuides.add(parent,guide),disposableStore.add((0,lifecycle_1.toDisposable)((()=>this.renderedIndentGuides.delete(parent,guide)))),node=parent}templateData.indentGuidesDisposable=disposableStore}_onDidChangeActiveNodes(nodes){if(!this.shouldRenderIndentGuides)return;const set=new Set,model=this.modelProvider();nodes.forEach((node=>{const ref=model.getNodeLocation(node);try{const parentRef=model.getParentNodeLocation(ref);node.collapsible&&node.children.length>0&&!node.collapsed?set.add(node):parentRef&&set.add(model.getNode(parentRef))}catch(_a){}})),this.activeIndentNodes.forEach((node=>{set.has(node)||this.renderedIndentGuides.forEach(node,(line=>line.classList.remove("active")))})),set.forEach((node=>{this.activeIndentNodes.has(node)||this.renderedIndentGuides.forEach(node,(line=>line.classList.add("active")))})),this.activeIndentNodes=set}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),(0,lifecycle_1.dispose)(this.disposables)}}TreeRenderer.DefaultIndent=8;class TypeFilter{constructor(tree,keyboardNavigationLabelProvider,_filter){this.tree=tree,this.keyboardNavigationLabelProvider=keyboardNavigationLabelProvider,this._filter=_filter,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new lifecycle_1.DisposableStore,tree.onWillRefilter(this.reset,this,this.disposables)}get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set pattern(pattern){this._pattern=pattern,this._lowercasePattern=pattern.toLowerCase()}filter(element,parentVisibility){if(this._filter){const result=this._filter.filter(element,parentVisibility);if(this.tree.options.simpleKeyboardNavigation)return result;let visibility;if(visibility="boolean"==typeof result?result?1:0:(0,indexTreeModel_1.isFilterResult)(result)?(0,indexTreeModel_1.getVisibleState)(result.visibility):result,0===visibility)return!1}if(this._totalCount++,this.tree.options.simpleKeyboardNavigation||!this._pattern)return this._matchCount++,{data:filters_1.FuzzyScore.Default,visibility:!0};const label=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(element),labels=Array.isArray(label)?label:[label];for(const l of labels){const labelStr=l&&l.toString();if(void 0===labelStr)return{data:filters_1.FuzzyScore.Default,visibility:!0};const score=(0,filters_1.fuzzyScore)(this._pattern,this._lowercasePattern,0,labelStr,labelStr.toLowerCase(),0,!0);if(score)return this._matchCount++,1===labels.length?{data:score,visibility:!0}:{data:{label:labelStr,score},visibility:!0}}return this.tree.options.filterOnType?2:{data:filters_1.FuzzyScore.Default,visibility:!0}}reset(){this._totalCount=0,this._matchCount=0}dispose(){(0,lifecycle_1.dispose)(this.disposables)}}class TypeFilterController{constructor(tree,model,view,filter,keyboardNavigationDelegate){this.tree=tree,this.view=view,this.filter=filter,this.keyboardNavigationDelegate=keyboardNavigationDelegate,this._enabled=!1,this._pattern="",this._empty=!1,this._onDidChangeEmptyState=new event_2.Emitter,this.positionClassName="ne",this.automaticKeyboardNavigation=!0,this.triggered=!1,this._onDidChangePattern=new event_2.Emitter,this.enabledDisposables=new lifecycle_1.DisposableStore,this.disposables=new lifecycle_1.DisposableStore,this.domNode=(0,dom_1.$)(`.monaco-list-type-filter.${this.positionClassName}`),this.domNode.draggable=!0,this.disposables.add((0,dom_1.addDisposableListener)(this.domNode,"dragstart",(()=>this.onDragStart()))),this.messageDomNode=(0,dom_1.append)(view.getHTMLElement(),(0,dom_1.$)(".monaco-list-type-filter-message")),this.labelDomNode=(0,dom_1.append)(this.domNode,(0,dom_1.$)("span.label"));const controls=(0,dom_1.append)(this.domNode,(0,dom_1.$)(".controls"));this._filterOnType=!!tree.options.filterOnType,this.filterOnTypeDomNode=(0,dom_1.append)(controls,(0,dom_1.$)("input.filter")),this.filterOnTypeDomNode.type="checkbox",this.filterOnTypeDomNode.checked=this._filterOnType,this.filterOnTypeDomNode.tabIndex=-1,this.updateFilterOnTypeTitleAndIcon(),this.disposables.add((0,dom_1.addDisposableListener)(this.filterOnTypeDomNode,"input",(()=>this.onDidChangeFilterOnType()))),this.clearDomNode=(0,dom_1.append)(controls,(0,dom_1.$)("button.clear"+codicons_1.Codicon.treeFilterClear.cssSelector)),this.clearDomNode.tabIndex=-1,this.clearDomNode.title=(0,nls_1.localize)(0,null),this.keyboardNavigationEventFilter=tree.options.keyboardNavigationEventFilter,model.onDidSplice(this.onDidSpliceModel,this,this.disposables),this.updateOptions(tree.options)}get enabled(){return this._enabled}get pattern(){return this._pattern}get filterOnType(){return this._filterOnType}updateOptions(options){options.simpleKeyboardNavigation?this.disable():this.enable(),void 0!==options.filterOnType&&(this._filterOnType=!!options.filterOnType,this.filterOnTypeDomNode.checked=this._filterOnType,this.updateFilterOnTypeTitleAndIcon()),void 0!==options.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=options.automaticKeyboardNavigation),this.tree.refilter(),this.render(),this.automaticKeyboardNavigation||this.onEventOrInput("")}enable(){if(this._enabled)return;const onRawKeyDown=this.enabledDisposables.add(new event_1.DomEmitter(this.view.getHTMLElement(),"keydown")),onKeyDown=event_2.Event.chain(onRawKeyDown.event).filter((e=>!(0,listWidget_1.isInputElement)(e.target)||e.target===this.filterOnTypeDomNode)).filter((e=>"Dead"!==e.key&&!/^Media/.test(e.key))).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e))).filter(this.keyboardNavigationEventFilter||(()=>!0)).filter((()=>this.automaticKeyboardNavigation||this.triggered)).filter((e=>this.keyboardNavigationDelegate.mightProducePrintableCharacter(e)&&!(18===e.keyCode||16===e.keyCode||15===e.keyCode||17===e.keyCode)||(this.pattern.length>0||this.triggered)&&(9===e.keyCode||1===e.keyCode)&&!e.altKey&&!e.ctrlKey&&!e.metaKey||1===e.keyCode&&(platform_1.isMacintosh?e.altKey&&!e.metaKey:e.ctrlKey)&&!e.shiftKey)).forEach((e=>{e.stopPropagation(),e.preventDefault()})).event,onClearClick=this.enabledDisposables.add(new event_1.DomEmitter(this.clearDomNode,"click"));event_2.Event.chain(event_2.Event.any(onKeyDown,onClearClick.event)).event(this.onEventOrInput,this,this.enabledDisposables),this.filter.pattern="",this.tree.refilter(),this.render(),this._enabled=!0,this.triggered=!1}disable(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.clear(),this.tree.refilter(),this.render(),this._enabled=!1,this.triggered=!1)}onEventOrInput(e){"string"==typeof e?this.onInput(e):e instanceof MouseEvent||9===e.keyCode||1===e.keyCode&&(platform_1.isMacintosh?e.altKey:e.ctrlKey)?this.onInput(""):1===e.keyCode?this.onInput(0===this.pattern.length?"":this.pattern.substr(0,this.pattern.length-1)):this.onInput(this.pattern+e.browserEvent.key)}onInput(pattern){const container=this.view.getHTMLElement();pattern&&!this.domNode.parentElement?container.append(this.domNode):!pattern&&this.domNode.parentElement&&(this.domNode.remove(),this.tree.domFocus()),this._pattern=pattern,this._onDidChangePattern.fire(pattern),this.filter.pattern=pattern,this.tree.refilter(),pattern&&this.tree.focusNext(0,!0,void 0,(node=>!filters_1.FuzzyScore.isDefault(node.filterData)));const focus=this.tree.getFocus();if(focus.length>0){const element=focus[0];null===this.tree.getRelativeTop(element)&&this.tree.reveal(element,.5)}this.render(),pattern||(this.triggered=!1)}onDragStart(){const container=this.view.getHTMLElement(),{left}=(0,dom_1.getDomNodePagePosition)(container),containerWidth=container.clientWidth,midContainerWidth=containerWidth/2,width=this.domNode.clientWidth,disposables=new lifecycle_1.DisposableStore;let positionClassName=this.positionClassName;const updatePosition=()=>{switch(positionClassName){case"nw":this.domNode.style.top="4px",this.domNode.style.left="4px";break;case"ne":this.domNode.style.top="4px",this.domNode.style.left=containerWidth-width-6+"px"}},onDragEnd=()=>{this.positionClassName=positionClassName,this.domNode.className=`monaco-list-type-filter ${this.positionClassName}`,this.domNode.style.top="",this.domNode.style.left="",(0,lifecycle_1.dispose)(disposables)};updatePosition(),this.domNode.classList.remove(positionClassName),this.domNode.classList.add("dragging"),disposables.add((0,lifecycle_1.toDisposable)((()=>this.domNode.classList.remove("dragging")))),disposables.add((0,dom_1.addDisposableListener)(document,"dragover",(e=>(event=>{event.preventDefault();const x=event.clientX-left;event.dataTransfer&&(event.dataTransfer.dropEffect="none"),positionClassName=x<midContainerWidth?"nw":"ne",updatePosition()})(e)))),disposables.add((0,dom_1.addDisposableListener)(this.domNode,"dragend",(()=>onDragEnd()))),dnd_1.StaticDND.CurrentDragAndDropData=new dnd_1.DragAndDropData("vscode-ui"),disposables.add((0,lifecycle_1.toDisposable)((()=>dnd_1.StaticDND.CurrentDragAndDropData=void 0)))}onDidSpliceModel(){this._enabled&&0!==this.pattern.length&&(this.tree.refilter(),this.render())}onDidChangeFilterOnType(){this.tree.updateOptions({filterOnType:this.filterOnTypeDomNode.checked}),this.tree.refilter(),this.tree.domFocus(),this.render(),this.updateFilterOnTypeTitleAndIcon()}updateFilterOnTypeTitleAndIcon(){this.filterOnType?(this.filterOnTypeDomNode.classList.remove(...codicons_1.Codicon.treeFilterOnTypeOff.classNamesArray),this.filterOnTypeDomNode.classList.add(...codicons_1.Codicon.treeFilterOnTypeOn.classNamesArray),this.filterOnTypeDomNode.title=(0,nls_1.localize)(1,null)):(this.filterOnTypeDomNode.classList.remove(...codicons_1.Codicon.treeFilterOnTypeOn.classNamesArray),this.filterOnTypeDomNode.classList.add(...codicons_1.Codicon.treeFilterOnTypeOff.classNamesArray),this.filterOnTypeDomNode.title=(0,nls_1.localize)(2,null))}render(){const noMatches=this.filter.totalCount>0&&0===this.filter.matchCount;this.pattern&&this.tree.options.filterOnType&&noMatches?(this.messageDomNode.textContent=(0,nls_1.localize)(3,null),this._empty=!0):(this.messageDomNode.innerText="",this._empty=!1),this.domNode.classList.toggle("no-matches",noMatches),this.domNode.title=(0,nls_1.localize)(4,null,this.filter.matchCount,this.filter.totalCount),this.labelDomNode.textContent=this.pattern.length>16?"…"+this.pattern.substr(this.pattern.length-16):this.pattern,this._onDidChangeEmptyState.fire(this._empty)}shouldAllowFocus(node){return!(this.enabled&&this.pattern&&!this.filterOnType)||(this.filter.totalCount>0&&this.filter.matchCount<=1||!filters_1.FuzzyScore.isDefault(node.filterData))}dispose(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.dispose(),this._enabled=!1,this.triggered=!1),this._onDidChangePattern.dispose(),(0,lifecycle_1.dispose)(this.disposables)}}function asTreeMouseEvent(event){let target=tree_1.TreeMouseEventTarget.Unknown;return(0,dom_1.hasParentWithClass)(event.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?target=tree_1.TreeMouseEventTarget.Twistie:(0,dom_1.hasParentWithClass)(event.browserEvent.target,"monaco-tl-contents","monaco-tl-row")&&(target=tree_1.TreeMouseEventTarget.Element),{browserEvent:event.browserEvent,element:event.element?event.element.element:null,target}}function dfs(node,fn){fn(node),node.children.forEach((child=>dfs(child,fn)))}class Trait{constructor(getFirstViewElementWithTrait,identityProvider){this.getFirstViewElementWithTrait=getFirstViewElementWithTrait,this.identityProvider=identityProvider,this.nodes=[],this._onDidChange=new event_2.Emitter,this.onDidChange=this._onDidChange.event}get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(nodes,browserEvent){!(null==browserEvent?void 0:browserEvent.__forceEvent)&&(0,arrays_1.equals)(this.nodes,nodes)||this._set(nodes,!1,browserEvent)}_set(nodes,silent,browserEvent){if(this.nodes=[...nodes],this.elements=void 0,this._nodeSet=void 0,!silent){const that=this;this._onDidChange.fire({get elements(){return that.get()},browserEvent})}}get(){return this.elements||(this.elements=this.nodes.map((node=>node.element))),[...this.elements]}getNodes(){return this.nodes}has(node){return this.nodeSet.has(node)}onDidModelSplice({insertedNodes,deletedNodes}){if(!this.identityProvider){const set=this.createNodeSet(),visit=node=>set.delete(node);return deletedNodes.forEach((node=>dfs(node,visit))),void this.set([...set.values()])}const deletedNodesIdSet=new Set,deletedNodesVisitor=node=>deletedNodesIdSet.add(this.identityProvider.getId(node.element).toString());deletedNodes.forEach((node=>dfs(node,deletedNodesVisitor)));const insertedNodesMap=new Map,insertedNodesVisitor=node=>insertedNodesMap.set(this.identityProvider.getId(node.element).toString(),node);insertedNodes.forEach((node=>dfs(node,insertedNodesVisitor)));const nodes=[];for(const node of this.nodes){const id=this.identityProvider.getId(node.element).toString();if(deletedNodesIdSet.has(id)){const insertedNode=insertedNodesMap.get(id);insertedNode&&nodes.push(insertedNode)}else nodes.push(node)}if(this.nodes.length>0&&0===nodes.length){const node=this.getFirstViewElementWithTrait();node&&nodes.push(node)}this._set(nodes,!0)}createNodeSet(){const set=new Set;for(const node of this.nodes)set.add(node);return set}}class TreeNodeListMouseController extends listWidget_1.MouseController{constructor(list,tree){super(list),this.tree=tree}onViewPointer(e){if((0,listWidget_1.isInputElement)(e.browserEvent.target)||(0,listWidget_1.isMonacoEditor)(e.browserEvent.target))return;const node=e.element;if(!node)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const target=e.browserEvent.target,onTwistie=target.classList.contains("monaco-tl-twistie")||target.classList.contains("monaco-icon-label")&&target.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let expandOnlyOnTwistieClick=!1;if(expandOnlyOnTwistieClick="function"==typeof this.tree.expandOnlyOnTwistieClick?this.tree.expandOnlyOnTwistieClick(node.element):!!this.tree.expandOnlyOnTwistieClick,expandOnlyOnTwistieClick&&!onTwistie&&2!==e.browserEvent.detail)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&2===e.browserEvent.detail)return super.onViewPointer(e);if(node.collapsible){const model=this.tree.model,location=model.getNodeLocation(node),recursive=e.browserEvent.altKey;if(this.tree.setFocus([location]),model.setCollapsed(location,void 0,recursive),expandOnlyOnTwistieClick&&onTwistie)return}super.onViewPointer(e)}onDoubleClick(e){!e.browserEvent.target.classList.contains("monaco-tl-twistie")&&this.tree.expandOnDoubleClick&&super.onDoubleClick(e)}}class TreeNodeList extends listWidget_1.List{constructor(user,container,virtualDelegate,renderers,focusTrait,selectionTrait,anchorTrait,options){super(user,container,virtualDelegate,renderers,options),this.focusTrait=focusTrait,this.selectionTrait=selectionTrait,this.anchorTrait=anchorTrait}createMouseController(options){return new TreeNodeListMouseController(this,options.tree)}splice(start,deleteCount,elements=[]){if(super.splice(start,deleteCount,elements),0===elements.length)return;const additionalFocus=[],additionalSelection=[];let anchor;elements.forEach(((node,index)=>{this.focusTrait.has(node)&&additionalFocus.push(start+index),this.selectionTrait.has(node)&&additionalSelection.push(start+index),this.anchorTrait.has(node)&&(anchor=start+index)})),additionalFocus.length>0&&super.setFocus((0,arrays_1.distinct)([...super.getFocus(),...additionalFocus])),additionalSelection.length>0&&super.setSelection((0,arrays_1.distinct)([...super.getSelection(),...additionalSelection])),"number"==typeof anchor&&super.setAnchor(anchor)}setFocus(indexes,browserEvent,fromAPI=!1){super.setFocus(indexes,browserEvent),fromAPI||this.focusTrait.set(indexes.map((i=>this.element(i))),browserEvent)}setSelection(indexes,browserEvent,fromAPI=!1){super.setSelection(indexes,browserEvent),fromAPI||this.selectionTrait.set(indexes.map((i=>this.element(i))),browserEvent)}setAnchor(index,fromAPI=!1){super.setAnchor(index),fromAPI||(void 0===index?this.anchorTrait.set([]):this.anchorTrait.set([this.element(index)]))}}exports.AbstractTree=class AbstractTree{constructor(_user,container,delegate,renderers,_options={}){this._user=_user,this._options=_options,this.eventBufferer=new event_2.EventBufferer,this.disposables=new lifecycle_1.DisposableStore,this._onWillRefilter=new event_2.Emitter,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new event_2.Emitter;const treeDelegate=new ComposedTreeDelegate(delegate),onDidChangeCollapseStateRelay=new event_2.Relay,onDidChangeActiveNodes=new event_2.Relay,activeNodes=new EventCollection(onDidChangeActiveNodes.event);this.renderers=renderers.map((r=>new TreeRenderer(r,(()=>this.model),onDidChangeCollapseStateRelay.event,activeNodes,_options)));for(let r of this.renderers)this.disposables.add(r);let filter;_options.keyboardNavigationLabelProvider&&(filter=new TypeFilter(this,_options.keyboardNavigationLabelProvider,_options.filter),_options=Object.assign(Object.assign({},_options),{filter}),this.disposables.add(filter)),this.focus=new Trait((()=>this.view.getFocusedElements()[0]),_options.identityProvider),this.selection=new Trait((()=>this.view.getSelectedElements()[0]),_options.identityProvider),this.anchor=new Trait((()=>this.view.getAnchorElement()),_options.identityProvider),this.view=new TreeNodeList(_user,container,treeDelegate,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},function asListOptions(modelProvider,options){return options&&Object.assign(Object.assign({},options),{identityProvider:options.identityProvider&&{getId:el=>options.identityProvider.getId(el.element)},dnd:options.dnd&&new TreeNodeListDragAndDrop(modelProvider,options.dnd),multipleSelectionController:options.multipleSelectionController&&{isSelectionSingleChangeEvent:e=>options.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element})),isSelectionRangeChangeEvent:e=>options.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},accessibilityProvider:options.accessibilityProvider&&Object.assign(Object.assign({},options.accessibilityProvider),{getSetSize(node){const model=modelProvider(),ref=model.getNodeLocation(node),parentRef=model.getParentNodeLocation(ref);return model.getNode(parentRef).visibleChildrenCount},getPosInSet:node=>node.visibleChildIndex+1,isChecked:options.accessibilityProvider&&options.accessibilityProvider.isChecked?node=>options.accessibilityProvider.isChecked(node.element):void 0,getRole:options.accessibilityProvider&&options.accessibilityProvider.getRole?node=>options.accessibilityProvider.getRole(node.element):()=>"treeitem",getAriaLabel:e=>options.accessibilityProvider.getAriaLabel(e.element),getWidgetAriaLabel:()=>options.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:options.accessibilityProvider&&options.accessibilityProvider.getWidgetRole?()=>options.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:options.accessibilityProvider&&options.accessibilityProvider.getAriaLevel?node=>options.accessibilityProvider.getAriaLevel(node.element):node=>node.depth,getActiveDescendantId:options.accessibilityProvider.getActiveDescendantId&&(node=>options.accessibilityProvider.getActiveDescendantId(node.element))}),keyboardNavigationLabelProvider:options.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},options.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:node=>options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(node.element)}),enableKeyboardNavigation:options.simpleKeyboardNavigation})}((()=>this.model),_options)),{tree:this})),this.model=this.createModel(_user,this.view,_options),onDidChangeCollapseStateRelay.input=this.model.onDidChangeCollapseState;const onDidModelSplice=event_2.Event.forEach(this.model.onDidSplice,(e=>{this.eventBufferer.bufferEvents((()=>{this.focus.onDidModelSplice(e),this.selection.onDidModelSplice(e)}))}));if(onDidModelSplice((()=>null),null,this.disposables),onDidChangeActiveNodes.input=event_2.Event.chain(event_2.Event.any(onDidModelSplice,this.focus.onDidChange,this.selection.onDidChange)).debounce((()=>null),0).map((()=>{const set=new Set;for(const node of this.focus.getNodes())set.add(node);for(const node of this.selection.getNodes())set.add(node);return[...set.values()]})).event,!1!==_options.keyboardSupport){const onKeyDown=event_2.Event.chain(this.view.onKeyDown).filter((e=>!(0,listWidget_1.isInputElement)(e.target))).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e)));onKeyDown.filter((e=>15===e.keyCode)).on(this.onLeftArrow,this,this.disposables),onKeyDown.filter((e=>17===e.keyCode)).on(this.onRightArrow,this,this.disposables),onKeyDown.filter((e=>10===e.keyCode)).on(this.onSpace,this,this.disposables)}if(_options.keyboardNavigationLabelProvider){const delegate=_options.keyboardNavigationDelegate||listWidget_1.DefaultKeyboardNavigationDelegate;this.typeFilterController=new TypeFilterController(this,this.model,this.view,filter,delegate),this.focusNavigationFilter=node=>this.typeFilterController.shouldAllowFocus(node),this.disposables.add(this.typeFilterController)}this.styleElement=(0,dom_1.createStyleSheet)(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return event_2.Event.map(this.view.onMouseDblClick,asTreeMouseEvent)}get onPointer(){return event_2.Event.map(this.view.onPointer,asTreeMouseEvent)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return event_2.Event.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get expandOnDoubleClick(){return void 0===this._options.expandOnDoubleClick||this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return void 0===this._options.expandOnlyOnTwistieClick||this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}updateOptions(optionsUpdate={}){this._options=Object.assign(Object.assign({},this._options),optionsUpdate);for(const renderer of this.renderers)renderer.updateOptions(optionsUpdate);this.view.updateOptions(Object.assign(Object.assign({},this._options),{enableKeyboardNavigation:this._options.simpleKeyboardNavigation})),this.typeFilterController&&this.typeFilterController.updateOptions(this._options),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(scrollTop){this.view.scrollTop=scrollTop}domFocus(){this.view.domFocus()}layout(height,width){this.view.layout(height,width)}style(styles){const suffix=`.${this.view.domId}`,content=[];styles.treeIndentGuidesStroke&&(content.push(`.monaco-list${suffix}:hover .monaco-tl-indent > .indent-guide, .monaco-list${suffix}.always .monaco-tl-indent > .indent-guide  { border-color: ${styles.treeIndentGuidesStroke.transparent(.4)}; }`),content.push(`.monaco-list${suffix} .monaco-tl-indent > .indent-guide.active { border-color: ${styles.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=content.join("\n"),this.view.style(styles)}getParentElement(location){const parentRef=this.model.getParentNodeLocation(location);return this.model.getNode(parentRef).element}getFirstElementChild(location){return this.model.getFirstElementChild(location)}getNode(location){return this.model.getNode(location)}collapse(location,recursive=!1){return this.model.setCollapsed(location,!0,recursive)}expand(location,recursive=!1){return this.model.setCollapsed(location,!1,recursive)}isCollapsible(location){return this.model.isCollapsible(location)}setCollapsible(location,collapsible){return this.model.setCollapsible(location,collapsible)}isCollapsed(location){return this.model.isCollapsed(location)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(elements,browserEvent){const nodes=elements.map((e=>this.model.getNode(e)));this.selection.set(nodes,browserEvent);const indexes=elements.map((e=>this.model.getListIndex(e))).filter((i=>i>-1));this.view.setSelection(indexes,browserEvent,!0)}getSelection(){return this.selection.get()}setFocus(elements,browserEvent){const nodes=elements.map((e=>this.model.getNode(e)));this.focus.set(nodes,browserEvent);const indexes=elements.map((e=>this.model.getListIndex(e))).filter((i=>i>-1));this.view.setFocus(indexes,browserEvent,!0)}focusNext(n=1,loop=!1,browserEvent,filter=this.focusNavigationFilter){this.view.focusNext(n,loop,browserEvent,filter)}getFocus(){return this.focus.get()}reveal(location,relativeTop){this.model.expandTo(location);const index=this.model.getListIndex(location);-1!==index&&this.view.reveal(index,relativeTop)}getRelativeTop(location){const index=this.model.getListIndex(location);return-1===index?null:this.view.getRelativeTop(index)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const nodes=this.view.getFocusedElements();if(0===nodes.length)return;const node=nodes[0],location=this.model.getNodeLocation(node);if(!this.model.setCollapsed(location,!0)){const parentLocation=this.model.getParentNodeLocation(location);if(!parentLocation)return;const parentListIndex=this.model.getListIndex(parentLocation);this.view.reveal(parentListIndex),this.view.setFocus([parentListIndex])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const nodes=this.view.getFocusedElements();if(0===nodes.length)return;const node=nodes[0],location=this.model.getNodeLocation(node);if(!this.model.setCollapsed(location,!1)){if(!node.children.some((child=>child.visible)))return;const[focusedIndex]=this.view.getFocus(),firstChildIndex=focusedIndex+1;this.view.reveal(firstChildIndex),this.view.setFocus([firstChildIndex])}}onSpace(e){e.preventDefault(),e.stopPropagation();const nodes=this.view.getFocusedElements();if(0===nodes.length)return;const node=nodes[0],location=this.model.getNodeLocation(node),recursive=e.browserEvent.altKey;this.model.setCollapsed(location,void 0,recursive)}dispose(){(0,lifecycle_1.dispose)(this.disposables),this.view.dispose()}}})),define(__m[487],__M([1,0,196,170]),(function(require,exports,abstractTree_1,objectTreeModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataTree=void 0;class DataTree extends abstractTree_1.AbstractTree{constructor(user,container,delegate,renderers,dataSource,options={}){super(user,container,delegate,renderers,options),this.user=user,this.dataSource=dataSource,this.identityProvider=options.identityProvider}createModel(user,view,options){return new objectTreeModel_1.ObjectTreeModel(user,view,options)}}exports.DataTree=DataTree})),define(__m[269],__M([1,0,196,321,170,95,57]),(function(require,exports,abstractTree_1,compressedObjectTreeModel_1,objectTreeModel_1,decorators_1,iterator_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompressibleObjectTree=exports.ObjectTree=void 0;class ObjectTree extends abstractTree_1.AbstractTree{constructor(user,container,delegate,renderers,options={}){super(user,container,delegate,renderers,options),this.user=user}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(element,children=iterator_1.Iterable.empty(),options){this.model.setChildren(element,children,options)}rerender(element){void 0!==element?this.model.rerender(element):this.view.rerender()}hasElement(element){return this.model.has(element)}createModel(user,view,options){return new objectTreeModel_1.ObjectTreeModel(user,view,options)}}exports.ObjectTree=ObjectTree;class CompressibleRenderer{constructor(_compressedTreeNodeProvider,renderer){this._compressedTreeNodeProvider=_compressedTreeNodeProvider,this.renderer=renderer,this.templateId=renderer.templateId,renderer.onDidChangeTwistieState&&(this.onDidChangeTwistieState=renderer.onDidChangeTwistieState)}get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(container){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(container)}}renderElement(node,index,templateData,height){const compressedTreeNode=this.compressedTreeNodeProvider.getCompressedTreeNode(node.element);1===compressedTreeNode.element.elements.length?(templateData.compressedTreeNode=void 0,this.renderer.renderElement(node,index,templateData.data,height)):(templateData.compressedTreeNode=compressedTreeNode,this.renderer.renderCompressedElements(compressedTreeNode,index,templateData.data,height))}disposeElement(node,index,templateData,height){templateData.compressedTreeNode?this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(templateData.compressedTreeNode,index,templateData.data,height):this.renderer.disposeElement&&this.renderer.disposeElement(node,index,templateData.data,height)}disposeTemplate(templateData){this.renderer.disposeTemplate(templateData.data)}renderTwistie(element,twistieElement){return!!this.renderer.renderTwistie&&this.renderer.renderTwistie(element,twistieElement)}}__decorate([decorators_1.memoize],CompressibleRenderer.prototype,"compressedTreeNodeProvider",null);exports.CompressibleObjectTree=class CompressibleObjectTree extends ObjectTree{constructor(user,container,delegate,renderers,options={}){const compressedTreeNodeProvider=()=>this;super(user,container,delegate,renderers.map((r=>new CompressibleRenderer(compressedTreeNodeProvider,r))),function asObjectTreeOptions(compressedTreeNodeProvider,options){return options&&Object.assign(Object.assign({},options),{keyboardNavigationLabelProvider:options.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(e){let compressedTreeNode;try{compressedTreeNode=compressedTreeNodeProvider().getCompressedTreeNode(e)}catch(_a){return options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e)}return 1===compressedTreeNode.element.elements.length?options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e):options.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(compressedTreeNode.element.elements)}}})}(compressedTreeNodeProvider,options))}setChildren(element,children=iterator_1.Iterable.empty(),options){this.model.setChildren(element,children,options)}createModel(user,view,options){return new compressedObjectTreeModel_1.CompressibleObjectTreeModel(user,view,options)}updateOptions(optionsUpdate={}){super.updateOptions(optionsUpdate),void 0!==optionsUpdate.compressionEnabled&&this.model.setCompressionEnabled(optionsUpdate.compressionEnabled)}getCompressedTreeNode(element=null){return this.model.getCompressedTreeNode(element)}}})),define(__m[488],__M([1,0,175,196,169,269,111,10,28,13,4,57,2,19]),(function(require,exports,listView_1,abstractTree_1,indexTreeModel_1,objectTree_1,tree_1,async_1,codicons_1,errors_1,event_1,iterator_1,lifecycle_1,types_1){"use strict";function createAsyncDataTreeNode(props){return Object.assign(Object.assign({},props),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function isAncestor(ancestor,descendant){return!!descendant.parent&&(descendant.parent===ancestor||isAncestor(ancestor,descendant.parent))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CompressibleAsyncDataTree=exports.AsyncDataTree=void 0;class AsyncDataTreeNodeWrapper{constructor(node){this.node=node}get element(){return this.node.element.element}get children(){return this.node.children.map((node=>new AsyncDataTreeNodeWrapper(node)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class AsyncDataTreeRenderer{constructor(renderer,nodeMapper,onDidChangeTwistieState){this.renderer=renderer,this.nodeMapper=nodeMapper,this.onDidChangeTwistieState=onDidChangeTwistieState,this.renderedNodes=new Map,this.templateId=renderer.templateId}renderTemplate(container){return{templateData:this.renderer.renderTemplate(container)}}renderElement(node,index,templateData,height){this.renderer.renderElement(this.nodeMapper.map(node),index,templateData.templateData,height)}renderTwistie(element,twistieElement){return element.slow?(twistieElement.classList.add(...codicons_1.Codicon.treeItemLoading.classNamesArray),!0):(twistieElement.classList.remove(...codicons_1.Codicon.treeItemLoading.classNamesArray),!1)}disposeElement(node,index,templateData,height){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(node),index,templateData.templateData,height)}disposeTemplate(templateData){this.renderer.disposeTemplate(templateData.templateData)}dispose(){this.renderedNodes.clear()}}function asTreeEvent(e){return{browserEvent:e.browserEvent,elements:e.elements.map((e=>e.element))}}function asTreeMouseEvent(e){return{browserEvent:e.browserEvent,element:e.element&&e.element.element,target:e.target}}class AsyncDataTreeElementsDragAndDropData extends listView_1.ElementsDragAndDropData{constructor(data){super(data.elements.map((node=>node.element))),this.data=data}}function asAsyncDataTreeDragAndDropData(data){return data instanceof listView_1.ElementsDragAndDropData?new AsyncDataTreeElementsDragAndDropData(data):data}class AsyncDataTreeNodeListDragAndDrop{constructor(dnd){this.dnd=dnd}getDragURI(node){return this.dnd.getDragURI(node.element)}getDragLabel(nodes,originalEvent){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(nodes.map((node=>node.element)),originalEvent)}onDragStart(data,originalEvent){this.dnd.onDragStart&&this.dnd.onDragStart(asAsyncDataTreeDragAndDropData(data),originalEvent)}onDragOver(data,targetNode,targetIndex,originalEvent,raw=!0){return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(data),targetNode&&targetNode.element,targetIndex,originalEvent)}drop(data,targetNode,targetIndex,originalEvent){this.dnd.drop(asAsyncDataTreeDragAndDropData(data),targetNode&&targetNode.element,targetIndex,originalEvent)}onDragEnd(originalEvent){this.dnd.onDragEnd&&this.dnd.onDragEnd(originalEvent)}}function asObjectTreeOptions(options){return options&&Object.assign(Object.assign({},options),{collapseByDefault:!0,identityProvider:options.identityProvider&&{getId:el=>options.identityProvider.getId(el.element)},dnd:options.dnd&&new AsyncDataTreeNodeListDragAndDrop(options.dnd),multipleSelectionController:options.multipleSelectionController&&{isSelectionSingleChangeEvent:e=>options.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element})),isSelectionRangeChangeEvent:e=>options.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},accessibilityProvider:options.accessibilityProvider&&Object.assign(Object.assign({},options.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:options.accessibilityProvider.getRole?el=>options.accessibilityProvider.getRole(el.element):()=>"treeitem",isChecked:options.accessibilityProvider.isChecked?e=>{var _a;return!!(null===(_a=options.accessibilityProvider)||void 0===_a?void 0:_a.isChecked(e.element))}:void 0,getAriaLabel:e=>options.accessibilityProvider.getAriaLabel(e.element),getWidgetAriaLabel:()=>options.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:options.accessibilityProvider.getWidgetRole?()=>options.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:options.accessibilityProvider.getAriaLevel&&(node=>options.accessibilityProvider.getAriaLevel(node.element)),getActiveDescendantId:options.accessibilityProvider.getActiveDescendantId&&(node=>options.accessibilityProvider.getActiveDescendantId(node.element))}),filter:options.filter&&{filter:(e,parentVisibility)=>options.filter.filter(e.element,parentVisibility)},keyboardNavigationLabelProvider:options.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},options.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:e=>options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}),sorter:void 0,expandOnlyOnTwistieClick:void 0===options.expandOnlyOnTwistieClick?void 0:"function"!=typeof options.expandOnlyOnTwistieClick?options.expandOnlyOnTwistieClick:e=>options.expandOnlyOnTwistieClick(e.element),additionalScrollHeight:options.additionalScrollHeight})}function dfs(node,fn){fn(node),node.children.forEach((child=>dfs(child,fn)))}class AsyncDataTree{constructor(user,container,delegate,renderers,dataSource,options={}){this.user=user,this.dataSource=dataSource,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new event_1.Emitter,this._onDidChangeNodeSlowState=new event_1.Emitter,this.nodeMapper=new tree_1.WeakMapper((node=>new AsyncDataTreeNodeWrapper(node))),this.disposables=new lifecycle_1.DisposableStore,this.identityProvider=options.identityProvider,this.autoExpandSingleChildren=void 0!==options.autoExpandSingleChildren&&options.autoExpandSingleChildren,this.sorter=options.sorter,this.collapseByDefault=options.collapseByDefault,this.tree=this.createTree(user,container,delegate,renderers,options),this.root=createAsyncDataTreeNode({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}get onDidChangeFocus(){return event_1.Event.map(this.tree.onDidChangeFocus,asTreeEvent)}get onDidChangeSelection(){return event_1.Event.map(this.tree.onDidChangeSelection,asTreeEvent)}get onMouseDblClick(){return event_1.Event.map(this.tree.onMouseDblClick,asTreeMouseEvent)}get onPointer(){return event_1.Event.map(this.tree.onPointer,asTreeMouseEvent)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidDispose(){return this.tree.onDidDispose}createTree(user,container,delegate,renderers,options){const objectTreeDelegate=new abstractTree_1.ComposedTreeDelegate(delegate),objectTreeRenderers=renderers.map((r=>new AsyncDataTreeRenderer(r,this.nodeMapper,this._onDidChangeNodeSlowState.event))),objectTreeOptions=asObjectTreeOptions(options)||{};return new objectTree_1.ObjectTree(user,container,objectTreeDelegate,objectTreeRenderers,objectTreeOptions)}updateOptions(options={}){this.tree.updateOptions(options)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(scrollTop){this.tree.scrollTop=scrollTop}domFocus(){this.tree.domFocus()}layout(height,width){this.tree.layout(height,width)}style(styles){this.tree.style(styles)}getInput(){return this.root.element}setInput(input,viewState){return __awaiter(this,void 0,void 0,(function*(){this.refreshPromises.forEach((promise=>promise.cancel())),this.refreshPromises.clear(),this.root.element=input;const viewStateContext=viewState&&{viewState,focus:[],selection:[]};yield this._updateChildren(input,!0,!1,viewStateContext),viewStateContext&&(this.tree.setFocus(viewStateContext.focus),this.tree.setSelection(viewStateContext.selection)),viewState&&"number"==typeof viewState.scrollTop&&(this.scrollTop=viewState.scrollTop)}))}_updateChildren(element=this.root.element,recursive=!0,rerender=!1,viewStateContext,options){return __awaiter(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new tree_1.TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield event_1.Event.toPromise(this._onDidRender.event));const node=this.getDataNode(element);if(yield this.refreshAndRenderNode(node,recursive,viewStateContext,options),rerender)try{this.tree.rerender(node)}catch(_a){}}))}rerender(element){if(void 0===element||element===this.root.element)return void this.tree.rerender();const node=this.getDataNode(element);this.tree.rerender(node)}getNode(element=this.root.element){const dataNode=this.getDataNode(element),node=this.tree.getNode(dataNode===this.root?null:dataNode);return this.nodeMapper.map(node)}collapse(element,recursive=!1){const node=this.getDataNode(element);return this.tree.collapse(node===this.root?null:node,recursive)}expand(element,recursive=!1){return __awaiter(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new tree_1.TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield event_1.Event.toPromise(this._onDidRender.event));const node=this.getDataNode(element);if(this.tree.hasElement(node)&&!this.tree.isCollapsible(node))return!1;if(node.refreshPromise&&(yield this.root.refreshPromise,yield event_1.Event.toPromise(this._onDidRender.event)),node!==this.root&&!node.refreshPromise&&!this.tree.isCollapsed(node))return!1;const result=this.tree.expand(node===this.root?null:node,recursive);return node.refreshPromise&&(yield this.root.refreshPromise,yield event_1.Event.toPromise(this._onDidRender.event)),result}))}setSelection(elements,browserEvent){const nodes=elements.map((e=>this.getDataNode(e)));this.tree.setSelection(nodes,browserEvent)}getSelection(){return this.tree.getSelection().map((n=>n.element))}setFocus(elements,browserEvent){const nodes=elements.map((e=>this.getDataNode(e)));this.tree.setFocus(nodes,browserEvent)}getFocus(){return this.tree.getFocus().map((n=>n.element))}reveal(element,relativeTop){this.tree.reveal(this.getDataNode(element),relativeTop)}getParentElement(element){const node=this.tree.getParentElement(this.getDataNode(element));return node&&node.element}getFirstElementChild(element=this.root.element){const dataNode=this.getDataNode(element),node=this.tree.getFirstElementChild(dataNode===this.root?null:dataNode);return node&&node.element}getDataNode(element){const node=this.nodes.get(element===this.root.element?null:element);if(!node)throw new tree_1.TreeError(this.user,`Data tree node not found: ${element}`);return node}refreshAndRenderNode(node,recursive,viewStateContext,options){return __awaiter(this,void 0,void 0,(function*(){yield this.refreshNode(node,recursive,viewStateContext),this.render(node,viewStateContext,options)}))}refreshNode(node,recursive,viewStateContext){return __awaiter(this,void 0,void 0,(function*(){let result;return this.subTreeRefreshPromises.forEach(((refreshPromise,refreshNode)=>{!result&&function intersects(node,other){return node===other||isAncestor(node,other)||isAncestor(other,node)}(refreshNode,node)&&(result=refreshPromise.then((()=>this.refreshNode(node,recursive,viewStateContext))))})),result||this.doRefreshSubTree(node,recursive,viewStateContext)}))}doRefreshSubTree(node,recursive,viewStateContext){return __awaiter(this,void 0,void 0,(function*(){let done;node.refreshPromise=new Promise((c=>done=c)),this.subTreeRefreshPromises.set(node,node.refreshPromise),node.refreshPromise.finally((()=>{node.refreshPromise=void 0,this.subTreeRefreshPromises.delete(node)}));try{const childrenToRefresh=yield this.doRefreshNode(node,recursive,viewStateContext);node.stale=!1,yield async_1.Promises.settled(childrenToRefresh.map((child=>this.doRefreshSubTree(child,recursive,viewStateContext))))}finally{done()}}))}doRefreshNode(node,recursive,viewStateContext){return __awaiter(this,void 0,void 0,(function*(){let childrenPromise;if(node.hasChildren=!!this.dataSource.hasChildren(node.element),node.hasChildren){const children=this.doGetChildren(node);if((0,types_1.isIterable)(children))childrenPromise=Promise.resolve(children);else{const slowTimeout=(0,async_1.timeout)(800);slowTimeout.then((()=>{node.slow=!0,this._onDidChangeNodeSlowState.fire(node)}),(_=>null)),childrenPromise=children.finally((()=>slowTimeout.cancel()))}}else childrenPromise=Promise.resolve(iterator_1.Iterable.empty());try{const children=yield childrenPromise;return this.setChildren(node,children,recursive,viewStateContext)}catch(err){if(node!==this.root&&this.tree.hasElement(node)&&this.tree.collapse(node),(0,errors_1.isCancellationError)(err))return[];throw err}finally{node.slow&&(node.slow=!1,this._onDidChangeNodeSlowState.fire(node))}}))}doGetChildren(node){let result=this.refreshPromises.get(node);if(result)return result;const children=this.dataSource.getChildren(node.element);return(0,types_1.isIterable)(children)?this.processChildren(children):(result=(0,async_1.createCancelablePromise)((()=>__awaiter(this,void 0,void 0,(function*(){return this.processChildren(yield children)})))),this.refreshPromises.set(node,result),result.finally((()=>{this.refreshPromises.delete(node)})))}_onDidChangeCollapseState({node,deep}){null!==node.element&&!node.collapsed&&node.element.stale&&(deep?this.collapse(node.element.element):this.refreshAndRenderNode(node.element,!1).catch(errors_1.onUnexpectedError))}setChildren(node,childrenElementsIterable,recursive,viewStateContext){const childrenElements=[...childrenElementsIterable];if(0===node.children.length&&0===childrenElements.length)return[];const nodesToForget=new Map,childrenTreeNodesById=new Map;for(const child of node.children)if(nodesToForget.set(child.element,child),this.identityProvider){const collapsed=this.tree.isCollapsed(child);childrenTreeNodesById.set(child.id,{node:child,collapsed})}const childrenToRefresh=[],children=childrenElements.map((element=>{const hasChildren=!!this.dataSource.hasChildren(element);if(!this.identityProvider){const asyncDataTreeNode=createAsyncDataTreeNode({element,parent:node,hasChildren});return hasChildren&&this.collapseByDefault&&!this.collapseByDefault(element)&&(asyncDataTreeNode.collapsedByDefault=!1,childrenToRefresh.push(asyncDataTreeNode)),asyncDataTreeNode}const id=this.identityProvider.getId(element).toString(),result=childrenTreeNodesById.get(id);if(result){const asyncDataTreeNode=result.node;return nodesToForget.delete(asyncDataTreeNode.element),this.nodes.delete(asyncDataTreeNode.element),this.nodes.set(element,asyncDataTreeNode),asyncDataTreeNode.element=element,asyncDataTreeNode.hasChildren=hasChildren,recursive?result.collapsed?(asyncDataTreeNode.children.forEach((node=>dfs(node,(node=>this.nodes.delete(node.element))))),asyncDataTreeNode.children.splice(0,asyncDataTreeNode.children.length),asyncDataTreeNode.stale=!0):childrenToRefresh.push(asyncDataTreeNode):hasChildren&&this.collapseByDefault&&!this.collapseByDefault(element)&&(asyncDataTreeNode.collapsedByDefault=!1,childrenToRefresh.push(asyncDataTreeNode)),asyncDataTreeNode}const childAsyncDataTreeNode=createAsyncDataTreeNode({element,parent:node,id,hasChildren});return viewStateContext&&viewStateContext.viewState.focus&&viewStateContext.viewState.focus.indexOf(id)>-1&&viewStateContext.focus.push(childAsyncDataTreeNode),viewStateContext&&viewStateContext.viewState.selection&&viewStateContext.viewState.selection.indexOf(id)>-1&&viewStateContext.selection.push(childAsyncDataTreeNode),viewStateContext&&viewStateContext.viewState.expanded&&viewStateContext.viewState.expanded.indexOf(id)>-1?childrenToRefresh.push(childAsyncDataTreeNode):hasChildren&&this.collapseByDefault&&!this.collapseByDefault(element)&&(childAsyncDataTreeNode.collapsedByDefault=!1,childrenToRefresh.push(childAsyncDataTreeNode)),childAsyncDataTreeNode}));for(const node of nodesToForget.values())dfs(node,(node=>this.nodes.delete(node.element)));for(const child of children)this.nodes.set(child.element,child);return node.children.splice(0,node.children.length,...children),node!==this.root&&this.autoExpandSingleChildren&&1===children.length&&0===childrenToRefresh.length&&(children[0].collapsedByDefault=!1,childrenToRefresh.push(children[0])),childrenToRefresh}render(node,viewStateContext,options){const children=node.children.map((node=>this.asTreeElement(node,viewStateContext))),objectTreeOptions=options&&Object.assign(Object.assign({},options),{diffIdentityProvider:options.diffIdentityProvider&&{getId:node=>options.diffIdentityProvider.getId(node.element)}});this.tree.setChildren(node===this.root?null:node,children,objectTreeOptions),node!==this.root&&this.tree.setCollapsible(node,node.hasChildren),this._onDidRender.fire()}asTreeElement(node,viewStateContext){if(node.stale)return{element:node,collapsible:node.hasChildren,collapsed:!0};let collapsed;return collapsed=!(viewStateContext&&viewStateContext.viewState.expanded&&node.id&&viewStateContext.viewState.expanded.indexOf(node.id)>-1)&&node.collapsedByDefault,node.collapsedByDefault=void 0,{element:node,children:node.hasChildren?iterator_1.Iterable.map(node.children,(child=>this.asTreeElement(child,viewStateContext))):[],collapsible:node.hasChildren,collapsed}}processChildren(children){return this.sorter&&(children=[...children].sort(this.sorter.compare.bind(this.sorter))),children}dispose(){this.disposables.dispose()}}exports.AsyncDataTree=AsyncDataTree;class CompressibleAsyncDataTreeNodeWrapper{constructor(node){this.node=node}get element(){return{elements:this.node.element.elements.map((e=>e.element)),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map((node=>new CompressibleAsyncDataTreeNodeWrapper(node)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class CompressibleAsyncDataTreeRenderer{constructor(renderer,nodeMapper,compressibleNodeMapperProvider,onDidChangeTwistieState){this.renderer=renderer,this.nodeMapper=nodeMapper,this.compressibleNodeMapperProvider=compressibleNodeMapperProvider,this.onDidChangeTwistieState=onDidChangeTwistieState,this.renderedNodes=new Map,this.disposables=[],this.templateId=renderer.templateId}renderTemplate(container){return{templateData:this.renderer.renderTemplate(container)}}renderElement(node,index,templateData,height){this.renderer.renderElement(this.nodeMapper.map(node),index,templateData.templateData,height)}renderCompressedElements(node,index,templateData,height){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(node),index,templateData.templateData,height)}renderTwistie(element,twistieElement){return element.slow?(twistieElement.classList.add(...codicons_1.Codicon.treeItemLoading.classNamesArray),!0):(twistieElement.classList.remove(...codicons_1.Codicon.treeItemLoading.classNamesArray),!1)}disposeElement(node,index,templateData,height){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(node),index,templateData.templateData,height)}disposeCompressedElements(node,index,templateData,height){this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(node),index,templateData.templateData,height)}disposeTemplate(templateData){this.renderer.disposeTemplate(templateData.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=(0,lifecycle_1.dispose)(this.disposables)}}exports.CompressibleAsyncDataTree=class CompressibleAsyncDataTree extends AsyncDataTree{constructor(user,container,virtualDelegate,compressionDelegate,renderers,dataSource,options={}){super(user,container,virtualDelegate,renderers,dataSource,options),this.compressionDelegate=compressionDelegate,this.compressibleNodeMapper=new tree_1.WeakMapper((node=>new CompressibleAsyncDataTreeNodeWrapper(node))),this.filter=options.filter}createTree(user,container,delegate,renderers,options){const objectTreeDelegate=new abstractTree_1.ComposedTreeDelegate(delegate),objectTreeRenderers=renderers.map((r=>new CompressibleAsyncDataTreeRenderer(r,this.nodeMapper,(()=>this.compressibleNodeMapper),this._onDidChangeNodeSlowState.event))),objectTreeOptions=function asCompressibleObjectTreeOptions(options){const objectTreeOptions=options&&asObjectTreeOptions(options);return objectTreeOptions&&Object.assign(Object.assign({},objectTreeOptions),{keyboardNavigationLabelProvider:objectTreeOptions.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},objectTreeOptions.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel:els=>options.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(els.map((e=>e.element)))})})}(options)||{};return new objectTree_1.CompressibleObjectTree(user,container,objectTreeDelegate,objectTreeRenderers,objectTreeOptions)}asTreeElement(node,viewStateContext){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(node.element)},super.asTreeElement(node,viewStateContext))}updateOptions(options={}){this.tree.updateOptions(options)}render(node,viewStateContext){if(!this.identityProvider)return super.render(node,viewStateContext);const getId=element=>this.identityProvider.getId(element).toString(),getUncompressedIds=nodes=>{const result=new Set;for(const node of nodes){const compressedNode=this.tree.getCompressedTreeNode(node===this.root?null:node);if(compressedNode.element)for(const node of compressedNode.element.elements)result.add(getId(node.element))}return result},oldSelection=getUncompressedIds(this.tree.getSelection()),oldFocus=getUncompressedIds(this.tree.getFocus());super.render(node,viewStateContext);const selection=this.getSelection();let didChangeSelection=!1;const focus=this.getFocus();let didChangeFocus=!1;const visit=node=>{const compressedNode=node.element;if(compressedNode)for(let i=0;i<compressedNode.elements.length;i++){const id=getId(compressedNode.elements[i].element),element=compressedNode.elements[compressedNode.elements.length-1].element;oldSelection.has(id)&&-1===selection.indexOf(element)&&(selection.push(element),didChangeSelection=!0),oldFocus.has(id)&&-1===focus.indexOf(element)&&(focus.push(element),didChangeFocus=!0)}node.children.forEach(visit)};visit(this.tree.getCompressedTreeNode(node===this.root?null:node)),didChangeSelection&&this.setSelection(selection),didChangeFocus&&this.setFocus(focus)}processChildren(children){return this.filter&&(children=iterator_1.Iterable.filter(children,(e=>{const visibility=function getVisibility(filterResult){return"boolean"==typeof filterResult?filterResult?1:0:(0,indexTreeModel_1.isFilterResult)(filterResult)?(0,indexTreeModel_1.getVisibleState)(filterResult.visibility):(0,indexTreeModel_1.getVisibleState)(filterResult)}(this.filter.filter(e,1));if(2===visibility)throw new Error("Recursive tree visibility not supported in async data compressed trees");return 1===visibility}))),super.processChildren(children)}}})),define(__m[489],__M([5,6]),(function(nls,data){return nls.create("vs/base/common/actions",data)})),define(__m[47],__M([1,0,4,2,489]),(function(require,exports,event_1,lifecycle_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmptySubmenuAction=exports.SubmenuAction=exports.Separator=exports.ActionRunner=exports.Action=void 0;class Action extends lifecycle_1.Disposable{constructor(id,label="",cssClass="",enabled=!0,actionCallback){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=id,this._label=label,this._cssClass=cssClass,this._enabled=enabled,this._actionCallback=actionCallback}get id(){return this._id}get label(){return this._label}set label(value){this._setLabel(value)}_setLabel(value){this._label!==value&&(this._label=value,this._onDidChange.fire({label:value}))}get tooltip(){return this._tooltip||""}set tooltip(value){this._setTooltip(value)}_setTooltip(value){this._tooltip!==value&&(this._tooltip=value,this._onDidChange.fire({tooltip:value}))}get class(){return this._cssClass}set class(value){this._setClass(value)}_setClass(value){this._cssClass!==value&&(this._cssClass=value,this._onDidChange.fire({class:value}))}get enabled(){return this._enabled}set enabled(value){this._setEnabled(value)}_setEnabled(value){this._enabled!==value&&(this._enabled=value,this._onDidChange.fire({enabled:value}))}get checked(){return this._checked}set checked(value){this._setChecked(value)}_setChecked(value){this._checked!==value&&(this._checked=value,this._onDidChange.fire({checked:value}))}run(event,data){return __awaiter(this,void 0,void 0,(function*(){this._actionCallback&&(yield this._actionCallback(event))}))}}exports.Action=Action;class ActionRunner extends lifecycle_1.Disposable{constructor(){super(...arguments),this._onBeforeRun=this._register(new event_1.Emitter),this.onBeforeRun=this._onBeforeRun.event,this._onDidRun=this._register(new event_1.Emitter),this.onDidRun=this._onDidRun.event}run(action,context){return __awaiter(this,void 0,void 0,(function*(){if(!action.enabled)return;let error;this._onBeforeRun.fire({action});try{yield this.runAction(action,context)}catch(e){error=e}this._onDidRun.fire({action,error})}))}runAction(action,context){return __awaiter(this,void 0,void 0,(function*(){yield action.run(context)}))}}exports.ActionRunner=ActionRunner;class Separator extends Action{constructor(label){super(Separator.ID,label,label?"separator text":"separator"),this.checked=!1,this.enabled=!1}}exports.Separator=Separator,Separator.ID="vs.actions.separator";exports.SubmenuAction=class SubmenuAction{constructor(id,label,actions,cssClass){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=id,this.label=label,this.class=cssClass,this._actions=actions}get actions(){return this._actions}dispose(){}run(){return __awaiter(this,void 0,void 0,(function*(){}))}};class EmptySubmenuAction extends Action{constructor(){super(EmptySubmenuAction.ID,nls.localize(0,null),void 0,!1)}}exports.EmptySubmenuAction=EmptySubmenuAction,EmptySubmenuAction.ID="vs.actions.empty"})),define(__m[128],__M([1,0,34,166,7,60,47,2,16,19,478,224]),(function(require,exports,browser_1,dnd_1,dom_1,touch_1,actions_1,lifecycle_1,platform,types,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionViewItem=exports.BaseActionViewItem=void 0;class BaseActionViewItem extends lifecycle_1.Disposable{constructor(context,action,options={}){super(),this.options=options,this._context=context||this,this._action=action,action instanceof actions_1.Action&&this._register(action.onDidChange((event=>{this.element&&this.handleActionChangeEvent(event)})))}handleActionChangeEvent(event){void 0!==event.enabled&&this.updateEnabled(),void 0!==event.checked&&this.updateChecked(),void 0!==event.class&&this.updateClass(),void 0!==event.label&&(this.updateLabel(),this.updateTooltip()),void 0!==event.tooltip&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new actions_1.ActionRunner)),this._actionRunner}set actionRunner(actionRunner){this._actionRunner=actionRunner}getAction(){return this._action}isEnabled(){return this._action.enabled}setActionContext(newContext){this._context=newContext}render(container){const element=this.element=container;this._register(touch_1.Gesture.addTarget(container));const enableDragging=this.options&&this.options.draggable;enableDragging&&(container.draggable=!0,browser_1.isFirefox&&this._register((0,dom_1.addDisposableListener)(container,dom_1.EventType.DRAG_START,(e=>{var _a;return null===(_a=e.dataTransfer)||void 0===_a?void 0:_a.setData(dnd_1.DataTransfers.TEXT,this._action.label)})))),this._register((0,dom_1.addDisposableListener)(element,touch_1.EventType.Tap,(e=>this.onClick(e,!0)))),this._register((0,dom_1.addDisposableListener)(element,dom_1.EventType.MOUSE_DOWN,(e=>{enableDragging||dom_1.EventHelper.stop(e,!0),this._action.enabled&&0===e.button&&element.classList.add("active")}))),platform.isMacintosh&&this._register((0,dom_1.addDisposableListener)(element,dom_1.EventType.CONTEXT_MENU,(e=>{0===e.button&&!0===e.ctrlKey&&this.onClick(e)}))),this._register((0,dom_1.addDisposableListener)(element,dom_1.EventType.CLICK,(e=>{dom_1.EventHelper.stop(e,!0),this.options&&this.options.isMenu||this.onClick(e)}))),this._register((0,dom_1.addDisposableListener)(element,dom_1.EventType.DBLCLICK,(e=>{dom_1.EventHelper.stop(e,!0)}))),[dom_1.EventType.MOUSE_UP,dom_1.EventType.MOUSE_OUT].forEach((event=>{this._register((0,dom_1.addDisposableListener)(element,event,(e=>{dom_1.EventHelper.stop(e),element.classList.remove("active")})))}))}onClick(event,preserveFocus=!1){var _a;dom_1.EventHelper.stop(event,!0);const context=types.isUndefinedOrNull(this._context)?(null===(_a=this.options)||void 0===_a?void 0:_a.useEventAsContext)?event:{preserveFocus}:this._context;this.actionRunner.run(this._action,context)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(focusable){this.element&&(this.element.tabIndex=focusable?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}updateTooltip(){}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),super.dispose()}}exports.BaseActionViewItem=BaseActionViewItem;exports.ActionViewItem=class ActionViewItem extends BaseActionViewItem{constructor(context,action,options={}){super(context,action,options),this.options=options,this.options.icon=void 0!==options.icon&&options.icon,this.options.label=void 0===options.label||options.label,this.cssClass=""}render(container){super.render(container),this.element&&(this.label=(0,dom_1.append)(this.element,(0,dom_1.$)("a.action-label"))),this.label&&(this._action.id===actions_1.Separator.ID?this.label.setAttribute("role","presentation"):this.options.isMenu?this.label.setAttribute("role","menuitem"):this.label.setAttribute("role","button")),this.options.label&&this.options.keybinding&&this.element&&((0,dom_1.append)(this.element,(0,dom_1.$)("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(focusable){this.label&&(this.label.tabIndex=focusable?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.getAction().label)}updateTooltip(){let title=null;this.getAction().tooltip?title=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(title=this.getAction().label,this.options.keybinding&&(title=nls.localize(0,null,title,this.options.keybinding))),title&&this.label&&(this.label.title=title)}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getAction().class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label&&this.label.classList.remove("codicon")}updateEnabled(){this.getAction().enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element&&this.element.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element&&this.element.classList.add("disabled"))}updateChecked(){this.label&&(this.getAction().checked?this.label.classList.add("checked"):this.label.classList.remove("checked"))}}})),define(__m[87],__M([1,0,7,44,128,47,4,2,19,224]),(function(require,exports,DOM,keyboardEvent_1,actionViewItems_1,actions_1,event_1,lifecycle_1,types){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionBar=void 0;class ActionBar extends lifecycle_1.Disposable{constructor(container,options={}){var _a,_b,_c,_d,_e,_f;let previousKeys,nextKeys;switch(super(),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new event_1.Emitter),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new event_1.Emitter({onFirstListenerAdd:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new event_1.Emitter),this.onDidRun=this._onDidRun.event,this._onBeforeRun=this._register(new event_1.Emitter),this.onBeforeRun=this._onBeforeRun.event,this.options=options,this._context=null!==(_a=options.context)&&void 0!==_a?_a:null,this._orientation=null!==(_b=this.options.orientation)&&void 0!==_b?_b:0,this._triggerKeys={keyDown:null!==(_d=null===(_c=this.options.triggerKeys)||void 0===_c?void 0:_c.keyDown)&&void 0!==_d&&_d,keys:null!==(_f=null===(_e=this.options.triggerKeys)||void 0===_e?void 0:_e.keys)&&void 0!==_f?_f:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new actions_1.ActionRunner,this._register(this._actionRunner)),this._register(this._actionRunner.onDidRun((e=>this._onDidRun.fire(e)))),this._register(this._actionRunner.onBeforeRun((e=>this._onBeforeRun.fire(e)))),this._actionIds=[],this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",!1!==options.animated&&this.domNode.classList.add("animated"),this._orientation){case 0:previousKeys=[15],nextKeys=[17];break;case 1:previousKeys=[16],nextKeys=[18],this.domNode.className+=" vertical"}this._register(DOM.addDisposableListener(this.domNode,DOM.EventType.KEY_DOWN,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);let eventHandled=!0;const focusedItem="number"==typeof this.focusedItem?this.viewItems[this.focusedItem]:void 0;previousKeys&&(event.equals(previousKeys[0])||event.equals(previousKeys[1]))?eventHandled=this.focusPrevious():nextKeys&&(event.equals(nextKeys[0])||event.equals(nextKeys[1]))?eventHandled=this.focusNext():event.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():event.equals(14)?eventHandled=this.focusFirst():event.equals(13)?eventHandled=this.focusLast():event.equals(2)&&focusedItem instanceof actionViewItems_1.BaseActionViewItem&&focusedItem.trapsArrowNavigation?eventHandled=this.focusNext():this.isTriggerKeyEvent(event)?this._triggerKeys.keyDown?this.doTrigger(event):this.triggerKeyDown=!0:eventHandled=!1,eventHandled&&(event.preventDefault(),event.stopPropagation())}))),this._register(DOM.addDisposableListener(this.domNode,DOM.EventType.KEY_UP,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);this.isTriggerKeyEvent(event)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(event)),event.preventDefault(),event.stopPropagation()):(event.equals(2)||event.equals(1026))&&this.updateFocusedItem()}))),this.focusTracker=this._register(DOM.trackFocus(this.domNode)),this._register(this.focusTracker.onDidBlur((()=>{DOM.getActiveElement()!==this.domNode&&DOM.isAncestor(DOM.getActiveElement(),this.domNode)||(this._onDidBlur.fire(),this.focusedItem=void 0,this.previouslyFocusedItem=void 0,this.triggerKeyDown=!1)}))),this._register(this.focusTracker.onDidFocus((()=>this.updateFocusedItem()))),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),container.appendChild(this.domNode)}refreshRole(){this.length()>=2?this.actionsList.setAttribute("role","toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(focusable){if(this.focusable=focusable,this.focusable){const firstEnabled=this.viewItems.find((vi=>vi instanceof actionViewItems_1.BaseActionViewItem&&vi.isEnabled()));firstEnabled instanceof actionViewItems_1.BaseActionViewItem&&firstEnabled.setFocusable(!0)}else this.viewItems.forEach((vi=>{vi instanceof actionViewItems_1.BaseActionViewItem&&vi.setFocusable(!1)}))}isTriggerKeyEvent(event){let ret=!1;return this._triggerKeys.keys.forEach((keyCode=>{ret=ret||event.equals(keyCode)})),ret}updateFocusedItem(){for(let i=0;i<this.actionsList.children.length;i++){const elem=this.actionsList.children[i];if(DOM.isAncestor(DOM.getActiveElement(),elem)){this.focusedItem=i;break}}}get context(){return this._context}set context(context){this._context=context,this.viewItems.forEach((i=>i.setActionContext(context)))}get actionRunner(){return this._actionRunner}set actionRunner(actionRunner){actionRunner&&(this._actionRunner=actionRunner,this.viewItems.forEach((item=>item.actionRunner=actionRunner)))}getContainer(){return this.domNode}push(arg,options={}){const actions=Array.isArray(arg)?arg:[arg];let index=types.isNumber(options.index)?options.index:null;actions.forEach((action=>{const actionViewItemElement=document.createElement("li");let item;actionViewItemElement.className="action-item",actionViewItemElement.setAttribute("role","presentation"),this.options.allowContextMenu||this._register(DOM.addDisposableListener(actionViewItemElement,DOM.EventType.CONTEXT_MENU,(e=>{DOM.EventHelper.stop(e,!0)}))),this.options.actionViewItemProvider&&(item=this.options.actionViewItemProvider(action)),item||(item=new actionViewItems_1.ActionViewItem(this.context,action,options)),item.actionRunner=this._actionRunner,item.setActionContext(this.context),item.render(actionViewItemElement),this.focusable&&item instanceof actionViewItems_1.BaseActionViewItem&&0===this.viewItems.length&&item.setFocusable(!0),null===index||index<0||index>=this.actionsList.children.length?(this.actionsList.appendChild(actionViewItemElement),this.viewItems.push(item),this._actionIds.push(action.id)):(this.actionsList.insertBefore(actionViewItemElement,this.actionsList.children[index]),this.viewItems.splice(index,0,item),this._actionIds.splice(index,0,action.id),index++)})),"number"==typeof this.focusedItem&&this.focus(this.focusedItem),this.refreshRole()}clear(){(0,lifecycle_1.dispose)(this.viewItems),this.viewItems=[],this._actionIds=[],DOM.clearNode(this.actionsList),this.refreshRole()}length(){return this.viewItems.length}focus(arg){let index,selectFirst=!1;if(void 0===arg?selectFirst=!0:"number"==typeof arg?index=arg:"boolean"==typeof arg&&(selectFirst=arg),selectFirst&&void 0===this.focusedItem){const firstEnabled=this.viewItems.findIndex((item=>item.isEnabled()));this.focusedItem=-1===firstEnabled?void 0:firstEnabled,this.updateFocus(void 0,void 0,!0)}else void 0!==index&&(this.focusedItem=index),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(forceLoop){if(void 0===this.focusedItem)this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const startIndex=this.focusedItem;let item;do{if(!forceLoop&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=startIndex,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,item=this.viewItems[this.focusedItem]}while(this.focusedItem!==startIndex&&this.options.focusOnlyEnabledItems&&!item.isEnabled());return this.updateFocus(),!0}focusPrevious(forceLoop){if(void 0===this.focusedItem)this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const startIndex=this.focusedItem;let item;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!forceLoop&&this.options.preventLoopNavigation)return this.focusedItem=startIndex,!1;this.focusedItem=this.viewItems.length-1}item=this.viewItems[this.focusedItem]}while(this.focusedItem!==startIndex&&this.options.focusOnlyEnabledItems&&!item.isEnabled());return this.updateFocus(!0),!0}updateFocus(fromRight,preventScroll,forceFocus=!1){var _a;void 0===this.focusedItem&&this.actionsList.focus({preventScroll}),void 0!==this.previouslyFocusedItem&&this.previouslyFocusedItem!==this.focusedItem&&(null===(_a=this.viewItems[this.previouslyFocusedItem])||void 0===_a||_a.blur());const actionViewItem=void 0!==this.focusedItem&&this.viewItems[this.focusedItem];if(actionViewItem){let focusItem=!0;types.isFunction(actionViewItem.focus)||(focusItem=!1),this.options.focusOnlyEnabledItems&&types.isFunction(actionViewItem.isEnabled)&&!actionViewItem.isEnabled()&&(focusItem=!1),focusItem?(forceFocus||this.previouslyFocusedItem!==this.focusedItem)&&(actionViewItem.focus(fromRight),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll}),this.previouslyFocusedItem=void 0)}}doTrigger(event){if(void 0===this.focusedItem)return;const actionViewItem=this.viewItems[this.focusedItem];if(actionViewItem instanceof actionViewItems_1.BaseActionViewItem){const context=null===actionViewItem._context||void 0===actionViewItem._context?event:actionViewItem._context;this.run(actionViewItem._action,context)}}run(action,context){return __awaiter(this,void 0,void 0,(function*(){yield this._actionRunner.run(action,context)}))}dispose(){(0,lifecycle_1.dispose)(this.viewItems),this.viewItems=[],this._actionIds=[],this.getContainer().remove(),super.dispose()}}exports.ActionBar=ActionBar})),define(__m[490],__M([1,0,7,44,60,47,4,227]),(function(require,exports,dom_1,keyboardEvent_1,touch_1,actions_1,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropdownMenu=exports.BaseDropdown=void 0;class BaseDropdown extends actions_1.ActionRunner{constructor(container,options){super(),this._onDidChangeVisibility=this._register(new event_1.Emitter),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=(0,dom_1.append)(container,(0,dom_1.$)(".monaco-dropdown")),this._label=(0,dom_1.append)(this._element,(0,dom_1.$)(".dropdown-label"));let labelRenderer=options.labelRenderer;labelRenderer||(labelRenderer=container=>(container.textContent=options.label||"",null));for(const event of[dom_1.EventType.CLICK,dom_1.EventType.MOUSE_DOWN,touch_1.EventType.Tap])this._register((0,dom_1.addDisposableListener)(this.element,event,(e=>dom_1.EventHelper.stop(e,!0))));for(const event of[dom_1.EventType.MOUSE_DOWN,touch_1.EventType.Tap])this._register((0,dom_1.addDisposableListener)(this._label,event,(e=>{e instanceof MouseEvent&&e.detail>1||(this.visible?this.hide():this.show())})));this._register((0,dom_1.addDisposableListener)(this._label,dom_1.EventType.KEY_UP,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);(event.equals(3)||event.equals(10))&&(dom_1.EventHelper.stop(e,!0),this.visible?this.hide():this.show())})));const cleanupFn=labelRenderer(this._label);cleanupFn&&this._register(cleanupFn),this._register(touch_1.Gesture.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}exports.BaseDropdown=BaseDropdown;exports.DropdownMenu=class DropdownMenu extends BaseDropdown{constructor(container,options){super(container,options),this._actions=[],this._contextMenuProvider=options.contextMenuProvider,this.actions=options.actions||[],this.actionProvider=options.actionProvider,this.menuClassName=options.menuClassName||"",this.menuAsChild=!!options.menuAsChild}set menuOptions(options){this._menuOptions=options}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(actions){this._actions=actions}show(){super.show(),this.element.classList.add("active"),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:action=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(action):void 0,getKeyBinding:action=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(action):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}})),define(__m[491],__M([1,0,7,128,490,4,227]),(function(require,exports,dom_1,actionViewItems_1,dropdown_1,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropdownMenuActionViewItem=void 0;class DropdownMenuActionViewItem extends actionViewItems_1.BaseActionViewItem{constructor(action,menuActionsOrProvider,contextMenuProvider,options=Object.create(null)){super(null,action,options),this.actionItem=null,this._onDidChangeVisibility=this._register(new event_1.Emitter),this.menuActionsOrProvider=menuActionsOrProvider,this.contextMenuProvider=contextMenuProvider,this.options=options,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(container){this.actionItem=container;const isActionsArray=Array.isArray(this.menuActionsOrProvider),options={contextMenuProvider:this.contextMenuProvider,labelRenderer:el=>{this.element=(0,dom_1.append)(el,(0,dom_1.$)("a.action-label"));let classNames=[];return"string"==typeof this.options.classNames?classNames=this.options.classNames.split(/\s+/g).filter((s=>!!s)):this.options.classNames&&(classNames=this.options.classNames),classNames.find((c=>"icon"===c))||classNames.push("codicon"),this.element.classList.add(...classNames),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",null},menuAsChild:this.options.menuAsChild,actions:isActionsArray?this.menuActionsOrProvider:void 0,actionProvider:isActionsArray?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new dropdown_1.DropdownMenu(container,options)),this._register(this.dropdownMenu.onDidChangeVisibility((visible=>{var _a;null===(_a=this.element)||void 0===_a||_a.setAttribute("aria-expanded",`${visible}`),this._onDidChangeVisibility.fire(visible)}))),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const that=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return that.options.anchorAlignmentProvider()}})}this.updateEnabled()}setActionContext(newContext){super.setActionContext(newContext),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=newContext:this.dropdownMenu.menuOptions={context:newContext})}updateEnabled(){var _a,_b;const disabled=!this.getAction().enabled;null===(_a=this.actionItem)||void 0===_a||_a.classList.toggle("disabled",disabled),null===(_b=this.element)||void 0===_b||_b.classList.toggle("disabled",disabled)}}exports.DropdownMenuActionViewItem=DropdownMenuActionViewItem})),define(__m[197],__M([1,0,7,92,171,87,46,69,62,30,4,316,40,484,341]),(function(require,exports,dom,event_1,formattedTextRenderer_1,actionbar_1,aria,scrollableElement_1,widget_1,color_1,event_2,history_1,objects_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HistoryInputBox=exports.InputBox=void 0;const $=dom.$,defaultOpts={inputBackground:color_1.Color.fromHex("#3C3C3C"),inputForeground:color_1.Color.fromHex("#CCCCCC"),inputValidationInfoBorder:color_1.Color.fromHex("#55AAFF"),inputValidationInfoBackground:color_1.Color.fromHex("#063B49"),inputValidationWarningBorder:color_1.Color.fromHex("#B89500"),inputValidationWarningBackground:color_1.Color.fromHex("#352A05"),inputValidationErrorBorder:color_1.Color.fromHex("#BE1100"),inputValidationErrorBackground:color_1.Color.fromHex("#5A1D1D")};class InputBox extends widget_1.Widget{constructor(container,contextViewProvider,options){var _a;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new event_2.Emitter),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new event_2.Emitter),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=contextViewProvider,this.options=options||Object.create(null),(0,objects_1.mixin)(this.options,defaultOpts,!1),this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=null!==(_a=this.options.tooltip)&&void 0!==_a?_a:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.inputBackground=this.options.inputBackground,this.inputForeground=this.options.inputForeground,this.inputBorder=this.options.inputBorder,this.inputValidationInfoBorder=this.options.inputValidationInfoBorder,this.inputValidationInfoBackground=this.options.inputValidationInfoBackground,this.inputValidationInfoForeground=this.options.inputValidationInfoForeground,this.inputValidationWarningBorder=this.options.inputValidationWarningBorder,this.inputValidationWarningBackground=this.options.inputValidationWarningBackground,this.inputValidationWarningForeground=this.options.inputValidationWarningForeground,this.inputValidationErrorBorder=this.options.inputValidationErrorBorder,this.inputValidationErrorBackground=this.options.inputValidationErrorBackground,this.inputValidationErrorForeground=this.options.inputValidationErrorForeground,this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=dom.append(container,$(".monaco-inputbox.idle"));let tagName=this.options.flexibleHeight?"textarea":"input",wrapper=dom.append(this.element,$(".ibwrapper"));if(this.input=dom.append(wrapper,$(tagName+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,(()=>this.element.classList.add("synthetic-focus"))),this.onblur(this.input,(()=>this.element.classList.remove("synthetic-focus"))),this.options.flexibleHeight){this.maxHeight="number"==typeof this.options.flexibleMaxHeight?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=dom.append(wrapper,$("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new scrollableElement_1.ScrollableElement(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),dom.append(container,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll((e=>this.input.scrollTop=e.scrollTop)));const onSelectionChange=this._register(new event_1.DomEmitter(document,"selectionchange")),onAnchoredSelectionChange=event_2.Event.filter(onSelectionChange.event,(()=>{const selection=document.getSelection();return(null==selection?void 0:selection.anchorNode)===wrapper}));this._register(onAnchoredSelectionChange(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,(()=>this.onValueChange())),this.onblur(this.input,(()=>this.onBlur())),this.onfocus(this.input,(()=>this.onFocus())),this.ignoreGesture(this.input),setTimeout((()=>this.updateMirror()),0),this.options.actions&&(this.actionbar=this._register(new actionbar_1.ActionBar(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(placeHolder){this.placeholder=placeHolder,this.input.setAttribute("placeholder",placeHolder)}setTooltip(tooltip){this.tooltip=tooltip,this.input.title=tooltip}setAriaLabel(label){this.ariaLabel=label,label?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get inputElement(){return this.input}get value(){return this.input.value}set value(newValue){this.input.value!==newValue&&(this.input.value=newValue,this.onValueChange())}get height(){return"number"==typeof this.cachedHeight?this.cachedHeight:dom.getTotalHeight(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(range=null){this.input.select(),range&&(this.input.setSelectionRange(range.start,range.end),range.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}get width(){return dom.getTotalWidth(this.input)}set width(width){if(this.options.flexibleHeight&&this.options.flexibleWidth){let horizontalPadding=0;if(this.mirror){horizontalPadding=(parseFloat(this.mirror.style.paddingLeft||"")||0)+(parseFloat(this.mirror.style.paddingRight||"")||0)}this.input.style.width=width-horizontalPadding+"px"}else this.input.style.width=width+"px";this.mirror&&(this.mirror.style.width=width+"px")}set paddingRight(paddingRight){this.input.style.width=`calc(100% - ${paddingRight}px)`,this.mirror&&(this.mirror.style.paddingRight=paddingRight+"px")}updateScrollDimensions(){if("number"!=typeof this.cachedContentHeight||"number"!=typeof this.cachedHeight||!this.scrollableElement)return;const scrollHeight=this.cachedContentHeight,height=this.cachedHeight,scrollTop=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight,height}),this.scrollableElement.setScrollPosition({scrollTop})}showMessage(message,force){this.message=message,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(message.type));const styles=this.stylesForType(this.message.type);this.element.style.border=styles.border?`1px solid ${styles.border}`:"",(this.hasFocus()||force)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let errorMsg=null;return this.validation&&(errorMsg=this.validation(this.value),errorMsg?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(errorMsg)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),null==errorMsg?void 0:errorMsg.type}stylesForType(type){switch(type){case 1:return{border:this.inputValidationInfoBorder,background:this.inputValidationInfoBackground,foreground:this.inputValidationInfoForeground};case 2:return{border:this.inputValidationWarningBorder,background:this.inputValidationWarningBackground,foreground:this.inputValidationWarningForeground};default:return{border:this.inputValidationErrorBorder,background:this.inputValidationErrorBackground,foreground:this.inputValidationErrorForeground}}}classForType(type){switch(type){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let div,alertText,layout=()=>div.style.width=dom.getTotalWidth(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:container=>{if(!this.message)return null;div=dom.append(container,$(".monaco-inputbox-container")),layout();const renderOptions={inline:!0,className:"monaco-inputbox-message"},spanElement=this.message.formatContent?(0,formattedTextRenderer_1.renderFormattedText)(this.message.content,renderOptions):(0,formattedTextRenderer_1.renderText)(this.message.content,renderOptions);spanElement.classList.add(this.classForType(this.message.type));const styles=this.stylesForType(this.message.type);return spanElement.style.backgroundColor=styles.background?styles.background.toString():"",spanElement.style.color=styles.foreground?styles.foreground.toString():"",spanElement.style.border=styles.border?`1px solid ${styles.border}`:"",dom.append(div,spanElement),null},onHide:()=>{this.state="closed"},layout}),alertText=3===this.message.type?nls.localize(0,null,this.message.content):2===this.message.type?nls.localize(1,null,this.message.content):nls.localize(2,null,this.message.content),aria.alert(alertText),this.state="open"}_hideMessage(){this.contextViewProvider&&("open"===this.state&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),"open"===this.state&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const value=this.value,suffix=10===value.charCodeAt(value.length-1)?" ":"";(value+suffix).replace(/\u000c/g,"")?this.mirror.textContent=value+suffix:this.mirror.innerText=" ",this.layout()}style(styles){this.inputBackground=styles.inputBackground,this.inputForeground=styles.inputForeground,this.inputBorder=styles.inputBorder,this.inputValidationInfoBackground=styles.inputValidationInfoBackground,this.inputValidationInfoForeground=styles.inputValidationInfoForeground,this.inputValidationInfoBorder=styles.inputValidationInfoBorder,this.inputValidationWarningBackground=styles.inputValidationWarningBackground,this.inputValidationWarningForeground=styles.inputValidationWarningForeground,this.inputValidationWarningBorder=styles.inputValidationWarningBorder,this.inputValidationErrorBackground=styles.inputValidationErrorBackground,this.inputValidationErrorForeground=styles.inputValidationErrorForeground,this.inputValidationErrorBorder=styles.inputValidationErrorBorder,this.applyStyles()}applyStyles(){const background=this.inputBackground?this.inputBackground.toString():"",foreground=this.inputForeground?this.inputForeground.toString():"",border=this.inputBorder?this.inputBorder.toString():"";this.element.style.backgroundColor=background,this.element.style.color=foreground,this.input.style.backgroundColor="inherit",this.input.style.color=foreground,this.element.style.borderWidth=border?"1px":"",this.element.style.borderStyle=border?"solid":"",this.element.style.borderColor=border}layout(){if(!this.mirror)return;const previousHeight=this.cachedContentHeight;this.cachedContentHeight=dom.getTotalHeight(this.mirror),previousHeight!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(text){const inputElement=this.inputElement,start=inputElement.selectionStart,end=inputElement.selectionEnd,content=inputElement.value;null!==start&&null!==end&&(this.value=content.substr(0,start)+text+content.substr(end),inputElement.setSelectionRange(start+1,start+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar&&this.actionbar.dispose(),super.dispose()}}exports.InputBox=InputBox;exports.HistoryInputBox=class HistoryInputBox extends InputBox{constructor(container,contextViewProvider,options){const NLS_PLACEHOLDER_HISTORY_HINT=nls.localize(3,null),NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX=` or ⇅ ${NLS_PLACEHOLDER_HISTORY_HINT}`,NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX_IN_PARENS=` (⇅ ${NLS_PLACEHOLDER_HISTORY_HINT})`;super(container,contextViewProvider,options),this.history=new history_1.HistoryNavigator(options.history,100);const addSuffix=()=>{if(options.showHistoryHint&&options.showHistoryHint()&&!this.placeholder.endsWith(NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX)&&!this.placeholder.endsWith(NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX_IN_PARENS)&&this.history.getHistory().length){const suffix=this.placeholder.endsWith(")")?NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX:NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX_IN_PARENS,suffixedPlaceholder=this.placeholder+suffix;options.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=suffixedPlaceholder:this.setPlaceHolder(suffixedPlaceholder)}};this.observer=new MutationObserver(((mutationList,observer)=>{mutationList.forEach((mutation=>{mutation.target.textContent||addSuffix()}))})),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,(()=>addSuffix())),this.onblur(this.input,(()=>{const resetPlaceholder=historyHint=>{if(this.placeholder.endsWith(historyHint)){const revertedPlaceholder=this.placeholder.slice(0,this.placeholder.length-historyHint.length);return options.showPlaceholderOnFocus?this.placeholder=revertedPlaceholder:this.setPlaceHolder(revertedPlaceholder),!0}return!1};resetPlaceholder(NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX_IN_PARENS)||resetPlaceholder(NLS_PLACEHOLDER_HISTORY_HINT_SUFFIX)}))}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(){this.value&&this.value!==this.getCurrentValue()&&this.history.add(this.value)}showNextValue(){this.history.has(this.value)||this.addToHistory();let next=this.getNextValue();next&&(next=next===this.value?this.getNextValue():next),next&&(this.value=next,aria.status(this.value))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let previous=this.getPreviousValue();previous&&(previous=previous===this.value?this.getPreviousValue():previous),previous&&(this.value=previous,aria.status(this.value))}getCurrentValue(){let currentValue=this.history.current();return currentValue||(currentValue=this.history.last(),this.history.next()),currentValue}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()||this.history.last()}}})),define(__m[492],__M([1,0,7,268,197,62,4,479,228]),(function(require,exports,dom,findInputCheckboxes_1,inputBox_1,widget_1,event_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindInput=void 0;const NLS_DEFAULT_LABEL=nls.localize(0,null);class FindInput extends widget_1.Widget{constructor(parent,contextViewProvider,_showOptionButtons,options){super(),this._showOptionButtons=_showOptionButtons,this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this._onDidOptionChange=this._register(new event_1.Emitter),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new event_1.Emitter),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new event_1.Emitter),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new event_1.Emitter),this._onKeyUp=this._register(new event_1.Emitter),this._onCaseSensitiveKeyDown=this._register(new event_1.Emitter),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new event_1.Emitter),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=contextViewProvider,this.placeholder=options.placeholder||"",this.validation=options.validation,this.label=options.label||NLS_DEFAULT_LABEL,this.inputActiveOptionBorder=options.inputActiveOptionBorder,this.inputActiveOptionForeground=options.inputActiveOptionForeground,this.inputActiveOptionBackground=options.inputActiveOptionBackground,this.inputBackground=options.inputBackground,this.inputForeground=options.inputForeground,this.inputBorder=options.inputBorder,this.inputValidationInfoBorder=options.inputValidationInfoBorder,this.inputValidationInfoBackground=options.inputValidationInfoBackground,this.inputValidationInfoForeground=options.inputValidationInfoForeground,this.inputValidationWarningBorder=options.inputValidationWarningBorder,this.inputValidationWarningBackground=options.inputValidationWarningBackground,this.inputValidationWarningForeground=options.inputValidationWarningForeground,this.inputValidationErrorBorder=options.inputValidationErrorBorder,this.inputValidationErrorBackground=options.inputValidationErrorBackground,this.inputValidationErrorForeground=options.inputValidationErrorForeground;const appendCaseSensitiveLabel=options.appendCaseSensitiveLabel||"",appendWholeWordsLabel=options.appendWholeWordsLabel||"",appendRegexLabel=options.appendRegexLabel||"",history=options.history||[],flexibleHeight=!!options.flexibleHeight,flexibleWidth=!!options.flexibleWidth,flexibleMaxHeight=options.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new inputBox_1.HistoryInputBox(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history,showHistoryHint:options.showHistoryHint,flexibleHeight,flexibleWidth,flexibleMaxHeight})),this.regex=this._register(new findInputCheckboxes_1.RegexCheckbox({appendTitle:appendRegexLabel,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.regex.onChange((viaKeyboard=>{this._onDidOptionChange.fire(viaKeyboard),!viaKeyboard&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.regex.onKeyDown((e=>{this._onRegexKeyDown.fire(e)}))),this.wholeWords=this._register(new findInputCheckboxes_1.WholeWordsCheckbox({appendTitle:appendWholeWordsLabel,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.wholeWords.onChange((viaKeyboard=>{this._onDidOptionChange.fire(viaKeyboard),!viaKeyboard&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this.caseSensitive=this._register(new findInputCheckboxes_1.CaseSensitiveCheckbox({appendTitle:appendCaseSensitiveLabel,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.caseSensitive.onChange((viaKeyboard=>{this._onDidOptionChange.fire(viaKeyboard),!viaKeyboard&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.caseSensitive.onKeyDown((e=>{this._onCaseSensitiveKeyDown.fire(e)}))),this._showOptionButtons&&(this.inputBox.paddingRight=this.caseSensitive.width()+this.wholeWords.width()+this.regex.width());let indexes=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,(event=>{if(event.equals(15)||event.equals(17)||event.equals(9)){let index=indexes.indexOf(document.activeElement);if(index>=0){let newIndex=-1;event.equals(17)?newIndex=(index+1)%indexes.length:event.equals(15)&&(newIndex=0===index?indexes.length-1:index-1),event.equals(9)?(indexes[index].blur(),this.inputBox.focus()):newIndex>=0&&indexes[newIndex].focus(),dom.EventHelper.stop(event,!0)}}})),this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this._showOptionButtons?"block":"none",this.controls.appendChild(this.caseSensitive.domNode),this.controls.appendChild(this.wholeWords.domNode),this.controls.appendChild(this.regex.domNode),this.domNode.appendChild(this.controls),parent&&parent.appendChild(this.domNode),this._register(dom.addDisposableListener(this.inputBox.inputElement,"compositionstart",(e=>{this.imeSessionInProgress=!0}))),this._register(dom.addDisposableListener(this.inputBox.inputElement,"compositionend",(e=>{this.imeSessionInProgress=!1,this._onInput.fire()}))),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setFocusInputOnOptionClick(value){this.fixFocusOnOptionClickEnabled=value}setEnabled(enabled){enabled?this.enable():this.disable()}getValue(){return this.inputBox.value}setValue(value){this.inputBox.value!==value&&(this.inputBox.value=value)}style(styles){this.inputActiveOptionBorder=styles.inputActiveOptionBorder,this.inputActiveOptionForeground=styles.inputActiveOptionForeground,this.inputActiveOptionBackground=styles.inputActiveOptionBackground,this.inputBackground=styles.inputBackground,this.inputForeground=styles.inputForeground,this.inputBorder=styles.inputBorder,this.inputValidationInfoBackground=styles.inputValidationInfoBackground,this.inputValidationInfoForeground=styles.inputValidationInfoForeground,this.inputValidationInfoBorder=styles.inputValidationInfoBorder,this.inputValidationWarningBackground=styles.inputValidationWarningBackground,this.inputValidationWarningForeground=styles.inputValidationWarningForeground,this.inputValidationWarningBorder=styles.inputValidationWarningBorder,this.inputValidationErrorBackground=styles.inputValidationErrorBackground,this.inputValidationErrorForeground=styles.inputValidationErrorForeground,this.inputValidationErrorBorder=styles.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const checkBoxStyles={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.regex.style(checkBoxStyles),this.wholeWords.style(checkBoxStyles),this.caseSensitive.style(checkBoxStyles);const inputBoxStyles={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(inputBoxStyles)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(value){this.caseSensitive.checked=value}getWholeWords(){return this.wholeWords.checked}setWholeWords(value){this.wholeWords.checked=value}getRegex(){return this.regex.checked}setRegex(value){this.regex.checked=value,this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}clearMessage(){this.inputBox.hideMessage()}}exports.FindInput=FindInput})),define(__m[493],__M([1,0,7,174,197,62,28,4,481,228]),(function(require,exports,dom,checkbox_1,inputBox_1,widget_1,codicons_1,event_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaceInput=exports.PreserveCaseCheckbox=void 0;const NLS_DEFAULT_LABEL=nls.localize(0,null),NLS_PRESERVE_CASE_LABEL=nls.localize(1,null);class PreserveCaseCheckbox extends checkbox_1.Checkbox{constructor(opts){super({icon:codicons_1.Codicon.preserveCase,title:NLS_PRESERVE_CASE_LABEL+opts.appendTitle,isChecked:opts.isChecked,inputActiveOptionBorder:opts.inputActiveOptionBorder,inputActiveOptionForeground:opts.inputActiveOptionForeground,inputActiveOptionBackground:opts.inputActiveOptionBackground})}}exports.PreserveCaseCheckbox=PreserveCaseCheckbox;class ReplaceInput extends widget_1.Widget{constructor(parent,contextViewProvider,_showOptionButtons,options){super(),this._showOptionButtons=_showOptionButtons,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new event_1.Emitter),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new event_1.Emitter),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new event_1.Emitter),this._onInput=this._register(new event_1.Emitter),this._onKeyUp=this._register(new event_1.Emitter),this._onPreserveCaseKeyDown=this._register(new event_1.Emitter),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=contextViewProvider,this.placeholder=options.placeholder||"",this.validation=options.validation,this.label=options.label||NLS_DEFAULT_LABEL,this.inputActiveOptionBorder=options.inputActiveOptionBorder,this.inputActiveOptionForeground=options.inputActiveOptionForeground,this.inputActiveOptionBackground=options.inputActiveOptionBackground,this.inputBackground=options.inputBackground,this.inputForeground=options.inputForeground,this.inputBorder=options.inputBorder,this.inputValidationInfoBorder=options.inputValidationInfoBorder,this.inputValidationInfoBackground=options.inputValidationInfoBackground,this.inputValidationInfoForeground=options.inputValidationInfoForeground,this.inputValidationWarningBorder=options.inputValidationWarningBorder,this.inputValidationWarningBackground=options.inputValidationWarningBackground,this.inputValidationWarningForeground=options.inputValidationWarningForeground,this.inputValidationErrorBorder=options.inputValidationErrorBorder,this.inputValidationErrorBackground=options.inputValidationErrorBackground,this.inputValidationErrorForeground=options.inputValidationErrorForeground;const appendPreserveCaseLabel=options.appendPreserveCaseLabel||"",history=options.history||[],flexibleHeight=!!options.flexibleHeight,flexibleWidth=!!options.flexibleWidth,flexibleMaxHeight=options.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new inputBox_1.HistoryInputBox(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history,showHistoryHint:options.showHistoryHint,flexibleHeight,flexibleWidth,flexibleMaxHeight})),this.preserveCase=this._register(new PreserveCaseCheckbox({appendTitle:appendPreserveCaseLabel,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange((viaKeyboard=>{this._onDidOptionChange.fire(viaKeyboard),!viaKeyboard&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.preserveCase.onKeyDown((e=>{this._onPreserveCaseKeyDown.fire(e)}))),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let indexes=[this.preserveCase.domNode];this.onkeydown(this.domNode,(event=>{if(event.equals(15)||event.equals(17)||event.equals(9)){let index=indexes.indexOf(document.activeElement);if(index>=0){let newIndex=-1;event.equals(17)?newIndex=(index+1)%indexes.length:event.equals(15)&&(newIndex=0===index?indexes.length-1:index-1),event.equals(9)?(indexes[index].blur(),this.inputBox.focus()):newIndex>=0&&indexes[newIndex].focus(),dom.EventHelper.stop(event,!0)}}}));let controls=document.createElement("div");controls.className="controls",controls.style.display=this._showOptionButtons?"block":"none",controls.appendChild(this.preserveCase.domNode),this.domNode.appendChild(controls),parent&&parent.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(enabled){enabled?this.enable():this.disable()}style(styles){this.inputActiveOptionBorder=styles.inputActiveOptionBorder,this.inputActiveOptionForeground=styles.inputActiveOptionForeground,this.inputActiveOptionBackground=styles.inputActiveOptionBackground,this.inputBackground=styles.inputBackground,this.inputForeground=styles.inputForeground,this.inputBorder=styles.inputBorder,this.inputValidationInfoBackground=styles.inputValidationInfoBackground,this.inputValidationInfoForeground=styles.inputValidationInfoForeground,this.inputValidationInfoBorder=styles.inputValidationInfoBorder,this.inputValidationWarningBackground=styles.inputValidationWarningBackground,this.inputValidationWarningForeground=styles.inputValidationWarningForeground,this.inputValidationWarningBorder=styles.inputValidationWarningBorder,this.inputValidationErrorBackground=styles.inputValidationErrorBackground,this.inputValidationErrorForeground=styles.inputValidationErrorForeground,this.inputValidationErrorBorder=styles.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const checkBoxStyles={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(checkBoxStyles);const inputBoxStyles={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(inputBoxStyles)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(value){this.preserveCase.checked=value}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(newWidth){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=newWidth,this.domNode.style.width=newWidth+"px"}dispose(){super.dispose()}}exports.ReplaceInput=ReplaceInput})),define(__m[494],__M([1,0,34,60,7,44,59,87,128,143,225,69,47,10,28,97,2,16,8]),(function(require,exports,browser_1,touch_1,dom_1,keyboardEvent_1,mouseEvent_1,actionbar_1,actionViewItems_1,codiconStyles_1,contextview_1,scrollableElement_1,actions_1,async_1,codicons_1,iconLabels_1,lifecycle_1,platform_1,strings){"use strict";var Direction;Object.defineProperty(exports,"__esModule",{value:!0}),exports.cleanMnemonic=exports.Menu=exports.Direction=exports.MENU_ESCAPED_MNEMONIC_REGEX=exports.MENU_MNEMONIC_REGEX=void 0,exports.MENU_MNEMONIC_REGEX=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,exports.MENU_ESCAPED_MNEMONIC_REGEX=/(&amp;)?(&amp;)([^\s&])/g,function(Direction){Direction[Direction.Right=0]="Right",Direction[Direction.Left=1]="Left"}(Direction=exports.Direction||(exports.Direction={}));class Menu extends actionbar_1.ActionBar{constructor(container,actions,options={}){container.classList.add("monaco-menu-container"),container.setAttribute("role","presentation");const menuElement=document.createElement("div");menuElement.classList.add("monaco-menu"),menuElement.setAttribute("role","presentation"),super(menuElement,{orientation:1,actionViewItemProvider:action=>this.doGetActionViewItem(action,options,parentData),context:options.context,actionRunner:options.actionRunner,ariaLabel:options.ariaLabel,focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...platform_1.isMacintosh||platform_1.isLinux?[10]:[]],keyDown:!0}}),this.menuElement=menuElement,this.actionsList.setAttribute("role","menu"),this.actionsList.tabIndex=0,this.menuDisposables=this._register(new lifecycle_1.DisposableStore),this.initializeOrUpdateStyleSheet(container,{}),this._register(touch_1.Gesture.addTarget(menuElement)),(0,dom_1.addDisposableListener)(menuElement,dom_1.EventType.KEY_DOWN,(e=>{new keyboardEvent_1.StandardKeyboardEvent(e).equals(2)&&e.preventDefault()})),options.enableMnemonics&&this.menuDisposables.add((0,dom_1.addDisposableListener)(menuElement,dom_1.EventType.KEY_DOWN,(e=>{const key=e.key.toLocaleLowerCase();if(this.mnemonics.has(key)){dom_1.EventHelper.stop(e,!0);const actions=this.mnemonics.get(key);if(1===actions.length&&(actions[0]instanceof SubmenuMenuActionViewItem&&actions[0].container&&this.focusItemByElement(actions[0].container),actions[0].onClick(e)),actions.length>1){const action=actions.shift();action&&action.container&&(this.focusItemByElement(action.container),actions.push(action)),this.mnemonics.set(key,actions)}}}))),platform_1.isLinux&&this._register((0,dom_1.addDisposableListener)(menuElement,dom_1.EventType.KEY_DOWN,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);event.equals(14)||event.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),dom_1.EventHelper.stop(e,!0)):(event.equals(13)||event.equals(12))&&(this.focusedItem=0,this.focusPrevious(),dom_1.EventHelper.stop(e,!0))}))),this._register((0,dom_1.addDisposableListener)(this.domNode,dom_1.EventType.MOUSE_OUT,(e=>{let relatedTarget=e.relatedTarget;(0,dom_1.isAncestor)(relatedTarget,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),e.stopPropagation())}))),this._register((0,dom_1.addDisposableListener)(this.actionsList,dom_1.EventType.MOUSE_OVER,(e=>{let target=e.target;if(target&&(0,dom_1.isAncestor)(target,this.actionsList)&&target!==this.actionsList){for(;target.parentElement!==this.actionsList&&null!==target.parentElement;)target=target.parentElement;if(target.classList.contains("action-item")){const lastFocusedItem=this.focusedItem;this.setFocusedItem(target),lastFocusedItem!==this.focusedItem&&this.updateFocus()}}}))),this._register(touch_1.Gesture.addTarget(this.actionsList)),this._register((0,dom_1.addDisposableListener)(this.actionsList,touch_1.EventType.Tap,(e=>{let target=e.initialTarget;if(target&&(0,dom_1.isAncestor)(target,this.actionsList)&&target!==this.actionsList){for(;target.parentElement!==this.actionsList&&null!==target.parentElement;)target=target.parentElement;if(target.classList.contains("action-item")){const lastFocusedItem=this.focusedItem;this.setFocusedItem(target),lastFocusedItem!==this.focusedItem&&this.updateFocus()}}})));let parentData={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new scrollableElement_1.DomScrollableElement(menuElement,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const scrollElement=this.scrollableElement.getDomNode();scrollElement.style.position="",this._register((0,dom_1.addDisposableListener)(menuElement,touch_1.EventType.Change,(e=>{dom_1.EventHelper.stop(e,!0);const scrollTop=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:scrollTop-e.translationY})}))),this._register((0,dom_1.addDisposableListener)(scrollElement,dom_1.EventType.MOUSE_UP,(e=>{e.preventDefault()}))),menuElement.style.maxHeight=`${Math.max(10,window.innerHeight-container.getBoundingClientRect().top-35)}px`,actions=actions.filter((a=>{var _a;return!(null===(_a=options.submenuIds)||void 0===_a?void 0:_a.has(a.id))||(console.warn(`Found submenu cycle: ${a.id}`),!1)})),this.push(actions,{icon:!0,label:!0,isMenu:!0}),container.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter((item=>!(item instanceof MenuSeparatorActionViewItem))).forEach(((item,index,array)=>{item.updatePositionInSet(index+1,array.length)}))}initializeOrUpdateStyleSheet(container,style){this.styleSheet||((0,dom_1.isInShadowDOM)(container)?this.styleSheet=(0,dom_1.createStyleSheet)(container):(Menu.globalStyleSheet||(Menu.globalStyleSheet=(0,dom_1.createStyleSheet)()),this.styleSheet=Menu.globalStyleSheet)),this.styleSheet.textContent=function getMenuWidgetCSS(style,isForShadowDom){let result=`\n.monaco-menu {\n\tfont-size: 13px;\n\n}\n\n${(0,codiconStyles_1.formatRule)(codicons_1.Codicon.menuSelection)}\n${(0,codiconStyles_1.formatRule)(codicons_1.Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\topacity: 0.4;\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid #bbb;\n\tpadding-top: 1px;\n\tmargin-left: .8em;\n\tmargin-right: .8em;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tpadding: 0.5em 0 0 0;\n\tmargin-bottom: 0.5em;\n\twidth: 100%;\n\theight: 0px !important;\n\tmargin-left: .8em !important;\n\tmargin-right: .8em !important;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tborder: thin solid transparent; /* prevents jumping behaviour on hover or focus */\n}\n\n\n/* High Contrast Theming */\n:host-context(.hc-black) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .5em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 1.8em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tpadding: 0.2em 0 0 0;\n\tmargin-bottom: 0.2em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}`;if(isForShadowDom){result+="\n\t\t\t/* Arrows */\n\t\t\t.monaco-scrollable-element > .scrollbar > .scra {\n\t\t\t\tcursor: pointer;\n\t\t\t\tfont-size: 11px !important;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .visible {\n\t\t\t\topacity: 1;\n\n\t\t\t\t/* Background rule added for IE9 - to allow clicks on dom node */\n\t\t\t\tbackground:rgba(0,0,0,0);\n\n\t\t\t\ttransition: opacity 100ms linear;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible {\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible.fade {\n\t\t\t\ttransition: opacity 800ms linear;\n\t\t\t}\n\n\t\t\t/* Scrollable Content Inset Shadow */\n\t\t\t.monaco-scrollable-element > .shadow {\n\t\t\t\tposition: absolute;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 3px;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 3px;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top-left-corner {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t";const scrollbarShadowColor=style.scrollbarShadow;scrollbarShadowColor&&(result+=`\n\t\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t\t}\n\t\t\t`);const scrollbarSliderBackgroundColor=style.scrollbarSliderBackground;scrollbarSliderBackgroundColor&&(result+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t\t}\n\t\t\t`);const scrollbarSliderHoverBackgroundColor=style.scrollbarSliderHoverBackground;scrollbarSliderHoverBackgroundColor&&(result+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t\t}\n\t\t\t`);const scrollbarSliderActiveBackgroundColor=style.scrollbarSliderActiveBackground;scrollbarSliderActiveBackgroundColor&&(result+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t\t}\n\t\t\t`)}return result}(style,(0,dom_1.isInShadowDOM)(container))}style(style){const container=this.getContainer();this.initializeOrUpdateStyleSheet(container,style);const fgColor=style.foregroundColor?`${style.foregroundColor}`:"",bgColor=style.backgroundColor?`${style.backgroundColor}`:"",border=style.borderColor?`1px solid ${style.borderColor}`:"",shadow=style.shadowColor?`0 2px 4px ${style.shadowColor}`:"";container.style.border=border,this.domNode.style.color=fgColor,this.domNode.style.backgroundColor=bgColor,container.style.boxShadow=shadow,this.viewItems&&this.viewItems.forEach((item=>{(item instanceof BaseMenuActionViewItem||item instanceof MenuSeparatorActionViewItem)&&item.style(style)}))}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(element){const lastFocusedItem=this.focusedItem;this.setFocusedItem(element),lastFocusedItem!==this.focusedItem&&this.updateFocus()}setFocusedItem(element){for(let i=0;i<this.actionsList.children.length;i++){if(element===this.actionsList.children[i]){this.focusedItem=i;break}}}updateFocus(fromRight){super.updateFocus(fromRight,!0,!0),void 0!==this.focusedItem&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(action,options,parentData){if(action instanceof actions_1.Separator)return new MenuSeparatorActionViewItem(options.context,action,{icon:!0});if(action instanceof actions_1.SubmenuAction){const menuActionViewItem=new SubmenuMenuActionViewItem(action,action.actions,parentData,Object.assign(Object.assign({},options),{submenuIds:new Set([...options.submenuIds||[],action.id])}));if(options.enableMnemonics){const mnemonic=menuActionViewItem.getMnemonic();if(mnemonic&&menuActionViewItem.isEnabled()){let actionViewItems=[];this.mnemonics.has(mnemonic)&&(actionViewItems=this.mnemonics.get(mnemonic)),actionViewItems.push(menuActionViewItem),this.mnemonics.set(mnemonic,actionViewItems)}}return menuActionViewItem}{const menuItemOptions={enableMnemonics:options.enableMnemonics,useEventAsContext:options.useEventAsContext};if(options.getKeyBinding){const keybinding=options.getKeyBinding(action);if(keybinding){const keybindingLabel=keybinding.getLabel();keybindingLabel&&(menuItemOptions.keybinding=keybindingLabel)}}const menuActionViewItem=new BaseMenuActionViewItem(options.context,action,menuItemOptions);if(options.enableMnemonics){const mnemonic=menuActionViewItem.getMnemonic();if(mnemonic&&menuActionViewItem.isEnabled()){let actionViewItems=[];this.mnemonics.has(mnemonic)&&(actionViewItems=this.mnemonics.get(mnemonic)),actionViewItems.push(menuActionViewItem),this.mnemonics.set(mnemonic,actionViewItems)}}return menuActionViewItem}}}exports.Menu=Menu;class BaseMenuActionViewItem extends actionViewItems_1.BaseActionViewItem{constructor(ctx,action,options={}){if(options.isMenu=!0,super(action,action,options),this.options=options,this.options.icon=void 0!==options.icon&&options.icon,this.options.label=void 0===options.label||options.label,this.cssClass="",this.options.label&&options.enableMnemonics){let label=this.getAction().label;if(label){let matches=exports.MENU_MNEMONIC_REGEX.exec(label);matches&&(this.mnemonic=(matches[1]?matches[1]:matches[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new async_1.RunOnceScheduler((()=>{this.element&&(this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.MOUSE_UP,(e=>{if(dom_1.EventHelper.stop(e,!0),browser_1.isFirefox){if(new mouseEvent_1.StandardMouseEvent(e).rightButton)return;this.onClick(e)}else setTimeout((()=>{this.onClick(e)}),0)}))),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.CONTEXT_MENU,(e=>{dom_1.EventHelper.stop(e,!0)}))))}),100),this._register(this.runOnceToEnableMouseUp)}render(container){super.render(container),this.element&&(this.container=container,this.item=(0,dom_1.append)(this.element,(0,dom_1.$)("a.action-menu-item")),this._action.id===actions_1.Separator.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=(0,dom_1.append)(this.item,(0,dom_1.$)("span.menu-item-check"+codicons_1.Codicon.menuSelection.cssSelector)),this.check.setAttribute("role","none"),this.label=(0,dom_1.append)(this.item,(0,dom_1.$)("span.action-label")),this.options.label&&this.options.keybinding&&((0,dom_1.append)(this.item,(0,dom_1.$)("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item&&this.item.focus(),this.applyStyle()}updatePositionInSet(pos,setSize){this.item&&(this.item.setAttribute("aria-posinset",`${pos}`),this.item.setAttribute("aria-setsize",`${setSize}`))}updateLabel(){if(this.label&&this.options.label){(0,dom_1.clearNode)(this.label);let label=(0,iconLabels_1.stripIcons)(this.getAction().label);if(label){const cleanLabel=cleanMnemonic(label);this.options.enableMnemonics||(label=cleanLabel),this.label.setAttribute("aria-label",cleanLabel.replace(/&&/g,"&"));const matches=exports.MENU_MNEMONIC_REGEX.exec(label);if(matches){label=strings.escape(label),exports.MENU_ESCAPED_MNEMONIC_REGEX.lastIndex=0;let escMatch=exports.MENU_ESCAPED_MNEMONIC_REGEX.exec(label);for(;escMatch&&escMatch[1];)escMatch=exports.MENU_ESCAPED_MNEMONIC_REGEX.exec(label);const replaceDoubleEscapes=str=>str.replace(/&amp;&amp;/g,"&amp;");escMatch?this.label.append(strings.ltrim(replaceDoubleEscapes(label.substr(0,escMatch.index))," "),(0,dom_1.$)("u",{"aria-hidden":"true"},escMatch[3]),strings.rtrim(replaceDoubleEscapes(label.substr(escMatch.index+escMatch[0].length))," ")):this.label.innerText=replaceDoubleEscapes(label).trim(),this.item&&this.item.setAttribute("aria-keyshortcuts",(matches[1]?matches[1]:matches[3]).toLocaleLowerCase())}else this.label.innerText=label.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.getAction().class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.getAction().enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const checked=this.getAction().checked;this.item.classList.toggle("checked",!!checked),void 0!==checked?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",checked?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){if(!this.menuStyle)return;const isSelected=this.element&&this.element.classList.contains("focused"),fgColor=isSelected&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,bgColor=isSelected&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,border=isSelected&&this.menuStyle.selectionBorderColor?`thin solid ${this.menuStyle.selectionBorderColor}`:"";this.item&&(this.item.style.color=fgColor?fgColor.toString():"",this.item.style.backgroundColor=bgColor?bgColor.toString():""),this.check&&(this.check.style.color=fgColor?fgColor.toString():""),this.container&&(this.container.style.border=border)}style(style){this.menuStyle=style,this.applyStyle()}}class SubmenuMenuActionViewItem extends BaseMenuActionViewItem{constructor(action,submenuActions,parentData,submenuOptions){super(action,action,submenuOptions),this.submenuActions=submenuActions,this.parentData=parentData,this.submenuOptions=submenuOptions,this.mysubmenu=null,this.submenuDisposables=this._register(new lifecycle_1.DisposableStore),this.mouseOver=!1,this.expandDirection=submenuOptions&&void 0!==submenuOptions.expandDirection?submenuOptions.expandDirection:Direction.Right,this.showScheduler=new async_1.RunOnceScheduler((()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))}),250),this.hideScheduler=new async_1.RunOnceScheduler((()=>{this.element&&!(0,dom_1.isAncestor)((0,dom_1.getActiveElement)(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))}),750)}render(container){super.render(container),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=(0,dom_1.append)(this.item,(0,dom_1.$)("span.submenu-indicator"+codicons_1.Codicon.menuSubmenu.cssSelector)),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.KEY_UP,(e=>{let event=new keyboardEvent_1.StandardKeyboardEvent(e);(event.equals(17)||event.equals(3))&&(dom_1.EventHelper.stop(e,!0),this.createSubmenu(!0))}))),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.KEY_DOWN,(e=>{let event=new keyboardEvent_1.StandardKeyboardEvent(e);(0,dom_1.getActiveElement)()===this.item&&(event.equals(17)||event.equals(3))&&dom_1.EventHelper.stop(e,!0)}))),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.MOUSE_OVER,(e=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())}))),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.MOUSE_LEAVE,(e=>{this.mouseOver=!1}))),this._register((0,dom_1.addDisposableListener)(this.element,dom_1.EventType.FOCUS_OUT,(e=>{this.element&&!(0,dom_1.isAncestor)((0,dom_1.getActiveElement)(),this.element)&&this.hideScheduler.schedule()}))),this._register(this.parentData.parent.onScroll((()=>{this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!1)}))))}updateEnabled(){}onClick(e){dom_1.EventHelper.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(force){if(this.parentData.submenu&&(force||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch(_a){}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(windowDimensions,submenu,entry,expandDirection){const ret={top:0,left:0};return ret.left=(0,contextview_1.layout)(windowDimensions.width,submenu.width,{position:expandDirection===Direction.Right?0:1,offset:entry.left,size:entry.width}),ret.left>=entry.left&&ret.left<entry.left+entry.width&&(entry.left+10+submenu.width<=windowDimensions.width&&(ret.left=entry.left+10),entry.top+=10,entry.height=0),ret.top=(0,contextview_1.layout)(windowDimensions.height,submenu.height,{position:0,offset:entry.top,size:0}),ret.top+submenu.height===entry.top&&ret.top+entry.height+submenu.height<=windowDimensions.height&&(ret.top+=entry.height),ret}createSubmenu(selectFirstItem=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=(0,dom_1.append)(this.element,(0,dom_1.$)("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const computedStyles=getComputedStyle(this.parentData.parent.domNode),paddingTop=parseFloat(computedStyles.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Menu(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new actions_1.EmptySubmenuAction],this.submenuOptions),this.menuStyle&&this.parentData.submenu.style(this.menuStyle);const entryBox=this.element.getBoundingClientRect(),entryBoxUpdated={top:entryBox.top-paddingTop,left:entryBox.left,height:entryBox.height+2*paddingTop,width:entryBox.width},viewBox=this.submenuContainer.getBoundingClientRect(),{top,left}=this.calculateSubmenuMenuLayout(new dom_1.Dimension(window.innerWidth,window.innerHeight),dom_1.Dimension.lift(viewBox),entryBoxUpdated,this.expandDirection);this.submenuContainer.style.left=left-viewBox.left+"px",this.submenuContainer.style.top=top-viewBox.top+"px",this.submenuDisposables.add((0,dom_1.addDisposableListener)(this.submenuContainer,dom_1.EventType.KEY_UP,(e=>{new keyboardEvent_1.StandardKeyboardEvent(e).equals(15)&&(dom_1.EventHelper.stop(e,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))}))),this.submenuDisposables.add((0,dom_1.addDisposableListener)(this.submenuContainer,dom_1.EventType.KEY_DOWN,(e=>{new keyboardEvent_1.StandardKeyboardEvent(e).equals(15)&&dom_1.EventHelper.stop(e,!0)}))),this.submenuDisposables.add(this.parentData.submenu.onDidCancel((()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)}))),this.parentData.submenu.focus(selectFirstItem),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(value){var _a;this.item&&(null===(_a=this.item)||void 0===_a||_a.setAttribute("aria-expanded",value))}applyStyle(){if(super.applyStyle(),!this.menuStyle)return;const fgColor=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=fgColor?`${fgColor}`:""),this.parentData.submenu&&this.parentData.submenu.style(this.menuStyle)}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class MenuSeparatorActionViewItem extends actionViewItems_1.ActionViewItem{style(style){this.label&&(this.label.style.borderBottomColor=style.separatorColor?`${style.separatorColor}`:"")}}function cleanMnemonic(label){const regex=exports.MENU_MNEMONIC_REGEX,matches=regex.exec(label);if(!matches)return label;const mnemonicInText=!matches[1];return label.replace(regex,mnemonicInText?"$2$3":"").trim()}exports.cleanMnemonic=cleanMnemonic})),define(__m[495],__M([1,0,7,44,59,197,2,76,145]),(function(require,exports,dom,keyboardEvent_1,mouseEvent_1,inputBox_1,lifecycle_1,severity_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickInputBox=void 0;const $=dom.$;class QuickInputBox extends lifecycle_1.Disposable{constructor(parent){super(),this.parent=parent,this.onKeyDown=handler=>dom.addDisposableListener(this.inputBox.inputElement,dom.EventType.KEY_DOWN,(e=>{handler(new keyboardEvent_1.StandardKeyboardEvent(e))})),this.onMouseDown=handler=>dom.addDisposableListener(this.inputBox.inputElement,dom.EventType.MOUSE_DOWN,(e=>{handler(new mouseEvent_1.StandardMouseEvent(e))})),this.onDidChange=handler=>this.inputBox.onDidChange(handler),this.container=dom.append(this.parent,$(".quick-input-box")),this.inputBox=this._register(new inputBox_1.InputBox(this.container,void 0))}get value(){return this.inputBox.value}set value(value){this.inputBox.value=value}select(range=null){this.inputBox.select(range)}isSelectionAtEnd(){return this.inputBox.isSelectionAtEnd()}get placeholder(){return this.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(placeholder){this.inputBox.setPlaceHolder(placeholder)}get ariaLabel(){return this.inputBox.getAriaLabel()}set ariaLabel(ariaLabel){this.inputBox.setAriaLabel(ariaLabel)}get password(){return"password"===this.inputBox.inputElement.type}set password(password){this.inputBox.inputElement.type=password?"password":"text"}setAttribute(name,value){this.inputBox.inputElement.setAttribute(name,value)}removeAttribute(name){this.inputBox.inputElement.removeAttribute(name)}showDecoration(decoration){decoration===severity_1.default.Ignore?this.inputBox.hideMessage():this.inputBox.showMessage({type:decoration===severity_1.default.Info?1:decoration===severity_1.default.Warning?2:3,content:""})}stylesForType(decoration){return this.inputBox.stylesForType(decoration===severity_1.default.Info?1:decoration===severity_1.default.Warning?2:3)}setFocus(){this.inputBox.focus()}layout(){this.inputBox.layout()}style(styles){this.inputBox.style(styles)}}exports.QuickInputBox=QuickInputBox})),define(__m[496],__M([5,6]),(function(nls,data){return nls.create("vs/base/common/errorMessage",data)})),define(__m[497],__M([1,0,18,19,496]),(function(require,exports,arrays,types,nls){"use strict";function exceptionToErrorMessage(exception,verbose){return verbose&&(exception.stack||exception.stacktrace)?nls.localize(0,null,detectSystemErrorMessage(exception),stackToString(exception.stack)||stackToString(exception.stacktrace)):detectSystemErrorMessage(exception)}function stackToString(stack){return Array.isArray(stack)?stack.join("\n"):stack}function detectSystemErrorMessage(exception){return"string"==typeof exception.code&&"number"==typeof exception.errno&&"string"==typeof exception.syscall?nls.localize(1,null,exception.message):exception.message||nls.localize(2,null)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.toErrorMessage=void 0,exports.toErrorMessage=function toErrorMessage(error=null,verbose=!1){if(!error)return nls.localize(3,null);if(Array.isArray(error)){const errors=arrays.coalesce(error),msg=toErrorMessage(errors[0],verbose);return errors.length>1?nls.localize(4,null,msg,errors.length):msg}if(types.isString(error))return error;if(error.detail){const detail=error.detail;if(detail.error)return exceptionToErrorMessage(detail.error,verbose);if(detail.exception)return exceptionToErrorMessage(detail.exception,verbose)}return error.stack?exceptionToErrorMessage(error,verbose):error.message?error.message:nls.localize(5,null)}})),define(__m[498],__M([5,6]),(function(nls,data){return nls.create("vs/base/common/keybindingLabels",data)})),define(__m[198],__M([1,0,498]),(function(require,exports,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserSettingsLabelProvider=exports.ElectronAcceleratorLabelProvider=exports.AriaLabelProvider=exports.UILabelProvider=exports.ModifierLabelProvider=void 0;class ModifierLabelProvider{constructor(mac,windows,linux=windows){this.modifierLabels=[null],this.modifierLabels[2]=mac,this.modifierLabels[1]=windows,this.modifierLabels[3]=linux}toLabel(OS,parts,keyLabelProvider){if(0===parts.length)return null;const result=[];for(let i=0,len=parts.length;i<len;i++){const part=parts[i],keyLabel=keyLabelProvider(part);if(null===keyLabel)return null;result[i]=_simpleAsString(part,keyLabel,this.modifierLabels[OS])}return result.join(" ")}}function _simpleAsString(modifiers,key,labels){if(null===key)return"";const result=[];return modifiers.ctrlKey&&result.push(labels.ctrlKey),modifiers.shiftKey&&result.push(labels.shiftKey),modifiers.altKey&&result.push(labels.altKey),modifiers.metaKey&&result.push(labels.metaKey),""!==key&&result.push(key),result.join(labels.separator)}exports.ModifierLabelProvider=ModifierLabelProvider,exports.UILabelProvider=new ModifierLabelProvider({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:nls.localize(0,null),shiftKey:nls.localize(1,null),altKey:nls.localize(2,null),metaKey:nls.localize(3,null),separator:"+"},{ctrlKey:nls.localize(4,null),shiftKey:nls.localize(5,null),altKey:nls.localize(6,null),metaKey:nls.localize(7,null),separator:"+"}),exports.AriaLabelProvider=new ModifierLabelProvider({ctrlKey:nls.localize(8,null),shiftKey:nls.localize(9,null),altKey:nls.localize(10,null),metaKey:nls.localize(11,null),separator:"+"},{ctrlKey:nls.localize(12,null),shiftKey:nls.localize(13,null),altKey:nls.localize(14,null),metaKey:nls.localize(15,null),separator:"+"},{ctrlKey:nls.localize(16,null),shiftKey:nls.localize(17,null),altKey:nls.localize(18,null),metaKey:nls.localize(19,null),separator:"+"}),exports.ElectronAcceleratorLabelProvider=new ModifierLabelProvider({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),exports.UserSettingsLabelProvider=new ModifierLabelProvider({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"})})),define(__m[499],__M([1,0,7,198,40,485,342]),(function(require,exports,dom,keybindingLabels_1,objects_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeybindingLabel=void 0;const $=dom.$;class KeybindingLabel{constructor(container,os,options){this.os=os,this.keyElements=new Set,this.options=options||Object.create(null),this.labelBackground=this.options.keybindingLabelBackground,this.labelForeground=this.options.keybindingLabelForeground,this.labelBorder=this.options.keybindingLabelBorder,this.labelBottomBorder=this.options.keybindingLabelBottomBorder,this.labelShadow=this.options.keybindingLabelShadow,this.domNode=dom.append(container,$(".monaco-keybinding")),this.didEverRender=!1,container.appendChild(this.domNode)}get element(){return this.domNode}set(keybinding,matches){this.didEverRender&&this.keybinding===keybinding&&KeybindingLabel.areSame(this.matches,matches)||(this.keybinding=keybinding,this.matches=matches,this.render())}render(){if(this.clear(),this.keybinding){let[firstPart,chordPart]=this.keybinding.getParts();firstPart&&this.renderPart(this.domNode,firstPart,this.matches?this.matches.firstPart:null),chordPart&&(dom.append(this.domNode,$("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderPart(this.domNode,chordPart,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()||""}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.applyStyles(),this.didEverRender=!0}clear(){dom.clearNode(this.domNode),this.keyElements.clear()}renderPart(parent,part,match){const modifierLabels=keybindingLabels_1.UILabelProvider.modifierLabels[this.os];part.ctrlKey&&this.renderKey(parent,modifierLabels.ctrlKey,Boolean(null==match?void 0:match.ctrlKey),modifierLabels.separator),part.shiftKey&&this.renderKey(parent,modifierLabels.shiftKey,Boolean(null==match?void 0:match.shiftKey),modifierLabels.separator),part.altKey&&this.renderKey(parent,modifierLabels.altKey,Boolean(null==match?void 0:match.altKey),modifierLabels.separator),part.metaKey&&this.renderKey(parent,modifierLabels.metaKey,Boolean(null==match?void 0:match.metaKey),modifierLabels.separator);const keyLabel=part.keyLabel;keyLabel&&this.renderKey(parent,keyLabel,Boolean(null==match?void 0:match.keyCode),"")}renderKey(parent,label,highlight,separator){dom.append(parent,this.createKeyElement(label,highlight?".highlight":"")),separator&&dom.append(parent,$("span.monaco-keybinding-key-separator",void 0,separator))}renderUnbound(parent){dom.append(parent,this.createKeyElement((0,nls_1.localize)(0,null)))}createKeyElement(label,extraClass=""){const keyElement=$("span.monaco-keybinding-key"+extraClass,void 0,label);return this.keyElements.add(keyElement),keyElement}style(styles){this.labelBackground=styles.keybindingLabelBackground,this.labelForeground=styles.keybindingLabelForeground,this.labelBorder=styles.keybindingLabelBorder,this.labelBottomBorder=styles.keybindingLabelBottomBorder,this.labelShadow=styles.keybindingLabelShadow,this.applyStyles()}applyStyles(){var _a;if(this.element){for(const keyElement of this.keyElements)this.labelBackground&&(keyElement.style.backgroundColor=null===(_a=this.labelBackground)||void 0===_a?void 0:_a.toString()),this.labelBorder&&(keyElement.style.borderColor=this.labelBorder.toString()),this.labelBottomBorder&&(keyElement.style.borderBottomColor=this.labelBottomBorder.toString()),this.labelShadow&&(keyElement.style.boxShadow=`inset 0 -1px 0 ${this.labelShadow}`);this.labelForeground&&(this.element.style.color=this.labelForeground.toString())}}static areSame(a,b){return a===b||!a&&!b||!!a&&!!b&&(0,objects_1.equals)(a.firstPart,b.firstPart)&&(0,objects_1.equals)(a.chordPart,b.chordPart)}}exports.KeybindingLabel=KeybindingLabel})),define(__m[500],__M([5,6]),(function(nls,data){return nls.create("vs/base/parts/quickinput/browser/quickInput",data)})),define(__m[501],__M([5,6]),(function(nls,data){return nls.create("vs/base/parts/quickinput/browser/quickInputList",data)})),define(__m[502],__M([1,0,7,44,87,195,499,47,18,28,320,95,4,97,2,16,19,232,501,145]),(function(require,exports,dom,keyboardEvent_1,actionbar_1,iconLabel_1,keybindingLabel_1,actions_1,arrays_1,codicons_1,comparers_1,decorators_1,event_1,iconLabels_1,lifecycle_1,platform,types_1,quickInputUtils_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickInputList=exports.QuickInputListFocus=void 0;const $=dom.$;class ListElement{constructor(init){this.hidden=!1,this._onChecked=new event_1.Emitter,this.onChecked=this._onChecked.event,Object.assign(this,init)}get checked(){return!!this._checked}set checked(value){value!==this._checked&&(this._checked=value,this._onChecked.fire(value))}dispose(){this._onChecked.dispose()}}class ListElementRenderer{get templateId(){return ListElementRenderer.ID}renderTemplate(container){const data=Object.create(null);data.toDisposeElement=[],data.toDisposeTemplate=[],data.entry=dom.append(container,$(".quick-input-list-entry"));const label=dom.append(data.entry,$("label.quick-input-list-label"));data.toDisposeTemplate.push(dom.addStandardDisposableListener(label,dom.EventType.CLICK,(e=>{data.checkbox.offsetParent||e.preventDefault()}))),data.checkbox=dom.append(label,$("input.quick-input-list-checkbox")),data.checkbox.type="checkbox",data.toDisposeTemplate.push(dom.addStandardDisposableListener(data.checkbox,dom.EventType.CHANGE,(e=>{data.element.checked=data.checkbox.checked})));const rows=dom.append(label,$(".quick-input-list-rows")),row1=dom.append(rows,$(".quick-input-list-row")),row2=dom.append(rows,$(".quick-input-list-row"));data.label=new iconLabel_1.IconLabel(row1,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const keybindingContainer=dom.append(row1,$(".quick-input-list-entry-keybinding"));data.keybinding=new keybindingLabel_1.KeybindingLabel(keybindingContainer,platform.OS);const detailContainer=dom.append(row2,$(".quick-input-list-label-meta"));return data.detail=new iconLabel_1.IconLabel(detailContainer,{supportHighlights:!0,supportIcons:!0}),data.separator=dom.append(data.entry,$(".quick-input-list-separator")),data.actionBar=new actionbar_1.ActionBar(data.entry),data.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),data.toDisposeTemplate.push(data.actionBar),data}renderElement(element,index,data){data.toDisposeElement=(0,lifecycle_1.dispose)(data.toDisposeElement),data.element=element,data.checkbox.checked=element.checked,data.toDisposeElement.push(element.onChecked((checked=>data.checkbox.checked=checked)));const{labelHighlights,descriptionHighlights,detailHighlights}=element,options=Object.create(null);options.matches=labelHighlights||[],options.descriptionTitle=element.saneDescription,options.descriptionMatches=descriptionHighlights||[],options.extraClasses=element.item.iconClasses,options.italic=element.item.italic,options.strikethrough=element.item.strikethrough,data.label.setLabel(element.saneLabel,element.saneDescription,options),data.keybinding.set(element.item.keybinding),element.saneDetail&&data.detail.setLabel(element.saneDetail,void 0,{matches:detailHighlights,title:element.saneDetail}),element.separator&&element.separator.label?(data.separator.textContent=element.separator.label,data.separator.style.display=""):data.separator.style.display="none",data.entry.classList.toggle("quick-input-list-separator-border",!!element.separator),data.actionBar.clear();const buttons=element.item.buttons;buttons&&buttons.length?(data.actionBar.push(buttons.map(((button,index)=>{let cssClasses=button.iconClass||(button.iconPath?(0,quickInputUtils_1.getIconClass)(button.iconPath):void 0);button.alwaysVisible&&(cssClasses=cssClasses?`${cssClasses} always-visible`:"always-visible");const action=new actions_1.Action(`id-${index}`,"",cssClasses,!0,(()=>__awaiter(this,void 0,void 0,(function*(){element.fireButtonTriggered({button,item:element.item})}))));return action.tooltip=button.tooltip||"",action})),{icon:!0,label:!1}),data.entry.classList.add("has-actions")):data.entry.classList.remove("has-actions")}disposeElement(element,index,data){data.toDisposeElement=(0,lifecycle_1.dispose)(data.toDisposeElement)}disposeTemplate(data){data.toDisposeElement=(0,lifecycle_1.dispose)(data.toDisposeElement),data.toDisposeTemplate=(0,lifecycle_1.dispose)(data.toDisposeTemplate)}}ListElementRenderer.ID="listelement";class ListElementDelegate{getHeight(element){return element.saneDetail?44:22}getTemplateId(element){return ListElementRenderer.ID}}var QuickInputListFocus;!function(QuickInputListFocus){QuickInputListFocus[QuickInputListFocus.First=1]="First",QuickInputListFocus[QuickInputListFocus.Second=2]="Second",QuickInputListFocus[QuickInputListFocus.Last=3]="Last",QuickInputListFocus[QuickInputListFocus.Next=4]="Next",QuickInputListFocus[QuickInputListFocus.Previous=5]="Previous",QuickInputListFocus[QuickInputListFocus.NextPage=6]="NextPage",QuickInputListFocus[QuickInputListFocus.PreviousPage=7]="PreviousPage"}(QuickInputListFocus=exports.QuickInputListFocus||(exports.QuickInputListFocus={}));class QuickInputList{constructor(parent,id,options){this.parent=parent,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new event_1.Emitter,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new event_1.Emitter,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new event_1.Emitter,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new event_1.Emitter,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new event_1.Emitter,this.onButtonTriggered=this._onButtonTriggered.event,this._onKeyDown=new event_1.Emitter,this.onKeyDown=this._onKeyDown.event,this._onLeave=new event_1.Emitter,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=id,this.container=dom.append(this.parent,$(".quick-input-list"));const delegate=new ListElementDelegate,accessibilityProvider=new QuickInputAccessibilityProvider;this.list=options.createList("QuickInput",this.container,delegate,[new ListElementRenderer],{identityProvider:{getId:element=>element.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider}),this.list.getHTMLElement().id=id,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown((e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);switch(event.keyCode){case 10:this.toggleCheckbox();break;case 31:(platform.isMacintosh?e.metaKey:e.ctrlKey)&&this.list.setFocus((0,arrays_1.range)(this.list.length));break;case 16:{const focus1=this.list.getFocus();1===focus1.length&&0===focus1[0]&&this._onLeave.fire();break}case 18:{const focus2=this.list.getFocus();1===focus2.length&&focus2[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(event)}))),this.disposables.push(this.list.onMouseDown((e=>{2!==e.browserEvent.button&&e.browserEvent.preventDefault()}))),this.disposables.push(dom.addDisposableListener(this.container,dom.EventType.CLICK,(e=>{(e.x||e.y)&&this._onLeave.fire()}))),this.disposables.push(this.list.onMouseMiddleClick((e=>{this._onLeave.fire()}))),this.disposables.push(this.list.onContextMenu((e=>{"number"==typeof e.index&&(e.browserEvent.preventDefault(),this.list.setSelection([e.index]))}))),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return event_1.Event.map(this.list.onDidChangeFocus,(e=>e.elements.map((e=>e.item))))}get onDidChangeSelection(){return event_1.Event.map(this.list.onDidChangeSelection,(e=>({items:e.elements.map((e=>e.item)),event:e.browserEvent})))}get scrollTop(){return this.list.scrollTop}set scrollTop(scrollTop){this.list.scrollTop=scrollTop}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(elements,whenNoneVisible=!0){for(let i=0,n=elements.length;i<n;i++){const element=elements[i];if(!element.hidden){if(!element.checked)return!1;whenNoneVisible=!0}}return whenNoneVisible}getCheckedCount(){let count=0;const elements=this.elements;for(let i=0,n=elements.length;i<n;i++)elements[i].checked&&count++;return count}getVisibleCount(){let count=0;const elements=this.elements;for(let i=0,n=elements.length;i<n;i++)elements[i].hidden||count++;return count}setAllVisibleChecked(checked){try{this._fireCheckedEvents=!1,this.elements.forEach((element=>{element.hidden||(element.checked=checked)}))}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(inputElements){this.elementDisposables=(0,lifecycle_1.dispose)(this.elementDisposables);const fireButtonTriggered=event=>this.fireButtonTriggered(event);this.inputElements=inputElements,this.elements=inputElements.reduce(((result,item,index)=>{var _a,_b,_c;if("separator"!==item.type){const previous=index&&inputElements[index-1],saneLabel=item.label&&item.label.replace(/\r?\n/g," "),saneMeta=item.meta&&item.meta.replace(/\r?\n/g," "),saneDescription=item.description&&item.description.replace(/\r?\n/g," "),saneDetail=item.detail&&item.detail.replace(/\r?\n/g," "),saneAriaLabel=item.ariaLabel||[saneLabel,saneDescription,saneDetail].map((s=>(0,codicons_1.getCodiconAriaLabel)(s))).filter((s=>!!s)).join(", "),hasCheckbox=this.parent.classList.contains("show-checkboxes");result.push(new ListElement({hasCheckbox,index,item,saneLabel,saneMeta,saneAriaLabel,saneDescription,saneDetail,labelHighlights:null===(_a=item.highlights)||void 0===_a?void 0:_a.label,descriptionHighlights:null===(_b=item.highlights)||void 0===_b?void 0:_b.description,detailHighlights:null===(_c=item.highlights)||void 0===_c?void 0:_c.detail,checked:!1,separator:previous&&"separator"===previous.type?previous:void 0,fireButtonTriggered}))}return result}),[]),this.elementDisposables.push(...this.elements),this.elementDisposables.push(...this.elements.map((element=>element.onChecked((()=>this.fireCheckedEvents()))))),this.elementsToIndexes=this.elements.reduce(((map,element,index)=>(map.set(element.item,index),map)),new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map((e=>e.item))}setFocusedElements(items){if(this.list.setFocus(items.filter((item=>this.elementsToIndexes.has(item))).map((item=>this.elementsToIndexes.get(item)))),items.length>0){const focused=this.list.getFocus()[0];"number"==typeof focused&&this.list.reveal(focused)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(items){this.list.setSelection(items.filter((item=>this.elementsToIndexes.has(item))).map((item=>this.elementsToIndexes.get(item))))}getCheckedElements(){return this.elements.filter((e=>e.checked)).map((e=>e.item))}setCheckedElements(items){try{this._fireCheckedEvents=!1;const checked=new Set;for(const item of items)checked.add(item);for(const element of this.elements)element.checked=checked.has(element.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(value){this.list.getHTMLElement().style.pointerEvents=value?"":"none"}focus(what){if(!this.list.length)return;switch(what===QuickInputListFocus.Next&&this.list.getFocus()[0]===this.list.length-1&&(what=QuickInputListFocus.First),what===QuickInputListFocus.Previous&&0===this.list.getFocus()[0]&&(what=QuickInputListFocus.Last),what===QuickInputListFocus.Second&&this.list.length<2&&(what=QuickInputListFocus.First),what){case QuickInputListFocus.First:this.list.focusFirst();break;case QuickInputListFocus.Second:this.list.focusNth(1);break;case QuickInputListFocus.Last:this.list.focusLast();break;case QuickInputListFocus.Next:this.list.focusNext();break;case QuickInputListFocus.Previous:this.list.focusPrevious();break;case QuickInputListFocus.NextPage:this.list.focusNextPage();break;case QuickInputListFocus.PreviousPage:this.list.focusPreviousPage()}const focused=this.list.getFocus()[0];"number"==typeof focused&&this.list.reveal(focused)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}layout(maxHeight){this.list.getHTMLElement().style.maxHeight=maxHeight?`calc(${44*Math.floor(maxHeight/44)}px)`:"",this.list.layout()}filter(query){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;if((query=query.trim())&&(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail)){let currentSeparator;this.elements.forEach((element=>{const labelHighlights=this.matchOnLabel?(0,types_1.withNullAsUndefined)((0,iconLabels_1.matchesFuzzyIconAware)(query,(0,iconLabels_1.parseLabelWithIcons)(element.saneLabel))):void 0,descriptionHighlights=this.matchOnDescription?(0,types_1.withNullAsUndefined)((0,iconLabels_1.matchesFuzzyIconAware)(query,(0,iconLabels_1.parseLabelWithIcons)(element.saneDescription||""))):void 0,detailHighlights=this.matchOnDetail?(0,types_1.withNullAsUndefined)((0,iconLabels_1.matchesFuzzyIconAware)(query,(0,iconLabels_1.parseLabelWithIcons)(element.saneDetail||""))):void 0,metaHighlights=this.matchOnMeta?(0,types_1.withNullAsUndefined)((0,iconLabels_1.matchesFuzzyIconAware)(query,(0,iconLabels_1.parseLabelWithIcons)(element.saneMeta||""))):void 0;if(labelHighlights||descriptionHighlights||detailHighlights||metaHighlights?(element.labelHighlights=labelHighlights,element.descriptionHighlights=descriptionHighlights,element.detailHighlights=detailHighlights,element.hidden=!1):(element.labelHighlights=void 0,element.descriptionHighlights=void 0,element.detailHighlights=void 0,element.hidden=!element.item.alwaysShow),element.separator=void 0,!this.sortByLabel){const previous=element.index&&this.inputElements[element.index-1];currentSeparator=previous&&"separator"===previous.type?previous:currentSeparator,currentSeparator&&!element.hidden&&(element.separator=currentSeparator,currentSeparator=void 0)}}))}else this.elements.forEach((element=>{element.labelHighlights=void 0,element.descriptionHighlights=void 0,element.detailHighlights=void 0,element.hidden=!1;const previous=element.index&&this.inputElements[element.index-1];element.separator=previous&&"separator"===previous.type?previous:void 0}));const shownElements=this.elements.filter((element=>!element.hidden));if(this.sortByLabel&&query){const normalizedSearchValue=query.toLowerCase();shownElements.sort(((a,b)=>function compareEntries(elementA,elementB,lookFor){const labelHighlightsA=elementA.labelHighlights||[],labelHighlightsB=elementB.labelHighlights||[];if(labelHighlightsA.length&&!labelHighlightsB.length)return-1;if(!labelHighlightsA.length&&labelHighlightsB.length)return 1;if(0===labelHighlightsA.length&&0===labelHighlightsB.length)return 0;return(0,comparers_1.compareAnything)(elementA.saneLabel,elementB.saneLabel,lookFor)}(a,b,normalizedSearchValue)))}return this.elementsToIndexes=shownElements.reduce(((map,element,index)=>(map.set(element.item,index),map)),new Map),this.list.splice(0,this.list.length,shownElements),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(shownElements.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const elements=this.list.getFocusedElements(),allChecked=this.allVisibleChecked(elements);for(const element of elements)element.checked=!allChecked}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(display){this.container.style.display=display?"":"none"}isDisplayed(){return"none"!==this.container.style.display}dispose(){this.elementDisposables=(0,lifecycle_1.dispose)(this.elementDisposables),this.disposables=(0,lifecycle_1.dispose)(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(event){this._onButtonTriggered.fire(event)}style(styles){this.list.style(styles)}}__decorate([decorators_1.memoize],QuickInputList.prototype,"onDidChangeFocus",null),__decorate([decorators_1.memoize],QuickInputList.prototype,"onDidChangeSelection",null),exports.QuickInputList=QuickInputList;class QuickInputAccessibilityProvider{getWidgetAriaLabel(){return(0,nls_1.localize)(0,null)}getAriaLabel(element){return element.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(element){return element.hasCheckbox?"checkbox":"option"}isChecked(element){if(element.hasCheckbox)return{value:element.checked,onDidChange:element.onChecked}}}})),define(__m[503],__M([1,0,7,44,87,333,226,115,345,47,18,10,21,28,4,2,16,76,19,232,223,500,495,502,145]),(function(require,exports,dom,keyboardEvent_1,actionbar_1,button_1,countBadge_1,iconLabels_1,progressbar_1,actions_1,arrays_1,async_1,cancellation_1,codicons_1,event_1,lifecycle_1,platform_1,severity_1,types_1,quickInputUtils_1,quickInput_1,nls_1,quickInputBox_1,quickInputList_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickInputController=void 0;const $=dom.$,backButton={iconClass:codicons_1.Codicon.quickInputBack.classNames,tooltip:(0,nls_1.localize)(0,null),handle:-1};class QuickInput extends lifecycle_1.Disposable{constructor(ui){super(),this.ui=ui,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.noValidationMessage=QuickInput.noPromptMessage,this._severity=severity_1.default.Ignore,this.buttonsUpdated=!1,this.onDidTriggerButtonEmitter=this._register(new event_1.Emitter),this.onDidHideEmitter=this._register(new event_1.Emitter),this.onDisposeEmitter=this._register(new event_1.Emitter),this.visibleDisposables=this._register(new lifecycle_1.DisposableStore),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(title){this._title=title,this.update()}get description(){return this._description}set description(description){this._description=description,this.update()}get step(){return this._steps}set step(step){this._steps=step,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(totalSteps){this._totalSteps=totalSteps,this.update()}get enabled(){return this._enabled}set enabled(enabled){this._enabled=enabled,this.update()}get contextKey(){return this._contextKey}set contextKey(contextKey){this._contextKey=contextKey,this.update()}get busy(){return this._busy}set busy(busy){this._busy=busy,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(ignoreFocusOut){const shouldUpdate=this._ignoreFocusOut!==ignoreFocusOut&&!platform_1.isIOS;this._ignoreFocusOut=ignoreFocusOut&&!platform_1.isIOS,shouldUpdate&&this.update()}get buttons(){return this._buttons}set buttons(buttons){this._buttons=buttons,this.buttonsUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(validationMessage){this._validationMessage=validationMessage,this.update()}get severity(){return this._severity}set severity(severity){this._severity=severity,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton((button=>{-1!==this.buttons.indexOf(button)&&this.onDidTriggerButtonEmitter.fire(button)}))),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(reason=quickInput_1.QuickInputHideReason.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason})}update(){if(!this.visible)return;const title=this.getTitle();title&&this.ui.title.textContent!==title?this.ui.title.textContent=title:title||"&nbsp;"===this.ui.title.innerHTML||(this.ui.title.innerText=" ");const description=this.getDescription();if(this.ui.description1.textContent!==description&&(this.ui.description1.textContent=description),this.ui.description2.textContent!==description&&(this.ui.description2.textContent=description),this.busy&&!this.busyDelay&&(this.busyDelay=new async_1.TimeoutTimer,this.busyDelay.setIfNotSet((()=>{this.visible&&this.ui.progressBar.infinite()}),800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const leftButtons=this.buttons.filter((button=>button===backButton));this.ui.leftActionBar.push(leftButtons.map(((button,index)=>{const action=new actions_1.Action(`id-${index}`,"",button.iconClass||(0,quickInputUtils_1.getIconClass)(button.iconPath),!0,(()=>__awaiter(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(button)}))));return action.tooltip=button.tooltip||"",action})),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const rightButtons=this.buttons.filter((button=>button!==backButton));this.ui.rightActionBar.push(rightButtons.map(((button,index)=>{const action=new actions_1.Action(`id-${index}`,"",button.iconClass||(0,quickInputUtils_1.getIconClass)(button.iconPath),!0,(()=>__awaiter(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(button)}))));return action.tooltip=button.tooltip||"",action})),{icon:!0,label:!1})}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const validationMessage=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==validationMessage&&(this._lastValidationMessage=validationMessage,dom.reset(this.ui.message,...(0,iconLabels_1.renderLabelWithIcons)(validationMessage))),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?(0,nls_1.localize)(2,null,this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(severity){if(this.ui.inputBox.showDecoration(severity),severity!==severity_1.default.Ignore){const styles=this.ui.inputBox.stylesForType(severity);this.ui.message.style.color=styles.foreground?`${styles.foreground}`:"",this.ui.message.style.backgroundColor=styles.background?`${styles.background}`:"",this.ui.message.style.border=styles.border?`1px solid ${styles.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}QuickInput.noPromptMessage=(0,nls_1.localize)(1,null);class QuickPick extends QuickInput{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new event_1.Emitter),this.onWillAcceptEmitter=this._register(new event_1.Emitter),this.onDidAcceptEmitter=this._register(new event_1.Emitter),this.onDidCustomEmitter=this._register(new event_1.Emitter),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=this.ui.isScreenReaderOptimized()?quickInput_1.ItemActivation.NONE:quickInput_1.ItemActivation.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new event_1.Emitter),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new event_1.Emitter),this.onDidTriggerItemButtonEmitter=this._register(new event_1.Emitter),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=value=>value,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(quickNavigate){this._quickNavigate=quickNavigate,this.update()}get value(){return this._value}set value(value){this.doSetValue(value)}doSetValue(value,skipUpdate){if(this._value!==value){if(this._value=value,skipUpdate||this.update(),this.visible){this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst()}this.onDidChangeValueEmitter.fire(this._value)}}set ariaLabel(ariaLabel){this._ariaLabel=ariaLabel,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(placeholder){this._placeholder=placeholder,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(scrollTop){this.ui.list.scrollTop=scrollTop}set items(items){this._items=items,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(canSelectMany){this._canSelectMany=canSelectMany,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(canAcceptInBackground){this._canAcceptInBackground=canAcceptInBackground}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(matchOnDescription){this._matchOnDescription=matchOnDescription,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(matchOnDetail){this._matchOnDetail=matchOnDetail,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(matchOnLabel){this._matchOnLabel=matchOnLabel,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(sortByLabel){this._sortByLabel=sortByLabel,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(autoFocusOnList){this._autoFocusOnList=autoFocusOnList,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(keepScrollPosition){this._keepScrollPosition=keepScrollPosition}get itemActivation(){return this._itemActivation}set itemActivation(itemActivation){this._itemActivation=itemActivation}get activeItems(){return this._activeItems}set activeItems(activeItems){this._activeItems=activeItems,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(selectedItems){this._selectedItems=selectedItems,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?quickInput_1.NO_KEY_MODS:this.ui.keyMods}set valueSelection(valueSelection){this._valueSelection=valueSelection,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(showCustomButton){this._customButton=showCustomButton,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(label){this._customButtonLabel=label,this.update()}get customHover(){return this._customButtonHover}set customHover(hover){this._customButtonHover=hover,this.update()}get ok(){return this._ok}set ok(showOkButton){this._ok=showOkButton,this.update()}get hideInput(){return!!this._hideInput}set hideInput(hideInput){this._hideInput=hideInput,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(quickInputList_1.QuickInputListFocus.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange((value=>{this.doSetValue(value,!0)}))),this.visibleDisposables.add(this.ui.inputBox.onMouseDown((event=>{this.autoFocusOnList||this.ui.list.clearFocus()}))),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown((event=>{switch(event.keyCode){case 18:this.ui.list.focus(quickInputList_1.QuickInputListFocus.Next),this.canSelectMany&&this.ui.list.domFocus(),dom.EventHelper.stop(event,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(quickInputList_1.QuickInputListFocus.Previous):this.ui.list.focus(quickInputList_1.QuickInputListFocus.Last),this.canSelectMany&&this.ui.list.domFocus(),dom.EventHelper.stop(event,!0);break;case 12:this.ui.list.focus(quickInputList_1.QuickInputListFocus.NextPage),this.canSelectMany&&this.ui.list.domFocus(),dom.EventHelper.stop(event,!0);break;case 11:this.ui.list.focus(quickInputList_1.QuickInputListFocus.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),dom.EventHelper.stop(event,!0);break;case 17:if(!this._canAcceptInBackground)return;if(!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:!event.ctrlKey&&!event.metaKey||event.shiftKey||event.altKey||(this.ui.list.focus(quickInputList_1.QuickInputListFocus.First),dom.EventHelper.stop(event,!0));break;case 13:!event.ctrlKey&&!event.metaKey||event.shiftKey||event.altKey||(this.ui.list.focus(quickInputList_1.QuickInputListFocus.Last),dom.EventHelper.stop(event,!0))}}))),this.visibleDisposables.add(this.ui.onDidAccept((()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)}))),this.visibleDisposables.add(this.ui.onDidCustom((()=>{this.onDidCustomEmitter.fire()}))),this.visibleDisposables.add(this.ui.list.onDidChangeFocus((focusedItems=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&(0,arrays_1.equals)(focusedItems,this._activeItems,((a,b)=>a===b))||(this._activeItems=focusedItems,this.onDidChangeActiveEmitter.fire(focusedItems))}))),this.visibleDisposables.add(this.ui.list.onDidChangeSelection((({items:selectedItems,event})=>{this.canSelectMany?selectedItems.length&&this.ui.list.setSelectedElements([]):this.selectedItemsToConfirm!==this._selectedItems&&(0,arrays_1.equals)(selectedItems,this._selectedItems,((a,b)=>a===b))||(this._selectedItems=selectedItems,this.onDidChangeSelectionEmitter.fire(selectedItems),selectedItems.length&&this.handleAccept(event instanceof MouseEvent&&1===event.button))}))),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements((checkedItems=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&(0,arrays_1.equals)(checkedItems,this._selectedItems,((a,b)=>a===b))||(this._selectedItems=checkedItems,this.onDidChangeSelectionEmitter.fire(checkedItems)))}))),this.visibleDisposables.add(this.ui.list.onButtonTriggered((event=>this.onDidTriggerItemButtonEmitter.fire(event)))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(inBackground){let veto=!1;this.onWillAcceptEmitter.fire({veto:()=>veto=!0}),veto||this.onDidAcceptEmitter.fire({inBackground})}registerQuickNavigation(){return dom.addDisposableListener(this.ui.container,dom.EventType.KEY_UP,(e=>{if(this.canSelectMany||!this._quickNavigate)return;const keyboardEvent=new keyboardEvent_1.StandardKeyboardEvent(e),keyCode=keyboardEvent.keyCode;this._quickNavigate.keybindings.some((k=>{const[firstPart,chordPart]=k.getParts();return!chordPart&&(firstPart.shiftKey&&4===keyCode?!(keyboardEvent.ctrlKey||keyboardEvent.altKey||keyboardEvent.metaKey):!(!firstPart.altKey||6!==keyCode)||(!(!firstPart.ctrlKey||5!==keyCode)||!(!firstPart.metaKey||57!==keyCode)))}))&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)}))}update(){if(!this.visible)return;const scrollTopBefore=this.keepScrollPosition?this.scrollTop:0,hideInput=!!this._hideInput&&this._items.length>0;this.ui.container.classList.toggle("hidden-input",hideInput&&!this.description);const visibilities={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!hideInput,progressBar:!hideInput,visibleCount:!0,count:this.canSelectMany,ok:"default"===this.ok?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(visibilities),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");const ariaLabel=this.ariaLabel||this.placeholder||QuickPick.DEFAULT_ARIA_LABEL;if(this.ui.inputBox.ariaLabel!==ariaLabel&&(this.ui.inputBox.ariaLabel=ariaLabel),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case quickInput_1.ItemActivation.NONE:this._itemActivation=quickInput_1.ItemActivation.FIRST;break;case quickInput_1.ItemActivation.SECOND:this.ui.list.focus(quickInputList_1.QuickInputListFocus.Second),this._itemActivation=quickInput_1.ItemActivation.FIRST;break;case quickInput_1.ItemActivation.LAST:this.ui.list.focus(quickInputList_1.QuickInputListFocus.Last),this._itemActivation=quickInput_1.ItemActivation.FIRST;break;default:this.trySelectFirst()}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",this.ui.setComboboxAccessibility(!0),visibilities.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(quickInputList_1.QuickInputListFocus.First)),this.keepScrollPosition&&(this.scrollTop=scrollTopBefore)}}QuickPick.DEFAULT_ARIA_LABEL=(0,nls_1.localize)(3,null);class QuickInputController extends lifecycle_1.Disposable{constructor(options){super(),this.options=options,this.comboboxAccessibility=!1,this.enabled=!0,this.onDidAcceptEmitter=this._register(new event_1.Emitter),this.onDidCustomEmitter=this._register(new event_1.Emitter),this.onDidTriggerButtonEmitter=this._register(new event_1.Emitter),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new event_1.Emitter),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new event_1.Emitter),this.onHide=this.onHideEmitter.event,this.idPrefix=options.idPrefix,this.parentElement=options.container,this.styles=options.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const listener=e=>{this.keyMods.ctrlCmd=e.ctrlKey||e.metaKey,this.keyMods.alt=e.altKey};this._register(dom.addDisposableListener(window,dom.EventType.KEY_DOWN,listener,!0)),this._register(dom.addDisposableListener(window,dom.EventType.KEY_UP,listener,!0)),this._register(dom.addDisposableListener(window,dom.EventType.MOUSE_DOWN,listener,!0))}getUI(){if(this.ui)return this.ui;const container=dom.append(this.parentElement,$(".quick-input-widget.show-file-icons"));container.tabIndex=-1,container.style.display="none";const styleSheet=dom.createStyleSheet(container),titleBar=dom.append(container,$(".quick-input-titlebar")),leftActionBar=this._register(new actionbar_1.ActionBar(titleBar));leftActionBar.domNode.classList.add("quick-input-left-action-bar");const title=dom.append(titleBar,$(".quick-input-title")),rightActionBar=this._register(new actionbar_1.ActionBar(titleBar));rightActionBar.domNode.classList.add("quick-input-right-action-bar");const description1=dom.append(container,$(".quick-input-description")),headerContainer=dom.append(container,$(".quick-input-header")),checkAll=dom.append(headerContainer,$("input.quick-input-check-all"));checkAll.type="checkbox",this._register(dom.addStandardDisposableListener(checkAll,dom.EventType.CHANGE,(e=>{const checked=checkAll.checked;list.setAllVisibleChecked(checked)}))),this._register(dom.addDisposableListener(checkAll,dom.EventType.CLICK,(e=>{(e.x||e.y)&&inputBox.setFocus()})));const description2=dom.append(headerContainer,$(".quick-input-description")),extraContainer=dom.append(headerContainer,$(".quick-input-and-message")),filterContainer=dom.append(extraContainer,$(".quick-input-filter")),inputBox=this._register(new quickInputBox_1.QuickInputBox(filterContainer));inputBox.setAttribute("aria-describedby",`${this.idPrefix}message`);const visibleCountContainer=dom.append(filterContainer,$(".quick-input-visible-count"));visibleCountContainer.setAttribute("aria-live","polite"),visibleCountContainer.setAttribute("aria-atomic","true");const visibleCount=new countBadge_1.CountBadge(visibleCountContainer,{countFormat:(0,nls_1.localize)(4,null)}),countContainer=dom.append(filterContainer,$(".quick-input-count"));countContainer.setAttribute("aria-live","polite");const count=new countBadge_1.CountBadge(countContainer,{countFormat:(0,nls_1.localize)(5,null)}),okContainer=dom.append(headerContainer,$(".quick-input-action")),ok=new button_1.Button(okContainer);ok.label=(0,nls_1.localize)(6,null),this._register(ok.onDidClick((e=>{this.onDidAcceptEmitter.fire()})));const customButtonContainer=dom.append(headerContainer,$(".quick-input-action")),customButton=new button_1.Button(customButtonContainer);customButton.label=(0,nls_1.localize)(7,null),this._register(customButton.onDidClick((e=>{this.onDidCustomEmitter.fire()})));const message=dom.append(extraContainer,$(`#${this.idPrefix}message.quick-input-message`)),list=this._register(new quickInputList_1.QuickInputList(container,this.idPrefix+"list",this.options));this._register(list.onChangedAllVisibleChecked((checked=>{checkAll.checked=checked}))),this._register(list.onChangedVisibleCount((c=>{visibleCount.setCount(c)}))),this._register(list.onChangedCheckedCount((c=>{count.setCount(c)}))),this._register(list.onLeave((()=>{setTimeout((()=>{inputBox.setFocus(),this.controller instanceof QuickPick&&this.controller.canSelectMany&&list.clearFocus()}),0)}))),this._register(list.onDidChangeFocus((()=>{this.comboboxAccessibility&&this.getUI().inputBox.setAttribute("aria-activedescendant",this.getUI().list.getActiveDescendant()||"")})));const progressBar=new progressbar_1.ProgressBar(container);progressBar.getContainer().classList.add("quick-input-progress");const focusTracker=dom.trackFocus(container);return this._register(focusTracker),this._register(dom.addDisposableListener(container,dom.EventType.FOCUS,(e=>{this.previousFocusElement=e.relatedTarget instanceof HTMLElement?e.relatedTarget:void 0}),!0)),this._register(focusTracker.onDidBlur((()=>{this.getUI().ignoreFocusOut||this.options.ignoreFocusOut()||this.hide(quickInput_1.QuickInputHideReason.Blur),this.previousFocusElement=void 0}))),this._register(dom.addDisposableListener(container,dom.EventType.FOCUS,(e=>{inputBox.setFocus()}))),this._register(dom.addDisposableListener(container,dom.EventType.KEY_DOWN,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);switch(event.keyCode){case 3:dom.EventHelper.stop(e,!0),this.onDidAcceptEmitter.fire();break;case 9:dom.EventHelper.stop(e,!0),this.hide(quickInput_1.QuickInputHideReason.Gesture);break;case 2:if(!event.altKey&&!event.ctrlKey&&!event.metaKey){const selectors=[".action-label.codicon"];container.classList.contains("show-checkboxes")?selectors.push("input"):selectors.push("input[type=text]"),this.getUI().list.isDisplayed()&&selectors.push(".monaco-list");const stops=container.querySelectorAll(selectors.join(", "));event.shiftKey&&event.target===stops[0]?(dom.EventHelper.stop(e,!0),stops[stops.length-1].focus()):event.shiftKey||event.target!==stops[stops.length-1]||(dom.EventHelper.stop(e,!0),stops[0].focus())}}}))),this.ui={container,styleSheet,leftActionBar,titleBar,title,description1,description2,rightActionBar,checkAll,filterContainer,inputBox,visibleCountContainer,visibleCount,countContainer,count,okContainer,ok,message,customButtonContainer,customButton,list,progressBar,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,isScreenReaderOptimized:()=>this.options.isScreenReaderOptimized(),show:controller=>this.show(controller),hide:()=>this.hide(),setVisibilities:visibilities=>this.setVisibilities(visibilities),setComboboxAccessibility:enabled=>this.setComboboxAccessibility(enabled),setEnabled:enabled=>this.setEnabled(enabled),setContextKey:contextKey=>this.options.setContextKey(contextKey)},this.updateStyles(),this.ui}pick(picks,options={},token=cancellation_1.CancellationToken.None){return new Promise(((doResolve,reject)=>{let resolve=result=>{resolve=doResolve,options.onKeyMods&&options.onKeyMods(input.keyMods),doResolve(result)};if(token.isCancellationRequested)return void resolve(void 0);const input=this.createQuickPick();let activeItem;const disposables=[input,input.onDidAccept((()=>{if(input.canSelectMany)resolve(input.selectedItems.slice()),input.hide();else{const result=input.activeItems[0];result&&(resolve(result),input.hide())}})),input.onDidChangeActive((items=>{const focused=items[0];focused&&options.onDidFocus&&options.onDidFocus(focused)})),input.onDidChangeSelection((items=>{if(!input.canSelectMany){const result=items[0];result&&(resolve(result),input.hide())}})),input.onDidTriggerItemButton((event=>options.onDidTriggerItemButton&&options.onDidTriggerItemButton(Object.assign(Object.assign({},event),{removeItem:()=>{const index=input.items.indexOf(event.item);if(-1!==index){const items=input.items.slice(),removed=items.splice(index,1),activeItems=input.activeItems.filter((activeItem=>activeItem!==removed[0])),keepScrollPositionBefore=input.keepScrollPosition;input.keepScrollPosition=!0,input.items=items,activeItems&&(input.activeItems=activeItems),input.keepScrollPosition=keepScrollPositionBefore}}})))),input.onDidChangeValue((value=>{!activeItem||value||1===input.activeItems.length&&input.activeItems[0]===activeItem||(input.activeItems=[activeItem])})),token.onCancellationRequested((()=>{input.hide()})),input.onDidHide((()=>{(0,lifecycle_1.dispose)(disposables),resolve(void 0)}))];input.title=options.title,input.canSelectMany=!!options.canPickMany,input.placeholder=options.placeHolder,input.ignoreFocusOut=!!options.ignoreFocusLost,input.matchOnDescription=!!options.matchOnDescription,input.matchOnDetail=!!options.matchOnDetail,input.matchOnLabel=void 0===options.matchOnLabel||options.matchOnLabel,input.autoFocusOnList=void 0===options.autoFocusOnList||options.autoFocusOnList,input.quickNavigate=options.quickNavigate,input.contextKey=options.contextKey,input.busy=!0,Promise.all([picks,options.activeItem]).then((([items,_activeItem])=>{activeItem=_activeItem,input.busy=!1,input.items=items,input.canSelectMany&&(input.selectedItems=items.filter((item=>"separator"!==item.type&&item.picked))),activeItem&&(input.activeItems=[activeItem])})),input.show(),Promise.resolve(picks).then(void 0,(err=>{reject(err),input.hide()}))}))}createQuickPick(){const ui=this.getUI();return new QuickPick(ui)}show(controller){const ui=this.getUI();this.onShowEmitter.fire();const oldController=this.controller;this.controller=controller,oldController&&oldController.didHide(),this.setEnabled(!0),ui.leftActionBar.clear(),ui.title.textContent="",ui.description1.textContent="",ui.description2.textContent="",ui.rightActionBar.clear(),ui.checkAll.checked=!1,ui.inputBox.placeholder="",ui.inputBox.password=!1,ui.inputBox.showDecoration(severity_1.default.Ignore),ui.visibleCount.setCount(0),ui.count.setCount(0),dom.reset(ui.message),ui.progressBar.stop(),ui.list.setElements([]),ui.list.matchOnDescription=!1,ui.list.matchOnDetail=!1,ui.list.matchOnLabel=!0,ui.list.sortByLabel=!0,ui.ignoreFocusOut=!1,this.setComboboxAccessibility(!1),ui.inputBox.ariaLabel="";const backKeybindingLabel=this.options.backKeybindingLabel();backButton.tooltip=backKeybindingLabel?(0,nls_1.localize)(8,null,backKeybindingLabel):(0,nls_1.localize)(9,null),ui.container.style.display="",this.updateLayout(),ui.inputBox.setFocus()}setVisibilities(visibilities){const ui=this.getUI();ui.title.style.display=visibilities.title?"":"none",ui.description1.style.display=visibilities.description&&(visibilities.inputBox||visibilities.checkAll)?"":"none",ui.description2.style.display=!visibilities.description||visibilities.inputBox||visibilities.checkAll?"none":"",ui.checkAll.style.display=visibilities.checkAll?"":"none",ui.filterContainer.style.display=visibilities.inputBox?"":"none",ui.visibleCountContainer.style.display=visibilities.visibleCount?"":"none",ui.countContainer.style.display=visibilities.count?"":"none",ui.okContainer.style.display=visibilities.ok?"":"none",ui.customButtonContainer.style.display=visibilities.customButton?"":"none",ui.message.style.display=visibilities.message?"":"none",ui.progressBar.getContainer().style.display=visibilities.progressBar?"":"none",ui.list.display(!!visibilities.list),ui.container.classList[visibilities.checkBox?"add":"remove"]("show-checkboxes"),this.updateLayout()}setComboboxAccessibility(enabled){if(enabled!==this.comboboxAccessibility){const ui=this.getUI();this.comboboxAccessibility=enabled,this.comboboxAccessibility?(ui.inputBox.setAttribute("role","combobox"),ui.inputBox.setAttribute("aria-haspopup","true"),ui.inputBox.setAttribute("aria-autocomplete","list"),ui.inputBox.setAttribute("aria-activedescendant",ui.list.getActiveDescendant()||"")):(ui.inputBox.removeAttribute("role"),ui.inputBox.removeAttribute("aria-haspopup"),ui.inputBox.removeAttribute("aria-autocomplete"),ui.inputBox.removeAttribute("aria-activedescendant"))}}setEnabled(enabled){if(enabled!==this.enabled){this.enabled=enabled;for(const item of this.getUI().leftActionBar.viewItems)item.getAction().enabled=enabled;for(const item of this.getUI().rightActionBar.viewItems)item.getAction().enabled=enabled;this.getUI().checkAll.disabled=!enabled,this.getUI().ok.enabled=enabled,this.getUI().list.enabled=enabled}}hide(reason){var _a;const controller=this.controller;if(controller){const focusChanged=!(null===(_a=this.ui)||void 0===_a?void 0:_a.container.contains(document.activeElement));if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!focusChanged){let currentElement=this.previousFocusElement;for(;currentElement&&!currentElement.offsetParent;)currentElement=(0,types_1.withNullAsUndefined)(currentElement.parentElement);(null==currentElement?void 0:currentElement.offsetParent)?(currentElement.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}controller.didHide(reason)}}layout(dimension,titleBarOffset){this.dimension=dimension,this.titleBarOffset=titleBarOffset,this.updateLayout()}updateLayout(){if(this.ui){this.ui.container.style.top=`${this.titleBarOffset}px`;const style=this.ui.container.style,width=Math.min(.62*this.dimension.width,QuickInputController.MAX_WIDTH);style.width=width+"px",style.marginLeft="-"+width/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&.4*this.dimension.height)}}applyStyles(styles){this.styles=styles,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground,quickInputBackground,quickInputForeground,contrastBorder,widgetShadow}=this.styles.widget;this.ui.titleBar.style.backgroundColor=quickInputTitleBackground?quickInputTitleBackground.toString():"",this.ui.container.style.backgroundColor=quickInputBackground?quickInputBackground.toString():"",this.ui.container.style.color=quickInputForeground?quickInputForeground.toString():"",this.ui.container.style.border=contrastBorder?`1px solid ${contrastBorder}`:"",this.ui.container.style.boxShadow=widgetShadow?`0 0 8px 2px ${widgetShadow}`:"",this.ui.inputBox.style(this.styles.inputBox),this.ui.count.style(this.styles.countBadge),this.ui.ok.style(this.styles.button),this.ui.customButton.style(this.styles.button),this.ui.progressBar.style(this.styles.progressBar),this.ui.list.style(this.styles.list);const content=[];this.styles.list.pickerGroupBorder&&content.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`),this.styles.list.pickerGroupForeground&&content.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(content.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&content.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&content.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&content.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&content.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&content.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),content.push("}"));const newStyles=content.join("\n");newStyles!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=newStyles)}}}exports.QuickInputController=QuickInputController,QuickInputController.MAX_WIDTH=600})),define(__m[504],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/controller/textAreaHandler",data)})),define(__m[505],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/coreCommands",data)})),define(__m[506],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/editorExtensions",data)})),define(__m[507],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/widget/codeEditorWidget",data)})),define(__m[508],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/widget/diffEditorWidget",data)})),define(__m[509],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/widget/diffReview",data)})),define(__m[510],__M([5,6]),(function(nls,data){return nls.create("vs/editor/browser/widget/inlineDiffMargin",data)})),define(__m[511],__M([1,0,510,7,47,2,3,28]),(function(require,exports,nls,dom,actions_1,lifecycle_1,range_1,codicons_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InlineDiffMargin=void 0;class InlineDiffMargin extends lifecycle_1.Disposable{constructor(_viewZoneId,_marginDomNode,editor,diff,_contextMenuService,_clipboardService){super(),this._viewZoneId=_viewZoneId,this._marginDomNode=_marginDomNode,this.editor=editor,this.diff=diff,this._contextMenuService=_contextMenuService,this._clipboardService=_clipboardService,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=codicons_1.Codicon.lightBulb.classNames+" lightbulb-glyph",this._diffActions.style.position="absolute";const lineHeight=editor.getOption(59),lineFeed=editor.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${lineHeight}px`,this._diffActions.style.lineHeight=`${lineHeight}px`,this._marginDomNode.appendChild(this._diffActions);const actions=[],isDeletion=0===diff.modifiedEndLineNumber;actions.push(new actions_1.Action("diff.clipboard.copyDeletedContent",isDeletion?diff.originalEndLineNumber>diff.modifiedStartLineNumber?nls.localize(0,null):nls.localize(1,null):diff.originalEndLineNumber>diff.modifiedStartLineNumber?nls.localize(2,null):nls.localize(3,null),void 0,!0,(()=>__awaiter(this,void 0,void 0,(function*(){const range=new range_1.Range(diff.originalStartLineNumber,1,diff.originalEndLineNumber+1,1),deletedText=diff.originalModel.getValueInRange(range);yield this._clipboardService.writeText(deletedText)})))));let copyLineAction,currentLineNumberOffset=0;diff.originalEndLineNumber>diff.modifiedStartLineNumber&&(copyLineAction=new actions_1.Action("diff.clipboard.copyDeletedLineContent",isDeletion?nls.localize(4,null,diff.originalStartLineNumber):nls.localize(5,null,diff.originalStartLineNumber),void 0,!0,(()=>__awaiter(this,void 0,void 0,(function*(){const lineContent=diff.originalModel.getLineContent(diff.originalStartLineNumber+currentLineNumberOffset);if(""===lineContent){const eof=diff.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===eof?"\n":"\r\n")}else yield this._clipboardService.writeText(lineContent)})))),actions.push(copyLineAction));editor.getOption(81)||actions.push(new actions_1.Action("diff.inline.revertChange",nls.localize(6,null),void 0,!0,(()=>__awaiter(this,void 0,void 0,(function*(){const range=new range_1.Range(diff.originalStartLineNumber,1,diff.originalEndLineNumber,diff.originalModel.getLineMaxColumn(diff.originalEndLineNumber)),deletedText=diff.originalModel.getValueInRange(range);if(0===diff.modifiedEndLineNumber){const column=editor.getModel().getLineMaxColumn(diff.modifiedStartLineNumber);editor.executeEdits("diffEditor",[{range:new range_1.Range(diff.modifiedStartLineNumber,column,diff.modifiedStartLineNumber,column),text:lineFeed+deletedText}])}else{const column=editor.getModel().getLineMaxColumn(diff.modifiedEndLineNumber);editor.executeEdits("diffEditor",[{range:new range_1.Range(diff.modifiedStartLineNumber,1,diff.modifiedEndLineNumber,column),text:deletedText}])}})))));const showContextMenu=(x,y)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x,y}),getActions:()=>(copyLineAction&&(copyLineAction.label=isDeletion?nls.localize(7,null,diff.originalStartLineNumber+currentLineNumberOffset):nls.localize(8,null,diff.originalStartLineNumber+currentLineNumberOffset)),actions),autoSelectFirstItem:!0})};this._register(dom.addStandardDisposableListener(this._diffActions,"mousedown",(e=>{const{top,height}=dom.getDomNodePagePosition(this._diffActions),pad=Math.floor(lineHeight/3);e.preventDefault(),showContextMenu(e.posx,top+height+pad)}))),this._register(editor.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){e.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,currentLineNumberOffset=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,lineHeight)):this.visibility=!1}else this.visibility=!1}))),this._register(editor.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){e.target.detail.viewZoneId===this._viewZoneId&&(e.event.preventDefault(),currentLineNumberOffset=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,lineHeight),showContextMenu(e.event.posx,e.event.posy+lineHeight))}})))}get visibility(){return this._visibility}set visibility(_visibility){this._visibility!==_visibility&&(this._visibility=_visibility,this._diffActions.style.visibility=_visibility?"visible":"hidden")}_updateLightBulbPosition(marginDomNode,y,lineHeight){const{top}=dom.getDomNodePagePosition(marginDomNode),offset=y-top,lineNumberOffset=Math.floor(offset/lineHeight),newTop=lineNumberOffset*lineHeight;if(this._diffActions.style.top=`${newTop}px`,this.diff.viewLineCounts){let acc=0;for(let i=0;i<this.diff.viewLineCounts.length;i++)if(acc+=this.diff.viewLineCounts[i],lineNumberOffset<acc)return i}return lineNumberOffset}}exports.InlineDiffMargin=InlineDiffMargin})),define(__m[512],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/config/editorConfigurationSchema",data)})),define(__m[513],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/config/editorOptions",data)})),define(__m[32],__M([1,0,513,16,121,18,40,148]),(function(require,exports,nls,platform,wordHelper_1,arrays,objects,textModelDefaults_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorOptions=exports.editorOptionsRegistry=exports.EDITOR_FONT_DEFAULTS=exports.unicodeHighlightConfigKeys=exports.inUntrustedWorkspace=exports.filterValidationDecorations=exports.EditorLayoutInfoComputer=exports.EditorFontLigatures=exports.TextEditorCursorStyle=exports.stringSet=exports.clampedInt=exports.boolean=exports.ApplyUpdateResult=exports.ComputeOptionsMemory=exports.ConfigurationChangedEvent=exports.MINIMAP_GUTTER_WIDTH=void 0,exports.MINIMAP_GUTTER_WIDTH=8;exports.ConfigurationChangedEvent=class ConfigurationChangedEvent{constructor(values){this._values=values}hasChanged(id){return this._values[id]}};class ComputeOptionsMemory{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}exports.ComputeOptionsMemory=ComputeOptionsMemory;class BaseEditorOption{constructor(id,name,defaultValue,schema){this.id=id,this.name=name,this.defaultValue=defaultValue,this.schema=schema}applyUpdate(value,update){return applyUpdate(value,update)}compute(env,options,value){return value}}class ApplyUpdateResult{constructor(newValue,didChange){this.newValue=newValue,this.didChange=didChange}}function applyUpdate(value,update){if("object"!=typeof value||"object"!=typeof update||!value||!update)return new ApplyUpdateResult(update,value!==update);if(Array.isArray(value)||Array.isArray(update)){const arrayEquals=Array.isArray(value)&&Array.isArray(update)&&arrays.equals(value,update);return new ApplyUpdateResult(update,arrayEquals)}let didChange=!1;for(const key in update)if(update.hasOwnProperty(key)){const result=applyUpdate(value[key],update[key]);result.didChange&&(value[key]=result.newValue,didChange=!0)}return new ApplyUpdateResult(value,didChange)}exports.ApplyUpdateResult=ApplyUpdateResult;class ComputedEditorOption{constructor(id){this.schema=void 0,this.id=id,this.name="_never_",this.defaultValue=void 0}applyUpdate(value,update){return applyUpdate(value,update)}validate(input){return this.defaultValue}}class SimpleEditorOption{constructor(id,name,defaultValue,schema){this.id=id,this.name=name,this.defaultValue=defaultValue,this.schema=schema}applyUpdate(value,update){return applyUpdate(value,update)}validate(input){return void 0===input?this.defaultValue:input}compute(env,options,value){return value}}function boolean(value,defaultValue){return void 0===value?defaultValue:"false"!==value&&Boolean(value)}exports.boolean=boolean;class EditorBooleanOption extends SimpleEditorOption{constructor(id,name,defaultValue,schema){void 0!==schema&&(schema.type="boolean",schema.default=defaultValue),super(id,name,defaultValue,schema)}validate(input){return boolean(input,this.defaultValue)}}function clampedInt(value,defaultValue,minimum,maximum){if(void 0===value)return defaultValue;let r=parseInt(value,10);return isNaN(r)?defaultValue:(r=Math.max(minimum,r),r=Math.min(maximum,r),0|r)}exports.clampedInt=clampedInt;class EditorIntOption extends SimpleEditorOption{constructor(id,name,defaultValue,minimum,maximum,schema){void 0!==schema&&(schema.type="integer",schema.default=defaultValue,schema.minimum=minimum,schema.maximum=maximum),super(id,name,defaultValue,schema),this.minimum=minimum,this.maximum=maximum}static clampedInt(value,defaultValue,minimum,maximum){return clampedInt(value,defaultValue,minimum,maximum)}validate(input){return EditorIntOption.clampedInt(input,this.defaultValue,this.minimum,this.maximum)}}class EditorFloatOption extends SimpleEditorOption{constructor(id,name,defaultValue,validationFn,schema){void 0!==schema&&(schema.type="number",schema.default=defaultValue),super(id,name,defaultValue,schema),this.validationFn=validationFn}static clamp(n,min,max){return n<min?min:n>max?max:n}static float(value,defaultValue){if("number"==typeof value)return value;if(void 0===value)return defaultValue;const r=parseFloat(value);return isNaN(r)?defaultValue:r}validate(input){return this.validationFn(EditorFloatOption.float(input,this.defaultValue))}}class EditorStringOption extends SimpleEditorOption{static string(value,defaultValue){return"string"!=typeof value?defaultValue:value}constructor(id,name,defaultValue,schema){void 0!==schema&&(schema.type="string",schema.default=defaultValue),super(id,name,defaultValue,schema)}validate(input){return EditorStringOption.string(input,this.defaultValue)}}function stringSet(value,defaultValue,allowedValues){return"string"!=typeof value||-1===allowedValues.indexOf(value)?defaultValue:value}exports.stringSet=stringSet;class EditorStringEnumOption extends SimpleEditorOption{constructor(id,name,defaultValue,allowedValues,schema){void 0!==schema&&(schema.type="string",schema.enum=allowedValues,schema.default=defaultValue),super(id,name,defaultValue,schema),this._allowedValues=allowedValues}validate(input){return stringSet(input,this.defaultValue,this._allowedValues)}}class EditorEnumOption extends BaseEditorOption{constructor(id,name,defaultValue,defaultStringValue,allowedValues,convert,schema){void 0!==schema&&(schema.type="string",schema.enum=allowedValues,schema.default=defaultStringValue),super(id,name,defaultValue,schema),this._allowedValues=allowedValues,this._convert=convert}validate(input){return"string"!=typeof input||-1===this._allowedValues.indexOf(input)?this.defaultValue:this._convert(input)}}var TextEditorCursorStyle;!function(TextEditorCursorStyle){TextEditorCursorStyle[TextEditorCursorStyle.Line=1]="Line",TextEditorCursorStyle[TextEditorCursorStyle.Block=2]="Block",TextEditorCursorStyle[TextEditorCursorStyle.Underline=3]="Underline",TextEditorCursorStyle[TextEditorCursorStyle.LineThin=4]="LineThin",TextEditorCursorStyle[TextEditorCursorStyle.BlockOutline=5]="BlockOutline",TextEditorCursorStyle[TextEditorCursorStyle.UnderlineThin=6]="UnderlineThin"}(TextEditorCursorStyle=exports.TextEditorCursorStyle||(exports.TextEditorCursorStyle={}));class EditorFontLigatures extends BaseEditorOption{constructor(){super(45,"fontLigatures",EditorFontLigatures.OFF,{anyOf:[{type:"boolean",description:nls.localize(19,null)},{type:"string",description:nls.localize(20,null)}],description:nls.localize(21,null),default:!1})}validate(input){return void 0===input?this.defaultValue:"string"==typeof input?"false"===input?EditorFontLigatures.OFF:"true"===input?EditorFontLigatures.ON:input:Boolean(input)?EditorFontLigatures.ON:EditorFontLigatures.OFF}}exports.EditorFontLigatures=EditorFontLigatures,EditorFontLigatures.OFF='"liga" off, "calt" off',EditorFontLigatures.ON='"liga" on, "calt" on';class EditorFontWeight extends BaseEditorOption{constructor(){super(47,"fontWeight",exports.EDITOR_FONT_DEFAULTS.fontWeight,{anyOf:[{type:"number",minimum:EditorFontWeight.MINIMUM_VALUE,maximum:EditorFontWeight.MAXIMUM_VALUE,errorMessage:nls.localize(23,null)},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:EditorFontWeight.SUGGESTION_VALUES}],default:exports.EDITOR_FONT_DEFAULTS.fontWeight,description:nls.localize(24,null)})}validate(input){return"normal"===input||"bold"===input?input:String(EditorIntOption.clampedInt(input,exports.EDITOR_FONT_DEFAULTS.fontWeight,EditorFontWeight.MINIMUM_VALUE,EditorFontWeight.MAXIMUM_VALUE))}}EditorFontWeight.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],EditorFontWeight.MINIMUM_VALUE=1,EditorFontWeight.MAXIMUM_VALUE=1e3;class EditorLayoutInfoComputer extends ComputedEditorOption{constructor(){super(131)}compute(env,options,_){return EditorLayoutInfoComputer.computeLayout(options,{memory:env.memory,outerWidth:env.outerWidth,outerHeight:env.outerHeight,isDominatedByLongLines:env.isDominatedByLongLines,lineHeight:env.fontInfo.lineHeight,viewLineCount:env.viewLineCount,lineNumbersDigitCount:env.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:env.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:env.fontInfo.maxDigitWidth,pixelRatio:env.pixelRatio})}static computeContainedMinimapLineCount(input){const typicalViewportLineCount=input.height/input.lineHeight,extraLinesBeyondLastLine=input.scrollBeyondLastLine?typicalViewportLineCount-1:0,desiredRatio=(input.viewLineCount+extraLinesBeyondLastLine)/(input.pixelRatio*input.height);return{typicalViewportLineCount,extraLinesBeyondLastLine,desiredRatio,minimapLineCount:Math.floor(input.viewLineCount/desiredRatio)}}static _computeMinimapLayout(input,memory){const outerWidth=input.outerWidth,outerHeight=input.outerHeight,pixelRatio=input.pixelRatio;if(!input.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(pixelRatio*outerHeight),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:outerHeight};const stableMinimapLayoutInput=memory.stableMinimapLayoutInput,couldUseMemory=stableMinimapLayoutInput&&input.outerHeight===stableMinimapLayoutInput.outerHeight&&input.lineHeight===stableMinimapLayoutInput.lineHeight&&input.typicalHalfwidthCharacterWidth===stableMinimapLayoutInput.typicalHalfwidthCharacterWidth&&input.pixelRatio===stableMinimapLayoutInput.pixelRatio&&input.scrollBeyondLastLine===stableMinimapLayoutInput.scrollBeyondLastLine&&input.minimap.enabled===stableMinimapLayoutInput.minimap.enabled&&input.minimap.side===stableMinimapLayoutInput.minimap.side&&input.minimap.size===stableMinimapLayoutInput.minimap.size&&input.minimap.showSlider===stableMinimapLayoutInput.minimap.showSlider&&input.minimap.renderCharacters===stableMinimapLayoutInput.minimap.renderCharacters&&input.minimap.maxColumn===stableMinimapLayoutInput.minimap.maxColumn&&input.minimap.scale===stableMinimapLayoutInput.minimap.scale&&input.verticalScrollbarWidth===stableMinimapLayoutInput.verticalScrollbarWidth&&input.isViewportWrapping===stableMinimapLayoutInput.isViewportWrapping,lineHeight=input.lineHeight,typicalHalfwidthCharacterWidth=input.typicalHalfwidthCharacterWidth,scrollBeyondLastLine=input.scrollBeyondLastLine,minimapRenderCharacters=input.minimap.renderCharacters;let minimapScale=pixelRatio>=2?Math.round(2*input.minimap.scale):input.minimap.scale;const minimapMaxColumn=input.minimap.maxColumn,minimapSize=input.minimap.size,minimapSide=input.minimap.side,verticalScrollbarWidth=input.verticalScrollbarWidth,viewLineCount=input.viewLineCount,remainingWidth=input.remainingWidth,isViewportWrapping=input.isViewportWrapping,baseCharHeight=minimapRenderCharacters?2:3;let minimapCanvasInnerHeight=Math.floor(pixelRatio*outerHeight);const minimapCanvasOuterHeight=minimapCanvasInnerHeight/pixelRatio;let minimapHeightIsEditorHeight=!1,minimapIsSampling=!1,minimapLineHeight=baseCharHeight*minimapScale,minimapCharWidth=minimapScale/pixelRatio,minimapWidthMultiplier=1;if("fill"===minimapSize||"fit"===minimapSize){const{typicalViewportLineCount,extraLinesBeyondLastLine,desiredRatio,minimapLineCount}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount,scrollBeyondLastLine,height:outerHeight,lineHeight,pixelRatio});if(viewLineCount/minimapLineCount>1)minimapHeightIsEditorHeight=!0,minimapIsSampling=!0,minimapScale=1,minimapLineHeight=1,minimapCharWidth=minimapScale/pixelRatio;else{let fitBecomesFill=!1,maxMinimapScale=minimapScale+1;if("fit"===minimapSize){const effectiveMinimapHeight=Math.ceil((viewLineCount+extraLinesBeyondLastLine)*minimapLineHeight);isViewportWrapping&&couldUseMemory&&remainingWidth<=memory.stableFitRemainingWidth?(fitBecomesFill=!0,maxMinimapScale=memory.stableFitMaxMinimapScale):fitBecomesFill=effectiveMinimapHeight>minimapCanvasInnerHeight}if("fill"===minimapSize||fitBecomesFill){minimapHeightIsEditorHeight=!0;const configuredMinimapScale=minimapScale;minimapLineHeight=Math.min(lineHeight*pixelRatio,Math.max(1,Math.floor(1/desiredRatio))),isViewportWrapping&&couldUseMemory&&remainingWidth<=memory.stableFitRemainingWidth&&(maxMinimapScale=memory.stableFitMaxMinimapScale),minimapScale=Math.min(maxMinimapScale,Math.max(1,Math.floor(minimapLineHeight/baseCharHeight))),minimapScale>configuredMinimapScale&&(minimapWidthMultiplier=Math.min(2,minimapScale/configuredMinimapScale)),minimapCharWidth=minimapScale/pixelRatio/minimapWidthMultiplier,minimapCanvasInnerHeight=Math.ceil(Math.max(typicalViewportLineCount,viewLineCount+extraLinesBeyondLastLine)*minimapLineHeight),isViewportWrapping?(memory.stableMinimapLayoutInput=input,memory.stableFitRemainingWidth=remainingWidth,memory.stableFitMaxMinimapScale=minimapScale):(memory.stableMinimapLayoutInput=null,memory.stableFitRemainingWidth=0)}}}const minimapMaxWidth=Math.floor(minimapMaxColumn*minimapCharWidth),minimapWidth=Math.min(minimapMaxWidth,Math.max(0,Math.floor((remainingWidth-verticalScrollbarWidth-2)*minimapCharWidth/(typicalHalfwidthCharacterWidth+minimapCharWidth)))+exports.MINIMAP_GUTTER_WIDTH);let minimapCanvasInnerWidth=Math.floor(pixelRatio*minimapWidth);const minimapCanvasOuterWidth=minimapCanvasInnerWidth/pixelRatio;minimapCanvasInnerWidth=Math.floor(minimapCanvasInnerWidth*minimapWidthMultiplier);return{renderMinimap:minimapRenderCharacters?1:2,minimapLeft:"left"===minimapSide?0:outerWidth-minimapWidth-verticalScrollbarWidth,minimapWidth,minimapHeightIsEditorHeight,minimapIsSampling,minimapScale,minimapLineHeight,minimapCanvasInnerWidth,minimapCanvasInnerHeight,minimapCanvasOuterWidth,minimapCanvasOuterHeight}}static computeLayout(options,env){const outerWidth=0|env.outerWidth,outerHeight=0|env.outerHeight,lineHeight=0|env.lineHeight,lineNumbersDigitCount=0|env.lineNumbersDigitCount,typicalHalfwidthCharacterWidth=env.typicalHalfwidthCharacterWidth,maxDigitWidth=env.maxDigitWidth,pixelRatio=env.pixelRatio,viewLineCount=env.viewLineCount,wordWrapOverride2=options.get(123),wordWrapOverride1="inherit"===wordWrapOverride2?options.get(122):wordWrapOverride2,wordWrap="inherit"===wordWrapOverride1?options.get(118):wordWrapOverride1,wordWrapColumn=options.get(121),accessibilitySupport=options.get(2),isDominatedByLongLines=env.isDominatedByLongLines,showGlyphMargin=options.get(50),showLineNumbers=0!==options.get(60).renderType,lineNumbersMinChars=options.get(61),scrollBeyondLastLine=options.get(94),minimap=options.get(65),scrollbar=options.get(92),verticalScrollbarWidth=scrollbar.verticalScrollbarSize,verticalScrollbarHasArrows=scrollbar.verticalHasArrows,scrollbarArrowSize=scrollbar.arrowSize,horizontalScrollbarHeight=scrollbar.horizontalScrollbarSize,rawLineDecorationsWidth=options.get(58),folding=options.get(37);let lineDecorationsWidth;if("string"==typeof rawLineDecorationsWidth&&/^\d+(\.\d+)?ch$/.test(rawLineDecorationsWidth)){const multiple=parseFloat(rawLineDecorationsWidth.substr(0,rawLineDecorationsWidth.length-2));lineDecorationsWidth=EditorIntOption.clampedInt(multiple*typicalHalfwidthCharacterWidth,0,0,1e3)}else lineDecorationsWidth=EditorIntOption.clampedInt(rawLineDecorationsWidth,0,0,1e3);folding&&(lineDecorationsWidth+=16);let lineNumbersWidth=0;if(showLineNumbers){const digitCount=Math.max(lineNumbersDigitCount,lineNumbersMinChars);lineNumbersWidth=Math.round(digitCount*maxDigitWidth)}let glyphMarginWidth=0;showGlyphMargin&&(glyphMarginWidth=lineHeight);let glyphMarginLeft=0,lineNumbersLeft=glyphMarginLeft+glyphMarginWidth,decorationsLeft=lineNumbersLeft+lineNumbersWidth,contentLeft=decorationsLeft+lineDecorationsWidth;const remainingWidth=outerWidth-glyphMarginWidth-lineNumbersWidth-lineDecorationsWidth;let isWordWrapMinified=!1,isViewportWrapping=!1,wrappingColumn=-1;2!==accessibilitySupport&&("inherit"===wordWrapOverride1&&isDominatedByLongLines?(isWordWrapMinified=!0,isViewportWrapping=!0):"on"===wordWrap||"bounded"===wordWrap?isViewportWrapping=!0:"wordWrapColumn"===wordWrap&&(wrappingColumn=wordWrapColumn));const minimapLayout=EditorLayoutInfoComputer._computeMinimapLayout({outerWidth,outerHeight,lineHeight,typicalHalfwidthCharacterWidth,pixelRatio,scrollBeyondLastLine,minimap,verticalScrollbarWidth,viewLineCount,remainingWidth,isViewportWrapping},env.memory||new ComputeOptionsMemory);0!==minimapLayout.renderMinimap&&0===minimapLayout.minimapLeft&&(glyphMarginLeft+=minimapLayout.minimapWidth,lineNumbersLeft+=minimapLayout.minimapWidth,decorationsLeft+=minimapLayout.minimapWidth,contentLeft+=minimapLayout.minimapWidth);const contentWidth=remainingWidth-minimapLayout.minimapWidth,viewportColumn=Math.max(1,Math.floor((contentWidth-verticalScrollbarWidth-2)/typicalHalfwidthCharacterWidth)),verticalArrowSize=verticalScrollbarHasArrows?scrollbarArrowSize:0;return isViewportWrapping&&(wrappingColumn=Math.max(1,viewportColumn),"bounded"===wordWrap&&(wrappingColumn=Math.min(wrappingColumn,wordWrapColumn))),{width:outerWidth,height:outerHeight,glyphMarginLeft,glyphMarginWidth,lineNumbersLeft,lineNumbersWidth,decorationsLeft,decorationsWidth:lineDecorationsWidth,contentLeft,contentWidth,minimap:minimapLayout,viewportColumn,isWordWrapMinified,isViewportWrapping,wrappingColumn,verticalScrollbarWidth,horizontalScrollbarHeight,overviewRuler:{top:verticalArrowSize,width:verticalScrollbarWidth,height:outerHeight-2*verticalArrowSize,right:0}}}}exports.EditorLayoutInfoComputer=EditorLayoutInfoComputer;exports.filterValidationDecorations=function filterValidationDecorations(options){const renderValidationDecorations=options.get(87);return"editable"===renderValidationDecorations?options.get(81):"on"!==renderValidationDecorations};function _scrollbarVisibilityFromString(visibility,defaultValue){if("string"!=typeof visibility)return defaultValue;switch(visibility){case"hidden":return 2;case"visible":return 3;default:return 1}}exports.inUntrustedWorkspace="inUntrustedWorkspace",exports.unicodeHighlightConfigKeys={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};function primitiveSet(value,defaultValue,allowedValues){const idx=allowedValues.indexOf(value);return-1===idx?defaultValue:allowedValues[idx]}function register(option){return exports.editorOptionsRegistry[option.id]=option,option}exports.EDITOR_FONT_DEFAULTS={fontFamily:platform.isMacintosh?"Menlo, Monaco, 'Courier New', monospace":platform.isLinux?"'Droid Sans Mono', 'monospace', monospace":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:platform.isMacintosh?12:14,lineHeight:0,letterSpacing:0},exports.editorOptionsRegistry=[],exports.EditorOptions={acceptSuggestionOnCommitCharacter:register(new EditorBooleanOption(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:nls.localize(148,null)})),acceptSuggestionOnEnter:register(new EditorStringEnumOption(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",nls.localize(149,null),""],markdownDescription:nls.localize(150,null)})),accessibilitySupport:register(new class EditorAccessibilitySupport extends BaseEditorOption{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[nls.localize(0,null),nls.localize(1,null),nls.localize(2,null)],default:"auto",description:nls.localize(3,null)})}validate(input){switch(input){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(env,options,value){return 0===value?env.accessibilitySupport:value}}),accessibilityPageSize:register(new EditorIntOption(3,"accessibilityPageSize",10,1,1073741824,{description:nls.localize(151,null)})),ariaLabel:register(new EditorStringOption(4,"ariaLabel",nls.localize(152,null))),autoClosingBrackets:register(new EditorStringEnumOption(5,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",nls.localize(153,null),nls.localize(154,null),""],description:nls.localize(155,null)})),autoClosingDelete:register(new EditorStringEnumOption(6,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",nls.localize(156,null),""],description:nls.localize(157,null)})),autoClosingOvertype:register(new EditorStringEnumOption(7,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",nls.localize(158,null),""],description:nls.localize(159,null)})),autoClosingQuotes:register(new EditorStringEnumOption(8,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",nls.localize(160,null),nls.localize(161,null),""],description:nls.localize(162,null)})),autoIndent:register(new EditorEnumOption(9,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],(function _autoIndentFromString(autoIndent){switch(autoIndent){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}),{enumDescriptions:[nls.localize(163,null),nls.localize(164,null),nls.localize(165,null),nls.localize(166,null),nls.localize(167,null)],description:nls.localize(168,null)})),automaticLayout:register(new EditorBooleanOption(10,"automaticLayout",!1)),autoSurround:register(new EditorStringEnumOption(11,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[nls.localize(169,null),nls.localize(170,null),nls.localize(171,null),""],description:nls.localize(172,null)})),bracketPairColorization:register(new class BracketPairColorization extends BaseEditorOption{constructor(){const defaults={enabled:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.enabled};super(12,"bracketPairColorization",defaults,{"editor.bracketPairColorization.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(93,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;return{enabled:boolean(_input.enabled,this.defaultValue.enabled)}}}),bracketPairGuides:register(new class GuideOptions extends BaseEditorOption{constructor(){const defaults={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(13,"guides",defaults,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[nls.localize(94,null),nls.localize(95,null),nls.localize(96,null)],default:defaults.bracketPairs,description:nls.localize(97,null)},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[nls.localize(98,null),nls.localize(99,null),nls.localize(100,null)],default:defaults.bracketPairsHorizontal,description:nls.localize(101,null)},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:defaults.highlightActiveBracketPair,description:nls.localize(102,null)},"editor.guides.indentation":{type:"boolean",default:defaults.indentation,description:nls.localize(103,null)},"editor.guides.highlightActiveIndentation":{type:"boolean",default:defaults.highlightActiveIndentation,description:nls.localize(104,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{bracketPairs:primitiveSet(input.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:primitiveSet(input.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:boolean(input.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:boolean(input.indentation,this.defaultValue.indentation),highlightActiveIndentation:boolean(input.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation)}}}),stickyTabStops:register(new EditorBooleanOption(104,"stickyTabStops",!1,{description:nls.localize(173,null)})),codeLens:register(new EditorBooleanOption(14,"codeLens",!0,{description:nls.localize(174,null)})),codeLensFontFamily:register(new EditorStringOption(15,"codeLensFontFamily","",{description:nls.localize(175,null)})),codeLensFontSize:register(new EditorIntOption(16,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:nls.localize(176,null)})),colorDecorators:register(new EditorBooleanOption(17,"colorDecorators",!0,{description:nls.localize(177,null)})),columnSelection:register(new EditorBooleanOption(18,"columnSelection",!1,{description:nls.localize(178,null)})),comments:register(new class EditorComments extends BaseEditorOption{constructor(){const defaults={insertSpace:!0,ignoreEmptyLines:!0};super(19,"comments",defaults,{"editor.comments.insertSpace":{type:"boolean",default:defaults.insertSpace,description:nls.localize(4,null)},"editor.comments.ignoreEmptyLines":{type:"boolean",default:defaults.ignoreEmptyLines,description:nls.localize(5,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{insertSpace:boolean(input.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:boolean(input.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}),contextmenu:register(new EditorBooleanOption(20,"contextmenu",!0)),copyWithSyntaxHighlighting:register(new EditorBooleanOption(21,"copyWithSyntaxHighlighting",!0,{description:nls.localize(179,null)})),cursorBlinking:register(new EditorEnumOption(22,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],(function _cursorBlinkingStyleFromString(cursorBlinkingStyle){switch(cursorBlinkingStyle){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}),{description:nls.localize(180,null)})),cursorSmoothCaretAnimation:register(new EditorBooleanOption(23,"cursorSmoothCaretAnimation",!1,{description:nls.localize(181,null)})),cursorStyle:register(new EditorEnumOption(24,"cursorStyle",TextEditorCursorStyle.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],(function _cursorStyleFromString(cursorStyle){switch(cursorStyle){case"line":return TextEditorCursorStyle.Line;case"block":return TextEditorCursorStyle.Block;case"underline":return TextEditorCursorStyle.Underline;case"line-thin":return TextEditorCursorStyle.LineThin;case"block-outline":return TextEditorCursorStyle.BlockOutline;case"underline-thin":return TextEditorCursorStyle.UnderlineThin}}),{description:nls.localize(182,null)})),cursorSurroundingLines:register(new EditorIntOption(25,"cursorSurroundingLines",0,0,1073741824,{description:nls.localize(183,null)})),cursorSurroundingLinesStyle:register(new EditorStringEnumOption(26,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[nls.localize(184,null),nls.localize(185,null)],description:nls.localize(186,null)})),cursorWidth:register(new EditorIntOption(27,"cursorWidth",0,0,1073741824,{markdownDescription:nls.localize(187,null)})),disableLayerHinting:register(new EditorBooleanOption(28,"disableLayerHinting",!1)),disableMonospaceOptimizations:register(new EditorBooleanOption(29,"disableMonospaceOptimizations",!1)),domReadOnly:register(new EditorBooleanOption(30,"domReadOnly",!1)),dragAndDrop:register(new EditorBooleanOption(31,"dragAndDrop",!0,{description:nls.localize(188,null)})),emptySelectionClipboard:register(new class EditorEmptySelectionClipboard extends EditorBooleanOption{constructor(){super(32,"emptySelectionClipboard",!0,{description:nls.localize(6,null)})}compute(env,options,value){return value&&env.emptySelectionClipboard}}),extraEditorClassName:register(new EditorStringOption(33,"extraEditorClassName","")),fastScrollSensitivity:register(new EditorFloatOption(34,"fastScrollSensitivity",5,(x=>x<=0?5:x),{markdownDescription:nls.localize(189,null)})),find:register(new class EditorFind extends BaseEditorOption{constructor(){const defaults={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(35,"find",defaults,{"editor.find.cursorMoveOnType":{type:"boolean",default:defaults.cursorMoveOnType,description:nls.localize(7,null)},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:defaults.seedSearchStringFromSelection,enumDescriptions:[nls.localize(8,null),nls.localize(9,null),nls.localize(10,null)],description:nls.localize(11,null)},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:defaults.autoFindInSelection,enumDescriptions:[nls.localize(12,null),nls.localize(13,null),nls.localize(14,null)],description:nls.localize(15,null)},"editor.find.globalFindClipboard":{type:"boolean",default:defaults.globalFindClipboard,description:nls.localize(16,null),included:platform.isMacintosh},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:defaults.addExtraSpaceOnTop,description:nls.localize(17,null)},"editor.find.loop":{type:"boolean",default:defaults.loop,description:nls.localize(18,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{cursorMoveOnType:boolean(input.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:"boolean"==typeof _input.seedSearchStringFromSelection?_input.seedSearchStringFromSelection?"always":"never":stringSet(input.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:"boolean"==typeof _input.autoFindInSelection?_input.autoFindInSelection?"always":"never":stringSet(input.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:boolean(input.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:boolean(input.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:boolean(input.loop,this.defaultValue.loop)}}}),fixedOverflowWidgets:register(new EditorBooleanOption(36,"fixedOverflowWidgets",!1)),folding:register(new EditorBooleanOption(37,"folding",!0,{description:nls.localize(190,null)})),foldingStrategy:register(new EditorStringEnumOption(38,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[nls.localize(191,null),nls.localize(192,null)],description:nls.localize(193,null)})),foldingHighlight:register(new EditorBooleanOption(39,"foldingHighlight",!0,{description:nls.localize(194,null)})),foldingImportsByDefault:register(new EditorBooleanOption(40,"foldingImportsByDefault",!1,{description:nls.localize(195,null)})),foldingMaximumRegions:register(new EditorIntOption(41,"foldingMaximumRegions",5e3,10,65e3,{description:nls.localize(196,null)})),unfoldOnClickAfterEndOfLine:register(new EditorBooleanOption(42,"unfoldOnClickAfterEndOfLine",!1,{description:nls.localize(197,null)})),fontFamily:register(new EditorStringOption(43,"fontFamily",exports.EDITOR_FONT_DEFAULTS.fontFamily,{description:nls.localize(198,null)})),fontInfo:register(new class EditorFontInfo extends ComputedEditorOption{constructor(){super(44)}compute(env,options,_){return env.fontInfo}}),fontLigatures2:register(new EditorFontLigatures),fontSize:register(new class EditorFontSize extends SimpleEditorOption{constructor(){super(46,"fontSize",exports.EDITOR_FONT_DEFAULTS.fontSize,{type:"number",minimum:6,maximum:100,default:exports.EDITOR_FONT_DEFAULTS.fontSize,description:nls.localize(22,null)})}validate(input){const r=EditorFloatOption.float(input,this.defaultValue);return 0===r?exports.EDITOR_FONT_DEFAULTS.fontSize:EditorFloatOption.clamp(r,6,100)}compute(env,options,value){return env.fontInfo.fontSize}}),fontWeight:register(new EditorFontWeight),formatOnPaste:register(new EditorBooleanOption(48,"formatOnPaste",!1,{description:nls.localize(199,null)})),formatOnType:register(new EditorBooleanOption(49,"formatOnType",!1,{description:nls.localize(200,null)})),glyphMargin:register(new EditorBooleanOption(50,"glyphMargin",!0,{description:nls.localize(201,null)})),gotoLocation:register(new class EditorGoToLocation extends BaseEditorOption{constructor(){const defaults={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},jsonSubset={type:"string",enum:["peek","gotoAndPeek","goto"],default:defaults.multiple,enumDescriptions:[nls.localize(25,null),nls.localize(26,null),nls.localize(27,null)]},alternativeCommandOptions=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(51,"gotoLocation",defaults,{"editor.gotoLocation.multiple":{deprecationMessage:nls.localize(28,null)},"editor.gotoLocation.multipleDefinitions":Object.assign({description:nls.localize(29,null)},jsonSubset),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:nls.localize(30,null)},jsonSubset),"editor.gotoLocation.multipleDeclarations":Object.assign({description:nls.localize(31,null)},jsonSubset),"editor.gotoLocation.multipleImplementations":Object.assign({description:nls.localize(32,null)},jsonSubset),"editor.gotoLocation.multipleReferences":Object.assign({description:nls.localize(33,null)},jsonSubset),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:defaults.alternativeDefinitionCommand,enum:alternativeCommandOptions,description:nls.localize(34,null)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:defaults.alternativeTypeDefinitionCommand,enum:alternativeCommandOptions,description:nls.localize(35,null)},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:defaults.alternativeDeclarationCommand,enum:alternativeCommandOptions,description:nls.localize(36,null)},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:defaults.alternativeImplementationCommand,enum:alternativeCommandOptions,description:nls.localize(37,null)},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:defaults.alternativeReferenceCommand,enum:alternativeCommandOptions,description:nls.localize(38,null)}})}validate(_input){var _a,_b,_c,_d,_e;if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{multiple:stringSet(input.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:null!==(_a=input.multipleDefinitions)&&void 0!==_a?_a:stringSet(input.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:null!==(_b=input.multipleTypeDefinitions)&&void 0!==_b?_b:stringSet(input.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:null!==(_c=input.multipleDeclarations)&&void 0!==_c?_c:stringSet(input.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:null!==(_d=input.multipleImplementations)&&void 0!==_d?_d:stringSet(input.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:null!==(_e=input.multipleReferences)&&void 0!==_e?_e:stringSet(input.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:EditorStringOption.string(input.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:EditorStringOption.string(input.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:EditorStringOption.string(input.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:EditorStringOption.string(input.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:EditorStringOption.string(input.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}),hideCursorInOverviewRuler:register(new EditorBooleanOption(52,"hideCursorInOverviewRuler",!1,{description:nls.localize(202,null)})),hover:register(new class EditorHover extends BaseEditorOption{constructor(){const defaults={enabled:!0,delay:300,sticky:!0,above:!0};super(53,"hover",defaults,{"editor.hover.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(39,null)},"editor.hover.delay":{type:"number",default:defaults.delay,minimum:0,maximum:1e4,description:nls.localize(40,null)},"editor.hover.sticky":{type:"boolean",default:defaults.sticky,description:nls.localize(41,null)},"editor.hover.above":{type:"boolean",default:defaults.above,description:nls.localize(42,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{enabled:boolean(input.enabled,this.defaultValue.enabled),delay:EditorIntOption.clampedInt(input.delay,this.defaultValue.delay,0,1e4),sticky:boolean(input.sticky,this.defaultValue.sticky),above:boolean(input.above,this.defaultValue.above)}}}),inDiffEditor:register(new EditorBooleanOption(54,"inDiffEditor",!1)),letterSpacing:register(new EditorFloatOption(56,"letterSpacing",exports.EDITOR_FONT_DEFAULTS.letterSpacing,(x=>EditorFloatOption.clamp(x,-5,20)),{description:nls.localize(203,null)})),lightbulb:register(new class EditorLightbulb extends BaseEditorOption{constructor(){const defaults={enabled:!0};super(57,"lightbulb",defaults,{"editor.lightbulb.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(43,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;return{enabled:boolean(_input.enabled,this.defaultValue.enabled)}}}),lineDecorationsWidth:register(new SimpleEditorOption(58,"lineDecorationsWidth",10)),lineHeight:register(new class EditorLineHeight extends EditorFloatOption{constructor(){super(59,"lineHeight",exports.EDITOR_FONT_DEFAULTS.lineHeight,(x=>EditorFloatOption.clamp(x,0,150)),{markdownDescription:nls.localize(47,null)})}compute(env,options,value){return env.fontInfo.lineHeight}}),lineNumbers:register(new class EditorRenderLineNumbersOption extends BaseEditorOption{constructor(){super(60,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[nls.localize(66,null),nls.localize(67,null),nls.localize(68,null),nls.localize(69,null)],default:"on",description:nls.localize(70,null)})}validate(lineNumbers){let renderType=this.defaultValue.renderType,renderFn=this.defaultValue.renderFn;return void 0!==lineNumbers&&("function"==typeof lineNumbers?(renderType=4,renderFn=lineNumbers):renderType="interval"===lineNumbers?3:"relative"===lineNumbers?2:"on"===lineNumbers?1:0),{renderType,renderFn}}}),lineNumbersMinChars:register(new EditorIntOption(61,"lineNumbersMinChars",5,1,300)),linkedEditing:register(new EditorBooleanOption(62,"linkedEditing",!1,{description:nls.localize(204,null)})),links:register(new EditorBooleanOption(63,"links",!0,{description:nls.localize(205,null)})),matchBrackets:register(new EditorStringEnumOption(64,"matchBrackets","always",["always","near","never"],{description:nls.localize(206,null)})),minimap:register(new class EditorMinimap extends BaseEditorOption{constructor(){const defaults={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",renderCharacters:!0,maxColumn:120,scale:1};super(65,"minimap",defaults,{"editor.minimap.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(48,null)},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[nls.localize(49,null),nls.localize(50,null),nls.localize(51,null)],default:defaults.size,description:nls.localize(52,null)},"editor.minimap.side":{type:"string",enum:["left","right"],default:defaults.side,description:nls.localize(53,null)},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:defaults.showSlider,description:nls.localize(54,null)},"editor.minimap.scale":{type:"number",default:defaults.scale,minimum:1,maximum:3,enum:[1,2,3],description:nls.localize(55,null)},"editor.minimap.renderCharacters":{type:"boolean",default:defaults.renderCharacters,description:nls.localize(56,null)},"editor.minimap.maxColumn":{type:"number",default:defaults.maxColumn,description:nls.localize(57,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{enabled:boolean(input.enabled,this.defaultValue.enabled),size:stringSet(input.size,this.defaultValue.size,["proportional","fill","fit"]),side:stringSet(input.side,this.defaultValue.side,["right","left"]),showSlider:stringSet(input.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:boolean(input.renderCharacters,this.defaultValue.renderCharacters),scale:EditorIntOption.clampedInt(input.scale,1,1,3),maxColumn:EditorIntOption.clampedInt(input.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}),mouseStyle:register(new EditorStringEnumOption(66,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:register(new EditorFloatOption(67,"mouseWheelScrollSensitivity",1,(x=>0===x?1:x),{markdownDescription:nls.localize(207,null)})),mouseWheelZoom:register(new EditorBooleanOption(68,"mouseWheelZoom",!1,{markdownDescription:nls.localize(208,null)})),multiCursorMergeOverlapping:register(new EditorBooleanOption(69,"multiCursorMergeOverlapping",!0,{description:nls.localize(209,null)})),multiCursorModifier:register(new EditorEnumOption(70,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],(function _multiCursorModifierFromString(multiCursorModifier){return"ctrlCmd"===multiCursorModifier?platform.isMacintosh?"metaKey":"ctrlKey":"altKey"}),{markdownEnumDescriptions:[nls.localize(210,null),nls.localize(211,null)],markdownDescription:nls.localize(212,null)})),multiCursorPaste:register(new EditorStringEnumOption(71,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[nls.localize(213,null),nls.localize(214,null)],markdownDescription:nls.localize(215,null)})),occurrencesHighlight:register(new EditorBooleanOption(72,"occurrencesHighlight",!0,{description:nls.localize(216,null)})),overviewRulerBorder:register(new EditorBooleanOption(73,"overviewRulerBorder",!0,{description:nls.localize(217,null)})),overviewRulerLanes:register(new EditorIntOption(74,"overviewRulerLanes",3,0,3)),padding:register(new class EditorPadding extends BaseEditorOption{constructor(){super(75,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:nls.localize(58,null)},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:nls.localize(59,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{top:EditorIntOption.clampedInt(input.top,0,0,1e3),bottom:EditorIntOption.clampedInt(input.bottom,0,0,1e3)}}}),parameterHints:register(new class EditorParameterHints extends BaseEditorOption{constructor(){const defaults={enabled:!0,cycle:!1};super(76,"parameterHints",defaults,{"editor.parameterHints.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(60,null)},"editor.parameterHints.cycle":{type:"boolean",default:defaults.cycle,description:nls.localize(61,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{enabled:boolean(input.enabled,this.defaultValue.enabled),cycle:boolean(input.cycle,this.defaultValue.cycle)}}}),peekWidgetDefaultFocus:register(new EditorStringEnumOption(77,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[nls.localize(218,null),nls.localize(219,null)],description:nls.localize(220,null)})),definitionLinkOpensInPeek:register(new EditorBooleanOption(78,"definitionLinkOpensInPeek",!1,{description:nls.localize(221,null)})),quickSuggestions:register(new class EditorQuickSuggestions extends BaseEditorOption{constructor(){const defaults={other:!0,comments:!1,strings:!1};super(79,"quickSuggestions",defaults,{anyOf:[{type:"boolean"},{type:"object",properties:{strings:{type:"boolean",default:defaults.strings,description:nls.localize(62,null)},comments:{type:"boolean",default:defaults.comments,description:nls.localize(63,null)},other:{type:"boolean",default:defaults.other,description:nls.localize(64,null)}}}],default:defaults,description:nls.localize(65,null)}),this.defaultValue=defaults}validate(_input){if("boolean"==typeof _input)return _input;if(_input&&"object"==typeof _input){const input=_input,opts={other:boolean(input.other,this.defaultValue.other),comments:boolean(input.comments,this.defaultValue.comments),strings:boolean(input.strings,this.defaultValue.strings)};return!!(opts.other&&opts.comments&&opts.strings)||!!(opts.other||opts.comments||opts.strings)&&opts}return this.defaultValue}}),quickSuggestionsDelay:register(new EditorIntOption(80,"quickSuggestionsDelay",10,0,1073741824,{description:nls.localize(222,null)})),readOnly:register(new EditorBooleanOption(81,"readOnly",!1)),renameOnType:register(new EditorBooleanOption(82,"renameOnType",!1,{description:nls.localize(223,null),markdownDeprecationMessage:nls.localize(224,null)})),renderControlCharacters:register(new EditorBooleanOption(83,"renderControlCharacters",!0,{description:nls.localize(225,null),restricted:!0})),renderFinalNewline:register(new EditorBooleanOption(84,"renderFinalNewline",!0,{description:nls.localize(226,null)})),renderLineHighlight:register(new EditorStringEnumOption(85,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",nls.localize(227,null)],description:nls.localize(228,null)})),renderLineHighlightOnlyWhenFocus:register(new EditorBooleanOption(86,"renderLineHighlightOnlyWhenFocus",!1,{description:nls.localize(229,null)})),renderValidationDecorations:register(new EditorStringEnumOption(87,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:register(new EditorStringEnumOption(88,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",nls.localize(230,null),nls.localize(231,null),nls.localize(232,null),""],description:nls.localize(233,null)})),revealHorizontalRightPadding:register(new EditorIntOption(89,"revealHorizontalRightPadding",30,0,1e3)),roundedSelection:register(new EditorBooleanOption(90,"roundedSelection",!0,{description:nls.localize(234,null)})),rulers:register(new class EditorRulers extends BaseEditorOption{constructor(){const defaults=[],columnSchema={type:"number",description:nls.localize(71,null)};super(91,"rulers",defaults,{type:"array",items:{anyOf:[columnSchema,{type:["object"],properties:{column:columnSchema,color:{type:"string",description:nls.localize(72,null),format:"color-hex"}}}]},default:defaults,description:nls.localize(73,null)})}validate(input){if(Array.isArray(input)){const rulers=[];for(let _element of input)if("number"==typeof _element)rulers.push({column:EditorIntOption.clampedInt(_element,0,0,1e4),color:null});else if(_element&&"object"==typeof _element){const element=_element;rulers.push({column:EditorIntOption.clampedInt(element.column,0,0,1e4),color:element.color})}return rulers.sort(((a,b)=>a.column-b.column)),rulers}return this.defaultValue}}),scrollbar:register(new class EditorScrollbar extends BaseEditorOption{constructor(){const defaults={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(92,"scrollbar",defaults,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[nls.localize(74,null),nls.localize(75,null),nls.localize(76,null)],default:"auto",description:nls.localize(77,null)},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[nls.localize(78,null),nls.localize(79,null),nls.localize(80,null)],default:"auto",description:nls.localize(81,null)},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:defaults.verticalScrollbarSize,description:nls.localize(82,null)},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:defaults.horizontalScrollbarSize,description:nls.localize(83,null)},"editor.scrollbar.scrollByPage":{type:"boolean",default:defaults.scrollByPage,description:nls.localize(84,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input,horizontalScrollbarSize=EditorIntOption.clampedInt(input.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),verticalScrollbarSize=EditorIntOption.clampedInt(input.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:EditorIntOption.clampedInt(input.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:_scrollbarVisibilityFromString(input.vertical,this.defaultValue.vertical),horizontal:_scrollbarVisibilityFromString(input.horizontal,this.defaultValue.horizontal),useShadows:boolean(input.useShadows,this.defaultValue.useShadows),verticalHasArrows:boolean(input.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:boolean(input.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:boolean(input.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:boolean(input.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize,horizontalSliderSize:EditorIntOption.clampedInt(input.horizontalSliderSize,horizontalScrollbarSize,0,1e3),verticalScrollbarSize,verticalSliderSize:EditorIntOption.clampedInt(input.verticalSliderSize,verticalScrollbarSize,0,1e3),scrollByPage:boolean(input.scrollByPage,this.defaultValue.scrollByPage)}}}),scrollBeyondLastColumn:register(new EditorIntOption(93,"scrollBeyondLastColumn",5,0,1073741824,{description:nls.localize(235,null)})),scrollBeyondLastLine:register(new EditorBooleanOption(94,"scrollBeyondLastLine",!0,{description:nls.localize(236,null)})),scrollPredominantAxis:register(new EditorBooleanOption(95,"scrollPredominantAxis",!0,{description:nls.localize(237,null)})),selectionClipboard:register(new EditorBooleanOption(96,"selectionClipboard",!0,{description:nls.localize(238,null),included:platform.isLinux})),selectionHighlight:register(new EditorBooleanOption(97,"selectionHighlight",!0,{description:nls.localize(239,null)})),selectOnLineNumbers:register(new EditorBooleanOption(98,"selectOnLineNumbers",!0)),showFoldingControls:register(new EditorStringEnumOption(99,"showFoldingControls","mouseover",["always","mouseover"],{enumDescriptions:[nls.localize(240,null),nls.localize(241,null)],description:nls.localize(242,null)})),showUnused:register(new EditorBooleanOption(100,"showUnused",!0,{description:nls.localize(243,null)})),showDeprecated:register(new EditorBooleanOption(126,"showDeprecated",!0,{description:nls.localize(244,null)})),inlayHints:register(new class EditorInlayHints extends BaseEditorOption{constructor(){const defaults={enabled:!0,fontSize:0,fontFamily:""};super(127,"inlayHints",defaults,{"editor.inlayHints.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(44,null)},"editor.inlayHints.fontSize":{type:"number",default:defaults.fontSize,markdownDescription:nls.localize(45,null)},"editor.inlayHints.fontFamily":{type:"string",default:defaults.fontFamily,markdownDescription:nls.localize(46,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{enabled:boolean(input.enabled,this.defaultValue.enabled),fontSize:EditorIntOption.clampedInt(input.fontSize,this.defaultValue.fontSize,0,100),fontFamily:EditorStringOption.string(input.fontFamily,this.defaultValue.fontFamily)}}}),snippetSuggestions:register(new EditorStringEnumOption(101,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[nls.localize(245,null),nls.localize(246,null),nls.localize(247,null),nls.localize(248,null)],description:nls.localize(249,null)})),smartSelect:register(new class SmartSelect extends BaseEditorOption{constructor(){super(102,"smartSelect",{selectLeadingAndTrailingWhitespace:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:nls.localize(147,null),default:!0,type:"boolean"}})}validate(input){return input&&"object"==typeof input?{selectLeadingAndTrailingWhitespace:boolean(input.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace)}:this.defaultValue}}),smoothScrolling:register(new EditorBooleanOption(103,"smoothScrolling",!1,{description:nls.localize(250,null)})),stopRenderingLineAfter:register(new EditorIntOption(105,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:register(new class EditorSuggest extends BaseEditorOption{constructor(){const defaults={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!0,localityBonus:!1,shareSuggestSelections:!1,showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(106,"suggest",defaults,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[nls.localize(105,null),nls.localize(106,null)],default:defaults.insertMode,description:nls.localize(107,null)},"editor.suggest.filterGraceful":{type:"boolean",default:defaults.filterGraceful,description:nls.localize(108,null)},"editor.suggest.localityBonus":{type:"boolean",default:defaults.localityBonus,description:nls.localize(109,null)},"editor.suggest.shareSuggestSelections":{type:"boolean",default:defaults.shareSuggestSelections,markdownDescription:nls.localize(110,null)},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:defaults.snippetsPreventQuickSuggestions,description:nls.localize(111,null)},"editor.suggest.showIcons":{type:"boolean",default:defaults.showIcons,description:nls.localize(112,null)},"editor.suggest.showStatusBar":{type:"boolean",default:defaults.showStatusBar,description:nls.localize(113,null)},"editor.suggest.preview":{type:"boolean",default:defaults.preview,description:nls.localize(114,null)},"editor.suggest.showInlineDetails":{type:"boolean",default:defaults.showInlineDetails,description:nls.localize(115,null)},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:nls.localize(116,null)},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:nls.localize(117,null)},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:nls.localize(118,null)},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:nls.localize(119,null)},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:nls.localize(120,null)},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:nls.localize(121,null)},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:nls.localize(122,null)},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:nls.localize(123,null)},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:nls.localize(124,null)},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:nls.localize(125,null)},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:nls.localize(126,null)},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:nls.localize(127,null)},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:nls.localize(128,null)},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:nls.localize(129,null)},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:nls.localize(130,null)},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:nls.localize(131,null)},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:nls.localize(132,null)},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:nls.localize(133,null)},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:nls.localize(134,null)},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:nls.localize(135,null)},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:nls.localize(136,null)},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:nls.localize(137,null)},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:nls.localize(138,null)},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:nls.localize(139,null)},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:nls.localize(140,null)},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:nls.localize(141,null)},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:nls.localize(142,null)},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:nls.localize(143,null)},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:nls.localize(144,null)},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:nls.localize(145,null)},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:nls.localize(146,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{insertMode:stringSet(input.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:boolean(input.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:boolean(input.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:boolean(input.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:boolean(input.shareSuggestSelections,this.defaultValue.shareSuggestSelections),showIcons:boolean(input.showIcons,this.defaultValue.showIcons),showStatusBar:boolean(input.showStatusBar,this.defaultValue.showStatusBar),preview:boolean(input.preview,this.defaultValue.preview),previewMode:stringSet(input.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:boolean(input.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:boolean(input.showMethods,this.defaultValue.showMethods),showFunctions:boolean(input.showFunctions,this.defaultValue.showFunctions),showConstructors:boolean(input.showConstructors,this.defaultValue.showConstructors),showDeprecated:boolean(input.showDeprecated,this.defaultValue.showDeprecated),showFields:boolean(input.showFields,this.defaultValue.showFields),showVariables:boolean(input.showVariables,this.defaultValue.showVariables),showClasses:boolean(input.showClasses,this.defaultValue.showClasses),showStructs:boolean(input.showStructs,this.defaultValue.showStructs),showInterfaces:boolean(input.showInterfaces,this.defaultValue.showInterfaces),showModules:boolean(input.showModules,this.defaultValue.showModules),showProperties:boolean(input.showProperties,this.defaultValue.showProperties),showEvents:boolean(input.showEvents,this.defaultValue.showEvents),showOperators:boolean(input.showOperators,this.defaultValue.showOperators),showUnits:boolean(input.showUnits,this.defaultValue.showUnits),showValues:boolean(input.showValues,this.defaultValue.showValues),showConstants:boolean(input.showConstants,this.defaultValue.showConstants),showEnums:boolean(input.showEnums,this.defaultValue.showEnums),showEnumMembers:boolean(input.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:boolean(input.showKeywords,this.defaultValue.showKeywords),showWords:boolean(input.showWords,this.defaultValue.showWords),showColors:boolean(input.showColors,this.defaultValue.showColors),showFiles:boolean(input.showFiles,this.defaultValue.showFiles),showReferences:boolean(input.showReferences,this.defaultValue.showReferences),showFolders:boolean(input.showFolders,this.defaultValue.showFolders),showTypeParameters:boolean(input.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:boolean(input.showSnippets,this.defaultValue.showSnippets),showUsers:boolean(input.showUsers,this.defaultValue.showUsers),showIssues:boolean(input.showIssues,this.defaultValue.showIssues)}}}),inlineSuggest:register(new class InlineEditorSuggest extends BaseEditorOption{constructor(){const defaults={enabled:!0,mode:"subwordSmart"};super(55,"inlineSuggest",defaults,{"editor.inlineSuggest.enabled":{type:"boolean",default:defaults.enabled,description:nls.localize(92,null)}})}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{enabled:boolean(input.enabled,this.defaultValue.enabled),mode:stringSet(input.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"])}}}),suggestFontSize:register(new EditorIntOption(107,"suggestFontSize",0,0,1e3,{markdownDescription:nls.localize(251,null)})),suggestLineHeight:register(new EditorIntOption(108,"suggestLineHeight",0,0,1e3,{markdownDescription:nls.localize(252,null)})),suggestOnTriggerCharacters:register(new EditorBooleanOption(109,"suggestOnTriggerCharacters",!0,{description:nls.localize(253,null)})),suggestSelection:register(new EditorStringEnumOption(110,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[nls.localize(254,null),nls.localize(255,null),nls.localize(256,null)],description:nls.localize(257,null)})),tabCompletion:register(new EditorStringEnumOption(111,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[nls.localize(258,null),nls.localize(259,null),nls.localize(260,null)],description:nls.localize(261,null)})),tabIndex:register(new EditorIntOption(112,"tabIndex",0,-1,1073741824)),unicodeHighlight:register(new class UnicodeHighlight extends BaseEditorOption{constructor(){const defaults={nonBasicASCII:exports.inUntrustedWorkspace,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:exports.inUntrustedWorkspace,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(113,"unicodeHighlight",defaults,{[exports.unicodeHighlightConfigKeys.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,exports.inUntrustedWorkspace],default:defaults.nonBasicASCII,description:nls.localize(85,null)},[exports.unicodeHighlightConfigKeys.invisibleCharacters]:{restricted:!0,type:"boolean",default:defaults.invisibleCharacters,description:nls.localize(86,null)},[exports.unicodeHighlightConfigKeys.ambiguousCharacters]:{restricted:!0,type:"boolean",default:defaults.ambiguousCharacters,description:nls.localize(87,null)},[exports.unicodeHighlightConfigKeys.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,exports.inUntrustedWorkspace],default:defaults.includeComments,description:nls.localize(88,null)},[exports.unicodeHighlightConfigKeys.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,exports.inUntrustedWorkspace],default:defaults.includeStrings,description:nls.localize(89,null)},[exports.unicodeHighlightConfigKeys.allowedCharacters]:{restricted:!0,type:"object",default:defaults.allowedCharacters,description:nls.localize(90,null),additionalProperties:{type:"boolean"}},[exports.unicodeHighlightConfigKeys.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:defaults.allowedLocales,description:nls.localize(91,null)}})}applyUpdate(value,update){let didChange=!1;update.allowedCharacters&&(objects.equals(value.allowedCharacters,update.allowedCharacters)||(value=Object.assign(Object.assign({},value),{allowedCharacters:update.allowedCharacters}),didChange=!0)),update.allowedLocales&&(objects.equals(value.allowedLocales,update.allowedLocales)||(value=Object.assign(Object.assign({},value),{allowedLocales:update.allowedLocales}),didChange=!0));const result=super.applyUpdate(value,update);return didChange?new ApplyUpdateResult(result.newValue,!0):result}validate(_input){if(!_input||"object"!=typeof _input)return this.defaultValue;const input=_input;return{nonBasicASCII:primitiveSet(input.nonBasicASCII,exports.inUntrustedWorkspace,[!0,!1,exports.inUntrustedWorkspace]),invisibleCharacters:boolean(input.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:boolean(input.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:primitiveSet(input.includeComments,exports.inUntrustedWorkspace,[!0,!1,exports.inUntrustedWorkspace]),includeStrings:primitiveSet(input.includeStrings,exports.inUntrustedWorkspace,[!0,!1,exports.inUntrustedWorkspace]),allowedCharacters:this.validateBooleanMap(_input.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(_input.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(map,defaultValue){if("object"!=typeof map||!map)return defaultValue;const result={};for(const[key,value]of Object.entries(map))!0===value&&(result[key]=!0);return result}}),unusualLineTerminators:register(new EditorStringEnumOption(114,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[nls.localize(262,null),nls.localize(263,null),nls.localize(264,null)],description:nls.localize(265,null)})),useShadowDOM:register(new EditorBooleanOption(115,"useShadowDOM",!0)),useTabStops:register(new EditorBooleanOption(116,"useTabStops",!0,{description:nls.localize(266,null)})),wordSeparators:register(new EditorStringOption(117,"wordSeparators",wordHelper_1.USUAL_WORD_SEPARATORS,{description:nls.localize(267,null)})),wordWrap:register(new EditorStringEnumOption(118,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[nls.localize(268,null),nls.localize(269,null),nls.localize(270,null),nls.localize(271,null)],description:nls.localize(272,null)})),wordWrapBreakAfterCharacters:register(new EditorStringOption(119,"wordWrapBreakAfterCharacters"," \t})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:register(new EditorStringOption(120,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:register(new EditorIntOption(121,"wordWrapColumn",80,1,1073741824,{markdownDescription:nls.localize(273,null)})),wordWrapOverride1:register(new EditorStringEnumOption(122,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:register(new EditorStringEnumOption(123,"wordWrapOverride2","inherit",["off","on","inherit"])),wrappingIndent:register(new EditorEnumOption(124,"wrappingIndent",1,"same",["none","same","indent","deepIndent"],(function _wrappingIndentFromString(wrappingIndent){switch(wrappingIndent){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}}),{enumDescriptions:[nls.localize(274,null),nls.localize(275,null),nls.localize(276,null),nls.localize(277,null)],description:nls.localize(278,null)})),wrappingStrategy:register(new EditorStringEnumOption(125,"wrappingStrategy","simple",["simple","advanced"],{enumDescriptions:[nls.localize(279,null),nls.localize(280,null)],description:nls.localize(281,null)})),editorClassName:register(new class EditorClassName extends ComputedEditorOption{constructor(){super(128)}compute(env,options,_){const classNames=["monaco-editor"];return options.get(33)&&classNames.push(options.get(33)),env.extraEditorClassName&&classNames.push(env.extraEditorClassName),"default"===options.get(66)?classNames.push("mouse-default"):"copy"===options.get(66)&&classNames.push("mouse-copy"),options.get(100)&&classNames.push("showUnused"),options.get(126)&&classNames.push("showDeprecated"),classNames.join(" ")}}),pixelRatio:register(new class EditorPixelRatio extends ComputedEditorOption{constructor(){super(129)}compute(env,options,_){return env.pixelRatio}}),tabFocusMode:register(new class EditorTabFocusMode extends ComputedEditorOption{constructor(){super(130)}compute(env,options,_){return!!options.get(81)||env.tabFocusMode}}),layoutInfo:register(new EditorLayoutInfoComputer),wrappingInfo:register(new class EditorWrappingInfoComputer extends ComputedEditorOption{constructor(){super(132)}compute(env,options,_){const layoutInfo=options.get(131);return{isDominatedByLongLines:env.isDominatedByLongLines,isWordWrapMinified:layoutInfo.isWordWrapMinified,isViewportWrapping:layoutInfo.isViewportWrapping,wrappingColumn:layoutInfo.wrappingColumn}}})}})),define(__m[64],__M([1,0,34,31,32]),(function(require,exports,browser,fastDomNode_1,editorOptions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyFontInfo=void 0,exports.applyFontInfo=function applyFontInfo(domNode,fontInfo){domNode instanceof fastDomNode_1.FastDomNode?(domNode.setFontFamily(fontInfo.getMassagedFontFamily(browser.isSafari?editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily:null)),domNode.setFontWeight(fontInfo.fontWeight),domNode.setFontSize(fontInfo.fontSize),domNode.setFontFeatureSettings(fontInfo.fontFeatureSettings),domNode.setLineHeight(fontInfo.lineHeight),domNode.setLetterSpacing(fontInfo.letterSpacing)):(domNode.style.fontFamily=fontInfo.getMassagedFontFamily(browser.isSafari?editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily:null),domNode.style.fontWeight=fontInfo.fontWeight,domNode.style.fontSize=fontInfo.fontSize+"px",domNode.style.fontFeatureSettings=fontInfo.fontFeatureSettings,domNode.style.lineHeight=fontInfo.lineHeight+"px",domNode.style.letterSpacing=fontInfo.letterSpacing+"px")}})),define(__m[514],__M([1,0,64]),(function(require,exports,domFontInfo_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readCharWidths=exports.CharWidthRequest=void 0;exports.CharWidthRequest=class CharWidthRequest{constructor(chr,type){this.chr=chr,this.type=type,this.width=0}fulfill(width){this.width=width}};class DomCharWidthReader{constructor(bareFontInfo,requests){this._bareFontInfo=bareFontInfo,this._requests=requests,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const container=document.createElement("div");container.style.position="absolute",container.style.top="-50000px",container.style.width="50000px";const regularDomNode=document.createElement("div");(0,domFontInfo_1.applyFontInfo)(regularDomNode,this._bareFontInfo),container.appendChild(regularDomNode);const boldDomNode=document.createElement("div");(0,domFontInfo_1.applyFontInfo)(boldDomNode,this._bareFontInfo),boldDomNode.style.fontWeight="bold",container.appendChild(boldDomNode);const italicDomNode=document.createElement("div");(0,domFontInfo_1.applyFontInfo)(italicDomNode,this._bareFontInfo),italicDomNode.style.fontStyle="italic",container.appendChild(italicDomNode);const testElements=[];for(const request of this._requests){let parent;0===request.type&&(parent=regularDomNode),2===request.type&&(parent=boldDomNode),1===request.type&&(parent=italicDomNode),parent.appendChild(document.createElement("br"));const testElement=document.createElement("span");DomCharWidthReader._render(testElement,request),parent.appendChild(testElement),testElements.push(testElement)}this._container=container,this._testElements=testElements}static _render(testElement,request){if(" "===request.chr){let htmlString=" ";for(let i=0;i<8;i++)htmlString+=htmlString;testElement.innerText=htmlString}else{let testString=request.chr;for(let i=0;i<8;i++)testString+=testString;testElement.textContent=testString}}_readFromDomElements(){for(let i=0,len=this._requests.length;i<len;i++){const request=this._requests[i],testElement=this._testElements[i];request.fulfill(testElement.offsetWidth/256)}}}exports.readCharWidths=function readCharWidths(bareFontInfo,requests){new DomCharWidthReader(bareFontInfo,requests).read()}})),define(__m[270],__M([1,0,34,4,2,514,32,176]),(function(require,exports,browser,event_1,lifecycle_1,charWidthReader_1,editorOptions_1,fontInfo_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FontMeasurements=void 0;class FontMeasurementsImpl extends lifecycle_1.Disposable{constructor(){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._cache=new FontMeasurementsCache,this._evictUntrustedReadingsTimeout=-1}dispose(){-1!==this._evictUntrustedReadingsTimeout&&(window.clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache=new FontMeasurementsCache,this._onDidChange.fire()}_writeToCache(item,value){this._cache.put(item,value),value.isTrusted||-1!==this._evictUntrustedReadingsTimeout||(this._evictUntrustedReadingsTimeout=window.setTimeout((()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()}),5e3))}_evictUntrustedReadings(){const values=this._cache.getValues();let somethingRemoved=!1;for(const item of values)item.isTrusted||(somethingRemoved=!0,this._cache.remove(item));somethingRemoved&&this._onDidChange.fire()}readFontInfo(bareFontInfo){if(!this._cache.has(bareFontInfo)){let readConfig=this._actualReadFontInfo(bareFontInfo);(readConfig.typicalHalfwidthCharacterWidth<=2||readConfig.typicalFullwidthCharacterWidth<=2||readConfig.spaceWidth<=2||readConfig.maxDigitWidth<=2)&&(readConfig=new fontInfo_1.FontInfo({pixelRatio:browser.PixelRatio.value,fontFamily:readConfig.fontFamily,fontWeight:readConfig.fontWeight,fontSize:readConfig.fontSize,fontFeatureSettings:readConfig.fontFeatureSettings,lineHeight:readConfig.lineHeight,letterSpacing:readConfig.letterSpacing,isMonospace:readConfig.isMonospace,typicalHalfwidthCharacterWidth:Math.max(readConfig.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(readConfig.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:readConfig.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(readConfig.spaceWidth,5),middotWidth:Math.max(readConfig.middotWidth,5),wsmiddotWidth:Math.max(readConfig.wsmiddotWidth,5),maxDigitWidth:Math.max(readConfig.maxDigitWidth,5)},!1)),this._writeToCache(bareFontInfo,readConfig)}return this._cache.get(bareFontInfo)}_createRequest(chr,type,all,monospace){const result=new charWidthReader_1.CharWidthRequest(chr,type);return all.push(result),monospace&&monospace.push(result),result}_actualReadFontInfo(bareFontInfo){const all=[],monospace=[],typicalHalfwidthCharacter=this._createRequest("n",0,all,monospace),typicalFullwidthCharacter=this._createRequest("ｍ",0,all,null),space=this._createRequest(" ",0,all,monospace),digit0=this._createRequest("0",0,all,monospace),digit1=this._createRequest("1",0,all,monospace),digit2=this._createRequest("2",0,all,monospace),digit3=this._createRequest("3",0,all,monospace),digit4=this._createRequest("4",0,all,monospace),digit5=this._createRequest("5",0,all,monospace),digit6=this._createRequest("6",0,all,monospace),digit7=this._createRequest("7",0,all,monospace),digit8=this._createRequest("8",0,all,monospace),digit9=this._createRequest("9",0,all,monospace),rightwardsArrow=this._createRequest("→",0,all,monospace),halfwidthRightwardsArrow=this._createRequest("￫",0,all,null),middot=this._createRequest("·",0,all,monospace),wsmiddotWidth=this._createRequest(String.fromCharCode(11825),0,all,null);for(let i=0,len="|/-_ilm%".length;i<len;i++)this._createRequest("|/-_ilm%".charAt(i),0,all,monospace),this._createRequest("|/-_ilm%".charAt(i),1,all,monospace),this._createRequest("|/-_ilm%".charAt(i),2,all,monospace);(0,charWidthReader_1.readCharWidths)(bareFontInfo,all);const maxDigitWidth=Math.max(digit0.width,digit1.width,digit2.width,digit3.width,digit4.width,digit5.width,digit6.width,digit7.width,digit8.width,digit9.width);let isMonospace=bareFontInfo.fontFeatureSettings===editorOptions_1.EditorFontLigatures.OFF;const referenceWidth=monospace[0].width;for(let i=1,len=monospace.length;isMonospace&&i<len;i++){const diff=referenceWidth-monospace[i].width;if(diff<-.001||diff>.001){isMonospace=!1;break}}let canUseHalfwidthRightwardsArrow=!0;return isMonospace&&halfwidthRightwardsArrow.width!==referenceWidth&&(canUseHalfwidthRightwardsArrow=!1),halfwidthRightwardsArrow.width>rightwardsArrow.width&&(canUseHalfwidthRightwardsArrow=!1),new fontInfo_1.FontInfo({pixelRatio:browser.PixelRatio.value,fontFamily:bareFontInfo.fontFamily,fontWeight:bareFontInfo.fontWeight,fontSize:bareFontInfo.fontSize,fontFeatureSettings:bareFontInfo.fontFeatureSettings,lineHeight:bareFontInfo.lineHeight,letterSpacing:bareFontInfo.letterSpacing,isMonospace,typicalHalfwidthCharacterWidth:typicalHalfwidthCharacter.width,typicalFullwidthCharacterWidth:typicalFullwidthCharacter.width,canUseHalfwidthRightwardsArrow,spaceWidth:space.width,middotWidth:middot.width,wsmiddotWidth:wsmiddotWidth.width,maxDigitWidth},!0)}}class FontMeasurementsCache{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(item){const itemId=item.getId();return!!this._values[itemId]}get(item){const itemId=item.getId();return this._values[itemId]}put(item,value){const itemId=item.getId();this._keys[itemId]=item,this._values[itemId]=value}remove(item){const itemId=item.getId();delete this._keys[itemId],delete this._values[itemId]}getValues(){return Object.keys(this._keys).map((id=>this._values[id]))}}exports.FontMeasurements=new FontMeasurementsImpl})),define(__m[515],__M([1,0,93,8,64,94,248]),(function(require,exports,stringBuilder_1,strings,domFontInfo_1,textModelEvents_1,modelLineProjectionData_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DOMLineBreaksComputerFactory=void 0;const ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("domLineBreaksComputer",{createHTML:value=>value});class DOMLineBreaksComputerFactory{static create(){return new DOMLineBreaksComputerFactory}constructor(){}createLineBreaksComputer(fontInfo,tabSize,wrappingColumn,wrappingIndent){const requests=[],injectedTexts=[];return{addRequest:(lineText,injectedText,previousLineBreakData)=>{requests.push(lineText),injectedTexts.push(injectedText)},finalize:()=>function createLineBreaks(requests,fontInfo,tabSize,firstLineBreakColumn,wrappingIndent,injectedTextsPerLine){var _a;function createEmptyLineBreakWithPossiblyInjectedText(requestIdx){const injectedTexts=injectedTextsPerLine[requestIdx];if(injectedTexts){const lineText=textModelEvents_1.LineInjectedText.applyInjectedText(requests[requestIdx],injectedTexts),injectionOptions=injectedTexts.map((t=>t.options)),injectionOffsets=injectedTexts.map((text=>text.column-1));return new modelLineProjectionData_1.ModelLineProjectionData(injectionOffsets,injectionOptions,[lineText.length],[],0)}return null}if(-1===firstLineBreakColumn){const result=[];for(let i=0,len=requests.length;i<len;i++)result[i]=createEmptyLineBreakWithPossiblyInjectedText(i);return result}const overallWidth=Math.round(firstLineBreakColumn*fontInfo.typicalHalfwidthCharacterWidth),additionalIndent=3===wrappingIndent?2:2===wrappingIndent?1:0,additionalIndentSize=Math.round(tabSize*additionalIndent),additionalIndentLength=Math.ceil(fontInfo.spaceWidth*additionalIndentSize),containerDomNode=document.createElement("div");(0,domFontInfo_1.applyFontInfo)(containerDomNode,fontInfo);const sb=(0,stringBuilder_1.createStringBuilder)(1e4),firstNonWhitespaceIndices=[],wrappedTextIndentLengths=[],renderLineContents=[],allCharOffsets=[],allVisibleColumns=[];for(let i=0;i<requests.length;i++){const lineContent=textModelEvents_1.LineInjectedText.applyInjectedText(requests[i],injectedTextsPerLine[i]);let firstNonWhitespaceIndex=0,wrappedTextIndentLength=0,width=overallWidth;if(0!==wrappingIndent)if(firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(lineContent),-1===firstNonWhitespaceIndex)firstNonWhitespaceIndex=0;else{for(let i=0;i<firstNonWhitespaceIndex;i++){wrappedTextIndentLength+=9===lineContent.charCodeAt(i)?tabSize-wrappedTextIndentLength%tabSize:1}const indentWidth=Math.ceil(fontInfo.spaceWidth*wrappedTextIndentLength);indentWidth+fontInfo.typicalFullwidthCharacterWidth>overallWidth?(firstNonWhitespaceIndex=0,wrappedTextIndentLength=0):width=overallWidth-indentWidth}const renderLineContent=lineContent.substr(firstNonWhitespaceIndex),tmp=renderLine(renderLineContent,wrappedTextIndentLength,tabSize,width,sb,additionalIndentLength);firstNonWhitespaceIndices[i]=firstNonWhitespaceIndex,wrappedTextIndentLengths[i]=wrappedTextIndentLength,renderLineContents[i]=renderLineContent,allCharOffsets[i]=tmp[0],allVisibleColumns[i]=tmp[1]}const html=sb.build(),trustedhtml=null!==(_a=null==ttPolicy?void 0:ttPolicy.createHTML(html))&&void 0!==_a?_a:html;containerDomNode.innerHTML=trustedhtml,containerDomNode.style.position="absolute",containerDomNode.style.top="10000",containerDomNode.style.wordWrap="break-word",document.body.appendChild(containerDomNode);const range=document.createRange(),lineDomNodes=Array.prototype.slice.call(containerDomNode.children,0),result=[];for(let i=0;i<requests.length;i++){const breakOffsets=readLineBreaks(range,lineDomNodes[i],renderLineContents[i],allCharOffsets[i]);if(null===breakOffsets){result[i]=createEmptyLineBreakWithPossiblyInjectedText(i);continue}const firstNonWhitespaceIndex=firstNonWhitespaceIndices[i],wrappedTextIndentLength=wrappedTextIndentLengths[i]+additionalIndentSize,visibleColumns=allVisibleColumns[i],breakOffsetsVisibleColumn=[];for(let j=0,len=breakOffsets.length;j<len;j++)breakOffsetsVisibleColumn[j]=visibleColumns[breakOffsets[j]];if(0!==firstNonWhitespaceIndex)for(let j=0,len=breakOffsets.length;j<len;j++)breakOffsets[j]+=firstNonWhitespaceIndex;let injectionOptions,injectionOffsets;const curInjectedTexts=injectedTextsPerLine[i];curInjectedTexts?(injectionOptions=curInjectedTexts.map((t=>t.options)),injectionOffsets=curInjectedTexts.map((text=>text.column-1))):(injectionOptions=null,injectionOffsets=null),result[i]=new modelLineProjectionData_1.ModelLineProjectionData(injectionOffsets,injectionOptions,breakOffsets,breakOffsetsVisibleColumn,wrappedTextIndentLength)}return document.body.removeChild(containerDomNode),result}(requests,fontInfo,tabSize,wrappingColumn,wrappingIndent,injectedTexts)}}}function renderLine(lineContent,initialVisibleColumn,tabSize,width,sb,wrappingIndentLength){if(0!==wrappingIndentLength){const hangingOffset=String(wrappingIndentLength);sb.appendASCIIString('<div style="text-indent: -'),sb.appendASCIIString(hangingOffset),sb.appendASCIIString("px; padding-left: "),sb.appendASCIIString(hangingOffset),sb.appendASCIIString("px; box-sizing: border-box; width:")}else sb.appendASCIIString('<div style="width:');sb.appendASCIIString(String(width)),sb.appendASCIIString('px;">');const len=lineContent.length;let visibleColumn=initialVisibleColumn,charOffset=0;const charOffsets=[],visibleColumns=[];let nextCharCode=0<len?lineContent.charCodeAt(0):0;sb.appendASCIIString("<span>");for(let charIndex=0;charIndex<len;charIndex++){0!==charIndex&&charIndex%16384==0&&sb.appendASCIIString("</span><span>"),charOffsets[charIndex]=charOffset,visibleColumns[charIndex]=visibleColumn;const charCode=nextCharCode;nextCharCode=charIndex+1<len?lineContent.charCodeAt(charIndex+1):0;let producedCharacters=1,charWidth=1;switch(charCode){case 9:producedCharacters=tabSize-visibleColumn%tabSize,charWidth=producedCharacters;for(let space=1;space<=producedCharacters;space++)space<producedCharacters?sb.write1(160):sb.appendASCII(32);break;case 32:32===nextCharCode?sb.write1(160):sb.appendASCII(32);break;case 60:sb.appendASCIIString("&lt;");break;case 62:sb.appendASCIIString("&gt;");break;case 38:sb.appendASCIIString("&amp;");break;case 0:sb.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:sb.write1(65533);break;default:strings.isFullWidthCharacter(charCode)&&charWidth++,charCode<32?sb.write1(9216+charCode):sb.write1(charCode)}charOffset+=producedCharacters,visibleColumn+=charWidth}return sb.appendASCIIString("</span>"),charOffsets[lineContent.length]=charOffset,visibleColumns[lineContent.length]=visibleColumn,sb.appendASCIIString("</div>"),[charOffsets,visibleColumns]}function readLineBreaks(range,lineDomNode,lineContent,charOffsets){if(lineContent.length<=1)return null;const spans=Array.prototype.slice.call(lineDomNode.children,0),breakOffsets=[];try{discoverBreaks(range,spans,charOffsets,0,null,lineContent.length-1,null,breakOffsets)}catch(err){return console.log(err),null}return 0===breakOffsets.length?null:(breakOffsets.push(lineContent.length),breakOffsets)}function discoverBreaks(range,spans,charOffsets,low,lowRects,high,highRects,result){if(low===high)return;if(lowRects=lowRects||readClientRect(range,spans,charOffsets[low],charOffsets[low+1]),highRects=highRects||readClientRect(range,spans,charOffsets[high],charOffsets[high+1]),Math.abs(lowRects[0].top-highRects[0].top)<=.1)return;if(low+1===high)return void result.push(high);const mid=low+(high-low)/2|0,midRects=readClientRect(range,spans,charOffsets[mid],charOffsets[mid+1]);discoverBreaks(range,spans,charOffsets,low,lowRects,mid,midRects,result),discoverBreaks(range,spans,charOffsets,mid,midRects,high,highRects,result)}function readClientRect(range,spans,startOffset,endOffset){return range.setStart(spans[startOffset/16384|0].firstChild,startOffset%16384),range.setEnd(spans[endOffset/16384|0].firstChild,endOffset%16384),range.getClientRects()}exports.DOMLineBreaksComputerFactory=DOMLineBreaksComputerFactory})),define(__m[516],__M([1,0,31,64,179,51]),(function(require,exports,fastDomNode_1,domFontInfo_1,viewLayer_1,viewPart_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarginViewOverlays=exports.ContentViewOverlays=exports.ViewOverlayLine=exports.ViewOverlays=void 0;class ViewOverlays extends viewPart_1.ViewPart{constructor(context){super(context),this._visibleLines=new viewLayer_1.VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode,this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let i=0,len=this._dynamicOverlays.length;i<len;i++){if(this._dynamicOverlays[i].shouldRender())return!0}return!1}dispose(){super.dispose();for(let i=0,len=this._dynamicOverlays.length;i<len;i++){this._dynamicOverlays[i].dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new ViewOverlayLine(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(overlay){this._dynamicOverlays.push(overlay)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const startLineNumber=this._visibleLines.getStartLineNumber(),endLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){this._visibleLines.getVisibleLine(lineNumber).onConfigurationChanged(e)}return!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(ctx){const toRender=this._dynamicOverlays.filter((overlay=>overlay.shouldRender()));for(let i=0,len=toRender.length;i<len;i++){const dynamicOverlay=toRender[i];dynamicOverlay.prepareRender(ctx),dynamicOverlay.onDidRender()}}render(ctx){this._viewOverlaysRender(ctx),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(ctx){this._visibleLines.renderLines(ctx.viewportData)}}exports.ViewOverlays=ViewOverlays;class ViewOverlayLine{constructor(configuration,dynamicOverlays){this._configuration=configuration,this._lineHeight=this._configuration.options.get(59),this._dynamicOverlays=dynamicOverlays,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(domNode){this._domNode=(0,fastDomNode_1.createFastDomNode)(domNode)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(59)}renderLine(lineNumber,deltaTop,viewportData,sb){let result="";for(let i=0,len=this._dynamicOverlays.length;i<len;i++){result+=this._dynamicOverlays[i].render(viewportData.startLineNumber,lineNumber)}return this._renderedContent!==result&&(this._renderedContent=result,sb.appendASCIIString('<div style="position:absolute;top:'),sb.appendASCIIString(String(deltaTop)),sb.appendASCIIString("px;width:100%;height:"),sb.appendASCIIString(String(this._lineHeight)),sb.appendASCIIString('px;">'),sb.appendASCIIString(result),sb.appendASCIIString("</div>"),!0)}layoutLine(lineNumber,deltaTop){this._domNode&&(this._domNode.setTop(deltaTop),this._domNode.setHeight(this._lineHeight))}}exports.ViewOverlayLine=ViewOverlayLine;exports.ContentViewOverlays=class ContentViewOverlays extends ViewOverlays{constructor(context){super(context);const layoutInfo=this._context.configuration.options.get(131);this._contentWidth=layoutInfo.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const layoutInfo=this._context.configuration.options.get(131);return this._contentWidth=layoutInfo.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(ctx){super._viewOverlaysRender(ctx),this.domNode.setWidth(Math.max(ctx.scrollWidth,this._contentWidth))}};exports.MarginViewOverlays=class MarginViewOverlays extends ViewOverlays{constructor(context){super(context);const options=this._context.configuration.options,layoutInfo=options.get(131);this._contentLeft=layoutInfo.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,domFontInfo_1.applyFontInfo)(this.domNode,options.get(44))}onConfigurationChanged(e){const options=this._context.configuration.options;(0,domFontInfo_1.applyFontInfo)(this.domNode,options.get(44));const layoutInfo=options.get(131);return this._contentLeft=layoutInfo.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(ctx){super._viewOverlaysRender(ctx);const height=Math.min(ctx.scrollHeight,1e6);this.domNode.setHeight(height),this.domNode.setWidth(this._contentLeft)}}})),define(__m[517],__M([1,0,7,31,8,64,32,11,3,144]),(function(require,exports,dom,fastDomNode_1,strings,domFontInfo_1,editorOptions_1,position_1,range_1,mouseCursor_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewCursor=void 0;class ViewCursorRenderData{constructor(top,left,width,height,textContent,textContentClassName){this.top=top,this.left=left,this.width=width,this.height=height,this.textContent=textContent,this.textContentClassName=textContentClassName}}exports.ViewCursor=class ViewCursor{constructor(context){this._context=context;const options=this._context.configuration.options,fontInfo=options.get(44);this._cursorStyle=options.get(24),this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(options.get(27),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._domNode.setClassName(`cursor ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),(0,domFontInfo_1.applyFontInfo)(this._domNode,fontInfo),this._domNode.setDisplay("none"),this._position=new position_1.Position(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const options=this._context.configuration.options,fontInfo=options.get(44);return this._cursorStyle=options.get(24),this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(options.get(27),this._typicalHalfwidthCharacterWidth),(0,domFontInfo_1.applyFontInfo)(this._domNode,fontInfo),!0}onCursorPositionChanged(position){return this._position=position,!0}_getGraphemeAwarePosition(){const{lineNumber,column}=this._position,lineContent=this._context.viewModel.getLineContent(lineNumber),[startOffset,endOffset]=strings.getCharContainingOffset(lineContent,column-1);return[new position_1.Position(lineNumber,startOffset+1),lineContent.substring(startOffset,endOffset)]}_prepareRender(ctx){let textContent="";const[position,nextGrapheme]=this._getGraphemeAwarePosition();if(this._cursorStyle===editorOptions_1.TextEditorCursorStyle.Line||this._cursorStyle===editorOptions_1.TextEditorCursorStyle.LineThin){const visibleRange=ctx.visibleRangeForPosition(position);if(!visibleRange||visibleRange.outsideRenderedLine)return null;let width;this._cursorStyle===editorOptions_1.TextEditorCursorStyle.Line?(width=dom.computeScreenAwareSize(this._lineCursorWidth>0?this._lineCursorWidth:2),width>2&&(textContent=nextGrapheme)):width=dom.computeScreenAwareSize(1);let left=visibleRange.left;width>=2&&left>=1&&(left-=1);const top=ctx.getVerticalOffsetForLineNumber(position.lineNumber)-ctx.bigNumbersDelta;return new ViewCursorRenderData(top,left,width,this._lineHeight,textContent,"")}const visibleRangeForCharacter=ctx.linesVisibleRangesForRange(new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column+nextGrapheme.length),!1);if(!visibleRangeForCharacter||0===visibleRangeForCharacter.length)return null;const firstVisibleRangeForCharacter=visibleRangeForCharacter[0];if(firstVisibleRangeForCharacter.outsideRenderedLine||0===firstVisibleRangeForCharacter.ranges.length)return null;const range=firstVisibleRangeForCharacter.ranges[0],width=range.width<1?this._typicalHalfwidthCharacterWidth:range.width;let textContentClassName="";if(this._cursorStyle===editorOptions_1.TextEditorCursorStyle.Block){const lineData=this._context.viewModel.getViewLineData(position.lineNumber);textContent=nextGrapheme;const tokenIndex=lineData.tokens.findTokenIndexAtOffset(position.column-1);textContentClassName=lineData.tokens.getClassName(tokenIndex)}let top=ctx.getVerticalOffsetForLineNumber(position.lineNumber)-ctx.bigNumbersDelta,height=this._lineHeight;return this._cursorStyle!==editorOptions_1.TextEditorCursorStyle.Underline&&this._cursorStyle!==editorOptions_1.TextEditorCursorStyle.UnderlineThin||(top+=this._lineHeight-2,height=2),new ViewCursorRenderData(top,range.left,width,height,textContent,textContentClassName)}prepareRender(ctx){this._renderData=this._prepareRender(ctx)}render(ctx){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}})),define(__m[271],__M([1,0,11,3,71,32]),(function(require,exports,position_1,range_1,viewModel_1,editorOptions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isModelDecorationInString=exports.isModelDecorationInComment=exports.isModelDecorationVisible=exports.ViewModelDecorations=void 0;function isModelDecorationVisible(model,decoration){return(!decoration.options.hideInCommentTokens||!isModelDecorationInComment(model,decoration))&&(!decoration.options.hideInStringTokens||!isModelDecorationInString(model,decoration))}function isModelDecorationInComment(model,decoration){return testTokensInRange(model,decoration.range,(tokenType=>1===tokenType))}function isModelDecorationInString(model,decoration){return testTokensInRange(model,decoration.range,(tokenType=>2===tokenType))}function testTokensInRange(model,range,callback){for(let lineNumber=range.startLineNumber;lineNumber<=range.endLineNumber;lineNumber++){const lineTokens=model.getLineTokens(lineNumber),isFirstLine=lineNumber===range.startLineNumber,isEndLine=lineNumber===range.endLineNumber;let tokenIdx=isFirstLine?lineTokens.findTokenIndexAtOffset(range.startColumn-1):0;for(;tokenIdx<lineTokens.getCount();){if(isEndLine){if(lineTokens.getStartOffset(tokenIdx)>range.endColumn-1)break}if(!callback(lineTokens.getStandardTokenType(tokenIdx)))return!1;tokenIdx++}}return!0}exports.ViewModelDecorations=class ViewModelDecorations{constructor(editorId,model,configuration,linesCollection,coordinatesConverter){this.editorId=editorId,this.model=model,this.configuration=configuration,this._linesCollection=linesCollection,this._coordinatesConverter=coordinatesConverter,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(modelDecoration){const id=modelDecoration.id;let r=this._decorationsCache[id];if(!r){const modelRange=modelDecoration.range,options=modelDecoration.options;let viewRange;if(options.isWholeLine){const start=this._coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelRange.startLineNumber,1),0),end=this._coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelRange.endLineNumber,this.model.getLineMaxColumn(modelRange.endLineNumber)),1);viewRange=new range_1.Range(start.lineNumber,start.column,end.lineNumber,end.column)}else viewRange=this._coordinatesConverter.convertModelRangeToViewRange(modelRange,1);r=new viewModel_1.ViewModelDecoration(viewRange,options),this._decorationsCache[id]=r}return r}getDecorationsViewportData(viewRange){let cacheIsValid=null!==this._cachedModelDecorationsResolver;return cacheIsValid=cacheIsValid&&viewRange.equalsRange(this._cachedModelDecorationsResolverViewRange),cacheIsValid||(this._cachedModelDecorationsResolver=this._getDecorationsViewportData(viewRange),this._cachedModelDecorationsResolverViewRange=viewRange),this._cachedModelDecorationsResolver}_getDecorationsViewportData(viewportRange){const modelDecorations=this._linesCollection.getDecorationsInRange(viewportRange,this.editorId,(0,editorOptions_1.filterValidationDecorations)(this.configuration.options)),startLineNumber=viewportRange.startLineNumber,endLineNumber=viewportRange.endLineNumber,decorationsInViewport=[];let decorationsInViewportLen=0;const inlineDecorations=[];for(let j=startLineNumber;j<=endLineNumber;j++)inlineDecorations[j-startLineNumber]=[];for(let i=0,len=modelDecorations.length;i<len;i++){const modelDecoration=modelDecorations[i],decorationOptions=modelDecoration.options;if(!isModelDecorationVisible(this.model,modelDecoration))continue;const viewModelDecoration=this._getOrCreateViewModelDecoration(modelDecoration),viewRange=viewModelDecoration.range;if(decorationsInViewport[decorationsInViewportLen++]=viewModelDecoration,decorationOptions.inlineClassName){const inlineDecoration=new viewModel_1.InlineDecoration(viewRange,decorationOptions.inlineClassName,decorationOptions.inlineClassNameAffectsLetterSpacing?3:0),intersectedStartLineNumber=Math.max(startLineNumber,viewRange.startLineNumber),intersectedEndLineNumber=Math.min(endLineNumber,viewRange.endLineNumber);for(let j=intersectedStartLineNumber;j<=intersectedEndLineNumber;j++)inlineDecorations[j-startLineNumber].push(inlineDecoration)}if(decorationOptions.beforeContentClassName&&startLineNumber<=viewRange.startLineNumber&&viewRange.startLineNumber<=endLineNumber){const inlineDecoration=new viewModel_1.InlineDecoration(new range_1.Range(viewRange.startLineNumber,viewRange.startColumn,viewRange.startLineNumber,viewRange.startColumn),decorationOptions.beforeContentClassName,1);inlineDecorations[viewRange.startLineNumber-startLineNumber].push(inlineDecoration)}if(decorationOptions.afterContentClassName&&startLineNumber<=viewRange.endLineNumber&&viewRange.endLineNumber<=endLineNumber){const inlineDecoration=new viewModel_1.InlineDecoration(new range_1.Range(viewRange.endLineNumber,viewRange.endColumn,viewRange.endLineNumber,viewRange.endColumn),decorationOptions.afterContentClassName,2);inlineDecorations[viewRange.endLineNumber-startLineNumber].push(inlineDecoration)}}return{decorations:decorationsInViewport,inlineDecorations}}},exports.isModelDecorationVisible=isModelDecorationVisible,exports.isModelDecorationInComment=isModelDecorationInComment,exports.isModelDecorationInString=isModelDecorationInString})),define(__m[518],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/core/editorColorRegistry",data)})),define(__m[519],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/editorContextKeys",data)})),define(__m[520],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/languages/modesRegistry",data)})),define(__m[521],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/model/editStack",data)})),define(__m[272],__M([1,0,521,13,22,25,240,112,42]),(function(require,exports,nls,errors_1,selection_1,uri_1,textChange_1,buffer,resources_1){"use strict";function uriGetComparisonKey(resource){return resource.toString()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditStack=exports.isEditStackElement=exports.MultiModelEditStackElement=exports.SingleModelEditStackElement=exports.SingleModelEditStackData=void 0;class SingleModelEditStackData{constructor(beforeVersionId,afterVersionId,beforeEOL,afterEOL,beforeCursorState,afterCursorState,changes){this.beforeVersionId=beforeVersionId,this.afterVersionId=afterVersionId,this.beforeEOL=beforeEOL,this.afterEOL=afterEOL,this.beforeCursorState=beforeCursorState,this.afterCursorState=afterCursorState,this.changes=changes}static create(model,beforeCursorState){const alternativeVersionId=model.getAlternativeVersionId(),eol=getModelEOL(model);return new SingleModelEditStackData(alternativeVersionId,alternativeVersionId,eol,eol,beforeCursorState,beforeCursorState,[])}append(model,textChanges,afterEOL,afterVersionId,afterCursorState){textChanges.length>0&&(this.changes=(0,textChange_1.compressConsecutiveTextChanges)(this.changes,textChanges)),this.afterEOL=afterEOL,this.afterVersionId=afterVersionId,this.afterCursorState=afterCursorState}static _writeSelectionsSize(selections){return 4+16*(selections?selections.length:0)}static _writeSelections(b,selections,offset){if(buffer.writeUInt32BE(b,selections?selections.length:0,offset),offset+=4,selections)for(const selection of selections)buffer.writeUInt32BE(b,selection.selectionStartLineNumber,offset),offset+=4,buffer.writeUInt32BE(b,selection.selectionStartColumn,offset),offset+=4,buffer.writeUInt32BE(b,selection.positionLineNumber,offset),offset+=4,buffer.writeUInt32BE(b,selection.positionColumn,offset),offset+=4;return offset}static _readSelections(b,offset,dest){const count=buffer.readUInt32BE(b,offset);offset+=4;for(let i=0;i<count;i++){const selectionStartLineNumber=buffer.readUInt32BE(b,offset);offset+=4;const selectionStartColumn=buffer.readUInt32BE(b,offset);offset+=4;const positionLineNumber=buffer.readUInt32BE(b,offset);offset+=4;const positionColumn=buffer.readUInt32BE(b,offset);offset+=4,dest.push(new selection_1.Selection(selectionStartLineNumber,selectionStartColumn,positionLineNumber,positionColumn))}return offset}serialize(){let necessarySize=10+SingleModelEditStackData._writeSelectionsSize(this.beforeCursorState)+SingleModelEditStackData._writeSelectionsSize(this.afterCursorState)+4;for(const change of this.changes)necessarySize+=change.writeSize();const b=new Uint8Array(necessarySize);let offset=0;buffer.writeUInt32BE(b,this.beforeVersionId,offset),offset+=4,buffer.writeUInt32BE(b,this.afterVersionId,offset),offset+=4,buffer.writeUInt8(b,this.beforeEOL,offset),offset+=1,buffer.writeUInt8(b,this.afterEOL,offset),offset+=1,offset=SingleModelEditStackData._writeSelections(b,this.beforeCursorState,offset),offset=SingleModelEditStackData._writeSelections(b,this.afterCursorState,offset),buffer.writeUInt32BE(b,this.changes.length,offset),offset+=4;for(const change of this.changes)offset=change.write(b,offset);return b.buffer}static deserialize(source){const b=new Uint8Array(source);let offset=0;const beforeVersionId=buffer.readUInt32BE(b,offset);offset+=4;const afterVersionId=buffer.readUInt32BE(b,offset);offset+=4;const beforeEOL=buffer.readUInt8(b,offset);offset+=1;const afterEOL=buffer.readUInt8(b,offset);offset+=1;const beforeCursorState=[];offset=SingleModelEditStackData._readSelections(b,offset,beforeCursorState);const afterCursorState=[];offset=SingleModelEditStackData._readSelections(b,offset,afterCursorState);const changeCount=buffer.readUInt32BE(b,offset);offset+=4;const changes=[];for(let i=0;i<changeCount;i++)offset=textChange_1.TextChange.read(b,offset,changes);return new SingleModelEditStackData(beforeVersionId,afterVersionId,beforeEOL,afterEOL,beforeCursorState,afterCursorState,changes)}}exports.SingleModelEditStackData=SingleModelEditStackData;class SingleModelEditStackElement{constructor(model,beforeCursorState){this.model=model,this._data=SingleModelEditStackData.create(model,beforeCursorState)}get type(){return 0}get resource(){return uri_1.URI.isUri(this.model)?this.model:this.model.uri}get label(){return nls.localize(0,null)}toString(){return(this._data instanceof SingleModelEditStackData?this._data:SingleModelEditStackData.deserialize(this._data)).changes.map((change=>change.toString())).join(", ")}matchesResource(resource){return(uri_1.URI.isUri(this.model)?this.model:this.model.uri).toString()===resource.toString()}setModel(model){this.model=model}canAppend(model){return this.model===model&&this._data instanceof SingleModelEditStackData}append(model,textChanges,afterEOL,afterVersionId,afterCursorState){this._data instanceof SingleModelEditStackData&&this._data.append(model,textChanges,afterEOL,afterVersionId,afterCursorState)}close(){this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize())}open(){this._data instanceof SingleModelEditStackData||(this._data=SingleModelEditStackData.deserialize(this._data))}undo(){if(uri_1.URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const data=SingleModelEditStackData.deserialize(this._data);this.model._applyUndo(data.changes,data.beforeEOL,data.beforeVersionId,data.beforeCursorState)}redo(){if(uri_1.URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const data=SingleModelEditStackData.deserialize(this._data);this.model._applyRedo(data.changes,data.afterEOL,data.afterVersionId,data.afterCursorState)}heapSize(){return this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize()),this._data.byteLength+168}}exports.SingleModelEditStackElement=SingleModelEditStackElement;class MultiModelEditStackElement{constructor(label,editStackElements){this.type=1,this.label=label,this._isOpen=!0,this._editStackElementsArr=editStackElements.slice(0),this._editStackElementsMap=new Map;for(const editStackElement of this._editStackElementsArr){const key=uriGetComparisonKey(editStackElement.resource);this._editStackElementsMap.set(key,editStackElement)}this._delegate=null}get resources(){return this._editStackElementsArr.map((editStackElement=>editStackElement.resource))}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(resource){const key=uriGetComparisonKey(resource);return this._editStackElementsMap.has(key)}setModel(model){const key=uriGetComparisonKey(uri_1.URI.isUri(model)?model:model.uri);this._editStackElementsMap.has(key)&&this._editStackElementsMap.get(key).setModel(model)}canAppend(model){if(!this._isOpen)return!1;const key=uriGetComparisonKey(model.uri);if(this._editStackElementsMap.has(key)){return this._editStackElementsMap.get(key).canAppend(model)}return!1}append(model,textChanges,afterEOL,afterVersionId,afterCursorState){const key=uriGetComparisonKey(model.uri);this._editStackElementsMap.get(key).append(model,textChanges,afterEOL,afterVersionId,afterCursorState)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const editStackElement of this._editStackElementsArr)editStackElement.undo()}redo(){for(const editStackElement of this._editStackElementsArr)editStackElement.redo()}heapSize(resource){const key=uriGetComparisonKey(resource);if(this._editStackElementsMap.has(key)){return this._editStackElementsMap.get(key).heapSize()}return 0}split(){return this._editStackElementsArr}toString(){let result=[];for(const editStackElement of this._editStackElementsArr)result.push(`${(0,resources_1.basename)(editStackElement.resource)}: ${editStackElement}`);return`{${result.join(", ")}}`}}function getModelEOL(model){return"\n"===model.getEOL()?0:1}function isEditStackElement(element){return!!element&&(element instanceof SingleModelEditStackElement||element instanceof MultiModelEditStackElement)}exports.MultiModelEditStackElement=MultiModelEditStackElement,exports.isEditStackElement=isEditStackElement;class EditStack{constructor(model,undoRedoService){this._model=model,this._undoRedoService=undoRedoService}pushStackElement(){const lastElement=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(lastElement)&&lastElement.close()}popStackElement(){const lastElement=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(lastElement)&&lastElement.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(beforeCursorState){const lastElement=this._undoRedoService.getLastElement(this._model.uri);if(isEditStackElement(lastElement)&&lastElement.canAppend(this._model))return lastElement;const newElement=new SingleModelEditStackElement(this._model,beforeCursorState);return this._undoRedoService.pushElement(newElement),newElement}pushEOL(eol){const editStackElement=this._getOrCreateEditStackElement(null);this._model.setEOL(eol),editStackElement.append(this._model,[],getModelEOL(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(beforeCursorState,editOperations,cursorStateComputer){const editStackElement=this._getOrCreateEditStackElement(beforeCursorState),inverseEditOperations=this._model.applyEdits(editOperations,!0),afterCursorState=EditStack._computeCursorState(cursorStateComputer,inverseEditOperations),textChanges=inverseEditOperations.map(((op,index)=>({index,textChange:op.textChange})));return textChanges.sort(((a,b)=>a.textChange.oldPosition===b.textChange.oldPosition?a.index-b.index:a.textChange.oldPosition-b.textChange.oldPosition)),editStackElement.append(this._model,textChanges.map((op=>op.textChange)),getModelEOL(this._model),this._model.getAlternativeVersionId(),afterCursorState),afterCursorState}static _computeCursorState(cursorStateComputer,inverseEditOperations){try{return cursorStateComputer?cursorStateComputer(inverseEditOperations):null}catch(e){return(0,errors_1.onUnexpectedError)(e),null}}}exports.EditStack=EditStack})),define(__m[522],__M([5,6]),(function(nls,data){return nls.create("vs/editor/common/standaloneStrings",data)})),define(__m[72],__M([1,0,522]),(function(require,exports,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandaloneServicesNLS=exports.ToggleHighContrastNLS=exports.StandaloneCodeEditorNLS=exports.QuickOutlineNLS=exports.QuickCommandNLS=exports.QuickHelpNLS=exports.GoToLineNLS=exports.InspectTokensNLS=exports.AccessibilityHelpNLS=void 0,function(AccessibilityHelpNLS){AccessibilityHelpNLS.noSelection=nls.localize(0,null),AccessibilityHelpNLS.singleSelectionRange=nls.localize(1,null),AccessibilityHelpNLS.singleSelection=nls.localize(2,null),AccessibilityHelpNLS.multiSelectionRange=nls.localize(3,null),AccessibilityHelpNLS.multiSelection=nls.localize(4,null),AccessibilityHelpNLS.emergencyConfOn=nls.localize(5,null),AccessibilityHelpNLS.openingDocs=nls.localize(6,null),AccessibilityHelpNLS.readonlyDiffEditor=nls.localize(7,null),AccessibilityHelpNLS.editableDiffEditor=nls.localize(8,null),AccessibilityHelpNLS.readonlyEditor=nls.localize(9,null),AccessibilityHelpNLS.editableEditor=nls.localize(10,null),AccessibilityHelpNLS.changeConfigToOnMac=nls.localize(11,null),AccessibilityHelpNLS.changeConfigToOnWinLinux=nls.localize(12,null),AccessibilityHelpNLS.auto_on=nls.localize(13,null),AccessibilityHelpNLS.auto_off=nls.localize(14,null),AccessibilityHelpNLS.tabFocusModeOnMsg=nls.localize(15,null),AccessibilityHelpNLS.tabFocusModeOnMsgNoKb=nls.localize(16,null),AccessibilityHelpNLS.tabFocusModeOffMsg=nls.localize(17,null),AccessibilityHelpNLS.tabFocusModeOffMsgNoKb=nls.localize(18,null),AccessibilityHelpNLS.openDocMac=nls.localize(19,null),AccessibilityHelpNLS.openDocWinLinux=nls.localize(20,null),AccessibilityHelpNLS.outroMsg=nls.localize(21,null),AccessibilityHelpNLS.showAccessibilityHelpAction=nls.localize(22,null)}(exports.AccessibilityHelpNLS||(exports.AccessibilityHelpNLS={})),function(InspectTokensNLS){InspectTokensNLS.inspectTokensAction=nls.localize(23,null)}(exports.InspectTokensNLS||(exports.InspectTokensNLS={})),function(GoToLineNLS){GoToLineNLS.gotoLineActionLabel=nls.localize(24,null)}(exports.GoToLineNLS||(exports.GoToLineNLS={})),function(QuickHelpNLS){QuickHelpNLS.helpQuickAccessActionLabel=nls.localize(25,null)}(exports.QuickHelpNLS||(exports.QuickHelpNLS={})),function(QuickCommandNLS){QuickCommandNLS.quickCommandActionLabel=nls.localize(26,null),QuickCommandNLS.quickCommandHelp=nls.localize(27,null)}(exports.QuickCommandNLS||(exports.QuickCommandNLS={})),function(QuickOutlineNLS){QuickOutlineNLS.quickOutlineActionLabel=nls.localize(28,null),QuickOutlineNLS.quickOutlineByCategoryActionLabel=nls.localize(29,null)}(exports.QuickOutlineNLS||(exports.QuickOutlineNLS={})),function(StandaloneCodeEditorNLS){StandaloneCodeEditorNLS.editorViewAccessibleLabel=nls.localize(30,null),StandaloneCodeEditorNLS.accessibilityHelpMessage=nls.localize(31,null)}(exports.StandaloneCodeEditorNLS||(exports.StandaloneCodeEditorNLS={})),function(ToggleHighContrastNLS){ToggleHighContrastNLS.toggleHighContrast=nls.localize(32,null)}(exports.ToggleHighContrastNLS||(exports.ToggleHighContrastNLS={})),function(StandaloneServicesNLS){StandaloneServicesNLS.bulkEditServiceSummary=nls.localize(33,null)}(exports.StandaloneServicesNLS||(exports.StandaloneServicesNLS={}))})),define(__m[523],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/anchorSelect/browser/anchorSelect",data)})),define(__m[524],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/bracketMatching/browser/bracketMatching",data)})),define(__m[525],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/caretOperations/browser/caretOperations",data)})),define(__m[526],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/caretOperations/browser/transpose",data)})),define(__m[527],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/clipboard/browser/clipboard",data)})),define(__m[528],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/codeAction/browser/codeActionCommands",data)})),define(__m[529],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/codeAction/browser/lightBulbWidget",data)})),define(__m[530],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/codelens/browser/codelensController",data)})),define(__m[531],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/colorPicker/browser/colorPickerWidget",data)})),define(__m[532],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/comment/browser/comment",data)})),define(__m[533],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/contextmenu/browser/contextmenu",data)})),define(__m[534],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/cursorUndo/browser/cursorUndo",data)})),define(__m[535],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/editorState/browser/keybindingCancellation",data)})),define(__m[536],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/find/browser/findController",data)})),define(__m[537],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/find/browser/findWidget",data)})),define(__m[538],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/folding/browser/folding",data)})),define(__m[539],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/folding/browser/foldingDecorations",data)})),define(__m[540],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/fontZoom/browser/fontZoom",data)})),define(__m[541],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/format/browser/format",data)})),define(__m[542],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/format/browser/formatActions",data)})),define(__m[543],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoError/browser/gotoError",data)})),define(__m[544],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoError/browser/gotoErrorWidget",data)})),define(__m[545],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/goToCommands",data)})),define(__m[546],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition",data)})),define(__m[547],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/peek/referencesController",data)})),define(__m[548],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/peek/referencesTree",data)})),define(__m[549],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget",data)})),define(__m[550],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/referencesModel",data)})),define(__m[129],__M([1,0,13,4,136,2,49,42,8,3,550]),(function(require,exports,errors_1,event_1,idGenerator_1,lifecycle_1,map_1,resources_1,strings,range_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReferencesModel=exports.FileReferences=exports.FilePreview=exports.OneReference=void 0;class OneReference{constructor(isProviderFirst,parent,link,_rangeCallback){this.isProviderFirst=isProviderFirst,this.parent=parent,this.link=link,this._rangeCallback=_rangeCallback,this.id=idGenerator_1.defaultGenerator.nextId()}get uri(){return this.link.uri}get range(){var _a,_b;return null!==(_b=null!==(_a=this._range)&&void 0!==_a?_a:this.link.targetSelectionRange)&&void 0!==_b?_b:this.link.range}set range(value){this._range=value,this._rangeCallback(this)}get ariaMessage(){var _a;const preview=null===(_a=this.parent.getPreview(this))||void 0===_a?void 0:_a.preview(this.range);return preview?(0,nls_1.localize)(1,null,(0,resources_1.basename)(this.uri),this.range.startLineNumber,this.range.startColumn,preview.value):(0,nls_1.localize)(0,null,(0,resources_1.basename)(this.uri),this.range.startLineNumber,this.range.startColumn)}}exports.OneReference=OneReference;class FilePreview{constructor(_modelReference){this._modelReference=_modelReference}dispose(){this._modelReference.dispose()}preview(range,n=8){const model=this._modelReference.object.textEditorModel;if(!model)return;const{startLineNumber,startColumn,endLineNumber,endColumn}=range,word=model.getWordUntilPosition({lineNumber:startLineNumber,column:startColumn-n}),beforeRange=new range_1.Range(startLineNumber,word.startColumn,startLineNumber,startColumn),afterRange=new range_1.Range(endLineNumber,endColumn,endLineNumber,1073741824),before=model.getValueInRange(beforeRange).replace(/^\s+/,""),inside=model.getValueInRange(range);return{value:before+inside+model.getValueInRange(afterRange).replace(/\s+$/,""),highlight:{start:before.length,end:before.length+inside.length}}}}exports.FilePreview=FilePreview;class FileReferences{constructor(parent,uri){this.parent=parent,this.uri=uri,this.children=[],this._previews=new map_1.ResourceMap}dispose(){(0,lifecycle_1.dispose)(this._previews.values()),this._previews.clear()}getPreview(child){return this._previews.get(child.uri)}get ariaMessage(){const len=this.children.length;return 1===len?(0,nls_1.localize)(2,null,(0,resources_1.basename)(this.uri),this.uri.fsPath):(0,nls_1.localize)(3,null,len,(0,resources_1.basename)(this.uri),this.uri.fsPath)}resolve(textModelResolverService){return __awaiter(this,void 0,void 0,(function*(){if(0!==this._previews.size)return this;for(let child of this.children)if(!this._previews.has(child.uri))try{const ref=yield textModelResolverService.createModelReference(child.uri);this._previews.set(child.uri,new FilePreview(ref))}catch(err){(0,errors_1.onUnexpectedError)(err)}return this}))}}exports.FileReferences=FileReferences;class ReferencesModel{constructor(links,title){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new event_1.Emitter,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=links,this._title=title;const[providersFirst]=links;let current;links.sort(ReferencesModel._compareReferences);for(let link of links)if(current&&resources_1.extUri.isEqual(current.uri,link.uri,!0)||(current=new FileReferences(this,link.uri),this.groups.push(current)),0===current.children.length||0!==ReferencesModel._compareReferences(link,current.children[current.children.length-1])){const oneRef=new OneReference(providersFirst===link,current,link,(ref=>this._onDidChangeReferenceRange.fire(ref)));this.references.push(oneRef),current.children.push(oneRef)}}dispose(){(0,lifecycle_1.dispose)(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new ReferencesModel(this._links,this._title)}get title(){return this._title}get isEmpty(){return 0===this.groups.length}get ariaMessage(){return this.isEmpty?(0,nls_1.localize)(4,null):1===this.references.length?(0,nls_1.localize)(5,null,this.references[0].uri.fsPath):1===this.groups.length?(0,nls_1.localize)(6,null,this.references.length,this.groups[0].uri.fsPath):(0,nls_1.localize)(7,null,this.references.length,this.groups.length)}nextOrPreviousReference(reference,next){let{parent}=reference,idx=parent.children.indexOf(reference),childCount=parent.children.length,groupCount=parent.parent.groups.length;return 1===groupCount||next&&idx+1<childCount||!next&&idx>0?(idx=next?(idx+1)%childCount:(idx+childCount-1)%childCount,parent.children[idx]):(idx=parent.parent.groups.indexOf(parent),next?(idx=(idx+1)%groupCount,parent.parent.groups[idx].children[0]):(idx=(idx+groupCount-1)%groupCount,parent.parent.groups[idx].children[parent.parent.groups[idx].children.length-1]))}nearestReference(resource,position){const nearest=this.references.map(((ref,idx)=>({idx,prefixLen:strings.commonPrefixLength(ref.uri.toString(),resource.toString()),offsetDist:100*Math.abs(ref.range.startLineNumber-position.lineNumber)+Math.abs(ref.range.startColumn-position.column)}))).sort(((a,b)=>a.prefixLen>b.prefixLen?-1:a.prefixLen<b.prefixLen?1:a.offsetDist<b.offsetDist?-1:a.offsetDist>b.offsetDist?1:0))[0];if(nearest)return this.references[nearest.idx]}referenceAt(resource,position){for(const ref of this.references)if(ref.uri.toString()===resource.toString()&&range_1.Range.containsPosition(ref.range,position))return ref}firstReference(){for(const ref of this.references)if(ref.isProviderFirst)return ref;return this.references[0]}static _compareReferences(a,b){return resources_1.extUri.compare(a.uri,b.uri)||range_1.Range.compareRangesUsingStarts(a.range,b.range)}}exports.ReferencesModel=ReferencesModel})),define(__m[551],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/gotoSymbol/browser/symbolNavigation",data)})),define(__m[552],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/hover/browser/hover",data)})),define(__m[553],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/hover/browser/markdownHoverParticipant",data)})),define(__m[554],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/hover/browser/markerHoverParticipant",data)})),define(__m[555],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace",data)})),define(__m[556],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/indentation/browser/indentation",data)})),define(__m[557],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/inlayHints/browser/inlayHintsHover",data)})),define(__m[558],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/inlineCompletions/browser/ghostTextController",data)})),define(__m[559],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/inlineCompletions/browser/inlineCompletionsHoverParticipant",data)})),define(__m[560],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/lineSelection/browser/lineSelection",data)})),define(__m[561],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/linesOperations/browser/linesOperations",data)})),define(__m[562],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/linkedEditing/browser/linkedEditing",data)})),define(__m[563],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/links/browser/links",data)})),define(__m[564],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/message/browser/messageController",data)})),define(__m[565],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/multicursor/browser/multicursor",data)})),define(__m[566],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/parameterHints/browser/parameterHints",data)})),define(__m[567],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/parameterHints/browser/parameterHintsWidget",data)})),define(__m[568],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/peekView/browser/peekView",data)})),define(__m[569],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess",data)})),define(__m[570],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess",data)})),define(__m[571],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/rename/browser/rename",data)})),define(__m[572],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/rename/browser/renameInputField",data)})),define(__m[573],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/smartSelect/browser/smartSelect",data)})),define(__m[574],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/snippet/browser/snippetController2",data)})),define(__m[575],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/snippet/browser/snippetVariables",data)})),define(__m[576],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggest",data)})),define(__m[577],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggestController",data)})),define(__m[578],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggestWidget",data)})),define(__m[579],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggestWidgetDetails",data)})),define(__m[580],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggestWidgetRenderer",data)})),define(__m[581],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/suggest/browser/suggestWidgetStatus",data)})),define(__m[582],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/symbolIcons/browser/symbolIcons",data)})),define(__m[583],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode",data)})),define(__m[584],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/tokenization/browser/tokenization",data)})),define(__m[585],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter",data)})),define(__m[586],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators",data)})),define(__m[587],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/wordHighlighter/browser/wordHighlighter",data)})),define(__m[588],__M([5,6]),(function(nls,data){return nls.create("vs/editor/contrib/wordOperations/browser/wordOperations",data)})),define(__m[589],__M([5,6]),(function(nls,data){return nls.create("vs/platform/actions/browser/menuEntryActionViewItem",data)})),define(__m[590],__M([5,6]),(function(nls,data){return nls.create("vs/platform/configuration/common/configurationRegistry",data)})),define(__m[591],__M([5,6]),(function(nls,data){return nls.create("vs/platform/contextkey/browser/contextKeyService",data)})),define(__m[592],__M([5,6]),(function(nls,data){return nls.create("vs/platform/contextkey/common/contextkeys",data)})),define(__m[593],__M([5,6]),(function(nls,data){return nls.create("vs/platform/history/browser/contextScopedHistoryWidget",data)})),define(__m[594],__M([5,6]),(function(nls,data){return nls.create("vs/platform/keybinding/common/abstractKeybindingService",data)})),define(__m[595],__M([5,6]),(function(nls,data){return nls.create("vs/platform/list/browser/listService",data)})),define(__m[596],__M([5,6]),(function(nls,data){return nls.create("vs/platform/markers/common/markers",data)})),define(__m[597],__M([5,6]),(function(nls,data){return nls.create("vs/platform/quickinput/browser/commandsQuickAccess",data)})),define(__m[598],__M([5,6]),(function(nls,data){return nls.create("vs/platform/quickinput/browser/helpQuickAccess",data)})),define(__m[599],__M([5,6]),(function(nls,data){return nls.create("vs/platform/theme/common/colorRegistry",data)})),define(__m[600],__M([5,6]),(function(nls,data){return nls.create("vs/platform/theme/common/iconRegistry",data)})),define(__m[601],__M([5,6]),(function(nls,data){return nls.create("vs/platform/undoRedo/common/undoRedoService",data)})),define(__m[602],__M([5,6]),(function(nls,data){return nls.create("vs/platform/workspace/common/workspace",data)})),define(__m[603],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorOpenSource=void 0,function(EditorOpenSource){EditorOpenSource[EditorOpenSource.API=0]="API",EditorOpenSource[EditorOpenSource.USER=1]="USER"}(exports.EditorOpenSource||(exports.EditorOpenSource={}))})),define(__m[604],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtensionIdentifier=void 0;exports.ExtensionIdentifier=class ExtensionIdentifier{constructor(value){this.value=value,this._lower=value.toLowerCase()}static toKey(id){return"string"==typeof id?id.toLowerCase():id._lower}}})),define(__m[273],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileKind=void 0,function(FileKind){FileKind[FileKind.FILE=0]="FILE",FileKind[FileKind.FOLDER=1]="FOLDER",FileKind[FileKind.ROOT_FOLDER=2]="ROOT_FOLDER"}(exports.FileKind||(exports.FileKind={}))})),define(__m[605],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.showHistoryKeybindingHint=void 0,exports.showHistoryKeybindingHint=function showHistoryKeybindingHint(keybindingService){var _a,_b;return"Up"===(null===(_a=keybindingService.lookupKeybinding("history.showPrevious"))||void 0===_a?void 0:_a.getElectronAccelerator())&&"Down"===(null===(_b=keybindingService.lookupKeybinding("history.showNext"))||void 0===_b?void 0:_b.getElectronAccelerator())}})),define(__m[199],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SyncDescriptor=void 0;exports.SyncDescriptor=class SyncDescriptor{constructor(ctor,staticArguments=[],supportsDelayedInstantiation=!1){this.ctor=ctor,this.staticArguments=staticArguments,this.supportsDelayedInstantiation=supportsDelayedInstantiation}}})),define(__m[52],__M([1,0,199]),(function(require,exports,descriptors_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSingletonServiceDescriptors=exports.registerSingleton=void 0;const _registry=[];exports.registerSingleton=function registerSingleton(id,ctorOrDescriptor,supportsDelayedInstantiation){ctorOrDescriptor instanceof descriptors_1.SyncDescriptor||(ctorOrDescriptor=new descriptors_1.SyncDescriptor(ctorOrDescriptor,[],supportsDelayedInstantiation)),_registry.push([id,ctorOrDescriptor])},exports.getSingletonServiceDescriptors=function getSingletonServiceDescriptors(){return _registry}})),define(__m[606],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Graph=exports.Node=void 0;class Node{constructor(data){this.incoming=new Map,this.outgoing=new Map,this.data=data}}exports.Node=Node;exports.Graph=class Graph{constructor(_hashFn){this._hashFn=_hashFn,this._nodes=new Map}roots(){const ret=[];for(let node of this._nodes.values())0===node.outgoing.size&&ret.push(node);return ret}insertEdge(from,to){const fromNode=this.lookupOrInsertNode(from),toNode=this.lookupOrInsertNode(to);fromNode.outgoing.set(this._hashFn(to),toNode),toNode.incoming.set(this._hashFn(from),fromNode)}removeNode(data){const key=this._hashFn(data);this._nodes.delete(key);for(let node of this._nodes.values())node.outgoing.delete(key),node.incoming.delete(key)}lookupOrInsertNode(data){const key=this._hashFn(data);let node=this._nodes.get(key);return node||(node=new Node(data),this._nodes.set(key,node)),node}isEmpty(){return 0===this._nodes.size}toString(){let data=[];for(let[key,value]of this._nodes)data.push(`${key}, (incoming)[${[...value.incoming.keys()].join(", ")}], (outgoing)[${[...value.outgoing.keys()].join(",")}]`);return data.join("\n")}findCycleSlow(){for(let[id,node]of this._nodes){const seen=new Set([id]),res=this._findCycle(node,seen);if(res)return res}}_findCycle(node,seen){for(let[id,outgoing]of node.outgoing){if(seen.has(id))return[...seen,id].join(" -> ");seen.add(id);const value=this._findCycle(outgoing,seen);if(value)return value;seen.delete(id)}}}})),define(__m[9],__M([1,0]),(function(require,exports){"use strict";var _util;function storeServiceDependency(id,target,index){target[_util.DI_TARGET]===target?target[_util.DI_DEPENDENCIES].push({id,index}):(target[_util.DI_DEPENDENCIES]=[{id,index}],target[_util.DI_TARGET]=target)}function createDecorator(serviceId){if(_util.serviceIds.has(serviceId))return _util.serviceIds.get(serviceId);const id=function(target,key,index){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");storeServiceDependency(id,target,index)};return id.toString=()=>serviceId,_util.serviceIds.set(serviceId,id),id}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDecorator=exports.IInstantiationService=exports._util=void 0,function(_util){_util.serviceIds=new Map,_util.DI_TARGET="$di$target",_util.DI_DEPENDENCIES="$di$dependencies",_util.getServiceDependencies=function getServiceDependencies(ctor){return ctor[_util.DI_DEPENDENCIES]||[]}}(_util=exports._util||(exports._util={})),exports.IInstantiationService=createDecorator("instantiationService"),exports.createDecorator=createDecorator})),define(__m[200],__M([1,0,9,25,19]),(function(require,exports,instantiation_1,uri_1,types_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResourceFileEdit=exports.ResourceTextEdit=exports.ResourceEdit=exports.IBulkEditService=void 0,exports.IBulkEditService=(0,instantiation_1.createDecorator)("IWorkspaceEditService");class ResourceEdit{constructor(metadata){this.metadata=metadata}static convert(edit){return edit.edits.map((edit=>{if(function isWorkspaceTextEdit(thing){return(0,types_1.isObject)(thing)&&uri_1.URI.isUri(thing.resource)&&(0,types_1.isObject)(thing.edit)}(edit))return new ResourceTextEdit(edit.resource,edit.edit,edit.modelVersionId,edit.metadata);if(function isWorkspaceFileEdit(thing){return(0,types_1.isObject)(thing)&&(Boolean(thing.newUri)||Boolean(thing.oldUri))}(edit))return new ResourceFileEdit(edit.oldUri,edit.newUri,edit.options,edit.metadata);throw new Error("Unsupported edit")}))}}exports.ResourceEdit=ResourceEdit;class ResourceTextEdit extends ResourceEdit{constructor(resource,textEdit,versionId,metadata){super(metadata),this.resource=resource,this.textEdit=textEdit,this.versionId=versionId}}exports.ResourceTextEdit=ResourceTextEdit;class ResourceFileEdit extends ResourceEdit{constructor(oldResource,newResource,options,metadata){super(metadata),this.oldResource=oldResource,this.newResource=newResource,this.options=options}}exports.ResourceFileEdit=ResourceFileEdit})),define(__m[29],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ICodeEditorService=void 0,exports.ICodeEditorService=(0,instantiation_1.createDecorator)("codeEditorService")})),define(__m[35],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ILanguageService=void 0,exports.ILanguageService=(0,instantiation_1.createDecorator)("languageService")})),define(__m[88],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IEditorWorkerService=exports.ID_EDITOR_WORKER_SERVICE=void 0,exports.ID_EDITOR_WORKER_SERVICE="editorWorkerService",exports.IEditorWorkerService=(0,instantiation_1.createDecorator)(exports.ID_EDITOR_WORKER_SERVICE)})),define(__m[20],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ILanguageFeaturesService=void 0,exports.ILanguageFeaturesService=(0,instantiation_1.createDecorator)("ILanguageFeaturesService")})),define(__m[607],__M([1,0,421,20,52]),(function(require,exports,languageFeatureRegistry_1,languageFeatures_1,extensions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguageFeaturesService=void 0;class LanguageFeaturesService{constructor(){this.referenceProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.renameProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.codeActionProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.definitionProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.typeDefinitionProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.declarationProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.implementationProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentSymbolProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.inlayHintsProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.colorProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.codeLensProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentFormattingEditProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeFormattingEditProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.onTypeFormattingEditProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.signatureHelpProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.hoverProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentHighlightProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.selectionRangeProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.foldingRangeProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.linkProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.inlineCompletionsProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.completionProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.linkedEditingRangeProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this)),this.documentSemanticTokensProvider=new languageFeatureRegistry_1.LanguageFeatureRegistry(this._score.bind(this))}_score(uri){var _a;return null===(_a=this._notebookTypeResolver)||void 0===_a?void 0:_a.call(this,uri)}}exports.LanguageFeaturesService=LanguageFeaturesService,(0,extensions_1.registerSingleton)(languageFeatures_1.ILanguageFeaturesService,LanguageFeaturesService,!0)})),define(__m[201],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IMarkerDecorationsService=void 0,exports.IMarkerDecorationsService=(0,instantiation_1.createDecorator)("markerDecorationsService")})),define(__m[48],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IModelService=void 0,exports.IModelService=(0,instantiation_1.createDecorator)("modelService")})),define(__m[56],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ITextModelService=void 0,exports.ITextModelService=(0,instantiation_1.createDecorator)("textModelService")})),define(__m[156],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ITextResourcePropertiesService=exports.ITextResourceConfigurationService=void 0,exports.ITextResourceConfigurationService=(0,instantiation_1.createDecorator)("textResourceConfigurationService"),exports.ITextResourcePropertiesService=(0,instantiation_1.createDecorator)("textResourcePropertiesService")})),define(__m[103],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IStandaloneThemeService=void 0,exports.IStandaloneThemeService=(0,instantiation_1.createDecorator)("themeService")})),define(__m[104],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IClipboardService=void 0,exports.IClipboardService=(0,instantiation_1.createDecorator)("clipboardService")})),define(__m[26],__M([1,0,4,57,2,83,19,9]),(function(require,exports,event_1,iterator_1,lifecycle_1,linkedList_1,types_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NullCommandService=exports.CommandsRegistry=exports.ICommandService=void 0,exports.ICommandService=(0,instantiation_1.createDecorator)("commandService"),exports.CommandsRegistry=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new event_1.Emitter,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(idOrCommand,handler){if(!idOrCommand)throw new Error("invalid command");if("string"==typeof idOrCommand){if(!handler)throw new Error("invalid command");return this.registerCommand({id:idOrCommand,handler})}if(idOrCommand.description){const constraints=[];for(let arg of idOrCommand.description.args)constraints.push(arg.constraint);const actualHandler=idOrCommand.handler;idOrCommand.handler=function(accessor,...args){return(0,types_1.validateConstraints)(args,constraints),actualHandler(accessor,...args)}}const{id}=idOrCommand;let commands=this._commands.get(id);commands||(commands=new linkedList_1.LinkedList,this._commands.set(id,commands));let removeFn=commands.unshift(idOrCommand),ret=(0,lifecycle_1.toDisposable)((()=>{removeFn();const command=this._commands.get(id);(null==command?void 0:command.isEmpty())&&this._commands.delete(id)}));return this._onDidRegisterCommand.fire(id),ret}registerCommandAlias(oldId,newId){return exports.CommandsRegistry.registerCommand(oldId,((accessor,...args)=>accessor.get(exports.ICommandService).executeCommand(newId,...args)))}getCommand(id){const list=this._commands.get(id);if(list&&!list.isEmpty())return iterator_1.Iterable.first(list)}getCommands(){const result=new Map;for(const key of this._commands.keys()){const command=this.getCommand(key);command&&result.set(key,command)}return result}},exports.NullCommandService={_serviceBrand:void 0,onWillExecuteCommand:()=>lifecycle_1.Disposable.None,onDidExecuteCommand:()=>lifecycle_1.Disposable.None,executeCommand:()=>Promise.resolve(void 0)},exports.CommandsRegistry.registerCommand("noop",(()=>{}))})),define(__m[274],__M([1,0,21,13,25,48,26,19,431,3,20]),(function(require,exports,cancellation_1,errors_1,uri_1,model_1,commands_1,types_1,semanticTokensDto_1,range_1,languageFeatures_1){"use strict";function isSemanticTokens(v){return v&&!!v.data}function isSemanticTokensEdits(v){return v&&Array.isArray(v.edits)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocumentRangeSemanticTokens=exports.hasDocumentRangeSemanticTokensProvider=exports.getDocumentSemanticTokens=exports.hasDocumentSemanticTokensProvider=exports.DocumentSemanticTokensResult=exports.isSemanticTokensEdits=exports.isSemanticTokens=void 0,exports.isSemanticTokens=isSemanticTokens,exports.isSemanticTokensEdits=isSemanticTokensEdits;class DocumentSemanticTokensResult{constructor(provider,tokens,error){this.provider=provider,this.tokens=tokens,this.error=error}}function hasDocumentSemanticTokensProvider(registry,model){return registry.has(model)}function getDocumentSemanticTokens(registry,model,lastProvider,lastResultId,token){return __awaiter(this,void 0,void 0,(function*(){const providers=function getDocumentSemanticTokensProviders(registry,model){const groups=registry.orderedGroups(model);return groups.length>0?groups[0]:[]}(registry,model),results=yield Promise.all(providers.map((provider=>__awaiter(this,void 0,void 0,(function*(){let result,error=null;try{result=yield provider.provideDocumentSemanticTokens(model,provider===lastProvider?lastResultId:null,token)}catch(err){error=err,result=null}return result&&(isSemanticTokens(result)||isSemanticTokensEdits(result))||(result=null),new DocumentSemanticTokensResult(provider,result,error)})))));for(const result of results){if(result.error)throw result.error;if(result.tokens)return result}return results.length>0?results[0]:null}))}exports.DocumentSemanticTokensResult=DocumentSemanticTokensResult,exports.hasDocumentSemanticTokensProvider=hasDocumentSemanticTokensProvider,exports.getDocumentSemanticTokens=getDocumentSemanticTokens;class DocumentRangeSemanticTokensResult{constructor(provider,tokens){this.provider=provider,this.tokens=tokens}}function getDocumentRangeSemanticTokensProviders(providers,model){const groups=providers.orderedGroups(model);return groups.length>0?groups[0]:[]}function getDocumentRangeSemanticTokens(registry,model,range,token){return __awaiter(this,void 0,void 0,(function*(){const providers=getDocumentRangeSemanticTokensProviders(registry,model),results=yield Promise.all(providers.map((provider=>__awaiter(this,void 0,void 0,(function*(){let result;try{result=yield provider.provideDocumentRangeSemanticTokens(model,range,token)}catch(err){(0,errors_1.onUnexpectedExternalError)(err),result=null}return result&&isSemanticTokens(result)||(result=null),new DocumentRangeSemanticTokensResult(provider,result)})))));for(const result of results)if(result.tokens)return result;return results.length>0?results[0]:null}))}exports.hasDocumentRangeSemanticTokensProvider=function hasDocumentRangeSemanticTokensProvider(providers,model){return providers.has(model)},exports.getDocumentRangeSemanticTokens=getDocumentRangeSemanticTokens,commands_1.CommandsRegistry.registerCommand("_provideDocumentSemanticTokensLegend",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri]=args;(0,types_1.assertType)(uri instanceof uri_1.URI);const model=accessor.get(model_1.IModelService).getModel(uri);if(!model)return;const{documentSemanticTokensProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),providers=function _getDocumentSemanticTokensProviderHighestGroup(registry,model){const result=registry.orderedGroups(model);return result.length>0?result[0]:null}(documentSemanticTokensProvider,model);return providers?providers[0].getLegend():accessor.get(commands_1.ICommandService).executeCommand("_provideDocumentRangeSemanticTokensLegend",uri)})))),commands_1.CommandsRegistry.registerCommand("_provideDocumentSemanticTokens",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri]=args;(0,types_1.assertType)(uri instanceof uri_1.URI);const model=accessor.get(model_1.IModelService).getModel(uri);if(!model)return;const{documentSemanticTokensProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService);if(!hasDocumentSemanticTokensProvider(documentSemanticTokensProvider,model))return accessor.get(commands_1.ICommandService).executeCommand("_provideDocumentRangeSemanticTokens",uri,model.getFullModelRange());const r=yield getDocumentSemanticTokens(documentSemanticTokensProvider,model,null,null,cancellation_1.CancellationToken.None);if(!r)return;const{provider,tokens}=r;if(!tokens||!isSemanticTokens(tokens))return;const buff=(0,semanticTokensDto_1.encodeSemanticTokensDto)({id:0,type:"full",data:tokens.data});return tokens.resultId&&provider.releaseDocumentSemanticTokens(tokens.resultId),buff})))),commands_1.CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokensLegend",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri,range]=args;(0,types_1.assertType)(uri instanceof uri_1.URI);const model=accessor.get(model_1.IModelService).getModel(uri);if(!model)return;const{documentRangeSemanticTokensProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),providers=getDocumentRangeSemanticTokensProviders(documentRangeSemanticTokensProvider,model);if(0===providers.length)return;if(1===providers.length)return providers[0].getLegend();if(!range||!range_1.Range.isIRange(range))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),providers[0].getLegend();const result=yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider,model,range_1.Range.lift(range),cancellation_1.CancellationToken.None);return result?result.provider.getLegend():void 0})))),commands_1.CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokens",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri,range]=args;(0,types_1.assertType)(uri instanceof uri_1.URI),(0,types_1.assertType)(range_1.Range.isIRange(range));const model=accessor.get(model_1.IModelService).getModel(uri);if(!model)return;const{documentRangeSemanticTokensProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),result=yield getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider,model,range_1.Range.lift(range),cancellation_1.CancellationToken.None);return result&&result.tokens?(0,semanticTokensDto_1.encodeSemanticTokensDto)({id:0,type:"full",data:result.tokens.data}):void 0}))))})),define(__m[275],__M([1,0,21,13,2,19,25,48,26,20]),(function(require,exports,cancellation_1,errors_1,lifecycle_1,types_1,uri_1,model_1,commands_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCodeLensModel=exports.CodeLensModel=void 0;class CodeLensModel{constructor(){this.lenses=[],this._disposables=new lifecycle_1.DisposableStore}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(list,provider){this._disposables.add(list);for(const symbol of list.lenses)this.lenses.push({symbol,provider})}}function getCodeLensModel(registry,model,token){return __awaiter(this,void 0,void 0,(function*(){const provider=registry.ordered(model),providerRanks=new Map,result=new CodeLensModel,promises=provider.map(((provider,i)=>__awaiter(this,void 0,void 0,(function*(){providerRanks.set(provider,i);try{const list=yield Promise.resolve(provider.provideCodeLenses(model,token));list&&result.add(list,provider)}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}}))));return yield Promise.all(promises),result.lenses=result.lenses.sort(((a,b)=>a.symbol.range.startLineNumber<b.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>b.symbol.range.startLineNumber?1:providerRanks.get(a.provider)<providerRanks.get(b.provider)?-1:providerRanks.get(a.provider)>providerRanks.get(b.provider)?1:a.symbol.range.startColumn<b.symbol.range.startColumn?-1:a.symbol.range.startColumn>b.symbol.range.startColumn?1:0)),result}))}exports.CodeLensModel=CodeLensModel,exports.getCodeLensModel=getCodeLensModel,commands_1.CommandsRegistry.registerCommand("_executeCodeLensProvider",(function(accessor,...args){let[uri,itemResolveCount]=args;(0,types_1.assertType)(uri_1.URI.isUri(uri)),(0,types_1.assertType)("number"==typeof itemResolveCount||!itemResolveCount);const{codeLensProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=accessor.get(model_1.IModelService).getModel(uri);if(!model)throw(0,errors_1.illegalArgument)();const result=[],disposables=new lifecycle_1.DisposableStore;return getCodeLensModel(codeLensProvider,model,cancellation_1.CancellationToken.None).then((value=>{disposables.add(value);let resolve=[];for(const item of value.lenses)null==itemResolveCount||Boolean(item.symbol.command)?result.push(item.symbol):itemResolveCount-- >0&&item.provider.resolveCodeLens&&resolve.push(Promise.resolve(item.provider.resolveCodeLens(model,item.symbol,cancellation_1.CancellationToken.None)).then((symbol=>result.push(symbol||item.symbol))));return Promise.all(resolve)})).then((()=>result)).finally((()=>{setTimeout((()=>disposables.dispose()),100)}))}))})),define(__m[276],__M([1,0,21,13,25,3,48,26,20]),(function(require,exports,cancellation_1,errors_1,uri_1,range_1,model_1,commands_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getColorPresentations=exports.getColors=void 0,exports.getColors=function getColors(registry,model,token){const colors=[],promises=registry.ordered(model).reverse().map((provider=>Promise.resolve(provider.provideDocumentColors(model,token)).then((result=>{if(Array.isArray(result))for(let colorInfo of result)colors.push({colorInfo,provider})}))));return Promise.all(promises).then((()=>colors))},exports.getColorPresentations=function getColorPresentations(model,colorInfo,provider,token){return Promise.resolve(provider.provideColorPresentations(model,colorInfo,token))},commands_1.CommandsRegistry.registerCommand("_executeDocumentColorProvider",(function(accessor,...args){const[resource]=args;if(!(resource instanceof uri_1.URI))throw(0,errors_1.illegalArgument)();const{colorProvider:colorProviderRegistry}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=accessor.get(model_1.IModelService).getModel(resource);if(!model)throw(0,errors_1.illegalArgument)();const rawCIs=[],promises=colorProviderRegistry.ordered(model).reverse().map((provider=>Promise.resolve(provider.provideDocumentColors(model,cancellation_1.CancellationToken.None)).then((result=>{if(Array.isArray(result))for(let ci of result)rawCIs.push({range:ci.range,color:[ci.color.red,ci.color.green,ci.color.blue,ci.color.alpha]})}))));return Promise.all(promises).then((()=>rawCIs))})),commands_1.CommandsRegistry.registerCommand("_executeColorPresentationProvider",(function(accessor,...args){const[color,context]=args,{uri,range}=context;if(!(uri instanceof uri_1.URI&&Array.isArray(color)&&4===color.length&&range_1.Range.isIRange(range)))throw(0,errors_1.illegalArgument)();const[red,green,blue,alpha]=color,{colorProvider:colorProviderRegistry}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=accessor.get(model_1.IModelService).getModel(uri);if(!model)throw(0,errors_1.illegalArgument)();const colorInfo={range,color:{red,green,blue,alpha}},presentations=[],promises=colorProviderRegistry.ordered(model).reverse().map((provider=>Promise.resolve(provider.provideColorPresentations(model,colorInfo,cancellation_1.CancellationToken.None)).then((result=>{Array.isArray(result)&&presentations.push(...result)}))));return Promise.all(promises).then((()=>presentations))}))})),define(__m[608],__M([1,0,18,21,13,2,19,25,3,48,26,20]),(function(require,exports,arrays_1,cancellation_1,errors_1,lifecycle_1,types_1,uri_1,range_1,model_1,commands_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLinks=exports.LinksList=exports.Link=void 0;class Link{constructor(link,provider){this._link=link,this._provider=provider}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(token){return __awaiter(this,void 0,void 0,(function*(){return this._link.url?this._link.url:"function"==typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,token)).then((value=>(this._link=value||this._link,this._link.url?this.resolve(token):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}))}}exports.Link=Link;class LinksList{constructor(tuples){this._disposables=new lifecycle_1.DisposableStore;let links=[];for(const[list,provider]of tuples){const newLinks=list.links.map((link=>new Link(link,provider)));links=LinksList._union(links,newLinks),(0,lifecycle_1.isDisposable)(list)&&this._disposables.add(list)}this.links=links}dispose(){this._disposables.dispose(),this.links.length=0}static _union(oldLinks,newLinks){let oldIndex,oldLen,newIndex,newLen,result=[];for(oldIndex=0,newIndex=0,oldLen=oldLinks.length,newLen=newLinks.length;oldIndex<oldLen&&newIndex<newLen;){const oldLink=oldLinks[oldIndex],newLink=newLinks[newIndex];if(range_1.Range.areIntersectingOrTouching(oldLink.range,newLink.range)){oldIndex++;continue}range_1.Range.compareRangesUsingStarts(oldLink.range,newLink.range)<0?(result.push(oldLink),oldIndex++):(result.push(newLink),newIndex++)}for(;oldIndex<oldLen;oldIndex++)result.push(oldLinks[oldIndex]);for(;newIndex<newLen;newIndex++)result.push(newLinks[newIndex]);return result}}function getLinks(providers,model,token){const lists=[],promises=providers.ordered(model).reverse().map(((provider,i)=>Promise.resolve(provider.provideLinks(model,token)).then((result=>{result&&(lists[i]=[result,provider])}),errors_1.onUnexpectedExternalError)));return Promise.all(promises).then((()=>{const result=new LinksList((0,arrays_1.coalesce)(lists));return token.isCancellationRequested?(result.dispose(),new LinksList([])):result}))}exports.LinksList=LinksList,exports.getLinks=getLinks,commands_1.CommandsRegistry.registerCommand("_executeLinkProvider",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){let[uri,resolveCount]=args;(0,types_1.assertType)(uri instanceof uri_1.URI),"number"!=typeof resolveCount&&(resolveCount=0);const{linkProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=accessor.get(model_1.IModelService).getModel(uri);if(!model)return[];const list=yield getLinks(linkProvider,model,cancellation_1.CancellationToken.None);if(!list)return[];for(let i=0;i<Math.min(resolveCount,list.links.length);i++)yield list.links[i].resolve(cancellation_1.CancellationToken.None);const result=list.links.slice(0);return list.dispose(),result}))))})),define(__m[41],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";function addToValueTree(settingsTreeRoot,key,value,conflictReporter){const segments=key.split("."),last=segments.pop();let curr=settingsTreeRoot;for(let i=0;i<segments.length;i++){let s=segments[i],obj=curr[s];switch(typeof obj){case"undefined":obj=curr[s]=Object.create(null);break;case"object":break;default:return void conflictReporter(`Ignoring ${key} as ${segments.slice(0,i+1).join(".")} is ${JSON.stringify(obj)}`)}curr=obj}if("object"==typeof curr&&null!==curr)try{curr[last]=value}catch(e){conflictReporter(`Ignoring ${key} as ${segments.join(".")} is ${JSON.stringify(curr)}`)}else conflictReporter(`Ignoring ${key} as ${segments.join(".")} is ${JSON.stringify(curr)}`)}function doRemoveFromValueTree(valueTree,segments){const first=segments.shift();if(0!==segments.length){if(-1!==Object.keys(valueTree).indexOf(first)){const value=valueTree[first];"object"!=typeof value||Array.isArray(value)||(doRemoveFromValueTree(value,segments),0===Object.keys(value).length&&delete valueTree[first])}}else delete valueTree[first]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getConfigurationValue=exports.removeFromValueTree=exports.addToValueTree=exports.toValuesTree=exports.IConfigurationService=void 0,exports.IConfigurationService=(0,instantiation_1.createDecorator)("configurationService"),exports.toValuesTree=function toValuesTree(properties,conflictReporter){const root=Object.create(null);for(let key in properties)addToValueTree(root,key,properties[key],conflictReporter);return root},exports.addToValueTree=addToValueTree,exports.removeFromValueTree=function removeFromValueTree(valueTree,key){doRemoveFromValueTree(valueTree,key.split("."))},exports.getConfigurationValue=function getConfigurationValue(config,settingPath,defaultValue){const result=function accessSetting(config,path){let current=config;for(const component of path){if("object"!=typeof current||null===current)return;current=current[component]}return current}(config,settingPath.split("."));return void 0===result?defaultValue:result}}));var __param=this&&this.__param||function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}};define(__m[33],__M([1,0,4,2,8,121,122,123,415,419,416,418,183,9,41,35,52]),(function(require,exports,event_1,lifecycle_1,strings,wordHelper_1,languageConfiguration_1,supports_1,characterPair_1,electricCharacter_1,indentRules_1,onEnter_1,richEditBrackets_1,instantiation_1,configuration_1,language_1,extensions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResolvedLanguageConfiguration=exports.LanguageConfigurationRegistry=exports.LanguageConfigurationRegistryImpl=exports.LanguageConfigurationChangeEvent=exports.LanguageConfigurationService=exports.ILanguageConfigurationService=exports.LanguageConfigurationServiceChangeEvent=void 0;class LanguageConfigurationServiceChangeEvent{constructor(languageId){this.languageId=languageId}affects(languageId){return!this.languageId||this.languageId===languageId}}exports.LanguageConfigurationServiceChangeEvent=LanguageConfigurationServiceChangeEvent,exports.ILanguageConfigurationService=(0,instantiation_1.createDecorator)("languageConfigurationService");let LanguageConfigurationService=class LanguageConfigurationService extends lifecycle_1.Disposable{constructor(configurationService,languageService){super(),this.configurationService=configurationService,this.languageService=languageService,this.onDidChangeEmitter=this._register(new event_1.Emitter),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const languageConfigKeys=new Set(Object.values(customizedLanguageConfigKeys));this._register(this.configurationService.onDidChangeConfiguration((e=>{const globalConfigChanged=e.change.keys.some((k=>languageConfigKeys.has(k))),localConfigChanged=e.change.overrides.filter((([overrideLangName,keys])=>keys.some((k=>languageConfigKeys.has(k))))).map((([overrideLangName])=>overrideLangName));if(globalConfigChanged)this.configurations.clear(),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(void 0));else for(const languageId of localConfigChanged)this.languageService.isRegisteredLanguageId(languageId)&&(this.configurations.delete(languageId),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(languageId)))}))),this._register(exports.LanguageConfigurationRegistry.onDidChange((e=>{this.configurations.delete(e.languageId),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(e.languageId))})))}getLanguageConfiguration(languageId){let result=this.configurations.get(languageId);return result||(result=function computeConfig(languageId,configurationService,languageService){let languageConfig=exports.LanguageConfigurationRegistry.getLanguageConfiguration(languageId);if(!languageConfig){if(!languageService.isRegisteredLanguageId(languageId))throw new Error(`Language id "${languageId}" is not configured nor known`);languageConfig=new ResolvedLanguageConfiguration(languageId,{})}const customizedConfig=function getCustomizedLanguageConfig(languageId,configurationService){const brackets=configurationService.getValue(customizedLanguageConfigKeys.brackets,{overrideIdentifier:languageId}),colorizedBracketPairs=configurationService.getValue(customizedLanguageConfigKeys.colorizedBracketPairs,{overrideIdentifier:languageId});return{brackets:validateBracketPairs(brackets),colorizedBracketPairs:validateBracketPairs(colorizedBracketPairs)}}(languageConfig.languageId,configurationService),data=combineLanguageConfigurations([languageConfig.underlyingConfig,customizedConfig]);return new ResolvedLanguageConfiguration(languageConfig.languageId,data)}(languageId,this.configurationService,this.languageService),this.configurations.set(languageId,result)),result}};LanguageConfigurationService=__decorate([__param(0,configuration_1.IConfigurationService),__param(1,language_1.ILanguageService)],LanguageConfigurationService),exports.LanguageConfigurationService=LanguageConfigurationService;const customizedLanguageConfigKeys={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function validateBracketPairs(data){if(Array.isArray(data))return data.map((pair=>{if(Array.isArray(pair)&&2===pair.length)return[pair[0],pair[1]]})).filter((p=>!!p))}class LanguageConfigurationChangeEvent{constructor(languageId){this.languageId=languageId}}exports.LanguageConfigurationChangeEvent=LanguageConfigurationChangeEvent;class LanguageConfigurationRegistryImpl{constructor(){this._entries=new Map,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event}register(languageId,configuration,priority=0){let entries=this._entries.get(languageId);entries||(entries=new ComposedLanguageConfiguration(languageId),this._entries.set(languageId,entries));const disposable=entries.register(configuration,priority);return this._onDidChange.fire(new LanguageConfigurationChangeEvent(languageId)),(0,lifecycle_1.toDisposable)((()=>{disposable.dispose(),this._onDidChange.fire(new LanguageConfigurationChangeEvent(languageId))}))}getLanguageConfiguration(languageId){const entries=this._entries.get(languageId);return(null==entries?void 0:entries.getResolvedConfiguration())||null}getComments(languageId){const value=this.getLanguageConfiguration(languageId);return value&&value.comments||null}getIndentRulesSupport(languageId){const value=this.getLanguageConfiguration(languageId);return value&&value.indentRulesSupport||null}getPrecedingValidLine(model,lineNumber,indentRulesSupport){const languageId=model.getLanguageIdAtPosition(lineNumber,0);if(lineNumber>1){let lastLineNumber,resultLineNumber=-1;for(lastLineNumber=lineNumber-1;lastLineNumber>=1;lastLineNumber--){if(model.getLanguageIdAtPosition(lastLineNumber,0)!==languageId)return resultLineNumber;const text=model.getLineContent(lastLineNumber);if(!indentRulesSupport.shouldIgnore(text)&&!/^\s+$/.test(text)&&""!==text)return lastLineNumber;resultLineNumber=lastLineNumber}}return-1}getInheritIndentForLine(autoIndent,model,lineNumber,honorIntentialIndent=!0){if(autoIndent<4)return null;const indentRulesSupport=this.getIndentRulesSupport(model.getLanguageId());if(!indentRulesSupport)return null;if(lineNumber<=1)return{indentation:"",action:null};const precedingUnIgnoredLine=this.getPrecedingValidLine(model,lineNumber,indentRulesSupport);if(precedingUnIgnoredLine<0)return null;if(precedingUnIgnoredLine<1)return{indentation:"",action:null};const precedingUnIgnoredLineContent=model.getLineContent(precedingUnIgnoredLine);if(indentRulesSupport.shouldIncrease(precedingUnIgnoredLineContent)||indentRulesSupport.shouldIndentNextLine(precedingUnIgnoredLineContent))return{indentation:strings.getLeadingWhitespace(precedingUnIgnoredLineContent),action:languageConfiguration_1.IndentAction.Indent,line:precedingUnIgnoredLine};if(indentRulesSupport.shouldDecrease(precedingUnIgnoredLineContent))return{indentation:strings.getLeadingWhitespace(precedingUnIgnoredLineContent),action:null,line:precedingUnIgnoredLine};{if(1===precedingUnIgnoredLine)return{indentation:strings.getLeadingWhitespace(model.getLineContent(precedingUnIgnoredLine)),action:null,line:precedingUnIgnoredLine};const previousLine=precedingUnIgnoredLine-1,previousLineIndentMetadata=indentRulesSupport.getIndentMetadata(model.getLineContent(previousLine));if(!(3&previousLineIndentMetadata)&&4&previousLineIndentMetadata){let stopLine=0;for(let i=previousLine-1;i>0;i--)if(!indentRulesSupport.shouldIndentNextLine(model.getLineContent(i))){stopLine=i;break}return{indentation:strings.getLeadingWhitespace(model.getLineContent(stopLine+1)),action:null,line:stopLine+1}}if(honorIntentialIndent)return{indentation:strings.getLeadingWhitespace(model.getLineContent(precedingUnIgnoredLine)),action:null,line:precedingUnIgnoredLine};for(let i=precedingUnIgnoredLine;i>0;i--){const lineContent=model.getLineContent(i);if(indentRulesSupport.shouldIncrease(lineContent))return{indentation:strings.getLeadingWhitespace(lineContent),action:languageConfiguration_1.IndentAction.Indent,line:i};if(indentRulesSupport.shouldIndentNextLine(lineContent)){let stopLine=0;for(let j=i-1;j>0;j--)if(!indentRulesSupport.shouldIndentNextLine(model.getLineContent(i))){stopLine=j;break}return{indentation:strings.getLeadingWhitespace(model.getLineContent(stopLine+1)),action:null,line:stopLine+1}}if(indentRulesSupport.shouldDecrease(lineContent))return{indentation:strings.getLeadingWhitespace(lineContent),action:null,line:i}}return{indentation:strings.getLeadingWhitespace(model.getLineContent(1)),action:null,line:1}}}getGoodIndentForLine(autoIndent,virtualModel,languageId,lineNumber,indentConverter){if(autoIndent<4)return null;const richEditSupport=this.getLanguageConfiguration(languageId);if(!richEditSupport)return null;const indentRulesSupport=this.getIndentRulesSupport(languageId);if(!indentRulesSupport)return null;const indent=this.getInheritIndentForLine(autoIndent,virtualModel,lineNumber),lineContent=virtualModel.getLineContent(lineNumber);if(indent){const inheritLine=indent.line;if(void 0!==inheritLine){const enterResult=richEditSupport.onEnter(autoIndent,"",virtualModel.getLineContent(inheritLine),"");if(enterResult){let indentation=strings.getLeadingWhitespace(virtualModel.getLineContent(inheritLine));return enterResult.removeText&&(indentation=indentation.substring(0,indentation.length-enterResult.removeText)),enterResult.indentAction===languageConfiguration_1.IndentAction.Indent||enterResult.indentAction===languageConfiguration_1.IndentAction.IndentOutdent?indentation=indentConverter.shiftIndent(indentation):enterResult.indentAction===languageConfiguration_1.IndentAction.Outdent&&(indentation=indentConverter.unshiftIndent(indentation)),indentRulesSupport.shouldDecrease(lineContent)&&(indentation=indentConverter.unshiftIndent(indentation)),enterResult.appendText&&(indentation+=enterResult.appendText),strings.getLeadingWhitespace(indentation)}}return indentRulesSupport.shouldDecrease(lineContent)?indent.action===languageConfiguration_1.IndentAction.Indent?indent.indentation:indentConverter.unshiftIndent(indent.indentation):indent.action===languageConfiguration_1.IndentAction.Indent?indentConverter.shiftIndent(indent.indentation):indent.indentation}return null}getIndentForEnter(autoIndent,model,range,indentConverter){if(autoIndent<4)return null;model.forceTokenization(range.startLineNumber);const lineTokens=model.getLineTokens(range.startLineNumber),scopedLineTokens=(0,supports_1.createScopedLineTokens)(lineTokens,range.startColumn-1),scopedLineText=scopedLineTokens.getLineContent();let beforeEnterText,afterEnterText,embeddedLanguage=!1;if(scopedLineTokens.firstCharOffset>0&&lineTokens.getLanguageId(0)!==scopedLineTokens.languageId?(embeddedLanguage=!0,beforeEnterText=scopedLineText.substr(0,range.startColumn-1-scopedLineTokens.firstCharOffset)):beforeEnterText=lineTokens.getLineContent().substring(0,range.startColumn-1),range.isEmpty())afterEnterText=scopedLineText.substr(range.startColumn-1-scopedLineTokens.firstCharOffset);else{afterEnterText=this.getScopedLineTokens(model,range.endLineNumber,range.endColumn).getLineContent().substr(range.endColumn-1-scopedLineTokens.firstCharOffset)}const indentRulesSupport=this.getIndentRulesSupport(scopedLineTokens.languageId);if(!indentRulesSupport)return null;const beforeEnterResult=beforeEnterText,beforeEnterIndent=strings.getLeadingWhitespace(beforeEnterText),virtualModel={getLineTokens:lineNumber=>model.getLineTokens(lineNumber),getLanguageId:()=>model.getLanguageId(),getLanguageIdAtPosition:(lineNumber,column)=>model.getLanguageIdAtPosition(lineNumber,column),getLineContent:lineNumber=>lineNumber===range.startLineNumber?beforeEnterResult:model.getLineContent(lineNumber)},currentLineIndent=strings.getLeadingWhitespace(lineTokens.getLineContent()),afterEnterAction=this.getInheritIndentForLine(autoIndent,virtualModel,range.startLineNumber+1);if(!afterEnterAction){const beforeEnter=embeddedLanguage?currentLineIndent:beforeEnterIndent;return{beforeEnter,afterEnter:beforeEnter}}let afterEnterIndent=embeddedLanguage?currentLineIndent:afterEnterAction.indentation;return afterEnterAction.action===languageConfiguration_1.IndentAction.Indent&&(afterEnterIndent=indentConverter.shiftIndent(afterEnterIndent)),indentRulesSupport.shouldDecrease(afterEnterText)&&(afterEnterIndent=indentConverter.unshiftIndent(afterEnterIndent)),{beforeEnter:embeddedLanguage?currentLineIndent:beforeEnterIndent,afterEnter:afterEnterIndent}}getIndentActionForType(autoIndent,model,range,ch,indentConverter){if(autoIndent<4)return null;const scopedLineTokens=this.getScopedLineTokens(model,range.startLineNumber,range.startColumn);if(scopedLineTokens.firstCharOffset)return null;const indentRulesSupport=this.getIndentRulesSupport(scopedLineTokens.languageId);if(!indentRulesSupport)return null;const scopedLineText=scopedLineTokens.getLineContent(),beforeTypeText=scopedLineText.substr(0,range.startColumn-1-scopedLineTokens.firstCharOffset);let afterTypeText;if(range.isEmpty())afterTypeText=scopedLineText.substr(range.startColumn-1-scopedLineTokens.firstCharOffset);else{afterTypeText=this.getScopedLineTokens(model,range.endLineNumber,range.endColumn).getLineContent().substr(range.endColumn-1-scopedLineTokens.firstCharOffset)}if(!indentRulesSupport.shouldDecrease(beforeTypeText+afterTypeText)&&indentRulesSupport.shouldDecrease(beforeTypeText+ch+afterTypeText)){const r=this.getInheritIndentForLine(autoIndent,model,range.startLineNumber,!1);if(!r)return null;let indentation=r.indentation;return r.action!==languageConfiguration_1.IndentAction.Indent&&(indentation=indentConverter.unshiftIndent(indentation)),indentation}return null}getIndentMetadata(model,lineNumber){const indentRulesSupport=this.getIndentRulesSupport(model.getLanguageId());return indentRulesSupport?lineNumber<1||lineNumber>model.getLineCount()?null:indentRulesSupport.getIndentMetadata(model.getLineContent(lineNumber)):null}getEnterAction(autoIndent,model,range){const scopedLineTokens=this.getScopedLineTokens(model,range.startLineNumber,range.startColumn),richEditSupport=this.getLanguageConfiguration(scopedLineTokens.languageId);if(!richEditSupport)return null;const scopedLineText=scopedLineTokens.getLineContent(),beforeEnterText=scopedLineText.substr(0,range.startColumn-1-scopedLineTokens.firstCharOffset);let afterEnterText;if(range.isEmpty())afterEnterText=scopedLineText.substr(range.startColumn-1-scopedLineTokens.firstCharOffset);else{afterEnterText=this.getScopedLineTokens(model,range.endLineNumber,range.endColumn).getLineContent().substr(range.endColumn-1-scopedLineTokens.firstCharOffset)}let previousLineText="";if(range.startLineNumber>1&&0===scopedLineTokens.firstCharOffset){const oneLineAboveScopedLineTokens=this.getScopedLineTokens(model,range.startLineNumber-1);oneLineAboveScopedLineTokens.languageId===scopedLineTokens.languageId&&(previousLineText=oneLineAboveScopedLineTokens.getLineContent())}const enterResult=richEditSupport.onEnter(autoIndent,previousLineText,beforeEnterText,afterEnterText);if(!enterResult)return null;const indentAction=enterResult.indentAction;let appendText=enterResult.appendText;const removeText=enterResult.removeText||0;appendText?indentAction===languageConfiguration_1.IndentAction.Indent&&(appendText="\t"+appendText):appendText=indentAction===languageConfiguration_1.IndentAction.Indent||indentAction===languageConfiguration_1.IndentAction.IndentOutdent?"\t":"";let indentation=this.getIndentationAtPosition(model,range.startLineNumber,range.startColumn);return removeText&&(indentation=indentation.substring(0,indentation.length-removeText)),{indentAction,appendText,removeText,indentation}}getIndentationAtPosition(model,lineNumber,column){const lineText=model.getLineContent(lineNumber);let indentation=strings.getLeadingWhitespace(lineText);return indentation.length>column-1&&(indentation=indentation.substring(0,column-1)),indentation}getScopedLineTokens(model,lineNumber,columnNumber){model.forceTokenization(lineNumber);const lineTokens=model.getLineTokens(lineNumber),column=void 0===columnNumber?model.getLineMaxColumn(lineNumber)-1:columnNumber-1;return(0,supports_1.createScopedLineTokens)(lineTokens,column)}}exports.LanguageConfigurationRegistryImpl=LanguageConfigurationRegistryImpl,exports.LanguageConfigurationRegistry=new LanguageConfigurationRegistryImpl;class ComposedLanguageConfiguration{constructor(languageId){this.languageId=languageId,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(configuration,priority){const entry=new LanguageConfigurationContribution(configuration,priority,++this._order);return this._entries.push(entry),this._resolved=null,(0,lifecycle_1.toDisposable)((()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===entry){this._entries.splice(i,1),this._resolved=null;break}}))}getResolvedConfiguration(){if(!this._resolved){const config=this._resolve();config&&(this._resolved=new ResolvedLanguageConfiguration(this.languageId,config))}return this._resolved}_resolve(){return 0===this._entries.length?null:(this._entries.sort(LanguageConfigurationContribution.cmp),combineLanguageConfigurations(this._entries.map((e=>e.configuration))))}}function combineLanguageConfigurations(configs){let result={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const entry of configs)result={comments:entry.comments||result.comments,brackets:entry.brackets||result.brackets,wordPattern:entry.wordPattern||result.wordPattern,indentationRules:entry.indentationRules||result.indentationRules,onEnterRules:entry.onEnterRules||result.onEnterRules,autoClosingPairs:entry.autoClosingPairs||result.autoClosingPairs,surroundingPairs:entry.surroundingPairs||result.surroundingPairs,autoCloseBefore:entry.autoCloseBefore||result.autoCloseBefore,folding:entry.folding||result.folding,colorizedBracketPairs:entry.colorizedBracketPairs||result.colorizedBracketPairs,__electricCharacterSupport:entry.__electricCharacterSupport||result.__electricCharacterSupport};return result}class LanguageConfigurationContribution{constructor(configuration,priority,order){this.configuration=configuration,this.priority=priority,this.order=order}static cmp(a,b){return a.priority===b.priority?a.order-b.order:a.priority-b.priority}}class ResolvedLanguageConfiguration{constructor(languageId,underlyingConfig){this.languageId=languageId,this.underlyingConfig=underlyingConfig,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new onEnter_1.OnEnterSupport(this.underlyingConfig):null,this.comments=ResolvedLanguageConfiguration._handleComments(this.underlyingConfig),this.characterPair=new characterPair_1.CharacterPairSupport(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||wordHelper_1.DEFAULT_WORD_REGEXP,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new indentRules_1.IndentRulesSupport(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{}}getWordDefinition(){return(0,wordHelper_1.ensureValidWordDefinition)(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new richEditBrackets_1.RichEditBrackets(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new electricCharacter_1.BracketElectricCharacterSupport(this.brackets)),this._electricCharacter}onEnter(autoIndent,previousLineText,beforeEnterText,afterEnterText){return this._onEnterSupport?this._onEnterSupport.onEnter(autoIndent,previousLineText,beforeEnterText,afterEnterText):null}getAutoClosingPairs(){return new languageConfiguration_1.AutoClosingPairs(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(){return this.characterPair.getAutoCloseBeforeSet()}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(conf){const commentRule=conf.comments;if(!commentRule)return null;const comments={};if(commentRule.lineComment&&(comments.lineCommentToken=commentRule.lineComment),commentRule.blockComment){const[blockStart,blockEnd]=commentRule.blockComment;comments.blockCommentStartToken=blockStart,comments.blockCommentEndToken=blockEnd}return comments}}exports.ResolvedLanguageConfiguration=ResolvedLanguageConfiguration,(0,extensions_1.registerSingleton)(exports.ILanguageConfigurationService,LanguageConfigurationService)})),define(__m[202],__M([1,0,8,70,3,22,33]),(function(require,exports,strings,cursorColumns_1,range_1,selection_1,languageConfigurationRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShiftCommand=exports.cachedStringRepeat=void 0;const repeatCache=Object.create(null);function cachedStringRepeat(str,count){if(count<=0)return"";repeatCache[str]||(repeatCache[str]=["",str]);const cache=repeatCache[str];for(let i=cache.length;i<=count;i++)cache[i]=cache[i-1]+str;return cache[count]}exports.cachedStringRepeat=cachedStringRepeat;class ShiftCommand{constructor(range,opts){this._opts=opts,this._selection=range,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(line,column,tabSize,indentSize,insertSpaces){const contentStartVisibleColumn=cursorColumns_1.CursorColumns.visibleColumnFromColumn(line,column,tabSize);if(insertSpaces){const indent=cachedStringRepeat(" ",indentSize);return cachedStringRepeat(indent,cursorColumns_1.CursorColumns.prevIndentTabStop(contentStartVisibleColumn,indentSize)/indentSize)}return cachedStringRepeat("\t",cursorColumns_1.CursorColumns.prevRenderTabStop(contentStartVisibleColumn,tabSize)/tabSize)}static shiftIndent(line,column,tabSize,indentSize,insertSpaces){const contentStartVisibleColumn=cursorColumns_1.CursorColumns.visibleColumnFromColumn(line,column,tabSize);if(insertSpaces){const indent=cachedStringRepeat(" ",indentSize);return cachedStringRepeat(indent,cursorColumns_1.CursorColumns.nextIndentTabStop(contentStartVisibleColumn,indentSize)/indentSize)}return cachedStringRepeat("\t",cursorColumns_1.CursorColumns.nextRenderTabStop(contentStartVisibleColumn,tabSize)/tabSize)}_addEditOperation(builder,range,text){this._useLastEditRangeForCursorEndPosition?builder.addTrackedEditOperation(range,text):builder.addEditOperation(range,text)}getEditOperations(model,builder){const startLine=this._selection.startLineNumber;let endLine=this._selection.endLineNumber;1===this._selection.endColumn&&startLine!==endLine&&(endLine-=1);const{tabSize,indentSize,insertSpaces}=this._opts,shouldIndentEmptyLines=startLine===endLine;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(model.getLineContent(startLine))&&(this._useLastEditRangeForCursorEndPosition=!0);let previousLineExtraSpaces=0,extraSpaces=0;for(let lineNumber=startLine;lineNumber<=endLine;lineNumber++,previousLineExtraSpaces=extraSpaces){extraSpaces=0;const lineText=model.getLineContent(lineNumber);let desiredIndent,indentationEndIndex=strings.firstNonWhitespaceIndex(lineText);if((!this._opts.isUnshift||0!==lineText.length&&0!==indentationEndIndex)&&(shouldIndentEmptyLines||this._opts.isUnshift||0!==lineText.length)){if(-1===indentationEndIndex&&(indentationEndIndex=lineText.length),lineNumber>1){if(cursorColumns_1.CursorColumns.visibleColumnFromColumn(lineText,indentationEndIndex+1,tabSize)%indentSize!=0&&model.isCheapToTokenize(lineNumber-1)){const enterAction=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(this._opts.autoIndent,model,new range_1.Range(lineNumber-1,model.getLineMaxColumn(lineNumber-1),lineNumber-1,model.getLineMaxColumn(lineNumber-1)));if(enterAction){if(extraSpaces=previousLineExtraSpaces,enterAction.appendText)for(let j=0,lenJ=enterAction.appendText.length;j<lenJ&&extraSpaces<indentSize&&32===enterAction.appendText.charCodeAt(j);j++)extraSpaces++;enterAction.removeText&&(extraSpaces=Math.max(0,extraSpaces-enterAction.removeText));for(let j=0;j<extraSpaces&&(0!==indentationEndIndex&&32===lineText.charCodeAt(indentationEndIndex-1));j++)indentationEndIndex--}}}this._opts.isUnshift&&0===indentationEndIndex||(desiredIndent=this._opts.isUnshift?ShiftCommand.unshiftIndent(lineText,indentationEndIndex+1,tabSize,indentSize,insertSpaces):ShiftCommand.shiftIndent(lineText,indentationEndIndex+1,tabSize,indentSize,insertSpaces),this._addEditOperation(builder,new range_1.Range(lineNumber,1,lineNumber,indentationEndIndex+1),desiredIndent),lineNumber!==startLine||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn<=indentationEndIndex+1))}}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&0===model.getLineLength(startLine)&&(this._useLastEditRangeForCursorEndPosition=!0);const oneIndent=insertSpaces?cachedStringRepeat(" ",indentSize):"\t";for(let lineNumber=startLine;lineNumber<=endLine;lineNumber++){const lineText=model.getLineContent(lineNumber);let indentationEndIndex=strings.firstNonWhitespaceIndex(lineText);if((!this._opts.isUnshift||0!==lineText.length&&0!==indentationEndIndex)&&((shouldIndentEmptyLines||this._opts.isUnshift||0!==lineText.length)&&(-1===indentationEndIndex&&(indentationEndIndex=lineText.length),!this._opts.isUnshift||0!==indentationEndIndex)))if(this._opts.isUnshift){indentationEndIndex=Math.min(indentationEndIndex,indentSize);for(let i=0;i<indentationEndIndex;i++){if(9===lineText.charCodeAt(i)){indentationEndIndex=i+1;break}}this._addEditOperation(builder,new range_1.Range(lineNumber,1,lineNumber,indentationEndIndex+1),"")}else this._addEditOperation(builder,new range_1.Range(lineNumber,1,lineNumber,1),oneIndent),lineNumber!==startLine||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=1===this._selection.startColumn)}}this._selectionId=builder.trackSelection(this._selection)}computeCursorState(model,helper){if(this._useLastEditRangeForCursorEndPosition){const lastOp=helper.getInverseEditOperations()[0];return new selection_1.Selection(lastOp.range.endLineNumber,lastOp.range.endColumn,lastOp.range.endLineNumber,lastOp.range.endColumn)}const result=helper.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const initialStartColumn=this._selection.startColumn;return result.startColumn<=initialStartColumn?result:0===result.getDirection()?new selection_1.Selection(result.startLineNumber,initialStartColumn,result.endLineNumber,result.endColumn):new selection_1.Selection(result.endLineNumber,result.endColumn,result.startLineNumber,initialStartColumn)}return result}}exports.ShiftCommand=ShiftCommand})),define(__m[203],__M([1,0,13,8,100,202,406,61,120,3,22,11,122,33,123]),(function(require,exports,errors_1,strings,replaceCommand_1,shiftCommand_1,surroundSelectionCommand_1,cursorCommon_1,wordCharacterClassifier_1,range_1,selection_1,position_1,languageConfiguration_1,languageConfigurationRegistry_1,supports_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeWithAutoClosingCommand=exports.TypeOperations=void 0;class TypeOperations{static indent(config,model,selections){if(null===model||null===selections)return[];const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new shiftCommand_1.ShiftCommand(selections[i],{isUnshift:!1,tabSize:config.tabSize,indentSize:config.indentSize,insertSpaces:config.insertSpaces,useTabStops:config.useTabStops,autoIndent:config.autoIndent});return commands}static outdent(config,model,selections){const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new shiftCommand_1.ShiftCommand(selections[i],{isUnshift:!0,tabSize:config.tabSize,indentSize:config.indentSize,insertSpaces:config.insertSpaces,useTabStops:config.useTabStops,autoIndent:config.autoIndent});return commands}static shiftIndent(config,indentation,count){return count=count||1,shiftCommand_1.ShiftCommand.shiftIndent(indentation,indentation.length+count,config.tabSize,config.indentSize,config.insertSpaces)}static unshiftIndent(config,indentation,count){return count=count||1,shiftCommand_1.ShiftCommand.unshiftIndent(indentation,indentation.length+count,config.tabSize,config.indentSize,config.insertSpaces)}static _distributedPaste(config,model,selections,text){const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new replaceCommand_1.ReplaceCommand(selections[i],text[i]);return new cursorCommon_1.EditOperationResult(0,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(config,model,selections,text,pasteOnNewLine){const commands=[];for(let i=0,len=selections.length;i<len;i++){const selection=selections[i],position=selection.getPosition();if(pasteOnNewLine&&!selection.isEmpty()&&(pasteOnNewLine=!1),pasteOnNewLine&&text.indexOf("\n")!==text.length-1&&(pasteOnNewLine=!1),pasteOnNewLine){const typeSelection=new range_1.Range(position.lineNumber,1,position.lineNumber,1);commands[i]=new replaceCommand_1.ReplaceCommandThatPreservesSelection(typeSelection,text,selection,!0)}else commands[i]=new replaceCommand_1.ReplaceCommand(selection,text)}return new cursorCommon_1.EditOperationResult(0,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(config,selections,text,pasteOnNewLine,multicursorText){if(pasteOnNewLine)return null;if(1===selections.length)return null;if(multicursorText&&multicursorText.length===selections.length)return multicursorText;if("spread"===config.multiCursorPaste){10===text.charCodeAt(text.length-1)&&(text=text.substr(0,text.length-1)),13===text.charCodeAt(text.length-1)&&(text=text.substr(0,text.length-1));const lines=strings.splitLines(text);if(lines.length===selections.length)return lines}return null}static paste(config,model,selections,text,pasteOnNewLine,multicursorText){const distributedPaste=this._distributePasteToCursors(config,selections,text,pasteOnNewLine,multicursorText);return distributedPaste?(selections=selections.sort(range_1.Range.compareRangesUsingStarts),this._distributedPaste(config,model,selections,distributedPaste)):this._simplePaste(config,model,selections,text,pasteOnNewLine)}static _goodIndentForLine(config,model,lineNumber){let action=null,indentation="";const expectedIndentAction=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getInheritIndentForLine(config.autoIndent,model,lineNumber,!1);if(expectedIndentAction)action=expectedIndentAction.action,indentation=expectedIndentAction.indentation;else if(lineNumber>1){let lastLineNumber;for(lastLineNumber=lineNumber-1;lastLineNumber>=1;lastLineNumber--){const lineText=model.getLineContent(lastLineNumber);if(strings.lastNonWhitespaceIndex(lineText)>=0)break}if(lastLineNumber<1)return null;const maxColumn=model.getLineMaxColumn(lastLineNumber),expectedEnterAction=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(config.autoIndent,model,new range_1.Range(lastLineNumber,maxColumn,lastLineNumber,maxColumn));expectedEnterAction&&(indentation=expectedEnterAction.indentation+expectedEnterAction.appendText)}return action&&(action===languageConfiguration_1.IndentAction.Indent&&(indentation=TypeOperations.shiftIndent(config,indentation)),action===languageConfiguration_1.IndentAction.Outdent&&(indentation=TypeOperations.unshiftIndent(config,indentation)),indentation=config.normalizeIndentation(indentation)),indentation||null}static _replaceJumpToNextIndent(config,model,selection,insertsAutoWhitespace){let typeText="";const position=selection.getStartPosition();if(config.insertSpaces){const visibleColumnFromColumn=config.visibleColumnFromColumn(model,position),indentSize=config.indentSize,spacesCnt=indentSize-visibleColumnFromColumn%indentSize;for(let i=0;i<spacesCnt;i++)typeText+=" "}else typeText="\t";return new replaceCommand_1.ReplaceCommand(selection,typeText,insertsAutoWhitespace)}static tab(config,model,selections){const commands=[];for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];if(selection.isEmpty()){const lineText=model.getLineContent(selection.startLineNumber);if(/^\s*$/.test(lineText)&&model.isCheapToTokenize(selection.startLineNumber)){let goodIndent=this._goodIndentForLine(config,model,selection.startLineNumber);goodIndent=goodIndent||"\t";const possibleTypeText=config.normalizeIndentation(goodIndent);if(!lineText.startsWith(possibleTypeText)){commands[i]=new replaceCommand_1.ReplaceCommand(new range_1.Range(selection.startLineNumber,1,selection.startLineNumber,lineText.length+1),possibleTypeText,!0);continue}}commands[i]=this._replaceJumpToNextIndent(config,model,selection,!0)}else{if(selection.startLineNumber===selection.endLineNumber){const lineMaxColumn=model.getLineMaxColumn(selection.startLineNumber);if(1!==selection.startColumn||selection.endColumn!==lineMaxColumn){commands[i]=this._replaceJumpToNextIndent(config,model,selection,!1);continue}}commands[i]=new shiftCommand_1.ShiftCommand(selection,{isUnshift:!1,tabSize:config.tabSize,indentSize:config.indentSize,insertSpaces:config.insertSpaces,useTabStops:config.useTabStops,autoIndent:config.autoIndent})}}return commands}static compositionType(prevEditOperationType,config,model,selections,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta){const commands=selections.map((selection=>this._compositionType(model,selection,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta)));return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:shouldPushStackElementBetween(prevEditOperationType,4),shouldPushStackElementAfter:!1})}static _compositionType(model,selection,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta){if(!selection.isEmpty())return null;const pos=selection.getPosition(),startColumn=Math.max(1,pos.column-replacePrevCharCnt),endColumn=Math.min(model.getLineMaxColumn(pos.lineNumber),pos.column+replaceNextCharCnt),range=new range_1.Range(pos.lineNumber,startColumn,pos.lineNumber,endColumn);return model.getValueInRange(range)===text&&0===positionDelta?null:new replaceCommand_1.ReplaceCommandWithOffsetCursorState(range,text,0,positionDelta)}static _typeCommand(range,text,keepPosition){return keepPosition?new replaceCommand_1.ReplaceCommandWithoutChangingPosition(range,text,!0):new replaceCommand_1.ReplaceCommand(range,text,!0)}static _enter(config,model,keepPosition,range){if(0===config.autoIndent)return TypeOperations._typeCommand(range,"\n",keepPosition);if(!model.isCheapToTokenize(range.getStartPosition().lineNumber)||1===config.autoIndent){const lineText=model.getLineContent(range.startLineNumber),indentation=strings.getLeadingWhitespace(lineText).substring(0,range.startColumn-1);return TypeOperations._typeCommand(range,"\n"+config.normalizeIndentation(indentation),keepPosition)}const r=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(config.autoIndent,model,range);if(r){if(r.indentAction===languageConfiguration_1.IndentAction.None)return TypeOperations._typeCommand(range,"\n"+config.normalizeIndentation(r.indentation+r.appendText),keepPosition);if(r.indentAction===languageConfiguration_1.IndentAction.Indent)return TypeOperations._typeCommand(range,"\n"+config.normalizeIndentation(r.indentation+r.appendText),keepPosition);if(r.indentAction===languageConfiguration_1.IndentAction.IndentOutdent){const normalIndent=config.normalizeIndentation(r.indentation),increasedIndent=config.normalizeIndentation(r.indentation+r.appendText),typeText="\n"+increasedIndent+"\n"+normalIndent;return keepPosition?new replaceCommand_1.ReplaceCommandWithoutChangingPosition(range,typeText,!0):new replaceCommand_1.ReplaceCommandWithOffsetCursorState(range,typeText,-1,increasedIndent.length-normalIndent.length,!0)}if(r.indentAction===languageConfiguration_1.IndentAction.Outdent){const actualIndentation=TypeOperations.unshiftIndent(config,r.indentation);return TypeOperations._typeCommand(range,"\n"+config.normalizeIndentation(actualIndentation+r.appendText),keepPosition)}}const lineText=model.getLineContent(range.startLineNumber),indentation=strings.getLeadingWhitespace(lineText).substring(0,range.startColumn-1);if(config.autoIndent>=4){const ir=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentForEnter(config.autoIndent,model,range,{unshiftIndent:indent=>TypeOperations.unshiftIndent(config,indent),shiftIndent:indent=>TypeOperations.shiftIndent(config,indent),normalizeIndentation:indent=>config.normalizeIndentation(indent)});if(ir){let oldEndViewColumn=config.visibleColumnFromColumn(model,range.getEndPosition());const oldEndColumn=range.endColumn,newLineContent=model.getLineContent(range.endLineNumber),firstNonWhitespace=strings.firstNonWhitespaceIndex(newLineContent);if(range=firstNonWhitespace>=0?range.setEndPosition(range.endLineNumber,Math.max(range.endColumn,firstNonWhitespace+1)):range.setEndPosition(range.endLineNumber,model.getLineMaxColumn(range.endLineNumber)),keepPosition)return new replaceCommand_1.ReplaceCommandWithoutChangingPosition(range,"\n"+config.normalizeIndentation(ir.afterEnter),!0);{let offset=0;return oldEndColumn<=firstNonWhitespace+1&&(config.insertSpaces||(oldEndViewColumn=Math.ceil(oldEndViewColumn/config.indentSize)),offset=Math.min(oldEndViewColumn+1-config.normalizeIndentation(ir.afterEnter).length-1,0)),new replaceCommand_1.ReplaceCommandWithOffsetCursorState(range,"\n"+config.normalizeIndentation(ir.afterEnter),0,offset,!0)}}}return TypeOperations._typeCommand(range,"\n"+config.normalizeIndentation(indentation),keepPosition)}static _isAutoIndentType(config,model,selections){if(config.autoIndent<4)return!1;for(let i=0,len=selections.length;i<len;i++)if(!model.isCheapToTokenize(selections[i].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(config,model,range,ch){const currentIndentation=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentationAtPosition(model,range.startLineNumber,range.startColumn),actualIndentation=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentActionForType(config.autoIndent,model,range,ch,{shiftIndent:indentation=>TypeOperations.shiftIndent(config,indentation),unshiftIndent:indentation=>TypeOperations.unshiftIndent(config,indentation)});if(null===actualIndentation)return null;if(actualIndentation!==config.normalizeIndentation(currentIndentation)){const firstNonWhitespace=model.getLineFirstNonWhitespaceColumn(range.startLineNumber);return 0===firstNonWhitespace?TypeOperations._typeCommand(new range_1.Range(range.startLineNumber,1,range.endLineNumber,range.endColumn),config.normalizeIndentation(actualIndentation)+ch,!1):TypeOperations._typeCommand(new range_1.Range(range.startLineNumber,1,range.endLineNumber,range.endColumn),config.normalizeIndentation(actualIndentation)+model.getLineContent(range.startLineNumber).substring(firstNonWhitespace-1,range.startColumn-1)+ch,!1)}return null}static _isAutoClosingOvertype(config,model,selections,autoClosedCharacters,ch){if("never"===config.autoClosingOvertype)return!1;if(!config.autoClosingPairs.autoClosingPairsCloseSingleChar.has(ch))return!1;for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];if(!selection.isEmpty())return!1;const position=selection.getPosition(),lineText=model.getLineContent(position.lineNumber);if(lineText.charAt(position.column-1)!==ch)return!1;const chIsQuote=(0,cursorCommon_1.isQuote)(ch);if(92===(position.column>2?lineText.charCodeAt(position.column-2):0)&&chIsQuote)return!1;if("auto"===config.autoClosingOvertype){let found=!1;for(let j=0,lenJ=autoClosedCharacters.length;j<lenJ;j++){const autoClosedCharacter=autoClosedCharacters[j];if(position.lineNumber===autoClosedCharacter.startLineNumber&&position.column===autoClosedCharacter.startColumn){found=!0;break}}if(!found)return!1}}return!0}static _runAutoClosingOvertype(prevEditOperationType,config,model,selections,ch){const commands=[];for(let i=0,len=selections.length;i<len;i++){const position=selections[i].getPosition(),typeSelection=new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column+1);commands[i]=new replaceCommand_1.ReplaceCommand(typeSelection,ch)}return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:shouldPushStackElementBetween(prevEditOperationType,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(config,lineAfter){const nextChar=lineAfter.charAt(0),potentialStartingBraces=config.autoClosingPairs.autoClosingPairsOpenByStart.get(nextChar)||[],potentialClosingBraces=config.autoClosingPairs.autoClosingPairsCloseByStart.get(nextChar)||[],isBeforeStartingBrace=potentialStartingBraces.some((x=>lineAfter.startsWith(x.open))),isBeforeClosingBrace=potentialClosingBraces.some((x=>lineAfter.startsWith(x.close)));return!isBeforeStartingBrace&&isBeforeClosingBrace}static _findAutoClosingPairOpen(config,model,positions,ch){const candidates=config.autoClosingPairs.autoClosingPairsOpenByEnd.get(ch);if(!candidates)return null;let result=null;for(const candidate of candidates)if(null===result||candidate.open.length>result.open.length){let candidateIsMatch=!0;for(const position of positions){if(model.getValueInRange(new range_1.Range(position.lineNumber,position.column-candidate.open.length+1,position.lineNumber,position.column))+ch!==candidate.open){candidateIsMatch=!1;break}}candidateIsMatch&&(result=candidate)}return result}static _findContainedAutoClosingPair(config,pair){if(pair.open.length<=1)return null;const lastChar=pair.close.charAt(pair.close.length-1),candidates=config.autoClosingPairs.autoClosingPairsCloseByEnd.get(lastChar)||[];let result=null;for(const candidate of candidates)candidate.open!==pair.open&&pair.open.includes(candidate.open)&&pair.close.endsWith(candidate.close)&&(!result||candidate.open.length>result.open.length)&&(result=candidate);return result}static _getAutoClosingPairClose(config,model,selections,ch,chIsAlreadyTyped){const chIsQuote=(0,cursorCommon_1.isQuote)(ch),autoCloseConfig=chIsQuote?config.autoClosingQuotes:config.autoClosingBrackets,shouldAutoCloseBefore=chIsQuote?config.shouldAutoCloseBefore.quote:config.shouldAutoCloseBefore.bracket;if("never"===autoCloseConfig)return null;for(const selection of selections)if(!selection.isEmpty())return null;const positions=selections.map((s=>{const position=s.getPosition();return chIsAlreadyTyped?{lineNumber:position.lineNumber,beforeColumn:position.column-ch.length,afterColumn:position.column}:{lineNumber:position.lineNumber,beforeColumn:position.column,afterColumn:position.column}})),pair=this._findAutoClosingPairOpen(config,model,positions.map((p=>new position_1.Position(p.lineNumber,p.beforeColumn))),ch);if(!pair)return null;const containedPair=this._findContainedAutoClosingPair(config,pair),containedPairClose=containedPair?containedPair.close:"";let isContainedPairPresent=!0;for(const position of positions){const{lineNumber,beforeColumn,afterColumn}=position,lineText=model.getLineContent(lineNumber),lineBefore=lineText.substring(0,beforeColumn-1),lineAfter=lineText.substring(afterColumn-1);if(lineAfter.startsWith(containedPairClose)||(isContainedPairPresent=!1),lineAfter.length>0){const characterAfter=lineAfter.charAt(0);if(!TypeOperations._isBeforeClosingBrace(config,lineAfter)&&!shouldAutoCloseBefore(characterAfter))return null}if(1===pair.open.length&&("'"===ch||'"'===ch)&&"always"!==autoCloseConfig){const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(config.wordSeparators);if(lineBefore.length>0){const characterBefore=lineBefore.charCodeAt(lineBefore.length-1);if(0===wordSeparators.get(characterBefore))return null}}if(!model.isCheapToTokenize(lineNumber))return null;model.forceTokenization(lineNumber);const lineTokens=model.getLineTokens(lineNumber),scopedLineTokens=(0,supports_1.createScopedLineTokens)(lineTokens,beforeColumn-1);if(!pair.shouldAutoClose(scopedLineTokens,beforeColumn-scopedLineTokens.firstCharOffset))return null;const neutralCharacter=pair.findNeutralCharacter();if(neutralCharacter){const tokenType=model.getTokenTypeIfInsertingCharacter(lineNumber,beforeColumn,neutralCharacter);if(!pair.isOK(tokenType))return null}}return isContainedPairPresent?pair.close.substring(0,pair.close.length-containedPairClose.length):pair.close}static _runAutoClosingOpenCharType(prevEditOperationType,config,model,selections,ch,chIsAlreadyTyped,autoClosingPairClose){const commands=[];for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];commands[i]=new TypeWithAutoClosingCommand(selection,ch,!chIsAlreadyTyped,autoClosingPairClose)}return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(config,ch){return(0,cursorCommon_1.isQuote)(ch)?"quotes"===config.autoSurround||"languageDefined"===config.autoSurround:"brackets"===config.autoSurround||"languageDefined"===config.autoSurround}static _isSurroundSelectionType(config,model,selections,ch){if(!TypeOperations._shouldSurroundChar(config,ch)||!config.surroundingPairs.hasOwnProperty(ch))return!1;const isTypingAQuoteCharacter=(0,cursorCommon_1.isQuote)(ch);for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];if(selection.isEmpty())return!1;let selectionContainsOnlyWhitespace=!0;for(let lineNumber=selection.startLineNumber;lineNumber<=selection.endLineNumber;lineNumber++){const lineText=model.getLineContent(lineNumber),startIndex=lineNumber===selection.startLineNumber?selection.startColumn-1:0,endIndex=lineNumber===selection.endLineNumber?selection.endColumn-1:lineText.length,selectedText=lineText.substring(startIndex,endIndex);if(/[^ \t]/.test(selectedText)){selectionContainsOnlyWhitespace=!1;break}}if(selectionContainsOnlyWhitespace)return!1;if(isTypingAQuoteCharacter&&selection.startLineNumber===selection.endLineNumber&&selection.startColumn+1===selection.endColumn){const selectionText=model.getValueInRange(selection);if((0,cursorCommon_1.isQuote)(selectionText))return!1}}return!0}static _runSurroundSelectionType(prevEditOperationType,config,model,selections,ch){const commands=[];for(let i=0,len=selections.length;i<len;i++){const selection=selections[i],closeCharacter=config.surroundingPairs[ch];commands[i]=new surroundSelectionCommand_1.SurroundSelectionCommand(selection,ch,closeCharacter)}return new cursorCommon_1.EditOperationResult(0,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(config,model,selections){return!(1!==selections.length||!model.isCheapToTokenize(selections[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(prevEditOperationType,config,model,selection,ch){if(!config.electricChars.hasOwnProperty(ch)||!selection.isEmpty())return null;const position=selection.getPosition();model.forceTokenization(position.lineNumber);const lineTokens=model.getLineTokens(position.lineNumber);let electricAction;try{electricAction=config.onElectricCharacter(ch,lineTokens,position.column)}catch(e){return(0,errors_1.onUnexpectedError)(e),null}if(!electricAction)return null;if(electricAction.matchOpenBracket){const endColumn=(lineTokens.getLineContent()+ch).lastIndexOf(electricAction.matchOpenBracket)+1,match=model.bracketPairs.findMatchingBracketUp(electricAction.matchOpenBracket,{lineNumber:position.lineNumber,column:endColumn},500);if(match){if(match.startLineNumber===position.lineNumber)return null;const matchLine=model.getLineContent(match.startLineNumber),matchLineIndentation=strings.getLeadingWhitespace(matchLine),newIndentation=config.normalizeIndentation(matchLineIndentation),lineText=model.getLineContent(position.lineNumber),lineFirstNonBlankColumn=model.getLineFirstNonWhitespaceColumn(position.lineNumber)||position.column,typeText=newIndentation+lineText.substring(lineFirstNonBlankColumn-1,position.column-1)+ch,typeSelection=new range_1.Range(position.lineNumber,1,position.lineNumber,position.column),command=new replaceCommand_1.ReplaceCommand(typeSelection,typeText);return new cursorCommon_1.EditOperationResult(getTypingOperation(typeText,prevEditOperationType),[command],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(prevEditOperationType,config,model,selectionsWhenCompositionStarted,selections,autoClosedCharacters){if(!selectionsWhenCompositionStarted||selection_1.Selection.selectionsArrEqual(selectionsWhenCompositionStarted,selections))return null;let ch=null;for(const selection of selections){if(!selection.isEmpty())return null;const position=selection.getPosition(),currentChar=model.getValueInRange(new range_1.Range(position.lineNumber,position.column-1,position.lineNumber,position.column));if(null===ch)ch=currentChar;else if(ch!==currentChar)return null}if(!ch)return null;if(this._isAutoClosingOvertype(config,model,selections,autoClosedCharacters,ch)){const commands=selections.map((s=>new replaceCommand_1.ReplaceCommand(new range_1.Range(s.positionLineNumber,s.positionColumn,s.positionLineNumber,s.positionColumn+1),"",!1)));return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const autoClosingPairClose=this._getAutoClosingPairClose(config,model,selections,ch,!0);return null!==autoClosingPairClose?this._runAutoClosingOpenCharType(prevEditOperationType,config,model,selections,ch,!0,autoClosingPairClose):null}static typeWithInterceptors(isDoingComposition,prevEditOperationType,config,model,selections,autoClosedCharacters,ch){if(!isDoingComposition&&"\n"===ch){const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=TypeOperations._enter(config,model,!1,selections[i]);return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!isDoingComposition&&this._isAutoIndentType(config,model,selections)){const commands=[];let autoIndentFails=!1;for(let i=0,len=selections.length;i<len;i++)if(commands[i]=this._runAutoIndentType(config,model,selections[i],ch),!commands[i]){autoIndentFails=!0;break}if(!autoIndentFails)return new cursorCommon_1.EditOperationResult(4,commands,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!isDoingComposition&&this._isAutoClosingOvertype(config,model,selections,autoClosedCharacters,ch))return this._runAutoClosingOvertype(prevEditOperationType,config,model,selections,ch);if(!isDoingComposition){const autoClosingPairClose=this._getAutoClosingPairClose(config,model,selections,ch,!1);if(autoClosingPairClose)return this._runAutoClosingOpenCharType(prevEditOperationType,config,model,selections,ch,!1,autoClosingPairClose)}if(this._isSurroundSelectionType(config,model,selections,ch))return this._runSurroundSelectionType(prevEditOperationType,config,model,selections,ch);if(!isDoingComposition&&this._isTypeInterceptorElectricChar(config,model,selections)){const r=this._typeInterceptorElectricChar(prevEditOperationType,config,model,selections[0],ch);if(r)return r}const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new replaceCommand_1.ReplaceCommand(selections[i],ch);const opType=getTypingOperation(ch,prevEditOperationType);return new cursorCommon_1.EditOperationResult(opType,commands,{shouldPushStackElementBefore:shouldPushStackElementBetween(prevEditOperationType,opType),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(prevEditOperationType,config,model,selections,str){const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new replaceCommand_1.ReplaceCommand(selections[i],str);const opType=getTypingOperation(str,prevEditOperationType);return new cursorCommon_1.EditOperationResult(opType,commands,{shouldPushStackElementBefore:shouldPushStackElementBetween(prevEditOperationType,opType),shouldPushStackElementAfter:!1})}static lineInsertBefore(config,model,selections){if(null===model||null===selections)return[];const commands=[];for(let i=0,len=selections.length;i<len;i++){let lineNumber=selections[i].positionLineNumber;if(1===lineNumber)commands[i]=new replaceCommand_1.ReplaceCommandWithoutChangingPosition(new range_1.Range(1,1,1,1),"\n");else{lineNumber--;const column=model.getLineMaxColumn(lineNumber);commands[i]=this._enter(config,model,!1,new range_1.Range(lineNumber,column,lineNumber,column))}}return commands}static lineInsertAfter(config,model,selections){if(null===model||null===selections)return[];const commands=[];for(let i=0,len=selections.length;i<len;i++){const lineNumber=selections[i].positionLineNumber,column=model.getLineMaxColumn(lineNumber);commands[i]=this._enter(config,model,!1,new range_1.Range(lineNumber,column,lineNumber,column))}return commands}static lineBreakInsert(config,model,selections){const commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=this._enter(config,model,!0,selections[i]);return commands}}exports.TypeOperations=TypeOperations;class TypeWithAutoClosingCommand extends replaceCommand_1.ReplaceCommandWithOffsetCursorState{constructor(selection,openCharacter,insertOpenCharacter,closeCharacter){super(selection,(insertOpenCharacter?openCharacter:"")+closeCharacter,0,-closeCharacter.length),this._openCharacter=openCharacter,this._closeCharacter=closeCharacter,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(model,helper){const range=helper.getInverseEditOperations()[0].range;return this.closeCharacterRange=new range_1.Range(range.startLineNumber,range.endColumn-this._closeCharacter.length,range.endLineNumber,range.endColumn),this.enclosingRange=new range_1.Range(range.startLineNumber,range.endColumn-this._openCharacter.length-this._closeCharacter.length,range.endLineNumber,range.endColumn),super.computeCursorState(model,helper)}}function getTypingOperation(typedText,previousTypingOperation){return" "===typedText?5===previousTypingOperation||6===previousTypingOperation?6:5:4}function shouldPushStackElementBetween(previousTypingOperation,typingOperation){return!(!isTypingOperation(previousTypingOperation)||isTypingOperation(typingOperation))||5!==previousTypingOperation&&normalizeOperationType(previousTypingOperation)!==normalizeOperationType(typingOperation)}function normalizeOperationType(type){return 6===type||5===type?"space":type}function isTypingOperation(type){return 4===type||5===type||6===type}exports.TypeWithAutoClosingCommand=TypeWithAutoClosingCommand})),define(__m[277],__M([1,0,13,8,414,61,407,181,203,3,22,94,189,2,190]),(function(require,exports,errors_1,strings,cursorCollection_1,cursorCommon_1,cursorContext_1,cursorDeleteOperations_1,cursorTypeOperations_1,range_1,selection_1,textModelEvents_1,viewEvents_1,lifecycle_1,viewModelEventDispatcher_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorsController=void 0;class CursorsController extends lifecycle_1.Disposable{constructor(model,viewModel,coordinatesConverter,cursorConfig){super(),this._model=model,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=viewModel,this._coordinatesConverter=coordinatesConverter,this.context=new cursorContext_1.CursorContext(this._model,this._viewModel,this._coordinatesConverter,cursorConfig),this._cursors=new cursorCollection_1.CursorCollection(this.context),this._hasFocus=!1,this._isHandling=!1,this._isDoingComposition=!1,this._selectionsWhenCompositionStarted=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=(0,lifecycle_1.dispose)(this._autoClosedActions),super.dispose()}updateConfiguration(cursorConfig){this.context=new cursorContext_1.CursorContext(this._model,this._viewModel,this._coordinatesConverter,cursorConfig),this._cursors.updateContext(this.context)}onLineMappingChanged(eventsCollector){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(eventsCollector,"viewModel",0,this.getCursorStates())}setHasFocus(hasFocus){this._hasFocus=hasFocus}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const selections=this._cursors.getSelections();for(let i=0;i<this._autoClosedActions.length;i++){const autoClosedAction=this._autoClosedActions[i];autoClosedAction.isValid(selections)||(autoClosedAction.dispose(),this._autoClosedActions.splice(i,1),i--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(eventsCollector,source,reason,states){let reachedMaxCursorCount=!1;null!==states&&states.length>CursorsController.MAX_CURSOR_COUNT&&(states=states.slice(0,CursorsController.MAX_CURSOR_COUNT),reachedMaxCursorCount=!0);const oldState=CursorModelState.from(this._model,this);return this._cursors.setStates(states),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(eventsCollector,source,reason,oldState,reachedMaxCursorCount)}setCursorColumnSelectData(columnSelectData){this._columnSelectData=columnSelectData}revealPrimary(eventsCollector,source,minimalReveal,verticalType,revealHorizontal,scrollType){const viewPositions=this._cursors.getViewPositions();let revealViewRange=null,revealViewSelections=null;viewPositions.length>1?revealViewSelections=this._cursors.getViewSelections():revealViewRange=range_1.Range.fromPositions(viewPositions[0],viewPositions[0]),eventsCollector.emitViewEvent(new viewEvents_1.ViewRevealRangeRequestEvent(source,minimalReveal,revealViewRange,revealViewSelections,verticalType,revealHorizontal,scrollType))}saveState(){const result=[],selections=this._cursors.getSelections();for(let i=0,len=selections.length;i<len;i++){const selection=selections[i];result.push({inSelectionMode:!selection.isEmpty(),selectionStart:{lineNumber:selection.selectionStartLineNumber,column:selection.selectionStartColumn},position:{lineNumber:selection.positionLineNumber,column:selection.positionColumn}})}return result}restoreState(eventsCollector,states){const desiredSelections=[];for(let i=0,len=states.length;i<len;i++){const state=states[i];let positionLineNumber=1,positionColumn=1;state.position&&state.position.lineNumber&&(positionLineNumber=state.position.lineNumber),state.position&&state.position.column&&(positionColumn=state.position.column);let selectionStartLineNumber=positionLineNumber,selectionStartColumn=positionColumn;state.selectionStart&&state.selectionStart.lineNumber&&(selectionStartLineNumber=state.selectionStart.lineNumber),state.selectionStart&&state.selectionStart.column&&(selectionStartColumn=state.selectionStart.column),desiredSelections.push({selectionStartLineNumber,selectionStartColumn,positionLineNumber,positionColumn})}this.setStates(eventsCollector,"restoreState",0,cursorCommon_1.CursorState.fromModelSelections(desiredSelections)),this.revealPrimary(eventsCollector,"restoreState",!1,0,!0,1)}onModelContentChanged(eventsCollector,e){if(e instanceof textModelEvents_1.ModelInjectedTextChangedEvent){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(eventsCollector,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{if(this._knownModelVersionId=e.versionId,this._isHandling)return;const hadFlushEvent=e.containsEvent(1);if(this._prevEditOperationType=0,hadFlushEvent)this._cursors.dispose(),this._cursors=new cursorCollection_1.CursorCollection(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(eventsCollector,"model",1,null,!1);else if(this._hasFocus&&e.resultingSelection&&e.resultingSelection.length>0){const cursorState=cursorCommon_1.CursorState.fromModelSelections(e.resultingSelection);this.setStates(eventsCollector,"modelChange",e.isUndoing?5:e.isRedoing?6:2,cursorState)&&this.revealPrimary(eventsCollector,"modelChange",!1,0,!0,0)}else{const selectionsFromMarkers=this._cursors.readSelectionFromMarkers();this.setStates(eventsCollector,"modelChange",2,cursorCommon_1.CursorState.fromModelSelections(selectionsFromMarkers))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const primaryCursor=this._cursors.getPrimaryCursor(),viewSelectionStart=primaryCursor.viewState.selectionStart.getStartPosition(),viewPosition=primaryCursor.viewState.position;return{isReal:!1,fromViewLineNumber:viewSelectionStart.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,viewSelectionStart),toViewLineNumber:viewPosition.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,viewPosition)}}getSelections(){return this._cursors.getSelections()}setSelections(eventsCollector,source,selections,reason){this.setStates(eventsCollector,source,reason,cursorCommon_1.CursorState.fromModelSelections(selections))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(type){this._prevEditOperationType=type}_pushAutoClosedAction(autoClosedCharactersRanges,autoClosedEnclosingRanges){const autoClosedCharactersDeltaDecorations=[],autoClosedEnclosingDeltaDecorations=[];for(let i=0,len=autoClosedCharactersRanges.length;i<len;i++)autoClosedCharactersDeltaDecorations.push({range:autoClosedCharactersRanges[i],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),autoClosedEnclosingDeltaDecorations.push({range:autoClosedEnclosingRanges[i],options:{description:"auto-closed-enclosing",stickiness:1}});const autoClosedCharactersDecorations=this._model.deltaDecorations([],autoClosedCharactersDeltaDecorations),autoClosedEnclosingDecorations=this._model.deltaDecorations([],autoClosedEnclosingDeltaDecorations);this._autoClosedActions.push(new AutoClosedAction(this._model,autoClosedCharactersDecorations,autoClosedEnclosingDecorations))}_executeEditOperation(opResult){if(!opResult)return;opResult.shouldPushStackElementBefore&&this._model.pushStackElement();const result=class CommandExecutor{static executeCommands(model,selectionsBefore,commands){const ctx={model,selectionsBefore,trackedRanges:[],trackedRangesDirection:[]},result=this._innerExecuteCommands(ctx,commands);for(let i=0,len=ctx.trackedRanges.length;i<len;i++)ctx.model._setTrackedRange(ctx.trackedRanges[i],null,0);return result}static _innerExecuteCommands(ctx,commands){if(this._arrayIsEmpty(commands))return null;const commandsData=this._getEditOperations(ctx,commands);if(0===commandsData.operations.length)return null;const rawOperations=commandsData.operations,loserCursorsMap=this._getLoserCursorMap(rawOperations);if(loserCursorsMap.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const filteredOperations=[];for(let i=0,len=rawOperations.length;i<len;i++)loserCursorsMap.hasOwnProperty(rawOperations[i].identifier.major.toString())||filteredOperations.push(rawOperations[i]);commandsData.hadTrackedEditOperation&&filteredOperations.length>0&&(filteredOperations[0]._isTracked=!0);let selectionsAfter=ctx.model.pushEditOperations(ctx.selectionsBefore,filteredOperations,(inverseEditOperations=>{const groupedInverseEditOperations=[];for(let i=0;i<ctx.selectionsBefore.length;i++)groupedInverseEditOperations[i]=[];for(const op of inverseEditOperations)op.identifier&&groupedInverseEditOperations[op.identifier.major].push(op);const minorBasedSorter=(a,b)=>a.identifier.minor-b.identifier.minor,cursorSelections=[];for(let i=0;i<ctx.selectionsBefore.length;i++)groupedInverseEditOperations[i].length>0?(groupedInverseEditOperations[i].sort(minorBasedSorter),cursorSelections[i]=commands[i].computeCursorState(ctx.model,{getInverseEditOperations:()=>groupedInverseEditOperations[i],getTrackedSelection:id=>{const idx=parseInt(id,10),range=ctx.model._getTrackedRange(ctx.trackedRanges[idx]);return 0===ctx.trackedRangesDirection[idx]?new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn):new selection_1.Selection(range.endLineNumber,range.endColumn,range.startLineNumber,range.startColumn)}})):cursorSelections[i]=ctx.selectionsBefore[i];return cursorSelections}));selectionsAfter||(selectionsAfter=ctx.selectionsBefore);const losingCursors=[];for(let losingCursorIndex in loserCursorsMap)loserCursorsMap.hasOwnProperty(losingCursorIndex)&&losingCursors.push(parseInt(losingCursorIndex,10));losingCursors.sort(((a,b)=>b-a));for(const losingCursor of losingCursors)selectionsAfter.splice(losingCursor,1);return selectionsAfter}static _arrayIsEmpty(commands){for(let i=0,len=commands.length;i<len;i++)if(commands[i])return!1;return!0}static _getEditOperations(ctx,commands){let operations=[],hadTrackedEditOperation=!1;for(let i=0,len=commands.length;i<len;i++){const command=commands[i];if(command){const r=this._getEditOperationsFromCommand(ctx,i,command);operations=operations.concat(r.operations),hadTrackedEditOperation=hadTrackedEditOperation||r.hadTrackedEditOperation}}return{operations,hadTrackedEditOperation}}static _getEditOperationsFromCommand(ctx,majorIdentifier,command){const operations=[];let operationMinor=0;const addEditOperation=(range,text,forceMoveMarkers=!1)=>{range_1.Range.isEmpty(range)&&""===text||operations.push({identifier:{major:majorIdentifier,minor:operationMinor++},range,text,forceMoveMarkers,isAutoWhitespaceEdit:command.insertsAutoWhitespace})};let hadTrackedEditOperation=!1;const addTrackedEditOperation=(selection,text,forceMoveMarkers)=>{hadTrackedEditOperation=!0,addEditOperation(selection,text,forceMoveMarkers)},editOperationBuilder={addEditOperation,addTrackedEditOperation,trackSelection:(_selection,trackPreviousOnEmpty)=>{const selection=selection_1.Selection.liftSelection(_selection);let stickiness;if(selection.isEmpty())if("boolean"==typeof trackPreviousOnEmpty)stickiness=trackPreviousOnEmpty?2:3;else{const maxLineColumn=ctx.model.getLineMaxColumn(selection.startLineNumber);stickiness=selection.startColumn===maxLineColumn?2:3}else stickiness=1;const l=ctx.trackedRanges.length,id=ctx.model._setTrackedRange(null,selection,stickiness);return ctx.trackedRanges[l]=id,ctx.trackedRangesDirection[l]=selection.getDirection(),l.toString()}};try{command.getEditOperations(ctx.model,editOperationBuilder)}catch(e){return(0,errors_1.onUnexpectedError)(e),{operations:[],hadTrackedEditOperation:!1}}return{operations,hadTrackedEditOperation}}static _getLoserCursorMap(operations){(operations=operations.slice(0)).sort(((a,b)=>-range_1.Range.compareRangesUsingEnds(a.range,b.range)));const loserCursorsMap={};for(let i=1;i<operations.length;i++){const previousOp=operations[i-1],currentOp=operations[i];if(range_1.Range.getStartPosition(previousOp.range).isBefore(range_1.Range.getEndPosition(currentOp.range))){let loserMajor;loserMajor=previousOp.identifier.major>currentOp.identifier.major?previousOp.identifier.major:currentOp.identifier.major,loserCursorsMap[loserMajor.toString()]=!0;for(let j=0;j<operations.length;j++)operations[j].identifier.major===loserMajor&&(operations.splice(j,1),j<i&&i--,j--);i>0&&i--}}return loserCursorsMap}}.executeCommands(this._model,this._cursors.getSelections(),opResult.commands);if(result){this._interpretCommandResult(result);const autoClosedCharactersRanges=[],autoClosedEnclosingRanges=[];for(let i=0;i<opResult.commands.length;i++){const command=opResult.commands[i];command instanceof cursorTypeOperations_1.TypeWithAutoClosingCommand&&command.enclosingRange&&command.closeCharacterRange&&(autoClosedCharactersRanges.push(command.closeCharacterRange),autoClosedEnclosingRanges.push(command.enclosingRange))}autoClosedCharactersRanges.length>0&&this._pushAutoClosedAction(autoClosedCharactersRanges,autoClosedEnclosingRanges),this._prevEditOperationType=opResult.type}opResult.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(cursorState){cursorState&&0!==cursorState.length||(cursorState=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(cursorState),this._cursors.normalize()}_emitStateChangedIfNecessary(eventsCollector,source,reason,oldState,reachedMaxCursorCount){const newState=CursorModelState.from(this._model,this);if(newState.equals(oldState))return!1;const selections=this._cursors.getSelections(),viewSelections=this._cursors.getViewSelections();if(eventsCollector.emitViewEvent(new viewEvents_1.ViewCursorStateChangedEvent(viewSelections,selections)),!oldState||oldState.cursorState.length!==newState.cursorState.length||newState.cursorState.some(((newCursorState,i)=>!newCursorState.modelState.equals(oldState.cursorState[i].modelState)))){const oldSelections=oldState?oldState.cursorState.map((s=>s.modelState.selection)):null,oldModelVersionId=oldState?oldState.modelVersionId:0;eventsCollector.emitOutgoingEvent(new viewModelEventDispatcher_1.CursorStateChangedEvent(oldSelections,selections,oldModelVersionId,newState.modelVersionId,source||"keyboard",reason,reachedMaxCursorCount))}return!0}_findAutoClosingPairs(edits){if(!edits.length)return null;const indices=[];for(let i=0,len=edits.length;i<len;i++){const edit=edits[i];if(!edit.text||edit.text.indexOf("\n")>=0)return null;const m=edit.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!m)return null;const closeChar=m[1],autoClosingPairsCandidates=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(closeChar);if(!autoClosingPairsCandidates||1!==autoClosingPairsCandidates.length)return null;const openChar=autoClosingPairsCandidates[0].open,closeCharIndex=edit.text.length-m[2].length-1,openCharIndex=edit.text.lastIndexOf(openChar,closeCharIndex-1);if(-1===openCharIndex)return null;indices.push([openCharIndex,closeCharIndex])}return indices}executeEdits(eventsCollector,source,edits,cursorStateComputer){let autoClosingIndices=null;"snippet"===source&&(autoClosingIndices=this._findAutoClosingPairs(edits)),autoClosingIndices&&(edits[0]._isTracked=!0);const autoClosedCharactersRanges=[],autoClosedEnclosingRanges=[],selections=this._model.pushEditOperations(this.getSelections(),edits,(undoEdits=>{if(autoClosingIndices)for(let i=0,len=autoClosingIndices.length;i<len;i++){const[openCharInnerIndex,closeCharInnerIndex]=autoClosingIndices[i],undoEdit=undoEdits[i],lineNumber=undoEdit.range.startLineNumber,openCharIndex=undoEdit.range.startColumn-1+openCharInnerIndex,closeCharIndex=undoEdit.range.startColumn-1+closeCharInnerIndex;autoClosedCharactersRanges.push(new range_1.Range(lineNumber,closeCharIndex+1,lineNumber,closeCharIndex+2)),autoClosedEnclosingRanges.push(new range_1.Range(lineNumber,openCharIndex+1,lineNumber,closeCharIndex+2))}const selections=cursorStateComputer(undoEdits);return selections&&(this._isHandling=!0),selections}));selections&&(this._isHandling=!1,this.setSelections(eventsCollector,source,selections,0)),autoClosedCharactersRanges.length>0&&this._pushAutoClosedAction(autoClosedCharactersRanges,autoClosedEnclosingRanges)}_executeEdit(callback,eventsCollector,source,cursorChangeReason=0){if(this.context.cursorConfig.readOnly)return;const oldState=CursorModelState.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),callback()}catch(err){(0,errors_1.onUnexpectedError)(err)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(eventsCollector,source,cursorChangeReason,oldState,!1)&&this.revealPrimary(eventsCollector,source,!1,0,!0,0)}setIsDoingComposition(isDoingComposition){this._isDoingComposition=isDoingComposition}getAutoClosedCharacters(){return AutoClosedAction.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(eventsCollector){this._selectionsWhenCompositionStarted=this.getSelections().slice(0)}endComposition(eventsCollector,source){this._executeEdit((()=>{"keyboard"===source&&(this._executeEditOperation(cursorTypeOperations_1.TypeOperations.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this._selectionsWhenCompositionStarted,this.getSelections(),this.getAutoClosedCharacters())),this._selectionsWhenCompositionStarted=null)}),eventsCollector,source)}type(eventsCollector,text,source){this._executeEdit((()=>{if("keyboard"===source){const len=text.length;let offset=0;for(;offset<len;){const charLength=strings.nextCharLength(text,offset),chr=text.substr(offset,charLength);this._executeEditOperation(cursorTypeOperations_1.TypeOperations.typeWithInterceptors(this._isDoingComposition,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),chr)),offset+=charLength}}else this._executeEditOperation(cursorTypeOperations_1.TypeOperations.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),text))}),eventsCollector,source)}compositionType(eventsCollector,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta,source){if(0!==text.length||0!==replacePrevCharCnt||0!==replaceNextCharCnt)this._executeEdit((()=>{this._executeEditOperation(cursorTypeOperations_1.TypeOperations.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),text,replacePrevCharCnt,replaceNextCharCnt,positionDelta))}),eventsCollector,source);else if(0!==positionDelta){const newSelections=this.getSelections().map((selection=>{const position=selection.getPosition();return new selection_1.Selection(position.lineNumber,position.column+positionDelta,position.lineNumber,position.column+positionDelta)}));this.setSelections(eventsCollector,source,newSelections,0)}}paste(eventsCollector,text,pasteOnNewLine,multicursorText,source){this._executeEdit((()=>{this._executeEditOperation(cursorTypeOperations_1.TypeOperations.paste(this.context.cursorConfig,this._model,this.getSelections(),text,pasteOnNewLine,multicursorText||[]))}),eventsCollector,source,4)}cut(eventsCollector,source){this._executeEdit((()=>{this._executeEditOperation(cursorDeleteOperations_1.DeleteOperations.cut(this.context.cursorConfig,this._model,this.getSelections()))}),eventsCollector,source)}executeCommand(eventsCollector,command,source){this._executeEdit((()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new cursorCommon_1.EditOperationResult(0,[command],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),eventsCollector,source)}executeCommands(eventsCollector,commands,source){this._executeEdit((()=>{this._executeEditOperation(new cursorCommon_1.EditOperationResult(0,commands,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),eventsCollector,source)}}exports.CursorsController=CursorsController,CursorsController.MAX_CURSOR_COUNT=1e4;class CursorModelState{constructor(modelVersionId,cursorState){this.modelVersionId=modelVersionId,this.cursorState=cursorState}static from(model,cursor){return new CursorModelState(model.getVersionId(),cursor.getCursorStates())}equals(other){if(!other)return!1;if(this.modelVersionId!==other.modelVersionId)return!1;if(this.cursorState.length!==other.cursorState.length)return!1;for(let i=0,len=this.cursorState.length;i<len;i++)if(!this.cursorState[i].equals(other.cursorState[i]))return!1;return!0}}class AutoClosedAction{constructor(model,autoClosedCharactersDecorations,autoClosedEnclosingDecorations){this._model=model,this._autoClosedCharactersDecorations=autoClosedCharactersDecorations,this._autoClosedEnclosingDecorations=autoClosedEnclosingDecorations}static getAllAutoClosedCharacters(autoClosedActions){let autoClosedCharacters=[];for(const autoClosedAction of autoClosedActions)autoClosedCharacters=autoClosedCharacters.concat(autoClosedAction.getAutoClosedCharactersRanges());return autoClosedCharacters}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const result=[];for(let i=0;i<this._autoClosedCharactersDecorations.length;i++){const decorationRange=this._model.getDecorationRange(this._autoClosedCharactersDecorations[i]);decorationRange&&result.push(decorationRange)}return result}isValid(selections){const enclosingRanges=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const decorationRange=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(decorationRange&&(enclosingRanges.push(decorationRange),decorationRange.startLineNumber!==decorationRange.endLineNumber))return!1}enclosingRanges.sort(range_1.Range.compareRangesUsingStarts),selections.sort(range_1.Range.compareRangesUsingStarts);for(let i=0;i<selections.length;i++){if(i>=enclosingRanges.length)return!1;if(!enclosingRanges[i].strictContainsRange(selections[i]))return!1}return!0}}})),define(__m[609],__M([1,0,8,63,11,3,22,33,257]),(function(require,exports,strings,editOperation_1,position_1,range_1,selection_1,languageConfigurationRegistry_1,blockCommentCommand_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LineCommentCommand=void 0;class LineCommentCommand{constructor(languageConfigurationService,selection,tabSize,type,insertSpace,ignoreEmptyLines,ignoreFirstLine){this.languageConfigurationService=languageConfigurationService,this._selection=selection,this._tabSize=tabSize,this._type=type,this._insertSpace=insertSpace,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=ignoreEmptyLines,this._ignoreFirstLine=ignoreFirstLine||!1}static _gatherPreflightCommentStrings(model,startLineNumber,endLineNumber,languageConfigurationService){model.tokenizeIfCheap(startLineNumber);const languageId=model.getLanguageIdAtPosition(startLineNumber,1),config=languageConfigurationService.getLanguageConfiguration(languageId).comments,commentStr=config?config.lineCommentToken:null;if(!commentStr)return null;let lines=[];for(let i=0,lineCount=endLineNumber-startLineNumber+1;i<lineCount;i++)lines[i]={ignore:!1,commentStr,commentStrOffset:0,commentStrLength:commentStr.length};return lines}static _analyzeLines(type,insertSpace,model,lines,startLineNumber,ignoreEmptyLines,ignoreFirstLine,languageConfigurationService){let shouldRemoveComments,onlyWhitespaceLines=!0;shouldRemoveComments=0===type||1!==type;for(let i=0,lineCount=lines.length;i<lineCount;i++){const lineData=lines[i],lineNumber=startLineNumber+i;if(lineNumber===startLineNumber&&ignoreFirstLine){lineData.ignore=!0;continue}const lineContent=model.getLineContent(lineNumber),lineContentStartOffset=strings.firstNonWhitespaceIndex(lineContent);if(-1!==lineContentStartOffset){if(onlyWhitespaceLines=!1,lineData.ignore=!1,lineData.commentStrOffset=lineContentStartOffset,shouldRemoveComments&&!blockCommentCommand_1.BlockCommentCommand._haystackHasNeedleAtOffset(lineContent,lineData.commentStr,lineContentStartOffset)&&(0===type?shouldRemoveComments=!1:1===type||(lineData.ignore=!0)),shouldRemoveComments&&insertSpace){const commentStrEndOffset=lineContentStartOffset+lineData.commentStrLength;commentStrEndOffset<lineContent.length&&32===lineContent.charCodeAt(commentStrEndOffset)&&(lineData.commentStrLength+=1)}}else lineData.ignore=ignoreEmptyLines,lineData.commentStrOffset=lineContent.length}if(0===type&&onlyWhitespaceLines){shouldRemoveComments=!1;for(let i=0,lineCount=lines.length;i<lineCount;i++)lines[i].ignore=!1}return{supported:!0,shouldRemoveComments,lines}}static _gatherPreflightData(type,insertSpace,model,startLineNumber,endLineNumber,ignoreEmptyLines,ignoreFirstLine,languageConfigurationService){const lines=LineCommentCommand._gatherPreflightCommentStrings(model,startLineNumber,endLineNumber,languageConfigurationService);return null===lines?{supported:!1}:LineCommentCommand._analyzeLines(type,insertSpace,model,lines,startLineNumber,ignoreEmptyLines,ignoreFirstLine,languageConfigurationService)}_executeLineComments(model,builder,data,s){let ops;data.shouldRemoveComments?ops=LineCommentCommand._createRemoveLineCommentsOperations(data.lines,s.startLineNumber):(LineCommentCommand._normalizeInsertionPoint(model,data.lines,s.startLineNumber,this._tabSize),ops=this._createAddLineCommentsOperations(data.lines,s.startLineNumber));const cursorPosition=new position_1.Position(s.positionLineNumber,s.positionColumn);for(let i=0,len=ops.length;i<len;i++)if(builder.addEditOperation(ops[i].range,ops[i].text),range_1.Range.isEmpty(ops[i].range)&&range_1.Range.getStartPosition(ops[i].range).equals(cursorPosition)){model.getLineContent(cursorPosition.lineNumber).length+1===cursorPosition.column&&(this._deltaColumn=(ops[i].text||"").length)}this._selectionId=builder.trackSelection(s)}_attemptRemoveBlockComment(model,s,startToken,endToken){let startLineNumber=s.startLineNumber,endLineNumber=s.endLineNumber,startTokenAllowedBeforeColumn=endToken.length+Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber),s.startColumn),startTokenIndex=model.getLineContent(startLineNumber).lastIndexOf(startToken,startTokenAllowedBeforeColumn-1),endTokenIndex=model.getLineContent(endLineNumber).indexOf(endToken,s.endColumn-1-startToken.length);return-1!==startTokenIndex&&-1===endTokenIndex&&(endTokenIndex=model.getLineContent(startLineNumber).indexOf(endToken,startTokenIndex+startToken.length),endLineNumber=startLineNumber),-1===startTokenIndex&&-1!==endTokenIndex&&(startTokenIndex=model.getLineContent(endLineNumber).lastIndexOf(startToken,endTokenIndex),startLineNumber=endLineNumber),!s.isEmpty()||-1!==startTokenIndex&&-1!==endTokenIndex||(startTokenIndex=model.getLineContent(startLineNumber).indexOf(startToken),-1!==startTokenIndex&&(endTokenIndex=model.getLineContent(startLineNumber).indexOf(endToken,startTokenIndex+startToken.length))),-1!==startTokenIndex&&32===model.getLineContent(startLineNumber).charCodeAt(startTokenIndex+startToken.length)&&(startToken+=" "),-1!==endTokenIndex&&32===model.getLineContent(endLineNumber).charCodeAt(endTokenIndex-1)&&(endToken=" "+endToken,endTokenIndex-=1),-1!==startTokenIndex&&-1!==endTokenIndex?blockCommentCommand_1.BlockCommentCommand._createRemoveBlockCommentOperations(new range_1.Range(startLineNumber,startTokenIndex+startToken.length+1,endLineNumber,endTokenIndex+1),startToken,endToken):null}_executeBlockComment(model,builder,s){model.tokenizeIfCheap(s.startLineNumber);let languageId=model.getLanguageIdAtPosition(s.startLineNumber,1),config=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getComments(languageId);if(!config||!config.blockCommentStartToken||!config.blockCommentEndToken)return;const startToken=config.blockCommentStartToken,endToken=config.blockCommentEndToken;let ops=this._attemptRemoveBlockComment(model,s,startToken,endToken);if(!ops){if(s.isEmpty()){const lineContent=model.getLineContent(s.startLineNumber);let firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(lineContent);-1===firstNonWhitespaceIndex&&(firstNonWhitespaceIndex=lineContent.length),ops=blockCommentCommand_1.BlockCommentCommand._createAddBlockCommentOperations(new range_1.Range(s.startLineNumber,firstNonWhitespaceIndex+1,s.startLineNumber,lineContent.length+1),startToken,endToken,this._insertSpace)}else ops=blockCommentCommand_1.BlockCommentCommand._createAddBlockCommentOperations(new range_1.Range(s.startLineNumber,model.getLineFirstNonWhitespaceColumn(s.startLineNumber),s.endLineNumber,model.getLineMaxColumn(s.endLineNumber)),startToken,endToken,this._insertSpace);1===ops.length&&(this._deltaColumn=startToken.length+1)}this._selectionId=builder.trackSelection(s);for(const op of ops)builder.addEditOperation(op.range,op.text)}getEditOperations(model,builder){let s=this._selection;if(this._moveEndPositionDown=!1,s.startLineNumber===s.endLineNumber&&this._ignoreFirstLine)return builder.addEditOperation(new range_1.Range(s.startLineNumber,model.getLineMaxColumn(s.startLineNumber),s.startLineNumber+1,1),s.startLineNumber===model.getLineCount()?"":"\n"),void(this._selectionId=builder.trackSelection(s));s.startLineNumber<s.endLineNumber&&1===s.endColumn&&(this._moveEndPositionDown=!0,s=s.setEndPosition(s.endLineNumber-1,model.getLineMaxColumn(s.endLineNumber-1)));const data=LineCommentCommand._gatherPreflightData(this._type,this._insertSpace,model,s.startLineNumber,s.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return data.supported?this._executeLineComments(model,builder,data,s):this._executeBlockComment(model,builder,s)}computeCursorState(model,helper){let result=helper.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(result=result.setEndPosition(result.endLineNumber+1,1)),new selection_1.Selection(result.selectionStartLineNumber,result.selectionStartColumn+this._deltaColumn,result.positionLineNumber,result.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(lines,startLineNumber){let res=[];for(let i=0,len=lines.length;i<len;i++){const lineData=lines[i];lineData.ignore||res.push(editOperation_1.EditOperation.delete(new range_1.Range(startLineNumber+i,lineData.commentStrOffset+1,startLineNumber+i,lineData.commentStrOffset+lineData.commentStrLength+1)))}return res}_createAddLineCommentsOperations(lines,startLineNumber){let res=[];const afterCommentStr=this._insertSpace?" ":"";for(let i=0,len=lines.length;i<len;i++){const lineData=lines[i];lineData.ignore||res.push(editOperation_1.EditOperation.insert(new position_1.Position(startLineNumber+i,lineData.commentStrOffset+1),lineData.commentStr+afterCommentStr))}return res}static nextVisibleColumn(currentVisibleColumn,tabSize,isTab,columnSize){return isTab?currentVisibleColumn+(tabSize-currentVisibleColumn%tabSize):currentVisibleColumn+columnSize}static _normalizeInsertionPoint(model,lines,startLineNumber,tabSize){let j,lenJ,minVisibleColumn=1073741824;for(let i=0,len=lines.length;i<len;i++){if(lines[i].ignore)continue;const lineContent=model.getLineContent(startLineNumber+i);let currentVisibleColumn=0;for(let j=0,lenJ=lines[i].commentStrOffset;currentVisibleColumn<minVisibleColumn&&j<lenJ;j++)currentVisibleColumn=LineCommentCommand.nextVisibleColumn(currentVisibleColumn,tabSize,9===lineContent.charCodeAt(j),1);currentVisibleColumn<minVisibleColumn&&(minVisibleColumn=currentVisibleColumn)}minVisibleColumn=Math.floor(minVisibleColumn/tabSize)*tabSize;for(let i=0,len=lines.length;i<len;i++){if(lines[i].ignore)continue;const lineContent=model.getLineContent(startLineNumber+i);let currentVisibleColumn=0;for(j=0,lenJ=lines[i].commentStrOffset;currentVisibleColumn<minVisibleColumn&&j<lenJ;j++)currentVisibleColumn=LineCommentCommand.nextVisibleColumn(currentVisibleColumn,tabSize,9===lineContent.charCodeAt(j),1);lines[i].commentStrOffset=currentVisibleColumn>minVisibleColumn?j-1:j}}}exports.LineCommentCommand=LineCommentCommand})),define(__m[610],__M([1,0,8,202,3,22,122,33,261]),(function(require,exports,strings,shiftCommand_1,range_1,selection_1,languageConfiguration_1,languageConfigurationRegistry_1,indentUtils){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveLinesCommand=void 0;exports.MoveLinesCommand=class MoveLinesCommand{constructor(selection,isMovingDown,autoIndent){this._selection=selection,this._isMovingDown=isMovingDown,this._autoIndent=autoIndent,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(model,builder){let modelLineCount=model.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===modelLineCount)return void(this._selectionId=builder.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=builder.trackSelection(this._selection));this._moveEndPositionDown=!1;let s=this._selection;s.startLineNumber<s.endLineNumber&&1===s.endColumn&&(this._moveEndPositionDown=!0,s=s.setEndPosition(s.endLineNumber-1,model.getLineMaxColumn(s.endLineNumber-1)));const{tabSize,indentSize,insertSpaces}=model.getOptions();let indentConverter=this.buildIndentConverter(tabSize,indentSize,insertSpaces),virtualModel={getLineTokens:lineNumber=>model.getLineTokens(lineNumber),getLanguageId:()=>model.getLanguageId(),getLanguageIdAtPosition:(lineNumber,column)=>model.getLanguageIdAtPosition(lineNumber,column),getLineContent:null};if(s.startLineNumber===s.endLineNumber&&1===model.getLineMaxColumn(s.startLineNumber)){let lineNumber=s.startLineNumber,otherLineNumber=this._isMovingDown?lineNumber+1:lineNumber-1;1===model.getLineMaxColumn(otherLineNumber)?builder.addEditOperation(new range_1.Range(1,1,1,1),null):(builder.addEditOperation(new range_1.Range(lineNumber,1,lineNumber,1),model.getLineContent(otherLineNumber)),builder.addEditOperation(new range_1.Range(otherLineNumber,1,otherLineNumber,model.getLineMaxColumn(otherLineNumber)),null)),s=new selection_1.Selection(otherLineNumber,1,otherLineNumber,1)}else{let movingLineNumber,movingLineText;if(this._isMovingDown){movingLineNumber=s.endLineNumber+1,movingLineText=model.getLineContent(movingLineNumber),builder.addEditOperation(new range_1.Range(movingLineNumber-1,model.getLineMaxColumn(movingLineNumber-1),movingLineNumber,model.getLineMaxColumn(movingLineNumber)),null);let insertingText=movingLineText;if(this.shouldAutoIndent(model,s)){let movingLineMatchResult=this.matchEnterRule(model,indentConverter,tabSize,movingLineNumber,s.startLineNumber-1);if(null!==movingLineMatchResult){let oldIndentation=strings.getLeadingWhitespace(model.getLineContent(movingLineNumber)),newSpaceCnt=movingLineMatchResult+indentUtils.getSpaceCnt(oldIndentation,tabSize),newIndentation=indentUtils.generateIndent(newSpaceCnt,tabSize,insertSpaces);insertingText=newIndentation+this.trimLeft(movingLineText)}else{virtualModel.getLineContent=lineNumber=>lineNumber===s.startLineNumber?model.getLineContent(movingLineNumber):model.getLineContent(lineNumber);let indentOfMovingLine=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,virtualModel,model.getLanguageIdAtPosition(movingLineNumber,1),s.startLineNumber,indentConverter);if(null!==indentOfMovingLine){let oldIndentation=strings.getLeadingWhitespace(model.getLineContent(movingLineNumber)),newSpaceCnt=indentUtils.getSpaceCnt(indentOfMovingLine,tabSize);if(newSpaceCnt!==indentUtils.getSpaceCnt(oldIndentation,tabSize)){let newIndentation=indentUtils.generateIndent(newSpaceCnt,tabSize,insertSpaces);insertingText=newIndentation+this.trimLeft(movingLineText)}}}builder.addEditOperation(new range_1.Range(s.startLineNumber,1,s.startLineNumber,1),insertingText+"\n");let ret=this.matchEnterRuleMovingDown(model,indentConverter,tabSize,s.startLineNumber,movingLineNumber,insertingText);if(null!==ret)0!==ret&&this.getIndentEditsOfMovingBlock(model,builder,s,tabSize,insertSpaces,ret);else{virtualModel.getLineContent=lineNumber=>lineNumber===s.startLineNumber?insertingText:lineNumber>=s.startLineNumber+1&&lineNumber<=s.endLineNumber+1?model.getLineContent(lineNumber-1):model.getLineContent(lineNumber);let newIndentatOfMovingBlock=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,virtualModel,model.getLanguageIdAtPosition(movingLineNumber,1),s.startLineNumber+1,indentConverter);if(null!==newIndentatOfMovingBlock){const oldIndentation=strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber)),newSpaceCnt=indentUtils.getSpaceCnt(newIndentatOfMovingBlock,tabSize),oldSpaceCnt=indentUtils.getSpaceCnt(oldIndentation,tabSize);if(newSpaceCnt!==oldSpaceCnt){const spaceCntOffset=newSpaceCnt-oldSpaceCnt;this.getIndentEditsOfMovingBlock(model,builder,s,tabSize,insertSpaces,spaceCntOffset)}}}}else builder.addEditOperation(new range_1.Range(s.startLineNumber,1,s.startLineNumber,1),insertingText+"\n")}else if(movingLineNumber=s.startLineNumber-1,movingLineText=model.getLineContent(movingLineNumber),builder.addEditOperation(new range_1.Range(movingLineNumber,1,movingLineNumber+1,1),null),builder.addEditOperation(new range_1.Range(s.endLineNumber,model.getLineMaxColumn(s.endLineNumber),s.endLineNumber,model.getLineMaxColumn(s.endLineNumber)),"\n"+movingLineText),this.shouldAutoIndent(model,s)){virtualModel.getLineContent=lineNumber=>lineNumber===movingLineNumber?model.getLineContent(s.startLineNumber):model.getLineContent(lineNumber);let ret=this.matchEnterRule(model,indentConverter,tabSize,s.startLineNumber,s.startLineNumber-2);if(null!==ret)0!==ret&&this.getIndentEditsOfMovingBlock(model,builder,s,tabSize,insertSpaces,ret);else{let indentOfFirstLine=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,virtualModel,model.getLanguageIdAtPosition(s.startLineNumber,1),movingLineNumber,indentConverter);if(null!==indentOfFirstLine){let oldIndent=strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber)),newSpaceCnt=indentUtils.getSpaceCnt(indentOfFirstLine,tabSize),oldSpaceCnt=indentUtils.getSpaceCnt(oldIndent,tabSize);if(newSpaceCnt!==oldSpaceCnt){let spaceCntOffset=newSpaceCnt-oldSpaceCnt;this.getIndentEditsOfMovingBlock(model,builder,s,tabSize,insertSpaces,spaceCntOffset)}}}}}this._selectionId=builder.trackSelection(s)}buildIndentConverter(tabSize,indentSize,insertSpaces){return{shiftIndent:indentation=>shiftCommand_1.ShiftCommand.shiftIndent(indentation,indentation.length+1,tabSize,indentSize,insertSpaces),unshiftIndent:indentation=>shiftCommand_1.ShiftCommand.unshiftIndent(indentation,indentation.length+1,tabSize,indentSize,insertSpaces)}}parseEnterResult(model,indentConverter,tabSize,line,enter){if(enter){let enterPrefix=enter.indentation;enter.indentAction===languageConfiguration_1.IndentAction.None||enter.indentAction===languageConfiguration_1.IndentAction.Indent?enterPrefix=enter.indentation+enter.appendText:enter.indentAction===languageConfiguration_1.IndentAction.IndentOutdent?enterPrefix=enter.indentation:enter.indentAction===languageConfiguration_1.IndentAction.Outdent&&(enterPrefix=indentConverter.unshiftIndent(enter.indentation)+enter.appendText);let movingLineText=model.getLineContent(line);if(this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix))>=0){let oldIndentation=strings.getLeadingWhitespace(model.getLineContent(line)),newIndentation=strings.getLeadingWhitespace(enterPrefix),indentMetadataOfMovelingLine=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentMetadata(model,line);return null!==indentMetadataOfMovelingLine&&2&indentMetadataOfMovelingLine&&(newIndentation=indentConverter.unshiftIndent(newIndentation)),indentUtils.getSpaceCnt(newIndentation,tabSize)-indentUtils.getSpaceCnt(oldIndentation,tabSize)}}return null}matchEnterRuleMovingDown(model,indentConverter,tabSize,line,futureAboveLineNumber,futureAboveLineText){if(strings.lastNonWhitespaceIndex(futureAboveLineText)>=0){let maxColumn=model.getLineMaxColumn(futureAboveLineNumber),enter=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(this._autoIndent,model,new range_1.Range(futureAboveLineNumber,maxColumn,futureAboveLineNumber,maxColumn));return this.parseEnterResult(model,indentConverter,tabSize,line,enter)}{let validPrecedingLine=line-1;for(;validPrecedingLine>=1;){let lineContent=model.getLineContent(validPrecedingLine);if(strings.lastNonWhitespaceIndex(lineContent)>=0)break;validPrecedingLine--}if(validPrecedingLine<1||line>model.getLineCount())return null;let maxColumn=model.getLineMaxColumn(validPrecedingLine),enter=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(this._autoIndent,model,new range_1.Range(validPrecedingLine,maxColumn,validPrecedingLine,maxColumn));return this.parseEnterResult(model,indentConverter,tabSize,line,enter)}}matchEnterRule(model,indentConverter,tabSize,line,oneLineAbove,previousLineText){let validPrecedingLine=oneLineAbove;for(;validPrecedingLine>=1;){let lineContent;if(lineContent=validPrecedingLine===oneLineAbove&&void 0!==previousLineText?previousLineText:model.getLineContent(validPrecedingLine),strings.lastNonWhitespaceIndex(lineContent)>=0)break;validPrecedingLine--}if(validPrecedingLine<1||line>model.getLineCount())return null;let maxColumn=model.getLineMaxColumn(validPrecedingLine),enter=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getEnterAction(this._autoIndent,model,new range_1.Range(validPrecedingLine,maxColumn,validPrecedingLine,maxColumn));return this.parseEnterResult(model,indentConverter,tabSize,line,enter)}trimLeft(str){return str.replace(/^\s+/,"")}shouldAutoIndent(model,selection){if(this._autoIndent<4)return!1;if(!model.isCheapToTokenize(selection.startLineNumber))return!1;let languageAtSelectionStart=model.getLanguageIdAtPosition(selection.startLineNumber,1);return languageAtSelectionStart===model.getLanguageIdAtPosition(selection.endLineNumber,1)&&null!==languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentRulesSupport(languageAtSelectionStart)}getIndentEditsOfMovingBlock(model,builder,s,tabSize,insertSpaces,offset){for(let i=s.startLineNumber;i<=s.endLineNumber;i++){let lineContent=model.getLineContent(i),originalIndent=strings.getLeadingWhitespace(lineContent),newSpacesCnt=indentUtils.getSpaceCnt(originalIndent,tabSize)+offset,newIndent=indentUtils.generateIndent(newSpacesCnt,tabSize,insertSpaces);newIndent!==originalIndent&&(builder.addEditOperation(new range_1.Range(i,1,i,originalIndent.length+1),newIndent),i===s.endLineNumber&&s.endColumn<=originalIndent.length+1&&""===newIndent&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(model,helper){let result=helper.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(result=result.setEndPosition(result.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&result.startLineNumber<result.endLineNumber&&(result=result.setEndPosition(result.endLineNumber,2)),result}}})),define(__m[17],__M([1,0,16,8,9]),(function(require,exports,platform_1,strings_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.implies=exports.SET_CONTEXT_COMMAND_ID=exports.IContextKeyService=exports.RawContextKey=exports.ContextKeyNotRegexExpr=exports.ContextKeyRegexExpr=exports.ContextKeySmallerEqualsExpr=exports.ContextKeySmallerExpr=exports.ContextKeyGreaterEqualsExpr=exports.ContextKeyGreaterExpr=exports.ContextKeyNotExpr=exports.ContextKeyNotEqualsExpr=exports.ContextKeyNotInExpr=exports.ContextKeyInExpr=exports.ContextKeyEqualsExpr=exports.ContextKeyDefinedExpr=exports.ContextKeyTrueExpr=exports.ContextKeyFalseExpr=exports.expressionsAreEqualWithConstantSubstitution=exports.ContextKeyExpr=void 0;const CONSTANT_VALUES=new Map;CONSTANT_VALUES.set("false",!1),CONSTANT_VALUES.set("true",!0),CONSTANT_VALUES.set("isMac",platform_1.isMacintosh),CONSTANT_VALUES.set("isLinux",platform_1.isLinux),CONSTANT_VALUES.set("isWindows",platform_1.isWindows),CONSTANT_VALUES.set("isWeb",platform_1.isWeb),CONSTANT_VALUES.set("isMacNative",platform_1.isMacintosh&&!platform_1.isWeb),CONSTANT_VALUES.set("isEdge",platform_1.isEdge),CONSTANT_VALUES.set("isFirefox",platform_1.isFirefox),CONSTANT_VALUES.set("isChrome",platform_1.isChrome),CONSTANT_VALUES.set("isSafari",platform_1.isSafari);const hasOwnProperty=Object.prototype.hasOwnProperty;function cmp(a,b){return a.cmp(b)}exports.ContextKeyExpr=class ContextKeyExpr{static has(key){return ContextKeyDefinedExpr.create(key)}static equals(key,value){return ContextKeyEqualsExpr.create(key,value)}static regex(key,value){return ContextKeyRegexExpr.create(key,value)}static not(key){return ContextKeyNotExpr.create(key)}static and(...expr){return ContextKeyAndExpr.create(expr,null)}static or(...expr){return ContextKeyOrExpr.create(expr,null,!0)}static deserialize(serialized,strict=!1){if(serialized)return this._deserializeOrExpression(serialized,strict)}static _deserializeOrExpression(serialized,strict){let pieces=serialized.split("||");return ContextKeyOrExpr.create(pieces.map((p=>this._deserializeAndExpression(p,strict))),null,!0)}static _deserializeAndExpression(serialized,strict){let pieces=serialized.split("&&");return ContextKeyAndExpr.create(pieces.map((p=>this._deserializeOne(p,strict))),null)}static _deserializeOne(serializedOne,strict){if((serializedOne=serializedOne.trim()).indexOf("!=")>=0){let pieces=serializedOne.split("!=");return ContextKeyNotEqualsExpr.create(pieces[0].trim(),this._deserializeValue(pieces[1],strict))}if(serializedOne.indexOf("==")>=0){let pieces=serializedOne.split("==");return ContextKeyEqualsExpr.create(pieces[0].trim(),this._deserializeValue(pieces[1],strict))}if(serializedOne.indexOf("=~")>=0){let pieces=serializedOne.split("=~");return ContextKeyRegexExpr.create(pieces[0].trim(),this._deserializeRegexValue(pieces[1],strict))}if(serializedOne.indexOf(" in ")>=0){let pieces=serializedOne.split(" in ");return ContextKeyInExpr.create(pieces[0].trim(),pieces[1].trim())}if(/^[^<=>]+>=[^<=>]+$/.test(serializedOne)){const pieces=serializedOne.split(">=");return ContextKeyGreaterEqualsExpr.create(pieces[0].trim(),pieces[1].trim())}if(/^[^<=>]+>[^<=>]+$/.test(serializedOne)){const pieces=serializedOne.split(">");return ContextKeyGreaterExpr.create(pieces[0].trim(),pieces[1].trim())}if(/^[^<=>]+<=[^<=>]+$/.test(serializedOne)){const pieces=serializedOne.split("<=");return ContextKeySmallerEqualsExpr.create(pieces[0].trim(),pieces[1].trim())}if(/^[^<=>]+<[^<=>]+$/.test(serializedOne)){const pieces=serializedOne.split("<");return ContextKeySmallerExpr.create(pieces[0].trim(),pieces[1].trim())}return/^\!\s*/.test(serializedOne)?ContextKeyNotExpr.create(serializedOne.substr(1).trim()):ContextKeyDefinedExpr.create(serializedOne)}static _deserializeValue(serializedValue,strict){if("true"===(serializedValue=serializedValue.trim()))return!0;if("false"===serializedValue)return!1;let m=/^'([^']*)'$/.exec(serializedValue);return m?m[1].trim():serializedValue}static _deserializeRegexValue(serializedValue,strict){if((0,strings_1.isFalsyOrWhitespace)(serializedValue)){if(strict)throw new Error("missing regexp-value for =~-expression");return console.warn("missing regexp-value for =~-expression"),null}let start=serializedValue.indexOf("/"),end=serializedValue.lastIndexOf("/");if(start===end||start<0){if(strict)throw new Error(`bad regexp-value '${serializedValue}', missing /-enclosure`);return console.warn(`bad regexp-value '${serializedValue}', missing /-enclosure`),null}let value=serializedValue.slice(start+1,end),caseIgnoreFlag="i"===serializedValue[end+1]?"i":"";try{return new RegExp(value,caseIgnoreFlag)}catch(e){if(strict)throw new Error(`bad regexp-value '${serializedValue}', parse error: ${e}`);return console.warn(`bad regexp-value '${serializedValue}', parse error: ${e}`),null}}},exports.expressionsAreEqualWithConstantSubstitution=function expressionsAreEqualWithConstantSubstitution(a,b){const aExpr=a?a.substituteConstants():void 0,bExpr=b?b.substituteConstants():void 0;return!aExpr&&!bExpr||!(!aExpr||!bExpr)&&aExpr.equals(bExpr)};class ContextKeyFalseExpr{constructor(){this.type=0}cmp(other){return this.type-other.type}equals(other){return other.type===this.type}substituteConstants(){return this}evaluate(context){return!1}serialize(){return"false"}keys(){return[]}negate(){return ContextKeyTrueExpr.INSTANCE}}exports.ContextKeyFalseExpr=ContextKeyFalseExpr,ContextKeyFalseExpr.INSTANCE=new ContextKeyFalseExpr;class ContextKeyTrueExpr{constructor(){this.type=1}cmp(other){return this.type-other.type}equals(other){return other.type===this.type}substituteConstants(){return this}evaluate(context){return!0}serialize(){return"true"}keys(){return[]}negate(){return ContextKeyFalseExpr.INSTANCE}}exports.ContextKeyTrueExpr=ContextKeyTrueExpr,ContextKeyTrueExpr.INSTANCE=new ContextKeyTrueExpr;class ContextKeyDefinedExpr{constructor(key,negated){this.key=key,this.negated=negated,this.type=2}static create(key,negated=null){const constantValue=CONSTANT_VALUES.get(key);return"boolean"==typeof constantValue?constantValue?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyDefinedExpr(key,negated)}cmp(other){return other.type!==this.type?this.type-other.type:cmp1(this.key,other.key)}equals(other){return other.type===this.type&&this.key===other.key}substituteConstants(){const constantValue=CONSTANT_VALUES.get(this.key);return"boolean"==typeof constantValue?constantValue?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:this}evaluate(context){return!!context.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotExpr.create(this.key,this)),this.negated}}exports.ContextKeyDefinedExpr=ContextKeyDefinedExpr;class ContextKeyEqualsExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=4}static create(key,value,negated=null){if("boolean"==typeof value)return value?ContextKeyDefinedExpr.create(key,negated):ContextKeyNotExpr.create(key,negated);const constantValue=CONSTANT_VALUES.get(key);if("boolean"==typeof constantValue){return value===(constantValue?"true":"false")?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return new ContextKeyEqualsExpr(key,value,negated)}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){const constantValue=CONSTANT_VALUES.get(this.key);if("boolean"==typeof constantValue){const trueValue=constantValue?"true":"false";return this.value===trueValue?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return this}evaluate(context){return context.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotEqualsExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeyEqualsExpr=ContextKeyEqualsExpr;class ContextKeyInExpr{constructor(key,valueKey){this.key=key,this.valueKey=valueKey,this.type=10,this.negated=null}static create(key,valueKey){return new ContextKeyInExpr(key,valueKey)}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.valueKey,other.key,other.valueKey)}equals(other){return other.type===this.type&&(this.key===other.key&&this.valueKey===other.valueKey)}substituteConstants(){return this}evaluate(context){const source=context.getValue(this.valueKey),item=context.getValue(this.key);return Array.isArray(source)?source.indexOf(item)>=0:"string"==typeof item&&"object"==typeof source&&null!==source&&hasOwnProperty.call(source,item)}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=ContextKeyNotInExpr.create(this)),this.negated}}exports.ContextKeyInExpr=ContextKeyInExpr;class ContextKeyNotInExpr{constructor(_actual){this._actual=_actual,this.type=11}static create(actual){return new ContextKeyNotInExpr(actual)}cmp(other){return other.type!==this.type?this.type-other.type:this._actual.cmp(other._actual)}equals(other){return other.type===this.type&&this._actual.equals(other._actual)}substituteConstants(){return this}evaluate(context){return!this._actual.evaluate(context)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}exports.ContextKeyNotInExpr=ContextKeyNotInExpr;class ContextKeyNotEqualsExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=5}static create(key,value,negated=null){if("boolean"==typeof value)return value?ContextKeyNotExpr.create(key,negated):ContextKeyDefinedExpr.create(key,negated);const constantValue=CONSTANT_VALUES.get(key);if("boolean"==typeof constantValue){return value===(constantValue?"true":"false")?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return new ContextKeyNotEqualsExpr(key,value,negated)}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){const constantValue=CONSTANT_VALUES.get(this.key);if("boolean"==typeof constantValue){const falseValue=constantValue?"true":"false";return this.value===falseValue?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return this}evaluate(context){return context.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyEqualsExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeyNotEqualsExpr=ContextKeyNotEqualsExpr;class ContextKeyNotExpr{constructor(key,negated){this.key=key,this.negated=negated,this.type=3}static create(key,negated=null){const constantValue=CONSTANT_VALUES.get(key);return"boolean"==typeof constantValue?constantValue?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotExpr(key,negated)}cmp(other){return other.type!==this.type?this.type-other.type:cmp1(this.key,other.key)}equals(other){return other.type===this.type&&this.key===other.key}substituteConstants(){const constantValue=CONSTANT_VALUES.get(this.key);return"boolean"==typeof constantValue?constantValue?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:this}evaluate(context){return!context.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyDefinedExpr.create(this.key,this)),this.negated}}function withFloatOrStr(value,callback){if("string"==typeof value){const n=parseFloat(value);isNaN(n)||(value=n)}return"string"==typeof value||"number"==typeof value?callback(value):ContextKeyFalseExpr.INSTANCE}exports.ContextKeyNotExpr=ContextKeyNotExpr;class ContextKeyGreaterExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=12}static create(key,_value,negated=null){return withFloatOrStr(_value,(value=>new ContextKeyGreaterExpr(key,value,negated)))}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){return this}evaluate(context){return"string"!=typeof this.value&&parseFloat(context.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerEqualsExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeyGreaterExpr=ContextKeyGreaterExpr;class ContextKeyGreaterEqualsExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=13}static create(key,_value,negated=null){return withFloatOrStr(_value,(value=>new ContextKeyGreaterEqualsExpr(key,value,negated)))}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){return this}evaluate(context){return"string"!=typeof this.value&&parseFloat(context.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeyGreaterEqualsExpr=ContextKeyGreaterEqualsExpr;class ContextKeySmallerExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=14}static create(key,_value,negated=null){return withFloatOrStr(_value,(value=>new ContextKeySmallerExpr(key,value,negated)))}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){return this}evaluate(context){return"string"!=typeof this.value&&parseFloat(context.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterEqualsExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeySmallerExpr=ContextKeySmallerExpr;class ContextKeySmallerEqualsExpr{constructor(key,value,negated){this.key=key,this.value=value,this.negated=negated,this.type=15}static create(key,_value,negated=null){return withFloatOrStr(_value,(value=>new ContextKeySmallerEqualsExpr(key,value,negated)))}cmp(other){return other.type!==this.type?this.type-other.type:cmp2(this.key,this.value,other.key,other.value)}equals(other){return other.type===this.type&&(this.key===other.key&&this.value===other.value)}substituteConstants(){return this}evaluate(context){return"string"!=typeof this.value&&parseFloat(context.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterExpr.create(this.key,this.value,this)),this.negated}}exports.ContextKeySmallerEqualsExpr=ContextKeySmallerEqualsExpr;class ContextKeyRegexExpr{constructor(key,regexp){this.key=key,this.regexp=regexp,this.type=7,this.negated=null}static create(key,regexp){return new ContextKeyRegexExpr(key,regexp)}cmp(other){if(other.type!==this.type)return this.type-other.type;if(this.key<other.key)return-1;if(this.key>other.key)return 1;const thisSource=this.regexp?this.regexp.source:"",otherSource=other.regexp?other.regexp.source:"";return thisSource<otherSource?-1:thisSource>otherSource?1:0}equals(other){if(other.type===this.type){const thisSource=this.regexp?this.regexp.source:"",otherSource=other.regexp?other.regexp.source:"";return this.key===other.key&&thisSource===otherSource}return!1}substituteConstants(){return this}evaluate(context){let value=context.getValue(this.key);return!!this.regexp&&this.regexp.test(value)}serialize(){const value=this.regexp?`/${this.regexp.source}/${this.regexp.ignoreCase?"i":""}`:"/invalid/";return`${this.key} =~ ${value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotRegexExpr.create(this)),this.negated}}exports.ContextKeyRegexExpr=ContextKeyRegexExpr;class ContextKeyNotRegexExpr{constructor(_actual){this._actual=_actual,this.type=8}static create(actual){return new ContextKeyNotRegexExpr(actual)}cmp(other){return other.type!==this.type?this.type-other.type:this._actual.cmp(other._actual)}equals(other){return other.type===this.type&&this._actual.equals(other._actual)}substituteConstants(){return this}evaluate(context){return!this._actual.evaluate(context)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}function eliminateConstantsInArray(arr){let newArr=null;for(let i=0,len=arr.length;i<len;i++){const newExpr=arr[i].substituteConstants();if(arr[i]!==newExpr&&null===newArr){newArr=[];for(let j=0;j<i;j++)newArr[j]=arr[j]}null!==newArr&&(newArr[i]=newExpr)}return null===newArr?arr:newArr}exports.ContextKeyNotRegexExpr=ContextKeyNotRegexExpr;class ContextKeyAndExpr{constructor(expr,negated){this.expr=expr,this.negated=negated,this.type=6}static create(_expr,negated){return ContextKeyAndExpr._normalizeArr(_expr,negated)}cmp(other){if(other.type!==this.type)return this.type-other.type;if(this.expr.length<other.expr.length)return-1;if(this.expr.length>other.expr.length)return 1;for(let i=0,len=this.expr.length;i<len;i++){const r=cmp(this.expr[i],other.expr[i]);if(0!==r)return r}return 0}equals(other){if(other.type===this.type){if(this.expr.length!==other.expr.length)return!1;for(let i=0,len=this.expr.length;i<len;i++)if(!this.expr[i].equals(other.expr[i]))return!1;return!0}return!1}substituteConstants(){const exprArr=eliminateConstantsInArray(this.expr);return exprArr===this.expr?this:ContextKeyAndExpr.create(exprArr,this.negated)}evaluate(context){for(let i=0,len=this.expr.length;i<len;i++)if(!this.expr[i].evaluate(context))return!1;return!0}static _normalizeArr(arr,negated){const expr=[];let hasTrue=!1;for(const e of arr)if(e)if(1!==e.type){if(0===e.type)return ContextKeyFalseExpr.INSTANCE;6!==e.type?expr.push(e):expr.push(...e.expr)}else hasTrue=!0;if(0===expr.length&&hasTrue)return ContextKeyTrueExpr.INSTANCE;if(0!==expr.length){if(1===expr.length)return expr[0];expr.sort(cmp);for(let i=1;i<expr.length;i++)expr[i-1].equals(expr[i])&&(expr.splice(i,1),i--);if(1===expr.length)return expr[0];for(;expr.length>1;){const lastElement=expr[expr.length-1];if(9!==lastElement.type)break;expr.pop();const secondToLastElement=expr.pop(),isFinished=0===expr.length,resultElement=ContextKeyOrExpr.create(lastElement.expr.map((el=>ContextKeyAndExpr.create([el,secondToLastElement],null))),null,isFinished);resultElement&&(expr.push(resultElement),expr.sort(cmp))}return 1===expr.length?expr[0]:new ContextKeyAndExpr(expr,negated)}}serialize(){return this.expr.map((e=>e.serialize())).join(" && ")}keys(){const result=[];for(let expr of this.expr)result.push(...expr.keys());return result}negate(){if(!this.negated){const result=[];for(let expr of this.expr)result.push(expr.negate());this.negated=ContextKeyOrExpr.create(result,this,!0)}return this.negated}}class ContextKeyOrExpr{constructor(expr,negated){this.expr=expr,this.negated=negated,this.type=9}static create(_expr,negated,extraRedundantCheck){return ContextKeyOrExpr._normalizeArr(_expr,negated,extraRedundantCheck)}cmp(other){if(other.type!==this.type)return this.type-other.type;if(this.expr.length<other.expr.length)return-1;if(this.expr.length>other.expr.length)return 1;for(let i=0,len=this.expr.length;i<len;i++){const r=cmp(this.expr[i],other.expr[i]);if(0!==r)return r}return 0}equals(other){if(other.type===this.type){if(this.expr.length!==other.expr.length)return!1;for(let i=0,len=this.expr.length;i<len;i++)if(!this.expr[i].equals(other.expr[i]))return!1;return!0}return!1}substituteConstants(){const exprArr=eliminateConstantsInArray(this.expr);return exprArr===this.expr?this:ContextKeyOrExpr.create(exprArr,this.negated,!1)}evaluate(context){for(let i=0,len=this.expr.length;i<len;i++)if(this.expr[i].evaluate(context))return!0;return!1}static _normalizeArr(arr,negated,extraRedundantCheck){let expr=[],hasFalse=!1;if(arr){for(let i=0,len=arr.length;i<len;i++){const e=arr[i];if(e)if(0!==e.type){if(1===e.type)return ContextKeyTrueExpr.INSTANCE;9!==e.type?expr.push(e):expr=expr.concat(e.expr)}else hasFalse=!0}if(0===expr.length&&hasFalse)return ContextKeyFalseExpr.INSTANCE;expr.sort(cmp)}if(0!==expr.length){if(1===expr.length)return expr[0];for(let i=1;i<expr.length;i++)expr[i-1].equals(expr[i])&&(expr.splice(i,1),i--);if(1===expr.length)return expr[0];if(extraRedundantCheck){for(let i=0;i<expr.length;i++)for(let j=i+1;j<expr.length;j++)implies(expr[i],expr[j])&&(expr.splice(j,1),j--);if(1===expr.length)return expr[0]}return new ContextKeyOrExpr(expr,negated)}}serialize(){return this.expr.map((e=>e.serialize())).join(" || ")}keys(){const result=[];for(let expr of this.expr)result.push(...expr.keys());return result}negate(){if(!this.negated){let result=[];for(let expr of this.expr)result.push(expr.negate());for(;result.length>1;){const LEFT=result.shift(),RIGHT=result.shift(),all=[];for(const left of getTerminals(LEFT))for(const right of getTerminals(RIGHT))all.push(ContextKeyAndExpr.create([left,right],null));const isFinished=0===result.length;result.unshift(ContextKeyOrExpr.create(all,null,isFinished))}this.negated=result[0]}return this.negated}}class RawContextKey extends ContextKeyDefinedExpr{constructor(key,defaultValue,metaOrHide){super(key,null),this._defaultValue=defaultValue,"object"==typeof metaOrHide?RawContextKey._info.push(Object.assign(Object.assign({},metaOrHide),{key})):!0!==metaOrHide&&RawContextKey._info.push({key,description:metaOrHide,type:null!=defaultValue?typeof defaultValue:void 0})}static all(){return RawContextKey._info.values()}bindTo(target){return target.createKey(this.key,this._defaultValue)}getValue(target){return target.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(value){return ContextKeyEqualsExpr.create(this.key,value)}}function cmp1(key1,key2){return key1<key2?-1:key1>key2?1:0}function cmp2(key1,value1,key2,value2){return key1<key2?-1:key1>key2?1:value1<value2?-1:value1>value2?1:0}function implies(p,q){if(6===q.type&&9!==p.type&&6!==p.type)for(const qTerm of q.expr)if(p.equals(qTerm))return!0;const expr=getTerminals(p.negate()).concat(getTerminals(q));expr.sort(cmp);for(let i=0;i<expr.length;i++){const notA=expr[i].negate();for(let j=i+1;j<expr.length;j++){const b=expr[j];if(notA.equals(b))return!0}}return!1}function getTerminals(node){return 9===node.type?node.expr:[node]}exports.RawContextKey=RawContextKey,RawContextKey._info=[],exports.IContextKeyService=(0,instantiation_1.createDecorator)("contextKeyService"),exports.SET_CONTEXT_COMMAND_ID="setContext",exports.implies=implies})),define(__m[24],__M([1,0,519,17]),(function(require,exports,nls,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorContextKeys=void 0,function(EditorContextKeys){EditorContextKeys.editorSimpleInput=new contextkey_1.RawContextKey("editorSimpleInput",!1,!0),EditorContextKeys.editorTextFocus=new contextkey_1.RawContextKey("editorTextFocus",!1,nls.localize(0,null)),EditorContextKeys.focus=new contextkey_1.RawContextKey("editorFocus",!1,nls.localize(1,null)),EditorContextKeys.textInputFocus=new contextkey_1.RawContextKey("textInputFocus",!1,nls.localize(2,null)),EditorContextKeys.readOnly=new contextkey_1.RawContextKey("editorReadonly",!1,nls.localize(3,null)),EditorContextKeys.inDiffEditor=new contextkey_1.RawContextKey("inDiffEditor",!1,nls.localize(4,null)),EditorContextKeys.columnSelection=new contextkey_1.RawContextKey("editorColumnSelection",!1,nls.localize(5,null)),EditorContextKeys.writable=EditorContextKeys.readOnly.toNegated(),EditorContextKeys.hasNonEmptySelection=new contextkey_1.RawContextKey("editorHasSelection",!1,nls.localize(6,null)),EditorContextKeys.hasOnlyEmptySelection=EditorContextKeys.hasNonEmptySelection.toNegated(),EditorContextKeys.hasMultipleSelections=new contextkey_1.RawContextKey("editorHasMultipleSelections",!1,nls.localize(7,null)),EditorContextKeys.hasSingleSelection=EditorContextKeys.hasMultipleSelections.toNegated(),EditorContextKeys.tabMovesFocus=new contextkey_1.RawContextKey("editorTabMovesFocus",!1,nls.localize(8,null)),EditorContextKeys.tabDoesNotMoveFocus=EditorContextKeys.tabMovesFocus.toNegated(),EditorContextKeys.isInWalkThroughSnippet=new contextkey_1.RawContextKey("isInEmbeddedEditor",!1,!0),EditorContextKeys.canUndo=new contextkey_1.RawContextKey("canUndo",!1,!0),EditorContextKeys.canRedo=new contextkey_1.RawContextKey("canRedo",!1,!0),EditorContextKeys.hoverVisible=new contextkey_1.RawContextKey("editorHoverVisible",!1,nls.localize(9,null)),EditorContextKeys.inCompositeEditor=new contextkey_1.RawContextKey("inCompositeEditor",void 0,nls.localize(10,null)),EditorContextKeys.notInCompositeEditor=EditorContextKeys.inCompositeEditor.toNegated(),EditorContextKeys.languageId=new contextkey_1.RawContextKey("editorLangId","",nls.localize(11,null)),EditorContextKeys.hasCompletionItemProvider=new contextkey_1.RawContextKey("editorHasCompletionItemProvider",!1,nls.localize(12,null)),EditorContextKeys.hasCodeActionsProvider=new contextkey_1.RawContextKey("editorHasCodeActionsProvider",!1,nls.localize(13,null)),EditorContextKeys.hasCodeLensProvider=new contextkey_1.RawContextKey("editorHasCodeLensProvider",!1,nls.localize(14,null)),EditorContextKeys.hasDefinitionProvider=new contextkey_1.RawContextKey("editorHasDefinitionProvider",!1,nls.localize(15,null)),EditorContextKeys.hasDeclarationProvider=new contextkey_1.RawContextKey("editorHasDeclarationProvider",!1,nls.localize(16,null)),EditorContextKeys.hasImplementationProvider=new contextkey_1.RawContextKey("editorHasImplementationProvider",!1,nls.localize(17,null)),EditorContextKeys.hasTypeDefinitionProvider=new contextkey_1.RawContextKey("editorHasTypeDefinitionProvider",!1,nls.localize(18,null)),EditorContextKeys.hasHoverProvider=new contextkey_1.RawContextKey("editorHasHoverProvider",!1,nls.localize(19,null)),EditorContextKeys.hasDocumentHighlightProvider=new contextkey_1.RawContextKey("editorHasDocumentHighlightProvider",!1,nls.localize(20,null)),EditorContextKeys.hasDocumentSymbolProvider=new contextkey_1.RawContextKey("editorHasDocumentSymbolProvider",!1,nls.localize(21,null)),EditorContextKeys.hasReferenceProvider=new contextkey_1.RawContextKey("editorHasReferenceProvider",!1,nls.localize(22,null)),EditorContextKeys.hasRenameProvider=new contextkey_1.RawContextKey("editorHasRenameProvider",!1,nls.localize(23,null)),EditorContextKeys.hasSignatureHelpProvider=new contextkey_1.RawContextKey("editorHasSignatureHelpProvider",!1,nls.localize(24,null)),EditorContextKeys.hasInlayHintsProvider=new contextkey_1.RawContextKey("editorHasInlayHintsProvider",!1,nls.localize(25,null)),EditorContextKeys.hasDocumentFormattingProvider=new contextkey_1.RawContextKey("editorHasDocumentFormattingProvider",!1,nls.localize(26,null)),EditorContextKeys.hasDocumentSelectionFormattingProvider=new contextkey_1.RawContextKey("editorHasDocumentSelectionFormattingProvider",!1,nls.localize(27,null)),EditorContextKeys.hasMultipleDocumentFormattingProvider=new contextkey_1.RawContextKey("editorHasMultipleDocumentFormattingProvider",!1,nls.localize(28,null)),EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider=new contextkey_1.RawContextKey("editorHasMultipleDocumentSelectionFormattingProvider",!1,nls.localize(29,null))}(exports.EditorContextKeys||(exports.EditorContextKeys={}))})),define(__m[204],__M([1,0,21,13,19,25,11,27,56,26,17,20]),(function(require,exports,cancellation_1,errors_1,types_1,uri_1,position_1,languages,resolverService_1,commands_1,contextkey_1,languageFeatures_1){"use strict";function provideSignatureHelp(registry,model,position,context,token){return __awaiter(this,void 0,void 0,(function*(){const supports=registry.ordered(model);for(const support of supports)try{const result=yield support.provideSignatureHelp(model,position,token,context);if(result)return result}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}}))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.provideSignatureHelp=exports.Context=void 0,exports.Context={Visible:new contextkey_1.RawContextKey("parameterHintsVisible",!1),MultipleSignatures:new contextkey_1.RawContextKey("parameterHintsMultipleSignatures",!1)},exports.provideSignatureHelp=provideSignatureHelp,commands_1.CommandsRegistry.registerCommand("_executeSignatureHelpProvider",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri,position,triggerCharacter]=args;(0,types_1.assertType)(uri_1.URI.isUri(uri)),(0,types_1.assertType)(position_1.Position.isIPosition(position)),(0,types_1.assertType)("string"==typeof triggerCharacter||!triggerCharacter);const languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),ref=yield accessor.get(resolverService_1.ITextModelService).createModelReference(uri);try{const result=yield provideSignatureHelp(languageFeaturesService.signatureHelpProvider,ref.object.textEditorModel,position_1.Position.lift(position),{triggerKind:languages.SignatureHelpTriggerKind.Invoke,isRetrigger:!1,triggerCharacter},cancellation_1.CancellationToken.None);if(!result)return;return setTimeout((()=>result.dispose()),0),result.value}finally{ref.dispose()}}))))})),define(__m[611],__M([1,0,10,13,4,2,99,27,204]),(function(require,exports,async_1,errors_1,event_1,lifecycle_1,characterClassifier_1,languages,provideSignatureHelp_1){"use strict";var ParameterHintState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParameterHintsModel=void 0,function(ParameterHintState){ParameterHintState.Default={type:0};ParameterHintState.Pending=class Pending{constructor(request,previouslyActiveHints){this.request=request,this.previouslyActiveHints=previouslyActiveHints,this.type=2}};ParameterHintState.Active=class Active{constructor(hints){this.hints=hints,this.type=1}}}(ParameterHintState||(ParameterHintState={}));class ParameterHintsModel extends lifecycle_1.Disposable{constructor(editor,providers,delay=ParameterHintsModel.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new event_1.Emitter),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=ParameterHintState.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new lifecycle_1.MutableDisposable),this.triggerChars=new characterClassifier_1.CharacterSet,this.retriggerChars=new characterClassifier_1.CharacterSet,this.triggerId=0,this.editor=editor,this.providers=providers,this.throttledDelayer=new async_1.Delayer(delay),this._register(this.editor.onDidBlurEditorWidget((()=>this.cancel()))),this._register(this.editor.onDidChangeConfiguration((()=>this.onEditorConfigurationChange()))),this._register(this.editor.onDidChangeModel((e=>this.onModelChanged()))),this._register(this.editor.onDidChangeModelLanguage((_=>this.onModelChanged()))),this._register(this.editor.onDidChangeCursorSelection((e=>this.onCursorChange(e)))),this._register(this.editor.onDidChangeModelContent((e=>this.onModelContentChange()))),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType((text=>this.onDidType(text)))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(value){2===this._state.type&&this._state.request.cancel(),this._state=value}cancel(silent=!1){this.state=ParameterHintState.Default,this.throttledDelayer.cancel(),silent||this._onChangedHints.fire(void 0)}trigger(context,delay){const model=this.editor.getModel();if(!model||!this.providers.has(model))return;const triggerId=++this.triggerId;this._pendingTriggers.push(context),this.throttledDelayer.trigger((()=>this.doTrigger(triggerId)),delay).catch(errors_1.onUnexpectedError)}next(){if(1!==this.state.type)return;const length=this.state.hints.signatures.length,activeSignature=this.state.hints.activeSignature,last=activeSignature%length==length-1,cycle=this.editor.getOption(76).cycle;!(length<2||last)||cycle?this.updateActiveSignature(last&&cycle?0:activeSignature+1):this.cancel()}previous(){if(1!==this.state.type)return;const length=this.state.hints.signatures.length,activeSignature=this.state.hints.activeSignature,first=0===activeSignature,cycle=this.editor.getOption(76).cycle;!(length<2||first)||cycle?this.updateActiveSignature(first&&cycle?length-1:activeSignature-1):this.cancel()}updateActiveSignature(activeSignature){1===this.state.type&&(this.state=new ParameterHintState.Active(Object.assign(Object.assign({},this.state.hints),{activeSignature})),this._onChangedHints.fire(this.state.hints))}doTrigger(triggerId){return __awaiter(this,void 0,void 0,(function*(){const isRetrigger=1===this.state.type||2===this.state.type,activeSignatureHelp=this.getLastActiveHints();if(this.cancel(!0),0===this._pendingTriggers.length)return!1;const context=this._pendingTriggers.reduce(mergeTriggerContexts);this._pendingTriggers=[];const triggerContext={triggerKind:context.triggerKind,triggerCharacter:context.triggerCharacter,isRetrigger,activeSignatureHelp};if(!this.editor.hasModel())return!1;const model=this.editor.getModel(),position=this.editor.getPosition();this.state=new ParameterHintState.Pending((0,async_1.createCancelablePromise)((token=>(0,provideSignatureHelp_1.provideSignatureHelp)(this.providers,model,position,triggerContext,token))),activeSignatureHelp);try{const result=yield this.state.request;return triggerId!==this.triggerId?(null==result||result.dispose(),!1):result&&result.value.signatures&&0!==result.value.signatures.length?(this.state=new ParameterHintState.Active(result.value),this._lastSignatureHelpResult.value=result,this._onChangedHints.fire(this.state.hints),!0):(null==result||result.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1)}catch(error){return triggerId===this.triggerId&&(this.state=ParameterHintState.Default),(0,errors_1.onUnexpectedError)(error),!1}}))}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return 1===this.state.type||2===this.state.type||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars=new characterClassifier_1.CharacterSet,this.retriggerChars=new characterClassifier_1.CharacterSet;const model=this.editor.getModel();if(model)for(const support of this.providers.ordered(model)){for(const ch of support.signatureHelpTriggerCharacters||[])this.triggerChars.add(ch.charCodeAt(0)),this.retriggerChars.add(ch.charCodeAt(0));for(const ch of support.signatureHelpRetriggerCharacters||[])this.retriggerChars.add(ch.charCodeAt(0))}}onDidType(text){if(!this.triggerOnType)return;const lastCharIndex=text.length-1,triggerCharCode=text.charCodeAt(lastCharIndex);(this.triggerChars.has(triggerCharCode)||this.isTriggered&&this.retriggerChars.has(triggerCharCode))&&this.trigger({triggerKind:languages.SignatureHelpTriggerKind.TriggerCharacter,triggerCharacter:text.charAt(lastCharIndex)})}onCursorChange(e){"mouse"===e.source?this.cancel():this.isTriggered&&this.trigger({triggerKind:languages.SignatureHelpTriggerKind.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:languages.SignatureHelpTriggerKind.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(76).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}function mergeTriggerContexts(previous,current){switch(current.triggerKind){case languages.SignatureHelpTriggerKind.Invoke:return current;case languages.SignatureHelpTriggerKind.ContentChange:return previous;case languages.SignatureHelpTriggerKind.TriggerCharacter:default:return current}}exports.ParameterHintsModel=ParameterHintsModel,ParameterHintsModel.DEFAULT_DELAY=120})),define(__m[612],__M([1,0,17]),(function(require,exports,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestAlternatives=void 0;let SuggestAlternatives=class SuggestAlternatives{constructor(_editor,contextKeyService){this._editor=_editor,this._index=0,this._ckOtherSuggestions=SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService)}dispose(){this.reset()}reset(){var _a;this._ckOtherSuggestions.reset(),null===(_a=this._listener)||void 0===_a||_a.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model,index},acceptNext){if(0===model.items.length)return void this.reset();SuggestAlternatives._moveIndex(!0,model,index)!==index?(this._acceptNext=acceptNext,this._model=model,this._index=index,this._listener=this._editor.onDidChangeCursorPosition((()=>{this._ignore||this.reset()})),this._ckOtherSuggestions.set(!0)):this.reset()}static _moveIndex(fwd,model,index){let newIndex=index;for(;newIndex=(newIndex+model.items.length+(fwd?1:-1))%model.items.length,newIndex!==index&&model.items[newIndex].completion.additionalTextEdits;);return newIndex}next(){this._move(!0)}prev(){this._move(!1)}_move(fwd){if(this._model)try{this._ignore=!0,this._index=SuggestAlternatives._moveIndex(fwd,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};SuggestAlternatives.OtherSuggestions=new contextkey_1.RawContextKey("hasOtherSuggestions",!1),SuggestAlternatives=__decorate([__param(1,contextkey_1.IContextKeyService)],SuggestAlternatives),exports.SuggestAlternatives=SuggestAlternatives})),define(__m[613],__M([1,0,17]),(function(require,exports,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WordContextKey=void 0;let WordContextKey=class WordContextKey{constructor(_editor,contextKeyService){this._editor=_editor,this._enabled=!1,this._ckAtEnd=WordContextKey.AtEnd.bindTo(contextKeyService),this._configListener=this._editor.onDidChangeConfiguration((e=>e.hasChanged(111)&&this._update())),this._update()}dispose(){var _a;this._configListener.dispose(),null===(_a=this._selectionListener)||void 0===_a||_a.dispose(),this._ckAtEnd.reset()}_update(){const enabled="on"===this._editor.getOption(111);if(this._enabled!==enabled)if(this._enabled=enabled,this._enabled){const checkForWordEnd=()=>{if(!this._editor.hasModel())return void this._ckAtEnd.set(!1);const model=this._editor.getModel(),selection=this._editor.getSelection(),word=model.getWordAtPosition(selection.getStartPosition());word?this._ckAtEnd.set(word.endColumn===selection.getStartPosition().column):this._ckAtEnd.set(!1)};this._selectionListener=this._editor.onDidChangeCursorSelection(checkForWordEnd),checkForWordEnd()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};WordContextKey.AtEnd=new contextkey_1.RawContextKey("atEndOfWord",!1),WordContextKey=__decorate([__param(1,contextkey_1.IContextKeyService)],WordContextKey),exports.WordContextKey=WordContextKey})),define(__m[65],__M([1,0,17,9]),(function(require,exports,contextkey_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CONTEXT_ACCESSIBILITY_MODE_ENABLED=exports.IAccessibilityService=void 0,exports.IAccessibilityService=(0,instantiation_1.createDecorator)("accessibilityService"),exports.CONTEXT_ACCESSIBILITY_MODE_ENABLED=new contextkey_1.RawContextKey("accessibilityModeEnabled",!1)})),define(__m[614],__M([1,0,34,18,4,2,40,16,233,270,400,234,32,147,176,65]),(function(require,exports,browser,arrays,event_1,lifecycle_1,objects,platform,elementSizeObserver_1,fontMeasurements_1,migrateOptions_1,tabFocus_1,editorOptions_1,editorZoom_1,fontInfo_1,accessibility_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ComputedEditorOptions=exports.EditorConfiguration=void 0;let EditorConfiguration=class EditorConfiguration extends lifecycle_1.Disposable{constructor(isSimpleWidget,options,container,_accessibilityService){super(),this._accessibilityService=_accessibilityService,this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new event_1.Emitter),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._computeOptionsMemory=new editorOptions_1.ComputeOptionsMemory,this.isSimpleWidget=isSimpleWidget,this._containerObserver=this._register(new elementSizeObserver_1.ElementSizeObserver(container,options.dimension)),this._rawOptions=deepCloneAndMigrateOptions(options),this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(10)&&this._containerObserver.startObserving(),this._register(editorZoom_1.EditorZoom.onDidChangeZoomLevel((()=>this._recomputeOptions()))),this._register(tabFocus_1.TabFocus.onDidChangeTabFocus((()=>this._recomputeOptions()))),this._register(this._containerObserver.onDidChange((()=>this._recomputeOptions()))),this._register(fontMeasurements_1.FontMeasurements.onDidChange((()=>this._recomputeOptions()))),this._register(browser.PixelRatio.onDidChange((()=>this._recomputeOptions()))),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized((()=>this._recomputeOptions())))}_recomputeOptions(){const newOptions=this._computeOptions(),changeEvent=EditorOptionsUtil.checkEquals(this.options,newOptions);null!==changeEvent&&(this.options=newOptions,this._onDidChangeFast.fire(changeEvent),this._onDidChange.fire(changeEvent))}_computeOptions(){const partialEnv=this._readEnvConfiguration(),bareFontInfo=fontInfo_1.BareFontInfo.createFromValidatedSettings(this._validatedOptions,partialEnv.pixelRatio,this.isSimpleWidget),fontInfo=this._readFontInfo(bareFontInfo),env={memory:this._computeOptionsMemory,outerWidth:partialEnv.outerWidth,outerHeight:partialEnv.outerHeight-this._reservedHeight,fontInfo,extraEditorClassName:partialEnv.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:partialEnv.emptySelectionClipboard,pixelRatio:partialEnv.pixelRatio,tabFocusMode:tabFocus_1.TabFocus.getTabFocusMode(),accessibilitySupport:partialEnv.accessibilitySupport};return EditorOptionsUtil.computeOptions(this._validatedOptions,env)}_readEnvConfiguration(){return{extraEditorClassName:getExtraEditorClassName(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:browser.isWebKit||browser.isFirefox,pixelRatio:browser.PixelRatio.value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(bareFontInfo){return fontMeasurements_1.FontMeasurements.readFontInfo(bareFontInfo)}getRawOptions(){return this._rawOptions}updateOptions(_newOptions){const newOptions=deepCloneAndMigrateOptions(_newOptions);EditorOptionsUtil.applyUpdate(this._rawOptions,newOptions)&&(this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(dimension){this._containerObserver.observe(dimension)}setIsDominatedByLongLines(isDominatedByLongLines){this._isDominatedByLongLines!==isDominatedByLongLines&&(this._isDominatedByLongLines=isDominatedByLongLines,this._recomputeOptions())}setModelLineCount(modelLineCount){const lineNumbersDigitCount=function digitCount(n){let r=0;for(;n;)n=Math.floor(n/10),r++;return r||1}(modelLineCount);this._lineNumbersDigitCount!==lineNumbersDigitCount&&(this._lineNumbersDigitCount=lineNumbersDigitCount,this._recomputeOptions())}setViewLineCount(viewLineCount){this._viewLineCount!==viewLineCount&&(this._viewLineCount=viewLineCount,this._recomputeOptions())}setReservedHeight(reservedHeight){this._reservedHeight!==reservedHeight&&(this._reservedHeight=reservedHeight,this._recomputeOptions())}};function getExtraEditorClassName(){let extra="";return browser.isSafari||browser.isWebkitWebView||(extra+="no-user-select "),browser.isSafari&&(extra+="no-minimap-shadow "),platform.isMacintosh&&(extra+="mac "),extra}EditorConfiguration=__decorate([__param(3,accessibility_1.IAccessibilityService)],EditorConfiguration),exports.EditorConfiguration=EditorConfiguration;class ValidatedEditorOptions{constructor(){this._values=[]}_read(option){return this._values[option]}get(id){return this._values[id]}_write(option,value){this._values[option]=value}}class ComputedEditorOptions{constructor(){this._values=[]}_read(id){if(id>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[id]}get(id){return this._read(id)}_write(id,value){this._values[id]=value}}exports.ComputedEditorOptions=ComputedEditorOptions;class EditorOptionsUtil{static validateOptions(options){const result=new ValidatedEditorOptions;for(const editorOption of editorOptions_1.editorOptionsRegistry){const value="_never_"===editorOption.name?void 0:options[editorOption.name];result._write(editorOption.id,editorOption.validate(value))}return result}static computeOptions(options,env){const result=new ComputedEditorOptions;for(const editorOption of editorOptions_1.editorOptionsRegistry)result._write(editorOption.id,editorOption.compute(env,result,options._read(editorOption.id)));return result}static _deepEquals(a,b){if("object"!=typeof a||"object"!=typeof b||!a||!b)return a===b;if(Array.isArray(a)||Array.isArray(b))return!(!Array.isArray(a)||!Array.isArray(b))&&arrays.equals(a,b);if(Object.keys(a).length!==Object.keys(b).length)return!1;for(const key in a)if(!EditorOptionsUtil._deepEquals(a[key],b[key]))return!1;return!0}static checkEquals(a,b){const result=[];let somethingChanged=!1;for(const editorOption of editorOptions_1.editorOptionsRegistry){const changed=!EditorOptionsUtil._deepEquals(a._read(editorOption.id),b._read(editorOption.id));result[editorOption.id]=changed,changed&&(somethingChanged=!0)}return somethingChanged?new editorOptions_1.ConfigurationChangedEvent(result):null}static applyUpdate(options,update){let changed=!1;for(const editorOption of editorOptions_1.editorOptionsRegistry)if(update.hasOwnProperty(editorOption.name)){const result=editorOption.applyUpdate(options[editorOption.name],update[editorOption.name]);options[editorOption.name]=result.newValue,changed=changed||result.didChange}return changed}}function deepCloneAndMigrateOptions(_options){const options=objects.deepClone(_options);return(0,migrateOptions_1.migrateOptions)(options),options}})),define(__m[615],__M([1,0,4,2,65,41,17]),(function(require,exports,event_1,lifecycle_1,accessibility_1,configuration_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessibilityService=void 0;let AccessibilityService=class AccessibilityService extends lifecycle_1.Disposable{constructor(_contextKeyService,_configurationService){super(),this._contextKeyService=_contextKeyService,this._configurationService=_configurationService,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new event_1.Emitter,this._accessibilityModeEnabledContext=accessibility_1.CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);const updateContextKey=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.accessibilitySupport")&&(updateContextKey(),this._onDidChangeScreenReaderOptimized.fire())}))),updateContextKey(),this.onDidChangeScreenReaderOptimized((()=>updateContextKey()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const config=this._configurationService.getValue("editor.accessibilitySupport");return"on"===config||"auto"===config&&2===this._accessibilitySupport}getAccessibilitySupport(){return this._accessibilitySupport}};AccessibilityService=__decorate([__param(0,contextkey_1.IContextKeyService),__param(1,configuration_1.IConfigurationService)],AccessibilityService),exports.AccessibilityService=AccessibilityService})),define(__m[616],__M([1,0,4,57,2,49,591,26,41,17]),(function(require,exports,event_1,iterator_1,lifecycle_1,map_1,nls_1,commands_1,configuration_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextKeyService=exports.AbstractContextKeyService=exports.Context=void 0;class Context{constructor(id,parent){this._id=id,this._parent=parent,this._value=Object.create(null),this._value._contextId=id}setValue(key,value){return this._value[key]!==value&&(this._value[key]=value,!0)}removeValue(key){return key in this._value&&(delete this._value[key],!0)}getValue(key){const ret=this._value[key];return void 0===ret&&this._parent?this._parent.getValue(key):ret}}exports.Context=Context;class NullContext extends Context{constructor(){super(-1,null)}setValue(key,value){return!1}removeValue(key){return!1}getValue(key){}}NullContext.INSTANCE=new NullContext;class ConfigAwareContextValuesContainer extends Context{constructor(id,_configurationService,emitter){super(id,null),this._configurationService=_configurationService,this._values=map_1.TernarySearchTree.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration((event=>{if(6===event.source){const allKeys=Array.from(iterator_1.Iterable.map(this._values,(([k])=>k)));this._values.clear(),emitter.fire(new ArrayContextKeyChangeEvent(allKeys))}else{const changedKeys=[];for(const configKey of event.affectedKeys){const contextKey=`config.${configKey}`,cachedItems=this._values.findSuperstr(contextKey);void 0!==cachedItems&&(changedKeys.push(...iterator_1.Iterable.map(cachedItems,(([key])=>key))),this._values.deleteSuperstr(contextKey)),this._values.has(contextKey)&&(changedKeys.push(contextKey),this._values.delete(contextKey))}emitter.fire(new ArrayContextKeyChangeEvent(changedKeys))}}))}dispose(){this._listener.dispose()}getValue(key){if(0!==key.indexOf(ConfigAwareContextValuesContainer._keyPrefix))return super.getValue(key);if(this._values.has(key))return this._values.get(key);const configKey=key.substr(ConfigAwareContextValuesContainer._keyPrefix.length),configValue=this._configurationService.getValue(configKey);let value;switch(typeof configValue){case"number":case"boolean":case"string":value=configValue;break;default:value=Array.isArray(configValue)?JSON.stringify(configValue):configValue}return this._values.set(key,value),value}setValue(key,value){return super.setValue(key,value)}removeValue(key){return super.removeValue(key)}}ConfigAwareContextValuesContainer._keyPrefix="config.";class ContextKey{constructor(service,key,defaultValue){this._service=service,this._key=key,this._defaultValue=defaultValue,this.reset()}set(value){this._service.setContext(this._key,value)}reset(){void 0===this._defaultValue?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class SimpleContextKeyChangeEvent{constructor(key){this.key=key}affectsSome(keys){return keys.has(this.key)}}class ArrayContextKeyChangeEvent{constructor(keys){this.keys=keys}affectsSome(keys){for(const key of this.keys)if(keys.has(key))return!0;return!1}}class CompositeContextKeyChangeEvent{constructor(events){this.events=events}affectsSome(keys){for(const e of this.events)if(e.affectsSome(keys))return!0;return!1}}class AbstractContextKeyService{constructor(myContextId){this._onDidChangeContext=new event_1.PauseableEmitter({merge:input=>new CompositeContextKeyChangeEvent(input)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=myContextId}createKey(key,defaultValue){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ContextKey(this,key,defaultValue)}bufferChangeEvents(callback){this._onDidChangeContext.pause();try{callback()}finally{this._onDidChangeContext.resume()}}createScoped(domNode){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ScopedContextKeyService(this,domNode)}contextMatchesRules(rules){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const context=this.getContextValuesContainer(this._myContextId);return!rules||rules.evaluate(context)}getContextKeyValue(key){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(key)}setContext(key,value){if(this._isDisposed)return;const myContext=this.getContextValuesContainer(this._myContextId);myContext&&myContext.setValue(key,value)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key))}removeContext(key){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(key)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key))}getContext(target){return this._isDisposed?NullContext.INSTANCE:this.getContextValuesContainer(function findContextAttr(domNode){for(;domNode;){if(domNode.hasAttribute("data-keybinding-context")){const attr=domNode.getAttribute("data-keybinding-context");return attr?parseInt(attr,10):NaN}domNode=domNode.parentElement}return 0}(target))}}exports.AbstractContextKeyService=AbstractContextKeyService;let ContextKeyService=class ContextKeyService extends AbstractContextKeyService{constructor(configurationService){super(0),this._contexts=new Map,this._toDispose=new lifecycle_1.DisposableStore,this._lastContextId=0;const myContext=new ConfigAwareContextValuesContainer(this._myContextId,configurationService,this._onDidChangeContext);this._contexts.set(this._myContextId,myContext),this._toDispose.add(myContext)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(contextId){return this._isDisposed?NullContext.INSTANCE:this._contexts.get(contextId)||NullContext.INSTANCE}createChildContext(parentContextId=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");let id=++this._lastContextId;return this._contexts.set(id,new Context(id,this.getContextValuesContainer(parentContextId))),id}disposeContext(contextId){this._isDisposed||this._contexts.delete(contextId)}};ContextKeyService=__decorate([__param(0,configuration_1.IConfigurationService)],ContextKeyService),exports.ContextKeyService=ContextKeyService;class ScopedContextKeyService extends AbstractContextKeyService{constructor(parent,domNode){if(super(parent.createChildContext()),this._parentChangeListener=new lifecycle_1.MutableDisposable,this._parent=parent,this._updateParentChangeListener(),this._domNode=domNode,this._domNode.hasAttribute("data-keybinding-context")){let extraInfo="";this._domNode.classList&&(extraInfo=Array.from(this._domNode.classList.values()).join(", ")),console.error("Element already has context attribute"+(extraInfo?": "+extraInfo:""))}this._domNode.setAttribute("data-keybinding-context",String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(this._onDidChangeContext.fire,this._onDidChangeContext)}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute("data-keybinding-context"),this._isDisposed=!0)}getContextValuesContainer(contextId){return this._isDisposed?NullContext.INSTANCE:this._parent.getContextValuesContainer(contextId)}createChildContext(parentContextId=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(parentContextId)}disposeContext(contextId){this._isDisposed||this._parent.disposeContext(contextId)}}commands_1.CommandsRegistry.registerCommand(contextkey_1.SET_CONTEXT_COMMAND_ID,(function(accessor,contextKey,contextValue){accessor.get(contextkey_1.IContextKeyService).createKey(String(contextKey),contextValue)})),commands_1.CommandsRegistry.registerCommand({id:"getContextKeyInfo",handler:()=>[...contextkey_1.RawContextKey.all()].sort(((a,b)=>a.key.localeCompare(b.key))),description:{description:(0,nls_1.localize)(0,null),args:[]}}),commands_1.CommandsRegistry.registerCommand("_generateContextKeyInfo",(function(){const result=[],seen=new Set;for(let info of contextkey_1.RawContextKey.all())seen.has(info.key)||(seen.add(info.key),result.push(info));result.sort(((a,b)=>a.key.localeCompare(b.key))),console.log(JSON.stringify(result,void 0,2))}))})),define(__m[278],__M([1,0,16,592,17]),(function(require,exports,platform_1,nls_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InputFocusedContext=exports.InputFocusedContextKey=exports.IsDevelopmentContext=exports.IsIOSContext=exports.IsMacNativeContext=exports.IsWebContext=exports.IsWindowsContext=exports.IsLinuxContext=exports.IsMacContext=void 0,exports.IsMacContext=new contextkey_1.RawContextKey("isMac",platform_1.isMacintosh,(0,nls_1.localize)(0,null)),exports.IsLinuxContext=new contextkey_1.RawContextKey("isLinux",platform_1.isLinux,(0,nls_1.localize)(1,null)),exports.IsWindowsContext=new contextkey_1.RawContextKey("isWindows",platform_1.isWindows,(0,nls_1.localize)(2,null)),exports.IsWebContext=new contextkey_1.RawContextKey("isWeb",platform_1.isWeb,(0,nls_1.localize)(3,null)),exports.IsMacNativeContext=new contextkey_1.RawContextKey("isMacNative",platform_1.isMacintosh&&!platform_1.isWeb,(0,nls_1.localize)(4,null)),exports.IsIOSContext=new contextkey_1.RawContextKey("isIOS",platform_1.isIOS,(0,nls_1.localize)(5,null)),exports.IsDevelopmentContext=new contextkey_1.RawContextKey("isDevelopment",!1,!0),exports.InputFocusedContextKey="inputFocus",exports.InputFocusedContext=new contextkey_1.RawContextKey(exports.InputFocusedContextKey,!1,(0,nls_1.localize)(6,null))})),define(__m[78],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IContextMenuService=exports.IContextViewService=void 0,exports.IContextViewService=(0,instantiation_1.createDecorator)("contextViewService"),exports.IContextMenuService=(0,instantiation_1.createDecorator)("contextMenuService")})),define(__m[130],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IDialogService=void 0,exports.IDialogService=(0,instantiation_1.createDecorator)("dialogService")})),define(__m[157],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServiceCollection=void 0;exports.ServiceCollection=class ServiceCollection{constructor(...entries){this._entries=new Map;for(let[id,service]of entries)this.set(id,service)}set(id,instanceOrDescriptor){const result=this._entries.get(id);return this._entries.set(id,instanceOrDescriptor),result}get(id){return this._entries.get(id)}}})),define(__m[617],__M([1,0,10,13,199,606,9,157]),(function(require,exports,async_1,errors_1,descriptors_1,graph_1,instantiation_1,serviceCollection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Trace=exports.InstantiationService=void 0;class CyclicDependencyError extends Error{constructor(graph){var _a;super("cyclic dependency between services"),this.message=null!==(_a=graph.findCycleSlow())&&void 0!==_a?_a:`UNABLE to detect cycle, dumping graph: \n${graph.toString()}`}}class InstantiationService{constructor(services=new serviceCollection_1.ServiceCollection,strict=!1,parent){this._activeInstantiations=new Set,this._services=services,this._strict=strict,this._parent=parent,this._services.set(instantiation_1.IInstantiationService,this)}createChild(services){return new InstantiationService(services,this._strict,this)}invokeFunction(fn,...args){let _trace=Trace.traceInvocation(fn),_done=!1;try{return fn({get:id=>{if(_done)throw(0,errors_1.illegalState)("service accessor is only valid during the invocation of its target method");const result=this._getOrCreateServiceInstance(id,_trace);if(!result)throw new Error(`[invokeFunction] unknown service '${id}'`);return result}},...args)}finally{_done=!0,_trace.stop()}}createInstance(ctorOrDescriptor,...rest){let _trace,result;return ctorOrDescriptor instanceof descriptors_1.SyncDescriptor?(_trace=Trace.traceCreation(ctorOrDescriptor.ctor),result=this._createInstance(ctorOrDescriptor.ctor,ctorOrDescriptor.staticArguments.concat(rest),_trace)):(_trace=Trace.traceCreation(ctorOrDescriptor),result=this._createInstance(ctorOrDescriptor,rest,_trace)),_trace.stop(),result}_createInstance(ctor,args=[],_trace){let serviceDependencies=instantiation_1._util.getServiceDependencies(ctor).sort(((a,b)=>a.index-b.index)),serviceArgs=[];for(const dependency of serviceDependencies){let service=this._getOrCreateServiceInstance(dependency.id,_trace);service||this._throwIfStrict(`[createInstance] ${ctor.name} depends on UNKNOWN service ${dependency.id}.`,!1),serviceArgs.push(service)}let firstServiceArgPos=serviceDependencies.length>0?serviceDependencies[0].index:args.length;if(args.length!==firstServiceArgPos){console.warn(`[createInstance] First service dependency of ${ctor.name} at position ${firstServiceArgPos+1} conflicts with ${args.length} static arguments`);let delta=firstServiceArgPos-args.length;args=delta>0?args.concat(new Array(delta)):args.slice(0,firstServiceArgPos)}return new ctor(...[...args,...serviceArgs])}_setServiceInstance(id,instance){if(this._services.get(id)instanceof descriptors_1.SyncDescriptor)this._services.set(id,instance);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setServiceInstance(id,instance)}}_getServiceInstanceOrDescriptor(id){let instanceOrDesc=this._services.get(id);return!instanceOrDesc&&this._parent?this._parent._getServiceInstanceOrDescriptor(id):instanceOrDesc}_getOrCreateServiceInstance(id,_trace){let thing=this._getServiceInstanceOrDescriptor(id);return thing instanceof descriptors_1.SyncDescriptor?this._safeCreateAndCacheServiceInstance(id,thing,_trace.branch(id,!0)):(_trace.branch(id,!1),thing)}_safeCreateAndCacheServiceInstance(id,desc,_trace){if(this._activeInstantiations.has(id))throw new Error(`illegal state - RECURSIVELY instantiating service '${id}'`);this._activeInstantiations.add(id);try{return this._createAndCacheServiceInstance(id,desc,_trace)}finally{this._activeInstantiations.delete(id)}}_createAndCacheServiceInstance(id,desc,_trace){const graph=new graph_1.Graph((data=>data.id.toString()));let cycleCount=0;const stack=[{id,desc,_trace}];for(;stack.length;){const item=stack.pop();if(graph.lookupOrInsertNode(item),cycleCount++>1e3)throw new CyclicDependencyError(graph);for(let dependency of instantiation_1._util.getServiceDependencies(item.desc.ctor)){let instanceOrDesc=this._getServiceInstanceOrDescriptor(dependency.id);if(instanceOrDesc||this._throwIfStrict(`[createInstance] ${id} depends on ${dependency.id} which is NOT registered.`,!0),instanceOrDesc instanceof descriptors_1.SyncDescriptor){const d={id:dependency.id,desc:instanceOrDesc,_trace:item._trace.branch(dependency.id,!0)};graph.insertEdge(item,d),stack.push(d)}}}for(;;){const roots=graph.roots();if(0===roots.length){if(!graph.isEmpty())throw new CyclicDependencyError(graph);break}for(const{data}of roots){if(this._getServiceInstanceOrDescriptor(data.id)instanceof descriptors_1.SyncDescriptor){const instance=this._createServiceInstanceWithOwner(data.id,data.desc.ctor,data.desc.staticArguments,data.desc.supportsDelayedInstantiation,data._trace);this._setServiceInstance(data.id,instance)}graph.removeNode(data)}}return this._getServiceInstanceOrDescriptor(id)}_createServiceInstanceWithOwner(id,ctor,args=[],supportsDelayedInstantiation,_trace){if(this._services.get(id)instanceof descriptors_1.SyncDescriptor)return this._createServiceInstance(ctor,args,supportsDelayedInstantiation,_trace);if(this._parent)return this._parent._createServiceInstanceWithOwner(id,ctor,args,supportsDelayedInstantiation,_trace);throw new Error(`illegalState - creating UNKNOWN service instance ${ctor.name}`)}_createServiceInstance(ctor,args=[],_supportsDelayedInstantiation,_trace){if(_supportsDelayedInstantiation){const idle=new async_1.IdleValue((()=>this._createInstance(ctor,args,_trace)));return new Proxy(Object.create(null),{get(target,key){if(key in target)return target[key];let obj=idle.value,prop=obj[key];return"function"!=typeof prop||(prop=prop.bind(obj),target[key]=prop),prop},set:(_target,p,value)=>(idle.value[p]=value,!0)})}return this._createInstance(ctor,args,_trace)}_throwIfStrict(msg,printWarning){if(printWarning&&console.warn(printWarning),this._strict)throw new Error(msg)}}exports.InstantiationService=InstantiationService;class Trace{constructor(type,name){this.type=type,this.name=name,this._start=Date.now(),this._dep=[]}static traceInvocation(ctor){return Trace._None}static traceCreation(ctor){return Trace._None}branch(id,first){let child=new Trace(2,id.toString());return this._dep.push([id,first,child]),child}stop(){let dur=Date.now()-this._start;Trace._totals+=dur;let causedCreation=!1;let lines=[`${0===this.type?"CREATE":"CALL"} ${this.name}`,`${function printChild(n,trace){let res=[],prefix=new Array(n+1).join("\t");for(const[id,first,child]of trace._dep)if(first&&child){causedCreation=!0,res.push(`${prefix}CREATES -> ${id}`);let nested=printChild(n+1,child);nested&&res.push(nested)}else res.push(`${prefix}uses -> ${id}`);return res.join("\n")}(1,this)}`,`DONE, took ${dur.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`];(dur>2||causedCreation)&&console.log(lines.join("\n"))}}exports.Trace=Trace,Trace._None=new class extends Trace{constructor(){super(-1,null)}stop(){}branch(){return this}},Trace._totals=0})),define(__m[618],__M([1,0,10,4,2,594]),(function(require,exports,async_1,event_1,lifecycle_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractKeybindingService=void 0;const HIGH_FREQ_COMMANDS=/^(cursor|delete)/;class AbstractKeybindingService extends lifecycle_1.Disposable{constructor(_contextKeyService,_commandService,_telemetryService,_notificationService,_logService){super(),this._contextKeyService=_contextKeyService,this._commandService=_commandService,this._telemetryService=_telemetryService,this._notificationService=_notificationService,this._logService=_logService,this._onDidUpdateKeybindings=this._register(new event_1.Emitter),this._currentChord=null,this._currentChordChecker=new async_1.IntervalTimer,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new async_1.TimeoutTimer,this._logging=!1}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:event_1.Event.None}dispose(){super.dispose()}_log(str){this._logging&&this._logService.info(`[KeybindingService]: ${str}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(commandId,context){const result=this._getResolver().lookupPrimaryKeybinding(commandId,context||this._contextKeyService);if(result)return result.resolvedKeybinding}dispatchEvent(e,target){return this._dispatch(e,target)}softDispatch(e,target){const keybinding=this.resolveKeyboardEvent(e);if(keybinding.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null;const[firstPart]=keybinding.getDispatchParts();if(null===firstPart)return null;const contextValue=this._contextKeyService.getContext(target),currentChord=this._currentChord?this._currentChord.keypress:null;return this._getResolver().resolve(contextValue,currentChord,firstPart)}_enterChordMode(firstPart,keypressLabel){this._currentChord={keypress:firstPart,label:keypressLabel},this._currentChordStatusMessage=this._notificationService.status(nls.localize(0,null,keypressLabel));const chordEnterTime=Date.now();this._currentChordChecker.cancelAndSet((()=>{this._documentHasFocus()?Date.now()-chordEnterTime>5e3&&this._leaveChordMode():this._leaveChordMode()}),500)}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChord=null}_dispatch(e,target){return this._doDispatch(this.resolveKeyboardEvent(e),target,!1)}_singleModifierDispatch(e,target){const keybinding=this.resolveKeyboardEvent(e),[singleModifier]=keybinding.getSingleModifierDispatchParts();if(singleModifier)return this._ignoreSingleModifiers.has(singleModifier)?(this._log(`+ Ignoring single modifier ${singleModifier} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,null===this._currentSingleModifier?(this._log(`+ Storing single modifier for possible chord ${singleModifier}.`),this._currentSingleModifier=singleModifier,this._currentSingleModifierClearTimeout.cancelAndSet((()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null}),300),!1):singleModifier===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${singleModifier} ${singleModifier}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(keybinding,target,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${singleModifier}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[firstPart]=keybinding.getParts();return this._ignoreSingleModifiers=new KeybindingModifierSet(firstPart),null!==this._currentSingleModifier&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(keybinding,target,isSingleModiferChord=!1){let shouldPreventDefault=!1;if(keybinding.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),!1;let firstPart=null,currentChord=null;if(isSingleModiferChord){const[dispatchKeyname]=keybinding.getSingleModifierDispatchParts();firstPart=dispatchKeyname,currentChord=dispatchKeyname}else[firstPart]=keybinding.getDispatchParts(),currentChord=this._currentChord?this._currentChord.keypress:null;if(null===firstPart)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),shouldPreventDefault;const contextValue=this._contextKeyService.getContext(target),keypressLabel=keybinding.getLabel(),resolveResult=this._getResolver().resolve(contextValue,currentChord,firstPart);return this._logService.trace("KeybindingService#dispatch",keypressLabel,null==resolveResult?void 0:resolveResult.commandId),resolveResult&&resolveResult.enterChord?(shouldPreventDefault=!0,this._enterChordMode(firstPart,keypressLabel),shouldPreventDefault):(this._currentChord&&(resolveResult&&resolveResult.commandId||(this._notificationService.status(nls.localize(1,null,this._currentChord.label,keypressLabel),{hideAfter:1e4}),shouldPreventDefault=!0)),this._leaveChordMode(),resolveResult&&resolveResult.commandId&&(resolveResult.bubble||(shouldPreventDefault=!0),void 0===resolveResult.commandArgs?this._commandService.executeCommand(resolveResult.commandId).then(void 0,(err=>this._notificationService.warn(err))):this._commandService.executeCommand(resolveResult.commandId,resolveResult.commandArgs).then(void 0,(err=>this._notificationService.warn(err))),HIGH_FREQ_COMMANDS.test(resolveResult.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:resolveResult.commandId,from:"keybinding"})),shouldPreventDefault)}mightProducePrintableCharacter(event){return!event.ctrlKey&&!event.metaKey&&(event.keyCode>=31&&event.keyCode<=56||event.keyCode>=21&&event.keyCode<=30)}}exports.AbstractKeybindingService=AbstractKeybindingService;class KeybindingModifierSet{constructor(source){this._ctrlKey=!!source&&source.ctrlKey,this._shiftKey=!!source&&source.shiftKey,this._altKey=!!source&&source.altKey,this._metaKey=!!source&&source.metaKey}has(modifier){switch(modifier){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}KeybindingModifierSet.EMPTY=new KeybindingModifierSet(null)})),define(__m[619],__M([1,0,13,198,96]),(function(require,exports,errors_1,keybindingLabels_1,keybindings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseResolvedKeybinding=void 0;class BaseResolvedKeybinding extends keybindings_1.ResolvedKeybinding{constructor(os,parts){if(super(),0===parts.length)throw(0,errors_1.illegalArgument)("parts");this._os=os,this._parts=parts}getLabel(){return keybindingLabels_1.UILabelProvider.toLabel(this._os,this._parts,(keybinding=>this._getLabel(keybinding)))}getAriaLabel(){return keybindingLabels_1.AriaLabelProvider.toLabel(this._os,this._parts,(keybinding=>this._getAriaLabel(keybinding)))}getElectronAccelerator(){return this._parts.length>1||this._parts[0].isDuplicateModifierCase()?null:keybindingLabels_1.ElectronAcceleratorLabelProvider.toLabel(this._os,this._parts,(keybinding=>this._getElectronAccelerator(keybinding)))}isChord(){return this._parts.length>1}getParts(){return this._parts.map((keybinding=>this._getPart(keybinding)))}_getPart(keybinding){return new keybindings_1.ResolvedKeybindingPart(keybinding.ctrlKey,keybinding.shiftKey,keybinding.altKey,keybinding.metaKey,this._getLabel(keybinding),this._getAriaLabel(keybinding))}getDispatchParts(){return this._parts.map((keybinding=>this._getDispatchPart(keybinding)))}getSingleModifierDispatchParts(){return this._parts.map((keybinding=>this._getSingleModifierDispatchPart(keybinding)))}}exports.BaseResolvedKeybinding=BaseResolvedKeybinding})),define(__m[43],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IKeybindingService=void 0,exports.IKeybindingService=(0,instantiation_1.createDecorator)("keybindingService")})),define(__m[620],__M([1,0,17]),(function(require,exports,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeybindingResolver=void 0;class KeybindingResolver{constructor(defaultKeybindings,overrides,log){this._log=log,this._defaultKeybindings=defaultKeybindings,this._defaultBoundCommands=new Map;for(const defaultKeybinding of defaultKeybindings){const command=defaultKeybinding.command;command&&"-"!==command.charAt(0)&&this._defaultBoundCommands.set(command,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=KeybindingResolver.handleRemovals([].concat(defaultKeybindings).concat(overrides));for(let i=0,len=this._keybindings.length;i<len;i++){let k=this._keybindings[i];0!==k.keypressParts.length&&(k.when&&0===k.when.type||this._addKeyPress(k.keypressParts[0],k))}}static _isTargetedForRemoval(defaultKb,keypressFirstPart,keypressChordPart,when){if(keypressFirstPart&&defaultKb.keypressParts[0]!==keypressFirstPart)return!1;if(keypressChordPart&&defaultKb.keypressParts[1]!==keypressChordPart)return!1;if(when){if(!defaultKb.when)return!1;if(!(0,contextkey_1.expressionsAreEqualWithConstantSubstitution)(when,defaultKb.when))return!1}return!0}static handleRemovals(rules){const removals=new Map;for(let i=0,len=rules.length;i<len;i++){const rule=rules[i];if(rule.command&&"-"===rule.command.charAt(0)){const command=rule.command.substring(1);removals.has(command)?removals.get(command).push(rule):removals.set(command,[rule])}}if(0===removals.size)return rules;const result=[];for(let i=0,len=rules.length;i<len;i++){const rule=rules[i];if(!rule.command||0===rule.command.length){result.push(rule);continue}if("-"===rule.command.charAt(0))continue;const commandRemovals=removals.get(rule.command);if(!commandRemovals||!rule.isDefault){result.push(rule);continue}let isRemoved=!1;for(const commandRemoval of commandRemovals){const keypressFirstPart=commandRemoval.keypressParts[0],keypressChordPart=commandRemoval.keypressParts[1],when=commandRemoval.when;if(this._isTargetedForRemoval(rule,keypressFirstPart,keypressChordPart,when)){isRemoved=!0;break}}isRemoved||result.push(rule)}return result}_addKeyPress(keypress,item){const conflicts=this._map.get(keypress);if(void 0===conflicts)return this._map.set(keypress,[item]),void this._addToLookupMap(item);for(let i=conflicts.length-1;i>=0;i--){let conflict=conflicts[i];if(conflict.command===item.command)continue;const conflictIsChord=conflict.keypressParts.length>1,itemIsChord=item.keypressParts.length>1;conflictIsChord&&itemIsChord&&conflict.keypressParts[1]!==item.keypressParts[1]||KeybindingResolver.whenIsEntirelyIncluded(conflict.when,item.when)&&this._removeFromLookupMap(conflict)}conflicts.push(item),this._addToLookupMap(item)}_addToLookupMap(item){if(!item.command)return;let arr=this._lookupMap.get(item.command);void 0===arr?(arr=[item],this._lookupMap.set(item.command,arr)):arr.push(item)}_removeFromLookupMap(item){if(!item.command)return;let arr=this._lookupMap.get(item.command);if(void 0!==arr)for(let i=0,len=arr.length;i<len;i++)if(arr[i]===item)return void arr.splice(i,1)}static whenIsEntirelyIncluded(a,b){return!b||1===b.type||!(!a||1===a.type)&&(0,contextkey_1.implies)(a,b)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(commandId,context){const items=this._lookupMap.get(commandId);if(void 0===items||0===items.length)return null;if(1===items.length)return items[0];for(let i=items.length-1;i>=0;i--){const item=items[i];if(context.contextMatchesRules(item.when))return item}return items[items.length-1]}resolve(context,currentChord,keypress){this._log(`| Resolving ${keypress}${currentChord?` chorded from ${currentChord}`:""}`);let lookupMap=null;if(null!==currentChord){const candidates=this._map.get(currentChord);if(void 0===candidates)return this._log("\\ No keybinding entries."),null;lookupMap=[];for(let i=0,len=candidates.length;i<len;i++){let candidate=candidates[i];candidate.keypressParts[1]===keypress&&lookupMap.push(candidate)}}else{const candidates=this._map.get(keypress);if(void 0===candidates)return this._log("\\ No keybinding entries."),null;lookupMap=candidates}let result=this._findCommand(context,lookupMap);return result?null===currentChord&&result.keypressParts.length>1&&null!==result.keypressParts[1]?(this._log(`\\ From ${lookupMap.length} keybinding entries, matched chord, when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`),{enterChord:!0,leaveChord:!1,commandId:null,commandArgs:null,bubble:!1}):(this._log(`\\ From ${lookupMap.length} keybinding entries, matched ${result.command}, when: ${printWhenExplanation(result.when)}, source: ${printSourceExplanation(result)}.`),{enterChord:!1,leaveChord:result.keypressParts.length>1,commandId:result.command,commandArgs:result.commandArgs,bubble:result.bubble}):(this._log(`\\ From ${lookupMap.length} keybinding entries, no when clauses matched the context.`),null)}_findCommand(context,matches){for(let i=matches.length-1;i>=0;i--){let k=matches[i];if(KeybindingResolver._contextMatchesRules(context,k.when))return k}return null}static _contextMatchesRules(context,rules){return!rules||rules.evaluate(context)}}function printWhenExplanation(when){return when?`${when.serialize()}`:"no when condition"}function printSourceExplanation(kb){return kb.extensionId?kb.isBuiltinExtension?`built-in extension ${kb.extensionId}`:`user extension ${kb.extensionId}`:kb.isDefault?"built-in":"user"}exports.KeybindingResolver=KeybindingResolver})),define(__m[279],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeElementsAfterNulls=exports.ResolvedKeybindingItem=void 0;function removeElementsAfterNulls(arr){let result=[];for(let i=0,len=arr.length;i<len;i++){const element=arr[i];if(!element)return result;result.push(element)}return result}exports.ResolvedKeybindingItem=class ResolvedKeybindingItem{constructor(resolvedKeybinding,command,commandArgs,when,isDefault,extensionId,isBuiltinExtension){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=resolvedKeybinding,this.keypressParts=resolvedKeybinding?removeElementsAfterNulls(resolvedKeybinding.getDispatchParts()):[],resolvedKeybinding&&0===this.keypressParts.length&&(this.keypressParts=removeElementsAfterNulls(resolvedKeybinding.getSingleModifierDispatchParts())),this.bubble=!!command&&94===command.charCodeAt(0),this.command=this.bubble?command.substr(1):command,this.commandArgs=commandArgs,this.when=when,this.isDefault=isDefault,this.extensionId=extensionId,this.isBuiltinExtension=isBuiltinExtension}},exports.removeElementsAfterNulls=removeElementsAfterNulls})),define(__m[621],__M([1,0,58,96,619,279]),(function(require,exports,keyCodes_1,keybindings_1,baseResolvedKeybinding_1,resolvedKeybindingItem_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.USLayoutResolvedKeybinding=void 0;class USLayoutResolvedKeybinding extends baseResolvedKeybinding_1.BaseResolvedKeybinding{constructor(actual,os){super(os,actual.parts)}_keyCodeToUILabel(keyCode){if(2===this._os)switch(keyCode){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return keyCodes_1.KeyCodeUtils.toString(keyCode)}_getLabel(keybinding){return keybinding.isDuplicateModifierCase()?"":this._keyCodeToUILabel(keybinding.keyCode)}_getAriaLabel(keybinding){return keybinding.isDuplicateModifierCase()?"":keyCodes_1.KeyCodeUtils.toString(keybinding.keyCode)}_getElectronAccelerator(keybinding){return keyCodes_1.KeyCodeUtils.toElectronAccelerator(keybinding.keyCode)}_getDispatchPart(keybinding){return USLayoutResolvedKeybinding.getDispatchStr(keybinding)}static getDispatchStr(keybinding){if(keybinding.isModifierKey())return null;let result="";return keybinding.ctrlKey&&(result+="ctrl+"),keybinding.shiftKey&&(result+="shift+"),keybinding.altKey&&(result+="alt+"),keybinding.metaKey&&(result+="meta+"),result+=keyCodes_1.KeyCodeUtils.toString(keybinding.keyCode),result}_getSingleModifierDispatchPart(keybinding){return 5!==keybinding.keyCode||keybinding.shiftKey||keybinding.altKey||keybinding.metaKey?4!==keybinding.keyCode||keybinding.ctrlKey||keybinding.altKey||keybinding.metaKey?6!==keybinding.keyCode||keybinding.ctrlKey||keybinding.shiftKey||keybinding.metaKey?57!==keybinding.keyCode||keybinding.ctrlKey||keybinding.shiftKey||keybinding.altKey?null:"meta":"alt":"shift":"ctrl"}static _scanCodeToKeyCode(scanCode){const immutableKeyCode=keyCodes_1.IMMUTABLE_CODE_TO_KEY_CODE[scanCode];if(-1!==immutableKeyCode)return immutableKeyCode;switch(scanCode){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 83;case 52:return 81;case 53:return 87;case 54:return 89;case 55:return 88;case 56:return 0;case 57:return 80;case 58:return 90;case 59:return 86;case 60:return 82;case 61:return 84;case 62:return 85;case 106:return 92}return 0}static _resolveSimpleUserBinding(binding){if(!binding)return null;if(binding instanceof keybindings_1.SimpleKeybinding)return binding;const keyCode=this._scanCodeToKeyCode(binding.scanCode);return 0===keyCode?null:new keybindings_1.SimpleKeybinding(binding.ctrlKey,binding.shiftKey,binding.altKey,binding.metaKey,keyCode)}static resolveUserBinding(input,os){const parts=(0,resolvedKeybindingItem_1.removeElementsAfterNulls)(input.map((keybinding=>this._resolveSimpleUserBinding(keybinding))));return parts.length>0?[new USLayoutResolvedKeybinding(new keybindings_1.ChordKeybinding(parts),os)]:[]}}exports.USLayoutResolvedKeybinding=USLayoutResolvedKeybinding})),define(__m[131],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ILabelService=void 0,exports.ILabelService=(0,instantiation_1.createDecorator)("labelService")})),define(__m[132],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ILayoutService=void 0,exports.ILayoutService=(0,instantiation_1.createDecorator)("layoutService")})),define(__m[280],__M([1,0,7,4,132,29,52]),(function(require,exports,dom,event_1,layoutService_1,codeEditorService_1,extensions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorScopedLayoutService=void 0;let StandaloneLayoutService=class StandaloneLayoutService{constructor(_codeEditorService){this._codeEditorService=_codeEditorService,this.onDidLayout=event_1.Event.None}get dimension(){return this._dimension||(this._dimension=dom.getClientArea(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var _a;null===(_a=this._codeEditorService.getFocusedCodeEditor())||void 0===_a||_a.focus()}};StandaloneLayoutService=__decorate([__param(0,codeEditorService_1.ICodeEditorService)],StandaloneLayoutService);let EditorScopedLayoutService=class EditorScopedLayoutService extends StandaloneLayoutService{constructor(_container,codeEditorService){super(codeEditorService),this._container=_container}get hasContainer(){return!1}get container(){return this._container}};EditorScopedLayoutService=__decorate([__param(1,codeEditorService_1.ICodeEditorService)],EditorScopedLayoutService),exports.EditorScopedLayoutService=EditorScopedLayoutService,(0,extensions_1.registerSingleton)(layoutService_1.ILayoutService,StandaloneLayoutService)})),define(__m[622],__M([1,0,225,2,132]),(function(require,exports,contextview_1,lifecycle_1,layoutService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextViewService=void 0;let ContextViewService=class ContextViewService extends lifecycle_1.Disposable{constructor(layoutService){super(),this.layoutService=layoutService,this.currentViewDisposable=lifecycle_1.Disposable.None,this.container=layoutService.hasContainer?layoutService.container:null,this.contextView=this._register(new contextview_1.ContextView(this.container,1)),this.layout(),this._register(layoutService.onDidLayout((()=>this.layout())))}setContainer(container,domPosition){this.contextView.setContainer(container,domPosition||1)}showContextView(delegate,container,shadowRoot){container?container!==this.container&&(this.container=container,this.setContainer(container,shadowRoot?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.contextView.show(delegate);const disposable=(0,lifecycle_1.toDisposable)((()=>{this.currentViewDisposable===disposable&&this.hideContextView()}));return this.currentViewDisposable=disposable,disposable}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(data){this.contextView.hide(data)}};ContextViewService=__decorate([__param(0,layoutService_1.ILayoutService)],ContextViewService),exports.ContextViewService=ContextViewService})),define(__m[66],__M([1,0,4,2,9]),(function(require,exports,event_1,lifecycle_1,instantiation_1){"use strict";var LogLevel;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogService=exports.ConsoleLogger=exports.AbstractLogger=exports.DEFAULT_LOG_LEVEL=exports.LogLevel=exports.ILogService=void 0,exports.ILogService=(0,instantiation_1.createDecorator)("logService"),function(LogLevel){LogLevel[LogLevel.Trace=0]="Trace",LogLevel[LogLevel.Debug=1]="Debug",LogLevel[LogLevel.Info=2]="Info",LogLevel[LogLevel.Warning=3]="Warning",LogLevel[LogLevel.Error=4]="Error",LogLevel[LogLevel.Critical=5]="Critical",LogLevel[LogLevel.Off=6]="Off"}(LogLevel=exports.LogLevel||(exports.LogLevel={})),exports.DEFAULT_LOG_LEVEL=LogLevel.Info;class AbstractLogger extends lifecycle_1.Disposable{constructor(){super(...arguments),this.level=exports.DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new event_1.Emitter)}setLevel(level){this.level!==level&&(this.level=level,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}exports.AbstractLogger=AbstractLogger;exports.ConsoleLogger=class ConsoleLogger extends AbstractLogger{constructor(logLevel=exports.DEFAULT_LOG_LEVEL){super(),this.setLevel(logLevel)}trace(message,...args){this.getLevel()<=LogLevel.Trace&&console.log("%cTRACE","color: #888",message,...args)}debug(message,...args){this.getLevel()<=LogLevel.Debug&&console.log("%cDEBUG","background: #eee; color: #888",message,...args)}info(message,...args){this.getLevel()<=LogLevel.Info&&console.log("%c INFO","color: #33f",message,...args)}error(message,...args){this.getLevel()<=LogLevel.Error&&console.log("%c  ERR","color: #f33",message,...args)}dispose(){}};class LogService extends lifecycle_1.Disposable{constructor(logger){super(),this.logger=logger,this._register(logger)}getLevel(){return this.logger.getLevel()}trace(message,...args){this.logger.trace(message,...args)}debug(message,...args){this.logger.debug(message,...args)}info(message,...args){this.logger.info(message,...args)}error(message,...args){this.logger.error(message,...args)}}exports.LogService=LogService})),define(__m[281],__M([1,0,10,2,222,329,3,33,437,48,156,8,18,66,55,13,20]),(function(require,exports,async_1,lifecycle_1,simpleWorker_1,defaultWorkerFactory_1,range_1,languageConfigurationRegistry_1,editorSimpleWorker_1,model_1,textResourceConfiguration_1,strings_1,arrays_1,log_1,stopwatch_1,errors_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorWorkerClient=exports.EditorWorkerHost=exports.EditorWorkerService=void 0;function canSyncModel(modelService,resource){const model=modelService.getModel(resource);return!!model&&!model.isTooLargeForSyncing()}let EditorWorkerService=class EditorWorkerService extends lifecycle_1.Disposable{constructor(modelService,configurationService,logService,languageConfigurationService,languageFeaturesService){super(),this._modelService=modelService,this._workerManager=this._register(new WorkerManager(this._modelService,languageConfigurationService)),this._logService=logService,this._register(languageFeaturesService.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(model,token)=>canSyncModel(this._modelService,model.uri)?this._workerManager.withWorker().then((client=>client.computeLinks(model.uri))).then((links=>links&&{links})):Promise.resolve({links:[]})})),this._register(languageFeaturesService.completionProvider.register("*",new WordBasedCompletionItemProvider(this._workerManager,configurationService,this._modelService,languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(uri){return canSyncModel(this._modelService,uri)}computedUnicodeHighlights(uri,options,range){return this._workerManager.withWorker().then((client=>client.computedUnicodeHighlights(uri,options,range)))}computeDiff(original,modified,ignoreTrimWhitespace,maxComputationTime){return this._workerManager.withWorker().then((client=>client.computeDiff(original,modified,ignoreTrimWhitespace,maxComputationTime)))}computeMoreMinimalEdits(resource,edits){if((0,arrays_1.isNonEmptyArray)(edits)){if(!canSyncModel(this._modelService,resource))return Promise.resolve(edits);const sw=stopwatch_1.StopWatch.create(!0),result=this._workerManager.withWorker().then((client=>client.computeMoreMinimalEdits(resource,edits)));return result.finally((()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",resource.toString(!0),sw.elapsed()))),Promise.race([result,(0,async_1.timeout)(1e3).then((()=>edits))])}return Promise.resolve(void 0)}canNavigateValueSet(resource){return canSyncModel(this._modelService,resource)}navigateValueSet(resource,range,up){return this._workerManager.withWorker().then((client=>client.navigateValueSet(resource,range,up)))}canComputeWordRanges(resource){return canSyncModel(this._modelService,resource)}computeWordRanges(resource,range){return this._workerManager.withWorker().then((client=>client.computeWordRanges(resource,range)))}};EditorWorkerService=__decorate([__param(0,model_1.IModelService),__param(1,textResourceConfiguration_1.ITextResourceConfigurationService),__param(2,log_1.ILogService),__param(3,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(4,languageFeatures_1.ILanguageFeaturesService)],EditorWorkerService),exports.EditorWorkerService=EditorWorkerService;class WordBasedCompletionItemProvider{constructor(workerManager,configurationService,modelService,languageConfigurationService){this.languageConfigurationService=languageConfigurationService,this._debugDisplayName="wordbasedCompletions",this._workerManager=workerManager,this._configurationService=configurationService,this._modelService=modelService}provideCompletionItems(model,position){return __awaiter(this,void 0,void 0,(function*(){const config=this._configurationService.getValue(model.uri,position,"editor");if(!config.wordBasedSuggestions)return;const models=[];if("currentDocument"===config.wordBasedSuggestionsMode)canSyncModel(this._modelService,model.uri)&&models.push(model.uri);else for(const candidate of this._modelService.getModels())canSyncModel(this._modelService,candidate.uri)&&(candidate===model?models.unshift(candidate.uri):"allDocuments"!==config.wordBasedSuggestionsMode&&candidate.getLanguageId()!==model.getLanguageId()||models.push(candidate.uri));if(0===models.length)return;const wordDefRegExp=this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition(),word=model.getWordAtPosition(position),replace=word?new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,word.endColumn):range_1.Range.fromPositions(position),insert=replace.setEndPosition(position.lineNumber,position.column),client=yield this._workerManager.withWorker(),data=yield client.textualSuggest(models,null==word?void 0:word.word,wordDefRegExp);return data?{duration:data.duration,suggestions:data.words.map((word=>({kind:18,label:word,insertText:word,range:{insert,replace}})))}:void 0}))}}class WorkerManager extends lifecycle_1.Disposable{constructor(modelService,languageConfigurationService){super(),this.languageConfigurationService=languageConfigurationService,this._modelService=modelService,this._editorWorkerClient=null,this._lastWorkerUsedTime=(new Date).getTime();this._register(new async_1.IntervalTimer).cancelAndSet((()=>this._checkStopIdleWorker()),Math.round(15e4)),this._register(this._modelService.onModelRemoved((_=>this._checkStopEmptyWorker())))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;0===this._modelService.getModels().length&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;(new Date).getTime()-this._lastWorkerUsedTime>3e5&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=(new Date).getTime(),this._editorWorkerClient||(this._editorWorkerClient=new EditorWorkerClient(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class EditorModelManager extends lifecycle_1.Disposable{constructor(proxy,modelService,keepIdleModels){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=proxy,this._modelService=modelService,!keepIdleModels){const timer=new async_1.IntervalTimer;timer.cancelAndSet((()=>this._checkStopModelSync()),Math.round(3e4)),this._register(timer)}}dispose(){for(let modelUrl in this._syncedModels)(0,lifecycle_1.dispose)(this._syncedModels[modelUrl]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(resources,forceLargeModels){for(const resource of resources){const resourceStr=resource.toString();this._syncedModels[resourceStr]||this._beginModelSync(resource,forceLargeModels),this._syncedModels[resourceStr]&&(this._syncedModelsLastUsedTime[resourceStr]=(new Date).getTime())}}_checkStopModelSync(){const currentTime=(new Date).getTime(),toRemove=[];for(let modelUrl in this._syncedModelsLastUsedTime){currentTime-this._syncedModelsLastUsedTime[modelUrl]>6e4&&toRemove.push(modelUrl)}for(const e of toRemove)this._stopModelSync(e)}_beginModelSync(resource,forceLargeModels){const model=this._modelService.getModel(resource);if(!model)return;if(!forceLargeModels&&model.isTooLargeForSyncing())return;const modelUrl=resource.toString();this._proxy.acceptNewModel({url:model.uri.toString(),lines:model.getLinesContent(),EOL:model.getEOL(),versionId:model.getVersionId()});const toDispose=new lifecycle_1.DisposableStore;toDispose.add(model.onDidChangeContent((e=>{this._proxy.acceptModelChanged(modelUrl.toString(),e)}))),toDispose.add(model.onWillDispose((()=>{this._stopModelSync(modelUrl)}))),toDispose.add((0,lifecycle_1.toDisposable)((()=>{this._proxy.acceptRemovedModel(modelUrl)}))),this._syncedModels[modelUrl]=toDispose}_stopModelSync(modelUrl){const toDispose=this._syncedModels[modelUrl];delete this._syncedModels[modelUrl],delete this._syncedModelsLastUsedTime[modelUrl],(0,lifecycle_1.dispose)(toDispose)}}class SynchronousWorkerClient{constructor(instance){this._instance=instance,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class EditorWorkerHost{constructor(workerClient){this._workerClient=workerClient}fhr(method,args){return this._workerClient.fhr(method,args)}}exports.EditorWorkerHost=EditorWorkerHost;class EditorWorkerClient extends lifecycle_1.Disposable{constructor(modelService,keepIdleModels,label,languageConfigurationService){super(),this.languageConfigurationService=languageConfigurationService,this._disposed=!1,this._modelService=modelService,this._keepIdleModels=keepIdleModels,this._workerFactory=new defaultWorkerFactory_1.DefaultWorkerFactory(label),this._worker=null,this._modelManager=null}fhr(method,args){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new simpleWorker_1.SimpleWorkerClient(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new EditorWorkerHost(this)))}catch(err){(0,simpleWorker_1.logOnceWebWorkerWarning)(err),this._worker=new SynchronousWorkerClient(new editorSimpleWorker_1.EditorSimpleWorker(new EditorWorkerHost(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,(err=>((0,simpleWorker_1.logOnceWebWorkerWarning)(err),this._worker=new SynchronousWorkerClient(new editorSimpleWorker_1.EditorSimpleWorker(new EditorWorkerHost(this),null)),this._getOrCreateWorker().getProxyObject())))}_getOrCreateModelManager(proxy){return this._modelManager||(this._modelManager=this._register(new EditorModelManager(proxy,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(resources,forceLargeModels=!1){return __awaiter(this,void 0,void 0,(function*(){return this._disposed?Promise.reject((0,errors_1.canceled)()):this._getProxy().then((proxy=>(this._getOrCreateModelManager(proxy).ensureSyncedResources(resources,forceLargeModels),proxy)))}))}computedUnicodeHighlights(uri,options,range){return this._withSyncedResources([uri]).then((proxy=>proxy.computeUnicodeHighlights(uri.toString(),options,range)))}computeDiff(original,modified,ignoreTrimWhitespace,maxComputationTime){return this._withSyncedResources([original,modified],!0).then((proxy=>proxy.computeDiff(original.toString(),modified.toString(),ignoreTrimWhitespace,maxComputationTime)))}computeMoreMinimalEdits(resource,edits){return this._withSyncedResources([resource]).then((proxy=>proxy.computeMoreMinimalEdits(resource.toString(),edits)))}computeLinks(resource){return this._withSyncedResources([resource]).then((proxy=>proxy.computeLinks(resource.toString())))}textualSuggest(resources,leadingWord,wordDefRegExp){return __awaiter(this,void 0,void 0,(function*(){const proxy=yield this._withSyncedResources(resources),wordDef=wordDefRegExp.source,wordDefFlags=(0,strings_1.regExpFlags)(wordDefRegExp);return proxy.textualSuggest(resources.map((r=>r.toString())),leadingWord,wordDef,wordDefFlags)}))}computeWordRanges(resource,range){return this._withSyncedResources([resource]).then((proxy=>{const model=this._modelService.getModel(resource);if(!model)return Promise.resolve(null);const wordDefRegExp=this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition(),wordDef=wordDefRegExp.source,wordDefFlags=(0,strings_1.regExpFlags)(wordDefRegExp);return proxy.computeWordRanges(resource.toString(),range,wordDef,wordDefFlags)}))}navigateValueSet(resource,range,up){return this._withSyncedResources([resource]).then((proxy=>{const model=this._modelService.getModel(resource);if(!model)return null;const wordDefRegExp=this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition(),wordDef=wordDefRegExp.source,wordDefFlags=(0,strings_1.regExpFlags)(wordDefRegExp);return proxy.navigateValueSet(resource.toString(),range,up,wordDef,wordDefFlags)}))}dispose(){super.dispose(),this._disposed=!0}}exports.EditorWorkerClient=EditorWorkerClient})),define(__m[623],__M([1,0,281,19]),(function(require,exports,editorWorkerService_1,types){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWebWorker=void 0,exports.createWebWorker=function createWebWorker(modelService,languageConfigurationService,opts){return new MonacoWebWorkerImpl(modelService,languageConfigurationService,opts)};class MonacoWebWorkerImpl extends editorWorkerService_1.EditorWorkerClient{constructor(modelService,languageConfigurationService,opts){super(modelService,opts.keepIdleModels||!1,opts.label,languageConfigurationService),this._foreignModuleId=opts.moduleId,this._foreignModuleCreateData=opts.createData||null,this._foreignModuleHost=opts.host||null,this._foreignProxy=null}fhr(method,args){if(!this._foreignModuleHost||"function"!=typeof this._foreignModuleHost[method])return Promise.reject(new Error("Missing method "+method+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost,args))}catch(e){return Promise.reject(e)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((proxy=>{const foreignHostMethods=this._foreignModuleHost?types.getAllMethodNames(this._foreignModuleHost):[];return proxy.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,foreignHostMethods).then((foreignMethods=>{this._foreignModuleCreateData=null;const proxyMethodRequest=(method,args)=>proxy.fmr(method,args),createProxyMethod=(method,proxyMethodRequest)=>function(){const args=Array.prototype.slice.call(arguments,0);return proxyMethodRequest(method,args)},foreignProxy={};for(const foreignMethod of foreignMethods)foreignProxy[foreignMethod]=createProxyMethod(foreignMethod,proxyMethodRequest);return foreignProxy}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(resources){return this._withSyncedResources(resources).then((_=>this.getProxy()))}}})),define(__m[67],__M([1,0,114,49,113,52,9,66]),(function(require,exports,hash_1,map_1,numbers_1,extensions_1,instantiation_1,log_1){"use strict";var IdentityHash;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguageFeatureDebounceService=exports.ILanguageFeatureDebounceService=void 0,exports.ILanguageFeatureDebounceService=(0,instantiation_1.createDecorator)("ILanguageFeatureDebounceService"),function(IdentityHash){const _hashes=new WeakMap;let pool=0;IdentityHash.of=function of(obj){let value=_hashes.get(obj);return void 0===value&&(value=++pool,_hashes.set(obj,value)),value}}(IdentityHash||(IdentityHash={}));class FeatureDebounceInformation{constructor(_logService,_name,_registry,_default,_min,_max){this._logService=_logService,this._name=_name,this._registry=_registry,this._default=_default,this._min=_min,this._max=_max,this._cache=new map_1.LRUCache(50,.7)}_key(model){return model.id+this._registry.all(model).reduce(((hashVal,obj)=>(0,hash_1.doHash)(IdentityHash.of(obj),hashVal)),0)}get(model){const key=this._key(model),avg=this._cache.get(key);return avg?(0,numbers_1.clamp)(avg.value,this._min,this._max):this.default()}update(model,value){const key=this._key(model);let avg=this._cache.get(key);avg||(avg=new numbers_1.SlidingWindowAverage(6),this._cache.set(key,avg));const newValue=(0,numbers_1.clamp)(avg.update(value),this._min,this._max);return this._logService.trace(`[DEBOUNCE: ${this._name}] for ${model.uri.toString()} is ${newValue}ms`),newValue}_overall(){const result=new numbers_1.MovingAverage;for(const[,avg]of this._cache)result.update(avg.value);return result.value}default(){const value=0|this._overall()||this._default;return(0,numbers_1.clamp)(value,this._min,this._max)}}let LanguageFeatureDebounceService=class LanguageFeatureDebounceService{constructor(_logService){this._logService=_logService,this._data=new Map}for(feature,name,config){var _a,_b,_c;const min=null!==(_a=null==config?void 0:config.min)&&void 0!==_a?_a:50,max=null!==(_b=null==config?void 0:config.max)&&void 0!==_b?_b:Math.pow(min,2),extra=null!==(_c=null==config?void 0:config.key)&&void 0!==_c?_c:void 0,key=`${IdentityHash.of(feature)},${min}${extra?","+extra:""}`;let info=this._data.get(key);return info||(info=new FeatureDebounceInformation(this._logService,name,feature,0|this._overallAverage()||1.5*min,min,max),this._data.set(key,info)),info}_overallAverage(){let result=new numbers_1.MovingAverage;for(let info of this._data.values())result.update(info.default());return result.value}};LanguageFeatureDebounceService=__decorate([__param(0,log_1.ILogService)],LanguageFeatureDebounceService),exports.LanguageFeatureDebounceService=LanguageFeatureDebounceService,(0,extensions_1.registerSingleton)(exports.ILanguageFeatureDebounceService,LanguageFeatureDebounceService,!0)})),define(__m[205],__M([1,0,18,21,13,57,49,11,3,67,9,52,48,2,20]),(function(require,exports,arrays_1,cancellation_1,errors_1,iterator_1,map_1,position_1,range_1,languageFeatureDebounce_1,instantiation_1,extensions_1,model_1,lifecycle_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutlineModelService=exports.IOutlineModelService=exports.OutlineModel=exports.OutlineGroup=exports.OutlineElement=exports.TreeElement=void 0;class TreeElement{remove(){this.parent&&this.parent.children.delete(this.id)}static findId(candidate,container){let candidateId;"string"==typeof candidate?candidateId=`${container.id}/${candidate}`:(candidateId=`${container.id}/${candidate.name}`,void 0!==container.children.get(candidateId)&&(candidateId=`${container.id}/${candidate.name}_${candidate.range.startLineNumber}_${candidate.range.startColumn}`));let id=candidateId;for(let i=0;void 0!==container.children.get(id);i++)id=`${candidateId}_${i}`;return id}static empty(element){return 0===element.children.size}}exports.TreeElement=TreeElement;class OutlineElement extends TreeElement{constructor(id,parent,symbol){super(),this.id=id,this.parent=parent,this.symbol=symbol,this.children=new Map}}exports.OutlineElement=OutlineElement;class OutlineGroup extends TreeElement{constructor(id,parent,label,order){super(),this.id=id,this.parent=parent,this.label=label,this.order=order,this.children=new Map}}exports.OutlineGroup=OutlineGroup;class OutlineModel extends TreeElement{constructor(uri){super(),this.uri=uri,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}static create(registry,textModel,token){const cts=new cancellation_1.CancellationTokenSource(token),result=new OutlineModel(textModel.uri),provider=registry.ordered(textModel),promises=provider.map(((provider,index)=>{var _a;let id=TreeElement.findId(`provider_${index}`,result),group=new OutlineGroup(id,result,null!==(_a=provider.displayName)&&void 0!==_a?_a:"Unknown Outline Provider",index);return Promise.resolve(provider.provideDocumentSymbols(textModel,cts.token)).then((result=>{for(const info of result||[])OutlineModel._makeOutlineElement(info,group);return group}),(err=>((0,errors_1.onUnexpectedExternalError)(err),group))).then((group=>{TreeElement.empty(group)?group.remove():result._groups.set(id,group)}))})),listener=registry.onDidChange((()=>{const newProvider=registry.ordered(textModel);(0,arrays_1.equals)(newProvider,provider)||cts.cancel()}));return Promise.all(promises).then((()=>cts.token.isCancellationRequested&&!token.isCancellationRequested?OutlineModel.create(registry,textModel,token):result._compact())).finally((()=>{listener.dispose()}))}static _makeOutlineElement(info,container){let id=TreeElement.findId(info,container),res=new OutlineElement(id,container,info);if(info.children)for(const childInfo of info.children)OutlineModel._makeOutlineElement(childInfo,res);container.children.set(res.id,res)}_compact(){let count=0;for(const[key,group]of this._groups)0===group.children.size?this._groups.delete(key):count+=1;if(1!==count)this.children=this._groups;else{let group=iterator_1.Iterable.first(this._groups.values());for(let[,child]of group.children)child.parent=this,this.children.set(child.id,child)}return this}getTopLevelSymbols(){const roots=[];for(const child of this.children.values())child instanceof OutlineElement?roots.push(child.symbol):roots.push(...iterator_1.Iterable.map(child.children.values(),(child=>child.symbol)));return roots.sort(((a,b)=>range_1.Range.compareRangesUsingStarts(a.range,b.range)))}asListOfDocumentSymbols(){const roots=this.getTopLevelSymbols(),bucket=[];return OutlineModel._flattenDocumentSymbols(bucket,roots,""),bucket.sort(((a,b)=>position_1.Position.compare(range_1.Range.getStartPosition(a.range),range_1.Range.getStartPosition(b.range))||position_1.Position.compare(range_1.Range.getEndPosition(b.range),range_1.Range.getEndPosition(a.range))))}static _flattenDocumentSymbols(bucket,entries,overrideContainerLabel){for(const entry of entries)bucket.push({kind:entry.kind,tags:entry.tags,name:entry.name,detail:entry.detail,containerName:entry.containerName||overrideContainerLabel,range:entry.range,selectionRange:entry.selectionRange,children:void 0}),entry.children&&OutlineModel._flattenDocumentSymbols(bucket,entry.children,entry.name)}}exports.OutlineModel=OutlineModel,exports.IOutlineModelService=(0,instantiation_1.createDecorator)("IOutlineModelService");let OutlineModelService=class OutlineModelService{constructor(_languageFeaturesService,debounces,modelService){this._languageFeaturesService=_languageFeaturesService,this._disposables=new lifecycle_1.DisposableStore,this._cache=new map_1.LRUCache(10,.7),this._debounceInformation=debounces.for(_languageFeaturesService.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(modelService.onModelRemoved((textModel=>{this._cache.delete(textModel.id)})))}dispose(){this._disposables.dispose()}getOrCreate(textModel,token){return __awaiter(this,void 0,void 0,(function*(){const registry=this._languageFeaturesService.documentSymbolProvider,provider=registry.ordered(textModel);let data=this._cache.get(textModel.id);if(!data||data.versionId!==textModel.getVersionId()||!(0,arrays_1.equals)(data.provider,provider)){let source=new cancellation_1.CancellationTokenSource;data={versionId:textModel.getVersionId(),provider,promiseCnt:0,source,promise:OutlineModel.create(registry,textModel,source.token),model:void 0},this._cache.set(textModel.id,data);const now=Date.now();data.promise.then((outlineModel=>{data.model=outlineModel,this._debounceInformation.update(textModel,Date.now()-now)})).catch((_err=>{this._cache.delete(textModel.id)}))}if(data.model)return data.model;data.promiseCnt+=1;const listener=token.onCancellationRequested((()=>{0==--data.promiseCnt&&(data.source.cancel(),this._cache.delete(textModel.id))}));try{return yield data.promise}finally{listener.dispose()}}))}};OutlineModelService=__decorate([__param(0,languageFeatures_1.ILanguageFeaturesService),__param(1,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(2,model_1.IModelService)],OutlineModelService),exports.OutlineModelService=OutlineModelService,(0,extensions_1.registerSingleton)(exports.IOutlineModelService,OutlineModelService,!0)})),define(__m[624],__M([1,0,21,19,25,56,205,26]),(function(require,exports,cancellation_1,types_1,uri_1,resolverService_1,outlineModel_1,commands_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),commands_1.CommandsRegistry.registerCommand("_executeDocumentSymbolProvider",(function(accessor,...args){return __awaiter(this,void 0,void 0,(function*(){const[resource]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource));const outlineService=accessor.get(outlineModel_1.IOutlineModelService),modelService=accessor.get(resolverService_1.ITextModelService),reference=yield modelService.createModelReference(resource);try{return(yield outlineService.getOrCreate(reference.object.textEditorModel,cancellation_1.CancellationToken.None)).getTopLevelSymbols()}finally{reference.dispose()}}))}))})),define(__m[625],__M([1,0,34,7,10,2,132,66]),(function(require,exports,browser_1,dom_1,async_1,lifecycle_1,layoutService_1,log_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserClipboardService=void 0;let BrowserClipboardService=class BrowserClipboardService extends lifecycle_1.Disposable{constructor(layoutService,logService){super(),this.layoutService=layoutService,this.logService=logService,this.mapTextToType=new Map,this.findText="",(browser_1.isSafari||browser_1.isWebkitWebView)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const handler=()=>{const currentWritePromise=new async_1.DeferredPromise;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=currentWritePromise,navigator.clipboard.write([new ClipboardItem({"text/plain":currentWritePromise.p})]).catch((err=>__awaiter(this,void 0,void 0,(function*(){err instanceof Error&&"NotAllowedError"===err.name&&currentWritePromise.isRejected||this.logService.error(err)}))))};this.layoutService.hasContainer&&(this._register((0,dom_1.addDisposableListener)(this.layoutService.container,"click",handler)),this._register((0,dom_1.addDisposableListener)(this.layoutService.container,"keydown",handler)))}writeText(text,type){return __awaiter(this,void 0,void 0,(function*(){if(type)return void this.mapTextToType.set(type,text);if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(text);try{return yield navigator.clipboard.writeText(text)}catch(error){console.error(error)}const activeElement=document.activeElement,textArea=document.body.appendChild((0,dom_1.$)("textarea",{"aria-hidden":!0}));textArea.style.height="1px",textArea.style.width="1px",textArea.style.position="absolute",textArea.value=text,textArea.focus(),textArea.select(),document.execCommand("copy"),activeElement instanceof HTMLElement&&activeElement.focus(),document.body.removeChild(textArea)}))}readText(type){return __awaiter(this,void 0,void 0,(function*(){if(type)return this.mapTextToType.get(type)||"";try{return yield navigator.clipboard.readText()}catch(error){return console.error(error),""}}))}readFindText(){return __awaiter(this,void 0,void 0,(function*(){return this.findText}))}writeFindText(text){return __awaiter(this,void 0,void 0,(function*(){this.findText=text}))}};BrowserClipboardService=__decorate([__param(0,layoutService_1.ILayoutService),__param(1,log_1.ILogService)],BrowserClipboardService),exports.BrowserClipboardService=BrowserClipboardService})),define(__m[79],__M([1,0,76,596,9]),(function(require,exports,severity_1,nls_1,instantiation_1){"use strict";var MarkerSeverity;Object.defineProperty(exports,"__esModule",{value:!0}),exports.IMarkerService=exports.IMarkerData=exports.MarkerSeverity=void 0,function(MarkerSeverity){MarkerSeverity[MarkerSeverity.Hint=1]="Hint",MarkerSeverity[MarkerSeverity.Info=2]="Info",MarkerSeverity[MarkerSeverity.Warning=4]="Warning",MarkerSeverity[MarkerSeverity.Error=8]="Error"}(MarkerSeverity=exports.MarkerSeverity||(exports.MarkerSeverity={})),function(MarkerSeverity){MarkerSeverity.compare=function compare(a,b){return b-a};const _displayStrings=Object.create(null);_displayStrings[MarkerSeverity.Error]=(0,nls_1.localize)(0,null),_displayStrings[MarkerSeverity.Warning]=(0,nls_1.localize)(1,null),_displayStrings[MarkerSeverity.Info]=(0,nls_1.localize)(2,null),MarkerSeverity.toString=function toString(a){return _displayStrings[a]||""},MarkerSeverity.fromSeverity=function fromSeverity(severity){switch(severity){case severity_1.default.Error:return MarkerSeverity.Error;case severity_1.default.Warning:return MarkerSeverity.Warning;case severity_1.default.Info:return MarkerSeverity.Info;case severity_1.default.Ignore:return MarkerSeverity.Hint}},MarkerSeverity.toSeverity=function toSeverity(severity){switch(severity){case MarkerSeverity.Error:return severity_1.default.Error;case MarkerSeverity.Warning:return severity_1.default.Warning;case MarkerSeverity.Info:return severity_1.default.Info;case MarkerSeverity.Hint:return severity_1.default.Ignore}}}(MarkerSeverity=exports.MarkerSeverity||(exports.MarkerSeverity={})),function(IMarkerData){function makeKeyOptionalMessage(markerData,useMessage){let result=[""];return markerData.source?result.push(markerData.source.replace("¦","\\¦")):result.push(""),markerData.code?"string"==typeof markerData.code?result.push(markerData.code.replace("¦","\\¦")):result.push(markerData.code.value.replace("¦","\\¦")):result.push(""),void 0!==markerData.severity&&null!==markerData.severity?result.push(MarkerSeverity.toString(markerData.severity)):result.push(""),markerData.message&&useMessage?result.push(markerData.message.replace("¦","\\¦")):result.push(""),void 0!==markerData.startLineNumber&&null!==markerData.startLineNumber?result.push(markerData.startLineNumber.toString()):result.push(""),void 0!==markerData.startColumn&&null!==markerData.startColumn?result.push(markerData.startColumn.toString()):result.push(""),void 0!==markerData.endLineNumber&&null!==markerData.endLineNumber?result.push(markerData.endLineNumber.toString()):result.push(""),void 0!==markerData.endColumn&&null!==markerData.endColumn?result.push(markerData.endColumn.toString()):result.push(""),result.push(""),result.join("¦")}IMarkerData.makeKey=function makeKey(markerData){return makeKeyOptionalMessage(markerData,!0)},IMarkerData.makeKeyOptionalMessage=makeKeyOptionalMessage}(exports.IMarkerData||(exports.IMarkerData={})),exports.IMarkerService=(0,instantiation_1.createDecorator)("markerService")})),define(__m[626],__M([1,0,18,4,2,83,8,25,3,52,9,79,41]),(function(require,exports,arrays_1,event_1,lifecycle_1,linkedList_1,strings_1,uri_1,range_1,extensions_1,instantiation_1,markers_1,configuration_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IMarkerNavigationService=exports.MarkerList=exports.MarkerCoordinate=void 0;class MarkerCoordinate{constructor(marker,index,total){this.marker=marker,this.index=index,this.total=total}}exports.MarkerCoordinate=MarkerCoordinate;let MarkerList=class MarkerList{constructor(resourceFilter,_markerService,_configService){this._markerService=_markerService,this._configService=_configService,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._dispoables=new lifecycle_1.DisposableStore,this._markers=[],this._nextIdx=-1,uri_1.URI.isUri(resourceFilter)?this._resourceFilter=uri=>uri.toString()===resourceFilter.toString():resourceFilter&&(this._resourceFilter=resourceFilter);const compareOrder=this._configService.getValue("problems.sortOrder"),compareMarker=(a,b)=>{let res=(0,strings_1.compare)(a.resource.toString(),b.resource.toString());return 0===res&&(res="position"===compareOrder?range_1.Range.compareRangesUsingStarts(a,b)||markers_1.MarkerSeverity.compare(a.severity,b.severity):markers_1.MarkerSeverity.compare(a.severity,b.severity)||range_1.Range.compareRangesUsingStarts(a,b)),res},updateMarker=()=>{this._markers=this._markerService.read({resource:uri_1.URI.isUri(resourceFilter)?resourceFilter:void 0,severities:markers_1.MarkerSeverity.Error|markers_1.MarkerSeverity.Warning|markers_1.MarkerSeverity.Info}),"function"==typeof resourceFilter&&(this._markers=this._markers.filter((m=>this._resourceFilter(m.resource)))),this._markers.sort(compareMarker)};updateMarker(),this._dispoables.add(_markerService.onMarkerChanged((uris=>{this._resourceFilter&&!uris.some((uri=>this._resourceFilter(uri)))||(updateMarker(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(uri){return!this._resourceFilter&&!uri||!(!this._resourceFilter||!uri)&&this._resourceFilter(uri)}get selected(){const marker=this._markers[this._nextIdx];return marker&&new MarkerCoordinate(marker,this._nextIdx+1,this._markers.length)}_initIdx(model,position,fwd){let found=!1,idx=this._markers.findIndex((marker=>marker.resource.toString()===model.uri.toString()));idx<0&&(idx=(0,arrays_1.binarySearch)(this._markers,{resource:model.uri},((a,b)=>(0,strings_1.compare)(a.resource.toString(),b.resource.toString()))),idx<0&&(idx=~idx));for(let i=idx;i<this._markers.length;i++){let range=range_1.Range.lift(this._markers[i]);if(range.isEmpty()){const word=model.getWordAtPosition(range.getStartPosition());word&&(range=new range_1.Range(range.startLineNumber,word.startColumn,range.startLineNumber,word.endColumn))}if(position&&(range.containsPosition(position)||position.isBeforeOrEqual(range.getStartPosition()))){this._nextIdx=i,found=!0;break}if(this._markers[i].resource.toString()!==model.uri.toString())break}found||(this._nextIdx=fwd?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(fwd,model,position){if(0===this._markers.length)return!1;let oldIdx=this._nextIdx;return-1===this._nextIdx?this._initIdx(model,position,fwd):fwd?this._nextIdx=(this._nextIdx+1)%this._markers.length:fwd||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),oldIdx!==this._nextIdx}find(uri,position){let idx=this._markers.findIndex((marker=>marker.resource.toString()===uri.toString()));if(!(idx<0))for(;idx<this._markers.length;idx++)if(range_1.Range.containsPosition(this._markers[idx],position))return new MarkerCoordinate(this._markers[idx],idx+1,this._markers.length)}};MarkerList=__decorate([__param(1,markers_1.IMarkerService),__param(2,configuration_1.IConfigurationService)],MarkerList),exports.MarkerList=MarkerList,exports.IMarkerNavigationService=(0,instantiation_1.createDecorator)("IMarkerNavigationService");let MarkerNavigationService=class MarkerNavigationService{constructor(_markerService,_configService){this._markerService=_markerService,this._configService=_configService,this._provider=new linkedList_1.LinkedList}getMarkerList(resource){for(let provider of this._provider){const result=provider.getMarkerList(resource);if(result)return result}return new MarkerList(resource,this._markerService,this._configService)}};MarkerNavigationService=__decorate([__param(0,markers_1.IMarkerService),__param(1,configuration_1.IConfigurationService)],MarkerNavigationService),(0,extensions_1.registerSingleton)(exports.IMarkerNavigationService,MarkerNavigationService,!0)})),define(__m[627],__M([1,0,18,4,57,49,45,25,79]),(function(require,exports,arrays_1,event_1,iterator_1,map_1,network_1,uri_1,markers_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkerService=void 0;class DoubleResourceMap{constructor(){this._byResource=new map_1.ResourceMap,this._byOwner=new Map}set(resource,owner,value){let ownerMap=this._byResource.get(resource);ownerMap||(ownerMap=new Map,this._byResource.set(resource,ownerMap)),ownerMap.set(owner,value);let resourceMap=this._byOwner.get(owner);resourceMap||(resourceMap=new map_1.ResourceMap,this._byOwner.set(owner,resourceMap)),resourceMap.set(resource,value)}get(resource,owner){let ownerMap=this._byResource.get(resource);return null==ownerMap?void 0:ownerMap.get(owner)}delete(resource,owner){let removedA=!1,removedB=!1,ownerMap=this._byResource.get(resource);ownerMap&&(removedA=ownerMap.delete(owner));let resourceMap=this._byOwner.get(owner);if(resourceMap&&(removedB=resourceMap.delete(resource)),removedA!==removedB)throw new Error("illegal state");return removedA&&removedB}values(key){var _a,_b,_c,_d;return"string"==typeof key?null!==(_b=null===(_a=this._byOwner.get(key))||void 0===_a?void 0:_a.values())&&void 0!==_b?_b:iterator_1.Iterable.empty():uri_1.URI.isUri(key)?null!==(_d=null===(_c=this._byResource.get(key))||void 0===_c?void 0:_c.values())&&void 0!==_d?_d:iterator_1.Iterable.empty():iterator_1.Iterable.map(iterator_1.Iterable.concat(...this._byOwner.values()),(map=>map[1]))}}class MarkerStats{constructor(service){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new map_1.ResourceMap,this._service=service,this._subscription=service.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(resources){for(const resource of resources){const oldStats=this._data.get(resource);oldStats&&this._substract(oldStats);const newStats=this._resourceStats(resource);this._add(newStats),this._data.set(resource,newStats)}}_resourceStats(resource){const result={errors:0,warnings:0,infos:0,unknowns:0};if(resource.scheme===network_1.Schemas.inMemory||resource.scheme===network_1.Schemas.walkThrough||resource.scheme===network_1.Schemas.walkThroughSnippet)return result;for(const{severity}of this._service.read({resource}))severity===markers_1.MarkerSeverity.Error?result.errors+=1:severity===markers_1.MarkerSeverity.Warning?result.warnings+=1:severity===markers_1.MarkerSeverity.Info?result.infos+=1:result.unknowns+=1;return result}_substract(op){this.errors-=op.errors,this.warnings-=op.warnings,this.infos-=op.infos,this.unknowns-=op.unknowns}_add(op){this.errors+=op.errors,this.warnings+=op.warnings,this.infos+=op.infos,this.unknowns+=op.unknowns}}class MarkerService{constructor(){this._onMarkerChanged=new event_1.DebounceEmitter({delay:0,merge:MarkerService._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new DoubleResourceMap,this._stats=new MarkerStats(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(owner,resources){for(const resource of resources||[])this.changeOne(owner,resource,[])}changeOne(owner,resource,markerData){if((0,arrays_1.isFalsyOrEmpty)(markerData)){this._data.delete(resource,owner)&&this._onMarkerChanged.fire([resource])}else{const markers=[];for(const data of markerData){const marker=MarkerService._toMarker(owner,resource,data);marker&&markers.push(marker)}this._data.set(resource,owner,markers),this._onMarkerChanged.fire([resource])}}static _toMarker(owner,resource,data){let{code,severity,message,source,startLineNumber,startColumn,endLineNumber,endColumn,relatedInformation,tags}=data;if(message)return startLineNumber=startLineNumber>0?startLineNumber:1,startColumn=startColumn>0?startColumn:1,endLineNumber=endLineNumber>=startLineNumber?endLineNumber:startLineNumber,endColumn=endColumn>0?endColumn:startColumn,{resource,owner,code,severity,message,source,startLineNumber,startColumn,endLineNumber,endColumn,relatedInformation,tags}}read(filter=Object.create(null)){let{owner,resource,severities,take}=filter;if((!take||take<0)&&(take=-1),owner&&resource){const data=this._data.get(resource,owner);if(data){const result=[];for(const marker of data)if(MarkerService._accept(marker,severities)){const newLen=result.push(marker);if(take>0&&newLen===take)break}return result}return[]}if(owner||resource){const iterable=this._data.values(null!=resource?resource:owner),result=[];for(const markers of iterable)for(const data of markers)if(MarkerService._accept(data,severities)){const newLen=result.push(data);if(take>0&&newLen===take)return result}return result}{const result=[];for(let markers of this._data.values())for(let data of markers)if(MarkerService._accept(data,severities)){const newLen=result.push(data);if(take>0&&newLen===take)return result}return result}}static _accept(marker,severities){return void 0===severities||(severities&marker.severity)===marker.severity}static _merge(all){const set=new map_1.ResourceMap;for(let array of all)for(let item of array)set.set(item,!0);return Array.from(set.keys())}}exports.MarkerService=MarkerService})),define(__m[39],__M([1,0,76,9]),(function(require,exports,severity_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoOpNotification=exports.INotificationService=exports.Severity=void 0,exports.Severity=severity_1.default,exports.INotificationService=(0,instantiation_1.createDecorator)("notificationService");exports.NoOpNotification=class NoOpNotification{}})),define(__m[53],__M([1,0,2,8,25,9]),(function(require,exports,lifecycle_1,strings_1,uri_1,instantiation_1){"use strict";function matchesScheme(target,scheme){return uri_1.URI.isUri(target)?(0,strings_1.equalsIgnoreCase)(target.scheme,scheme):(0,strings_1.startsWithIgnoreCase)(target,scheme+":")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractSelection=exports.matchesSomeScheme=exports.matchesScheme=exports.NullOpenerService=exports.IOpenerService=void 0,exports.IOpenerService=(0,instantiation_1.createDecorator)("openerService"),exports.NullOpenerService=Object.freeze({_serviceBrand:void 0,registerOpener:()=>lifecycle_1.Disposable.None,registerValidator:()=>lifecycle_1.Disposable.None,registerExternalUriResolver:()=>lifecycle_1.Disposable.None,setDefaultExternalOpener(){},registerExternalOpener:()=>lifecycle_1.Disposable.None,open(){return __awaiter(this,void 0,void 0,(function*(){return!1}))},resolveExternalUri(uri){return __awaiter(this,void 0,void 0,(function*(){return{resolved:uri,dispose(){}}}))}}),exports.matchesScheme=matchesScheme,exports.matchesSomeScheme=function matchesSomeScheme(target,...schemes){return schemes.some((scheme=>matchesScheme(target,scheme)))},exports.extractSelection=function extractSelection(uri){let selection;const match=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(uri.fragment);return match&&(selection={startLineNumber:parseInt(match[1]),startColumn:match[2]?parseInt(match[2]):1,endLineNumber:match[4]?parseInt(match[4]):void 0,endColumn:match[4]?match[5]?parseInt(match[5]):1:void 0},uri=uri.with({fragment:""})),{selection,uri}}})),define(__m[628],__M([1,0,7,21,83,49,219,45,42,25,29,26,603,53]),(function(require,exports,dom,cancellation_1,linkedList_1,map_1,marshalling_1,network_1,resources_1,uri_1,codeEditorService_1,commands_1,editor_1,opener_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenerService=void 0;let CommandOpener=class CommandOpener{constructor(_commandService){this._commandService=_commandService}open(target,options){return __awaiter(this,void 0,void 0,(function*(){if(!(0,opener_1.matchesScheme)(target,network_1.Schemas.command))return!1;if(!(null==options?void 0:options.allowCommands))return!0;"string"==typeof target&&(target=uri_1.URI.parse(target));let args=[];try{args=(0,marshalling_1.parse)(decodeURIComponent(target.query))}catch(_a){try{args=(0,marshalling_1.parse)(target.query)}catch(_b){}}return Array.isArray(args)||(args=[args]),yield this._commandService.executeCommand(target.path,...args),!0}))}};CommandOpener=__decorate([__param(0,commands_1.ICommandService)],CommandOpener);let EditorOpener=class EditorOpener{constructor(_editorService){this._editorService=_editorService}open(target,options){return __awaiter(this,void 0,void 0,(function*(){"string"==typeof target&&(target=uri_1.URI.parse(target));const{selection,uri}=(0,opener_1.extractSelection)(target);return(target=uri).scheme===network_1.Schemas.file&&(target=(0,resources_1.normalizePath)(target)),yield this._editorService.openCodeEditor({resource:target,options:Object.assign({selection,source:(null==options?void 0:options.fromUserGesture)?editor_1.EditorOpenSource.USER:editor_1.EditorOpenSource.API},null==options?void 0:options.editorOptions)},this._editorService.getFocusedCodeEditor(),null==options?void 0:options.openToSide),!0}))}};EditorOpener=__decorate([__param(0,codeEditorService_1.ICodeEditorService)],EditorOpener);let OpenerService=class OpenerService{constructor(editorService,commandService){this._openers=new linkedList_1.LinkedList,this._validators=new linkedList_1.LinkedList,this._resolvers=new linkedList_1.LinkedList,this._resolvedUriTargets=new map_1.ResourceMap((uri=>uri.with({path:null,fragment:null,query:null}).toString())),this._externalOpeners=new linkedList_1.LinkedList,this._defaultExternalOpener={openExternal:href=>__awaiter(this,void 0,void 0,(function*(){return(0,opener_1.matchesSomeScheme)(href,network_1.Schemas.http,network_1.Schemas.https)?dom.windowOpenNoOpener(href):window.location.href=href,!0}))},this._openers.push({open:(target,options)=>__awaiter(this,void 0,void 0,(function*(){return!(!(null==options?void 0:options.openExternal)&&!(0,opener_1.matchesSomeScheme)(target,network_1.Schemas.mailto,network_1.Schemas.http,network_1.Schemas.https,network_1.Schemas.vsls))&&(yield this._doOpenExternal(target,options),!0)}))}),this._openers.push(new CommandOpener(commandService)),this._openers.push(new EditorOpener(editorService))}registerOpener(opener){return{dispose:this._openers.unshift(opener)}}registerValidator(validator){return{dispose:this._validators.push(validator)}}registerExternalUriResolver(resolver){return{dispose:this._resolvers.push(resolver)}}setDefaultExternalOpener(externalOpener){this._defaultExternalOpener=externalOpener}registerExternalOpener(opener){return{dispose:this._externalOpeners.push(opener)}}open(target,options){var _a;return __awaiter(this,void 0,void 0,(function*(){const targetURI="string"==typeof target?uri_1.URI.parse(target):target,validationTarget=null!==(_a=this._resolvedUriTargets.get(targetURI))&&void 0!==_a?_a:target;for(const validator of this._validators)if(!(yield validator.shouldOpen(validationTarget)))return!1;for(const opener of this._openers){if(yield opener.open(target,options))return!0}return!1}))}resolveExternalUri(resource,options){return __awaiter(this,void 0,void 0,(function*(){for(const resolver of this._resolvers)try{const result=yield resolver.resolveExternalUri(resource,options);if(result)return this._resolvedUriTargets.has(result.resolved)||this._resolvedUriTargets.set(result.resolved,resource),result}catch(_a){}throw new Error("Could not resolve external URI: "+resource.toString())}))}_doOpenExternal(resource,options){return __awaiter(this,void 0,void 0,(function*(){const uri="string"==typeof resource?uri_1.URI.parse(resource):resource;let externalUri,href;try{externalUri=(yield this.resolveExternalUri(uri,options)).resolved}catch(_a){externalUri=uri}if(href="string"==typeof resource&&uri.toString()===externalUri.toString()?resource:encodeURI(externalUri.toString(!0)),null==options?void 0:options.allowContributedOpeners){const preferredOpenerId="string"==typeof(null==options?void 0:options.allowContributedOpeners)?null==options?void 0:options.allowContributedOpeners:void 0;for(const opener of this._externalOpeners){if(yield opener.openExternal(href,{sourceUri:uri,preferredOpenerId},cancellation_1.CancellationToken.None))return!0}}return this._defaultExternalOpener.openExternal(href,{sourceUri:uri},cancellation_1.CancellationToken.None)}))}dispose(){this._validators.clear()}};OpenerService=__decorate([__param(0,codeEditorService_1.ICodeEditorService),__param(1,commands_1.ICommandService)],OpenerService),exports.OpenerService=OpenerService})),define(__m[73],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IEditorProgressService=exports.Progress=exports.emptyProgressRunner=void 0,exports.emptyProgressRunner=Object.freeze({total(){},worked(){},done(){}});class Progress{constructor(callback){this.callback=callback}report(item){this._value=item,this.callback(this._value)}}exports.Progress=Progress,Progress.None=Object.freeze({report(){}}),exports.IEditorProgressService=(0,instantiation_1.createDecorator)("editorProgressService")})),define(__m[629],__M([1,0,10,21,2]),(function(require,exports,async_1,cancellation_1,lifecycle_1){"use strict";var TriggerAction;function isPicksWithActive(obj){const candidate=obj;return Array.isArray(candidate.items)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PickerQuickAccessProvider=exports.TriggerAction=void 0,function(TriggerAction){TriggerAction[TriggerAction.NO_ACTION=0]="NO_ACTION",TriggerAction[TriggerAction.CLOSE_PICKER=1]="CLOSE_PICKER",TriggerAction[TriggerAction.REFRESH_PICKER=2]="REFRESH_PICKER",TriggerAction[TriggerAction.REMOVE_ITEM=3]="REMOVE_ITEM"}(TriggerAction=exports.TriggerAction||(exports.TriggerAction={}));class PickerQuickAccessProvider extends lifecycle_1.Disposable{constructor(prefix,options){super(),this.prefix=prefix,this.options=options}provide(picker,token){var _a;const disposables=new lifecycle_1.DisposableStore;let picksCts;picker.canAcceptInBackground=!!(null===(_a=this.options)||void 0===_a?void 0:_a.canAcceptInBackground),picker.matchOnLabel=picker.matchOnDescription=picker.matchOnDetail=picker.sortByLabel=!1;const picksDisposable=disposables.add(new lifecycle_1.MutableDisposable),updatePickerItems=()=>__awaiter(this,void 0,void 0,(function*(){const picksDisposables=picksDisposable.value=new lifecycle_1.DisposableStore;null==picksCts||picksCts.dispose(!0),picker.busy=!1,picksCts=new cancellation_1.CancellationTokenSource(token);const picksToken=picksCts.token,picksFilter=picker.value.substr(this.prefix.length).trim(),providedPicks=this._getPicks(picksFilter,picksDisposables,picksToken),applyPicks=(picks,skipEmpty)=>{var _a;let items,activeItem;if(isPicksWithActive(picks)?(items=picks.items,activeItem=picks.active):items=picks,0===items.length){if(skipEmpty)return!1;picksFilter.length>0&&(null===(_a=this.options)||void 0===_a?void 0:_a.noResultsPick)&&(items=[this.options.noResultsPick])}return picker.items=items,activeItem&&(picker.activeItems=[activeItem]),!0};if(null===providedPicks);else if(function isFastAndSlowPicks(obj){const candidate=obj;return!!candidate.picks&&candidate.additionalPicks instanceof Promise}(providedPicks)){let fastPicksApplied=!1,slowPicksApplied=!1;yield Promise.all([(()=>__awaiter(this,void 0,void 0,(function*(){yield(0,async_1.timeout)(PickerQuickAccessProvider.FAST_PICKS_RACE_DELAY),picksToken.isCancellationRequested||slowPicksApplied||(fastPicksApplied=applyPicks(providedPicks.picks,!0))})))(),(()=>__awaiter(this,void 0,void 0,(function*(){picker.busy=!0;try{const awaitedAdditionalPicks=yield providedPicks.additionalPicks;if(picksToken.isCancellationRequested)return;let picks,activePick,additionalPicks,additionalActivePick;if(isPicksWithActive(providedPicks.picks)?(picks=providedPicks.picks.items,activePick=providedPicks.picks.active):picks=providedPicks.picks,isPicksWithActive(awaitedAdditionalPicks)?(additionalPicks=awaitedAdditionalPicks.items,additionalActivePick=awaitedAdditionalPicks.active):additionalPicks=awaitedAdditionalPicks,additionalPicks.length>0||!fastPicksApplied){let fallbackActivePick;if(!activePick&&!additionalActivePick){const fallbackActivePickCandidate=picker.activeItems[0];fallbackActivePickCandidate&&-1!==picks.indexOf(fallbackActivePickCandidate)&&(fallbackActivePick=fallbackActivePickCandidate)}applyPicks({items:[...picks,...additionalPicks],active:activePick||additionalActivePick||fallbackActivePick})}}finally{picksToken.isCancellationRequested||(picker.busy=!1),slowPicksApplied=!0}})))()])}else if(providedPicks instanceof Promise){picker.busy=!0;try{const awaitedPicks=yield providedPicks;if(picksToken.isCancellationRequested)return;applyPicks(awaitedPicks)}finally{picksToken.isCancellationRequested||(picker.busy=!1)}}else applyPicks(providedPicks)}));return disposables.add(picker.onDidChangeValue((()=>updatePickerItems()))),updatePickerItems(),disposables.add(picker.onDidAccept((event=>{const[item]=picker.selectedItems;"function"==typeof(null==item?void 0:item.accept)&&(event.inBackground||picker.hide(),item.accept(picker.keyMods,event))}))),disposables.add(picker.onDidTriggerItemButton((({button,item})=>__awaiter(this,void 0,void 0,(function*(){var _b,_c;if("function"==typeof item.trigger){const buttonIndex=null!==(_c=null===(_b=item.buttons)||void 0===_b?void 0:_b.indexOf(button))&&void 0!==_c?_c:-1;if(buttonIndex>=0){const result=item.trigger(buttonIndex,picker.keyMods),action="number"==typeof result?result:yield result;if(token.isCancellationRequested)return;switch(action){case TriggerAction.NO_ACTION:break;case TriggerAction.CLOSE_PICKER:picker.hide();break;case TriggerAction.REFRESH_PICKER:updatePickerItems();break;case TriggerAction.REMOVE_ITEM:{const index=picker.items.indexOf(item);if(-1!==index){const items=picker.items.slice(),removed=items.splice(index,1),activeItems=picker.activeItems.filter((activeItem=>activeItem!==removed[0])),keepScrollPositionBefore=picker.keepScrollPosition;picker.keepScrollPosition=!0,picker.items=items,activeItems&&(picker.activeItems=activeItems),picker.keepScrollPosition=keepScrollPositionBefore}break}}}}}))))),disposables}}exports.PickerQuickAccessProvider=PickerQuickAccessProvider,PickerQuickAccessProvider.FAST_PICKS_RACE_DELAY=200}));var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};define(__m[80],__M([1,0,9,223]),(function(require,exports,instantiation_1,quickInput_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IQuickInputService=void 0,__exportStar(quickInput_1,exports),exports.IQuickInputService=(0,instantiation_1.createDecorator)("quickInputService")})),define(__m[36],__M([1,0,216,19]),(function(require,exports,Assert,Types){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Registry=void 0;exports.Registry=new class RegistryImpl{constructor(){this.data=new Map}add(id,data){Assert.ok(Types.isString(id)),Assert.ok(Types.isObject(data)),Assert.ok(!this.data.has(id),"There is already an extension with this id"),this.data.set(id,data)}as(id){return this.data.get(id)||null}}})),define(__m[206],__M([1,0,4,36]),(function(require,exports,event_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extensions=void 0,exports.Extensions={JSONContribution:"base.contributions.json"};const jsonContributionRegistry=new class JSONContributionRegistry{constructor(){this._onDidChangeSchema=new event_1.Emitter,this.schemasById={}}registerSchema(uri,unresolvedSchemaContent){this.schemasById[function normalizeId(id){return id.length>0&&"#"===id.charAt(id.length-1)?id.substring(0,id.length-1):id}(uri)]=unresolvedSchemaContent,this._onDidChangeSchema.fire(uri)}notifySchemaChanged(uri){this._onDidChangeSchema.fire(uri)}};platform.Registry.add(exports.Extensions.JSONContribution,jsonContributionRegistry)})),define(__m[105],__M([1,0,18,4,19,590,206,36]),(function(require,exports,arrays_1,event_1,types,nls,jsonContributionRegistry_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateProperty=exports.getDefaultValue=exports.overrideIdentifiersFromKey=exports.OVERRIDE_PROPERTY_REGEX=exports.OVERRIDE_PROPERTY_PATTERN=exports.resourceLanguageSettingsSchemaId=exports.resourceSettings=exports.windowSettings=exports.machineOverridableSettings=exports.machineSettings=exports.applicationSettings=exports.allSettings=exports.Extensions=void 0,exports.Extensions={Configuration:"base.contributions.configuration"},exports.allSettings={properties:{},patternProperties:{}},exports.applicationSettings={properties:{},patternProperties:{}},exports.machineSettings={properties:{},patternProperties:{}},exports.machineOverridableSettings={properties:{},patternProperties:{}},exports.windowSettings={properties:{},patternProperties:{}},exports.resourceSettings={properties:{},patternProperties:{}},exports.resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage";const contributionRegistry=platform_1.Registry.as(jsonContributionRegistry_1.Extensions.JSONContribution);const OVERRIDE_IDENTIFIER_REGEX=new RegExp("\\[([^\\]]+)\\]","g");function overrideIdentifiersFromKey(key){const identifiers=[];if(exports.OVERRIDE_PROPERTY_REGEX.test(key)){let matches=OVERRIDE_IDENTIFIER_REGEX.exec(key);for(;null==matches?void 0:matches.length;){const identifier=matches[1].trim();identifier&&identifiers.push(identifier),matches=OVERRIDE_IDENTIFIER_REGEX.exec(key)}}return(0,arrays_1.distinct)(identifiers)}function getDefaultValue(type){switch(Array.isArray(type)?type[0]:type){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}exports.OVERRIDE_PROPERTY_PATTERN="^(\\[([^\\]]+)\\])+$",exports.OVERRIDE_PROPERTY_REGEX=new RegExp(exports.OVERRIDE_PROPERTY_PATTERN),exports.overrideIdentifiersFromKey=overrideIdentifiersFromKey,exports.getDefaultValue=getDefaultValue;const configurationRegistry=new class ConfigurationRegistry{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new event_1.Emitter,this._onDidUpdateConfiguration=new event_1.Emitter,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:nls.localize(0,null),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},contributionRegistry.registerSchema(exports.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(configuration,validate=!0){this.registerConfigurations([configuration],validate)}registerConfigurations(configurations,validate=!0){const properties=this.doRegisterConfigurations(configurations,validate);contributionRegistry.registerSchema(exports.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties})}registerDefaultConfigurations(configurationDefaults){var _a;const properties=[],overrideIdentifiers=[];for(const{overrides,source}of configurationDefaults)for(const key in overrides)if(properties.push(key),exports.OVERRIDE_PROPERTY_REGEX.test(key)){const defaultValue=Object.assign(Object.assign({},(null===(_a=this.configurationDefaultsOverrides.get(key))||void 0===_a?void 0:_a.value)||{}),overrides[key]);this.configurationDefaultsOverrides.set(key,{source,value:defaultValue});const property={type:"object",default:defaultValue,description:nls.localize(1,null,key),$ref:exports.resourceLanguageSettingsSchemaId,defaultDefaultValue:defaultValue,source:types.isString(source)?void 0:source};overrideIdentifiers.push(...overrideIdentifiersFromKey(key)),this.configurationProperties[key]=property,this.defaultLanguageConfigurationOverridesNode.properties[key]=property}else{this.configurationDefaultsOverrides.set(key,{value:overrides[key],source});const property=this.configurationProperties[key];property&&(this.updatePropertyDefaultValue(key,property),this.updateSchema(key,property))}this.registerOverrideIdentifiers(overrideIdentifiers),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties,defaultsOverrides:!0})}registerOverrideIdentifiers(overrideIdentifiers){for(const overrideIdentifier of overrideIdentifiers)this.overrideIdentifiers.add(overrideIdentifier);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(configurations,validate){const properties=[];return configurations.forEach((configuration=>{properties.push(...this.validateAndRegisterProperties(configuration,validate,configuration.extensionInfo,configuration.restrictedProperties)),this.configurationContributors.push(configuration),this.registerJSONConfiguration(configuration)})),properties}validateAndRegisterProperties(configuration,validate=!0,extensionInfo,restrictedProperties,scope=3){scope=types.isUndefinedOrNull(configuration.scope)?scope:configuration.scope;let propertyKeys=[],properties=configuration.properties;if(properties)for(let key in properties){if(validate&&validateProperty(key)){delete properties[key];continue}const property=properties[key];property.source=extensionInfo,property.defaultDefaultValue=properties[key].default,this.updatePropertyDefaultValue(key,property),exports.OVERRIDE_PROPERTY_REGEX.test(key)?property.scope=void 0:(property.scope=types.isUndefinedOrNull(property.scope)?scope:property.scope,property.restricted=types.isUndefinedOrNull(property.restricted)?!!(null==restrictedProperties?void 0:restrictedProperties.includes(key)):property.restricted),!properties[key].hasOwnProperty("included")||properties[key].included?(this.configurationProperties[key]=properties[key],!properties[key].deprecationMessage&&properties[key].markdownDeprecationMessage&&(properties[key].deprecationMessage=properties[key].markdownDeprecationMessage),propertyKeys.push(key)):(this.excludedConfigurationProperties[key]=properties[key],delete properties[key])}let subNodes=configuration.allOf;if(subNodes)for(let node of subNodes)propertyKeys.push(...this.validateAndRegisterProperties(node,validate,extensionInfo,restrictedProperties,scope));return propertyKeys}getConfigurationProperties(){return this.configurationProperties}registerJSONConfiguration(configuration){const register=configuration=>{let properties=configuration.properties;if(properties)for(const key in properties)this.updateSchema(key,properties[key]);let subNodes=configuration.allOf;subNodes&&subNodes.forEach(register)};register(configuration)}updateSchema(key,property){switch(exports.allSettings.properties[key]=property,property.scope){case 1:exports.applicationSettings.properties[key]=property;break;case 2:exports.machineSettings.properties[key]=property;break;case 6:exports.machineOverridableSettings.properties[key]=property;break;case 3:exports.windowSettings.properties[key]=property;break;case 4:exports.resourceSettings.properties[key]=property;break;case 5:exports.resourceSettings.properties[key]=property,this.resourceLanguageSettingsSchema.properties[key]=property}}updateOverridePropertyPatternKey(){for(const overrideIdentifier of this.overrideIdentifiers.values()){const overrideIdentifierProperty=`[${overrideIdentifier}]`,resourceLanguagePropertiesSchema={type:"object",description:nls.localize(2,null),errorMessage:nls.localize(3,null),$ref:exports.resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(overrideIdentifierProperty,resourceLanguagePropertiesSchema),exports.allSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema,exports.applicationSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema,exports.machineSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema,exports.machineOverridableSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema,exports.windowSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema,exports.resourceSettings.properties[overrideIdentifierProperty]=resourceLanguagePropertiesSchema}this._onDidSchemaChange.fire()}registerOverridePropertyPatternKey(){const resourceLanguagePropertiesSchema={type:"object",description:nls.localize(4,null),errorMessage:nls.localize(5,null),$ref:exports.resourceLanguageSettingsSchemaId};exports.allSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,exports.applicationSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,exports.machineSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,exports.machineOverridableSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,exports.windowSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,exports.resourceSettings.patternProperties[exports.OVERRIDE_PROPERTY_PATTERN]=resourceLanguagePropertiesSchema,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(key,property){const configurationdefaultOverride=this.configurationDefaultsOverrides.get(key);let defaultValue=null==configurationdefaultOverride?void 0:configurationdefaultOverride.value,defaultSource=null==configurationdefaultOverride?void 0:configurationdefaultOverride.source;types.isUndefined(defaultValue)&&(defaultValue=property.defaultDefaultValue,defaultSource=void 0),types.isUndefined(defaultValue)&&(defaultValue=getDefaultValue(property.type)),property.default=defaultValue,property.defaultValueSource=defaultSource}};function validateProperty(property){return property.trim()?exports.OVERRIDE_PROPERTY_REGEX.test(property)?nls.localize(7,null,property):void 0!==configurationRegistry.getConfigurationProperties()[property]?nls.localize(8,null,property):null:nls.localize(6,null)}platform_1.Registry.add(exports.Extensions.Configuration,configurationRegistry),exports.validateProperty=validateProperty})),define(__m[630],__M([1,0,32,148,512,105,36]),(function(require,exports,editorOptions_1,textModelDefaults_1,nls,configurationRegistry_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDiffEditorConfigurationKey=exports.isEditorConfigurationKey=exports.editorConfigurationBaseNode=void 0,exports.editorConfigurationBaseNode=Object.freeze({id:"editor",order:5,type:"object",title:nls.localize(0,null),scope:5});const editorConfiguration=Object.assign(Object.assign({},exports.editorConfigurationBaseNode),{properties:{"editor.tabSize":{type:"number",default:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.tabSize,minimum:1,markdownDescription:nls.localize(1,null)},"editor.insertSpaces":{type:"boolean",default:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.insertSpaces,markdownDescription:nls.localize(2,null)},"editor.detectIndentation":{type:"boolean",default:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.detectIndentation,markdownDescription:nls.localize(3,null)},"editor.trimAutoWhitespace":{type:"boolean",default:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,description:nls.localize(4,null)},"editor.largeFileOptimizations":{type:"boolean",default:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.largeFileOptimizations,description:nls.localize(5,null)},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:nls.localize(6,null)},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[nls.localize(7,null),nls.localize(8,null),nls.localize(9,null)],description:nls.localize(10,null)},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[nls.localize(11,null),nls.localize(12,null),nls.localize(13,null)],default:"configuredByTheme",description:nls.localize(14,null)},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:nls.localize(15,null)},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:nls.localize(16,null)},"editor.language.brackets":{type:"array",default:!1,description:nls.localize(17,null),items:{type:"array",items:[{type:"string",description:nls.localize(18,null)},{type:"string",description:nls.localize(19,null)}]}},"editor.language.colorizedBracketPairs":{type:"array",default:!1,description:nls.localize(20,null),items:{type:"array",items:[{type:"string",description:nls.localize(21,null)},{type:"string",description:nls.localize(22,null)}]}},"diffEditor.maxComputationTime":{type:"number",default:5e3,description:nls.localize(23,null)},"diffEditor.maxFileSize":{type:"number",default:50,description:nls.localize(24,null)},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:nls.localize(25,null)},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:nls.localize(26,null)},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:nls.localize(27,null)},"diffEditor.codeLens":{type:"boolean",default:!1,description:nls.localize(28,null)},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:"inherit",markdownEnumDescriptions:[nls.localize(29,null),nls.localize(30,null),nls.localize(31,null)]}}});for(const editorOption of editorOptions_1.editorOptionsRegistry){const schema=editorOption.schema;if(void 0!==schema)if(void 0!==(x=schema).type||void 0!==x.anyOf)editorConfiguration.properties[`editor.${editorOption.name}`]=schema;else for(const key in schema)Object.hasOwnProperty.call(schema,key)&&(editorConfiguration.properties[key]=schema[key])}var x;let cachedEditorConfigurationKeys=null;function getEditorConfigurationKeys(){return null===cachedEditorConfigurationKeys&&(cachedEditorConfigurationKeys=Object.create(null),Object.keys(editorConfiguration.properties).forEach((prop=>{cachedEditorConfigurationKeys[prop]=!0}))),cachedEditorConfigurationKeys}exports.isEditorConfigurationKey=function isEditorConfigurationKey(key){return getEditorConfigurationKeys()[`editor.${key}`]||!1},exports.isDiffEditorConfigurationKey=function isDiffEditorConfigurationKey(key){return getEditorConfigurationKeys()[`diffEditor.${key}`]||!1};platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).registerConfiguration(editorConfiguration)})),define(__m[81],__M([1,0,520,4,33,36,138,105]),(function(require,exports,nls,event_1,languageConfigurationRegistry_1,platform_1,mime_1,configurationRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PLAINTEXT_EXTENSION=exports.PLAINTEXT_LANGUAGE_ID=exports.ModesRegistry=exports.EditorModesRegistry=exports.Extensions=void 0,exports.Extensions={ModesRegistry:"editor.modesRegistry"};class EditorModesRegistry{constructor(){this._onDidChangeLanguages=new event_1.Emitter,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(def){return this._languages.push(def),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let i=0,len=this._languages.length;i<len;i++)if(this._languages[i]===def)return void this._languages.splice(i,1)}}}getLanguages(){return this._languages}}exports.EditorModesRegistry=EditorModesRegistry,exports.ModesRegistry=new EditorModesRegistry,platform_1.Registry.add(exports.Extensions.ModesRegistry,exports.ModesRegistry),exports.PLAINTEXT_LANGUAGE_ID="plaintext",exports.PLAINTEXT_EXTENSION=".txt",exports.ModesRegistry.registerLanguage({id:exports.PLAINTEXT_LANGUAGE_ID,extensions:[exports.PLAINTEXT_EXTENSION],aliases:[nls.localize(0,null),"text"],mimetypes:[mime_1.Mimes.text]}),languageConfigurationRegistry_1.LanguageConfigurationRegistry.register(exports.PLAINTEXT_LANGUAGE_ID,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0),platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}])})),define(__m[631],__M([1,0,45,42,81,273]),(function(require,exports,network_1,resources_1,modesRegistry_1,files_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cssEscape=exports.getIconClasses=void 0;const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function cssEscape(str){return str.replace(/[\11\12\14\15\40]/g,"/")}exports.getIconClasses=function getIconClasses(modelService,languageService,resource,fileKind){const classes=fileKind===files_1.FileKind.ROOT_FOLDER?["rootfolder-icon"]:fileKind===files_1.FileKind.FOLDER?["folder-icon"]:["file-icon"];if(resource){let name;if(resource.scheme===network_1.Schemas.data){name=resources_1.DataUri.parseMetaData(resource).get(resources_1.DataUri.META_DATA_LABEL)}else{const match=resource.path.match(fileIconDirectoryRegex);match?(name=cssEscape(match[2].toLowerCase()),match[1]&&classes.push(`${cssEscape(match[1].toLowerCase())}-name-dir-icon`)):name=cssEscape(resource.authority.toLowerCase())}if(fileKind===files_1.FileKind.FOLDER)classes.push(`${name}-name-folder-icon`);else{if(name){if(classes.push(`${name}-name-file-icon`),classes.push("name-file-icon"),name.length<=255){const dotSegments=name.split(".");for(let i=1;i<dotSegments.length;i++)classes.push(`${dotSegments.slice(i).join(".")}-ext-file-icon`)}classes.push("ext-file-icon")}const detectedLanguageId=function detectLanguageId(modelService,languageService,resource){if(!resource)return null;let languageId=null;if(resource.scheme===network_1.Schemas.data){const mime=resources_1.DataUri.parseMetaData(resource).get(resources_1.DataUri.META_DATA_MIME);mime&&(languageId=languageService.getLanguageIdByMimeType(mime))}else{const model=modelService.getModel(resource);model&&(languageId=model.getLanguageId())}if(languageId&&languageId!==modesRegistry_1.PLAINTEXT_LANGUAGE_ID)return languageId;return languageService.guessLanguageIdByFilepathOrFirstLine(resource)}(modelService,languageService,resource);detectedLanguageId&&classes.push(`${cssEscape(detectedLanguageId)}-lang-file-icon`)}}return classes},exports.cssEscape=cssEscape})),define(__m[632],__M([1,0,18,13,4,2,8,430,81,105,36,33]),(function(require,exports,arrays_1,errors_1,event_1,lifecycle_1,strings_1,languagesAssociations_1,modesRegistry_1,configurationRegistry_1,platform_1,languageConfigurationRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguagesRegistry=exports.LanguageIdCodec=void 0;const hasOwnProperty=Object.prototype.hasOwnProperty;languageConfigurationRegistry_1.LanguageConfigurationRegistry.register("vs.editor.nullLanguage",{});class LanguageIdCodec{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register("vs.editor.nullLanguage",0),this._register(modesRegistry_1.PLAINTEXT_LANGUAGE_ID,1),this._nextLanguageId=2}_register(language,languageId){this._languageIdToLanguage[languageId]=language,this._languageToLanguageId.set(language,languageId)}register(language){if(this._languageToLanguageId.has(language))return;const languageId=this._nextLanguageId++;this._register(language,languageId)}encodeLanguageId(languageId){return this._languageToLanguageId.get(languageId)||0}decodeLanguageId(languageId){return this._languageIdToLanguage[languageId]||"vs.editor.nullLanguage"}}exports.LanguageIdCodec=LanguageIdCodec;class LanguagesRegistry extends lifecycle_1.Disposable{constructor(useModesRegistry=!0,warnOnOverwrite=!1){super(),this._onDidChange=this._register(new event_1.Emitter),this.onDidChange=this._onDidChange.event,LanguagesRegistry.instanceCount++,this._warnOnOverwrite=warnOnOverwrite,this.languageIdCodec=new LanguageIdCodec,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},useModesRegistry&&(this._initializeFromRegistry(),this._register(modesRegistry_1.ModesRegistry.onDidChangeLanguages((m=>{this._initializeFromRegistry()}))))}dispose(){LanguagesRegistry.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},(0,languagesAssociations_1.clearPlatformLanguageAssociations)();const desc=[].concat(modesRegistry_1.ModesRegistry.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(desc)}_registerLanguages(desc){for(const d of desc)this._registerLanguage(d);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach((langId=>{const language=this._languages[langId];language.name&&(this._nameMap[language.name]=language.identifier),language.aliases.forEach((alias=>{this._lowercaseNameMap[alias.toLowerCase()]=language.identifier})),language.mimetypes.forEach((mimetype=>{this._mimeTypesMap[mimetype]=language.identifier}))})),platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(lang){const langId=lang.id;let resolvedLanguage;hasOwnProperty.call(this._languages,langId)?resolvedLanguage=this._languages[langId]:(this.languageIdCodec.register(langId),resolvedLanguage={identifier:langId,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[langId]=resolvedLanguage),this._mergeLanguage(resolvedLanguage,lang)}_mergeLanguage(resolvedLanguage,lang){const langId=lang.id;let primaryMime=null;if(Array.isArray(lang.mimetypes)&&lang.mimetypes.length>0&&(resolvedLanguage.mimetypes.push(...lang.mimetypes),primaryMime=lang.mimetypes[0]),primaryMime||(primaryMime=`text/x-${langId}`,resolvedLanguage.mimetypes.push(primaryMime)),Array.isArray(lang.extensions)){lang.configuration?resolvedLanguage.extensions=lang.extensions.concat(resolvedLanguage.extensions):resolvedLanguage.extensions=resolvedLanguage.extensions.concat(lang.extensions);for(let extension of lang.extensions)(0,languagesAssociations_1.registerPlatformLanguageAssociation)({id:langId,mime:primaryMime,extension},this._warnOnOverwrite)}if(Array.isArray(lang.filenames))for(let filename of lang.filenames)(0,languagesAssociations_1.registerPlatformLanguageAssociation)({id:langId,mime:primaryMime,filename},this._warnOnOverwrite),resolvedLanguage.filenames.push(filename);if(Array.isArray(lang.filenamePatterns))for(let filenamePattern of lang.filenamePatterns)(0,languagesAssociations_1.registerPlatformLanguageAssociation)({id:langId,mime:primaryMime,filepattern:filenamePattern},this._warnOnOverwrite);if("string"==typeof lang.firstLine&&lang.firstLine.length>0){let firstLineRegexStr=lang.firstLine;"^"!==firstLineRegexStr.charAt(0)&&(firstLineRegexStr="^"+firstLineRegexStr);try{const firstLineRegex=new RegExp(firstLineRegexStr);(0,strings_1.regExpLeadsToEndlessLoop)(firstLineRegex)||(0,languagesAssociations_1.registerPlatformLanguageAssociation)({id:langId,mime:primaryMime,firstline:firstLineRegex},this._warnOnOverwrite)}catch(err){(0,errors_1.onUnexpectedError)(err)}}resolvedLanguage.aliases.push(langId);let langAliases=null;if(void 0!==lang.aliases&&Array.isArray(lang.aliases)&&(langAliases=0===lang.aliases.length?[null]:lang.aliases),null!==langAliases)for(const langAlias of langAliases)langAlias&&0!==langAlias.length&&resolvedLanguage.aliases.push(langAlias);const containsAliases=null!==langAliases&&langAliases.length>0;if(containsAliases&&null===langAliases[0]);else{const bestName=(containsAliases?langAliases[0]:null)||langId;!containsAliases&&resolvedLanguage.name||(resolvedLanguage.name=bestName)}lang.configuration&&resolvedLanguage.configurationFiles.push(lang.configuration),lang.icon&&resolvedLanguage.icons.push(lang.icon)}isRegisteredLanguageId(languageId){return!!languageId&&hasOwnProperty.call(this._languages,languageId)}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(languageName){const languageNameLower=languageName.toLowerCase();return hasOwnProperty.call(this._lowercaseNameMap,languageNameLower)?this._lowercaseNameMap[languageNameLower]:null}getLanguageIdByMimeType(mimeType){return mimeType&&hasOwnProperty.call(this._mimeTypesMap,mimeType)?this._mimeTypesMap[mimeType]:null}guessLanguageIdByFilepathOrFirstLine(resource,firstLine){if(!resource&&!firstLine)return[];const mimeTypes=(0,languagesAssociations_1.getMimeTypes)(resource,firstLine);return(0,arrays_1.coalesce)(mimeTypes.map((mimeType=>this.getLanguageIdByMimeType(mimeType))))}}exports.LanguagesRegistry=LanguagesRegistry,LanguagesRegistry.instanceCount=0})),define(__m[633],__M([1,0,4,2,632,18,27,81]),(function(require,exports,event_1,lifecycle_1,languagesRegistry_1,arrays_1,languages_1,modesRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LanguageService=void 0;class LanguageService extends lifecycle_1.Disposable{constructor(warnOnOverwrite=!1){super(),this._onDidEncounterLanguage=this._register(new event_1.Emitter),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event,this._onDidChange=this._register(new event_1.Emitter({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,LanguageService.instanceCount++,this._encounteredLanguages=new Set,this._registry=this._register(new languagesRegistry_1.LanguagesRegistry(!0,warnOnOverwrite)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange((()=>this._onDidChange.fire())))}dispose(){LanguageService.instanceCount--,super.dispose()}isRegisteredLanguageId(languageId){return this._registry.isRegisteredLanguageId(languageId)}getLanguageIdByLanguageName(languageName){return this._registry.getLanguageIdByLanguageName(languageName)}getLanguageIdByMimeType(mimeType){return this._registry.getLanguageIdByMimeType(mimeType)}guessLanguageIdByFilepathOrFirstLine(resource,firstLine){const languageIds=this._registry.guessLanguageIdByFilepathOrFirstLine(resource,firstLine);return(0,arrays_1.firstOrDefault)(languageIds,null)}createById(languageId){return new LanguageSelection(this.onDidChange,(()=>this._createAndGetLanguageIdentifier(languageId)))}createByFilepathOrFirstLine(resource,firstLine){return new LanguageSelection(this.onDidChange,(()=>{const languageId=this.guessLanguageIdByFilepathOrFirstLine(resource,firstLine);return this._createAndGetLanguageIdentifier(languageId)}))}_createAndGetLanguageIdentifier(languageId){return languageId&&this.isRegisteredLanguageId(languageId)||(languageId=modesRegistry_1.PLAINTEXT_LANGUAGE_ID),this._encounteredLanguages.has(languageId)||(this._encounteredLanguages.add(languageId),languages_1.TokenizationRegistry.getOrCreate(languageId),this._onDidEncounterLanguage.fire(languageId)),languageId}}exports.LanguageService=LanguageService,LanguageService.instanceCount=0;class LanguageSelection{constructor(_onDidChangeLanguages,_selector){this._onDidChangeLanguages=_onDidChangeLanguages,this._selector=_selector,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages((()=>this._evaluate()))),this._emitter||(this._emitter=new event_1.Emitter({onLastListenerRemove:()=>{this._dispose()}})),this._emitter.event}_evaluate(){const languageId=this._selector();languageId!==this.languageId&&(this.languageId=languageId,this._emitter&&this._emitter.fire(this.languageId))}}})),define(__m[106],__M([1,0,327,53,35,13,253,4,2,64,81]),(function(require,exports,markdownRenderer_1,opener_1,language_1,errors_1,textToHtmlTokenizer_1,event_1,lifecycle_1,domFontInfo_1,modesRegistry_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkdownRenderer=void 0;let MarkdownRenderer=class MarkdownRenderer{constructor(_options,_languageService,_openerService){this._options=_options,this._languageService=_languageService,this._openerService=_openerService,this._onDidRenderAsync=new event_1.Emitter,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(markdown,options,markedOptions){if(!markdown){return{element:document.createElement("span"),dispose:()=>{}}}const disposables=new lifecycle_1.DisposableStore;return{element:disposables.add((0,markdownRenderer_1.renderMarkdown)(markdown,Object.assign(Object.assign({},this._getRenderOptions(markdown,disposables)),options),markedOptions)).element,dispose:()=>disposables.dispose()}}_getRenderOptions(markdown,disposeables){return{codeBlockRenderer:(languageAlias,value)=>__awaiter(this,void 0,void 0,(function*(){var _a,_b,_c;let languageId;languageAlias?languageId=this._languageService.getLanguageIdByLanguageName(languageAlias):this._options.editor&&(languageId=null===(_a=this._options.editor.getModel())||void 0===_a?void 0:_a.getLanguageId()),languageId||(languageId=modesRegistry_1.PLAINTEXT_LANGUAGE_ID);const html=yield(0,textToHtmlTokenizer_1.tokenizeToString)(this._languageService,value,languageId),element=document.createElement("span");if(element.innerHTML=null!==(_c=null===(_b=MarkdownRenderer._ttpTokenizer)||void 0===_b?void 0:_b.createHTML(html))&&void 0!==_c?_c:html,this._options.editor){const fontInfo=this._options.editor.getOption(44);(0,domFontInfo_1.applyFontInfo)(element,fontInfo)}else this._options.codeBlockFontFamily&&(element.style.fontFamily=this._options.codeBlockFontFamily);return element})),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:content=>this._openerService.open(content,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:markdown.isTrusted}).catch(errors_1.onUnexpectedError),disposables:disposeables}}}};MarkdownRenderer._ttpTokenizer=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("tokenizeToString",{createHTML:html=>html}),MarkdownRenderer=__decorate([__param(1,language_1.ILanguageService),__param(2,opener_1.IOpenerService)],MarkdownRenderer),exports.MarkdownRenderer=MarkdownRenderer})),define(__m[634],__M([1,0,7,18,68,2,106,260,53,230]),(function(require,exports,dom,arrays_1,htmlContent_1,lifecycle_1,markdownRenderer_1,hoverOperation_1,opener_1,hoverWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarginHoverWidget=void 0;const $=dom.$;class MarginHoverWidget extends lifecycle_1.Disposable{constructor(editor,languageService,openerService=opener_1.NullOpenerService){super(),this._renderDisposeables=this._register(new lifecycle_1.DisposableStore),this._editor=editor,this._isVisible=!1,this._messages=[],this._hover=this._register(new hoverWidget_1.HoverWidget),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new markdownRenderer_1.MarkdownRenderer({editor:this._editor},languageService,openerService)),this._computer=new MarginHoverComputer(this._editor),this._hoverOperation=this._register(new hoverOperation_1.HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult((result=>{this._withResult(result.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return MarginHoverWidget.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((node=>this._editor.applyFontInfo(node)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(lineNumber){this._computer.lineNumber!==lineNumber&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=lineNumber,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(result){this._messages=result,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(lineNumber,messages){this._renderDisposeables.clear();const fragment=document.createDocumentFragment();for(const msg of messages){const markdownHoverElement=$("div.hover-row.markdown-hover"),hoverContentsElement=dom.append(markdownHoverElement,$("div.hover-contents")),renderedContents=this._renderDisposeables.add(this._markdownRenderer.render(msg.value));hoverContentsElement.appendChild(renderedContents.element),fragment.appendChild(markdownHoverElement)}this._updateContents(fragment),this._showAt(lineNumber)}_updateContents(node){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(node),this._updateFont()}_showAt(lineNumber){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const editorLayout=this._editor.getLayoutInfo(),topForLineNumber=this._editor.getTopForLineNumber(lineNumber),editorScrollTop=this._editor.getScrollTop(),lineHeight=this._editor.getOption(59),top=topForLineNumber-editorScrollTop-(this._hover.containerDomNode.clientHeight-lineHeight)/2;this._hover.containerDomNode.style.left=`${editorLayout.glyphMarginLeft+editorLayout.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(top),0)}px`}}exports.MarginHoverWidget=MarginHoverWidget,MarginHoverWidget.ID="editor.contrib.modesGlyphHoverWidget";class MarginHoverComputer{constructor(_editor){this._editor=_editor,this._lineNumber=-1}get lineNumber(){return this._lineNumber}set lineNumber(value){this._lineNumber=value}computeSync(){const toHoverMessage=contents=>({value:contents}),lineDecorations=this._editor.getLineDecorations(this._lineNumber),result=[];if(!lineDecorations)return result;for(const d of lineDecorations){if(!d.options.glyphMarginClassName)continue;const hoverMessage=d.options.glyphMarginHoverMessage;hoverMessage&&!(0,htmlContent_1.isEmptyMarkdownString)(hoverMessage)&&result.push(...(0,arrays_1.asArray)(hoverMessage).map(toHoverMessage))}return result}}})),define(__m[282],__M([1,0,34,7,69,28,4,68,2,106,32,265,579,9]),(function(require,exports,browser_1,dom,scrollableElement_1,codicons_1,event_1,htmlContent_1,lifecycle_1,markdownRenderer_1,editorOptions_1,resizable_1,nls,instantiation_1){"use strict";function canExpandCompletionItem(item){return!!item&&Boolean(item.completion.documentation||item.completion.detail&&item.completion.detail!==item.completion.label)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestDetailsOverlay=exports.SuggestDetailsWidget=exports.canExpandCompletionItem=void 0,exports.canExpandCompletionItem=canExpandCompletionItem;let SuggestDetailsWidget=class SuggestDetailsWidget{constructor(_editor,instaService){this._editor=_editor,this._onDidClose=new event_1.Emitter,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new event_1.Emitter,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new lifecycle_1.DisposableStore,this._renderDisposeable=new lifecycle_1.DisposableStore,this._borderWidth=1,this._size=new dom.Dimension(330,0),this.domNode=dom.$(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=instaService.createInstance(markdownRenderer_1.MarkdownRenderer,{editor:_editor}),this._body=dom.$(".body"),this._scrollbar=new scrollableElement_1.DomScrollableElement(this._body,{}),dom.append(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=dom.append(this._body,dom.$(".header")),this._close=dom.append(this._header,dom.$("span"+codicons_1.Codicon.close.cssSelector)),this._close.title=nls.localize(0,null),this._type=dom.append(this._header,dom.$("p.type")),this._docs=dom.append(this._body,dom.$("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._configureFont()})))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const options=this._editor.getOptions(),fontInfo=options.get(44),fontFamily=fontInfo.getMassagedFontFamily(browser_1.isSafari?editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily:null),fontSize=options.get(107)||fontInfo.fontSize,lineHeight=options.get(108)||fontInfo.lineHeight,fontWeight=fontInfo.fontWeight,fontSizePx=`${fontSize}px`,lineHeightPx=`${lineHeight}px`;this.domNode.style.fontSize=fontSizePx,this.domNode.style.lineHeight=""+lineHeight/fontSize,this.domNode.style.fontWeight=fontWeight,this.domNode.style.fontFeatureSettings=fontInfo.fontFeatureSettings,this._type.style.fontFamily=fontFamily,this._close.style.height=lineHeightPx,this._close.style.width=lineHeightPx}getLayoutInfo(){const lineHeight=this._editor.getOption(108)||this._editor.getOption(44).lineHeight,borderWidth=this._borderWidth;return{lineHeight,borderWidth,borderHeight:2*borderWidth,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=nls.localize(1,null),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,2*this.getLayoutInfo().lineHeight),this._onDidChangeContents.fire(this)}renderItem(item,explainMode){var _a,_b;this._renderDisposeable.clear();let{detail,documentation}=item.completion;if(explainMode){let md="";md+=`score: ${item.score[0]}\n`,md+=`prefix: ${null!==(_a=item.word)&&void 0!==_a?_a:"(no prefix)"}\n`,md+=`word: ${item.completion.filterText?item.completion.filterText+" (filterText)":item.textLabel}\n`,md+=`distance: ${item.distance} (localityBonus-setting)\n`,md+=`index: ${item.idx}, based on ${item.completion.sortText&&`sortText: "${item.completion.sortText}"`||"label"}\n`,md+=`commit_chars: ${null===(_b=item.completion.commitCharacters)||void 0===_b?void 0:_b.join("")}\n`,documentation=(new htmlContent_1.MarkdownString).appendCodeblock("empty",md),detail=`Provider: ${item.provider._debugDisplayName}`}if(explainMode||canExpandCompletionItem(item)){if(this.domNode.classList.remove("no-docs","no-type"),detail){const cappedDetail=detail.length>1e5?`${detail.substr(0,1e5)}…`:detail;this._type.textContent=cappedDetail,this._type.title=cappedDetail,dom.show(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gim.test(cappedDetail))}else dom.clearNode(this._type),this._type.title="",dom.hide(this._type),this.domNode.classList.add("no-type");if(dom.clearNode(this._docs),"string"==typeof documentation)this._docs.classList.remove("markdown-docs"),this._docs.textContent=documentation;else if(documentation){this._docs.classList.add("markdown-docs"),dom.clearNode(this._docs);const renderedContents=this._markdownRenderer.render(documentation);this._docs.appendChild(renderedContents.element),this._renderDisposeable.add(renderedContents),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync((()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)})))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=e=>{e.preventDefault(),e.stopPropagation()},this._close.onclick=e=>{e.preventDefault(),e.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}else this.clearContents()}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get size(){return this._size}layout(width,height){const newSize=new dom.Dimension(width,height);dom.Dimension.equals(newSize,this._size)||(this._size=newSize,dom.size(this.domNode,width,height)),this._scrollbar.scanDomNode()}scrollDown(much=8){this._body.scrollTop+=much}scrollUp(much=8){this._body.scrollTop-=much}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(width){this._borderWidth=width}get borderWidth(){return this._borderWidth}};SuggestDetailsWidget=__decorate([__param(1,instantiation_1.IInstantiationService)],SuggestDetailsWidget),exports.SuggestDetailsWidget=SuggestDetailsWidget;exports.SuggestDetailsOverlay=class SuggestDetailsOverlay{constructor(widget,_editor){let topLeftNow,sizeNow;this.widget=widget,this._editor=_editor,this._disposables=new lifecycle_1.DisposableStore,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new resizable_1.ResizableHTMLElement,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(widget.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let deltaTop=0,deltaLeft=0;this._disposables.add(this._resizable.onDidWillResize((()=>{topLeftNow=this._topLeft,sizeNow=this._resizable.size}))),this._disposables.add(this._resizable.onDidResize((e=>{if(topLeftNow&&sizeNow){this.widget.layout(e.dimension.width,e.dimension.height);let updateTopLeft=!1;e.west&&(deltaLeft=sizeNow.width-e.dimension.width,updateTopLeft=!0),e.north&&(deltaTop=sizeNow.height-e.dimension.height,updateTopLeft=!0),updateTopLeft&&this._applyTopLeft({top:topLeftNow.top+deltaTop,left:topLeftNow.left+deltaLeft})}e.done&&(topLeftNow=void 0,sizeNow=void 0,deltaTop=0,deltaLeft=0,this._userSize=e.dimension)}))),this._disposables.add(this.widget.onDidChangeContents((()=>{var _a;this._anchorBox&&this._placeAtAnchor(this._anchorBox,null!==(_a=this._userSize)&&void 0!==_a?_a:this.widget.size,this._preferAlignAtTop)})))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}hide(sessionEnded=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),sessionEnded&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(anchor,preferAlignAtTop){var _a;const anchorBox=anchor.getBoundingClientRect();this._anchorBox=anchorBox,this._preferAlignAtTop=preferAlignAtTop,this._placeAtAnchor(this._anchorBox,null!==(_a=this._userSize)&&void 0!==_a?_a:this.widget.size,preferAlignAtTop)}_placeAtAnchor(anchorBox,size,preferAlignAtTop){var _a;const bodyBox=dom.getClientArea(document.body),info=this.widget.getLayoutInfo(),defaultMinSize=new dom.Dimension(220,2*info.lineHeight),defaultTop=anchorBox.top,eastPlacement=function(){const width=bodyBox.width-(anchorBox.left+anchorBox.width+info.borderWidth+info.horizontalPadding),left=-info.borderWidth+anchorBox.left+anchorBox.width,maxSizeTop=new dom.Dimension(width,bodyBox.height-anchorBox.top-info.borderHeight-info.verticalPadding),maxSizeBottom=maxSizeTop.with(void 0,anchorBox.top+anchorBox.height-info.borderHeight-info.verticalPadding);return{top:defaultTop,left,fit:width-size.width,maxSizeTop,maxSizeBottom,minSize:defaultMinSize.with(Math.min(width,defaultMinSize.width))}}(),placements=[eastPlacement,function(){const width=anchorBox.left-info.borderWidth-info.horizontalPadding,left=Math.max(info.horizontalPadding,anchorBox.left-size.width-info.borderWidth),maxSizeTop=new dom.Dimension(width,bodyBox.height-anchorBox.top-info.borderHeight-info.verticalPadding),maxSizeBottom=maxSizeTop.with(void 0,anchorBox.top+anchorBox.height-info.borderHeight-info.verticalPadding);return{top:defaultTop,left,fit:width-size.width,maxSizeTop,maxSizeBottom,minSize:defaultMinSize.with(Math.min(width,defaultMinSize.width))}}(),function(){const left=anchorBox.left,top=-info.borderWidth+anchorBox.top+anchorBox.height,maxSizeBottom=new dom.Dimension(anchorBox.width-info.borderHeight,bodyBox.height-anchorBox.top-anchorBox.height-info.verticalPadding);return{top,left,fit:maxSizeBottom.height-size.height,maxSizeBottom,maxSizeTop:maxSizeBottom,minSize:defaultMinSize.with(maxSizeBottom.width)}}()],placement=null!==(_a=placements.find((p=>p.fit>=0)))&&void 0!==_a?_a:placements.sort(((a,b)=>b.fit-a.fit))[0],bottom=anchorBox.top+anchorBox.height-info.borderHeight;let alignAtTop,height=size.height;const maxHeight=Math.max(placement.maxSizeTop.height,placement.maxSizeBottom.height);let maxSize;height>maxHeight&&(height=maxHeight),preferAlignAtTop?height<=placement.maxSizeTop.height?(alignAtTop=!0,maxSize=placement.maxSizeTop):(alignAtTop=!1,maxSize=placement.maxSizeBottom):height<=placement.maxSizeBottom.height?(alignAtTop=!1,maxSize=placement.maxSizeBottom):(alignAtTop=!0,maxSize=placement.maxSizeTop),this._applyTopLeft({left:placement.left,top:alignAtTop?placement.top:bottom-height}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!alignAtTop,placement===eastPlacement,alignAtTop,placement!==eastPlacement),this._resizable.minSize=placement.minSize,this._resizable.maxSize=maxSize,this._resizable.layout(height,Math.min(maxSize.width,size.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(topLeft){this._topLeft=topLeft,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}}})),define(__m[635],__M([1,0,18,49,40,19,25,41,105,36]),(function(require,exports,arrays,map_1,objects,types,uri_1,configuration_1,configurationRegistry_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConfigurationChangeEvent=exports.Configuration=exports.DefaultConfigurationModel=exports.ConfigurationModel=void 0;class ConfigurationModel{constructor(_contents={},_keys=[],_overrides=[]){this._contents=_contents,this._keys=_keys,this._overrides=_overrides,this.isFrozen=!1,this.overrideConfigurations=new Map}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return 0===this._keys.length&&0===Object.keys(this._contents).length&&0===this._overrides.length}getValue(section){return section?(0,configuration_1.getConfigurationValue)(this.contents,section):this.contents}getOverrideValue(section,overrideIdentifier){const overrideContents=this.getContentsForOverrideIdentifer(overrideIdentifier);return overrideContents?section?(0,configuration_1.getConfigurationValue)(overrideContents,section):overrideContents:void 0}override(identifier){let overrideConfigurationModel=this.overrideConfigurations.get(identifier);return overrideConfigurationModel||(overrideConfigurationModel=this.createOverrideConfigurationModel(identifier),this.overrideConfigurations.set(identifier,overrideConfigurationModel)),overrideConfigurationModel}merge(...others){const contents=objects.deepClone(this.contents),overrides=objects.deepClone(this.overrides),keys=[...this.keys];for(const other of others){this.mergeContents(contents,other.contents);for(const otherOverride of other.overrides){const[override]=overrides.filter((o=>arrays.equals(o.identifiers,otherOverride.identifiers)));override?(this.mergeContents(override.contents,otherOverride.contents),override.keys.push(...otherOverride.keys),override.keys=arrays.distinct(override.keys)):overrides.push(objects.deepClone(otherOverride))}for(const key of other.keys)-1===keys.indexOf(key)&&keys.push(key)}return new ConfigurationModel(contents,keys,overrides)}freeze(){return this.isFrozen=!0,this}createOverrideConfigurationModel(identifier){const overrideContents=this.getContentsForOverrideIdentifer(identifier);if(!overrideContents||"object"!=typeof overrideContents||!Object.keys(overrideContents).length)return this;let contents={};for(const key of arrays.distinct([...Object.keys(this.contents),...Object.keys(overrideContents)])){let contentsForKey=this.contents[key],overrideContentsForKey=overrideContents[key];overrideContentsForKey&&("object"==typeof contentsForKey&&"object"==typeof overrideContentsForKey?(contentsForKey=objects.deepClone(contentsForKey),this.mergeContents(contentsForKey,overrideContentsForKey)):contentsForKey=overrideContentsForKey),contents[key]=contentsForKey}return new ConfigurationModel(contents,this.keys,this.overrides)}mergeContents(source,target){for(const key of Object.keys(target))key in source&&types.isObject(source[key])&&types.isObject(target[key])?this.mergeContents(source[key],target[key]):source[key]=objects.deepClone(target[key])}checkAndFreeze(data){return this.isFrozen&&!Object.isFrozen(data)?objects.deepFreeze(data):data}getContentsForOverrideIdentifer(identifier){let contentsForIdentifierOnly=null,contents=null;const mergeContents=contentsToMerge=>{contentsToMerge&&(contents?this.mergeContents(contents,contentsToMerge):contents=objects.deepClone(contentsToMerge))};for(const override of this.overrides)arrays.equals(override.identifiers,[identifier])?contentsForIdentifierOnly=override.contents:override.identifiers.includes(identifier)&&mergeContents(override.contents);return mergeContents(contentsForIdentifierOnly),contents}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(key,value){this.addKey(key),(0,configuration_1.addToValueTree)(this.contents,key,value,(e=>{throw new Error(e)}))}removeValue(key){this.removeKey(key)&&(0,configuration_1.removeFromValueTree)(this.contents,key)}addKey(key){let index=this.keys.length;for(let i=0;i<index;i++)0===key.indexOf(this.keys[i])&&(index=i);this.keys.splice(index,1,key)}removeKey(key){let index=this.keys.indexOf(key);return-1!==index&&(this.keys.splice(index,1),!0)}}exports.ConfigurationModel=ConfigurationModel;exports.DefaultConfigurationModel=class DefaultConfigurationModel extends ConfigurationModel{constructor(configurationDefaultsOverrides={}){const properties=platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).getConfigurationProperties(),keys=Object.keys(properties),contents=Object.create(null),overrides=[];for(const key in properties){const defaultOverrideValue=configurationDefaultsOverrides[key],value=void 0!==defaultOverrideValue?defaultOverrideValue:properties[key].default;(0,configuration_1.addToValueTree)(contents,key,value,(message=>console.error(`Conflict in default settings: ${message}`)))}for(const key of Object.keys(contents))configurationRegistry_1.OVERRIDE_PROPERTY_REGEX.test(key)&&overrides.push({identifiers:(0,configurationRegistry_1.overrideIdentifiersFromKey)(key),keys:Object.keys(contents[key]),contents:(0,configuration_1.toValuesTree)(contents[key],(message=>console.error(`Conflict in default settings file: ${message}`)))});super(contents,keys,overrides)}};class Configuration{constructor(_defaultConfiguration,_localUserConfiguration,_remoteUserConfiguration=new ConfigurationModel,_workspaceConfiguration=new ConfigurationModel,_folderConfigurations=new map_1.ResourceMap,_memoryConfiguration=new ConfigurationModel,_memoryConfigurationByResource=new map_1.ResourceMap,_freeze=!0){this._defaultConfiguration=_defaultConfiguration,this._localUserConfiguration=_localUserConfiguration,this._remoteUserConfiguration=_remoteUserConfiguration,this._workspaceConfiguration=_workspaceConfiguration,this._folderConfigurations=_folderConfigurations,this._memoryConfiguration=_memoryConfiguration,this._memoryConfigurationByResource=_memoryConfigurationByResource,this._freeze=_freeze,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new map_1.ResourceMap,this._userConfiguration=null}getValue(section,overrides,workspace){return this.getConsolidateConfigurationModel(overrides,workspace).getValue(section)}updateValue(key,value,overrides={}){let memoryConfiguration;overrides.resource?(memoryConfiguration=this._memoryConfigurationByResource.get(overrides.resource),memoryConfiguration||(memoryConfiguration=new ConfigurationModel,this._memoryConfigurationByResource.set(overrides.resource,memoryConfiguration))):memoryConfiguration=this._memoryConfiguration,void 0===value?memoryConfiguration.removeValue(key):memoryConfiguration.setValue(key,value),overrides.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(key,overrides,workspace){const consolidateConfigurationModel=this.getConsolidateConfigurationModel(overrides,workspace),folderConfigurationModel=this.getFolderConfigurationModelForResource(overrides.resource,workspace),memoryConfigurationModel=overrides.resource&&this._memoryConfigurationByResource.get(overrides.resource)||this._memoryConfiguration,defaultValue=overrides.overrideIdentifier?this._defaultConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key):this._defaultConfiguration.freeze().getValue(key),userValue=overrides.overrideIdentifier?this.userConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key):this.userConfiguration.freeze().getValue(key),userLocalValue=overrides.overrideIdentifier?this.localUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key):this.localUserConfiguration.freeze().getValue(key),userRemoteValue=overrides.overrideIdentifier?this.remoteUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key):this.remoteUserConfiguration.freeze().getValue(key),workspaceValue=workspace?overrides.overrideIdentifier?this._workspaceConfiguration.freeze().override(overrides.overrideIdentifier).getValue(key):this._workspaceConfiguration.freeze().getValue(key):void 0,workspaceFolderValue=folderConfigurationModel?overrides.overrideIdentifier?folderConfigurationModel.freeze().override(overrides.overrideIdentifier).getValue(key):folderConfigurationModel.freeze().getValue(key):void 0,memoryValue=overrides.overrideIdentifier?memoryConfigurationModel.override(overrides.overrideIdentifier).getValue(key):memoryConfigurationModel.getValue(key),value=consolidateConfigurationModel.getValue(key),overrideIdentifiers=arrays.distinct(arrays.flatten(consolidateConfigurationModel.overrides.map((override=>override.identifiers)))).filter((overrideIdentifier=>void 0!==consolidateConfigurationModel.getOverrideValue(key,overrideIdentifier)));return{defaultValue,userValue,userLocalValue,userRemoteValue,workspaceValue,workspaceFolderValue,memoryValue,value,default:void 0!==defaultValue?{value:this._defaultConfiguration.freeze().getValue(key),override:overrides.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,user:void 0!==userValue?{value:this.userConfiguration.freeze().getValue(key),override:overrides.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,userLocal:void 0!==userLocalValue?{value:this.localUserConfiguration.freeze().getValue(key),override:overrides.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,userRemote:void 0!==userRemoteValue?{value:this.remoteUserConfiguration.freeze().getValue(key),override:overrides.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,workspace:void 0!==workspaceValue?{value:this._workspaceConfiguration.freeze().getValue(key),override:overrides.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,workspaceFolder:void 0!==workspaceFolderValue?{value:null==folderConfigurationModel?void 0:folderConfigurationModel.freeze().getValue(key),override:overrides.overrideIdentifier?null==folderConfigurationModel?void 0:folderConfigurationModel.freeze().getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,memory:void 0!==memoryValue?{value:memoryConfigurationModel.getValue(key),override:overrides.overrideIdentifier?memoryConfigurationModel.getOverrideValue(key,overrides.overrideIdentifier):void 0}:void 0,overrideIdentifiers:overrideIdentifiers.length?overrideIdentifiers:void 0}}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidateConfigurationModel(overrides,workspace){let configurationModel=this.getConsolidatedConfigurationModelForResource(overrides,workspace);return overrides.overrideIdentifier?configurationModel.override(overrides.overrideIdentifier):configurationModel}getConsolidatedConfigurationModelForResource({resource},workspace){let consolidateConfiguration=this.getWorkspaceConsolidatedConfiguration();if(workspace&&resource){const root=workspace.getFolder(resource);root&&(consolidateConfiguration=this.getFolderConsolidatedConfiguration(root.uri)||consolidateConfiguration);const memoryConfigurationForResource=this._memoryConfigurationByResource.get(resource);memoryConfigurationForResource&&(consolidateConfiguration=consolidateConfiguration.merge(memoryConfigurationForResource))}return consolidateConfiguration}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(folder){let folderConsolidatedConfiguration=this._foldersConsolidatedConfigurations.get(folder);if(!folderConsolidatedConfiguration){const workspaceConsolidateConfiguration=this.getWorkspaceConsolidatedConfiguration(),folderConfiguration=this._folderConfigurations.get(folder);folderConfiguration?(folderConsolidatedConfiguration=workspaceConsolidateConfiguration.merge(folderConfiguration),this._freeze&&(folderConsolidatedConfiguration=folderConsolidatedConfiguration.freeze()),this._foldersConsolidatedConfigurations.set(folder,folderConsolidatedConfiguration)):folderConsolidatedConfiguration=workspaceConsolidateConfiguration}return folderConsolidatedConfiguration}getFolderConfigurationModelForResource(resource,workspace){if(workspace&&resource){const root=workspace.getFolder(resource);if(root)return this._folderConfigurations.get(root.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce(((result,folder)=>{const{contents,overrides,keys}=this._folderConfigurations.get(folder);return result.push([folder,{contents,overrides,keys}]),result}),[])}}static parse(data){const defaultConfiguration=this.parseConfigurationModel(data.defaults),userConfiguration=this.parseConfigurationModel(data.user),workspaceConfiguration=this.parseConfigurationModel(data.workspace),folders=data.folders.reduce(((result,value)=>(result.set(uri_1.URI.revive(value[0]),this.parseConfigurationModel(value[1])),result)),new map_1.ResourceMap);return new Configuration(defaultConfiguration,userConfiguration,new ConfigurationModel,workspaceConfiguration,folders,new ConfigurationModel,new map_1.ResourceMap,!1)}static parseConfigurationModel(model){return new ConfigurationModel(model.contents,model.keys,model.overrides).freeze()}}exports.Configuration=Configuration;exports.ConfigurationChangeEvent=class ConfigurationChangeEvent{constructor(change,previous,currentConfiguraiton,currentWorkspace){this.change=change,this.previous=previous,this.currentConfiguraiton=currentConfiguraiton,this.currentWorkspace=currentWorkspace,this._previousConfiguration=void 0;const keysSet=new Set;change.keys.forEach((key=>keysSet.add(key))),change.overrides.forEach((([,keys])=>keys.forEach((key=>keysSet.add(key))))),this.affectedKeys=[...keysSet.values()];const configurationModel=new ConfigurationModel;this.affectedKeys.forEach((key=>configurationModel.setValue(key,{}))),this.affectedKeysTree=configurationModel.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Configuration.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(section,overrides){var _a;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,section)){if(overrides){const value1=this.previousConfiguration?this.previousConfiguration.getValue(section,overrides,null===(_a=this.previous)||void 0===_a?void 0:_a.workspace):void 0,value2=this.currentConfiguraiton.getValue(section,overrides,this.currentWorkspace);return!objects.equals(value1,value2)}return!0}return!1}doesAffectedKeysTreeContains(affectedKeysTree,section){let key,requestedTree=(0,configuration_1.toValuesTree)({[section]:!0},(()=>{}));for(;"object"==typeof requestedTree&&(key=Object.keys(requestedTree)[0]);){if(!(affectedKeysTree=affectedKeysTree[key]))return!1;requestedTree=requestedTree[key]}return!0}}})),define(__m[89],__M([1,0,96,16,26,36]),(function(require,exports,keybindings_1,platform_1,commands_1,platform_2){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extensions=exports.KeybindingsRegistry=void 0;class KeybindingsRegistryImpl{constructor(){this._coreKeybindings=[],this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(kb){if(1===platform_1.OS){if(kb&&kb.win)return kb.win}else if(2===platform_1.OS){if(kb&&kb.mac)return kb.mac}else if(kb&&kb.linux)return kb.linux;return kb}registerKeybindingRule(rule){const actualKb=KeybindingsRegistryImpl.bindToCurrentPlatform(rule);if(actualKb&&actualKb.primary){const kk=(0,keybindings_1.createKeybinding)(actualKb.primary,platform_1.OS);kk&&this._registerDefaultKeybinding(kk,rule.id,rule.args,rule.weight,0,rule.when)}if(actualKb&&Array.isArray(actualKb.secondary))for(let i=0,len=actualKb.secondary.length;i<len;i++){const k=actualKb.secondary[i],kk=(0,keybindings_1.createKeybinding)(k,platform_1.OS);kk&&this._registerDefaultKeybinding(kk,rule.id,rule.args,rule.weight,-i-1,rule.when)}}registerCommandAndKeybindingRule(desc){this.registerKeybindingRule(desc),commands_1.CommandsRegistry.registerCommand(desc)}static _mightProduceChar(keyCode){return keyCode>=21&&keyCode<=30||(keyCode>=31&&keyCode<=56||(80===keyCode||81===keyCode||82===keyCode||83===keyCode||84===keyCode||85===keyCode||86===keyCode||110===keyCode||111===keyCode||87===keyCode||88===keyCode||89===keyCode||90===keyCode||91===keyCode||92===keyCode))}_assertNoCtrlAlt(keybinding,commandId){keybinding.ctrlKey&&keybinding.altKey&&!keybinding.metaKey&&KeybindingsRegistryImpl._mightProduceChar(keybinding.keyCode)&&console.warn("Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ",keybinding," for ",commandId)}_registerDefaultKeybinding(keybinding,commandId,commandArgs,weight1,weight2,when){1===platform_1.OS&&this._assertNoCtrlAlt(keybinding.parts[0],commandId),this._coreKeybindings.push({keybinding:keybinding.parts,command:commandId,commandArgs,when,weight1,weight2,extensionId:null,isBuiltinExtension:!1}),this._cachedMergedKeybindings=null}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=[].concat(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(sorter)),this._cachedMergedKeybindings.slice(0)}}function sorter(a,b){return a.weight1!==b.weight1?a.weight1-b.weight1:a.command<b.command?-1:a.command>b.command?1:a.weight2-b.weight2}exports.KeybindingsRegistry=new KeybindingsRegistryImpl,exports.Extensions={EditorModes:"platform.keybindingsRegistry"},platform_2.Registry.add(exports.Extensions.EditorModes,exports.KeybindingsRegistry)})),define(__m[283],__M([1,0,492,493,17,89,593]),(function(require,exports,findInput_1,replaceInput_1,contextkey_1,keybindingsRegistry_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextScopedReplaceInput=exports.ContextScopedFindInput=exports.createAndBindHistoryNavigationWidgetScopedContextKeyService=exports.HistoryNavigationWidgetContext=exports.historyNavigationVisible=void 0,exports.historyNavigationVisible=new contextkey_1.RawContextKey("suggestWidgetVisible",!1,(0,nls_1.localize)(0,null)),exports.HistoryNavigationWidgetContext="historyNavigationWidget";function getContextScopedWidget(contextKeyService,contextKey){return contextKeyService.getContext(document.activeElement).getValue(contextKey)}function createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService,widget){const scopedContextKeyService=function createWidgetScopedContextKeyService(contextKeyService,widget){return contextKeyService.createScoped(widget.target)}(contextKeyService,widget);!function bindContextScopedWidget(contextKeyService,widget,contextKey){new contextkey_1.RawContextKey(contextKey,widget).bindTo(contextKeyService)}(scopedContextKeyService,widget,exports.HistoryNavigationWidgetContext);return{scopedContextKeyService,historyNavigationForwardsEnablement:new contextkey_1.RawContextKey("historyNavigationForwardsEnabled",!0).bindTo(scopedContextKeyService),historyNavigationBackwardsEnablement:new contextkey_1.RawContextKey("historyNavigationBackwardsEnabled",!0).bindTo(scopedContextKeyService)}}exports.createAndBindHistoryNavigationWidgetScopedContextKeyService=createAndBindHistoryNavigationWidgetScopedContextKeyService;let ContextScopedFindInput=class ContextScopedFindInput extends findInput_1.FindInput{constructor(container,contextViewProvider,options,contextKeyService,showFindOptions=!1){super(container,contextViewProvider,showFindOptions,options),this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};ContextScopedFindInput=__decorate([__param(3,contextkey_1.IContextKeyService)],ContextScopedFindInput),exports.ContextScopedFindInput=ContextScopedFindInput;let ContextScopedReplaceInput=class ContextScopedReplaceInput extends replaceInput_1.ReplaceInput{constructor(container,contextViewProvider,options,contextKeyService,showReplaceOptions=!1){super(container,contextViewProvider,showReplaceOptions,options),this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};ContextScopedReplaceInput=__decorate([__param(3,contextkey_1.IContextKeyService)],ContextScopedReplaceInput),exports.ContextScopedReplaceInput=ContextScopedReplaceInput,keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:contextkey_1.ContextKeyExpr.and(contextkey_1.ContextKeyExpr.has(exports.HistoryNavigationWidgetContext),contextkey_1.ContextKeyExpr.equals("historyNavigationBackwardsEnabled",!0),exports.historyNavigationVisible.isEqualTo(!1)),primary:16,secondary:[528],handler:accessor=>{const widget=getContextScopedWidget(accessor.get(contextkey_1.IContextKeyService),exports.HistoryNavigationWidgetContext);if(widget){widget.historyNavigator.showPreviousValue()}}}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:contextkey_1.ContextKeyExpr.and(contextkey_1.ContextKeyExpr.has(exports.HistoryNavigationWidgetContext),contextkey_1.ContextKeyExpr.equals("historyNavigationForwardsEnabled",!0),exports.historyNavigationVisible.isEqualTo(!1)),primary:18,secondary:[530],handler:accessor=>{const widget=getContextScopedWidget(accessor.get(contextkey_1.IContextKeyService),exports.HistoryNavigationWidgetContext);if(widget){widget.historyNavigator.showNextValue()}}})})),define(__m[107],__M([1,0,18,2,36]),(function(require,exports,arrays_1,lifecycle_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickAccessRegistry=exports.Extensions=exports.DefaultQuickAccessFilterValue=void 0,function(DefaultQuickAccessFilterValue){DefaultQuickAccessFilterValue[DefaultQuickAccessFilterValue.PRESERVE=0]="PRESERVE",DefaultQuickAccessFilterValue[DefaultQuickAccessFilterValue.LAST=1]="LAST"}(exports.DefaultQuickAccessFilterValue||(exports.DefaultQuickAccessFilterValue={})),exports.Extensions={Quickaccess:"workbench.contributions.quickaccess"};class QuickAccessRegistry{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(provider){return 0===provider.prefix.length?this.defaultProvider=provider:this.providers.push(provider),this.providers.sort(((providerA,providerB)=>providerB.prefix.length-providerA.prefix.length)),(0,lifecycle_1.toDisposable)((()=>{this.providers.splice(this.providers.indexOf(provider),1),this.defaultProvider===provider&&(this.defaultProvider=void 0)}))}getQuickAccessProviders(){return(0,arrays_1.coalesce)([this.defaultProvider,...this.providers])}getQuickAccessProvider(prefix){return prefix&&this.providers.find((provider=>prefix.startsWith(provider.prefix)))||void 0||this.defaultProvider}}exports.QuickAccessRegistry=QuickAccessRegistry,platform_1.Registry.add(exports.Extensions.Quickaccess,new QuickAccessRegistry)})),define(__m[636],__M([1,0,2,598,107,80,36]),(function(require,exports,lifecycle_1,nls_1,quickAccess_1,quickInput_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HelpQuickAccessProvider=void 0;let HelpQuickAccessProvider=class HelpQuickAccessProvider{constructor(quickInputService){this.quickInputService=quickInputService,this.registry=platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess)}provide(picker){const disposables=new lifecycle_1.DisposableStore;disposables.add(picker.onDidAccept((()=>{const[item]=picker.selectedItems;item&&this.quickInputService.quickAccess.show(item.prefix,{preserveValue:!0})}))),disposables.add(picker.onDidChangeValue((value=>{const providerDescriptor=this.registry.getQuickAccessProvider(value.substr(HelpQuickAccessProvider.PREFIX.length));providerDescriptor&&providerDescriptor.prefix&&providerDescriptor.prefix!==HelpQuickAccessProvider.PREFIX&&this.quickInputService.quickAccess.show(providerDescriptor.prefix,{preserveValue:!0})})));const{editorProviders,globalProviders}=this.getQuickAccessProviders();return picker.items=0===editorProviders.length||0===globalProviders.length?[...0===editorProviders.length?globalProviders:editorProviders]:[{label:(0,nls_1.localize)(0,null),type:"separator"},...globalProviders,{label:(0,nls_1.localize)(1,null),type:"separator"},...editorProviders],disposables}getQuickAccessProviders(){const globalProviders=[],editorProviders=[];for(const provider of this.registry.getQuickAccessProviders().sort(((providerA,providerB)=>providerA.prefix.localeCompare(providerB.prefix))))if(provider.prefix!==HelpQuickAccessProvider.PREFIX)for(const helpEntry of provider.helpEntries){const prefix=helpEntry.prefix||provider.prefix,label=prefix||"…";(helpEntry.needsEditor?editorProviders:globalProviders).push({prefix,label,ariaLabel:(0,nls_1.localize)(2,null,label,helpEntry.description),description:helpEntry.description})}return{editorProviders,globalProviders}}};HelpQuickAccessProvider.PREFIX="?",HelpQuickAccessProvider=__decorate([__param(0,quickInput_1.IQuickInputService)],HelpQuickAccessProvider),exports.HelpQuickAccessProvider=HelpQuickAccessProvider})),define(__m[637],__M([1,0,36,107,72,636]),(function(require,exports,platform_1,quickAccess_1,standaloneStrings_1,helpQuickAccess_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess).registerQuickAccessProvider({ctor:helpQuickAccess_1.HelpQuickAccessProvider,prefix:"",helpEntries:[{description:standaloneStrings_1.QuickHelpNLS.helpQuickAccessActionLabel,needsEditor:!0}]})})),define(__m[638],__M([1,0,10,21,91,2,9,107,80,36]),(function(require,exports,async_1,cancellation_1,functional_1,lifecycle_1,instantiation_1,quickAccess_1,quickInput_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickAccessController=void 0;let QuickAccessController=class QuickAccessController extends lifecycle_1.Disposable{constructor(quickInputService,instantiationService){super(),this.quickInputService=quickInputService,this.instantiationService=instantiationService,this.registry=platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(value="",options){this.doShowOrPick(value,!1,options)}doShowOrPick(value,pick,options){var _a;const[provider,descriptor]=this.getOrInstantiateProvider(value),visibleQuickAccess=this.visibleQuickAccess,visibleDescriptor=null==visibleQuickAccess?void 0:visibleQuickAccess.descriptor;if(visibleQuickAccess&&descriptor&&visibleDescriptor===descriptor)return value===descriptor.prefix||(null==options?void 0:options.preserveValue)||(visibleQuickAccess.picker.value=value),void this.adjustValueSelection(visibleQuickAccess.picker,descriptor,options);if(descriptor&&!(null==options?void 0:options.preserveValue)){let newValue;if(visibleQuickAccess&&visibleDescriptor&&visibleDescriptor!==descriptor){const newValueCandidateWithoutPrefix=visibleQuickAccess.value.substr(visibleDescriptor.prefix.length);newValueCandidateWithoutPrefix&&(newValue=`${descriptor.prefix}${newValueCandidateWithoutPrefix}`)}if(!newValue){const defaultFilterValue=null==provider?void 0:provider.defaultFilterValue;defaultFilterValue===quickAccess_1.DefaultQuickAccessFilterValue.LAST?newValue=this.lastAcceptedPickerValues.get(descriptor):"string"==typeof defaultFilterValue&&(newValue=`${descriptor.prefix}${defaultFilterValue}`)}"string"==typeof newValue&&(value=newValue)}const disposables=new lifecycle_1.DisposableStore,picker=disposables.add(this.quickInputService.createQuickPick());let pickPromise;picker.value=value,this.adjustValueSelection(picker,descriptor,options),picker.placeholder=null==descriptor?void 0:descriptor.placeholder,picker.quickNavigate=null==options?void 0:options.quickNavigateConfiguration,picker.hideInput=!!picker.quickNavigate&&!visibleQuickAccess,("number"==typeof(null==options?void 0:options.itemActivation)||(null==options?void 0:options.quickNavigateConfiguration))&&(picker.itemActivation=null!==(_a=null==options?void 0:options.itemActivation)&&void 0!==_a?_a:quickInput_1.ItemActivation.SECOND),picker.contextKey=null==descriptor?void 0:descriptor.contextKey,picker.filterValue=value=>value.substring(descriptor?descriptor.prefix.length:0),(null==descriptor?void 0:descriptor.placeholder)&&(picker.ariaLabel=null==descriptor?void 0:descriptor.placeholder),pick&&(pickPromise=new async_1.DeferredPromise,disposables.add((0,functional_1.once)(picker.onWillAccept)((e=>{e.veto(),picker.hide()})))),disposables.add(this.registerPickerListeners(picker,provider,descriptor,value));const cts=disposables.add(new cancellation_1.CancellationTokenSource);return provider&&disposables.add(provider.provide(picker,cts.token)),(0,functional_1.once)(picker.onDidHide)((()=>{0===picker.selectedItems.length&&cts.cancel(),disposables.dispose(),null==pickPromise||pickPromise.complete(picker.selectedItems.slice(0))})),picker.show(),pick?null==pickPromise?void 0:pickPromise.p:void 0}adjustValueSelection(picker,descriptor,options){var _a;let valueSelection;valueSelection=(null==options?void 0:options.preserveValue)?[picker.value.length,picker.value.length]:[null!==(_a=null==descriptor?void 0:descriptor.prefix.length)&&void 0!==_a?_a:0,picker.value.length],picker.valueSelection=valueSelection}registerPickerListeners(picker,provider,descriptor,value){const disposables=new lifecycle_1.DisposableStore,visibleQuickAccess=this.visibleQuickAccess={picker,descriptor,value};return disposables.add((0,lifecycle_1.toDisposable)((()=>{visibleQuickAccess===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)}))),disposables.add(picker.onDidChangeValue((value=>{const[providerForValue]=this.getOrInstantiateProvider(value);providerForValue!==provider?this.show(value,{preserveValue:!0}):visibleQuickAccess.value=value}))),descriptor&&disposables.add(picker.onDidAccept((()=>{this.lastAcceptedPickerValues.set(descriptor,picker.value)}))),disposables}getOrInstantiateProvider(value){const providerDescriptor=this.registry.getQuickAccessProvider(value);if(!providerDescriptor)return[void 0,void 0];let provider=this.mapProviderToDescriptor.get(providerDescriptor);return provider||(provider=this.instantiationService.createInstance(providerDescriptor.ctor),this.mapProviderToDescriptor.set(providerDescriptor,provider)),[provider,providerDescriptor]}};QuickAccessController=__decorate([__param(0,quickInput_1.IQuickInputService),__param(1,instantiation_1.IInstantiationService)],QuickAccessController),exports.QuickAccessController=QuickAccessController})),define(__m[82],__M([1,0,4,2,19,330,9]),(function(require,exports,event_1,lifecycle_1,types_1,storage_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InMemoryStorageService=exports.AbstractStorageService=exports.WillSaveStateReason=exports.IStorageService=void 0;const TARGET_KEY="__$__targetStorageMarker";exports.IStorageService=(0,instantiation_1.createDecorator)("storageService"),function(WillSaveStateReason){WillSaveStateReason[WillSaveStateReason.NONE=0]="NONE",WillSaveStateReason[WillSaveStateReason.SHUTDOWN=1]="SHUTDOWN"}(exports.WillSaveStateReason||(exports.WillSaveStateReason={}));class AbstractStorageService extends lifecycle_1.Disposable{constructor(options={flushInterval:AbstractStorageService.DEFAULT_FLUSH_INTERVAL}){super(),this.options=options,this._onDidChangeValue=this._register(new event_1.PauseableEmitter),this._onDidChangeTarget=this._register(new event_1.PauseableEmitter),this._onWillSaveState=this._register(new event_1.Emitter),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}emitDidChangeValue(scope,key){key===TARGET_KEY?(0===scope?this._globalKeyTargets=void 0:1===scope&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope})):this._onDidChangeValue.fire({scope,key,target:this.getKeyTargets(scope)[key]})}get(key,scope,fallbackValue){var _a;return null===(_a=this.getStorage(scope))||void 0===_a?void 0:_a.get(key,fallbackValue)}getBoolean(key,scope,fallbackValue){var _a;return null===(_a=this.getStorage(scope))||void 0===_a?void 0:_a.getBoolean(key,fallbackValue)}getNumber(key,scope,fallbackValue){var _a;return null===(_a=this.getStorage(scope))||void 0===_a?void 0:_a.getNumber(key,fallbackValue)}store(key,value,scope,target){(0,types_1.isUndefinedOrNull)(value)?this.remove(key,scope):this.withPausedEmitters((()=>{var _a;this.updateKeyTarget(key,scope,target),null===(_a=this.getStorage(scope))||void 0===_a||_a.set(key,value)}))}remove(key,scope){this.withPausedEmitters((()=>{var _a;this.updateKeyTarget(key,scope,void 0),null===(_a=this.getStorage(scope))||void 0===_a||_a.delete(key)}))}withPausedEmitters(fn){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{fn()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(key,scope,target){var _a,_b;const keyTargets=this.getKeyTargets(scope);"number"==typeof target?keyTargets[key]!==target&&(keyTargets[key]=target,null===(_a=this.getStorage(scope))||void 0===_a||_a.set(TARGET_KEY,JSON.stringify(keyTargets))):"number"==typeof keyTargets[key]&&(delete keyTargets[key],null===(_b=this.getStorage(scope))||void 0===_b||_b.set(TARGET_KEY,JSON.stringify(keyTargets)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(scope){return 0===scope?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(scope){const keysRaw=this.get(TARGET_KEY,scope);if(keysRaw)try{return JSON.parse(keysRaw)}catch(error){}return Object.create(null)}}exports.AbstractStorageService=AbstractStorageService,AbstractStorageService.DEFAULT_FLUSH_INTERVAL=6e4;exports.InMemoryStorageService=class InMemoryStorageService extends AbstractStorageService{constructor(){super(),this.globalStorage=this._register(new storage_1.Storage(new storage_1.InMemoryStorageDatabase)),this.workspaceStorage=this._register(new storage_1.Storage(new storage_1.InMemoryStorageDatabase)),this._register(this.workspaceStorage.onDidChangeStorage((key=>this.emitDidChangeValue(1,key)))),this._register(this.globalStorage.onDidChangeStorage((key=>this.emitDidChangeValue(0,key))))}getStorage(scope){return 0===scope?this.globalStorage:this.workspaceStorage}}})),define(__m[639],__M([1,0,10,91,49,3,275,52,9,82]),(function(require,exports,async_1,functional_1,map_1,range_1,codelens_1,extensions_1,instantiation_1,storage_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeLensCache=exports.ICodeLensCache=void 0,exports.ICodeLensCache=(0,instantiation_1.createDecorator)("ICodeLensCache");class CacheItem{constructor(lineCount,data){this.lineCount=lineCount,this.data=data}}let CodeLensCache=class CodeLensCache{constructor(storageService){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new map_1.LRUCache(20,.75);(0,async_1.runWhenIdle)((()=>storageService.remove("codelens/cache",1)));const key="codelens/cache2",raw=storageService.get(key,1,"{}");this._deserialize(raw),(0,functional_1.once)(storageService.onWillSaveState)((e=>{e.reason===storage_1.WillSaveStateReason.SHUTDOWN&&storageService.store(key,this._serialize(),1,1)}))}put(model,data){const copyItems=data.lenses.map((item=>{var _a;return{range:item.symbol.range,command:item.symbol.command&&{id:"",title:null===(_a=item.symbol.command)||void 0===_a?void 0:_a.title}}})),copyModel=new codelens_1.CodeLensModel;copyModel.add({lenses:copyItems,dispose:()=>{}},this._fakeProvider);const item=new CacheItem(model.getLineCount(),copyModel);this._cache.set(model.uri.toString(),item)}get(model){const item=this._cache.get(model.uri.toString());return item&&item.lineCount===model.getLineCount()?item.data:void 0}delete(model){this._cache.delete(model.uri.toString())}_serialize(){const data=Object.create(null);for(const[key,value]of this._cache){const lines=new Set;for(const d of value.data.lenses)lines.add(d.symbol.range.startLineNumber);data[key]={lineCount:value.lineCount,lines:[...lines.values()]}}return JSON.stringify(data)}_deserialize(raw){try{const data=JSON.parse(raw);for(const key in data){const element=data[key],lenses=[];for(const line of element.lines)lenses.push({range:new range_1.Range(line,1,line,11)});const model=new codelens_1.CodeLensModel;model.add({lenses,dispose(){}},this._fakeProvider),this._cache.set(key,new CacheItem(element.lineCount,model))}}catch(_a){}}};CodeLensCache=__decorate([__param(0,storage_1.IStorageService)],CodeLensCache),exports.CodeLensCache=CodeLensCache,(0,extensions_1.registerSingleton)(exports.ICodeLensCache,CodeLensCache)})),define(__m[640],__M([1,0,10,2,49,27,41,52,9,82]),(function(require,exports,async_1,lifecycle_1,map_1,languages_1,configuration_1,extensions_1,instantiation_1,storage_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ISuggestMemoryService=exports.SuggestMemoryService=exports.PrefixMemory=exports.LRUMemory=exports.NoMemory=exports.Memory=void 0;class Memory{constructor(name){this.name=name}select(model,pos,items){if(0===items.length)return 0;let topScore=items[0].score[0];for(let i=0;i<items.length;i++){const{score,completion:suggestion}=items[i];if(score[0]!==topScore)break;if(suggestion.preselect)return i}return 0}}exports.Memory=Memory;class NoMemory extends Memory{constructor(){super("first")}memorize(model,pos,item){}toJSON(){}fromJSON(){}}exports.NoMemory=NoMemory;class LRUMemory extends Memory{constructor(){super("recentlyUsed"),this._cache=new map_1.LRUCache(300,.66),this._seq=0}memorize(model,pos,item){const key=`${model.getLanguageId()}/${item.textLabel}`;this._cache.set(key,{touch:this._seq++,type:item.completion.kind,insertText:item.completion.insertText})}select(model,pos,items){if(0===items.length)return 0;const lineSuffix=model.getLineContent(pos.lineNumber).substr(pos.column-10,pos.column-1);if(/\s$/.test(lineSuffix))return super.select(model,pos,items);let topScore=items[0].score[0],indexPreselect=-1,indexRecency=-1,seq=-1;for(let i=0;i<items.length&&items[i].score[0]===topScore;i++){const key=`${model.getLanguageId()}/${items[i].textLabel}`,item=this._cache.peek(key);if(item&&item.touch>seq&&item.type===items[i].completion.kind&&item.insertText===items[i].completion.insertText&&(seq=item.touch,indexRecency=i),items[i].completion.preselect&&-1===indexPreselect)return i}return-1!==indexRecency?indexRecency:-1!==indexPreselect?indexPreselect:0}toJSON(){return this._cache.toJSON()}fromJSON(data){this._cache.clear();for(const[key,value]of data)value.touch=0,value.type="number"==typeof value.type?value.type:languages_1.CompletionItemKinds.fromString(value.type),this._cache.set(key,value);this._seq=this._cache.size}}exports.LRUMemory=LRUMemory;class PrefixMemory extends Memory{constructor(){super("recentlyUsedByPrefix"),this._trie=map_1.TernarySearchTree.forStrings(),this._seq=0}memorize(model,pos,item){const{word}=model.getWordUntilPosition(pos),key=`${model.getLanguageId()}/${word}`;this._trie.set(key,{type:item.completion.kind,insertText:item.completion.insertText,touch:this._seq++})}select(model,pos,items){let{word}=model.getWordUntilPosition(pos);if(!word)return super.select(model,pos,items);let key=`${model.getLanguageId()}/${word}`,item=this._trie.get(key);if(item||(item=this._trie.findSubstr(key)),item)for(let i=0;i<items.length;i++){let{kind,insertText}=items[i].completion;if(kind===item.type&&insertText===item.insertText)return i}return super.select(model,pos,items)}toJSON(){let entries=[];return this._trie.forEach(((value,key)=>entries.push([key,value]))),entries.sort(((a,b)=>-(a[1].touch-b[1].touch))).forEach(((value,i)=>value[1].touch=i)),entries.slice(0,200)}fromJSON(data){if(this._trie.clear(),data.length>0){this._seq=data[0][1].touch+1;for(const[key,value]of data)value.type="number"==typeof value.type?value.type:languages_1.CompletionItemKinds.fromString(value.type),this._trie.set(key,value)}}}exports.PrefixMemory=PrefixMemory;let SuggestMemoryService=class SuggestMemoryService{constructor(_storageService,_configService){this._storageService=_storageService,this._configService=_configService,this._disposables=new lifecycle_1.DisposableStore,this._persistSoon=new async_1.RunOnceScheduler((()=>this._saveState()),500),this._disposables.add(_storageService.onWillSaveState((e=>{e.reason===storage_1.WillSaveStateReason.SHUTDOWN&&this._saveState()})))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(model,pos,item){this._withStrategy(model,pos).memorize(model,pos,item),this._persistSoon.schedule()}select(model,pos,items){return this._withStrategy(model,pos).select(model,pos,items)}_withStrategy(model,pos){var _a;const mode=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:model.getLanguageIdAtPosition(pos.lineNumber,pos.column),resource:model.uri});if((null===(_a=this._strategy)||void 0===_a?void 0:_a.name)!==mode){this._saveState();const ctor=SuggestMemoryService._strategyCtors.get(mode)||NoMemory;this._strategy=new ctor;try{const scope=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,raw=this._storageService.get(`${SuggestMemoryService._storagePrefix}/${mode}`,scope);raw&&this._strategy.fromJSON(JSON.parse(raw))}catch(e){}}return this._strategy}_saveState(){if(this._strategy){const scope=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,raw=JSON.stringify(this._strategy);this._storageService.store(`${SuggestMemoryService._storagePrefix}/${this._strategy.name}`,raw,scope,1)}}};SuggestMemoryService._strategyCtors=new Map([["recentlyUsedByPrefix",PrefixMemory],["recentlyUsed",LRUMemory],["first",NoMemory]]),SuggestMemoryService._storagePrefix="suggest/memories",SuggestMemoryService=__decorate([__param(0,storage_1.IStorageService),__param(1,configuration_1.IConfigurationService)],SuggestMemoryService),exports.SuggestMemoryService=SuggestMemoryService,exports.ISuggestMemoryService=(0,instantiation_1.createDecorator)("ISuggestMemories"),(0,extensions_1.registerSingleton)(exports.ISuggestMemoryService,SuggestMemoryService,!0)})),define(__m[90],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ITelemetryService=void 0,exports.ITelemetryService=(0,instantiation_1.createDecorator)("telemetryService")})),define(__m[641],__M([1,0,497,13,75,2,49,76,19,597,26,41,130,9,43,629,82,90]),(function(require,exports,errorMessage_1,errors_1,filters_1,lifecycle_1,map_1,severity_1,types_1,nls_1,commands_1,configuration_1,dialogs_1,instantiation_1,keybinding_1,pickerQuickAccess_1,storage_1,telemetry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CommandsHistory=exports.AbstractCommandsQuickAccessProvider=void 0;let AbstractCommandsQuickAccessProvider=class AbstractCommandsQuickAccessProvider extends pickerQuickAccess_1.PickerQuickAccessProvider{constructor(options,instantiationService,keybindingService,commandService,telemetryService,dialogService){super(AbstractCommandsQuickAccessProvider.PREFIX,options),this.instantiationService=instantiationService,this.keybindingService=keybindingService,this.commandService=commandService,this.telemetryService=telemetryService,this.dialogService=dialogService,this.commandsHistory=this._register(this.instantiationService.createInstance(CommandsHistory)),this.options=options}_getPicks(filter,disposables,token){return __awaiter(this,void 0,void 0,(function*(){const allCommandPicks=yield this.getCommandPicks(disposables,token);if(token.isCancellationRequested)return[];const filteredCommandPicks=[];for(const commandPick of allCommandPicks){const labelHighlights=(0,types_1.withNullAsUndefined)(AbstractCommandsQuickAccessProvider.WORD_FILTER(filter,commandPick.label)),aliasHighlights=commandPick.commandAlias?(0,types_1.withNullAsUndefined)(AbstractCommandsQuickAccessProvider.WORD_FILTER(filter,commandPick.commandAlias)):void 0;labelHighlights||aliasHighlights?(commandPick.highlights={label:labelHighlights,detail:this.options.showAlias?aliasHighlights:void 0},filteredCommandPicks.push(commandPick)):filter===commandPick.commandId&&filteredCommandPicks.push(commandPick)}const mapLabelToCommand=new Map;for(const commandPick of filteredCommandPicks){const existingCommandForLabel=mapLabelToCommand.get(commandPick.label);existingCommandForLabel?(commandPick.description=commandPick.commandId,existingCommandForLabel.description=existingCommandForLabel.commandId):mapLabelToCommand.set(commandPick.label,commandPick)}filteredCommandPicks.sort(((commandPickA,commandPickB)=>{const commandACounter=this.commandsHistory.peek(commandPickA.commandId),commandBCounter=this.commandsHistory.peek(commandPickB.commandId);return commandACounter&&commandBCounter?commandACounter>commandBCounter?-1:1:commandACounter?-1:commandBCounter?1:commandPickA.label.localeCompare(commandPickB.label)}));const commandPicks=[];let addSeparator=!1;for(let i=0;i<filteredCommandPicks.length;i++){const commandPick=filteredCommandPicks[i],keybinding=this.keybindingService.lookupKeybinding(commandPick.commandId),ariaLabel=keybinding?(0,nls_1.localize)(0,null,commandPick.label,keybinding.getAriaLabel()):commandPick.label;0===i&&this.commandsHistory.peek(commandPick.commandId)&&(commandPicks.push({type:"separator",label:(0,nls_1.localize)(1,null)}),addSeparator=!0),0!==i&&addSeparator&&!this.commandsHistory.peek(commandPick.commandId)&&(commandPicks.push({type:"separator",label:(0,nls_1.localize)(2,null)}),addSeparator=!1),commandPicks.push(Object.assign(Object.assign({},commandPick),{ariaLabel,detail:this.options.showAlias&&commandPick.commandAlias!==commandPick.label?commandPick.commandAlias:void 0,keybinding,accept:()=>__awaiter(this,void 0,void 0,(function*(){this.commandsHistory.push(commandPick.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:commandPick.commandId,from:"quick open"});try{yield this.commandService.executeCommand(commandPick.commandId)}catch(error){(0,errors_1.isCancellationError)(error)||this.dialogService.show(severity_1.default.Error,(0,nls_1.localize)(3,null,commandPick.label,(0,errorMessage_1.toErrorMessage)(error)))}}))}))}return commandPicks}))}};AbstractCommandsQuickAccessProvider.PREFIX=">",AbstractCommandsQuickAccessProvider.WORD_FILTER=(0,filters_1.or)(filters_1.matchesPrefix,filters_1.matchesWords,filters_1.matchesContiguousSubString),AbstractCommandsQuickAccessProvider=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,keybinding_1.IKeybindingService),__param(3,commands_1.ICommandService),__param(4,telemetry_1.ITelemetryService),__param(5,dialogs_1.IDialogService)],AbstractCommandsQuickAccessProvider),exports.AbstractCommandsQuickAccessProvider=AbstractCommandsQuickAccessProvider;let CommandsHistory=class CommandsHistory extends lifecycle_1.Disposable{constructor(storageService,configurationService){super(),this.storageService=storageService,this.configurationService=configurationService,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((()=>this.updateConfiguration())))}updateConfiguration(){this.configuredCommandsHistoryLength=CommandsHistory.getConfiguredCommandHistoryLength(this.configurationService),CommandsHistory.cache&&CommandsHistory.cache.limit!==this.configuredCommandsHistoryLength&&(CommandsHistory.cache.limit=this.configuredCommandsHistoryLength,CommandsHistory.saveState(this.storageService))}load(){const raw=this.storageService.get(CommandsHistory.PREF_KEY_CACHE,0);let serializedCache;if(raw)try{serializedCache=JSON.parse(raw)}catch(error){}const cache=CommandsHistory.cache=new map_1.LRUCache(this.configuredCommandsHistoryLength,1);if(serializedCache){let entries;entries=serializedCache.usesLRU?serializedCache.entries:serializedCache.entries.sort(((a,b)=>a.value-b.value)),entries.forEach((entry=>cache.set(entry.key,entry.value)))}CommandsHistory.counter=this.storageService.getNumber(CommandsHistory.PREF_KEY_COUNTER,0,CommandsHistory.counter)}push(commandId){CommandsHistory.cache&&(CommandsHistory.cache.set(commandId,CommandsHistory.counter++),CommandsHistory.saveState(this.storageService))}peek(commandId){var _a;return null===(_a=CommandsHistory.cache)||void 0===_a?void 0:_a.peek(commandId)}static saveState(storageService){if(!CommandsHistory.cache)return;const serializedCache={usesLRU:!0,entries:[]};CommandsHistory.cache.forEach(((value,key)=>serializedCache.entries.push({key,value}))),storageService.store(CommandsHistory.PREF_KEY_CACHE,JSON.stringify(serializedCache),0,0),storageService.store(CommandsHistory.PREF_KEY_COUNTER,CommandsHistory.counter,0,0)}static getConfiguredCommandHistoryLength(configurationService){var _a,_b;const configuredCommandHistoryLength=null===(_b=null===(_a=configurationService.getValue().workbench)||void 0===_a?void 0:_a.commandPalette)||void 0===_b?void 0:_b.history;return"number"==typeof configuredCommandHistoryLength?configuredCommandHistoryLength:CommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH}};CommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH=50,CommandsHistory.PREF_KEY_CACHE="commandPalette.mru.cache",CommandsHistory.PREF_KEY_COUNTER="commandPalette.mru.counter",CommandsHistory.counter=1,CommandsHistory=__decorate([__param(0,storage_1.IStorageService),__param(1,configuration_1.IConfigurationService)],CommandsHistory),exports.CommandsHistory=CommandsHistory})),define(__m[642],__M([1,0,97,641]),(function(require,exports,iconLabels_1,commandsQuickAccess_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractEditorCommandsQuickAccessProvider=void 0;class AbstractEditorCommandsQuickAccessProvider extends commandsQuickAccess_1.AbstractCommandsQuickAccessProvider{constructor(options,instantiationService,keybindingService,commandService,telemetryService,dialogService){super(options,instantiationService,keybindingService,commandService,telemetryService,dialogService)}getCodeEditorCommandPicks(){const activeTextEditorControl=this.activeTextEditorControl;if(!activeTextEditorControl)return[];const editorCommandPicks=[];for(const editorAction of activeTextEditorControl.getSupportedActions())editorCommandPicks.push({commandId:editorAction.id,commandAlias:editorAction.alias,label:(0,iconLabels_1.stripIcons)(editorAction.label)||editorAction.id});return editorCommandPicks}}exports.AbstractEditorCommandsQuickAccessProvider=AbstractEditorCommandsQuickAccessProvider})),define(__m[23],__M([1,0,10,30,4,19,599,206,36]),(function(require,exports,async_1,color_1,event_1,types_1,nls,jsonContributionRegistry_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.workbenchColorsSchemaId=exports.resolveColorValue=exports.ifDefinedThenElse=exports.oneOf=exports.transparent=exports.lighten=exports.darken=exports.executeTransform=exports.chartsPurple=exports.chartsGreen=exports.chartsOrange=exports.chartsYellow=exports.chartsBlue=exports.chartsRed=exports.chartsLines=exports.chartsForeground=exports.problemsInfoIconForeground=exports.problemsWarningIconForeground=exports.problemsErrorIconForeground=exports.minimapSliderActiveBackground=exports.minimapSliderHoverBackground=exports.minimapSliderBackground=exports.minimapForegroundOpacity=exports.minimapBackground=exports.minimapWarning=exports.minimapError=exports.minimapSelection=exports.minimapSelectionOccurrenceHighlight=exports.minimapFindMatch=exports.overviewRulerSelectionHighlightForeground=exports.overviewRulerFindMatchForeground=exports.overviewRulerCommonContentForeground=exports.overviewRulerIncomingContentForeground=exports.overviewRulerCurrentContentForeground=exports.mergeBorder=exports.mergeCommonContentBackground=exports.mergeCommonHeaderBackground=exports.mergeIncomingContentBackground=exports.mergeIncomingHeaderBackground=exports.mergeCurrentContentBackground=exports.mergeCurrentHeaderBackground=exports.breadcrumbsPickerBackground=exports.breadcrumbsActiveSelectionForeground=exports.breadcrumbsFocusForeground=exports.breadcrumbsBackground=exports.breadcrumbsForeground=exports.snippetFinalTabstopHighlightBorder=exports.snippetFinalTabstopHighlightBackground=exports.snippetTabstopHighlightBorder=exports.snippetTabstopHighlightBackground=exports.toolbarActiveBackground=exports.toolbarHoverOutline=exports.toolbarHoverBackground=exports.menuSeparatorBackground=exports.menuSelectionBorder=exports.menuSelectionBackground=exports.menuSelectionForeground=exports.menuBackground=exports.menuForeground=exports.menuBorder=exports.quickInputListFocusBackground=exports.quickInputListFocusIconForeground=exports.quickInputListFocusForeground=exports._deprecatedQuickInputListFocusBackground=exports.listDeemphasizedForeground=exports.tableOddRowsBackgroundColor=exports.tableColumnsBorder=exports.treeIndentGuidesStroke=exports.listFilterMatchHighlightBorder=exports.listFilterMatchHighlight=exports.listFilterWidgetNoMatchesOutline=exports.listFilterWidgetOutline=exports.listFilterWidgetBackground=exports.listWarningForeground=exports.listErrorForeground=exports.listInvalidItemForeground=exports.listFocusHighlightForeground=exports.listHighlightForeground=exports.listDropBackground=exports.listHoverForeground=exports.listHoverBackground=exports.listInactiveFocusOutline=exports.listInactiveFocusBackground=exports.listInactiveSelectionIconForeground=exports.listInactiveSelectionForeground=exports.listInactiveSelectionBackground=exports.listActiveSelectionIconForeground=exports.listActiveSelectionForeground=exports.listActiveSelectionBackground=exports.listFocusOutline=exports.listFocusForeground=exports.listFocusBackground=exports.diffDiagonalFill=exports.diffBorder=exports.diffRemovedOutline=exports.diffInsertedOutline=exports.diffOverviewRulerRemoved=exports.diffOverviewRulerInserted=exports.diffRemovedLineGutter=exports.diffInsertedLineGutter=exports.diffRemovedLine=exports.diffInsertedLine=exports.diffRemoved=exports.diffInserted=exports.defaultRemoveColor=exports.defaultInsertColor=exports.editorLightBulbAutoFixForeground=exports.editorLightBulbForeground=exports.editorInlayHintParameterBackground=exports.editorInlayHintParameterForeground=exports.editorInlayHintTypeBackground=exports.editorInlayHintTypeForeground=exports.editorInlayHintBackground=exports.editorInlayHintForeground=exports.editorActiveLinkForeground=exports.editorHoverStatusBarBackground=exports.editorHoverBorder=exports.editorHoverForeground=exports.editorHoverBackground=exports.editorHoverHighlight=exports.searchEditorFindMatchBorder=exports.searchEditorFindMatch=exports.editorFindRangeHighlightBorder=exports.editorFindMatchHighlightBorder=exports.editorFindMatchBorder=exports.editorFindRangeHighlight=exports.editorFindMatchHighlight=exports.editorFindMatch=exports.editorSelectionHighlightBorder=exports.editorSelectionHighlight=exports.editorInactiveSelection=exports.editorSelectionForeground=exports.editorSelectionBackground=exports.keybindingLabelBottomBorder=exports.keybindingLabelBorder=exports.keybindingLabelForeground=exports.keybindingLabelBackground=exports.pickerGroupBorder=exports.pickerGroupForeground=exports.quickInputTitleBackground=exports.quickInputForeground=exports.quickInputBackground=exports.editorWidgetResizeBorder=exports.editorWidgetBorder=exports.editorWidgetForeground=exports.editorWidgetBackground=exports.editorForeground=exports.editorBackground=exports.sashHoverBorder=exports.editorHintBorder=exports.editorHintForeground=exports.editorInfoBorder=exports.editorInfoForeground=exports.editorInfoBackground=exports.editorWarningBorder=exports.editorWarningForeground=exports.editorWarningBackground=exports.editorErrorBorder=exports.editorErrorForeground=exports.editorErrorBackground=exports.progressBarBackground=exports.scrollbarSliderActiveBackground=exports.scrollbarSliderHoverBackground=exports.scrollbarSliderBackground=exports.scrollbarShadow=exports.badgeForeground=exports.badgeBackground=exports.buttonSecondaryHoverBackground=exports.buttonSecondaryBackground=exports.buttonSecondaryForeground=exports.buttonBorder=exports.buttonHoverBackground=exports.buttonBackground=exports.buttonForeground=exports.simpleCheckboxBorder=exports.simpleCheckboxForeground=exports.simpleCheckboxBackground=exports.selectBorder=exports.selectForeground=exports.selectListBackground=exports.selectBackground=exports.inputValidationErrorBorder=exports.inputValidationErrorForeground=exports.inputValidationErrorBackground=exports.inputValidationWarningBorder=exports.inputValidationWarningForeground=exports.inputValidationWarningBackground=exports.inputValidationInfoBorder=exports.inputValidationInfoForeground=exports.inputValidationInfoBackground=exports.inputPlaceholderForeground=exports.inputActiveOptionForeground=exports.inputActiveOptionBackground=exports.inputActiveOptionHoverBackground=exports.inputActiveOptionBorder=exports.inputBorder=exports.inputForeground=exports.inputBackground=exports.widgetShadow=exports.textCodeBlockBackground=exports.textBlockQuoteBorder=exports.textBlockQuoteBackground=exports.textPreformatForeground=exports.textLinkActiveForeground=exports.textLinkForeground=exports.textSeparatorForeground=exports.selectionBackground=exports.activeContrastBorder=exports.contrastBorder=exports.focusBorder=exports.iconForeground=exports.descriptionForeground=exports.errorForeground=exports.foreground=exports.registerColor=exports.Extensions=exports.asCssVariableName=void 0,exports.asCssVariableName=function asCssVariableName(colorIdent){return`--vscode-${colorIdent.replace(/\./g,"-")}`},exports.Extensions={ColorContribution:"base.contributions.colors"};const colorRegistry=new class ColorRegistry{constructor(){this._onDidChangeSchema=new event_1.Emitter,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(id,defaults,description,needsTransparency=!1,deprecationMessage){let colorContribution={id,description,defaults,needsTransparency,deprecationMessage};this.colorsById[id]=colorContribution;let propertySchema={type:"string",description,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return deprecationMessage&&(propertySchema.deprecationMessage=deprecationMessage),this.colorSchema.properties[id]=propertySchema,this.colorReferenceSchema.enum.push(id),this.colorReferenceSchema.enumDescriptions.push(description),this._onDidChangeSchema.fire(),id}getColors(){return Object.keys(this.colorsById).map((id=>this.colorsById[id]))}resolveDefaultColor(id,theme){const colorDesc=this.colorsById[id];if(colorDesc&&colorDesc.defaults){return resolveColorValue(colorDesc.defaults[theme.type],theme)}}getColorSchema(){return this.colorSchema}toString(){return Object.keys(this.colorsById).sort(((a,b)=>{let cat1=-1===a.indexOf(".")?0:1,cat2=-1===b.indexOf(".")?0:1;return cat1!==cat2?cat1-cat2:a.localeCompare(b)})).map((k=>`- \`${k}\`: ${this.colorsById[k].description}`)).join("\n")}};function registerColor(id,defaults,description,needsTransparency,deprecationMessage){return colorRegistry.registerColor(id,defaults,description,needsTransparency,deprecationMessage)}platform.Registry.add(exports.Extensions.ColorContribution,colorRegistry),exports.registerColor=registerColor,exports.foreground=registerColor("foreground",{dark:"#CCCCCC",light:"#616161",hc:"#FFFFFF"},nls.localize(0,null)),exports.errorForeground=registerColor("errorForeground",{dark:"#F48771",light:"#A1260D",hc:"#F48771"},nls.localize(1,null)),exports.descriptionForeground=registerColor("descriptionForeground",{light:"#717171",dark:transparent(exports.foreground,.7),hc:transparent(exports.foreground,.7)},nls.localize(2,null)),exports.iconForeground=registerColor("icon.foreground",{dark:"#C5C5C5",light:"#424242",hc:"#FFFFFF"},nls.localize(3,null)),exports.focusBorder=registerColor("focusBorder",{dark:"#007FD4",light:"#0090F1",hc:"#F38518"},nls.localize(4,null)),exports.contrastBorder=registerColor("contrastBorder",{light:null,dark:null,hc:"#6FC3DF"},nls.localize(5,null)),exports.activeContrastBorder=registerColor("contrastActiveBorder",{light:null,dark:null,hc:exports.focusBorder},nls.localize(6,null)),exports.selectionBackground=registerColor("selection.background",{light:null,dark:null,hc:null},nls.localize(7,null)),exports.textSeparatorForeground=registerColor("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hc:color_1.Color.black},nls.localize(8,null)),exports.textLinkForeground=registerColor("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},nls.localize(9,null)),exports.textLinkActiveForeground=registerColor("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},nls.localize(10,null)),exports.textPreformatForeground=registerColor("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hc:"#D7BA7D"},nls.localize(11,null)),exports.textBlockQuoteBackground=registerColor("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hc:null},nls.localize(12,null)),exports.textBlockQuoteBorder=registerColor("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hc:color_1.Color.white},nls.localize(13,null)),exports.textCodeBlockBackground=registerColor("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hc:color_1.Color.black},nls.localize(14,null)),exports.widgetShadow=registerColor("widget.shadow",{dark:transparent(color_1.Color.black,.36),light:transparent(color_1.Color.black,.16),hc:null},nls.localize(15,null)),exports.inputBackground=registerColor("input.background",{dark:"#3C3C3C",light:color_1.Color.white,hc:color_1.Color.black},nls.localize(16,null)),exports.inputForeground=registerColor("input.foreground",{dark:exports.foreground,light:exports.foreground,hc:exports.foreground},nls.localize(17,null)),exports.inputBorder=registerColor("input.border",{dark:null,light:null,hc:exports.contrastBorder},nls.localize(18,null)),exports.inputActiveOptionBorder=registerColor("inputOption.activeBorder",{dark:"#007ACC00",light:"#007ACC00",hc:exports.contrastBorder},nls.localize(19,null)),exports.inputActiveOptionHoverBackground=registerColor("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hc:null},nls.localize(20,null)),exports.inputActiveOptionBackground=registerColor("inputOption.activeBackground",{dark:transparent(exports.focusBorder,.4),light:transparent(exports.focusBorder,.2),hc:color_1.Color.transparent},nls.localize(21,null)),exports.inputActiveOptionForeground=registerColor("inputOption.activeForeground",{dark:color_1.Color.white,light:color_1.Color.black,hc:null},nls.localize(22,null)),exports.inputPlaceholderForeground=registerColor("input.placeholderForeground",{light:transparent(exports.foreground,.5),dark:transparent(exports.foreground,.5),hc:transparent(exports.foreground,.7)},nls.localize(23,null)),exports.inputValidationInfoBackground=registerColor("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hc:color_1.Color.black},nls.localize(24,null)),exports.inputValidationInfoForeground=registerColor("inputValidation.infoForeground",{dark:null,light:null,hc:null},nls.localize(25,null)),exports.inputValidationInfoBorder=registerColor("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hc:exports.contrastBorder},nls.localize(26,null)),exports.inputValidationWarningBackground=registerColor("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hc:color_1.Color.black},nls.localize(27,null)),exports.inputValidationWarningForeground=registerColor("inputValidation.warningForeground",{dark:null,light:null,hc:null},nls.localize(28,null)),exports.inputValidationWarningBorder=registerColor("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hc:exports.contrastBorder},nls.localize(29,null)),exports.inputValidationErrorBackground=registerColor("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hc:color_1.Color.black},nls.localize(30,null)),exports.inputValidationErrorForeground=registerColor("inputValidation.errorForeground",{dark:null,light:null,hc:null},nls.localize(31,null)),exports.inputValidationErrorBorder=registerColor("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hc:exports.contrastBorder},nls.localize(32,null)),exports.selectBackground=registerColor("dropdown.background",{dark:"#3C3C3C",light:color_1.Color.white,hc:color_1.Color.black},nls.localize(33,null)),exports.selectListBackground=registerColor("dropdown.listBackground",{dark:null,light:null,hc:color_1.Color.black},nls.localize(34,null)),exports.selectForeground=registerColor("dropdown.foreground",{dark:"#F0F0F0",light:null,hc:color_1.Color.white},nls.localize(35,null)),exports.selectBorder=registerColor("dropdown.border",{dark:exports.selectBackground,light:"#CECECE",hc:exports.contrastBorder},nls.localize(36,null)),exports.simpleCheckboxBackground=registerColor("checkbox.background",{dark:exports.selectBackground,light:exports.selectBackground,hc:exports.selectBackground},nls.localize(37,null)),exports.simpleCheckboxForeground=registerColor("checkbox.foreground",{dark:exports.selectForeground,light:exports.selectForeground,hc:exports.selectForeground},nls.localize(38,null)),exports.simpleCheckboxBorder=registerColor("checkbox.border",{dark:exports.selectBorder,light:exports.selectBorder,hc:exports.selectBorder},nls.localize(39,null)),exports.buttonForeground=registerColor("button.foreground",{dark:color_1.Color.white,light:color_1.Color.white,hc:color_1.Color.white},nls.localize(40,null)),exports.buttonBackground=registerColor("button.background",{dark:"#0E639C",light:"#007ACC",hc:null},nls.localize(41,null)),exports.buttonHoverBackground=registerColor("button.hoverBackground",{dark:lighten(exports.buttonBackground,.2),light:darken(exports.buttonBackground,.2),hc:null},nls.localize(42,null)),exports.buttonBorder=registerColor("button.border",{dark:exports.contrastBorder,light:exports.contrastBorder,hc:exports.contrastBorder},nls.localize(43,null)),exports.buttonSecondaryForeground=registerColor("button.secondaryForeground",{dark:color_1.Color.white,light:color_1.Color.white,hc:color_1.Color.white},nls.localize(44,null)),exports.buttonSecondaryBackground=registerColor("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hc:null},nls.localize(45,null)),exports.buttonSecondaryHoverBackground=registerColor("button.secondaryHoverBackground",{dark:lighten(exports.buttonSecondaryBackground,.2),light:darken(exports.buttonSecondaryBackground,.2),hc:null},nls.localize(46,null)),exports.badgeBackground=registerColor("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hc:color_1.Color.black},nls.localize(47,null)),exports.badgeForeground=registerColor("badge.foreground",{dark:color_1.Color.white,light:"#333",hc:color_1.Color.white},nls.localize(48,null)),exports.scrollbarShadow=registerColor("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hc:null},nls.localize(49,null)),exports.scrollbarSliderBackground=registerColor("scrollbarSlider.background",{dark:color_1.Color.fromHex("#797979").transparent(.4),light:color_1.Color.fromHex("#646464").transparent(.4),hc:transparent(exports.contrastBorder,.6)},nls.localize(50,null)),exports.scrollbarSliderHoverBackground=registerColor("scrollbarSlider.hoverBackground",{dark:color_1.Color.fromHex("#646464").transparent(.7),light:color_1.Color.fromHex("#646464").transparent(.7),hc:transparent(exports.contrastBorder,.8)},nls.localize(51,null)),exports.scrollbarSliderActiveBackground=registerColor("scrollbarSlider.activeBackground",{dark:color_1.Color.fromHex("#BFBFBF").transparent(.4),light:color_1.Color.fromHex("#000000").transparent(.6),hc:exports.contrastBorder},nls.localize(52,null)),exports.progressBarBackground=registerColor("progressBar.background",{dark:color_1.Color.fromHex("#0E70C0"),light:color_1.Color.fromHex("#0E70C0"),hc:exports.contrastBorder},nls.localize(53,null)),exports.editorErrorBackground=registerColor("editorError.background",{dark:null,light:null,hc:null},nls.localize(54,null),!0),exports.editorErrorForeground=registerColor("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hc:null},nls.localize(55,null)),exports.editorErrorBorder=registerColor("editorError.border",{dark:null,light:null,hc:color_1.Color.fromHex("#E47777").transparent(.8)},nls.localize(56,null)),exports.editorWarningBackground=registerColor("editorWarning.background",{dark:null,light:null,hc:null},nls.localize(57,null),!0),exports.editorWarningForeground=registerColor("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hc:null},nls.localize(58,null)),exports.editorWarningBorder=registerColor("editorWarning.border",{dark:null,light:null,hc:color_1.Color.fromHex("#FFCC00").transparent(.8)},nls.localize(59,null)),exports.editorInfoBackground=registerColor("editorInfo.background",{dark:null,light:null,hc:null},nls.localize(60,null),!0),exports.editorInfoForeground=registerColor("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hc:"#3794FF"},nls.localize(61,null)),exports.editorInfoBorder=registerColor("editorInfo.border",{dark:null,light:null,hc:color_1.Color.fromHex("#3794FF").transparent(.8)},nls.localize(62,null)),exports.editorHintForeground=registerColor("editorHint.foreground",{dark:color_1.Color.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hc:null},nls.localize(63,null)),exports.editorHintBorder=registerColor("editorHint.border",{dark:null,light:null,hc:color_1.Color.fromHex("#eeeeee").transparent(.8)},nls.localize(64,null)),exports.sashHoverBorder=registerColor("sash.hoverBorder",{dark:exports.focusBorder,light:exports.focusBorder,hc:exports.focusBorder},nls.localize(65,null)),exports.editorBackground=registerColor("editor.background",{light:"#fffffe",dark:"#1E1E1E",hc:color_1.Color.black},nls.localize(66,null)),exports.editorForeground=registerColor("editor.foreground",{light:"#333333",dark:"#BBBBBB",hc:color_1.Color.white},nls.localize(67,null)),exports.editorWidgetBackground=registerColor("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hc:"#0C141F"},nls.localize(68,null)),exports.editorWidgetForeground=registerColor("editorWidget.foreground",{dark:exports.foreground,light:exports.foreground,hc:exports.foreground},nls.localize(69,null)),exports.editorWidgetBorder=registerColor("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hc:exports.contrastBorder},nls.localize(70,null)),exports.editorWidgetResizeBorder=registerColor("editorWidget.resizeBorder",{light:null,dark:null,hc:null},nls.localize(71,null)),exports.quickInputBackground=registerColor("quickInput.background",{dark:exports.editorWidgetBackground,light:exports.editorWidgetBackground,hc:exports.editorWidgetBackground},nls.localize(72,null)),exports.quickInputForeground=registerColor("quickInput.foreground",{dark:exports.editorWidgetForeground,light:exports.editorWidgetForeground,hc:exports.editorWidgetForeground},nls.localize(73,null)),exports.quickInputTitleBackground=registerColor("quickInputTitle.background",{dark:new color_1.Color(new color_1.RGBA(255,255,255,.105)),light:new color_1.Color(new color_1.RGBA(0,0,0,.06)),hc:"#000000"},nls.localize(74,null)),exports.pickerGroupForeground=registerColor("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hc:color_1.Color.white},nls.localize(75,null)),exports.pickerGroupBorder=registerColor("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hc:color_1.Color.white},nls.localize(76,null)),exports.keybindingLabelBackground=registerColor("keybindingLabel.background",{dark:new color_1.Color(new color_1.RGBA(128,128,128,.17)),light:new color_1.Color(new color_1.RGBA(221,221,221,.4)),hc:color_1.Color.transparent},nls.localize(77,null)),exports.keybindingLabelForeground=registerColor("keybindingLabel.foreground",{dark:color_1.Color.fromHex("#CCCCCC"),light:color_1.Color.fromHex("#555555"),hc:color_1.Color.white},nls.localize(78,null)),exports.keybindingLabelBorder=registerColor("keybindingLabel.border",{dark:new color_1.Color(new color_1.RGBA(51,51,51,.6)),light:new color_1.Color(new color_1.RGBA(204,204,204,.4)),hc:new color_1.Color(new color_1.RGBA(111,195,223))},nls.localize(79,null)),exports.keybindingLabelBottomBorder=registerColor("keybindingLabel.bottomBorder",{dark:new color_1.Color(new color_1.RGBA(68,68,68,.6)),light:new color_1.Color(new color_1.RGBA(187,187,187,.4)),hc:new color_1.Color(new color_1.RGBA(111,195,223))},nls.localize(80,null)),exports.editorSelectionBackground=registerColor("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hc:"#f3f518"},nls.localize(81,null)),exports.editorSelectionForeground=registerColor("editor.selectionForeground",{light:null,dark:null,hc:"#000000"},nls.localize(82,null)),exports.editorInactiveSelection=registerColor("editor.inactiveSelectionBackground",{light:transparent(exports.editorSelectionBackground,.5),dark:transparent(exports.editorSelectionBackground,.5),hc:transparent(exports.editorSelectionBackground,.5)},nls.localize(83,null),!0),exports.editorSelectionHighlight=registerColor("editor.selectionHighlightBackground",{light:lessProminent(exports.editorSelectionBackground,exports.editorBackground,.3,.6),dark:lessProminent(exports.editorSelectionBackground,exports.editorBackground,.3,.6),hc:null},nls.localize(84,null),!0),exports.editorSelectionHighlightBorder=registerColor("editor.selectionHighlightBorder",{light:null,dark:null,hc:exports.activeContrastBorder},nls.localize(85,null)),exports.editorFindMatch=registerColor("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hc:null},nls.localize(86,null)),exports.editorFindMatchHighlight=registerColor("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hc:null},nls.localize(87,null),!0),exports.editorFindRangeHighlight=registerColor("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hc:null},nls.localize(88,null),!0),exports.editorFindMatchBorder=registerColor("editor.findMatchBorder",{light:null,dark:null,hc:exports.activeContrastBorder},nls.localize(89,null)),exports.editorFindMatchHighlightBorder=registerColor("editor.findMatchHighlightBorder",{light:null,dark:null,hc:exports.activeContrastBorder},nls.localize(90,null)),exports.editorFindRangeHighlightBorder=registerColor("editor.findRangeHighlightBorder",{dark:null,light:null,hc:transparent(exports.activeContrastBorder,.4)},nls.localize(91,null),!0),exports.searchEditorFindMatch=registerColor("searchEditor.findMatchBackground",{light:transparent(exports.editorFindMatchHighlight,.66),dark:transparent(exports.editorFindMatchHighlight,.66),hc:exports.editorFindMatchHighlight},nls.localize(92,null)),exports.searchEditorFindMatchBorder=registerColor("searchEditor.findMatchBorder",{light:transparent(exports.editorFindMatchHighlightBorder,.66),dark:transparent(exports.editorFindMatchHighlightBorder,.66),hc:exports.editorFindMatchHighlightBorder},nls.localize(93,null)),exports.editorHoverHighlight=registerColor("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hc:"#ADD6FF26"},nls.localize(94,null),!0),exports.editorHoverBackground=registerColor("editorHoverWidget.background",{light:exports.editorWidgetBackground,dark:exports.editorWidgetBackground,hc:exports.editorWidgetBackground},nls.localize(95,null)),exports.editorHoverForeground=registerColor("editorHoverWidget.foreground",{light:exports.editorWidgetForeground,dark:exports.editorWidgetForeground,hc:exports.editorWidgetForeground},nls.localize(96,null)),exports.editorHoverBorder=registerColor("editorHoverWidget.border",{light:exports.editorWidgetBorder,dark:exports.editorWidgetBorder,hc:exports.editorWidgetBorder},nls.localize(97,null)),exports.editorHoverStatusBarBackground=registerColor("editorHoverWidget.statusBarBackground",{dark:lighten(exports.editorHoverBackground,.2),light:darken(exports.editorHoverBackground,.05),hc:exports.editorWidgetBackground},nls.localize(98,null)),exports.editorActiveLinkForeground=registerColor("editorLink.activeForeground",{dark:"#4E94CE",light:color_1.Color.blue,hc:color_1.Color.cyan},nls.localize(99,null)),exports.editorInlayHintForeground=registerColor("editorInlayHint.foreground",{dark:transparent(exports.badgeForeground,.8),light:transparent(exports.badgeForeground,.8),hc:exports.badgeForeground},nls.localize(100,null)),exports.editorInlayHintBackground=registerColor("editorInlayHint.background",{dark:transparent(exports.badgeBackground,.6),light:transparent(exports.badgeBackground,.3),hc:exports.badgeBackground},nls.localize(101,null)),exports.editorInlayHintTypeForeground=registerColor("editorInlayHint.typeForeground",{dark:exports.editorInlayHintForeground,light:exports.editorInlayHintForeground,hc:exports.editorInlayHintForeground},nls.localize(102,null)),exports.editorInlayHintTypeBackground=registerColor("editorInlayHint.typeBackground",{dark:exports.editorInlayHintBackground,light:exports.editorInlayHintBackground,hc:exports.editorInlayHintBackground},nls.localize(103,null)),exports.editorInlayHintParameterForeground=registerColor("editorInlayHint.parameterForeground",{dark:exports.editorInlayHintForeground,light:exports.editorInlayHintForeground,hc:exports.editorInlayHintForeground},nls.localize(104,null)),exports.editorInlayHintParameterBackground=registerColor("editorInlayHint.parameterBackground",{dark:exports.editorInlayHintBackground,light:exports.editorInlayHintBackground,hc:exports.editorInlayHintBackground},nls.localize(105,null)),exports.editorLightBulbForeground=registerColor("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hc:"#FFCC00"},nls.localize(106,null)),exports.editorLightBulbAutoFixForeground=registerColor("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},nls.localize(107,null)),exports.defaultInsertColor=new color_1.Color(new color_1.RGBA(155,185,85,.2)),exports.defaultRemoveColor=new color_1.Color(new color_1.RGBA(255,0,0,.2)),exports.diffInserted=registerColor("diffEditor.insertedTextBackground",{dark:exports.defaultInsertColor,light:exports.defaultInsertColor,hc:null},nls.localize(108,null),!0),exports.diffRemoved=registerColor("diffEditor.removedTextBackground",{dark:exports.defaultRemoveColor,light:exports.defaultRemoveColor,hc:null},nls.localize(109,null),!0),exports.diffInsertedLine=registerColor("diffEditor.insertedLineBackground",{dark:null,light:null,hc:null},nls.localize(110,null),!0),exports.diffRemovedLine=registerColor("diffEditor.removedLineBackground",{dark:null,light:null,hc:null},nls.localize(111,null),!0),exports.diffInsertedLineGutter=registerColor("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hc:null},nls.localize(112,null)),exports.diffRemovedLineGutter=registerColor("diffEditorGutter.removedLineBackground",{dark:null,light:null,hc:null},nls.localize(113,null)),exports.diffOverviewRulerInserted=registerColor("diffEditorOverview.insertedForeground",{dark:null,light:null,hc:null},nls.localize(114,null)),exports.diffOverviewRulerRemoved=registerColor("diffEditorOverview.removedForeground",{dark:null,light:null,hc:null},nls.localize(115,null)),exports.diffInsertedOutline=registerColor("diffEditor.insertedTextBorder",{dark:null,light:null,hc:"#33ff2eff"},nls.localize(116,null)),exports.diffRemovedOutline=registerColor("diffEditor.removedTextBorder",{dark:null,light:null,hc:"#FF008F"},nls.localize(117,null)),exports.diffBorder=registerColor("diffEditor.border",{dark:null,light:null,hc:exports.contrastBorder},nls.localize(118,null)),exports.diffDiagonalFill=registerColor("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hc:null},nls.localize(119,null)),exports.listFocusBackground=registerColor("list.focusBackground",{dark:null,light:null,hc:null},nls.localize(120,null)),exports.listFocusForeground=registerColor("list.focusForeground",{dark:null,light:null,hc:null},nls.localize(121,null)),exports.listFocusOutline=registerColor("list.focusOutline",{dark:exports.focusBorder,light:exports.focusBorder,hc:exports.activeContrastBorder},nls.localize(122,null)),exports.listActiveSelectionBackground=registerColor("list.activeSelectionBackground",{dark:"#094771",light:"#0060C0",hc:null},nls.localize(123,null)),exports.listActiveSelectionForeground=registerColor("list.activeSelectionForeground",{dark:color_1.Color.white,light:color_1.Color.white,hc:null},nls.localize(124,null)),exports.listActiveSelectionIconForeground=registerColor("list.activeSelectionIconForeground",{dark:null,light:null,hc:null},nls.localize(125,null)),exports.listInactiveSelectionBackground=registerColor("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hc:null},nls.localize(126,null)),exports.listInactiveSelectionForeground=registerColor("list.inactiveSelectionForeground",{dark:null,light:null,hc:null},nls.localize(127,null)),exports.listInactiveSelectionIconForeground=registerColor("list.inactiveSelectionIconForeground",{dark:null,light:null,hc:null},nls.localize(128,null)),exports.listInactiveFocusBackground=registerColor("list.inactiveFocusBackground",{dark:null,light:null,hc:null},nls.localize(129,null)),exports.listInactiveFocusOutline=registerColor("list.inactiveFocusOutline",{dark:null,light:null,hc:null},nls.localize(130,null)),exports.listHoverBackground=registerColor("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hc:null},nls.localize(131,null)),exports.listHoverForeground=registerColor("list.hoverForeground",{dark:null,light:null,hc:null},nls.localize(132,null)),exports.listDropBackground=registerColor("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hc:null},nls.localize(133,null)),exports.listHighlightForeground=registerColor("list.highlightForeground",{dark:"#18A3FF",light:"#0066BF",hc:exports.focusBorder},nls.localize(134,null)),exports.listFocusHighlightForeground=registerColor("list.focusHighlightForeground",{dark:exports.listHighlightForeground,light:ifDefinedThenElse(exports.listActiveSelectionBackground,exports.listHighlightForeground,"#9DDDFF"),hc:exports.listHighlightForeground},nls.localize(135,null)),exports.listInvalidItemForeground=registerColor("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hc:"#B89500"},nls.localize(136,null)),exports.listErrorForeground=registerColor("list.errorForeground",{dark:"#F88070",light:"#B01011",hc:null},nls.localize(137,null)),exports.listWarningForeground=registerColor("list.warningForeground",{dark:"#CCA700",light:"#855F00",hc:null},nls.localize(138,null)),exports.listFilterWidgetBackground=registerColor("listFilterWidget.background",{light:"#efc1ad",dark:"#653723",hc:color_1.Color.black},nls.localize(139,null)),exports.listFilterWidgetOutline=registerColor("listFilterWidget.outline",{dark:color_1.Color.transparent,light:color_1.Color.transparent,hc:"#f38518"},nls.localize(140,null)),exports.listFilterWidgetNoMatchesOutline=registerColor("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hc:exports.contrastBorder},nls.localize(141,null)),exports.listFilterMatchHighlight=registerColor("list.filterMatchBackground",{dark:exports.editorFindMatchHighlight,light:exports.editorFindMatchHighlight,hc:null},nls.localize(142,null)),exports.listFilterMatchHighlightBorder=registerColor("list.filterMatchBorder",{dark:exports.editorFindMatchHighlightBorder,light:exports.editorFindMatchHighlightBorder,hc:exports.contrastBorder},nls.localize(143,null)),exports.treeIndentGuidesStroke=registerColor("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hc:"#a9a9a9"},nls.localize(144,null)),exports.tableColumnsBorder=registerColor("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hc:null},nls.localize(145,null)),exports.tableOddRowsBackgroundColor=registerColor("tree.tableOddRowsBackground",{dark:transparent(exports.foreground,.04),light:transparent(exports.foreground,.04),hc:null},nls.localize(146,null)),exports.listDeemphasizedForeground=registerColor("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hc:"#A7A8A9"},nls.localize(147,null)),exports._deprecatedQuickInputListFocusBackground=registerColor("quickInput.list.focusBackground",{dark:null,light:null,hc:null},"",void 0,nls.localize(148,null)),exports.quickInputListFocusForeground=registerColor("quickInputList.focusForeground",{dark:exports.listActiveSelectionForeground,light:exports.listActiveSelectionForeground,hc:exports.listActiveSelectionForeground},nls.localize(149,null)),exports.quickInputListFocusIconForeground=registerColor("quickInputList.focusIconForeground",{dark:exports.listActiveSelectionIconForeground,light:exports.listActiveSelectionIconForeground,hc:exports.listActiveSelectionIconForeground},nls.localize(150,null)),exports.quickInputListFocusBackground=registerColor("quickInputList.focusBackground",{dark:oneOf(exports._deprecatedQuickInputListFocusBackground,exports.listActiveSelectionBackground),light:oneOf(exports._deprecatedQuickInputListFocusBackground,exports.listActiveSelectionBackground),hc:null},nls.localize(151,null)),exports.menuBorder=registerColor("menu.border",{dark:null,light:null,hc:exports.contrastBorder},nls.localize(152,null)),exports.menuForeground=registerColor("menu.foreground",{dark:exports.selectForeground,light:exports.foreground,hc:exports.selectForeground},nls.localize(153,null)),exports.menuBackground=registerColor("menu.background",{dark:exports.selectBackground,light:exports.selectBackground,hc:exports.selectBackground},nls.localize(154,null)),exports.menuSelectionForeground=registerColor("menu.selectionForeground",{dark:exports.listActiveSelectionForeground,light:exports.listActiveSelectionForeground,hc:exports.listActiveSelectionForeground},nls.localize(155,null)),exports.menuSelectionBackground=registerColor("menu.selectionBackground",{dark:exports.listActiveSelectionBackground,light:exports.listActiveSelectionBackground,hc:exports.listActiveSelectionBackground},nls.localize(156,null)),exports.menuSelectionBorder=registerColor("menu.selectionBorder",{dark:null,light:null,hc:exports.activeContrastBorder},nls.localize(157,null)),exports.menuSeparatorBackground=registerColor("menu.separatorBackground",{dark:"#BBBBBB",light:"#888888",hc:exports.contrastBorder},nls.localize(158,null)),exports.toolbarHoverBackground=registerColor("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hc:null},nls.localize(159,null)),exports.toolbarHoverOutline=registerColor("toolbar.hoverOutline",{dark:null,light:null,hc:exports.activeContrastBorder},nls.localize(160,null)),exports.toolbarActiveBackground=registerColor("toolbar.activeBackground",{dark:lighten(exports.toolbarHoverBackground,.1),light:darken(exports.toolbarHoverBackground,.1),hc:null},nls.localize(161,null)),exports.snippetTabstopHighlightBackground=registerColor("editor.snippetTabstopHighlightBackground",{dark:new color_1.Color(new color_1.RGBA(124,124,124,.3)),light:new color_1.Color(new color_1.RGBA(10,50,100,.2)),hc:new color_1.Color(new color_1.RGBA(124,124,124,.3))},nls.localize(162,null)),exports.snippetTabstopHighlightBorder=registerColor("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hc:null},nls.localize(163,null)),exports.snippetFinalTabstopHighlightBackground=registerColor("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hc:null},nls.localize(164,null)),exports.snippetFinalTabstopHighlightBorder=registerColor("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new color_1.Color(new color_1.RGBA(10,50,100,.5)),hc:"#525252"},nls.localize(165,null)),exports.breadcrumbsForeground=registerColor("breadcrumb.foreground",{light:transparent(exports.foreground,.8),dark:transparent(exports.foreground,.8),hc:transparent(exports.foreground,.8)},nls.localize(166,null)),exports.breadcrumbsBackground=registerColor("breadcrumb.background",{light:exports.editorBackground,dark:exports.editorBackground,hc:exports.editorBackground},nls.localize(167,null)),exports.breadcrumbsFocusForeground=registerColor("breadcrumb.focusForeground",{light:darken(exports.foreground,.2),dark:lighten(exports.foreground,.1),hc:lighten(exports.foreground,.1)},nls.localize(168,null)),exports.breadcrumbsActiveSelectionForeground=registerColor("breadcrumb.activeSelectionForeground",{light:darken(exports.foreground,.2),dark:lighten(exports.foreground,.1),hc:lighten(exports.foreground,.1)},nls.localize(169,null)),exports.breadcrumbsPickerBackground=registerColor("breadcrumbPicker.background",{light:exports.editorWidgetBackground,dark:exports.editorWidgetBackground,hc:exports.editorWidgetBackground},nls.localize(170,null));const currentBaseColor=color_1.Color.fromHex("#40C8AE").transparent(.5),incomingBaseColor=color_1.Color.fromHex("#40A6FF").transparent(.5),commonBaseColor=color_1.Color.fromHex("#606060").transparent(.4);function executeTransform(transform,theme){var _a,_b,_c;switch(transform.op){case 0:return null===(_a=resolveColorValue(transform.value,theme))||void 0===_a?void 0:_a.darken(transform.factor);case 1:return null===(_b=resolveColorValue(transform.value,theme))||void 0===_b?void 0:_b.lighten(transform.factor);case 2:return null===(_c=resolveColorValue(transform.value,theme))||void 0===_c?void 0:_c.transparent(transform.factor);case 3:for(const candidate of transform.values){const color=resolveColorValue(candidate,theme);if(color)return color}return;case 5:return resolveColorValue(theme.defines(transform.if)?transform.then:transform.else,theme);case 4:{const from=resolveColorValue(transform.value,theme);if(!from)return;const backgroundColor=resolveColorValue(transform.background,theme);return backgroundColor?from.isDarkerThan(backgroundColor)?color_1.Color.getLighterColor(from,backgroundColor,transform.factor).transparent(transform.transparency):color_1.Color.getDarkerColor(from,backgroundColor,transform.factor).transparent(transform.transparency):from.transparent(transform.factor*transform.transparency)}default:throw(0,types_1.assertNever)(transform)}}function darken(colorValue,factor){return{op:0,value:colorValue,factor}}function lighten(colorValue,factor){return{op:1,value:colorValue,factor}}function transparent(colorValue,factor){return{op:2,value:colorValue,factor}}function oneOf(...colorValues){return{op:3,values:colorValues}}function ifDefinedThenElse(ifArg,thenArg,elseArg){return{op:5,if:ifArg,then:thenArg,else:elseArg}}function lessProminent(colorValue,backgroundColorValue,factor,transparency){return{op:4,value:colorValue,background:backgroundColorValue,factor,transparency}}function resolveColorValue(colorValue,theme){if(null!==colorValue)return"string"==typeof colorValue?"#"===colorValue[0]?color_1.Color.fromHex(colorValue):theme.getColor(colorValue):colorValue instanceof color_1.Color?colorValue:"object"==typeof colorValue?executeTransform(colorValue,theme):void 0}exports.mergeCurrentHeaderBackground=registerColor("merge.currentHeaderBackground",{dark:currentBaseColor,light:currentBaseColor,hc:null},nls.localize(171,null),!0),exports.mergeCurrentContentBackground=registerColor("merge.currentContentBackground",{dark:transparent(exports.mergeCurrentHeaderBackground,.4),light:transparent(exports.mergeCurrentHeaderBackground,.4),hc:transparent(exports.mergeCurrentHeaderBackground,.4)},nls.localize(172,null),!0),exports.mergeIncomingHeaderBackground=registerColor("merge.incomingHeaderBackground",{dark:incomingBaseColor,light:incomingBaseColor,hc:null},nls.localize(173,null),!0),exports.mergeIncomingContentBackground=registerColor("merge.incomingContentBackground",{dark:transparent(exports.mergeIncomingHeaderBackground,.4),light:transparent(exports.mergeIncomingHeaderBackground,.4),hc:transparent(exports.mergeIncomingHeaderBackground,.4)},nls.localize(174,null),!0),exports.mergeCommonHeaderBackground=registerColor("merge.commonHeaderBackground",{dark:commonBaseColor,light:commonBaseColor,hc:null},nls.localize(175,null),!0),exports.mergeCommonContentBackground=registerColor("merge.commonContentBackground",{dark:transparent(exports.mergeCommonHeaderBackground,.4),light:transparent(exports.mergeCommonHeaderBackground,.4),hc:transparent(exports.mergeCommonHeaderBackground,.4)},nls.localize(176,null),!0),exports.mergeBorder=registerColor("merge.border",{dark:null,light:null,hc:"#C3DF6F"},nls.localize(177,null)),exports.overviewRulerCurrentContentForeground=registerColor("editorOverviewRuler.currentContentForeground",{dark:transparent(exports.mergeCurrentHeaderBackground,1),light:transparent(exports.mergeCurrentHeaderBackground,1),hc:exports.mergeBorder},nls.localize(178,null)),exports.overviewRulerIncomingContentForeground=registerColor("editorOverviewRuler.incomingContentForeground",{dark:transparent(exports.mergeIncomingHeaderBackground,1),light:transparent(exports.mergeIncomingHeaderBackground,1),hc:exports.mergeBorder},nls.localize(179,null)),exports.overviewRulerCommonContentForeground=registerColor("editorOverviewRuler.commonContentForeground",{dark:transparent(exports.mergeCommonHeaderBackground,1),light:transparent(exports.mergeCommonHeaderBackground,1),hc:exports.mergeBorder},nls.localize(180,null)),exports.overviewRulerFindMatchForeground=registerColor("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hc:"#AB5A00"},nls.localize(181,null),!0),exports.overviewRulerSelectionHighlightForeground=registerColor("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},nls.localize(182,null),!0),exports.minimapFindMatch=registerColor("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hc:"#AB5A00"},nls.localize(183,null),!0),exports.minimapSelectionOccurrenceHighlight=registerColor("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hc:"#ffffff"},nls.localize(184,null),!0),exports.minimapSelection=registerColor("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hc:"#ffffff"},nls.localize(185,null),!0),exports.minimapError=registerColor("minimap.errorHighlight",{dark:new color_1.Color(new color_1.RGBA(255,18,18,.7)),light:new color_1.Color(new color_1.RGBA(255,18,18,.7)),hc:new color_1.Color(new color_1.RGBA(255,50,50,1))},nls.localize(186,null)),exports.minimapWarning=registerColor("minimap.warningHighlight",{dark:exports.editorWarningForeground,light:exports.editorWarningForeground,hc:exports.editorWarningBorder},nls.localize(187,null)),exports.minimapBackground=registerColor("minimap.background",{dark:null,light:null,hc:null},nls.localize(188,null)),exports.minimapForegroundOpacity=registerColor("minimap.foregroundOpacity",{dark:color_1.Color.fromHex("#000f"),light:color_1.Color.fromHex("#000f"),hc:color_1.Color.fromHex("#000f")},nls.localize(189,null)),exports.minimapSliderBackground=registerColor("minimapSlider.background",{light:transparent(exports.scrollbarSliderBackground,.5),dark:transparent(exports.scrollbarSliderBackground,.5),hc:transparent(exports.scrollbarSliderBackground,.5)},nls.localize(190,null)),exports.minimapSliderHoverBackground=registerColor("minimapSlider.hoverBackground",{light:transparent(exports.scrollbarSliderHoverBackground,.5),dark:transparent(exports.scrollbarSliderHoverBackground,.5),hc:transparent(exports.scrollbarSliderHoverBackground,.5)},nls.localize(191,null)),exports.minimapSliderActiveBackground=registerColor("minimapSlider.activeBackground",{light:transparent(exports.scrollbarSliderActiveBackground,.5),dark:transparent(exports.scrollbarSliderActiveBackground,.5),hc:transparent(exports.scrollbarSliderActiveBackground,.5)},nls.localize(192,null)),exports.problemsErrorIconForeground=registerColor("problemsErrorIcon.foreground",{dark:exports.editorErrorForeground,light:exports.editorErrorForeground,hc:exports.editorErrorForeground},nls.localize(193,null)),exports.problemsWarningIconForeground=registerColor("problemsWarningIcon.foreground",{dark:exports.editorWarningForeground,light:exports.editorWarningForeground,hc:exports.editorWarningForeground},nls.localize(194,null)),exports.problemsInfoIconForeground=registerColor("problemsInfoIcon.foreground",{dark:exports.editorInfoForeground,light:exports.editorInfoForeground,hc:exports.editorInfoForeground},nls.localize(195,null)),exports.chartsForeground=registerColor("charts.foreground",{dark:exports.foreground,light:exports.foreground,hc:exports.foreground},nls.localize(196,null)),exports.chartsLines=registerColor("charts.lines",{dark:transparent(exports.foreground,.5),light:transparent(exports.foreground,.5),hc:transparent(exports.foreground,.5)},nls.localize(197,null)),exports.chartsRed=registerColor("charts.red",{dark:exports.editorErrorForeground,light:exports.editorErrorForeground,hc:exports.editorErrorForeground},nls.localize(198,null)),exports.chartsBlue=registerColor("charts.blue",{dark:exports.editorInfoForeground,light:exports.editorInfoForeground,hc:exports.editorInfoForeground},nls.localize(199,null)),exports.chartsYellow=registerColor("charts.yellow",{dark:exports.editorWarningForeground,light:exports.editorWarningForeground,hc:exports.editorWarningForeground},nls.localize(200,null)),exports.chartsOrange=registerColor("charts.orange",{dark:exports.minimapFindMatch,light:exports.minimapFindMatch,hc:exports.minimapFindMatch},nls.localize(201,null)),exports.chartsGreen=registerColor("charts.green",{dark:"#89D185",light:"#388A34",hc:"#89D185"},nls.localize(202,null)),exports.chartsPurple=registerColor("charts.purple",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},nls.localize(203,null)),exports.executeTransform=executeTransform,exports.darken=darken,exports.lighten=lighten,exports.transparent=transparent,exports.oneOf=oneOf,exports.ifDefinedThenElse=ifDefinedThenElse,exports.resolveColorValue=resolveColorValue,exports.workbenchColorsSchemaId="vscode://schemas/workbench-colors";let schemaRegistry=platform.Registry.as(jsonContributionRegistry_1.Extensions.JSONContribution);schemaRegistry.registerSchema(exports.workbenchColorsSchemaId,colorRegistry.getColorSchema());const delayer=new async_1.RunOnceScheduler((()=>schemaRegistry.notifySchemaChanged(exports.workbenchColorsSchemaId)),200);colorRegistry.onDidChangeSchema((()=>{delayer.isScheduled()||delayer.schedule()}))})),define(__m[133],__M([1,0,7,98,59,10,2,23]),(function(require,exports,dom,globalMouseMoveMonitor_1,mouseEvent_1,async_1,lifecycle_1,colorRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicCssRules=exports.GlobalEditorMouseMoveMonitor=exports.EditorPointerEventFactory=exports.EditorMouseEventFactory=exports.EditorMouseEvent=exports.createCoordinatesRelativeToEditor=exports.createEditorPagePosition=exports.CoordinatesRelativeToEditor=exports.EditorPagePosition=exports.ClientCoordinates=exports.PageCoordinates=void 0;class PageCoordinates{constructor(x,y){this.x=x,this.y=y,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new ClientCoordinates(this.x-dom.StandardWindow.scrollX,this.y-dom.StandardWindow.scrollY)}}exports.PageCoordinates=PageCoordinates;class ClientCoordinates{constructor(clientX,clientY){this.clientX=clientX,this.clientY=clientY,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new PageCoordinates(this.clientX+dom.StandardWindow.scrollX,this.clientY+dom.StandardWindow.scrollY)}}exports.ClientCoordinates=ClientCoordinates;class EditorPagePosition{constructor(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height,this._editorPagePositionBrand=void 0}}exports.EditorPagePosition=EditorPagePosition;class CoordinatesRelativeToEditor{constructor(x,y){this.x=x,this.y=y,this._positionRelativeToEditorBrand=void 0}}function createEditorPagePosition(editorViewDomNode){const editorPos=dom.getDomNodePagePosition(editorViewDomNode);return new EditorPagePosition(editorPos.left,editorPos.top,editorPos.width,editorPos.height)}function createCoordinatesRelativeToEditor(editorViewDomNode,editorPagePosition,pos){const scaleX=editorPagePosition.width/editorViewDomNode.offsetWidth,scaleY=editorPagePosition.height/editorViewDomNode.offsetHeight,relativeX=(pos.x-editorPagePosition.x)/scaleX,relativeY=(pos.y-editorPagePosition.y)/scaleY;return new CoordinatesRelativeToEditor(relativeX,relativeY)}exports.CoordinatesRelativeToEditor=CoordinatesRelativeToEditor,exports.createEditorPagePosition=createEditorPagePosition,exports.createCoordinatesRelativeToEditor=createCoordinatesRelativeToEditor;class EditorMouseEvent extends mouseEvent_1.StandardMouseEvent{constructor(e,editorViewDomNode){super(e),this._editorMouseEventBrand=void 0,this.pos=new PageCoordinates(this.posx,this.posy),this.editorPos=createEditorPagePosition(editorViewDomNode),this.relativePos=createCoordinatesRelativeToEditor(editorViewDomNode,this.editorPos,this.pos)}}exports.EditorMouseEvent=EditorMouseEvent;exports.EditorMouseEventFactory=class EditorMouseEventFactory{constructor(editorViewDomNode){this._editorViewDomNode=editorViewDomNode}_create(e){return new EditorMouseEvent(e,this._editorViewDomNode)}onContextMenu(target,callback){return dom.addDisposableListener(target,"contextmenu",(e=>{callback(this._create(e))}))}onMouseUp(target,callback){return dom.addDisposableListener(target,"mouseup",(e=>{callback(this._create(e))}))}onMouseDown(target,callback){return dom.addDisposableListener(target,"mousedown",(e=>{callback(this._create(e))}))}onMouseLeave(target,callback){return dom.addDisposableNonBubblingMouseOutListener(target,(e=>{callback(this._create(e))}))}onMouseMoveThrottled(target,callback,merger,minimumTimeMs){return dom.addDisposableThrottledListener(target,"mousemove",callback,((lastEvent,currentEvent)=>merger(lastEvent,this._create(currentEvent))),minimumTimeMs)}};exports.EditorPointerEventFactory=class EditorPointerEventFactory{constructor(editorViewDomNode){this._editorViewDomNode=editorViewDomNode}_create(e){return new EditorMouseEvent(e,this._editorViewDomNode)}onPointerUp(target,callback){return dom.addDisposableListener(target,"pointerup",(e=>{callback(this._create(e))}))}onPointerDown(target,callback){return dom.addDisposableListener(target,"pointerdown",(e=>{callback(this._create(e))}))}onPointerLeave(target,callback){return dom.addDisposableNonBubblingPointerOutListener(target,(e=>{callback(this._create(e))}))}onPointerMoveThrottled(target,callback,merger,minimumTimeMs){return dom.addDisposableThrottledListener(target,"pointermove",callback,((lastEvent,currentEvent)=>merger(lastEvent,this._create(currentEvent))),minimumTimeMs)}};class GlobalEditorMouseMoveMonitor extends lifecycle_1.Disposable{constructor(editorViewDomNode){super(),this._editorViewDomNode=editorViewDomNode,this._globalMouseMoveMonitor=this._register(new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor),this._keydownListener=null}startMonitoring(initialElement,initialButtons,merger,mouseMoveCallback,onStopCallback){this._keydownListener=dom.addStandardDisposableListener(document,"keydown",(e=>{e.toKeybinding().isModifierKey()||this._globalMouseMoveMonitor.stopMonitoring(!0,e.browserEvent)}),!0);this._globalMouseMoveMonitor.startMonitoring(initialElement,initialButtons,((lastEvent,currentEvent)=>merger(lastEvent,new EditorMouseEvent(currentEvent,this._editorViewDomNode))),mouseMoveCallback,(e=>{this._keydownListener.dispose(),onStopCallback(e)}))}stopMonitoring(){this._globalMouseMoveMonitor.stopMonitoring(!0)}}exports.GlobalEditorMouseMoveMonitor=GlobalEditorMouseMoveMonitor;class DynamicCssRules{constructor(_editor){this._editor=_editor,this._instanceId=++DynamicCssRules._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new async_1.RunOnceScheduler((()=>this.garbageCollect()),1e3)}createClassNameRef(options){const rule=this.getOrCreateRule(options);return rule.increaseRefCount(),{className:rule.className,dispose:()=>{rule.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(properties){const key=this.computeUniqueKey(properties);let existingRule=this._rules.get(key);if(!existingRule){const counter=this._counter++;existingRule=new RefCountedCssRule(key,`dyn-rule-${this._instanceId}-${counter}`,dom.isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,properties),this._rules.set(key,existingRule)}return existingRule}computeUniqueKey(properties){return JSON.stringify(properties)}garbageCollect(){for(const rule of this._rules.values())rule.hasReferences()||(this._rules.delete(rule.key),rule.dispose())}}exports.DynamicCssRules=DynamicCssRules,DynamicCssRules._idPool=0;class RefCountedCssRule{constructor(key,className,_containerElement,properties){this.key=key,this.className=className,this.properties=properties,this._referenceCount=0,this._styleElement=dom.createStyleSheet(_containerElement),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(className,properties){let str=`.${className} {`;for(const prop in properties){const value=properties[prop];let cssValue;cssValue="object"==typeof value?`var(${(0,colorRegistry_1.asCssVariableName)(value.id)})`:value;str+=`\n\t${camelToDashes(prop)}: ${cssValue};`}return str+="\n}",str}dispose(){this._styleElement.remove()}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function camelToDashes(str){return str.replace(/(^[A-Z])/,(([first])=>first.toLowerCase())).replace(/([A-Z])/g,(([letter])=>`-${letter.toLowerCase()}`))}})),define(__m[134],__M([1,0,23]),(function(require,exports,colorRegistry_1){"use strict";function computeStyles(theme,styleMap){const styles=Object.create(null);for(let key in styleMap){const value=styleMap[key];value&&(styles[key]=(0,colorRegistry_1.resolveColorValue)(value,theme))}return styles}function attachStyler(themeService,styleMap,widgetOrCallback){function applyStyles(){const styles=computeStyles(themeService.getColorTheme(),styleMap);"function"==typeof widgetOrCallback?widgetOrCallback(styles):widgetOrCallback.style(styles)}return applyStyles(),themeService.onDidColorThemeChange(applyStyles)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.attachMenuStyler=exports.defaultMenuStyles=exports.defaultListStyles=exports.attachListStyler=exports.attachBadgeStyler=exports.attachStyler=exports.computeStyles=void 0,exports.computeStyles=computeStyles,exports.attachStyler=attachStyler,exports.attachBadgeStyler=function attachBadgeStyler(widget,themeService,style){return attachStyler(themeService,{badgeBackground:(null==style?void 0:style.badgeBackground)||colorRegistry_1.badgeBackground,badgeForeground:(null==style?void 0:style.badgeForeground)||colorRegistry_1.badgeForeground,badgeBorder:colorRegistry_1.contrastBorder},widget)},exports.attachListStyler=function attachListStyler(widget,themeService,overrides){return attachStyler(themeService,Object.assign(Object.assign({},exports.defaultListStyles),overrides||{}),widget)},exports.defaultListStyles={listFocusBackground:colorRegistry_1.listFocusBackground,listFocusForeground:colorRegistry_1.listFocusForeground,listFocusOutline:colorRegistry_1.listFocusOutline,listActiveSelectionBackground:colorRegistry_1.listActiveSelectionBackground,listActiveSelectionForeground:colorRegistry_1.listActiveSelectionForeground,listActiveSelectionIconForeground:colorRegistry_1.listActiveSelectionIconForeground,listFocusAndSelectionBackground:colorRegistry_1.listActiveSelectionBackground,listFocusAndSelectionForeground:colorRegistry_1.listActiveSelectionForeground,listInactiveSelectionBackground:colorRegistry_1.listInactiveSelectionBackground,listInactiveSelectionIconForeground:colorRegistry_1.listInactiveSelectionIconForeground,listInactiveSelectionForeground:colorRegistry_1.listInactiveSelectionForeground,listInactiveFocusBackground:colorRegistry_1.listInactiveFocusBackground,listInactiveFocusOutline:colorRegistry_1.listInactiveFocusOutline,listHoverBackground:colorRegistry_1.listHoverBackground,listHoverForeground:colorRegistry_1.listHoverForeground,listDropBackground:colorRegistry_1.listDropBackground,listSelectionOutline:colorRegistry_1.activeContrastBorder,listHoverOutline:colorRegistry_1.activeContrastBorder,listFilterWidgetBackground:colorRegistry_1.listFilterWidgetBackground,listFilterWidgetOutline:colorRegistry_1.listFilterWidgetOutline,listFilterWidgetNoMatchesOutline:colorRegistry_1.listFilterWidgetNoMatchesOutline,listMatchesShadow:colorRegistry_1.widgetShadow,treeIndentGuidesStroke:colorRegistry_1.treeIndentGuidesStroke,tableColumnsBorder:colorRegistry_1.tableColumnsBorder,tableOddRowsBackgroundColor:colorRegistry_1.tableOddRowsBackgroundColor},exports.defaultMenuStyles={shadowColor:colorRegistry_1.widgetShadow,borderColor:colorRegistry_1.menuBorder,foregroundColor:colorRegistry_1.menuForeground,backgroundColor:colorRegistry_1.menuBackground,selectionForegroundColor:colorRegistry_1.menuSelectionForeground,selectionBackgroundColor:colorRegistry_1.menuSelectionBackground,selectionBorderColor:colorRegistry_1.menuSelectionBorder,separatorColor:colorRegistry_1.menuSeparatorBackground,scrollbarShadow:colorRegistry_1.scrollbarShadow,scrollbarSliderBackground:colorRegistry_1.scrollbarSliderBackground,scrollbarSliderHoverBackground:colorRegistry_1.scrollbarSliderHoverBackground,scrollbarSliderActiveBackground:colorRegistry_1.scrollbarSliderActiveBackground},exports.attachMenuStyler=function attachMenuStyler(widget,themeService,style){return attachStyler(themeService,Object.assign(Object.assign({},exports.defaultMenuStyles),style),widget)}})),define(__m[643],__M([1,0,7,59,494,47,13,2,134,399]),(function(require,exports,dom_1,mouseEvent_1,menu_1,actions_1,errors_1,lifecycle_1,styler_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextMenuHandler=void 0;exports.ContextMenuHandler=class ContextMenuHandler{constructor(contextViewService,telemetryService,notificationService,keybindingService,themeService){this.contextViewService=contextViewService,this.telemetryService=telemetryService,this.notificationService=notificationService,this.keybindingService=keybindingService,this.themeService=themeService,this.focusToReturn=null,this.block=null,this.options={blockMouse:!0}}configure(options){this.options=options}showContextMenu(delegate){const actions=delegate.getActions();if(!actions.length)return;let menu;this.focusToReturn=document.activeElement;let shadowRootElement=(0,dom_1.isHTMLElement)(delegate.domForShadowRoot)?delegate.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>delegate.getAnchor(),canRelayout:!1,anchorAlignment:delegate.anchorAlignment,anchorAxisAlignment:delegate.anchorAxisAlignment,render:container=>{let className=delegate.getMenuClassName?delegate.getMenuClassName():"";className&&(container.className+=" "+className),this.options.blockMouse&&(this.block=container.appendChild((0,dom_1.$)(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(0,dom_1.addDisposableListener)(this.block,dom_1.EventType.MOUSE_DOWN,(e=>e.stopPropagation())));const menuDisposables=new lifecycle_1.DisposableStore,actionRunner=delegate.actionRunner||new actions_1.ActionRunner;return actionRunner.onBeforeRun(this.onActionRun,this,menuDisposables),actionRunner.onDidRun(this.onDidActionRun,this,menuDisposables),menu=new menu_1.Menu(container,actions,{actionViewItemProvider:delegate.getActionViewItem,context:delegate.getActionsContext?delegate.getActionsContext():null,actionRunner,getKeyBinding:delegate.getKeyBinding?delegate.getKeyBinding:action=>this.keybindingService.lookupKeybinding(action.id)}),menuDisposables.add((0,styler_1.attachMenuStyler)(menu,this.themeService)),menu.onDidCancel((()=>this.contextViewService.hideContextView(!0)),null,menuDisposables),menu.onDidBlur((()=>this.contextViewService.hideContextView(!0)),null,menuDisposables),menuDisposables.add((0,dom_1.addDisposableListener)(window,dom_1.EventType.BLUR,(()=>this.contextViewService.hideContextView(!0)))),menuDisposables.add((0,dom_1.addDisposableListener)(window,dom_1.EventType.MOUSE_DOWN,(e=>{if(e.defaultPrevented)return;let event=new mouseEvent_1.StandardMouseEvent(e),element=event.target;if(!event.rightButton){for(;element;){if(element===container)return;element=element.parentElement}this.contextViewService.hideContextView(!0)}}))),(0,lifecycle_1.combinedDisposable)(menuDisposables,menu)},focus:()=>{menu&&menu.focus(!!delegate.autoSelectFirstItem)},onHide:didCancel=>{delegate.onHide&&delegate.onHide(!!didCancel),this.block&&(this.block.remove(),this.block=null),this.focusToReturn&&this.focusToReturn.focus()}},shadowRootElement,!!shadowRootElement)}onActionRun(e){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1),this.focusToReturn&&this.focusToReturn.focus()}onDidActionRun(e){e.error&&!(0,errors_1.isCancellationError)(e.error)&&this.notificationService.error(e.error)}}})),define(__m[135],__M([1,0]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorScheme=void 0,function(ColorScheme){ColorScheme.DARK="dark",ColorScheme.LIGHT="light",ColorScheme.HIGH_CONTRAST="hc"}(exports.ColorScheme||(exports.ColorScheme={}))})),define(__m[284],__M([1,0,34,31,16,401,118,154,126,135,32]),(function(require,exports,browser,fastDomNode_1,platform,rangeUtil_1,renderingContext_1,lineDecorations_1,viewLineRenderer_1,theme_1,editorOptions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewLine=exports.ViewLineOptions=exports.DomReadingContext=void 0;const canUseFastRenderedViewLine=!!platform.isNative||!(platform.isLinux||browser.isFirefox||browser.isSafari);let monospaceAssumptionsAreValid=!0;exports.DomReadingContext=class DomReadingContext{constructor(domNode,endNode){this._domNode=domNode,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1,this.endNode=endNode}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const rect=this._domNode.getBoundingClientRect();this._clientRectDeltaLeft=rect.left,this._clientRectScale=rect.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}};exports.ViewLineOptions=class ViewLineOptions{constructor(config,themeType){this.themeType=themeType;const options=config.options,fontInfo=options.get(44);this.renderWhitespace=options.get(88),this.renderControlCharacters=options.get(83),this.spaceWidth=fontInfo.spaceWidth,this.middotWidth=fontInfo.middotWidth,this.wsmiddotWidth=fontInfo.wsmiddotWidth,this.useMonospaceOptimizations=fontInfo.isMonospace&&!options.get(29),this.canUseHalfwidthRightwardsArrow=fontInfo.canUseHalfwidthRightwardsArrow,this.lineHeight=options.get(59),this.stopRenderingLineAfter=options.get(105),this.fontLigatures=options.get(45)}equals(other){return this.themeType===other.themeType&&this.renderWhitespace===other.renderWhitespace&&this.renderControlCharacters===other.renderControlCharacters&&this.spaceWidth===other.spaceWidth&&this.middotWidth===other.middotWidth&&this.wsmiddotWidth===other.wsmiddotWidth&&this.useMonospaceOptimizations===other.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===other.canUseHalfwidthRightwardsArrow&&this.lineHeight===other.lineHeight&&this.stopRenderingLineAfter===other.stopRenderingLineAfter&&this.fontLigatures===other.fontLigatures}};class ViewLine{constructor(options){this._options=options,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(domNode){if(!this._renderedViewLine)throw new Error("I have no rendered view line to set the dom node to...");this._renderedViewLine.domNode=(0,fastDomNode_1.createFastDomNode)(domNode)}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(newOptions){this._isMaybeInvalid=!0,this._options=newOptions}onSelectionChanged(){return(this._options.themeType===theme_1.ColorScheme.HIGH_CONTRAST||"selection"===this._options.renderWhitespace)&&(this._isMaybeInvalid=!0,!0)}renderLine(lineNumber,deltaTop,viewportData,sb){if(!1===this._isMaybeInvalid)return!1;this._isMaybeInvalid=!1;const lineData=viewportData.getViewLineRenderingData(lineNumber),options=this._options,actualInlineDecorations=lineDecorations_1.LineDecoration.filter(lineData.inlineDecorations,lineNumber,lineData.minColumn,lineData.maxColumn);let selectionsOnLine=null;if(options.themeType===theme_1.ColorScheme.HIGH_CONTRAST||"selection"===this._options.renderWhitespace){const selections=viewportData.selections;for(const selection of selections){if(selection.endLineNumber<lineNumber||selection.startLineNumber>lineNumber)continue;const startColumn=selection.startLineNumber===lineNumber?selection.startColumn:lineData.minColumn,endColumn=selection.endLineNumber===lineNumber?selection.endColumn:lineData.maxColumn;startColumn<endColumn&&(options.themeType===theme_1.ColorScheme.HIGH_CONTRAST||"selection"!==this._options.renderWhitespace?actualInlineDecorations.push(new lineDecorations_1.LineDecoration(startColumn,endColumn,"inline-selected-text",0)):(selectionsOnLine||(selectionsOnLine=[]),selectionsOnLine.push(new viewLineRenderer_1.LineRange(startColumn-1,endColumn-1))))}}const renderLineInput=new viewLineRenderer_1.RenderLineInput(options.useMonospaceOptimizations,options.canUseHalfwidthRightwardsArrow,lineData.content,lineData.continuesWithWrappedLine,lineData.isBasicASCII,lineData.containsRTL,lineData.minColumn-1,lineData.tokens,actualInlineDecorations,lineData.tabSize,lineData.startVisibleColumn,options.spaceWidth,options.middotWidth,options.wsmiddotWidth,options.stopRenderingLineAfter,options.renderWhitespace,options.renderControlCharacters,options.fontLigatures!==editorOptions_1.EditorFontLigatures.OFF,selectionsOnLine);if(this._renderedViewLine&&this._renderedViewLine.input.equals(renderLineInput))return!1;sb.appendASCIIString('<div style="top:'),sb.appendASCIIString(String(deltaTop)),sb.appendASCIIString("px;height:"),sb.appendASCIIString(String(this._options.lineHeight)),sb.appendASCIIString('px;" class="'),sb.appendASCIIString(ViewLine.CLASS_NAME),sb.appendASCIIString('">');const output=(0,viewLineRenderer_1.renderViewLine)(renderLineInput,sb);sb.appendASCIIString("</div>");let renderedViewLine=null;return monospaceAssumptionsAreValid&&canUseFastRenderedViewLine&&lineData.isBasicASCII&&options.useMonospaceOptimizations&&0===output.containsForeignElements&&lineData.content.length<300&&renderLineInput.lineTokens.getCount()<100&&(renderedViewLine=new FastRenderedViewLine(this._renderedViewLine?this._renderedViewLine.domNode:null,renderLineInput,output.characterMapping)),renderedViewLine||(renderedViewLine=createRenderedLine(this._renderedViewLine?this._renderedViewLine.domNode:null,renderLineInput,output.characterMapping,output.containsRTL,output.containsForeignElements)),this._renderedViewLine=renderedViewLine,!0}layoutLine(lineNumber,deltaTop){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(deltaTop),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(){return this._renderedViewLine?this._renderedViewLine.getWidth():0}getWidthIsFast(){return!this._renderedViewLine||this._renderedViewLine.getWidthIsFast()}needsMonospaceFontCheck(){return!!this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine?this._renderedViewLine.monospaceAssumptionsAreValid():monospaceAssumptionsAreValid}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(lineNumber,startColumn,endColumn,context){if(!this._renderedViewLine)return null;startColumn=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,startColumn)),endColumn=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,endColumn));const stopRenderingLineAfter=this._renderedViewLine.input.stopRenderingLineAfter;let outsideRenderedLine=!1;-1!==stopRenderingLineAfter&&startColumn>stopRenderingLineAfter+1&&endColumn>stopRenderingLineAfter+1&&(outsideRenderedLine=!0),-1!==stopRenderingLineAfter&&startColumn>stopRenderingLineAfter+1&&(startColumn=stopRenderingLineAfter+1),-1!==stopRenderingLineAfter&&endColumn>stopRenderingLineAfter+1&&(endColumn=stopRenderingLineAfter+1);const horizontalRanges=this._renderedViewLine.getVisibleRangesForRange(lineNumber,startColumn,endColumn,context);return horizontalRanges&&horizontalRanges.length>0?new renderingContext_1.VisibleRanges(outsideRenderedLine,horizontalRanges):null}getColumnOfNodeOffset(lineNumber,spanNode,offset){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(lineNumber,spanNode,offset):1}}exports.ViewLine=ViewLine,ViewLine.CLASS_NAME="view-line";class FastRenderedViewLine{constructor(domNode,renderLineInput,characterMapping){this.domNode=domNode,this.input=renderLineInput,this._characterMapping=characterMapping,this._charWidth=renderLineInput.spaceWidth}getWidth(){return Math.round(this._getCharPosition(this._characterMapping.length))}getWidthIsFast(){return!0}monospaceAssumptionsAreValid(){if(!this.domNode)return monospaceAssumptionsAreValid;const expectedWidth=this.getWidth(),actualWidth=this.domNode.domNode.firstChild.offsetWidth;return Math.abs(expectedWidth-actualWidth)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),monospaceAssumptionsAreValid=!1),monospaceAssumptionsAreValid}toSlowRenderedLine(){return createRenderedLine(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(lineNumber,startColumn,endColumn,context){const startPosition=this._getCharPosition(startColumn),endPosition=this._getCharPosition(endColumn);return[new renderingContext_1.FloatHorizontalRange(startPosition,endPosition-startPosition)]}_getCharPosition(column){const charOffset=this._characterMapping.getAbsoluteOffset(column);return this._charWidth*charOffset}getColumnOfNodeOffset(lineNumber,spanNode,offset){const spanNodeTextContentLength=spanNode.textContent.length;let spanIndex=-1;for(;spanNode;)spanNode=spanNode.previousSibling,spanIndex++;return this._characterMapping.getColumn(new viewLineRenderer_1.DomPosition(spanIndex,offset),spanNodeTextContentLength)}}class RenderedViewLine{constructor(domNode,renderLineInput,characterMapping,containsRTL,containsForeignElements){if(this.domNode=domNode,this.input=renderLineInput,this._characterMapping=characterMapping,this._isWhitespaceOnly=/^\s*$/.test(renderLineInput.lineContent),this._containsForeignElements=containsForeignElements,this._cachedWidth=-1,this._pixelOffsetCache=null,!containsRTL||0===this._characterMapping.length){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let column=0,len=this._characterMapping.length;column<=len;column++)this._pixelOffsetCache[column]=-1}}_getReadingTarget(myDomNode){return myDomNode.domNode.firstChild}getWidth(){return this.domNode?(-1===this._cachedWidth&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth),this._cachedWidth):0}getWidthIsFast(){return-1!==this._cachedWidth}getVisibleRangesForRange(lineNumber,startColumn,endColumn,context){if(!this.domNode)return null;if(null!==this._pixelOffsetCache){const startOffset=this._readPixelOffset(this.domNode,lineNumber,startColumn,context);if(-1===startOffset)return null;const endOffset=this._readPixelOffset(this.domNode,lineNumber,endColumn,context);return-1===endOffset?null:[new renderingContext_1.FloatHorizontalRange(startOffset,endOffset-startOffset)]}return this._readVisibleRangesForRange(this.domNode,lineNumber,startColumn,endColumn,context)}_readVisibleRangesForRange(domNode,lineNumber,startColumn,endColumn,context){if(startColumn===endColumn){const pixelOffset=this._readPixelOffset(domNode,lineNumber,startColumn,context);return-1===pixelOffset?null:[new renderingContext_1.FloatHorizontalRange(pixelOffset,0)]}return this._readRawVisibleRangesForRange(domNode,startColumn,endColumn,context)}_readPixelOffset(domNode,lineNumber,column,context){if(0===this._characterMapping.length){if(0===this._containsForeignElements)return 0;if(2===this._containsForeignElements)return 0;if(1===this._containsForeignElements)return this.getWidth();const readingTarget=this._getReadingTarget(domNode);return readingTarget.firstChild?readingTarget.firstChild.offsetWidth:0}if(null!==this._pixelOffsetCache){const cachedPixelOffset=this._pixelOffsetCache[column];if(-1!==cachedPixelOffset)return cachedPixelOffset;const result=this._actualReadPixelOffset(domNode,lineNumber,column,context);return this._pixelOffsetCache[column]=result,result}return this._actualReadPixelOffset(domNode,lineNumber,column,context)}_actualReadPixelOffset(domNode,lineNumber,column,context){if(0===this._characterMapping.length){const r=rangeUtil_1.RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode),0,0,0,0,context.clientRectDeltaLeft,context.clientRectScale,context.endNode);return r&&0!==r.length?r[0].left:-1}if(column===this._characterMapping.length&&this._isWhitespaceOnly&&0===this._containsForeignElements)return this.getWidth();const domPosition=this._characterMapping.getDomPosition(column),r=rangeUtil_1.RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode),domPosition.partIndex,domPosition.charIndex,domPosition.partIndex,domPosition.charIndex,context.clientRectDeltaLeft,context.clientRectScale,context.endNode);if(!r||0===r.length)return-1;const result=r[0].left;if(this.input.isBasicASCII){const charOffset=this._characterMapping.getAbsoluteOffset(column),expectedResult=Math.round(this.input.spaceWidth*charOffset);if(Math.abs(expectedResult-result)<=1)return expectedResult}return result}_readRawVisibleRangesForRange(domNode,startColumn,endColumn,context){if(1===startColumn&&endColumn===this._characterMapping.length)return[new renderingContext_1.FloatHorizontalRange(0,this.getWidth())];const startDomPosition=this._characterMapping.getDomPosition(startColumn),endDomPosition=this._characterMapping.getDomPosition(endColumn);return rangeUtil_1.RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode),startDomPosition.partIndex,startDomPosition.charIndex,endDomPosition.partIndex,endDomPosition.charIndex,context.clientRectDeltaLeft,context.clientRectScale,context.endNode)}getColumnOfNodeOffset(lineNumber,spanNode,offset){const spanNodeTextContentLength=spanNode.textContent.length;let spanIndex=-1;for(;spanNode;)spanNode=spanNode.previousSibling,spanIndex++;return this._characterMapping.getColumn(new viewLineRenderer_1.DomPosition(spanIndex,offset),spanNodeTextContentLength)}}class WebKitRenderedViewLine extends RenderedViewLine{_readVisibleRangesForRange(domNode,lineNumber,startColumn,endColumn,context){const output=super._readVisibleRangesForRange(domNode,lineNumber,startColumn,endColumn,context);if(!output||0===output.length||startColumn===endColumn||1===startColumn&&endColumn===this._characterMapping.length)return output;if(!this.input.containsRTL){const endPixelOffset=this._readPixelOffset(domNode,lineNumber,endColumn,context);if(-1!==endPixelOffset){const lastRange=output[output.length-1];lastRange.left<endPixelOffset&&(lastRange.width=endPixelOffset-lastRange.left)}}return output}}const createRenderedLine=browser.isWebKit?createWebKitRenderedLine:createNormalRenderedLine;function createWebKitRenderedLine(domNode,renderLineInput,characterMapping,containsRTL,containsForeignElements){return new WebKitRenderedViewLine(domNode,renderLineInput,characterMapping,containsRTL,containsForeignElements)}function createNormalRenderedLine(domNode,renderLineInput,characterMapping,containsRTL,containsForeignElements){return new RenderedViewLine(domNode,renderLineInput,characterMapping,containsRTL,containsForeignElements)}})),define(__m[285],__M([1,0,133,51,284,11,3,70,7,241]),(function(require,exports,editorDom_1,viewPart_1,viewLine_1,position_1,range_1,cursorColumns_1,dom,cursorAtomicMoveOperations_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shadowCaretRangeFromPoint=exports.MouseTargetFactory=exports.HitTestContext=exports.MouseTarget=exports.PointerHandlerLastRenderData=void 0;class UnknownHitTestResult{constructor(hitTarget=null){this.hitTarget=hitTarget,this.type=0}}class ContentHitTestResult{constructor(position,spanNode,injectedText){this.position=position,this.spanNode=spanNode,this.injectedText=injectedText,this.type=1}}var HitTestResult;!function(HitTestResult){HitTestResult.createFromDOMInfo=function createFromDOMInfo(ctx,spanNode,offset){const position=ctx.getPositionFromDOMInfo(spanNode,offset);return position?new ContentHitTestResult(position,spanNode,null):new UnknownHitTestResult(spanNode)}}(HitTestResult||(HitTestResult={}));exports.PointerHandlerLastRenderData=class PointerHandlerLastRenderData{constructor(lastViewCursorsRenderData,lastTextareaPosition){this.lastViewCursorsRenderData=lastViewCursorsRenderData,this.lastTextareaPosition=lastTextareaPosition}};class MouseTarget{static _deduceRage(position,range=null){return!range&&position?new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column):null!=range?range:null}static createUnknown(element,mouseColumn,position){return{type:0,element,mouseColumn,position,range:this._deduceRage(position)}}static createTextarea(element,mouseColumn){return{type:1,element,mouseColumn,position:null,range:null}}static createMargin(type,element,mouseColumn,position,range,detail){return{type,element,mouseColumn,position,range,detail}}static createViewZone(type,element,mouseColumn,position,detail){return{type,element,mouseColumn,position,range:this._deduceRage(position),detail}}static createContentText(element,mouseColumn,position,range,detail){return{type:6,element,mouseColumn,position,range:this._deduceRage(position,range),detail}}static createContentEmpty(element,mouseColumn,position,detail){return{type:7,element,mouseColumn,position,range:this._deduceRage(position),detail}}static createContentWidget(element,mouseColumn,detail){return{type:9,element,mouseColumn,position:null,range:null,detail}}static createScrollbar(element,mouseColumn,position){return{type:11,element,mouseColumn,position,range:this._deduceRage(position)}}static createOverlayWidget(element,mouseColumn,detail){return{type:12,element,mouseColumn,position:null,range:null,detail}}static createOutsideEditor(mouseColumn,position){return{type:13,element:null,mouseColumn,position,range:this._deduceRage(position)}}static _typeToString(type){return 1===type?"TEXTAREA":2===type?"GUTTER_GLYPH_MARGIN":3===type?"GUTTER_LINE_NUMBERS":4===type?"GUTTER_LINE_DECORATIONS":5===type?"GUTTER_VIEW_ZONE":6===type?"CONTENT_TEXT":7===type?"CONTENT_EMPTY":8===type?"CONTENT_VIEW_ZONE":9===type?"CONTENT_WIDGET":10===type?"OVERVIEW_RULER":11===type?"SCROLLBAR":12===type?"OVERLAY_WIDGET":"UNKNOWN"}static toString(target){return this._typeToString(target.type)+": "+target.position+" - "+target.range+" - "+JSON.stringify(target.detail)}}exports.MouseTarget=MouseTarget;class ElementPath{static isTextArea(path){return 2===path.length&&3===path[0]&&6===path[1]}static isChildOfViewLines(path){return path.length>=4&&3===path[0]&&7===path[3]}static isStrictChildOfViewLines(path){return path.length>4&&3===path[0]&&7===path[3]}static isChildOfScrollableElement(path){return path.length>=2&&3===path[0]&&5===path[1]}static isChildOfMinimap(path){return path.length>=2&&3===path[0]&&8===path[1]}static isChildOfContentWidgets(path){return path.length>=4&&3===path[0]&&1===path[3]}static isChildOfOverflowingContentWidgets(path){return path.length>=1&&2===path[0]}static isChildOfOverlayWidgets(path){return path.length>=2&&3===path[0]&&4===path[1]}}class HitTestContext{constructor(context,viewHelper,lastRenderData){this.viewModel=context.viewModel;const options=context.configuration.options;this.layoutInfo=options.get(131),this.viewDomNode=viewHelper.viewDomNode,this.lineHeight=options.get(59),this.stickyTabStops=options.get(104),this.typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,this.lastRenderData=lastRenderData,this._context=context,this._viewHelper=viewHelper}getZoneAtCoord(mouseVerticalOffset){return HitTestContext.getZoneAtCoord(this._context,mouseVerticalOffset)}static getZoneAtCoord(context,mouseVerticalOffset){const viewZoneWhitespace=context.viewLayout.getWhitespaceAtVerticalOffset(mouseVerticalOffset);if(viewZoneWhitespace){const viewZoneMiddle=viewZoneWhitespace.verticalOffset+viewZoneWhitespace.height/2,lineCount=context.viewModel.getLineCount();let position,positionBefore=null,positionAfter=null;return viewZoneWhitespace.afterLineNumber!==lineCount&&(positionAfter=new position_1.Position(viewZoneWhitespace.afterLineNumber+1,1)),viewZoneWhitespace.afterLineNumber>0&&(positionBefore=new position_1.Position(viewZoneWhitespace.afterLineNumber,context.viewModel.getLineMaxColumn(viewZoneWhitespace.afterLineNumber))),position=null===positionAfter?positionBefore:null===positionBefore?positionAfter:mouseVerticalOffset<viewZoneMiddle?positionBefore:positionAfter,{viewZoneId:viewZoneWhitespace.id,afterLineNumber:viewZoneWhitespace.afterLineNumber,positionBefore,positionAfter,position}}return null}getFullLineRangeAtCoord(mouseVerticalOffset){if(this._context.viewLayout.isAfterLines(mouseVerticalOffset)){const lineNumber=this._context.viewModel.getLineCount(),maxLineColumn=this._context.viewModel.getLineMaxColumn(lineNumber);return{range:new range_1.Range(lineNumber,maxLineColumn,lineNumber,maxLineColumn),isAfterLines:!0}}const lineNumber=this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset),maxLineColumn=this._context.viewModel.getLineMaxColumn(lineNumber);return{range:new range_1.Range(lineNumber,1,lineNumber,maxLineColumn),isAfterLines:!1}}getLineNumberAtVerticalOffset(mouseVerticalOffset){return this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset)}isAfterLines(mouseVerticalOffset){return this._context.viewLayout.isAfterLines(mouseVerticalOffset)}isInTopPadding(mouseVerticalOffset){return this._context.viewLayout.isInTopPadding(mouseVerticalOffset)}isInBottomPadding(mouseVerticalOffset){return this._context.viewLayout.isInBottomPadding(mouseVerticalOffset)}getVerticalOffsetForLineNumber(lineNumber){return this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber)}findAttribute(element,attr){return HitTestContext._findAttribute(element,attr,this._viewHelper.viewDomNode)}static _findAttribute(element,attr,stopAt){for(;element&&element!==document.body;){if(element.hasAttribute&&element.hasAttribute(attr))return element.getAttribute(attr);if(element===stopAt)return null;element=element.parentNode}return null}getLineWidth(lineNumber){return this._viewHelper.getLineWidth(lineNumber)}visibleRangeForPosition(lineNumber,column){return this._viewHelper.visibleRangeForPosition(lineNumber,column)}getPositionFromDOMInfo(spanNode,offset){return this._viewHelper.getPositionFromDOMInfo(spanNode,offset)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}exports.HitTestContext=HitTestContext;class HitTestRequest extends class BareHitTestRequest{constructor(ctx,editorPos,pos,relativePos){this.editorPos=editorPos,this.pos=pos,this.relativePos=relativePos,this.mouseVerticalOffset=Math.max(0,ctx.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=ctx.getCurrentScrollLeft()+this.relativePos.x-ctx.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<ctx.layoutInfo.contentLeft&&this.relativePos.x>=ctx.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset,ctx.typicalHalfwidthCharacterWidth))}}{constructor(ctx,editorPos,pos,relativePos,target){super(ctx,editorPos,pos,relativePos),this._ctx=ctx,target?(this.target=target,this.targetPath=viewPart_1.PartFingerprints.collect(target,ctx.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\n\ttarget: ${this.target?this.target.outerHTML:null}`}_getMouseColumn(position=null){return position&&position.column<this._ctx.viewModel.getLineMaxColumn(position.lineNumber)?cursorColumns_1.CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(position.lineNumber),position.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(position=null){return MouseTarget.createUnknown(this.target,this._getMouseColumn(position),position)}fulfillTextarea(){return MouseTarget.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(type,position,range,detail){return MouseTarget.createMargin(type,this.target,this._getMouseColumn(position),position,range,detail)}fulfillViewZone(type,position,detail){return MouseTarget.createViewZone(type,this.target,this._getMouseColumn(position),position,detail)}fulfillContentText(position,range,detail){return MouseTarget.createContentText(this.target,this._getMouseColumn(position),position,range,detail)}fulfillContentEmpty(position,detail){return MouseTarget.createContentEmpty(this.target,this._getMouseColumn(position),position,detail)}fulfillContentWidget(detail){return MouseTarget.createContentWidget(this.target,this._getMouseColumn(),detail)}fulfillScrollbar(position){return MouseTarget.createScrollbar(this.target,this._getMouseColumn(position),position)}fulfillOverlayWidget(detail){return MouseTarget.createOverlayWidget(this.target,this._getMouseColumn(),detail)}withTarget(target){return new HitTestRequest(this._ctx,this.editorPos,this.pos,this.relativePos,target)}}const EMPTY_CONTENT_AFTER_LINES={isAfterLines:!0};function createEmptyContentDataInLines(horizontalDistanceToText){return{isAfterLines:!1,horizontalDistanceToText}}class MouseTargetFactory{constructor(context,viewHelper){this._context=context,this._viewHelper=viewHelper}mouseTargetIsWidget(e){const t=e.target,path=viewPart_1.PartFingerprints.collect(t,this._viewHelper.viewDomNode);return!(!ElementPath.isChildOfContentWidgets(path)&&!ElementPath.isChildOfOverflowingContentWidgets(path))||!!ElementPath.isChildOfOverlayWidgets(path)}createMouseTarget(lastRenderData,editorPos,pos,relativePos,target){const ctx=new HitTestContext(this._context,this._viewHelper,lastRenderData),request=new HitTestRequest(ctx,editorPos,pos,relativePos,target);try{return MouseTargetFactory._createMouseTarget(ctx,request,!1)}catch(err){return request.fulfillUnknown()}}static _createMouseTarget(ctx,request,domHitTestExecuted){if(null===request.target){if(domHitTestExecuted)return request.fulfillUnknown();const hitTestResult=MouseTargetFactory._doHitTest(ctx,request);return 1===hitTestResult.type?MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx,request,hitTestResult.spanNode,hitTestResult.position,hitTestResult.injectedText):this._createMouseTarget(ctx,request.withTarget(hitTestResult.hitTarget),!0)}const resolvedRequest=request;let result=null;return result=result||MouseTargetFactory._hitTestContentWidget(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestOverlayWidget(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestMinimap(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestScrollbarSlider(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestViewZone(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestMargin(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestViewCursor(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestTextArea(ctx,resolvedRequest),result=result||MouseTargetFactory._hitTestViewLines(ctx,resolvedRequest,domHitTestExecuted),result=result||MouseTargetFactory._hitTestScrollbar(ctx,resolvedRequest),result||request.fulfillUnknown()}static _hitTestContentWidget(ctx,request){if(ElementPath.isChildOfContentWidgets(request.targetPath)||ElementPath.isChildOfOverflowingContentWidgets(request.targetPath)){const widgetId=ctx.findAttribute(request.target,"widgetId");return widgetId?request.fulfillContentWidget(widgetId):request.fulfillUnknown()}return null}static _hitTestOverlayWidget(ctx,request){if(ElementPath.isChildOfOverlayWidgets(request.targetPath)){const widgetId=ctx.findAttribute(request.target,"widgetId");return widgetId?request.fulfillOverlayWidget(widgetId):request.fulfillUnknown()}return null}static _hitTestViewCursor(ctx,request){if(request.target){const lastViewCursorsRenderData=ctx.lastRenderData.lastViewCursorsRenderData;for(const d of lastViewCursorsRenderData)if(request.target===d.domNode)return request.fulfillContentText(d.position,null,{mightBeForeignElement:!1,injectedText:null})}if(request.isInContentArea){const lastViewCursorsRenderData=ctx.lastRenderData.lastViewCursorsRenderData,mouseContentHorizontalOffset=request.mouseContentHorizontalOffset,mouseVerticalOffset=request.mouseVerticalOffset;for(const d of lastViewCursorsRenderData){if(mouseContentHorizontalOffset<d.contentLeft)continue;if(mouseContentHorizontalOffset>d.contentLeft+d.width)continue;const cursorVerticalOffset=ctx.getVerticalOffsetForLineNumber(d.position.lineNumber);if(cursorVerticalOffset<=mouseVerticalOffset&&mouseVerticalOffset<=cursorVerticalOffset+d.height)return request.fulfillContentText(d.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(ctx,request){const viewZoneData=ctx.getZoneAtCoord(request.mouseVerticalOffset);if(viewZoneData){const mouseTargetType=request.isInContentArea?8:5;return request.fulfillViewZone(mouseTargetType,viewZoneData.position,viewZoneData)}return null}static _hitTestTextArea(ctx,request){return ElementPath.isTextArea(request.targetPath)?ctx.lastRenderData.lastTextareaPosition?request.fulfillContentText(ctx.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):request.fulfillTextarea():null}static _hitTestMargin(ctx,request){if(request.isInMarginArea){const res=ctx.getFullLineRangeAtCoord(request.mouseVerticalOffset),pos=res.range.getStartPosition();let offset=Math.abs(request.relativePos.x);const detail={isAfterLines:res.isAfterLines,glyphMarginLeft:ctx.layoutInfo.glyphMarginLeft,glyphMarginWidth:ctx.layoutInfo.glyphMarginWidth,lineNumbersWidth:ctx.layoutInfo.lineNumbersWidth,offsetX:offset};return offset-=ctx.layoutInfo.glyphMarginLeft,offset<=ctx.layoutInfo.glyphMarginWidth?request.fulfillMargin(2,pos,res.range,detail):(offset-=ctx.layoutInfo.glyphMarginWidth,offset<=ctx.layoutInfo.lineNumbersWidth?request.fulfillMargin(3,pos,res.range,detail):(offset-=ctx.layoutInfo.lineNumbersWidth,request.fulfillMargin(4,pos,res.range,detail)))}return null}static _hitTestViewLines(ctx,request,domHitTestExecuted){if(!ElementPath.isChildOfViewLines(request.targetPath))return null;if(ctx.isInTopPadding(request.mouseVerticalOffset))return request.fulfillContentEmpty(new position_1.Position(1,1),EMPTY_CONTENT_AFTER_LINES);if(ctx.isAfterLines(request.mouseVerticalOffset)||ctx.isInBottomPadding(request.mouseVerticalOffset)){const lineCount=ctx.viewModel.getLineCount(),maxLineColumn=ctx.viewModel.getLineMaxColumn(lineCount);return request.fulfillContentEmpty(new position_1.Position(lineCount,maxLineColumn),EMPTY_CONTENT_AFTER_LINES)}if(domHitTestExecuted){if(ElementPath.isStrictChildOfViewLines(request.targetPath)){const lineNumber=ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);if(0===ctx.viewModel.getLineLength(lineNumber)){const lineWidth=ctx.getLineWidth(lineNumber),detail=createEmptyContentDataInLines(request.mouseContentHorizontalOffset-lineWidth);return request.fulfillContentEmpty(new position_1.Position(lineNumber,1),detail)}const lineWidth=ctx.getLineWidth(lineNumber);if(request.mouseContentHorizontalOffset>=lineWidth){const detail=createEmptyContentDataInLines(request.mouseContentHorizontalOffset-lineWidth),pos=new position_1.Position(lineNumber,ctx.viewModel.getLineMaxColumn(lineNumber));return request.fulfillContentEmpty(pos,detail)}}return request.fulfillUnknown()}const hitTestResult=MouseTargetFactory._doHitTest(ctx,request);return 1===hitTestResult.type?MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx,request,hitTestResult.spanNode,hitTestResult.position,hitTestResult.injectedText):this._createMouseTarget(ctx,request.withTarget(hitTestResult.hitTarget),!0)}static _hitTestMinimap(ctx,request){if(ElementPath.isChildOfMinimap(request.targetPath)){const possibleLineNumber=ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset),maxColumn=ctx.viewModel.getLineMaxColumn(possibleLineNumber);return request.fulfillScrollbar(new position_1.Position(possibleLineNumber,maxColumn))}return null}static _hitTestScrollbarSlider(ctx,request){if(ElementPath.isChildOfScrollableElement(request.targetPath)&&request.target&&1===request.target.nodeType){const className=request.target.className;if(className&&/\b(slider|scrollbar)\b/.test(className)){const possibleLineNumber=ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset),maxColumn=ctx.viewModel.getLineMaxColumn(possibleLineNumber);return request.fulfillScrollbar(new position_1.Position(possibleLineNumber,maxColumn))}}return null}static _hitTestScrollbar(ctx,request){if(ElementPath.isChildOfScrollableElement(request.targetPath)){const possibleLineNumber=ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset),maxColumn=ctx.viewModel.getLineMaxColumn(possibleLineNumber);return request.fulfillScrollbar(new position_1.Position(possibleLineNumber,maxColumn))}return null}getMouseColumn(relativePos){const options=this._context.configuration.options,layoutInfo=options.get(131),mouseContentHorizontalOffset=this._context.viewLayout.getCurrentScrollLeft()+relativePos.x-layoutInfo.contentLeft;return MouseTargetFactory._getMouseColumn(mouseContentHorizontalOffset,options.get(44).typicalHalfwidthCharacterWidth)}static _getMouseColumn(mouseContentHorizontalOffset,typicalHalfwidthCharacterWidth){if(mouseContentHorizontalOffset<0)return 1;return Math.round(mouseContentHorizontalOffset/typicalHalfwidthCharacterWidth)+1}static createMouseTargetFromHitTestPosition(ctx,request,spanNode,pos,injectedText){const lineNumber=pos.lineNumber,column=pos.column,lineWidth=ctx.getLineWidth(lineNumber);if(request.mouseContentHorizontalOffset>lineWidth){const detail=createEmptyContentDataInLines(request.mouseContentHorizontalOffset-lineWidth);return request.fulfillContentEmpty(pos,detail)}const visibleRange=ctx.visibleRangeForPosition(lineNumber,column);if(!visibleRange)return request.fulfillUnknown(pos);const columnHorizontalOffset=visibleRange.left;if(request.mouseContentHorizontalOffset===columnHorizontalOffset)return request.fulfillContentText(pos,null,{mightBeForeignElement:!!injectedText,injectedText});const points=[];if(points.push({offset:visibleRange.left,column}),column>1){const visibleRange=ctx.visibleRangeForPosition(lineNumber,column-1);visibleRange&&points.push({offset:visibleRange.left,column:column-1})}if(column<ctx.viewModel.getLineMaxColumn(lineNumber)){const visibleRange=ctx.visibleRangeForPosition(lineNumber,column+1);visibleRange&&points.push({offset:visibleRange.left,column:column+1})}points.sort(((a,b)=>a.offset-b.offset));const mouseCoordinates=request.pos.toClientCoordinates(),spanNodeClientRect=spanNode.getBoundingClientRect(),mouseIsOverSpanNode=spanNodeClientRect.left<=mouseCoordinates.clientX&&mouseCoordinates.clientX<=spanNodeClientRect.right;for(let i=1;i<points.length;i++){const prev=points[i-1],curr=points[i];if(prev.offset<=request.mouseContentHorizontalOffset&&request.mouseContentHorizontalOffset<=curr.offset){const rng=new range_1.Range(lineNumber,prev.column,lineNumber,curr.column);return request.fulfillContentText(pos,rng,{mightBeForeignElement:!mouseIsOverSpanNode||!!injectedText,injectedText})}}return request.fulfillContentText(pos,null,{mightBeForeignElement:!mouseIsOverSpanNode||!!injectedText,injectedText})}static _doHitTestWithCaretRangeFromPoint(ctx,request){const lineNumber=ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset),lineCenteredVerticalOffset=ctx.getVerticalOffsetForLineNumber(lineNumber)+Math.floor(ctx.lineHeight/2);let adjustedPageY=request.pos.y+(lineCenteredVerticalOffset-request.mouseVerticalOffset);adjustedPageY<=request.editorPos.y&&(adjustedPageY=request.editorPos.y+1),adjustedPageY>=request.editorPos.y+request.editorPos.height&&(adjustedPageY=request.editorPos.y+request.editorPos.height-1);const adjustedPage=new editorDom_1.PageCoordinates(request.pos.x,adjustedPageY),r=this._actualDoHitTestWithCaretRangeFromPoint(ctx,adjustedPage.toClientCoordinates());return 1===r.type?r:this._actualDoHitTestWithCaretRangeFromPoint(ctx,request.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(ctx,coords){const shadowRoot=dom.getShadowRoot(ctx.viewDomNode);let range;if(range=shadowRoot?void 0===shadowRoot.caretRangeFromPoint?shadowCaretRangeFromPoint(shadowRoot,coords.clientX,coords.clientY):shadowRoot.caretRangeFromPoint(coords.clientX,coords.clientY):document.caretRangeFromPoint(coords.clientX,coords.clientY),!range||!range.startContainer)return new UnknownHitTestResult;const startContainer=range.startContainer;if(startContainer.nodeType===startContainer.TEXT_NODE){const parent1=startContainer.parentNode,parent2=parent1?parent1.parentNode:null,parent3=parent2?parent2.parentNode:null;return(parent3&&parent3.nodeType===parent3.ELEMENT_NODE?parent3.className:null)===viewLine_1.ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(ctx,parent1,range.startOffset):new UnknownHitTestResult(startContainer.parentNode)}if(startContainer.nodeType===startContainer.ELEMENT_NODE){const parent1=startContainer.parentNode,parent2=parent1?parent1.parentNode:null;return(parent2&&parent2.nodeType===parent2.ELEMENT_NODE?parent2.className:null)===viewLine_1.ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(ctx,startContainer,startContainer.textContent.length):new UnknownHitTestResult(startContainer)}return new UnknownHitTestResult}static _doHitTestWithCaretPositionFromPoint(ctx,coords){const hitResult=document.caretPositionFromPoint(coords.clientX,coords.clientY);if(hitResult.offsetNode.nodeType===hitResult.offsetNode.TEXT_NODE){const parent1=hitResult.offsetNode.parentNode,parent2=parent1?parent1.parentNode:null,parent3=parent2?parent2.parentNode:null;return(parent3&&parent3.nodeType===parent3.ELEMENT_NODE?parent3.className:null)===viewLine_1.ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(ctx,hitResult.offsetNode.parentNode,hitResult.offset):new UnknownHitTestResult(hitResult.offsetNode.parentNode)}if(hitResult.offsetNode.nodeType===hitResult.offsetNode.ELEMENT_NODE){const parent1=hitResult.offsetNode.parentNode,parent1ClassName=parent1&&parent1.nodeType===parent1.ELEMENT_NODE?parent1.className:null,parent2=parent1?parent1.parentNode:null,parent2ClassName=parent2&&parent2.nodeType===parent2.ELEMENT_NODE?parent2.className:null;if(parent1ClassName===viewLine_1.ViewLine.CLASS_NAME){const tokenSpan=hitResult.offsetNode.childNodes[Math.min(hitResult.offset,hitResult.offsetNode.childNodes.length-1)];if(tokenSpan)return HitTestResult.createFromDOMInfo(ctx,tokenSpan,0)}else if(parent2ClassName===viewLine_1.ViewLine.CLASS_NAME)return HitTestResult.createFromDOMInfo(ctx,hitResult.offsetNode,0)}return new UnknownHitTestResult(hitResult.offsetNode)}static _snapToSoftTabBoundary(position,viewModel){const lineContent=viewModel.getLineContent(position.lineNumber),{tabSize}=viewModel.model.getOptions(),newPosition=cursorAtomicMoveOperations_1.AtomicTabMoveOperations.atomicPosition(lineContent,position.column-1,tabSize,2);return-1!==newPosition?new position_1.Position(position.lineNumber,newPosition+1):position}static _doHitTest(ctx,request){let result=new UnknownHitTestResult;if("function"==typeof document.caretRangeFromPoint?result=this._doHitTestWithCaretRangeFromPoint(ctx,request):document.caretPositionFromPoint&&(result=this._doHitTestWithCaretPositionFromPoint(ctx,request.pos.toClientCoordinates())),1===result.type){const injectedText=ctx.viewModel.getInjectedTextAt(result.position),normalizedPosition=ctx.viewModel.normalizePosition(result.position,2);!injectedText&&normalizedPosition.equals(result.position)||(result=new ContentHitTestResult(normalizedPosition,result.spanNode,injectedText))}return 1===result.type&&ctx.stickyTabStops&&(result=new ContentHitTestResult(this._snapToSoftTabBoundary(result.position,ctx.viewModel),result.spanNode,result.injectedText)),result}}function shadowCaretRangeFromPoint(shadowRoot,x,y){const range=document.createRange();let el=shadowRoot.elementFromPoint(x,y);if(null!==el){for(;el&&el.firstChild&&el.firstChild.nodeType!==el.firstChild.TEXT_NODE&&el.lastChild&&el.lastChild.firstChild;)el=el.lastChild;const rect=el.getBoundingClientRect(),font=window.getComputedStyle(el,null).getPropertyValue("font"),text=el.innerText;let step,pixelCursor=rect.left,offset=0;if(x>rect.left+rect.width)offset=text.length;else{const charWidthReader=CharWidthReader.getInstance();for(let i=0;i<text.length+1;i++){if(step=charWidthReader.getCharWidth(text.charAt(i),font)/2,pixelCursor+=step,x<pixelCursor){offset=i;break}pixelCursor+=step}}range.setStart(el.firstChild,offset),range.setEnd(el.firstChild,offset)}return range}exports.MouseTargetFactory=MouseTargetFactory,exports.shadowCaretRangeFromPoint=shadowCaretRangeFromPoint;class CharWidthReader{constructor(){this._cache={},this._canvas=document.createElement("canvas")}static getInstance(){return CharWidthReader._INSTANCE||(CharWidthReader._INSTANCE=new CharWidthReader),CharWidthReader._INSTANCE}getCharWidth(char,font){const cacheKey=char+font;if(this._cache[cacheKey])return this._cache[cacheKey];const context=this._canvas.getContext("2d");context.font=font;const width=context.measureText(char).width;return this._cache[cacheKey]=width,width}}CharWidthReader._INSTANCE=null})),define(__m[644],__M([1,0,7,59,10,2,16,285,133,147,11,22,125]),(function(require,exports,dom,mouseEvent_1,async_1,lifecycle_1,platform,mouseTarget_1,editorDom_1,editorZoom_1,position_1,selection_1,viewEventHandler_1){"use strict";function createMouseMoveEventMerger(mouseTargetFactory){return function(lastEvent,currentEvent){let targetIsWidget=!1;return mouseTargetFactory&&(targetIsWidget=mouseTargetFactory.mouseTargetIsWidget(currentEvent)),targetIsWidget||currentEvent.preventDefault(),currentEvent}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.MouseHandler=exports.createMouseMoveEventMerger=void 0,exports.createMouseMoveEventMerger=createMouseMoveEventMerger;class MouseHandler extends viewEventHandler_1.ViewEventHandler{constructor(context,viewController,viewHelper){super(),this._context=context,this.viewController=viewController,this.viewHelper=viewHelper,this.mouseTargetFactory=new mouseTarget_1.MouseTargetFactory(this._context,viewHelper),this._mouseDownOperation=this._register(new MouseDownOperation(this._context,this.viewController,this.viewHelper,((e,testEventTarget)=>this._createMouseTarget(e,testEventTarget)),(e=>this._getMouseColumn(e)))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(131).height;const mouseEvents=new editorDom_1.EditorMouseEventFactory(this.viewHelper.viewDomNode);this._register(mouseEvents.onContextMenu(this.viewHelper.viewDomNode,(e=>this._onContextMenu(e,!0)))),this._register(mouseEvents.onMouseMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),createMouseMoveEventMerger(this.mouseTargetFactory),MouseHandler.MOUSE_MOVE_MINIMUM_TIME)),this._register(mouseEvents.onMouseUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(mouseEvents.onMouseLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(mouseEvents.onMouseDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))));this._register(dom.addDisposableListener(this.viewHelper.viewDomNode,dom.EventType.MOUSE_WHEEL,(browserEvent=>{if(this.viewController.emitMouseWheel(browserEvent),!this._context.configuration.options.get(68))return;const e=new mouseEvent_1.StandardWheelEvent(browserEvent);if(platform.isMacintosh?(browserEvent.metaKey||browserEvent.ctrlKey)&&!browserEvent.shiftKey&&!browserEvent.altKey:browserEvent.ctrlKey&&!browserEvent.metaKey&&!browserEvent.shiftKey&&!browserEvent.altKey){const zoomLevel=editorZoom_1.EditorZoom.getZoomLevel(),delta=e.deltaY>0?1:-1;editorZoom_1.EditorZoom.setZoomLevel(zoomLevel+delta),e.preventDefault(),e.stopPropagation()}}),{capture:!0,passive:!1})),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(131)){const height=this._context.configuration.options.get(131).height;this._height!==height&&(this._height=height,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}onScrollChanged(e){return this._mouseDownOperation.onScrollChanged(),!1}getTargetAtClientPoint(clientX,clientY){const pos=new editorDom_1.ClientCoordinates(clientX,clientY).toPageCoordinates(),editorPos=(0,editorDom_1.createEditorPagePosition)(this.viewHelper.viewDomNode);if(pos.y<editorPos.y||pos.y>editorPos.y+editorPos.height||pos.x<editorPos.x||pos.x>editorPos.x+editorPos.width)return null;const relativePos=(0,editorDom_1.createCoordinatesRelativeToEditor)(this.viewHelper.viewDomNode,editorPos,pos);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),editorPos,pos,relativePos,null)}_createMouseTarget(e,testEventTarget){let target=e.target;if(!this.viewHelper.viewDomNode.contains(target)){const shadowRoot=dom.getShadowRoot(this.viewHelper.viewDomNode);shadowRoot&&(target=shadowRoot.elementsFromPoint(e.posx,e.posy).find((el=>this.viewHelper.viewDomNode.contains(el))))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,testEventTarget?target:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,testEventTarget){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,testEventTarget)})}_onMouseMove(e){if(this._mouseDownOperation.isActive())return;e.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this.lastMouseLeaveTime=(new Date).getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e){const t=this._createMouseTarget(e,!0),targetIsContent=6===t.type||7===t.type,targetIsGutter=2===t.type||3===t.type||4===t.type,targetIsLineNumbers=3===t.type,selectOnLineNumbers=this._context.configuration.options.get(98),targetIsViewZone=8===t.type||5===t.type,targetIsWidget=9===t.type;let shouldHandle=e.leftButton||e.middleButton;platform.isMacintosh&&e.leftButton&&e.ctrlKey&&(shouldHandle=!1);const focus=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(shouldHandle&&(targetIsContent||targetIsLineNumbers&&selectOnLineNumbers))focus(),this._mouseDownOperation.start(t.type,e);else if(targetIsGutter)e.preventDefault();else if(targetIsViewZone){const viewZoneData=t.detail;this.viewHelper.shouldSuppressMouseDownOnViewZone(viewZoneData.viewZoneId)&&(focus(),this._mouseDownOperation.start(t.type,e),e.preventDefault())}else targetIsWidget&&this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)&&(focus(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:t})}}exports.MouseHandler=MouseHandler,MouseHandler.MOUSE_MOVE_MINIMUM_TIME=100;class MouseDownOperation extends lifecycle_1.Disposable{constructor(context,viewController,viewHelper,createMouseTarget,getMouseColumn){super(),this._context=context,this._viewController=viewController,this._viewHelper=viewHelper,this._createMouseTarget=createMouseTarget,this._getMouseColumn=getMouseColumn,this._mouseMoveMonitor=this._register(new editorDom_1.GlobalEditorMouseMoveMonitor(this._viewHelper.viewDomNode)),this._onScrollTimeout=this._register(new async_1.TimeoutTimer),this._mouseState=new MouseDownState,this._currentSelection=new selection_1.Selection(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const position=this._findMousePosition(e,!0);position&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:position}):this._dispatchMouse(position,!0))}start(targetType,e){this._lastMouseEvent=e,this._mouseState.setStartedOnLineNumbers(3===targetType),this._mouseState.setStartButtons(e),this._mouseState.setModifiers(e);const position=this._findMousePosition(e,!0);if(!position||!position.position)return;this._mouseState.trySetCount(e.detail,position.position),e.detail=this._mouseState.count;const options=this._context.configuration.options;if(!options.get(81)&&options.get(31)&&!options.get(18)&&!this._mouseState.altKey&&e.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&6===position.type&&position.position&&this._currentSelection.containsPosition(position.position))return this._mouseState.isDragAndDrop=!0,this._isActive=!0,void this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,createMouseMoveEventMerger(null),(e=>this._onMouseDownThenMove(e)),(browserEvent=>{const position=this._findMousePosition(this._lastMouseEvent,!0);browserEvent&&browserEvent instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:position?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()}));this._mouseState.isDragAndDrop=!1,this._dispatchMouse(position,e.shiftKey),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,createMouseMoveEventMerger(null),(e=>this._onMouseDownThenMove(e)),(()=>this._stop())))}_stop(){this._isActive=!1,this._onScrollTimeout.cancel()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onScrollChanged(){this._isActive&&this._onScrollTimeout.setIfNotSet((()=>{if(!this._lastMouseEvent)return;const position=this._findMousePosition(this._lastMouseEvent,!1);position&&(this._mouseState.isDragAndDrop||this._dispatchMouse(position,!0))}),10)}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const editorContent=e.editorPos,model=this._context.viewModel,viewLayout=this._context.viewLayout,mouseColumn=this._getMouseColumn(e);if(e.posy<editorContent.y){const verticalOffset=Math.max(viewLayout.getCurrentScrollTop()-(editorContent.y-e.posy),0),viewZoneData=mouseTarget_1.HitTestContext.getZoneAtCoord(this._context,verticalOffset);if(viewZoneData){const newPosition=this._helpPositionJumpOverViewZone(viewZoneData);if(newPosition)return mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,newPosition)}const aboveLineNumber=viewLayout.getLineNumberAtVerticalOffset(verticalOffset);return mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,new position_1.Position(aboveLineNumber,1))}if(e.posy>editorContent.y+editorContent.height){const verticalOffset=viewLayout.getCurrentScrollTop()+e.relativePos.y,viewZoneData=mouseTarget_1.HitTestContext.getZoneAtCoord(this._context,verticalOffset);if(viewZoneData){const newPosition=this._helpPositionJumpOverViewZone(viewZoneData);if(newPosition)return mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,newPosition)}const belowLineNumber=viewLayout.getLineNumberAtVerticalOffset(verticalOffset);return mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,new position_1.Position(belowLineNumber,model.getLineMaxColumn(belowLineNumber)))}const possibleLineNumber=viewLayout.getLineNumberAtVerticalOffset(viewLayout.getCurrentScrollTop()+e.relativePos.y);return e.posx<editorContent.x?mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,new position_1.Position(possibleLineNumber,1)):e.posx>editorContent.x+editorContent.width?mouseTarget_1.MouseTarget.createOutsideEditor(mouseColumn,new position_1.Position(possibleLineNumber,model.getLineMaxColumn(possibleLineNumber))):null}_findMousePosition(e,testEventTarget){const positionOutsideEditor=this._getPositionOutsideEditor(e);if(positionOutsideEditor)return positionOutsideEditor;const t=this._createMouseTarget(e,testEventTarget);if(!t.position)return null;if(8===t.type||5===t.type){const newPosition=this._helpPositionJumpOverViewZone(t.detail);if(newPosition)return mouseTarget_1.MouseTarget.createViewZone(t.type,t.element,t.mouseColumn,newPosition,t.detail)}return t}_helpPositionJumpOverViewZone(viewZoneData){const selectionStart=new position_1.Position(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),positionBefore=viewZoneData.positionBefore,positionAfter=viewZoneData.positionAfter;return positionBefore&&positionAfter?positionBefore.isBefore(selectionStart)?positionBefore:positionAfter:null}_dispatchMouse(position,inSelectionMode){position.position&&this._viewController.dispatchMouse({position:position.position,mouseColumn:position.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,inSelectionMode,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:6===position.type&&null!==position.detail.injectedText})}}class MouseDownState{constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}get count(){return this._lastMouseDownCount}setModifiers(source){this._altKey=source.altKey,this._ctrlKey=source.ctrlKey,this._metaKey=source.metaKey,this._shiftKey=source.shiftKey}setStartButtons(source){this._leftButton=source.leftButton,this._middleButton=source.middleButton}setStartedOnLineNumbers(startedOnLineNumbers){this._startedOnLineNumbers=startedOnLineNumbers}trySetCount(setMouseDownCount,newMouseDownPosition){const currentTime=(new Date).getTime();currentTime-this._lastSetMouseDownCountTime>MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME&&(setMouseDownCount=1),this._lastSetMouseDownCountTime=currentTime,setMouseDownCount>this._lastMouseDownCount+1&&(setMouseDownCount=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(newMouseDownPosition)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=newMouseDownPosition,this._lastMouseDownCount=Math.min(setMouseDownCount,this._lastMouseDownPositionEqualCount)}}MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME=400})),define(__m[645],__M([1,0,7,16,60,2,644,133,167,178]),(function(require,exports,dom,platform,touch_1,lifecycle_1,mouseHandler_1,editorDom_1,canIUse_1,textAreaInput_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PointerHandler=exports.PointerEventHandler=void 0;class PointerEventHandler extends mouseHandler_1.MouseHandler{constructor(context,viewController,viewHelper){super(context,viewController,viewHelper),this._register(touch_1.Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Tap,(e=>this.onTap(e)))),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Change,(e=>this.onChange(e)))),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Contextmenu,(e=>this._onContextMenu(new editorDom_1.EditorMouseEvent(e,this.viewHelper.viewDomNode),!1)))),this._lastPointerType="mouse",this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,"pointerdown",(e=>{const pointerType=e.pointerType;this._lastPointerType="mouse"!==pointerType?"touch"===pointerType?"touch":"pen":"mouse"})));const pointerEvents=new editorDom_1.EditorPointerEventFactory(this.viewHelper.viewDomNode);this._register(pointerEvents.onPointerMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),(0,mouseHandler_1.createMouseMoveEventMerger)(this.mouseTargetFactory),mouseHandler_1.MouseHandler.MOUSE_MOVE_MINIMUM_TIME)),this._register(pointerEvents.onPointerUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(pointerEvents.onPointerLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(pointerEvents.onPointerDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))))}onTap(event){if(!event.initialTarget||!this.viewHelper.linesContentDomNode.contains(event.initialTarget))return;event.preventDefault(),this.viewHelper.focusTextArea();const target=this._createMouseTarget(new editorDom_1.EditorMouseEvent(event,this.viewHelper.viewDomNode),!1);target.position&&this.viewController.dispatchMouse({position:target.position,mouseColumn:target.position.column,startedOnLineNumbers:!1,mouseDownCount:event.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:6===target.type&&null!==target.detail.injectedText})}onChange(e){"touch"===this._lastPointerType&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e){"touch"!==e.browserEvent.pointerType&&super._onMouseDown(e)}}exports.PointerEventHandler=PointerEventHandler;class TouchHandler extends mouseHandler_1.MouseHandler{constructor(context,viewController,viewHelper){super(context,viewController,viewHelper),this._register(touch_1.Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Tap,(e=>this.onTap(e)))),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Change,(e=>this.onChange(e)))),this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode,touch_1.EventType.Contextmenu,(e=>this._onContextMenu(new editorDom_1.EditorMouseEvent(e,this.viewHelper.viewDomNode),!1))))}onTap(event){event.preventDefault(),this.viewHelper.focusTextArea();const target=this._createMouseTarget(new editorDom_1.EditorMouseEvent(event,this.viewHelper.viewDomNode),!1);if(target.position){const event=document.createEvent("CustomEvent");event.initEvent(textAreaInput_1.TextAreaSyntethicEvents.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(event),this.viewController.moveTo(target.position)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class PointerHandler extends lifecycle_1.Disposable{constructor(context,viewController,viewHelper){super(),platform.isIOS&&canIUse_1.BrowserFeatures.pointerEvents?this.handler=this._register(new PointerEventHandler(context,viewController,viewHelper)):window.TouchEvent?this.handler=this._register(new TouchHandler(context,viewController,viewHelper)):this.handler=this._register(new mouseHandler_1.MouseHandler(context,viewController,viewHelper))}getTargetAtClientPoint(clientX,clientY){return this.handler.getTargetAtClientPoint(clientX,clientY)}}exports.PointerHandler=PointerHandler})),define(__m[646],__M([1,0,16,10,64,179,51,284,11,3,118,144,359]),(function(require,exports,platform,async_1,domFontInfo_1,viewLayer_1,viewPart_1,viewLine_1,position_1,range_1,renderingContext_1,mouseCursor_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewLines=void 0;class LastRenderedData{constructor(){this._currentVisibleRange=new range_1.Range(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(currentVisibleRange){this._currentVisibleRange=currentVisibleRange}}class HorizontalRevealRangeRequest{constructor(minimalReveal,lineNumber,startColumn,endColumn,startScrollTop,stopScrollTop,scrollType){this.minimalReveal=minimalReveal,this.lineNumber=lineNumber,this.startColumn=startColumn,this.endColumn=endColumn,this.startScrollTop=startScrollTop,this.stopScrollTop=stopScrollTop,this.scrollType=scrollType,this.type="range",this.minLineNumber=lineNumber,this.maxLineNumber=lineNumber}}class HorizontalRevealSelectionsRequest{constructor(minimalReveal,selections,startScrollTop,stopScrollTop,scrollType){this.minimalReveal=minimalReveal,this.selections=selections,this.startScrollTop=startScrollTop,this.stopScrollTop=stopScrollTop,this.scrollType=scrollType,this.type="selections";let minLineNumber=selections[0].startLineNumber,maxLineNumber=selections[0].endLineNumber;for(let i=1,len=selections.length;i<len;i++){const selection=selections[i];minLineNumber=Math.min(minLineNumber,selection.startLineNumber),maxLineNumber=Math.max(maxLineNumber,selection.endLineNumber)}this.minLineNumber=minLineNumber,this.maxLineNumber=maxLineNumber}}class ViewLines extends viewPart_1.ViewPart{constructor(context,linesContent){super(context),this._linesContent=linesContent,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new viewLayer_1.VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode;const conf=this._context.configuration,options=this._context.configuration.options,fontInfo=options.get(44),wrappingInfo=options.get(132),layoutInfo=options.get(131);this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,this._isViewportWrapping=wrappingInfo.isViewportWrapping,this._revealHorizontalRightPadding=options.get(89),this._horizontalScrollbarHeight=layoutInfo.horizontalScrollbarHeight,this._cursorSurroundingLines=options.get(25),this._cursorSurroundingLinesStyle=options.get(26),this._canUseLayerHinting=!options.get(28),this._viewLineOptions=new viewLine_1.ViewLineOptions(conf,this._context.theme.type),viewPart_1.PartFingerprints.write(this.domNode,7),this.domNode.setClassName(`view-lines ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),(0,domFontInfo_1.applyFontInfo)(this.domNode,fontInfo),this._maxLineWidth=0,this._asyncUpdateLineWidths=new async_1.RunOnceScheduler((()=>{this._updateLineWidthsSlow()}),200),this._asyncCheckMonospaceFontAssumptions=new async_1.RunOnceScheduler((()=>{this._checkMonospaceFontAssumptions()}),2e3),this._lastRenderedData=new LastRenderedData,this._horizontalRevealRequest=null}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new viewLine_1.ViewLine(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(132)&&(this._maxLineWidth=0);const options=this._context.configuration.options,fontInfo=options.get(44),wrappingInfo=options.get(132),layoutInfo=options.get(131);return this._lineHeight=options.get(59),this._typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,this._isViewportWrapping=wrappingInfo.isViewportWrapping,this._revealHorizontalRightPadding=options.get(89),this._horizontalScrollbarHeight=layoutInfo.horizontalScrollbarHeight,this._cursorSurroundingLines=options.get(25),this._cursorSurroundingLinesStyle=options.get(26),this._canUseLayerHinting=!options.get(28),(0,domFontInfo_1.applyFontInfo)(this.domNode,fontInfo),this._onOptionsMaybeChanged(),e.hasChanged(131)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const conf=this._context.configuration,newViewLineOptions=new viewLine_1.ViewLineOptions(conf,this._context.theme.type);if(!this._viewLineOptions.equals(newViewLineOptions)){this._viewLineOptions=newViewLineOptions;const startLineNumber=this._visibleLines.getStartLineNumber(),endLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){this._visibleLines.getVisibleLine(lineNumber).onOptionsChanged(this._viewLineOptions)}return!0}return!1}onCursorStateChanged(e){const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();let r=!1;for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++)r=this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged()||r;return r}onDecorationsChanged(e){{const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++)this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged()}return!0}onFlushed(e){const shouldRender=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,shouldRender}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const desiredScrollTop=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(-1===desiredScrollTop)return!1;let newScrollPosition=this._context.viewLayout.validateScrollPosition({scrollTop:desiredScrollTop});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?newScrollPosition={scrollTop:newScrollPosition.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new HorizontalRevealRangeRequest(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),newScrollPosition.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new HorizontalRevealSelectionsRequest(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),newScrollPosition.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const scrollType=Math.abs(this._context.viewLayout.getCurrentScrollTop()-newScrollPosition.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition,scrollType),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const min=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),max=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<min||e.scrollTop>max)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(spanNode,offset){const viewLineDomNode=this._getViewLineDomNode(spanNode);if(null===viewLineDomNode)return null;const lineNumber=this._getLineNumberFor(viewLineDomNode);if(-1===lineNumber)return null;if(lineNumber<1||lineNumber>this._context.viewModel.getLineCount())return null;if(1===this._context.viewModel.getLineMaxColumn(lineNumber))return new position_1.Position(lineNumber,1);const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();if(lineNumber<rendStartLineNumber||lineNumber>rendEndLineNumber)return null;let column=this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber,spanNode,offset);const minColumn=this._context.viewModel.getLineMinColumn(lineNumber);return column<minColumn&&(column=minColumn),new position_1.Position(lineNumber,column)}_getViewLineDomNode(node){for(;node&&1===node.nodeType;){if(node.className===viewLine_1.ViewLine.CLASS_NAME)return node;node=node.parentElement}return null}_getLineNumberFor(domNode){const startLineNumber=this._visibleLines.getStartLineNumber(),endLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){if(domNode===this._visibleLines.getVisibleLine(lineNumber).getDomNode())return lineNumber}return-1}getLineWidth(lineNumber){const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();return lineNumber<rendStartLineNumber||lineNumber>rendEndLineNumber?-1:this._visibleLines.getVisibleLine(lineNumber).getWidth()}linesVisibleRangesForRange(_range,includeNewLines){if(this.shouldRender())return null;const originalEndLineNumber=_range.endLineNumber,range=range_1.Range.intersectRanges(_range,this._lastRenderedData.getCurrentVisibleRange());if(!range)return null;let visibleRanges=[],visibleRangesLen=0;const domReadingContext=new viewLine_1.DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot);let nextLineModelLineNumber=0;includeNewLines&&(nextLineModelLineNumber=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new position_1.Position(range.startLineNumber,1)).lineNumber);const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=range.startLineNumber;lineNumber<=range.endLineNumber;lineNumber++){if(lineNumber<rendStartLineNumber||lineNumber>rendEndLineNumber)continue;const startColumn=lineNumber===range.startLineNumber?range.startColumn:1,endColumn=lineNumber===range.endLineNumber?range.endColumn:this._context.viewModel.getLineMaxColumn(lineNumber),visibleRangesForLine=this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber,startColumn,endColumn,domReadingContext);if(visibleRangesForLine){if(includeNewLines&&lineNumber<originalEndLineNumber){const currentLineModelLineNumber=nextLineModelLineNumber;nextLineModelLineNumber=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new position_1.Position(lineNumber+1,1)).lineNumber,currentLineModelLineNumber!==nextLineModelLineNumber&&(visibleRangesForLine.ranges[visibleRangesForLine.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}visibleRanges[visibleRangesLen++]=new renderingContext_1.LineVisibleRanges(visibleRangesForLine.outsideRenderedLine,lineNumber,renderingContext_1.HorizontalRange.from(visibleRangesForLine.ranges))}}return 0===visibleRangesLen?null:visibleRanges}_visibleRangesForLineRange(lineNumber,startColumn,endColumn){return this.shouldRender()||lineNumber<this._visibleLines.getStartLineNumber()||lineNumber>this._visibleLines.getEndLineNumber()?null:this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber,startColumn,endColumn,new viewLine_1.DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot))}visibleRangeForPosition(position){const visibleRanges=this._visibleRangesForLineRange(position.lineNumber,position.column,position.column);return visibleRanges?new renderingContext_1.HorizontalPosition(visibleRanges.outsideRenderedLine,visibleRanges.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidths(fast){const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();let localMaxLineWidth=1,allWidthsComputed=!0;for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++){const visibleLine=this._visibleLines.getVisibleLine(lineNumber);!fast||visibleLine.getWidthIsFast()?localMaxLineWidth=Math.max(localMaxLineWidth,visibleLine.getWidth()):allWidthsComputed=!1}return allWidthsComputed&&1===rendStartLineNumber&&rendEndLineNumber===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(localMaxLineWidth),allWidthsComputed}_checkMonospaceFontAssumptions(){let longestLineNumber=-1,longestWidth=-1;const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++){const visibleLine=this._visibleLines.getVisibleLine(lineNumber);if(visibleLine.needsMonospaceFontCheck()){const lineWidth=visibleLine.getWidth();lineWidth>longestWidth&&(longestWidth=lineWidth,longestLineNumber=lineNumber)}}if(-1!==longestLineNumber&&!this._visibleLines.getVisibleLine(longestLineNumber).monospaceAssumptionsAreValid())for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++){this._visibleLines.getVisibleLine(lineNumber).onMonospaceAssumptionsInvalidated()}}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(viewportData){if(this._visibleLines.renderLines(viewportData),this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const horizontalRevealRequest=this._horizontalRevealRequest;if(viewportData.startLineNumber<=horizontalRevealRequest.minLineNumber&&horizontalRevealRequest.maxLineNumber<=viewportData.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const newScrollLeft=this._computeScrollLeftToReveal(horizontalRevealRequest);newScrollLeft&&(this._isViewportWrapping||this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:newScrollLeft.scrollLeft},horizontalRevealRequest.scrollType))}}if(this._updateLineWidthsFast()||this._asyncUpdateLineWidths.schedule(),platform.isLinux&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const rendStartLineNumber=this._visibleLines.getStartLineNumber(),rendEndLineNumber=this._visibleLines.getEndLineNumber();for(let lineNumber=rendStartLineNumber;lineNumber<=rendEndLineNumber;lineNumber++){if(this._visibleLines.getVisibleLine(lineNumber).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const adjustedScrollTop=this._context.viewLayout.getCurrentScrollTop()-viewportData.bigNumbersDelta;this._linesContent.setTop(-adjustedScrollTop),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(lineWidth){const iLineWidth=Math.ceil(lineWidth);this._maxLineWidth<iLineWidth&&(this._maxLineWidth=iLineWidth,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(viewport,source,minimalReveal,range,selections,verticalType){const viewportStartY=viewport.top,viewportHeight=viewport.height,viewportEndY=viewportStartY+viewportHeight;let boxIsSingleRange,boxStartY,boxEndY;if(selections&&selections.length>0){let minLineNumber=selections[0].startLineNumber,maxLineNumber=selections[0].endLineNumber;for(let i=1,len=selections.length;i<len;i++){const selection=selections[i];minLineNumber=Math.min(minLineNumber,selection.startLineNumber),maxLineNumber=Math.max(maxLineNumber,selection.endLineNumber)}boxIsSingleRange=!1,boxStartY=this._context.viewLayout.getVerticalOffsetForLineNumber(minLineNumber),boxEndY=this._context.viewLayout.getVerticalOffsetForLineNumber(maxLineNumber)+this._lineHeight}else{if(!range)return-1;boxIsSingleRange=!0,boxStartY=this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber),boxEndY=this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber)+this._lineHeight}if(("mouse"===source||minimalReveal)&&"default"===this._cursorSurroundingLinesStyle)minimalReveal||(boxStartY-=this._lineHeight);else{const context=Math.min(viewportHeight/this._lineHeight/2,this._cursorSurroundingLines);boxStartY-=context*this._lineHeight,boxEndY+=Math.max(0,context-1)*this._lineHeight}let newScrollTop;if(0!==verticalType&&4!==verticalType||(boxEndY+=minimalReveal?this._horizontalScrollbarHeight:this._lineHeight),boxEndY-boxStartY>viewportHeight){if(!boxIsSingleRange)return-1;newScrollTop=boxStartY}else if(5===verticalType||6===verticalType)if(6===verticalType&&viewportStartY<=boxStartY&&boxEndY<=viewportEndY)newScrollTop=viewportStartY;else{const desiredScrollTop=boxStartY-Math.max(5*this._lineHeight,.2*viewportHeight),minScrollTop=boxEndY-viewportHeight;newScrollTop=Math.max(minScrollTop,desiredScrollTop)}else if(1===verticalType||2===verticalType)if(2===verticalType&&viewportStartY<=boxStartY&&boxEndY<=viewportEndY)newScrollTop=viewportStartY;else{const boxMiddleY=(boxStartY+boxEndY)/2;newScrollTop=Math.max(0,boxMiddleY-viewportHeight/2)}else newScrollTop=this._computeMinimumScrolling(viewportStartY,viewportEndY,boxStartY,boxEndY,3===verticalType,4===verticalType);return newScrollTop}_computeScrollLeftToReveal(horizontalRevealRequest){const viewport=this._context.viewLayout.getCurrentViewport(),viewportStartX=viewport.left,viewportEndX=viewportStartX+viewport.width;let boxStartX=1073741824,boxEndX=0;if("range"===horizontalRevealRequest.type){const visibleRanges=this._visibleRangesForLineRange(horizontalRevealRequest.lineNumber,horizontalRevealRequest.startColumn,horizontalRevealRequest.endColumn);if(!visibleRanges)return null;for(const visibleRange of visibleRanges.ranges)boxStartX=Math.min(boxStartX,Math.round(visibleRange.left)),boxEndX=Math.max(boxEndX,Math.round(visibleRange.left+visibleRange.width))}else for(const selection of horizontalRevealRequest.selections){if(selection.startLineNumber!==selection.endLineNumber)return null;const visibleRanges=this._visibleRangesForLineRange(selection.startLineNumber,selection.startColumn,selection.endColumn);if(!visibleRanges)return null;for(const visibleRange of visibleRanges.ranges)boxStartX=Math.min(boxStartX,Math.round(visibleRange.left)),boxEndX=Math.max(boxEndX,Math.round(visibleRange.left+visibleRange.width))}if(horizontalRevealRequest.minimalReveal||(boxStartX=Math.max(0,boxStartX-ViewLines.HORIZONTAL_EXTRA_PX),boxEndX+=this._revealHorizontalRightPadding),"selections"===horizontalRevealRequest.type&&boxEndX-boxStartX>viewport.width)return null;return{scrollLeft:this._computeMinimumScrolling(viewportStartX,viewportEndX,boxStartX,boxEndX),maxHorizontalOffset:boxEndX}}_computeMinimumScrolling(viewportStart,viewportEnd,boxStart,boxEnd,revealAtStart,revealAtEnd){revealAtStart=!!revealAtStart,revealAtEnd=!!revealAtEnd;const viewportLength=(viewportEnd|=0)-(viewportStart|=0);return(boxEnd|=0)-(boxStart|=0)<viewportLength?revealAtStart?boxStart:revealAtEnd?Math.max(0,boxEnd-viewportLength):boxStart<viewportStart?boxStart:boxEnd>viewportEnd?Math.max(0,boxEnd-viewportLength):viewportStart:boxStart}}exports.ViewLines=ViewLines,ViewLines.HORIZONTAL_EXTRA_PX=30})),define(__m[14],__M([1,0,28,4,2,9,36,135]),(function(require,exports,codicons_1,event_1,lifecycle_1,instantiation_1,platform,theme_1){"use strict";var ThemeColor;function themeColorFromId(id){return{id}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Themable=exports.registerThemingParticipant=exports.Extensions=exports.getThemeTypeSelector=exports.ThemeIcon=exports.themeColorFromId=exports.ThemeColor=exports.IThemeService=void 0,exports.IThemeService=(0,instantiation_1.createDecorator)("themeService"),function(ThemeColor){ThemeColor.isThemeColor=function isThemeColor(obj){return obj&&"object"==typeof obj&&"string"==typeof obj.id}}(ThemeColor=exports.ThemeColor||(exports.ThemeColor={})),exports.themeColorFromId=themeColorFromId,function(ThemeIcon){ThemeIcon.isThemeIcon=function isThemeIcon(obj){return obj&&"object"==typeof obj&&"string"==typeof obj.id&&(void 0===obj.color||ThemeColor.isThemeColor(obj.color))};const _regexFromString=new RegExp(`^\\$\\((${codicons_1.CSSIcon.iconNameExpression}(?:${codicons_1.CSSIcon.iconModifierExpression})?)\\)$`);ThemeIcon.fromString=function fromString(str){const match=_regexFromString.exec(str);if(!match)return;let[,name]=match;return{id:name}},ThemeIcon.fromId=function fromId(id){return{id}},ThemeIcon.modify=function modify(icon,modifier){let id=icon.id;const tildeIndex=id.lastIndexOf("~");return-1!==tildeIndex&&(id=id.substring(0,tildeIndex)),modifier&&(id=`${id}~${modifier}`),{id}},ThemeIcon.getModifier=function getModifier(icon){const tildeIndex=icon.id.lastIndexOf("~");if(-1!==tildeIndex)return icon.id.substring(tildeIndex+1)},ThemeIcon.isEqual=function isEqual(ti1,ti2){var _a,_b;return ti1.id===ti2.id&&(null===(_a=ti1.color)||void 0===_a?void 0:_a.id)===(null===(_b=ti2.color)||void 0===_b?void 0:_b.id)},ThemeIcon.asThemeIcon=function asThemeIcon(codicon,color){return{id:codicon.id,color:color?themeColorFromId(color):void 0}},ThemeIcon.asClassNameArray=codicons_1.CSSIcon.asClassNameArray,ThemeIcon.asClassName=codicons_1.CSSIcon.asClassName,ThemeIcon.asCSSSelector=codicons_1.CSSIcon.asCSSSelector}(exports.ThemeIcon||(exports.ThemeIcon={})),exports.getThemeTypeSelector=function getThemeTypeSelector(type){switch(type){case theme_1.ColorScheme.DARK:return"vs-dark";case theme_1.ColorScheme.HIGH_CONTRAST:return"hc-black";default:return"vs"}},exports.Extensions={ThemingContribution:"base.contributions.theming"};let themingRegistry=new class ThemingRegistry{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new event_1.Emitter}onColorThemeChange(participant){return this.themingParticipants.push(participant),this.onThemingParticipantAddedEmitter.fire(participant),(0,lifecycle_1.toDisposable)((()=>{const idx=this.themingParticipants.indexOf(participant);this.themingParticipants.splice(idx,1)}))}getThemingParticipants(){return this.themingParticipants}};platform.Registry.add(exports.Extensions.ThemingContribution,themingRegistry),exports.registerThemingParticipant=function registerThemingParticipant(participant){return themingRegistry.onColorThemeChange(participant)};class Themable extends lifecycle_1.Disposable{constructor(themeService){super(),this.themeService=themeService,this.theme=themeService.getColorTheme(),this._register(this.themeService.onDidColorThemeChange((theme=>this.onThemeChange(theme))))}onThemeChange(theme){this.theme=theme,this.updateStyles()}updateStyles(){}}exports.Themable=Themable})),define(__m[647],__M([1,0,4,2,14]),(function(require,exports,event_1,lifecycle_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalStyleSheet=exports.AbstractCodeEditorService=void 0;let AbstractCodeEditorService=class AbstractCodeEditorService extends lifecycle_1.Disposable{constructor(_themeService){super(),this._themeService=_themeService,this._onCodeEditorAdd=this._register(new event_1.Emitter),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new event_1.Emitter),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onDiffEditorAdd=this._register(new event_1.Emitter),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new event_1.Emitter),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}addCodeEditor(editor){this._codeEditors[editor.getId()]=editor,this._onCodeEditorAdd.fire(editor)}removeCodeEditor(editor){delete this._codeEditors[editor.getId()]&&this._onCodeEditorRemove.fire(editor)}listCodeEditors(){return Object.keys(this._codeEditors).map((id=>this._codeEditors[id]))}addDiffEditor(editor){this._diffEditors[editor.getId()]=editor,this._onDiffEditorAdd.fire(editor)}removeDiffEditor(editor){delete this._diffEditors[editor.getId()]&&this._onDiffEditorRemove.fire(editor)}listDiffEditors(){return Object.keys(this._diffEditors).map((id=>this._diffEditors[id]))}getFocusedCodeEditor(){let editorWithWidgetFocus=null;const editors=this.listCodeEditors();for(const editor of editors){if(editor.hasTextFocus())return editor;editor.hasWidgetFocus()&&(editorWithWidgetFocus=editor)}return editorWithWidgetFocus}removeDecorationType(key){const provider=this._decorationOptionProviders.get(key);provider&&(provider.refCount--,provider.refCount<=0&&(this._decorationOptionProviders.delete(key),provider.dispose(),this.listCodeEditors().forEach((ed=>ed.removeDecorations(key)))))}setModelProperty(resource,key,value){const key1=resource.toString();let dest;this._modelProperties.has(key1)?dest=this._modelProperties.get(key1):(dest=new Map,this._modelProperties.set(key1,dest)),dest.set(key,value)}getModelProperty(resource,key){const key1=resource.toString();if(this._modelProperties.has(key1)){return this._modelProperties.get(key1).get(key)}}};AbstractCodeEditorService=__decorate([__param(0,themeService_1.IThemeService)],AbstractCodeEditorService),exports.AbstractCodeEditorService=AbstractCodeEditorService;exports.GlobalStyleSheet=class GlobalStyleSheet{constructor(styleSheet){this._styleSheet=styleSheet}}})),define(__m[648],__M([1,0,7,31,69,51,14,23]),(function(require,exports,dom,fastDomNode_1,scrollableElement_1,viewPart_1,themeService_1,colorRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorScrollbar=void 0;class EditorScrollbar extends viewPart_1.ViewPart{constructor(context,linesContent,viewDomNode,overflowGuardDomNode){super(context);const options=this._context.configuration.options,scrollbar=options.get(92),mouseWheelScrollSensitivity=options.get(67),fastScrollSensitivity=options.get(34),scrollPredominantAxis=options.get(95),scrollbarOptions={listenOnDomNode:viewDomNode.domNode,className:"editor-scrollable "+(0,themeService_1.getThemeTypeSelector)(context.theme.type),useShadows:!1,lazyRender:!0,vertical:scrollbar.vertical,horizontal:scrollbar.horizontal,verticalHasArrows:scrollbar.verticalHasArrows,horizontalHasArrows:scrollbar.horizontalHasArrows,verticalScrollbarSize:scrollbar.verticalScrollbarSize,verticalSliderSize:scrollbar.verticalSliderSize,horizontalScrollbarSize:scrollbar.horizontalScrollbarSize,horizontalSliderSize:scrollbar.horizontalSliderSize,handleMouseWheel:scrollbar.handleMouseWheel,alwaysConsumeMouseWheel:scrollbar.alwaysConsumeMouseWheel,arrowSize:scrollbar.arrowSize,mouseWheelScrollSensitivity,fastScrollSensitivity,scrollPredominantAxis,scrollByPage:scrollbar.scrollByPage};this.scrollbar=this._register(new scrollableElement_1.SmoothScrollableElement(linesContent.domNode,scrollbarOptions,this._context.viewLayout.getScrollable())),viewPart_1.PartFingerprints.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=(0,fastDomNode_1.createFastDomNode)(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const onBrowserDesperateReveal=(domNode,lookAtScrollTop,lookAtScrollLeft)=>{const newScrollPosition={};if(lookAtScrollTop){const deltaTop=domNode.scrollTop;deltaTop&&(newScrollPosition.scrollTop=this._context.viewLayout.getCurrentScrollTop()+deltaTop,domNode.scrollTop=0)}if(lookAtScrollLeft){const deltaLeft=domNode.scrollLeft;deltaLeft&&(newScrollPosition.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+deltaLeft,domNode.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition,1)};this._register(dom.addDisposableListener(viewDomNode.domNode,"scroll",(e=>onBrowserDesperateReveal(viewDomNode.domNode,!0,!0)))),this._register(dom.addDisposableListener(linesContent.domNode,"scroll",(e=>onBrowserDesperateReveal(linesContent.domNode,!0,!1)))),this._register(dom.addDisposableListener(overflowGuardDomNode.domNode,"scroll",(e=>onBrowserDesperateReveal(overflowGuardDomNode.domNode,!0,!1)))),this._register(dom.addDisposableListener(this.scrollbarDomNode.domNode,"scroll",(e=>onBrowserDesperateReveal(this.scrollbarDomNode.domNode,!0,!1))))}dispose(){super.dispose()}_setLayout(){const options=this._context.configuration.options,layoutInfo=options.get(131);this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);"right"===options.get(65).side?this.scrollbarDomNode.setWidth(layoutInfo.contentWidth+layoutInfo.minimap.minimapWidth):this.scrollbarDomNode.setWidth(layoutInfo.contentWidth),this.scrollbarDomNode.setHeight(layoutInfo.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarMouseDown(browserEvent){this.scrollbar.delegateVerticalScrollbarMouseDown(browserEvent)}onConfigurationChanged(e){if(e.hasChanged(92)||e.hasChanged(67)||e.hasChanged(34)){const options=this._context.configuration.options,scrollbar=options.get(92),mouseWheelScrollSensitivity=options.get(67),fastScrollSensitivity=options.get(34),scrollPredominantAxis=options.get(95),newOpts={vertical:scrollbar.vertical,horizontal:scrollbar.horizontal,verticalScrollbarSize:scrollbar.verticalScrollbarSize,horizontalScrollbarSize:scrollbar.horizontalScrollbarSize,scrollByPage:scrollbar.scrollByPage,handleMouseWheel:scrollbar.handleMouseWheel,mouseWheelScrollSensitivity,fastScrollSensitivity,scrollPredominantAxis};this.scrollbar.updateOptions(newOpts)}return e.hasChanged(131)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+(0,themeService_1.getThemeTypeSelector)(this._context.theme.type)),!0}prepareRender(ctx){}render(ctx){this.scrollbar.renderNow()}}exports.EditorScrollbar=EditorScrollbar,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const scrollbarShadowColor=theme.getColor(colorRegistry_1.scrollbarShadow);scrollbarShadowColor&&collector.addRule(`\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t}\n\t\t`);const scrollbarSliderBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderBackground);scrollbarSliderBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t}\n\t\t`);const scrollbarSliderHoverBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderHoverBackground);scrollbarSliderHoverBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t}\n\t\t`);const scrollbarSliderActiveBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderActiveBackground);scrollbarSliderActiveBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t}\n\t\t`)}))})),define(__m[649],__M([1,0,7,31,98,2,16,8,179,51,32,3,239,255,71,23,14,22,60,404,50,91,362]),(function(require,exports,dom,fastDomNode_1,globalMouseMoveMonitor_1,lifecycle_1,platform,strings,viewLayer_1,viewPart_1,editorOptions_1,range_1,rgba_1,minimapTokensColorTracker_1,viewModel_1,colorRegistry_1,themeService_1,selection_1,touch_1,minimapCharRendererFactory_1,model_1,functional_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Minimap=void 0;class MinimapOptions{constructor(configuration,theme,tokensColorTracker){const options=configuration.options,pixelRatio=options.get(129),layoutInfo=options.get(131),minimapLayout=layoutInfo.minimap,fontInfo=options.get(44),minimapOpts=options.get(65);this.renderMinimap=minimapLayout.renderMinimap,this.size=minimapOpts.size,this.minimapHeightIsEditorHeight=minimapLayout.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=options.get(94),this.showSlider=minimapOpts.showSlider,this.pixelRatio=pixelRatio,this.typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,this.lineHeight=options.get(59),this.minimapLeft=minimapLayout.minimapLeft,this.minimapWidth=minimapLayout.minimapWidth,this.minimapHeight=layoutInfo.height,this.canvasInnerWidth=minimapLayout.minimapCanvasInnerWidth,this.canvasInnerHeight=minimapLayout.minimapCanvasInnerHeight,this.canvasOuterWidth=minimapLayout.minimapCanvasOuterWidth,this.canvasOuterHeight=minimapLayout.minimapCanvasOuterHeight,this.isSampling=minimapLayout.minimapIsSampling,this.editorHeight=layoutInfo.height,this.fontScale=minimapLayout.minimapScale,this.minimapLineHeight=minimapLayout.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=(0,functional_1.once)((()=>minimapCharRendererFactory_1.MinimapCharRendererFactory.create(this.fontScale,fontInfo.fontFamily))),this.defaultBackgroundColor=tokensColorTracker.getColor(2),this.backgroundColor=MinimapOptions._getMinimapBackground(theme,this.defaultBackgroundColor),this.foregroundAlpha=MinimapOptions._getMinimapForegroundOpacity(theme)}static _getMinimapBackground(theme,defaultBackgroundColor){const themeColor=theme.getColor(colorRegistry_1.minimapBackground);return themeColor?new rgba_1.RGBA8(themeColor.rgba.r,themeColor.rgba.g,themeColor.rgba.b,Math.round(255*themeColor.rgba.a)):defaultBackgroundColor}static _getMinimapForegroundOpacity(theme){const themeColor=theme.getColor(colorRegistry_1.minimapForegroundOpacity);return themeColor?rgba_1.RGBA8._clamp(Math.round(255*themeColor.rgba.a)):255}equals(other){return this.renderMinimap===other.renderMinimap&&this.size===other.size&&this.minimapHeightIsEditorHeight===other.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===other.scrollBeyondLastLine&&this.showSlider===other.showSlider&&this.pixelRatio===other.pixelRatio&&this.typicalHalfwidthCharacterWidth===other.typicalHalfwidthCharacterWidth&&this.lineHeight===other.lineHeight&&this.minimapLeft===other.minimapLeft&&this.minimapWidth===other.minimapWidth&&this.minimapHeight===other.minimapHeight&&this.canvasInnerWidth===other.canvasInnerWidth&&this.canvasInnerHeight===other.canvasInnerHeight&&this.canvasOuterWidth===other.canvasOuterWidth&&this.canvasOuterHeight===other.canvasOuterHeight&&this.isSampling===other.isSampling&&this.editorHeight===other.editorHeight&&this.fontScale===other.fontScale&&this.minimapLineHeight===other.minimapLineHeight&&this.minimapCharWidth===other.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(other.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(other.backgroundColor)&&this.foregroundAlpha===other.foregroundAlpha}}class MinimapLayout{constructor(scrollTop,scrollHeight,sliderNeeded,computedSliderRatio,sliderTop,sliderHeight,startLineNumber,endLineNumber){this.scrollTop=scrollTop,this.scrollHeight=scrollHeight,this.sliderNeeded=sliderNeeded,this._computedSliderRatio=computedSliderRatio,this.sliderTop=sliderTop,this.sliderHeight=sliderHeight,this.startLineNumber=startLineNumber,this.endLineNumber=endLineNumber}getDesiredScrollTopFromDelta(delta){return Math.round(this.scrollTop+delta/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(pageY){return Math.round((pageY-this.sliderHeight/2)/this._computedSliderRatio)}static create(options,viewportStartLineNumber,viewportEndLineNumber,viewportStartLineNumberVerticalOffset,viewportHeight,viewportContainsWhitespaceGaps,lineCount,realLineCount,scrollTop,scrollHeight,previousLayout){const pixelRatio=options.pixelRatio,minimapLineHeight=options.minimapLineHeight,minimapLinesFitting=Math.floor(options.canvasInnerHeight/minimapLineHeight),lineHeight=options.lineHeight;if(options.minimapHeightIsEditorHeight){const logicalScrollHeight=realLineCount*options.lineHeight+(options.scrollBeyondLastLine?viewportHeight-options.lineHeight:0),sliderHeight=Math.max(1,Math.floor(viewportHeight*viewportHeight/logicalScrollHeight)),maxMinimapSliderTop=Math.max(0,options.minimapHeight-sliderHeight),computedSliderRatio=maxMinimapSliderTop/(scrollHeight-viewportHeight),sliderTop=scrollTop*computedSliderRatio,sliderNeeded=maxMinimapSliderTop>0,maxLinesFitting=Math.floor(options.canvasInnerHeight/options.minimapLineHeight);return new MinimapLayout(scrollTop,scrollHeight,sliderNeeded,computedSliderRatio,sliderTop,sliderHeight,1,Math.min(lineCount,maxLinesFitting))}let sliderHeight,maxMinimapSliderTop;if(viewportContainsWhitespaceGaps&&viewportEndLineNumber!==lineCount){const viewportLineCount=viewportEndLineNumber-viewportStartLineNumber+1;sliderHeight=Math.floor(viewportLineCount*minimapLineHeight/pixelRatio)}else{const expectedViewportLineCount=viewportHeight/lineHeight;sliderHeight=Math.floor(expectedViewportLineCount*minimapLineHeight/pixelRatio)}maxMinimapSliderTop=options.scrollBeyondLastLine?(lineCount-1)*minimapLineHeight/pixelRatio:Math.max(0,lineCount*minimapLineHeight/pixelRatio-sliderHeight),maxMinimapSliderTop=Math.min(options.minimapHeight-sliderHeight,maxMinimapSliderTop);const computedSliderRatio=maxMinimapSliderTop/(scrollHeight-viewportHeight),sliderTop=scrollTop*computedSliderRatio;let extraLinesAtTheBottom=0;if(options.scrollBeyondLastLine){extraLinesAtTheBottom=viewportHeight/lineHeight-1}if(minimapLinesFitting>=lineCount+extraLinesAtTheBottom){return new MinimapLayout(scrollTop,scrollHeight,maxMinimapSliderTop>0,computedSliderRatio,sliderTop,sliderHeight,1,lineCount)}{let startLineNumber=Math.max(1,Math.floor(viewportStartLineNumber-sliderTop*pixelRatio/minimapLineHeight));previousLayout&&previousLayout.scrollHeight===scrollHeight&&(previousLayout.scrollTop>scrollTop&&(startLineNumber=Math.min(startLineNumber,previousLayout.startLineNumber)),previousLayout.scrollTop<scrollTop&&(startLineNumber=Math.max(startLineNumber,previousLayout.startLineNumber)));const endLineNumber=Math.min(lineCount,startLineNumber+minimapLinesFitting-1);return new MinimapLayout(scrollTop,scrollHeight,!0,computedSliderRatio,(viewportStartLineNumber-startLineNumber+(scrollTop-viewportStartLineNumberVerticalOffset)/lineHeight)*minimapLineHeight/pixelRatio,sliderHeight,startLineNumber,endLineNumber)}}}class MinimapLine{constructor(dy){this.dy=dy}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}MinimapLine.INVALID=new MinimapLine(-1);class RenderData{constructor(renderedLayout,imageData,lines){this.renderedLayout=renderedLayout,this._imageData=imageData,this._renderedLines=new viewLayer_1.RenderedLinesCollection((()=>MinimapLine.INVALID)),this._renderedLines._set(renderedLayout.startLineNumber,lines)}linesEquals(layout){if(!this.scrollEquals(layout))return!1;const lines=this._renderedLines._get().lines;for(let i=0,len=lines.length;i<len;i++)if(-1===lines[i].dy)return!1;return!0}scrollEquals(layout){return this.renderedLayout.startLineNumber===layout.startLineNumber&&this.renderedLayout.endLineNumber===layout.endLineNumber}_get(){const tmp=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:tmp.rendLineNumberStart,lines:tmp.lines}}onLinesChanged(changeFromLineNumber,changeToLineNumber){return this._renderedLines.onLinesChanged(changeFromLineNumber,changeToLineNumber)}onLinesDeleted(deleteFromLineNumber,deleteToLineNumber){this._renderedLines.onLinesDeleted(deleteFromLineNumber,deleteToLineNumber)}onLinesInserted(insertFromLineNumber,insertToLineNumber){this._renderedLines.onLinesInserted(insertFromLineNumber,insertToLineNumber)}onTokensChanged(ranges){return this._renderedLines.onTokensChanged(ranges)}}class MinimapBuffers{constructor(ctx,WIDTH,HEIGHT,background){this._backgroundFillData=MinimapBuffers._createBackgroundFillData(WIDTH,HEIGHT,background),this._buffers=[ctx.createImageData(WIDTH,HEIGHT),ctx.createImageData(WIDTH,HEIGHT)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const result=this._buffers[this._lastUsedBuffer];return result.data.set(this._backgroundFillData),result}static _createBackgroundFillData(WIDTH,HEIGHT,background){const backgroundR=background.r,backgroundG=background.g,backgroundB=background.b,backgroundA=background.a,result=new Uint8ClampedArray(WIDTH*HEIGHT*4);let offset=0;for(let i=0;i<HEIGHT;i++)for(let j=0;j<WIDTH;j++)result[offset]=backgroundR,result[offset+1]=backgroundG,result[offset+2]=backgroundB,result[offset+3]=backgroundA,offset+=4;return result}}class MinimapSamplingState{constructor(samplingRatio,minimapLines){this.samplingRatio=samplingRatio,this.minimapLines=minimapLines}static compute(options,viewLineCount,oldSamplingState){if(0===options.renderMinimap||!options.isSampling)return[null,[]];const pixelRatio=options.pixelRatio,lineHeight=options.lineHeight,scrollBeyondLastLine=options.scrollBeyondLastLine,{minimapLineCount}=editorOptions_1.EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount,scrollBeyondLastLine,height:options.editorHeight,lineHeight,pixelRatio}),ratio=viewLineCount/minimapLineCount,halfRatio=ratio/2;if(!oldSamplingState||0===oldSamplingState.minimapLines.length){const result=[];if(result[0]=1,minimapLineCount>1){for(let i=0,lastIndex=minimapLineCount-1;i<lastIndex;i++)result[i]=Math.round(i*ratio+halfRatio);result[minimapLineCount-1]=viewLineCount}return[new MinimapSamplingState(ratio,result),[]]}const oldMinimapLines=oldSamplingState.minimapLines,oldLength=oldMinimapLines.length,result=[];let oldIndex=0,oldDeltaLineCount=0,minViewLineNumber=1;let events=[],lastEvent=null;for(let i=0;i<minimapLineCount;i++){const fromViewLineNumber=Math.max(minViewLineNumber,Math.round(i*ratio)),toViewLineNumber=Math.max(fromViewLineNumber,Math.round((i+1)*ratio));for(;oldIndex<oldLength&&oldMinimapLines[oldIndex]<fromViewLineNumber;){if(events.length<10){const oldMinimapLineNumber=oldIndex+1+oldDeltaLineCount;lastEvent&&"deleted"===lastEvent.type&&lastEvent._oldIndex===oldIndex-1?lastEvent.deleteToLineNumber++:(lastEvent={type:"deleted",_oldIndex:oldIndex,deleteFromLineNumber:oldMinimapLineNumber,deleteToLineNumber:oldMinimapLineNumber},events.push(lastEvent)),oldDeltaLineCount--}oldIndex++}let selectedViewLineNumber;if(oldIndex<oldLength&&oldMinimapLines[oldIndex]<=toViewLineNumber)selectedViewLineNumber=oldMinimapLines[oldIndex],oldIndex++;else if(selectedViewLineNumber=0===i?1:i+1===minimapLineCount?viewLineCount:Math.round(i*ratio+halfRatio),events.length<10){const oldMinimapLineNumber=oldIndex+1+oldDeltaLineCount;lastEvent&&"inserted"===lastEvent.type&&lastEvent._i===i-1?lastEvent.insertToLineNumber++:(lastEvent={type:"inserted",_i:i,insertFromLineNumber:oldMinimapLineNumber,insertToLineNumber:oldMinimapLineNumber},events.push(lastEvent)),oldDeltaLineCount++}result[i]=selectedViewLineNumber,minViewLineNumber=selectedViewLineNumber}if(events.length<10)for(;oldIndex<oldLength;){const oldMinimapLineNumber=oldIndex+1+oldDeltaLineCount;lastEvent&&"deleted"===lastEvent.type&&lastEvent._oldIndex===oldIndex-1?lastEvent.deleteToLineNumber++:(lastEvent={type:"deleted",_oldIndex:oldIndex,deleteFromLineNumber:oldMinimapLineNumber,deleteToLineNumber:oldMinimapLineNumber},events.push(lastEvent)),oldDeltaLineCount--,oldIndex++}else events=[{type:"flush"}];return[new MinimapSamplingState(ratio,result),events]}modelLineToMinimapLine(lineNumber){return Math.min(this.minimapLines.length,Math.max(1,Math.round(lineNumber/this.samplingRatio)))}modelLineRangeToMinimapLineRange(fromLineNumber,toLineNumber){let fromLineIndex=this.modelLineToMinimapLine(fromLineNumber)-1;for(;fromLineIndex>0&&this.minimapLines[fromLineIndex-1]>=fromLineNumber;)fromLineIndex--;let toLineIndex=this.modelLineToMinimapLine(toLineNumber)-1;for(;toLineIndex+1<this.minimapLines.length&&this.minimapLines[toLineIndex+1]<=toLineNumber;)toLineIndex++;if(fromLineIndex===toLineIndex){const sampledLineNumber=this.minimapLines[fromLineIndex];if(sampledLineNumber<fromLineNumber||sampledLineNumber>toLineNumber)return null}return[fromLineIndex+1,toLineIndex+1]}decorationLineRangeToMinimapLineRange(startLineNumber,endLineNumber){let minimapLineStart=this.modelLineToMinimapLine(startLineNumber),minimapLineEnd=this.modelLineToMinimapLine(endLineNumber);return startLineNumber!==endLineNumber&&minimapLineEnd===minimapLineStart&&(minimapLineEnd===this.minimapLines.length?minimapLineStart>1&&minimapLineStart--:minimapLineEnd++),[minimapLineStart,minimapLineEnd]}onLinesDeleted(e){const deletedLineCount=e.toLineNumber-e.fromLineNumber+1;let changeStartIndex=this.minimapLines.length,changeEndIndex=0;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]<=e.toLineNumber?(this.minimapLines[i]=Math.max(1,e.fromLineNumber-1),changeStartIndex=Math.min(changeStartIndex,i),changeEndIndex=Math.max(changeEndIndex,i)):this.minimapLines[i]-=deletedLineCount;return[changeStartIndex,changeEndIndex]}onLinesInserted(e){const insertedLineCount=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=insertedLineCount}}class Minimap extends viewPart_1.ViewPart{constructor(context){super(context),this.tokensColorTracker=minimapTokensColorTracker_1.MinimapTokensColorTracker.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);const[samplingState]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=samplingState,this._shouldCheckSampling=!1,this._actual=new InnerMinimap(context.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const opts=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);return!this.options.equals(opts)&&(this.options=opts,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return!!e.affectsMinimap&&this._actual.onDecorationsChanged()}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const minimapLineRange=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.toLineNumber);return!!minimapLineRange&&this._actual.onLinesChanged(minimapLineRange[0],minimapLineRange[1])}return this._actual.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){if(this._samplingState){const[changeStartIndex,changeEndIndex]=this._samplingState.onLinesDeleted(e);return changeStartIndex<=changeEndIndex&&this._actual.onLinesChanged(changeStartIndex+1,changeEndIndex+1),this._shouldCheckSampling=!0,!0}return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const ranges=[];for(const range of e.ranges){const minimapLineRange=this._samplingState.modelLineRangeToMinimapLineRange(range.fromLineNumber,range.toLineNumber);minimapLineRange&&ranges.push({fromLineNumber:minimapLineRange[0],toLineNumber:minimapLineRange[1]})}return!!ranges.length&&this._actual.onTokensChanged(ranges)}return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(ctx){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(ctx){let viewportStartLineNumber=ctx.visibleRange.startLineNumber,viewportEndLineNumber=ctx.visibleRange.endLineNumber;this._samplingState&&(viewportStartLineNumber=this._samplingState.modelLineToMinimapLine(viewportStartLineNumber),viewportEndLineNumber=this._samplingState.modelLineToMinimapLine(viewportEndLineNumber));const minimapCtx={viewportContainsWhitespaceGaps:ctx.viewportData.whitespaceViewportData.length>0,scrollWidth:ctx.scrollWidth,scrollHeight:ctx.scrollHeight,viewportStartLineNumber,viewportEndLineNumber,viewportStartLineNumberVerticalOffset:ctx.getVerticalOffsetForLineNumber(viewportStartLineNumber),scrollTop:ctx.scrollTop,scrollLeft:ctx.scrollLeft,viewportWidth:ctx.viewportWidth,viewportHeight:ctx.viewportHeight};this._actual.render(minimapCtx)}_recreateLineSampling(){this._minimapSelections=null;const wasSampling=Boolean(this._samplingState),[samplingState,events]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=samplingState,wasSampling&&this._samplingState)for(const event of events)switch(event.type){case"deleted":this._actual.onLinesDeleted(event.deleteFromLineNumber,event.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(event.insertFromLineNumber,event.insertToLineNumber);break;case"flush":this._actual.onFlushed()}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(lineNumber){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[lineNumber-1]):this._context.viewModel.getLineContent(lineNumber)}getLineMaxColumn(lineNumber){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[lineNumber-1]):this._context.viewModel.getLineMaxColumn(lineNumber)}getMinimapLinesRenderingData(startLineNumber,endLineNumber,needed){if(this._samplingState){const result=[];for(let lineIndex=0,lineCount=endLineNumber-startLineNumber+1;lineIndex<lineCount;lineIndex++)needed[lineIndex]?result[lineIndex]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[startLineNumber+lineIndex-1]):result[lineIndex]=null;return result}return this._context.viewModel.getMinimapLinesRenderingData(startLineNumber,endLineNumber,needed).data}getSelections(){if(null===this._minimapSelections)if(this._samplingState){this._minimapSelections=[];for(const selection of this._selections){const[minimapLineStart,minimapLineEnd]=this._samplingState.decorationLineRangeToMinimapLineRange(selection.startLineNumber,selection.endLineNumber);this._minimapSelections.push(new selection_1.Selection(minimapLineStart,selection.startColumn,minimapLineEnd,selection.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(startLineNumber,endLineNumber){let visibleRange;if(this._samplingState){const modelStartLineNumber=this._samplingState.minimapLines[startLineNumber-1],modelEndLineNumber=this._samplingState.minimapLines[endLineNumber-1];visibleRange=new range_1.Range(modelStartLineNumber,1,modelEndLineNumber,this._context.viewModel.getLineMaxColumn(modelEndLineNumber))}else visibleRange=new range_1.Range(startLineNumber,1,endLineNumber,this._context.viewModel.getLineMaxColumn(endLineNumber));const decorations=this._context.viewModel.getDecorationsInViewport(visibleRange);if(this._samplingState){const result=[];for(const decoration of decorations){if(!decoration.options.minimap)continue;const range=decoration.range,minimapStartLineNumber=this._samplingState.modelLineToMinimapLine(range.startLineNumber),minimapEndLineNumber=this._samplingState.modelLineToMinimapLine(range.endLineNumber);result.push(new viewModel_1.ViewModelDecoration(new range_1.Range(minimapStartLineNumber,range.startColumn,minimapEndLineNumber,range.endColumn),decoration.options))}return result}return decorations}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(lineNumber){this._samplingState&&(lineNumber=this._samplingState.minimapLines[lineNumber-1]),this._context.viewModel.revealRange("mouse",!1,new range_1.Range(lineNumber,1,lineNumber,1),1,0)}setScrollTop(scrollTop){this._context.viewModel.viewLayout.setScrollPosition({scrollTop},1)}}exports.Minimap=Minimap;class InnerMinimap extends lifecycle_1.Disposable{constructor(theme,model){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=theme,this._model=model,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(colorRegistry_1.minimapSelection),this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),viewPart_1.PartFingerprints.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=(0,fastDomNode_1.createFastDomNode)(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=(0,fastDomNode_1.createFastDomNode)(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._mouseDownListener=dom.addStandardDisposableListener(this._domNode.domNode,"mousedown",(e=>{e.preventDefault();if(0===this._model.options.renderMinimap)return;if(!this._lastRenderData)return;if("proportional"!==this._model.options.size){if(e.leftButton&&this._lastRenderData){const position=dom.getDomNodePagePosition(this._slider.domNode),initialPosY=position.top+position.height/2;this._startSliderDragging(e.buttons,e.posx,initialPosY,e.posy,this._lastRenderData.renderedLayout)}return}const minimapLineHeight=this._model.options.minimapLineHeight,internalOffsetY=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*e.browserEvent.offsetY;let lineNumber=Math.floor(internalOffsetY/minimapLineHeight)+this._lastRenderData.renderedLayout.startLineNumber;lineNumber=Math.min(lineNumber,this._model.getLineCount()),this._model.revealLineNumber(lineNumber)})),this._sliderMouseMoveMonitor=new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor,this._sliderMouseDownListener=dom.addStandardDisposableListener(this._slider.domNode,"mousedown",(e=>{e.preventDefault(),e.stopPropagation(),e.leftButton&&this._lastRenderData&&this._startSliderDragging(e.buttons,e.posx,e.posy,e.posy,this._lastRenderData.renderedLayout)})),this._gestureDisposable=touch_1.Gesture.addTarget(this._domNode.domNode),this._sliderTouchStartListener=dom.addDisposableListener(this._domNode.domNode,touch_1.EventType.Start,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(e))}),{passive:!1}),this._sliderTouchMoveListener=dom.addDisposableListener(this._domNode.domNode,touch_1.EventType.Change,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(e)}),{passive:!1}),this._sliderTouchEndListener=dom.addStandardDisposableListener(this._domNode.domNode,touch_1.EventType.End,(e=>{e.preventDefault(),e.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)}))}_startSliderDragging(initialButtons,initialPosX,initialPosY,posy,initialSliderState){this._slider.toggleClassName("active",!0);const handleMouseMove=(posy,posx)=>{const mouseOrthogonalDelta=Math.abs(posx-initialPosX);if(platform.isWindows&&mouseOrthogonalDelta>140)return void this._model.setScrollTop(initialSliderState.scrollTop);const mouseDelta=posy-initialPosY;this._model.setScrollTop(initialSliderState.getDesiredScrollTopFromDelta(mouseDelta))};posy!==initialPosY&&handleMouseMove(posy,initialPosX),this._sliderMouseMoveMonitor.startMonitoring(this._slider.domNode,initialButtons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(mouseMoveData=>handleMouseMove(mouseMoveData.posy,mouseMoveData.posx)),(()=>{this._slider.toggleClassName("active",!1)}))}scrollDueToTouchEvent(touch){const startY=this._domNode.domNode.getBoundingClientRect().top,scrollTop=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(touch.pageY-startY);this._model.setScrollTop(scrollTop)}dispose(){this._mouseDownListener.dispose(),this._sliderMouseMoveMonitor.dispose(),this._sliderMouseDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){return"always"===this._model.options.showSlider?"minimap slider-always":"minimap slider-mouseover"}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new MinimapBuffers(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(changeFromLineNumber,changeToLineNumber){return!!this._lastRenderData&&this._lastRenderData.onLinesChanged(changeFromLineNumber,changeToLineNumber)}onLinesDeleted(deleteFromLineNumber,deleteToLineNumber){return this._lastRenderData&&this._lastRenderData.onLinesDeleted(deleteFromLineNumber,deleteToLineNumber),!0}onLinesInserted(insertFromLineNumber,insertToLineNumber){return this._lastRenderData&&this._lastRenderData.onLinesInserted(insertFromLineNumber,insertToLineNumber),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(colorRegistry_1.minimapSelection),this._renderDecorations=!0,!0}onTokensChanged(ranges){return!!this._lastRenderData&&this._lastRenderData.onTokensChanged(ranges)}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(renderingCtx){if(0===this._model.options.renderMinimap)return this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),void this._sliderHorizontal.setHeight(0);renderingCtx.scrollLeft+renderingCtx.viewportWidth>=renderingCtx.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const layout=MinimapLayout.create(this._model.options,renderingCtx.viewportStartLineNumber,renderingCtx.viewportEndLineNumber,renderingCtx.viewportStartLineNumberVerticalOffset,renderingCtx.viewportHeight,renderingCtx.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),renderingCtx.scrollTop,renderingCtx.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(layout.sliderNeeded?"block":"none"),this._slider.setTop(layout.sliderTop),this._slider.setHeight(layout.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(layout.sliderHeight),this.renderDecorations(layout),this._lastRenderData=this.renderLines(layout)}renderDecorations(layout){if(this._renderDecorations){this._renderDecorations=!1;const selections=this._model.getSelections();selections.sort(range_1.Range.compareRangesUsingStarts);const decorations=this._model.getMinimapDecorationsInViewport(layout.startLineNumber,layout.endLineNumber);decorations.sort(((a,b)=>(a.options.zIndex||0)-(b.options.zIndex||0)));const{canvasInnerWidth,canvasInnerHeight}=this._model.options,lineHeight=this._model.options.minimapLineHeight,characterWidth=this._model.options.minimapCharWidth,tabSize=this._model.getOptions().tabSize,canvasContext=this._decorationsCanvas.domNode.getContext("2d");canvasContext.clearRect(0,0,canvasInnerWidth,canvasInnerHeight);const highlightedLines=new ContiguousLineMap(layout.startLineNumber,layout.endLineNumber,!1);this._renderSelectionLineHighlights(canvasContext,selections,highlightedLines,layout,lineHeight),this._renderDecorationsLineHighlights(canvasContext,decorations,highlightedLines,layout,lineHeight);const lineOffsetMap=new ContiguousLineMap(layout.startLineNumber,layout.endLineNumber,null);this._renderSelectionsHighlights(canvasContext,selections,lineOffsetMap,layout,lineHeight,tabSize,characterWidth,canvasInnerWidth),this._renderDecorationsHighlights(canvasContext,decorations,lineOffsetMap,layout,lineHeight,tabSize,characterWidth,canvasInnerWidth)}}_renderSelectionLineHighlights(canvasContext,selections,highlightedLines,layout,lineHeight){if(!this._selectionColor||this._selectionColor.isTransparent())return;canvasContext.fillStyle=this._selectionColor.transparent(.5).toString();let y1=0,y2=0;for(const selection of selections){const startLineNumber=Math.max(layout.startLineNumber,selection.startLineNumber),endLineNumber=Math.min(layout.endLineNumber,selection.endLineNumber);if(startLineNumber>endLineNumber)continue;for(let line=startLineNumber;line<=endLineNumber;line++)highlightedLines.set(line,!0);const yy1=(startLineNumber-layout.startLineNumber)*lineHeight,yy2=(endLineNumber-layout.startLineNumber)*lineHeight+lineHeight;y2>=yy1||(y2>y1&&canvasContext.fillRect(editorOptions_1.MINIMAP_GUTTER_WIDTH,y1,canvasContext.canvas.width,y2-y1),y1=yy1),y2=yy2}y2>y1&&canvasContext.fillRect(editorOptions_1.MINIMAP_GUTTER_WIDTH,y1,canvasContext.canvas.width,y2-y1)}_renderDecorationsLineHighlights(canvasContext,decorations,highlightedLines,layout,lineHeight){const highlightColors=new Map;for(let i=decorations.length-1;i>=0;i--){const decoration=decorations[i],minimapOptions=decoration.options.minimap;if(!minimapOptions||minimapOptions.position!==model_1.MinimapPosition.Inline)continue;const startLineNumber=Math.max(layout.startLineNumber,decoration.range.startLineNumber),endLineNumber=Math.min(layout.endLineNumber,decoration.range.endLineNumber);if(startLineNumber>endLineNumber)continue;const decorationColor=minimapOptions.getColor(this._theme.value);if(!decorationColor||decorationColor.isTransparent())continue;let highlightColor=highlightColors.get(decorationColor.toString());highlightColor||(highlightColor=decorationColor.transparent(.5).toString(),highlightColors.set(decorationColor.toString(),highlightColor)),canvasContext.fillStyle=highlightColor;for(let line=startLineNumber;line<=endLineNumber;line++){if(highlightedLines.has(line))continue;highlightedLines.set(line,!0);const y=(startLineNumber-layout.startLineNumber)*lineHeight;canvasContext.fillRect(editorOptions_1.MINIMAP_GUTTER_WIDTH,y,canvasContext.canvas.width,lineHeight)}}}_renderSelectionsHighlights(canvasContext,selections,lineOffsetMap,layout,lineHeight,tabSize,characterWidth,canvasInnerWidth){if(this._selectionColor&&!this._selectionColor.isTransparent())for(const selection of selections){const startLineNumber=Math.max(layout.startLineNumber,selection.startLineNumber),endLineNumber=Math.min(layout.endLineNumber,selection.endLineNumber);if(!(startLineNumber>endLineNumber))for(let line=startLineNumber;line<=endLineNumber;line++)this.renderDecorationOnLine(canvasContext,lineOffsetMap,selection,this._selectionColor,layout,line,lineHeight,lineHeight,tabSize,characterWidth,canvasInnerWidth)}}_renderDecorationsHighlights(canvasContext,decorations,lineOffsetMap,layout,lineHeight,tabSize,characterWidth,canvasInnerWidth){for(const decoration of decorations){const minimapOptions=decoration.options.minimap;if(!minimapOptions)continue;const startLineNumber=Math.max(layout.startLineNumber,decoration.range.startLineNumber),endLineNumber=Math.min(layout.endLineNumber,decoration.range.endLineNumber);if(startLineNumber>endLineNumber)continue;const decorationColor=minimapOptions.getColor(this._theme.value);if(decorationColor&&!decorationColor.isTransparent())for(let line=startLineNumber;line<=endLineNumber;line++)switch(minimapOptions.position){case model_1.MinimapPosition.Inline:this.renderDecorationOnLine(canvasContext,lineOffsetMap,decoration.range,decorationColor,layout,line,lineHeight,lineHeight,tabSize,characterWidth,canvasInnerWidth);continue;case model_1.MinimapPosition.Gutter:{const y=(line-layout.startLineNumber)*lineHeight,x=2;this.renderDecoration(canvasContext,decorationColor,x,y,2,lineHeight);continue}}}}renderDecorationOnLine(canvasContext,lineOffsetMap,decorationRange,decorationColor,layout,lineNumber,height,lineHeight,tabSize,charWidth,canvasInnerWidth){const y=(lineNumber-layout.startLineNumber)*lineHeight;if(y+height<0||y>this._model.options.canvasInnerHeight)return;const{startLineNumber,endLineNumber}=decorationRange,startColumn=startLineNumber===lineNumber?decorationRange.startColumn:1,endColumn=endLineNumber===lineNumber?decorationRange.endColumn:this._model.getLineMaxColumn(lineNumber),x1=this.getXOffsetForPosition(lineOffsetMap,lineNumber,startColumn,tabSize,charWidth,canvasInnerWidth),x2=this.getXOffsetForPosition(lineOffsetMap,lineNumber,endColumn,tabSize,charWidth,canvasInnerWidth);this.renderDecoration(canvasContext,decorationColor,x1,y,x2-x1,height)}getXOffsetForPosition(lineOffsetMap,lineNumber,column,tabSize,charWidth,canvasInnerWidth){if(1===column)return editorOptions_1.MINIMAP_GUTTER_WIDTH;if((column-1)*charWidth>=canvasInnerWidth)return canvasInnerWidth;let lineIndexToXOffset=lineOffsetMap.get(lineNumber);if(!lineIndexToXOffset){const lineData=this._model.getLineContent(lineNumber);lineIndexToXOffset=[editorOptions_1.MINIMAP_GUTTER_WIDTH];let prevx=editorOptions_1.MINIMAP_GUTTER_WIDTH;for(let i=1;i<lineData.length+1;i++){const charCode=lineData.charCodeAt(i-1),x=prevx+(9===charCode?tabSize*charWidth:strings.isFullWidthCharacter(charCode)?2*charWidth:charWidth);if(x>=canvasInnerWidth){lineIndexToXOffset[i]=canvasInnerWidth;break}lineIndexToXOffset[i]=x,prevx=x}lineOffsetMap.set(lineNumber,lineIndexToXOffset)}return column-1<lineIndexToXOffset.length?lineIndexToXOffset[column-1]:canvasInnerWidth}renderDecoration(canvasContext,decorationColor,x,y,width,height){canvasContext.fillStyle=decorationColor&&decorationColor.toString()||"",canvasContext.fillRect(x,y,width,height)}renderLines(layout){const startLineNumber=layout.startLineNumber,endLineNumber=layout.endLineNumber,minimapLineHeight=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(layout)){const _lastData=this._lastRenderData._get();return new RenderData(layout,_lastData.imageData,_lastData.lines)}const imageData=this._getBuffer();if(!imageData)return null;const[_dirtyY1,_dirtyY2,needed]=InnerMinimap._renderUntouchedLines(imageData,startLineNumber,endLineNumber,minimapLineHeight,this._lastRenderData),lineInfo=this._model.getMinimapLinesRenderingData(startLineNumber,endLineNumber,needed),tabSize=this._model.getOptions().tabSize,defaultBackground=this._model.options.defaultBackgroundColor,background=this._model.options.backgroundColor,foregroundAlpha=this._model.options.foregroundAlpha,tokensColorTracker=this._model.tokensColorTracker,useLighterFont=tokensColorTracker.backgroundIsLight(),renderMinimap=this._model.options.renderMinimap,charRenderer=this._model.options.charRenderer(),fontScale=this._model.options.fontScale,minimapCharWidth=this._model.options.minimapCharWidth,renderMinimapLineHeight=(1===renderMinimap?2:3)*fontScale,innerLinePadding=minimapLineHeight>renderMinimapLineHeight?Math.floor((minimapLineHeight-renderMinimapLineHeight)/2):0,backgroundA=background.a/255,renderBackground=new rgba_1.RGBA8(Math.round((background.r-defaultBackground.r)*backgroundA+defaultBackground.r),Math.round((background.g-defaultBackground.g)*backgroundA+defaultBackground.g),Math.round((background.b-defaultBackground.b)*backgroundA+defaultBackground.b),255);let dy=0;const renderedLines=[];for(let lineIndex=0,lineCount=endLineNumber-startLineNumber+1;lineIndex<lineCount;lineIndex++)needed[lineIndex]&&InnerMinimap._renderLine(imageData,renderBackground,background.a,useLighterFont,renderMinimap,minimapCharWidth,tokensColorTracker,foregroundAlpha,charRenderer,dy,innerLinePadding,tabSize,lineInfo[lineIndex],fontScale,minimapLineHeight),renderedLines[lineIndex]=new MinimapLine(dy),dy+=minimapLineHeight;const dirtyY1=-1===_dirtyY1?0:_dirtyY1,dirtyHeight=(-1===_dirtyY2?imageData.height:_dirtyY2)-dirtyY1;return this._canvas.domNode.getContext("2d").putImageData(imageData,0,0,0,dirtyY1,imageData.width,dirtyHeight),new RenderData(layout,imageData,renderedLines)}static _renderUntouchedLines(target,startLineNumber,endLineNumber,minimapLineHeight,lastRenderData){const needed=[];if(!lastRenderData){for(let i=0,len=endLineNumber-startLineNumber+1;i<len;i++)needed[i]=!0;return[-1,-1,needed]}const _lastData=lastRenderData._get(),lastTargetData=_lastData.imageData.data,lastStartLineNumber=_lastData.rendLineNumberStart,lastLines=_lastData.lines,lastLinesLength=lastLines.length,WIDTH=target.width,targetData=target.data,maxDestPixel=(endLineNumber-startLineNumber+1)*minimapLineHeight*WIDTH*4;let dirtyPixel1=-1,dirtyPixel2=-1,copySourceStart=-1,copySourceEnd=-1,copyDestStart=-1,copyDestEnd=-1,dest_dy=0;for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const lineIndex=lineNumber-startLineNumber,lastLineIndex=lineNumber-lastStartLineNumber,source_dy=lastLineIndex>=0&&lastLineIndex<lastLinesLength?lastLines[lastLineIndex].dy:-1;if(-1===source_dy){needed[lineIndex]=!0,dest_dy+=minimapLineHeight;continue}const sourceStart=source_dy*WIDTH*4,sourceEnd=(source_dy+minimapLineHeight)*WIDTH*4,destStart=dest_dy*WIDTH*4,destEnd=(dest_dy+minimapLineHeight)*WIDTH*4;copySourceEnd===sourceStart&&copyDestEnd===destStart?(copySourceEnd=sourceEnd,copyDestEnd=destEnd):(-1!==copySourceStart&&(targetData.set(lastTargetData.subarray(copySourceStart,copySourceEnd),copyDestStart),-1===dirtyPixel1&&0===copySourceStart&&copySourceStart===copyDestStart&&(dirtyPixel1=copySourceEnd),-1===dirtyPixel2&&copySourceEnd===maxDestPixel&&copySourceStart===copyDestStart&&(dirtyPixel2=copySourceStart)),copySourceStart=sourceStart,copySourceEnd=sourceEnd,copyDestStart=destStart,copyDestEnd=destEnd),needed[lineIndex]=!1,dest_dy+=minimapLineHeight}-1!==copySourceStart&&(targetData.set(lastTargetData.subarray(copySourceStart,copySourceEnd),copyDestStart),-1===dirtyPixel1&&0===copySourceStart&&copySourceStart===copyDestStart&&(dirtyPixel1=copySourceEnd),-1===dirtyPixel2&&copySourceEnd===maxDestPixel&&copySourceStart===copyDestStart&&(dirtyPixel2=copySourceStart));return[-1===dirtyPixel1?-1:dirtyPixel1/(4*WIDTH),-1===dirtyPixel2?-1:dirtyPixel2/(4*WIDTH),needed]}static _renderLine(target,backgroundColor,backgroundAlpha,useLighterFont,renderMinimap,charWidth,colorTracker,foregroundAlpha,minimapCharRenderer,dy,innerLinePadding,tabSize,lineData,fontScale,minimapLineHeight){const content=lineData.content,tokens=lineData.tokens,maxDx=target.width-charWidth,force1pxHeight=1===minimapLineHeight;let dx=editorOptions_1.MINIMAP_GUTTER_WIDTH,charIndex=0,tabsCharDelta=0;for(let tokenIndex=0,tokensLen=tokens.getCount();tokenIndex<tokensLen;tokenIndex++){const tokenEndIndex=tokens.getEndOffset(tokenIndex),tokenColorId=tokens.getForeground(tokenIndex),tokenColor=colorTracker.getColor(tokenColorId);for(;charIndex<tokenEndIndex;charIndex++){if(dx>maxDx)return;const charCode=content.charCodeAt(charIndex);if(9===charCode){const insertSpacesCount=tabSize-(charIndex+tabsCharDelta)%tabSize;tabsCharDelta+=insertSpacesCount-1,dx+=insertSpacesCount*charWidth}else if(32===charCode)dx+=charWidth;else{const count=strings.isFullWidthCharacter(charCode)?2:1;for(let i=0;i<count;i++)if(2===renderMinimap?minimapCharRenderer.blockRenderChar(target,dx,dy+innerLinePadding,tokenColor,foregroundAlpha,backgroundColor,backgroundAlpha,force1pxHeight):minimapCharRenderer.renderChar(target,dx,dy+innerLinePadding,charCode,tokenColor,foregroundAlpha,backgroundColor,backgroundAlpha,fontScale,useLighterFont,force1pxHeight),dx+=charWidth,dx>maxDx)return}}}}}class ContiguousLineMap{constructor(startLineNumber,endLineNumber,defaultValue){this._startLineNumber=startLineNumber,this._endLineNumber=endLineNumber,this._defaultValue=defaultValue,this._values=[];for(let i=0,count=this._endLineNumber-this._startLineNumber+1;i<count;i++)this._values[i]=defaultValue}has(lineNumber){return this.get(lineNumber)!==this._defaultValue}set(lineNumber,value){lineNumber<this._startLineNumber||lineNumber>this._endLineNumber||(this._values[lineNumber-this._startLineNumber]=value)}get(lineNumber){return lineNumber<this._startLineNumber||lineNumber>this._endLineNumber?this._defaultValue:this._values[lineNumber-this._startLineNumber]}}(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const sliderBackground=theme.getColor(colorRegistry_1.minimapSliderBackground);sliderBackground&&collector.addRule(`.monaco-editor .minimap-slider .minimap-slider-horizontal { background: ${sliderBackground}; }`);const sliderHoverBackground=theme.getColor(colorRegistry_1.minimapSliderHoverBackground);sliderHoverBackground&&collector.addRule(`.monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: ${sliderHoverBackground}; }`);const sliderActiveBackground=theme.getColor(colorRegistry_1.minimapSliderActiveBackground);sliderActiveBackground&&collector.addRule(`.monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: ${sliderActiveBackground}; }`);const shadow=theme.getColor(colorRegistry_1.scrollbarShadow);shadow&&collector.addRule(`.monaco-editor .minimap-shadow-visible { box-shadow: ${shadow} -6px 0 6px -6px inset; }`)}))})),define(__m[650],__M([1,0,31,51,23,14,365]),(function(require,exports,fastDomNode_1,viewPart_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScrollDecorationViewPart=void 0;class ScrollDecorationViewPart extends viewPart_1.ViewPart{constructor(context){super(context),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const scrollbar=this._context.configuration.options.get(92);this._useShadows=scrollbar.useShadows,this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const newShouldShow=this._useShadows&&this._scrollTop>0;return this._shouldShow!==newShouldShow&&(this._shouldShow=newShouldShow,!0)}getDomNode(){return this._domNode}_updateWidth(){const layoutInfo=this._context.configuration.options.get(131);0===layoutInfo.minimap.renderMinimap||layoutInfo.minimap.minimapWidth>0&&0===layoutInfo.minimap.minimapLeft?this._width=layoutInfo.width:this._width=layoutInfo.width-layoutInfo.minimap.minimapWidth-layoutInfo.verticalScrollbarWidth}onConfigurationChanged(e){const scrollbar=this._context.configuration.options.get(92);return this._useShadows=scrollbar.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(ctx){}render(ctx){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}exports.ScrollDecorationViewPart=ScrollDecorationViewPart,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const shadow=theme.getColor(colorRegistry_1.scrollbarShadow);shadow&&collector.addRule(`.monaco-editor .scroll-decoration { box-shadow: ${shadow} 0 6px 6px -6px inset; }`)}))})),define(__m[651],__M([1,0,102,23,14,366]),(function(require,exports,dynamicViewOverlay_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectionsOverlay=void 0;class HorizontalRangeWithStyle{constructor(other){this.left=other.left,this.width=other.width,this.startStyle=null,this.endStyle=null}}class LineVisibleRangesWithStyle{constructor(lineNumber,ranges){this.lineNumber=lineNumber,this.ranges=ranges}}function toStyledRange(item){return new HorizontalRangeWithStyle(item)}function toStyled(item){return new LineVisibleRangesWithStyle(item.lineNumber,item.ranges.map(toStyledRange))}class SelectionsOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{constructor(context){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=context;const options=this._context.configuration.options;this._lineHeight=options.get(59),this._roundedSelection=options.get(90),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options;return this._lineHeight=options.get(59),this._roundedSelection=options.get(90),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(linesVisibleRanges){for(let i=0,len=linesVisibleRanges.length;i<len;i++){if(linesVisibleRanges[i].ranges.length>1)return!0}return!1}_enrichVisibleRangesWithStyle(viewport,linesVisibleRanges,previousFrame){const epsilon=this._typicalHalfwidthCharacterWidth/4;let previousFrameTop=null,previousFrameBottom=null;if(previousFrame&&previousFrame.length>0&&linesVisibleRanges.length>0){const topLineNumber=linesVisibleRanges[0].lineNumber;if(topLineNumber===viewport.startLineNumber)for(let i=0;!previousFrameTop&&i<previousFrame.length;i++)previousFrame[i].lineNumber===topLineNumber&&(previousFrameTop=previousFrame[i].ranges[0]);const bottomLineNumber=linesVisibleRanges[linesVisibleRanges.length-1].lineNumber;if(bottomLineNumber===viewport.endLineNumber)for(let i=previousFrame.length-1;!previousFrameBottom&&i>=0;i--)previousFrame[i].lineNumber===bottomLineNumber&&(previousFrameBottom=previousFrame[i].ranges[0]);previousFrameTop&&!previousFrameTop.startStyle&&(previousFrameTop=null),previousFrameBottom&&!previousFrameBottom.startStyle&&(previousFrameBottom=null)}for(let i=0,len=linesVisibleRanges.length;i<len;i++){const curLineRange=linesVisibleRanges[i].ranges[0],curLeft=curLineRange.left,curRight=curLineRange.left+curLineRange.width,startStyle={top:0,bottom:0},endStyle={top:0,bottom:0};if(i>0){const prevLeft=linesVisibleRanges[i-1].ranges[0].left,prevRight=linesVisibleRanges[i-1].ranges[0].left+linesVisibleRanges[i-1].ranges[0].width;abs(curLeft-prevLeft)<epsilon?startStyle.top=2:curLeft>prevLeft&&(startStyle.top=1),abs(curRight-prevRight)<epsilon?endStyle.top=2:prevLeft<curRight&&curRight<prevRight&&(endStyle.top=1)}else previousFrameTop&&(startStyle.top=previousFrameTop.startStyle.top,endStyle.top=previousFrameTop.endStyle.top);if(i+1<len){const nextLeft=linesVisibleRanges[i+1].ranges[0].left,nextRight=linesVisibleRanges[i+1].ranges[0].left+linesVisibleRanges[i+1].ranges[0].width;abs(curLeft-nextLeft)<epsilon?startStyle.bottom=2:nextLeft<curLeft&&curLeft<nextRight&&(startStyle.bottom=1),abs(curRight-nextRight)<epsilon?endStyle.bottom=2:curRight<nextRight&&(endStyle.bottom=1)}else previousFrameBottom&&(startStyle.bottom=previousFrameBottom.startStyle.bottom,endStyle.bottom=previousFrameBottom.endStyle.bottom);curLineRange.startStyle=startStyle,curLineRange.endStyle=endStyle}}_getVisibleRangesWithStyle(selection,ctx,previousFrame){const linesVisibleRanges=(ctx.linesVisibleRangesForRange(selection,!0)||[]).map(toStyled);return!this._visibleRangesHaveGaps(linesVisibleRanges)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(ctx.visibleRange,linesVisibleRanges,previousFrame),linesVisibleRanges}_createSelectionPiece(top,height,className,left,width){return'<div class="cslr '+className+'" style="top:'+top.toString()+"px;left:"+left.toString()+"px;width:"+width.toString()+"px;height:"+height+'px;"></div>'}_actualRenderOneSelection(output2,visibleStartLineNumber,hasMultipleSelections,visibleRanges){if(0===visibleRanges.length)return;const visibleRangesHaveStyle=!!visibleRanges[0].ranges[0].startStyle,fullLineHeight=this._lineHeight.toString(),reducedLineHeight=(this._lineHeight-1).toString(),firstLineNumber=visibleRanges[0].lineNumber,lastLineNumber=visibleRanges[visibleRanges.length-1].lineNumber;for(let i=0,len=visibleRanges.length;i<len;i++){const lineVisibleRanges=visibleRanges[i],lineNumber=lineVisibleRanges.lineNumber,lineIndex=lineNumber-visibleStartLineNumber,lineHeight=hasMultipleSelections&&(lineNumber===lastLineNumber||lineNumber===firstLineNumber)?reducedLineHeight:fullLineHeight,top=hasMultipleSelections&&lineNumber===firstLineNumber?1:0;let innerCornerOutput="",restOfSelectionOutput="";for(let j=0,lenJ=lineVisibleRanges.ranges.length;j<lenJ;j++){const visibleRange=lineVisibleRanges.ranges[j];if(visibleRangesHaveStyle){const startStyle=visibleRange.startStyle,endStyle=visibleRange.endStyle;if(1===startStyle.top||1===startStyle.bottom){innerCornerOutput+=this._createSelectionPiece(top,lineHeight,SelectionsOverlay.SELECTION_CLASS_NAME,visibleRange.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let className=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;1===startStyle.top&&(className+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),1===startStyle.bottom&&(className+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT),innerCornerOutput+=this._createSelectionPiece(top,lineHeight,className,visibleRange.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}if(1===endStyle.top||1===endStyle.bottom){innerCornerOutput+=this._createSelectionPiece(top,lineHeight,SelectionsOverlay.SELECTION_CLASS_NAME,visibleRange.left+visibleRange.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let className=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;1===endStyle.top&&(className+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),1===endStyle.bottom&&(className+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),innerCornerOutput+=this._createSelectionPiece(top,lineHeight,className,visibleRange.left+visibleRange.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}}let className=SelectionsOverlay.SELECTION_CLASS_NAME;if(visibleRangesHaveStyle){const startStyle=visibleRange.startStyle,endStyle=visibleRange.endStyle;0===startStyle.top&&(className+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),0===startStyle.bottom&&(className+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),0===endStyle.top&&(className+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),0===endStyle.bottom&&(className+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT)}restOfSelectionOutput+=this._createSelectionPiece(top,lineHeight,className,visibleRange.left,visibleRange.width)}output2[lineIndex][0]+=innerCornerOutput,output2[lineIndex][1]+=restOfSelectionOutput}}prepareRender(ctx){const output=[],visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber;for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){output[lineNumber-visibleStartLineNumber]=["",""]}const thisFrameVisibleRangesWithStyle=[];for(let i=0,len=this._selections.length;i<len;i++){const selection=this._selections[i];if(selection.isEmpty()){thisFrameVisibleRangesWithStyle[i]=null;continue}const visibleRangesWithStyle=this._getVisibleRangesWithStyle(selection,ctx,this._previousFrameVisibleRangesWithStyle[i]);thisFrameVisibleRangesWithStyle[i]=visibleRangesWithStyle,this._actualRenderOneSelection(output,visibleStartLineNumber,this._selections.length>1,visibleRangesWithStyle)}this._previousFrameVisibleRangesWithStyle=thisFrameVisibleRangesWithStyle,this._renderResult=output.map((([internalCorners,restOfSelection])=>internalCorners+restOfSelection))}render(startLineNumber,lineNumber){if(!this._renderResult)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex<0||lineIndex>=this._renderResult.length?"":this._renderResult[lineIndex]}}function abs(n){return n<0?-n:n}exports.SelectionsOverlay=SelectionsOverlay,SelectionsOverlay.SELECTION_CLASS_NAME="selected-text",SelectionsOverlay.SELECTION_TOP_LEFT="top-left-radius",SelectionsOverlay.SELECTION_BOTTOM_LEFT="bottom-left-radius",SelectionsOverlay.SELECTION_TOP_RIGHT="top-right-radius",SelectionsOverlay.SELECTION_BOTTOM_RIGHT="bottom-right-radius",SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",SelectionsOverlay.ROUNDED_PIECE_WIDTH=10,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const editorSelectionColor=theme.getColor(colorRegistry_1.editorSelectionBackground);editorSelectionColor&&collector.addRule(`.monaco-editor .focused .selected-text { background-color: ${editorSelectionColor}; }`);const editorInactiveSelectionColor=theme.getColor(colorRegistry_1.editorInactiveSelection);editorInactiveSelectionColor&&collector.addRule(`.monaco-editor .selected-text { background-color: ${editorInactiveSelectionColor}; }`);const editorSelectionForegroundColor=theme.getColor(colorRegistry_1.editorSelectionForeground);editorSelectionForegroundColor&&!editorSelectionForegroundColor.isTransparent()&&collector.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${editorSelectionForegroundColor}; }`)}))})),define(__m[54],__M([1,0,518,30,23,14]),(function(require,exports,nls,color_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorUnicodeHighlightBorder=exports.editorBracketPairGuideActiveBackground6=exports.editorBracketPairGuideActiveBackground5=exports.editorBracketPairGuideActiveBackground4=exports.editorBracketPairGuideActiveBackground3=exports.editorBracketPairGuideActiveBackground2=exports.editorBracketPairGuideActiveBackground1=exports.editorBracketPairGuideBackground6=exports.editorBracketPairGuideBackground5=exports.editorBracketPairGuideBackground4=exports.editorBracketPairGuideBackground3=exports.editorBracketPairGuideBackground2=exports.editorBracketPairGuideBackground1=exports.editorBracketHighlightingUnexpectedBracketForeground=exports.editorBracketHighlightingForeground6=exports.editorBracketHighlightingForeground5=exports.editorBracketHighlightingForeground4=exports.editorBracketHighlightingForeground3=exports.editorBracketHighlightingForeground2=exports.editorBracketHighlightingForeground1=exports.overviewRulerInfo=exports.overviewRulerWarning=exports.overviewRulerError=exports.overviewRulerRangeHighlight=exports.ghostTextBackground=exports.ghostTextForeground=exports.ghostTextBorder=exports.editorUnnecessaryCodeOpacity=exports.editorUnnecessaryCodeBorder=exports.editorGutter=exports.editorOverviewRulerBackground=exports.editorOverviewRulerBorder=exports.editorBracketMatchBorder=exports.editorBracketMatchBackground=exports.editorCodeLensForeground=exports.editorRuler=exports.editorActiveLineNumber=exports.editorLineNumbers=exports.editorActiveIndentGuides=exports.editorIndentGuides=exports.editorWhitespaces=exports.editorCursorBackground=exports.editorCursorForeground=exports.editorSymbolHighlightBorder=exports.editorSymbolHighlight=exports.editorRangeHighlightBorder=exports.editorRangeHighlight=exports.editorLineHighlightBorder=exports.editorLineHighlight=void 0,exports.editorLineHighlight=(0,colorRegistry_1.registerColor)("editor.lineHighlightBackground",{dark:null,light:null,hc:null},nls.localize(0,null)),exports.editorLineHighlightBorder=(0,colorRegistry_1.registerColor)("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hc:"#f38518"},nls.localize(1,null)),exports.editorRangeHighlight=(0,colorRegistry_1.registerColor)("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hc:null},nls.localize(2,null),!0),exports.editorRangeHighlightBorder=(0,colorRegistry_1.registerColor)("editor.rangeHighlightBorder",{dark:null,light:null,hc:colorRegistry_1.activeContrastBorder},nls.localize(3,null),!0),exports.editorSymbolHighlight=(0,colorRegistry_1.registerColor)("editor.symbolHighlightBackground",{dark:colorRegistry_1.editorFindMatchHighlight,light:colorRegistry_1.editorFindMatchHighlight,hc:null},nls.localize(4,null),!0),exports.editorSymbolHighlightBorder=(0,colorRegistry_1.registerColor)("editor.symbolHighlightBorder",{dark:null,light:null,hc:colorRegistry_1.activeContrastBorder},nls.localize(5,null),!0),exports.editorCursorForeground=(0,colorRegistry_1.registerColor)("editorCursor.foreground",{dark:"#AEAFAD",light:color_1.Color.black,hc:color_1.Color.white},nls.localize(6,null)),exports.editorCursorBackground=(0,colorRegistry_1.registerColor)("editorCursor.background",null,nls.localize(7,null)),exports.editorWhitespaces=(0,colorRegistry_1.registerColor)("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hc:"#e3e4e229"},nls.localize(8,null)),exports.editorIndentGuides=(0,colorRegistry_1.registerColor)("editorIndentGuide.background",{dark:exports.editorWhitespaces,light:exports.editorWhitespaces,hc:exports.editorWhitespaces},nls.localize(9,null)),exports.editorActiveIndentGuides=(0,colorRegistry_1.registerColor)("editorIndentGuide.activeBackground",{dark:exports.editorWhitespaces,light:exports.editorWhitespaces,hc:exports.editorWhitespaces},nls.localize(10,null)),exports.editorLineNumbers=(0,colorRegistry_1.registerColor)("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hc:color_1.Color.white},nls.localize(11,null));const deprecatedEditorActiveLineNumber=(0,colorRegistry_1.registerColor)("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hc:colorRegistry_1.activeContrastBorder},nls.localize(12,null),!1,nls.localize(13,null));exports.editorActiveLineNumber=(0,colorRegistry_1.registerColor)("editorLineNumber.activeForeground",{dark:deprecatedEditorActiveLineNumber,light:deprecatedEditorActiveLineNumber,hc:deprecatedEditorActiveLineNumber},nls.localize(14,null)),exports.editorRuler=(0,colorRegistry_1.registerColor)("editorRuler.foreground",{dark:"#5A5A5A",light:color_1.Color.lightgrey,hc:color_1.Color.white},nls.localize(15,null)),exports.editorCodeLensForeground=(0,colorRegistry_1.registerColor)("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hc:"#999999"},nls.localize(16,null)),exports.editorBracketMatchBackground=(0,colorRegistry_1.registerColor)("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hc:"#0064001a"},nls.localize(17,null)),exports.editorBracketMatchBorder=(0,colorRegistry_1.registerColor)("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hc:colorRegistry_1.contrastBorder},nls.localize(18,null)),exports.editorOverviewRulerBorder=(0,colorRegistry_1.registerColor)("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hc:"#7f7f7f4d"},nls.localize(19,null)),exports.editorOverviewRulerBackground=(0,colorRegistry_1.registerColor)("editorOverviewRuler.background",null,nls.localize(20,null)),exports.editorGutter=(0,colorRegistry_1.registerColor)("editorGutter.background",{dark:colorRegistry_1.editorBackground,light:colorRegistry_1.editorBackground,hc:colorRegistry_1.editorBackground},nls.localize(21,null)),exports.editorUnnecessaryCodeBorder=(0,colorRegistry_1.registerColor)("editorUnnecessaryCode.border",{dark:null,light:null,hc:color_1.Color.fromHex("#fff").transparent(.8)},nls.localize(22,null)),exports.editorUnnecessaryCodeOpacity=(0,colorRegistry_1.registerColor)("editorUnnecessaryCode.opacity",{dark:color_1.Color.fromHex("#000a"),light:color_1.Color.fromHex("#0007"),hc:null},nls.localize(23,null)),exports.ghostTextBorder=(0,colorRegistry_1.registerColor)("editorGhostText.border",{dark:null,light:null,hc:color_1.Color.fromHex("#fff").transparent(.8)},nls.localize(24,null)),exports.ghostTextForeground=(0,colorRegistry_1.registerColor)("editorGhostText.foreground",{dark:color_1.Color.fromHex("#ffffff56"),light:color_1.Color.fromHex("#0007"),hc:null},nls.localize(25,null)),exports.ghostTextBackground=(0,colorRegistry_1.registerColor)("editorGhostText.background",{dark:null,light:null,hc:null},nls.localize(26,null));const rulerRangeDefault=new color_1.Color(new color_1.RGBA(0,122,204,.6));exports.overviewRulerRangeHighlight=(0,colorRegistry_1.registerColor)("editorOverviewRuler.rangeHighlightForeground",{dark:rulerRangeDefault,light:rulerRangeDefault,hc:rulerRangeDefault},nls.localize(27,null),!0),exports.overviewRulerError=(0,colorRegistry_1.registerColor)("editorOverviewRuler.errorForeground",{dark:new color_1.Color(new color_1.RGBA(255,18,18,.7)),light:new color_1.Color(new color_1.RGBA(255,18,18,.7)),hc:new color_1.Color(new color_1.RGBA(255,50,50,1))},nls.localize(28,null)),exports.overviewRulerWarning=(0,colorRegistry_1.registerColor)("editorOverviewRuler.warningForeground",{dark:colorRegistry_1.editorWarningForeground,light:colorRegistry_1.editorWarningForeground,hc:colorRegistry_1.editorWarningBorder},nls.localize(29,null)),exports.overviewRulerInfo=(0,colorRegistry_1.registerColor)("editorOverviewRuler.infoForeground",{dark:colorRegistry_1.editorInfoForeground,light:colorRegistry_1.editorInfoForeground,hc:colorRegistry_1.editorInfoBorder},nls.localize(30,null)),exports.editorBracketHighlightingForeground1=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hc:"#FFD700"},nls.localize(31,null)),exports.editorBracketHighlightingForeground2=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hc:"#DA70D6"},nls.localize(32,null)),exports.editorBracketHighlightingForeground3=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hc:"#87CEFA"},nls.localize(33,null)),exports.editorBracketHighlightingForeground4=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(34,null)),exports.editorBracketHighlightingForeground5=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(35,null)),exports.editorBracketHighlightingForeground6=(0,colorRegistry_1.registerColor)("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(36,null)),exports.editorBracketHighlightingUnexpectedBracketForeground=(0,colorRegistry_1.registerColor)("editorBracketHighlight.unexpectedBracket.foreground",{dark:new color_1.Color(new color_1.RGBA(255,18,18,.8)),light:new color_1.Color(new color_1.RGBA(255,18,18,.8)),hc:new color_1.Color(new color_1.RGBA(255,50,50,1))},nls.localize(37,null)),exports.editorBracketPairGuideBackground1=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(38,null)),exports.editorBracketPairGuideBackground2=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(39,null)),exports.editorBracketPairGuideBackground3=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(40,null)),exports.editorBracketPairGuideBackground4=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(41,null)),exports.editorBracketPairGuideBackground5=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(42,null)),exports.editorBracketPairGuideBackground6=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(43,null)),exports.editorBracketPairGuideActiveBackground1=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(44,null)),exports.editorBracketPairGuideActiveBackground2=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(45,null)),exports.editorBracketPairGuideActiveBackground3=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(46,null)),exports.editorBracketPairGuideActiveBackground4=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(47,null)),exports.editorBracketPairGuideActiveBackground5=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(48,null)),exports.editorBracketPairGuideActiveBackground6=(0,colorRegistry_1.registerColor)("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},nls.localize(49,null)),exports.editorUnicodeHighlightBorder=(0,colorRegistry_1.registerColor)("editorUnicodeHighlight.border",{dark:"#BD9B03",light:"#CEA33D",hc:"#ff0000"},nls.localize(50,null)),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const background=theme.getColor(colorRegistry_1.editorBackground);background&&collector.addRule(`.monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: ${background}; }`);const foreground=theme.getColor(colorRegistry_1.editorForeground);foreground&&collector.addRule(`.monaco-editor, .monaco-editor .inputarea.ime-input { color: ${foreground}; }`);const gutter=theme.getColor(exports.editorGutter);gutter&&collector.addRule(`.monaco-editor .margin { background-color: ${gutter}; }`);const rangeHighlight=theme.getColor(exports.editorRangeHighlight);rangeHighlight&&collector.addRule(`.monaco-editor .rangeHighlight { background-color: ${rangeHighlight}; }`);const rangeHighlightBorder=theme.getColor(exports.editorRangeHighlightBorder);rangeHighlightBorder&&collector.addRule(`.monaco-editor .rangeHighlight { border: 1px ${"hc"===theme.type?"dotted":"solid"} ${rangeHighlightBorder}; }`);const symbolHighlight=theme.getColor(exports.editorSymbolHighlight);symbolHighlight&&collector.addRule(`.monaco-editor .symbolHighlight { background-color: ${symbolHighlight}; }`);const symbolHighlightBorder=theme.getColor(exports.editorSymbolHighlightBorder);symbolHighlightBorder&&collector.addRule(`.monaco-editor .symbolHighlight { border: 1px ${"hc"===theme.type?"dotted":"solid"} ${symbolHighlightBorder}; }`);const invisibles=theme.getColor(exports.editorWhitespaces);invisibles&&(collector.addRule(`.monaco-editor .mtkw { color: ${invisibles} !important; }`),collector.addRule(`.monaco-editor .mtkz { color: ${invisibles} !important; }`))}))})),define(__m[652],__M([1,0,102,54,18,14,22,354]),(function(require,exports,dynamicViewOverlay_1,editorColorRegistry_1,arrays,themeService_1,selection_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CurrentLineMarginHighlightOverlay=exports.CurrentLineHighlightOverlay=exports.AbstractLineHighlightOverlay=void 0;class AbstractLineHighlightOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{constructor(context){super(),this._context=context;const options=this._context.configuration.options,layoutInfo=options.get(131);this._lineHeight=options.get(59),this._renderLineHighlight=options.get(85),this._renderLineHighlightOnlyWhenFocus=options.get(86),this._contentLeft=layoutInfo.contentLeft,this._contentWidth=layoutInfo.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new selection_1.Selection(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let hasChanged=!1;const cursorsLineNumbers=this._selections.map((s=>s.positionLineNumber));cursorsLineNumbers.sort(((a,b)=>a-b)),arrays.equals(this._cursorLineNumbers,cursorsLineNumbers)||(this._cursorLineNumbers=cursorsLineNumbers,hasChanged=!0);const selectionIsEmpty=this._selections.every((s=>s.isEmpty()));return this._selectionIsEmpty!==selectionIsEmpty&&(this._selectionIsEmpty=selectionIsEmpty,hasChanged=!0),hasChanged}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const options=this._context.configuration.options,layoutInfo=options.get(131);return this._lineHeight=options.get(59),this._renderLineHighlight=options.get(85),this._renderLineHighlightOnlyWhenFocus=options.get(86),this._contentLeft=layoutInfo.contentLeft,this._contentWidth=layoutInfo.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return!!this._renderLineHighlightOnlyWhenFocus&&(this._focused=e.isFocused,!0)}prepareRender(ctx){if(!this._shouldRenderThis())return void(this._renderData=null);const renderedLine=this._renderOne(ctx),visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,len=this._cursorLineNumbers.length;let index=0;const renderData=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber;for(;index<len&&this._cursorLineNumbers[index]<lineNumber;)index++;index<len&&this._cursorLineNumbers[index]===lineNumber?renderData[lineIndex]=renderedLine:renderData[lineIndex]=""}this._renderData=renderData}render(startLineNumber,lineNumber){if(!this._renderData)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex>=this._renderData.length?"":this._renderData[lineIndex]}_shouldRenderInMargin(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}exports.AbstractLineHighlightOverlay=AbstractLineHighlightOverlay;exports.CurrentLineHighlightOverlay=class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(ctx){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(ctx.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}};exports.CurrentLineMarginHighlightOverlay=class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(ctx){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}},(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const lineHighlight=theme.getColor(editorColorRegistry_1.editorLineHighlight);if(lineHighlight&&(collector.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${lineHighlight}; }`),collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${lineHighlight}; border: none; }`)),!lineHighlight||lineHighlight.isTransparent()||theme.defines(editorColorRegistry_1.editorLineHighlightBorder)){const lineHighlightBorder=theme.getColor(editorColorRegistry_1.editorLineHighlightBorder);lineHighlightBorder&&(collector.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${lineHighlightBorder}; }`),collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${lineHighlightBorder}; }`),"hc"===theme.type&&(collector.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),collector.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}}))})),define(__m[653],__M([1,0,102,54,14,11,18,19,250,186,357]),(function(require,exports,dynamicViewOverlay_1,editorColorRegistry_1,themeService_1,position_1,arrays_1,types_1,guidesTextModelPart_1,textModelGuides_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndentGuidesOverlay=void 0;class IndentGuidesOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{constructor(context){super(),this._context=context,this._primaryPosition=null;const options=this._context.configuration.options,wrappingInfo=options.get(132),fontInfo=options.get(44);this._lineHeight=options.get(59),this._spaceWidth=fontInfo.spaceWidth,this._maxIndentLeft=-1===wrappingInfo.wrappingColumn?-1:wrappingInfo.wrappingColumn*fontInfo.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=options.get(13),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options,wrappingInfo=options.get(132),fontInfo=options.get(44);return this._lineHeight=options.get(59),this._spaceWidth=fontInfo.spaceWidth,this._maxIndentLeft=-1===wrappingInfo.wrappingColumn?-1:wrappingInfo.wrappingColumn*fontInfo.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=options.get(13),!0}onCursorStateChanged(e){var _a;const newPosition=e.selections[0].getPosition();return!(null===(_a=this._primaryPosition)||void 0===_a?void 0:_a.equals(newPosition))&&(this._primaryPosition=newPosition,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(ctx){var _a,_b,_c,_d;if(!this._bracketPairGuideOptions.indentation&&!1===this._bracketPairGuideOptions.bracketPairs)return void(this._renderResult=null);const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,scrollWidth=ctx.scrollWidth,lineHeight=this._lineHeight,activeCursorPosition=this._primaryPosition,indents=this.getGuidesByLine(visibleStartLineNumber,visibleEndLineNumber,activeCursorPosition),output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber,indent=indents[lineIndex];let result="";const leftOffset=null!==(_b=null===(_a=ctx.visibleRangeForPosition(new position_1.Position(lineNumber,1)))||void 0===_a?void 0:_a.left)&&void 0!==_b?_b:0;for(const guide of indent){const left=leftOffset+(guide.visibleColumn-1)*this._spaceWidth;if(left>scrollWidth||this._maxIndentLeft>0&&left>this._maxIndentLeft)break;const className=guide.horizontalLine?guide.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",width=guide.horizontalLine?(null!==(_d=null===(_c=ctx.visibleRangeForPosition(new position_1.Position(lineNumber,guide.horizontalLine.endColumn)))||void 0===_c?void 0:_c.left)&&void 0!==_d?_d:left+this._spaceWidth)-left:this._spaceWidth;result+=`<div class="core-guide ${guide.className} ${className}" style="left:${left}px;height:${lineHeight}px;width:${width}px"></div>`}output[lineIndex]=result}this._renderResult=output}getGuidesByLine(visibleStartLineNumber,visibleEndLineNumber,activeCursorPosition){const bracketGuides=!1!==this._bracketPairGuideOptions.bracketPairs?this._context.viewModel.getBracketGuidesInRangeByLine(visibleStartLineNumber,visibleEndLineNumber,activeCursorPosition,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:!0===this._bracketPairGuideOptions.bracketPairsHorizontal?textModelGuides_1.HorizontalGuidesState.Enabled:"active"===this._bracketPairGuideOptions.bracketPairsHorizontal?textModelGuides_1.HorizontalGuidesState.EnabledForActive:textModelGuides_1.HorizontalGuidesState.Disabled,includeInactive:!0===this._bracketPairGuideOptions.bracketPairs}):null,indentGuides=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(visibleStartLineNumber,visibleEndLineNumber):null;let activeIndentStartLineNumber=0,activeIndentEndLineNumber=0,activeIndentLevel=0;if(this._bracketPairGuideOptions.highlightActiveIndentation&&activeCursorPosition){const activeIndentInfo=this._context.viewModel.getActiveIndentGuide(activeCursorPosition.lineNumber,visibleStartLineNumber,visibleEndLineNumber);activeIndentStartLineNumber=activeIndentInfo.startLineNumber,activeIndentEndLineNumber=activeIndentInfo.endLineNumber,activeIndentLevel=activeIndentInfo.indent}const{indentSize}=this._context.viewModel.model.getOptions(),result=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineGuides=new Array;result.push(lineGuides);const bracketGuidesInLine=bracketGuides?bracketGuides[lineNumber-visibleStartLineNumber]:[],bracketGuidesInLineQueue=new arrays_1.ArrayQueue(bracketGuidesInLine),indentGuidesInLine=indentGuides?indentGuides[lineNumber-visibleStartLineNumber]:[];for(let indentLvl=1;indentLvl<=indentGuidesInLine;indentLvl++){const indentGuide=(indentLvl-1)*indentSize+1,isActive=0===bracketGuidesInLine.length&&activeIndentStartLineNumber<=lineNumber&&lineNumber<=activeIndentEndLineNumber&&indentLvl===activeIndentLevel;lineGuides.push(...bracketGuidesInLineQueue.takeWhile((g=>g.visibleColumn<indentGuide))||[]);const peeked=bracketGuidesInLineQueue.peek();peeked&&peeked.visibleColumn===indentGuide&&!peeked.horizontalLine||lineGuides.push(new textModelGuides_1.IndentGuide(indentGuide,isActive?"core-guide-indent-active":"core-guide-indent",null))}lineGuides.push(...bracketGuidesInLineQueue.takeWhile((g=>!0))||[])}return result}render(startLineNumber,lineNumber){if(!this._renderResult)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex<0||lineIndex>=this._renderResult.length?"":this._renderResult[lineIndex]}}function transparentToUndefined(color){if(!color||!color.isTransparent())return color}exports.IndentGuidesOverlay=IndentGuidesOverlay,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const editorIndentGuidesColor=theme.getColor(editorColorRegistry_1.editorIndentGuides);editorIndentGuidesColor&&collector.addRule(`.monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 ${editorIndentGuidesColor} inset; }`);const editorActiveIndentGuidesColor=theme.getColor(editorColorRegistry_1.editorActiveIndentGuides)||editorIndentGuidesColor;editorActiveIndentGuidesColor&&collector.addRule(`.monaco-editor .lines-content .core-guide-indent-active { box-shadow: 1px 0 0 0 ${editorActiveIndentGuidesColor} inset; }`);const colors=[{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground1,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground1,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground1},{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground2,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground2,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground2},{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground3,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground3,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground3},{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground4,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground4,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground4},{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground5,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground5,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground5},{bracketColor:editorColorRegistry_1.editorBracketHighlightingForeground6,guideColor:editorColorRegistry_1.editorBracketPairGuideBackground6,guideColorActive:editorColorRegistry_1.editorBracketPairGuideActiveBackground6}],colorProvider=new guidesTextModelPart_1.BracketPairGuidesClassNames,colorValues=colors.map((c=>{var _a,_b;const bracketColor=theme.getColor(c.bracketColor),guideColor=theme.getColor(c.guideColor),guideColorActive=theme.getColor(c.guideColorActive),effectiveGuideColor=transparentToUndefined(null!==(_a=transparentToUndefined(guideColor))&&void 0!==_a?_a:null==bracketColor?void 0:bracketColor.transparent(.3)),effectiveGuideColorActive=transparentToUndefined(null!==(_b=transparentToUndefined(guideColorActive))&&void 0!==_b?_b:bracketColor);if(effectiveGuideColor&&effectiveGuideColorActive)return{guideColor:effectiveGuideColor,guideColorActive:effectiveGuideColorActive}})).filter(types_1.isDefined);if(colorValues.length>0){for(let level=0;level<30;level++){const colors=colorValues[level%colorValues.length];collector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level).replace(/ /g,".")} { --guide-color: ${colors.guideColor}; --guide-color-active: ${colors.guideColorActive}; }`)}collector.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),collector.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),collector.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),collector.addRule(`.monaco-editor .vertical.${colorProvider.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),collector.addRule(`.monaco-editor .horizontal-top.${colorProvider.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),collector.addRule(`.monaco-editor .horizontal-bottom.${colorProvider.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}}))})),define(__m[286],__M([1,0,16,102,11,54,14,358]),(function(require,exports,platform,dynamicViewOverlay_1,position_1,editorColorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LineNumbersOverlay=void 0;class LineNumbersOverlay extends dynamicViewOverlay_1.DynamicViewOverlay{constructor(context){super(),this._context=context,this._readConfig(),this._lastCursorModelPosition=new position_1.Position(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const options=this._context.configuration.options;this._lineHeight=options.get(59);const lineNumbers=options.get(60);this._renderLineNumbers=lineNumbers.renderType,this._renderCustomLineNumbers=lineNumbers.renderFn,this._renderFinalNewline=options.get(84);const layoutInfo=options.get(131);this._lineNumbersLeft=layoutInfo.lineNumbersLeft,this._lineNumbersWidth=layoutInfo.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const primaryViewPosition=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(primaryViewPosition);let shouldRender=!1;return this._activeLineNumber!==primaryViewPosition.lineNumber&&(this._activeLineNumber=primaryViewPosition.lineNumber,shouldRender=!0),2!==this._renderLineNumbers&&3!==this._renderLineNumbers||(shouldRender=!0),shouldRender}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(viewLineNumber){const modelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new position_1.Position(viewLineNumber,1));if(1!==modelPosition.column)return"";const modelLineNumber=modelPosition.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(modelLineNumber);if(2===this._renderLineNumbers){const diff=Math.abs(this._lastCursorModelPosition.lineNumber-modelLineNumber);return 0===diff?'<span class="relative-current-line-number">'+modelLineNumber+"</span>":String(diff)}return 3===this._renderLineNumbers?this._lastCursorModelPosition.lineNumber===modelLineNumber||modelLineNumber%10==0?String(modelLineNumber):"":String(modelLineNumber)}prepareRender(ctx){if(0===this._renderLineNumbers)return void(this._renderResult=null);const lineHeightClassName=platform.isLinux?this._lineHeight%2==0?" lh-even":" lh-odd":"",visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,common='<div class="'+LineNumbersOverlay.CLASS_NAME+lineHeightClassName+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">',lineCount=this._context.viewModel.getLineCount(),output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber;if(!this._renderFinalNewline&&lineNumber===lineCount&&0===this._context.viewModel.getLineLength(lineNumber)){output[lineIndex]="";continue}const renderLineNumber=this._getLineRenderLineNumber(lineNumber);renderLineNumber?lineNumber===this._activeLineNumber?output[lineIndex]='<div class="active-line-number '+LineNumbersOverlay.CLASS_NAME+lineHeightClassName+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">'+renderLineNumber+"</div>":output[lineIndex]=common+renderLineNumber+"</div>":output[lineIndex]=""}this._renderResult=output}render(startLineNumber,lineNumber){if(!this._renderResult)return"";const lineIndex=lineNumber-startLineNumber;return lineIndex<0||lineIndex>=this._renderResult.length?"":this._renderResult[lineIndex]}}exports.LineNumbersOverlay=LineNumbersOverlay,LineNumbersOverlay.CLASS_NAME="line-numbers",(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const lineNumbers=theme.getColor(editorColorRegistry_1.editorLineNumbers);lineNumbers&&collector.addRule(`.monaco-editor .line-numbers { color: ${lineNumbers}; }`);const activeLineNumber=theme.getColor(editorColorRegistry_1.editorActiveLineNumber);activeLineNumber&&collector.addRule(`.monaco-editor .line-numbers.active-line-number { color: ${activeLineNumber}; }`)}))})),define(__m[654],__M([1,0,504,34,31,16,8,64,178,237,51,286,254,32,120,11,3,22,144,27,30,353]),(function(require,exports,nls,browser,fastDomNode_1,platform,strings,domFontInfo_1,textAreaInput_1,textAreaState_1,viewPart_1,lineNumbers_1,margin_1,editorOptions_1,wordCharacterClassifier_1,position_1,range_1,selection_1,mouseCursor_1,languages_1,color_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextAreaHandler=void 0;class VisibleTextAreaData{constructor(_context,modelLineNumber,distanceToModelLineStart,widthOfHiddenLineTextBefore,distanceToModelLineEnd){this._context=_context,this.modelLineNumber=modelLineNumber,this.distanceToModelLineStart=distanceToModelLineStart,this.widthOfHiddenLineTextBefore=widthOfHiddenLineTextBefore,this.distanceToModelLineEnd=distanceToModelLineEnd,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(visibleRangeProvider){const startModelPosition=new position_1.Position(this.modelLineNumber,this.distanceToModelLineStart+1),endModelPosition=new position_1.Position(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(startModelPosition),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(endModelPosition),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=visibleRangeProvider.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=visibleRangeProvider.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(tokenPresentation){return this._previousPresentation||(this._previousPresentation=tokenPresentation||{foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const canUseZeroSizeTextarea=browser.isFirefox;class TextAreaHandler extends viewPart_1.ViewPart{constructor(context,viewController,visibleRangeProvider){super(context),this._primaryCursorPosition=new position_1.Position(1,1),this._primaryCursorVisibleRange=null,this._viewController=viewController,this._visibleRangeProvider=visibleRangeProvider,this._scrollLeft=0,this._scrollTop=0;const options=this._context.configuration.options,layoutInfo=options.get(131);this._setAccessibilityOptions(options),this._contentLeft=layoutInfo.contentLeft,this._contentWidth=layoutInfo.contentWidth,this._contentHeight=layoutInfo.height,this._fontInfo=options.get(44),this._lineHeight=options.get(59),this._emptySelectionClipboard=options.get(32),this._copyWithSyntaxHighlighting=options.get(21),this._visibleTextArea=null,this._selections=[new selection_1.Selection(1,1,1,1)],this._modelSelections=[new selection_1.Selection(1,1,1,1)],this._lastRenderPosition=null,this.textArea=(0,fastDomNode_1.createFastDomNode)(document.createElement("textarea")),viewPart_1.PartFingerprints.write(this.textArea,6),this.textArea.setClassName(`inputarea ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(options)),this.textArea.setAttribute("tabindex",String(options.get(112))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",nls.localize(0,null)),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),options.get(30)&&options.get(81)&&this.textArea.setAttribute("readonly","true"),this.textAreaCover=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.textAreaCover.setPosition("absolute");const simpleModel={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:lineNumber=>this._context.viewModel.getLineMaxColumn(lineNumber),getValueInRange:(range,eol)=>this._context.viewModel.getValueInRange(range,eol)},textAreaInputHost={getDataToCopy:()=>{const rawTextToCopy=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,platform.isWindows),newLineCharacter=this._context.viewModel.model.getEOL(),isFromEmptySelection=this._emptySelectionClipboard&&1===this._modelSelections.length&&this._modelSelections[0].isEmpty(),multicursorText=Array.isArray(rawTextToCopy)?rawTextToCopy:null,text=Array.isArray(rawTextToCopy)?rawTextToCopy.join(newLineCharacter):rawTextToCopy;let html,mode=null;if(textAreaInput_1.CopyOptions.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&text.length<65536){const richText=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);richText&&(html=richText.html,mode=richText.mode)}return{isFromEmptySelection,multicursorText,text,html,mode}},getScreenReaderContent:currentState=>{if(1===this._accessibilitySupport){if(platform.isMacintosh){const selection=this._selections[0];if(selection.isEmpty()){const position=selection.getStartPosition();let textBefore=this._getWordBeforePosition(position);if(0===textBefore.length&&(textBefore=this._getCharacterBeforePosition(position)),textBefore.length>0)return new textAreaState_1.TextAreaState(textBefore,textBefore.length,textBefore.length,position,position)}}return textAreaState_1.TextAreaState.EMPTY}if(browser.isAndroid){const selection=this._selections[0];if(selection.isEmpty()){const position=selection.getStartPosition(),[wordAtPosition,positionOffsetInWord]=this._getAndroidWordAtPosition(position);if(wordAtPosition.length>0)return new textAreaState_1.TextAreaState(wordAtPosition,positionOffsetInWord,positionOffsetInWord,position,position)}return textAreaState_1.TextAreaState.EMPTY}return textAreaState_1.PagedScreenReaderStrategy.fromEditorSelection(currentState,simpleModel,this._selections[0],this._accessibilityPageSize,0===this._accessibilitySupport)},deduceModelPosition:(viewAnchorPosition,deltaOffset,lineFeedCnt)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(viewAnchorPosition,deltaOffset,lineFeedCnt)},textAreaWrapper=this._register(new textAreaInput_1.TextAreaWrapper(this.textArea.domNode));this._textAreaInput=this._register(new textAreaInput_1.TextAreaInput(textAreaInputHost,textAreaWrapper,platform.OS,browser)),this._register(this._textAreaInput.onKeyDown((e=>{this._viewController.emitKeyDown(e)}))),this._register(this._textAreaInput.onKeyUp((e=>{this._viewController.emitKeyUp(e)}))),this._register(this._textAreaInput.onPaste((e=>{let pasteOnNewLine=!1,multicursorText=null,mode=null;e.metadata&&(pasteOnNewLine=this._emptySelectionClipboard&&!!e.metadata.isFromEmptySelection,multicursorText=void 0!==e.metadata.multicursorText?e.metadata.multicursorText:null,mode=e.metadata.mode),this._viewController.paste(e.text,pasteOnNewLine,multicursorText,mode)}))),this._register(this._textAreaInput.onCut((()=>{this._viewController.cut()}))),this._register(this._textAreaInput.onType((e=>{e.replacePrevCharCnt||e.replaceNextCharCnt||e.positionDelta?(textAreaState_1._debugComposition&&console.log(` => compositionType: <<${e.text}>>, ${e.replacePrevCharCnt}, ${e.replaceNextCharCnt}, ${e.positionDelta}`),this._viewController.compositionType(e.text,e.replacePrevCharCnt,e.replaceNextCharCnt,e.positionDelta)):(textAreaState_1._debugComposition&&console.log(` => type: <<${e.text}>>`),this._viewController.type(e.text))}))),this._register(this._textAreaInput.onSelectionChangeRequest((modelSelection=>{this._viewController.setSelection(modelSelection)}))),this._register(this._textAreaInput.onCompositionStart((e=>{const ta=this.textArea.domNode,modelSelection=this._modelSelections[0],{distanceToModelLineStart,widthOfHiddenTextBefore}=(()=>{const textBeforeSelection=ta.value.substring(0,Math.min(ta.selectionStart,ta.selectionEnd)),lineFeedOffset1=textBeforeSelection.lastIndexOf("\n"),lineTextBeforeSelection=textBeforeSelection.substring(lineFeedOffset1+1),tabOffset1=lineTextBeforeSelection.lastIndexOf("\t"),desiredVisibleBeforeCharCount=lineTextBeforeSelection.length-tabOffset1-1,startModelPosition=modelSelection.getStartPosition(),visibleBeforeCharCount=Math.min(startModelPosition.column-1,desiredVisibleBeforeCharCount),distanceToModelLineStart=startModelPosition.column-1-visibleBeforeCharCount,widthOfHiddenTextBefore=function measureText(text,fontInfo){if(0===text.length)return 0;const container=document.createElement("div");container.style.position="absolute",container.style.top="-50000px",container.style.width="50000px";const regularDomNode=document.createElement("span");(0,domFontInfo_1.applyFontInfo)(regularDomNode,fontInfo),regularDomNode.style.whiteSpace="pre",regularDomNode.append(text),container.appendChild(regularDomNode),document.body.appendChild(container);const res=regularDomNode.offsetWidth;return document.body.removeChild(container),res}(lineTextBeforeSelection.substring(0,lineTextBeforeSelection.length-visibleBeforeCharCount),this._fontInfo);return{distanceToModelLineStart,widthOfHiddenTextBefore}})(),{distanceToModelLineEnd}=(()=>{const textAfterSelection=ta.value.substring(Math.max(ta.selectionStart,ta.selectionEnd)),lineFeedOffset2=textAfterSelection.indexOf("\n"),lineTextAfterSelection=-1===lineFeedOffset2?textAfterSelection:textAfterSelection.substring(0,lineFeedOffset2),tabOffset2=lineTextAfterSelection.indexOf("\t"),desiredVisibleAfterCharCount=-1===tabOffset2?lineTextAfterSelection.length:lineTextAfterSelection.length-tabOffset2-1,endModelPosition=modelSelection.getEndPosition(),visibleAfterCharCount=Math.min(this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber)-endModelPosition.column,desiredVisibleAfterCharCount);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber)-endModelPosition.column-visibleAfterCharCount}})();this._context.viewModel.revealRange("keyboard",!0,range_1.Range.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new VisibleTextAreaData(this._context,modelSelection.startLineNumber,distanceToModelLineStart,widthOfHiddenTextBefore,distanceToModelLineEnd),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()}))),this._register(this._textAreaInput.onCompositionUpdate((e=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())}))),this._register(this._textAreaInput.onCompositionEnd((()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName(`inputarea ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}))),this._register(this._textAreaInput.onFocus((()=>{this._context.viewModel.setHasFocus(!0)}))),this._register(this._textAreaInput.onBlur((()=>{this._context.viewModel.setHasFocus(!1)})))}dispose(){super.dispose()}_getAndroidWordAtPosition(position){const lineContent=this._context.viewModel.getLineContent(position.lineNumber),wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)('`~!@#$%^&*()-=+[{]}\\|;:",.<>/?');let goingLeft=!0,startColumn=position.column,goingRight=!0,endColumn=position.column,distance=0;for(;distance<50&&(goingLeft||goingRight);){if(goingLeft&&startColumn<=1&&(goingLeft=!1),goingLeft){const charCode=lineContent.charCodeAt(startColumn-2);0!==wordSeparators.get(charCode)?goingLeft=!1:startColumn--}if(goingRight&&endColumn>lineContent.length&&(goingRight=!1),goingRight){const charCode=lineContent.charCodeAt(endColumn-1);0!==wordSeparators.get(charCode)?goingRight=!1:endColumn++}distance++}return[lineContent.substring(startColumn-1,endColumn-1),position.column-startColumn]}_getWordBeforePosition(position){const lineContent=this._context.viewModel.getLineContent(position.lineNumber),wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(this._context.configuration.options.get(117));let column=position.column,distance=0;for(;column>1;){const charCode=lineContent.charCodeAt(column-2);if(0!==wordSeparators.get(charCode)||distance>50)return lineContent.substring(column-1,position.column-1);distance++,column--}return lineContent.substring(0,position.column-1)}_getCharacterBeforePosition(position){if(position.column>1){const charBefore=this._context.viewModel.getLineContent(position.lineNumber).charAt(position.column-2);if(!strings.isHighSurrogate(charBefore.charCodeAt(0)))return charBefore}return""}_getAriaLabel(options){return 1===options.get(2)?nls.localize(1,null,platform.isLinux?"Shift+Alt+F1":"Alt+F1"):options.get(4)}_setAccessibilityOptions(options){this._accessibilitySupport=options.get(2);const accessibilityPageSize=options.get(3);2===this._accessibilitySupport&&accessibilityPageSize===editorOptions_1.EditorOptions.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=accessibilityPageSize}onConfigurationChanged(e){const options=this._context.configuration.options,layoutInfo=options.get(131);return this._setAccessibilityOptions(options),this._contentLeft=layoutInfo.contentLeft,this._contentWidth=layoutInfo.contentWidth,this._contentHeight=layoutInfo.height,this._fontInfo=options.get(44),this._lineHeight=options.get(59),this._emptySelectionClipboard=options.get(32),this._copyWithSyntaxHighlighting=options.get(21),this.textArea.setAttribute("aria-label",this._getAriaLabel(options)),this.textArea.setAttribute("tabindex",String(options.get(112))),(e.hasChanged(30)||e.hasChanged(81))&&(options.get(30)&&options.get(81)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(options){options.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",options.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),options.role&&this.textArea.setAttribute("role",options.role)}prepareRender(ctx){this._primaryCursorPosition=new position_1.Position(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=ctx.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea&&this._visibleTextArea.prepareRender(ctx)}render(ctx){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea){const visibleStart=this._visibleTextArea.visibleTextareaStart,visibleEnd=this._visibleTextArea.visibleTextareaEnd,startPosition=this._visibleTextArea.startPosition,endPosition=this._visibleTextArea.endPosition;if(startPosition&&endPosition&&visibleStart&&visibleEnd&&visibleEnd.left>=this._scrollLeft&&visibleStart.left<=this._scrollLeft+this._contentWidth){const top=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,lineCount=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let scrollLeft=this._visibleTextArea.widthOfHiddenLineTextBefore,left=this._contentLeft+visibleStart.left-this._scrollLeft,width=visibleEnd.left-visibleStart.left+1;if(left<this._contentLeft){const delta=this._contentLeft-left;left+=delta,scrollLeft+=delta,width-=delta}width>this._contentWidth&&(width=this._contentWidth);const viewLineData=this._context.viewModel.getViewLineData(startPosition.lineNumber),startTokenIndex=viewLineData.tokens.findTokenIndexAtOffset(startPosition.column-1),textareaSpansSingleToken=startTokenIndex===viewLineData.tokens.findTokenIndexAtOffset(endPosition.column-1),presentation=this._visibleTextArea.definePresentation(textareaSpansSingleToken?viewLineData.tokens.getPresentation(startTokenIndex):null);this.textArea.domNode.scrollTop=lineCount*this._lineHeight,this.textArea.domNode.scrollLeft=scrollLeft,this._doRender({lastRenderPosition:null,top,left,width,height:this._lineHeight,useCover:!1,color:(languages_1.TokenizationRegistry.getColorMap()||[])[presentation.foreground],italic:presentation.italic,bold:presentation.bold,underline:presentation.underline,strikethrough:presentation.strikethrough})}return}if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft();const left=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(left<this._contentLeft||left>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft();const top=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(top<0||top>this._contentHeight)this._renderAtTopLeft();else if(platform.isMacintosh){this._doRender({lastRenderPosition:this._primaryCursorPosition,top,left,width:canUseZeroSizeTextarea?0:1,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const lineCount=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=lineCount*this._lineHeight}else this._doRender({lastRenderPosition:this._primaryCursorPosition,top,left,width:canUseZeroSizeTextarea?0:1,height:canUseZeroSizeTextarea?0:1,useCover:!1})}_newlinecount(text){let result=0,startIndex=-1;for(;;){if(startIndex=text.indexOf("\n",startIndex+1),-1===startIndex)break;result++}return result}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:canUseZeroSizeTextarea?0:1,height:canUseZeroSizeTextarea?0:1,useCover:!0})}_doRender(renderData){this._lastRenderPosition=renderData.lastRenderPosition;const ta=this.textArea,tac=this.textAreaCover;(0,domFontInfo_1.applyFontInfo)(ta,this._fontInfo),ta.setTop(renderData.top),ta.setLeft(renderData.left),ta.setWidth(renderData.width),ta.setHeight(renderData.height),ta.setColor(renderData.color?color_1.Color.Format.CSS.formatHex(renderData.color):""),ta.setFontStyle(renderData.italic?"italic":""),renderData.bold&&ta.setFontWeight("bold"),ta.setTextDecoration(`${renderData.underline?" underline":""}${renderData.strikethrough?" line-through":""}`),tac.setTop(renderData.useCover?renderData.top:0),tac.setLeft(renderData.useCover?renderData.left:0),tac.setWidth(renderData.useCover?renderData.width:0),tac.setHeight(renderData.useCover?renderData.height:0);const options=this._context.configuration.options;options.get(50)?tac.setClassName("monaco-editor-background textAreaCover "+margin_1.Margin.OUTER_CLASS_NAME):0!==options.get(60).renderType?tac.setClassName("monaco-editor-background textAreaCover "+lineNumbers_1.LineNumbersOverlay.CLASS_NAME):tac.setClassName("monaco-editor-background textAreaCover")}}exports.TextAreaHandler=TextAreaHandler})),define(__m[655],__M([1,0,31,30,51,11,27,54,71]),(function(require,exports,fastDomNode_1,color_1,viewPart_1,position_1,languages_1,editorColorRegistry_1,viewModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DecorationsOverviewRuler=void 0;class Settings{constructor(config,theme){const options=config.options;this.lineHeight=options.get(59),this.pixelRatio=options.get(129),this.overviewRulerLanes=options.get(74),this.renderBorder=options.get(73);const borderColor=theme.getColor(editorColorRegistry_1.editorOverviewRulerBorder);this.borderColor=borderColor?borderColor.toString():null,this.hideCursor=options.get(52);const cursorColor=theme.getColor(editorColorRegistry_1.editorCursorForeground);this.cursorColor=cursorColor?cursorColor.transparent(.7).toString():null,this.themeType=theme.type;const minimapOpts=options.get(65),minimapEnabled=minimapOpts.enabled,minimapSide=minimapOpts.side,backgroundColor=minimapEnabled?theme.getColor(editorColorRegistry_1.editorOverviewRulerBackground)||languages_1.TokenizationRegistry.getDefaultBackground():null;this.backgroundColor=null===backgroundColor||"left"===minimapSide?null:color_1.Color.Format.CSS.formatHex(backgroundColor);const position=options.get(131).overviewRuler;this.top=position.top,this.right=position.right,this.domWidth=position.width,this.domHeight=position.height,0===this.overviewRulerLanes?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[x,w]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=x,this.w=w}_initLanes(canvasLeftOffset,canvasWidth,laneCount){const remainingWidth=canvasWidth-canvasLeftOffset;if(laneCount>=3){const leftWidth=Math.floor(remainingWidth/3),rightWidth=Math.floor(remainingWidth/3),centerWidth=remainingWidth-leftWidth-rightWidth,centerOffset=canvasLeftOffset+leftWidth;return[[0,canvasLeftOffset,centerOffset,canvasLeftOffset,canvasLeftOffset+leftWidth+centerWidth,canvasLeftOffset,centerOffset,canvasLeftOffset],[0,leftWidth,centerWidth,leftWidth+centerWidth,rightWidth,leftWidth+centerWidth+rightWidth,centerWidth+rightWidth,leftWidth+centerWidth+rightWidth]]}if(2===laneCount){const leftWidth=Math.floor(remainingWidth/2),rightWidth=remainingWidth-leftWidth;return[[0,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset+leftWidth,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset],[0,leftWidth,leftWidth,leftWidth,rightWidth,leftWidth+rightWidth,leftWidth+rightWidth,leftWidth+rightWidth]]}return[[0,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset,canvasLeftOffset],[0,remainingWidth,remainingWidth,remainingWidth,remainingWidth,remainingWidth,remainingWidth,remainingWidth]]}equals(other){return this.lineHeight===other.lineHeight&&this.pixelRatio===other.pixelRatio&&this.overviewRulerLanes===other.overviewRulerLanes&&this.renderBorder===other.renderBorder&&this.borderColor===other.borderColor&&this.hideCursor===other.hideCursor&&this.cursorColor===other.cursorColor&&this.themeType===other.themeType&&this.backgroundColor===other.backgroundColor&&this.top===other.top&&this.right===other.right&&this.domWidth===other.domWidth&&this.domHeight===other.domHeight&&this.canvasWidth===other.canvasWidth&&this.canvasHeight===other.canvasHeight}}class DecorationsOverviewRuler extends viewPart_1.ViewPart{constructor(context){super(context),this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=languages_1.TokenizationRegistry.onDidChange((e=>{e.changedColorMap&&this._updateSettings(!0)})),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(renderNow){const newSettings=new Settings(this._context.configuration,this._context.theme);return(!this._settings||!this._settings.equals(newSettings))&&(this._settings=newSettings,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,renderNow&&this._render(),!0)}onConfigurationChanged(e){return this._updateSettings(!1)}onCursorStateChanged(e){this._cursorPositions=[];for(let i=0,len=e.selections.length;i<len;i++)this._cursorPositions[i]=e.selections[i].getPosition();return this._cursorPositions.sort(position_1.Position.compare),!0}onDecorationsChanged(e){return!!e.affectsOverviewRuler}onFlushed(e){return!0}onScrollChanged(e){return e.scrollHeightChanged}onZonesChanged(e){return!0}onThemeChanged(e){return this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(ctx){}render(editorCtx){this._render()}_render(){if(0===this._settings.overviewRulerLanes)return this._domNode.setBackgroundColor(this._settings.backgroundColor?this._settings.backgroundColor:""),void this._domNode.setDisplay("none");this._domNode.setDisplay("block");const canvasWidth=this._settings.canvasWidth,canvasHeight=this._settings.canvasHeight,lineHeight=this._settings.lineHeight,viewLayout=this._context.viewLayout,heightRatio=canvasHeight/this._context.viewLayout.getScrollHeight(),decorations=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme),minDecorationHeight=6*this._settings.pixelRatio|0,halfMinDecorationHeight=minDecorationHeight/2|0,canvasCtx=this._domNode.domNode.getContext("2d");null===this._settings.backgroundColor?canvasCtx.clearRect(0,0,canvasWidth,canvasHeight):(canvasCtx.fillStyle=this._settings.backgroundColor,canvasCtx.fillRect(0,0,canvasWidth,canvasHeight));const x=this._settings.x,w=this._settings.w;decorations.sort(viewModel_1.OverviewRulerDecorationsGroup.cmp);for(const decorationGroup of decorations){const color=decorationGroup.color,decorationGroupData=decorationGroup.data;canvasCtx.fillStyle=color;let prevLane=0,prevY1=0,prevY2=0;for(let i=0,len=decorationGroupData.length/3;i<len;i++){const lane=decorationGroupData[3*i],startLineNumber=decorationGroupData[3*i+1],endLineNumber=decorationGroupData[3*i+2];let y1=viewLayout.getVerticalOffsetForLineNumber(startLineNumber)*heightRatio|0,y2=(viewLayout.getVerticalOffsetForLineNumber(endLineNumber)+lineHeight)*heightRatio|0;if(y2-y1<minDecorationHeight){let yCenter=(y1+y2)/2|0;yCenter<halfMinDecorationHeight?yCenter=halfMinDecorationHeight:yCenter+halfMinDecorationHeight>canvasHeight&&(yCenter=canvasHeight-halfMinDecorationHeight),y1=yCenter-halfMinDecorationHeight,y2=yCenter+halfMinDecorationHeight}y1>prevY2+1||lane!==prevLane?(0!==i&&canvasCtx.fillRect(x[prevLane],prevY1,w[prevLane],prevY2-prevY1),prevLane=lane,prevY1=y1,prevY2=y2):y2>prevY2&&(prevY2=y2)}canvasCtx.fillRect(x[prevLane],prevY1,w[prevLane],prevY2-prevY1)}if(!this._settings.hideCursor&&this._settings.cursorColor){const cursorHeight=2*this._settings.pixelRatio|0,halfCursorHeight=cursorHeight/2|0,cursorX=this._settings.x[7],cursorW=this._settings.w[7];canvasCtx.fillStyle=this._settings.cursorColor;let prevY1=-100,prevY2=-100;for(let i=0,len=this._cursorPositions.length;i<len;i++){const cursor=this._cursorPositions[i];let yCenter=viewLayout.getVerticalOffsetForLineNumber(cursor.lineNumber)*heightRatio|0;yCenter<halfCursorHeight?yCenter=halfCursorHeight:yCenter+halfCursorHeight>canvasHeight&&(yCenter=canvasHeight-halfCursorHeight);const y1=yCenter-halfCursorHeight,y2=y1+cursorHeight;y1>prevY2+1?(0!==i&&canvasCtx.fillRect(cursorX,prevY1,cursorW,prevY2-prevY1),prevY1=y1,prevY2=y2):y2>prevY2&&(prevY2=y2)}canvasCtx.fillRect(cursorX,prevY1,cursorW,prevY2-prevY1)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(canvasCtx.beginPath(),canvasCtx.lineWidth=1,canvasCtx.strokeStyle=this._settings.borderColor,canvasCtx.moveTo(0,0),canvasCtx.lineTo(0,canvasHeight),canvasCtx.stroke(),canvasCtx.moveTo(0,0),canvasCtx.lineTo(canvasWidth,0),canvasCtx.stroke())}}exports.DecorationsOverviewRuler=DecorationsOverviewRuler})),define(__m[656],__M([1,0,31,51,54,14,364]),(function(require,exports,fastDomNode_1,viewPart_1,editorColorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rulers=void 0;class Rulers extends viewPart_1.ViewPart{constructor(context){super(context),this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const options=this._context.configuration.options;this._rulers=options.get(91),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const options=this._context.configuration.options;return this._rulers=options.get(91),this._typicalHalfwidthCharacterWidth=options.get(44).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(ctx){}_ensureRulersCount(){const currentCount=this._renderedRulers.length,desiredCount=this._rulers.length;if(currentCount===desiredCount)return;if(currentCount<desiredCount){const{tabSize}=this._context.viewModel.model.getOptions(),rulerWidth=tabSize;let addCount=desiredCount-currentCount;for(;addCount>0;){const node=(0,fastDomNode_1.createFastDomNode)(document.createElement("div"));node.setClassName("view-ruler"),node.setWidth(rulerWidth),this.domNode.appendChild(node),this._renderedRulers.push(node),addCount--}return}let removeCount=currentCount-desiredCount;for(;removeCount>0;){const node=this._renderedRulers.pop();this.domNode.removeChild(node),removeCount--}}render(ctx){this._ensureRulersCount();for(let i=0,len=this._rulers.length;i<len;i++){const node=this._renderedRulers[i],ruler=this._rulers[i];node.setBoxShadow(ruler.color?`1px 0 0 0 ${ruler.color} inset`:""),node.setHeight(Math.min(ctx.scrollHeight,1e6)),node.setLeft(ruler.column*this._typicalHalfwidthCharacterWidth)}}}exports.Rulers=Rulers,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const rulerColor=theme.getColor(editorColorRegistry_1.editorRuler);rulerColor&&collector.addRule(`.monaco-editor .view-ruler { box-shadow: 1px 0 0 0 ${rulerColor} inset; }`)}))})),define(__m[657],__M([1,0,31,10,51,517,32,54,14,367]),(function(require,exports,fastDomNode_1,async_1,viewPart_1,viewCursor_1,editorOptions_1,editorColorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewCursors=void 0;class ViewCursors extends viewPart_1.ViewPart{constructor(context){super(context);const options=this._context.configuration.options;this._readOnly=options.get(81),this._cursorBlinking=options.get(22),this._cursorStyle=options.get(24),this._cursorSmoothCaretAnimation=options.get(23),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new viewCursor_1.ViewCursor(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new async_1.TimeoutTimer,this._cursorFlatBlinkInterval=new async_1.IntervalTimer,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const options=this._context.configuration.options;this._readOnly=options.get(81),this._cursorBlinking=options.get(22),this._cursorStyle=options.get(24),this._cursorSmoothCaretAnimation=options.get(23),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,len=this._secondaryCursors.length;i<len;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(position,secondaryPositions){if(this._primaryCursor.onCursorPositionChanged(position),this._updateBlinking(),this._secondaryCursors.length<secondaryPositions.length){const addCnt=secondaryPositions.length-this._secondaryCursors.length;for(let i=0;i<addCnt;i++){const newCursor=new viewCursor_1.ViewCursor(this._context);this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(newCursor)}}else if(this._secondaryCursors.length>secondaryPositions.length){const removeCnt=this._secondaryCursors.length-secondaryPositions.length;for(let i=0;i<removeCnt;i++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let i=0;i<secondaryPositions.length;i++)this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i])}onCursorStateChanged(e){const positions=[];for(let i=0,len=e.selections.length;i<len;i++)positions[i]=e.selections[i].getPosition();this._onCursorPositionChanged(positions[0],positions.slice(1));const selectionIsEmpty=e.selections[0].isEmpty();return this._selectionIsEmpty!==selectionIsEmpty&&(this._selectionIsEmpty=selectionIsEmpty,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const shouldRender=position=>{for(let i=0,len=e.ranges.length;i<len;i++)if(e.ranges[i].fromLineNumber<=position.lineNumber&&position.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(shouldRender(this._primaryCursor.getPosition()))return!0;for(const secondaryCursor of this._secondaryCursors)if(shouldRender(secondaryCursor.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const blinkingStyle=this._getCursorBlinking(),isHidden=0===blinkingStyle,isSolid=5===blinkingStyle;isHidden?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),isHidden||isSolid||(1===blinkingStyle?this._cursorFlatBlinkInterval.cancelAndSet((()=>{this._isVisible?this._hide():this._show()}),ViewCursors.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet((()=>{this._blinkingEnabled=!0,this._updateDomClassName()}),ViewCursors.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let result="cursors-layer";switch(this._selectionIsEmpty||(result+=" has-selection"),this._cursorStyle){case editorOptions_1.TextEditorCursorStyle.Line:result+=" cursor-line-style";break;case editorOptions_1.TextEditorCursorStyle.Block:result+=" cursor-block-style";break;case editorOptions_1.TextEditorCursorStyle.Underline:result+=" cursor-underline-style";break;case editorOptions_1.TextEditorCursorStyle.LineThin:result+=" cursor-line-thin-style";break;case editorOptions_1.TextEditorCursorStyle.BlockOutline:result+=" cursor-block-outline-style";break;case editorOptions_1.TextEditorCursorStyle.UnderlineThin:result+=" cursor-underline-thin-style";break;default:result+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:result+=" cursor-blink";break;case 2:result+=" cursor-smooth";break;case 3:result+=" cursor-phase";break;case 4:result+=" cursor-expand";break;default:result+=" cursor-solid"}else result+=" cursor-solid";return this._cursorSmoothCaretAnimation&&(result+=" cursor-smooth-caret-animation"),result}_show(){this._primaryCursor.show();for(let i=0,len=this._secondaryCursors.length;i<len;i++)this._secondaryCursors[i].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let i=0,len=this._secondaryCursors.length;i<len;i++)this._secondaryCursors[i].hide();this._isVisible=!1}prepareRender(ctx){this._primaryCursor.prepareRender(ctx);for(let i=0,len=this._secondaryCursors.length;i<len;i++)this._secondaryCursors[i].prepareRender(ctx)}render(ctx){const renderData=[];let renderDataLen=0;const primaryRenderData=this._primaryCursor.render(ctx);primaryRenderData&&(renderData[renderDataLen++]=primaryRenderData);for(let i=0,len=this._secondaryCursors.length;i<len;i++){const secondaryRenderData=this._secondaryCursors[i].render(ctx);secondaryRenderData&&(renderData[renderDataLen++]=secondaryRenderData)}this._renderData=renderData}getLastRenderData(){return this._renderData}}exports.ViewCursors=ViewCursors,ViewCursors.BLINK_INTERVAL=500,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const caret=theme.getColor(editorColorRegistry_1.editorCursorForeground);if(caret){let caretBackground=theme.getColor(editorColorRegistry_1.editorCursorBackground);caretBackground||(caretBackground=caret.opposite()),collector.addRule(`.monaco-editor .inputarea.ime-input { caret-color: ${caret}; }`),collector.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${caret}; border-color: ${caret}; color: ${caretBackground}; }`),"hc"===theme.type&&collector.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${caretBackground}; border-right: 1px solid ${caretBackground}; }`)}}))})),define(__m[658],__M([1,0,4,2,3,54,14]),(function(require,exports,event_1,lifecycle_1,range_1,editorColorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorizedBracketPairsDecorationProvider=void 0;class ColorizedBracketPairsDecorationProvider extends lifecycle_1.Disposable{constructor(textModel){super(),this.textModel=textModel,this.colorProvider=new ColorProvider,this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=textModel.getOptions().bracketPairColorizationOptions,this._register(textModel.bracketPairs.onDidChange((e=>{this.onDidChangeEmitter.fire()})))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(range,ownerId,filterOutValidation){if(void 0===ownerId)return[];if(!this.colorizationOptions.enabled)return[];const result=new Array,bracketsInRange=this.textModel.bracketPairs.getBracketsInRange(range);for(const bracket of bracketsInRange)result.push({id:`bracket${bracket.range.toString()}-${bracket.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(bracket)},ownerId:0,range:bracket.range});return result}getAllDecorations(ownerId,filterOutValidation){return void 0===ownerId?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new range_1.Range(1,1,this.textModel.getLineCount(),1),ownerId,filterOutValidation):[]}}exports.ColorizedBracketPairsDecorationProvider=ColorizedBracketPairsDecorationProvider;class ColorProvider{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(bracket){return bracket.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(bracket.nestingLevel)}getInlineClassNameOfLevel(level){return"bracket-highlighting-"+level%30}}(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const colors=[editorColorRegistry_1.editorBracketHighlightingForeground1,editorColorRegistry_1.editorBracketHighlightingForeground2,editorColorRegistry_1.editorBracketHighlightingForeground3,editorColorRegistry_1.editorBracketHighlightingForeground4,editorColorRegistry_1.editorBracketHighlightingForeground5,editorColorRegistry_1.editorBracketHighlightingForeground6],colorProvider=new ColorProvider;collector.addRule(`.monaco-editor .${colorProvider.unexpectedClosingBracketClassName} { color: ${theme.getColor(editorColorRegistry_1.editorBracketHighlightingUnexpectedBracketForeground)}; }`);const colorValues=colors.map((c=>theme.getColor(c))).filter((c=>!!c)).filter((c=>!c.isTransparent()));for(let level=0;level<30;level++){const color=colorValues[level%colorValues.length];collector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level)} { color: ${color}; }`)}}))})),define(__m[659],__M([1,0,79,2,50,14,54,48,3,45,4,23,49]),(function(require,exports,markers_1,lifecycle_1,model_1,themeService_1,editorColorRegistry_1,model_2,range_1,network_1,event_1,colorRegistry_1,map_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkerDecorationsService=void 0;class MarkerDecorations extends lifecycle_1.Disposable{constructor(model){super(),this.model=model,this._markersData=new Map,this._register((0,lifecycle_1.toDisposable)((()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()})))}update(markers,newDecorations){const oldIds=[...this._markersData.keys()];this._markersData.clear();const ids=this.model.deltaDecorations(oldIds,newDecorations);for(let index=0;index<ids.length;index++)this._markersData.set(ids[index],markers[index]);return 0!==oldIds.length||0!==ids.length}getMarker(decoration){return this._markersData.get(decoration.id)}}let MarkerDecorationsService=class MarkerDecorationsService extends lifecycle_1.Disposable{constructor(modelService,_markerService){super(),this._markerService=_markerService,this._onDidChangeMarker=this._register(new event_1.Emitter),this._markerDecorations=new map_1.ResourceMap,modelService.getModels().forEach((model=>this._onModelAdded(model))),this._register(modelService.onModelAdded(this._onModelAdded,this)),this._register(modelService.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach((value=>value.dispose())),this._markerDecorations.clear()}getMarker(uri,decoration){const markerDecorations=this._markerDecorations.get(uri);return markerDecorations&&markerDecorations.getMarker(decoration)||null}_handleMarkerChange(changedResources){changedResources.forEach((resource=>{const markerDecorations=this._markerDecorations.get(resource);markerDecorations&&this._updateDecorations(markerDecorations)}))}_onModelAdded(model){const markerDecorations=new MarkerDecorations(model);this._markerDecorations.set(model.uri,markerDecorations),this._updateDecorations(markerDecorations)}_onModelRemoved(model){const markerDecorations=this._markerDecorations.get(model.uri);markerDecorations&&(markerDecorations.dispose(),this._markerDecorations.delete(model.uri)),model.uri.scheme!==network_1.Schemas.inMemory&&model.uri.scheme!==network_1.Schemas.internal&&model.uri.scheme!==network_1.Schemas.vscode||this._markerService&&this._markerService.read({resource:model.uri}).map((marker=>marker.owner)).forEach((owner=>this._markerService.remove(owner,[model.uri])))}_updateDecorations(markerDecorations){const markers=this._markerService.read({resource:markerDecorations.model.uri,take:500}),newModelDecorations=markers.map((marker=>({range:this._createDecorationRange(markerDecorations.model,marker),options:this._createDecorationOption(marker)})));markerDecorations.update(markers,newModelDecorations)&&this._onDidChangeMarker.fire(markerDecorations.model)}_createDecorationRange(model,rawMarker){let ret=range_1.Range.lift(rawMarker);if(rawMarker.severity!==markers_1.MarkerSeverity.Hint||this._hasMarkerTag(rawMarker,1)||this._hasMarkerTag(rawMarker,2)||(ret=ret.setEndPosition(ret.startLineNumber,ret.startColumn+2)),ret=model.validateRange(ret),ret.isEmpty()){const maxColumn=model.getLineLastNonWhitespaceColumn(ret.startLineNumber)||model.getLineMaxColumn(ret.startLineNumber);if(1===maxColumn||ret.endColumn>=maxColumn)return ret;const word=model.getWordAtPosition(ret.getStartPosition());word&&(ret=new range_1.Range(ret.startLineNumber,word.startColumn,ret.endLineNumber,word.endColumn))}else if(rawMarker.endColumn===Number.MAX_VALUE&&1===rawMarker.startColumn&&ret.startLineNumber===ret.endLineNumber){let minColumn=model.getLineFirstNonWhitespaceColumn(rawMarker.startLineNumber);minColumn<ret.endColumn&&(ret=new range_1.Range(ret.startLineNumber,minColumn,ret.endLineNumber,ret.endColumn),rawMarker.startColumn=minColumn)}return ret}_createDecorationOption(marker){let className,color,zIndex,inlineClassName,minimap;switch(marker.severity){case markers_1.MarkerSeverity.Hint:className=this._hasMarkerTag(marker,2)?void 0:this._hasMarkerTag(marker,1)?"squiggly-unnecessary":"squiggly-hint",zIndex=0;break;case markers_1.MarkerSeverity.Warning:className="squiggly-warning",color=(0,themeService_1.themeColorFromId)(editorColorRegistry_1.overviewRulerWarning),zIndex=20,minimap={color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapWarning),position:model_1.MinimapPosition.Inline};break;case markers_1.MarkerSeverity.Info:className="squiggly-info",color=(0,themeService_1.themeColorFromId)(editorColorRegistry_1.overviewRulerInfo),zIndex=10;break;case markers_1.MarkerSeverity.Error:default:className="squiggly-error",color=(0,themeService_1.themeColorFromId)(editorColorRegistry_1.overviewRulerError),zIndex=30,minimap={color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapError),position:model_1.MinimapPosition.Inline}}return marker.tags&&(-1!==marker.tags.indexOf(1)&&(inlineClassName="squiggly-inline-unnecessary"),-1!==marker.tags.indexOf(2)&&(inlineClassName="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className,showIfCollapsed:!0,overviewRuler:{color,position:model_1.OverviewRulerLane.Right},minimap,zIndex,inlineClassName}}_hasMarkerTag(marker,tag){return!!marker.tags&&marker.tags.indexOf(tag)>=0}};MarkerDecorationsService=__decorate([__param(0,model_2.IModelService),__param(1,markers_1.IMarkerService)],MarkerDecorationsService),exports.MarkerDecorationsService=MarkerDecorationsService})),define(__m[287],__M([1,0,27,14,66,443,35]),(function(require,exports,languages_1,themeService_1,log_1,sparseMultilineTokens_1,language_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toMultilineTokens2=exports.SemanticTokensProviderStyling=void 0;let SemanticTokensProviderStyling=class SemanticTokensProviderStyling{constructor(_legend,_themeService,_languageService,_logService){this._legend=_legend,this._themeService=_themeService,this._languageService=_languageService,this._logService=_logService,this._hashTable=new HashTable,this._hasWarnedOverlappingTokens=!1}getMetadata(tokenTypeIndex,tokenModifierSet,languageId){const encodedLanguageId=this._languageService.languageIdCodec.encodeLanguageId(languageId),entry=this._hashTable.get(tokenTypeIndex,tokenModifierSet,encodedLanguageId);let metadata;if(entry)metadata=entry.metadata,this._logService.getLevel()===log_1.LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${tokenTypeIndex} / ${tokenModifierSet}: foreground ${languages_1.TokenMetadata.getForeground(metadata)}, fontStyle ${languages_1.TokenMetadata.getFontStyle(metadata).toString(2)}`);else{let tokenType=this._legend.tokenTypes[tokenTypeIndex];const tokenModifiers=[];if(tokenType){let modifierSet=tokenModifierSet;for(let modifierIndex=0;modifierSet>0&&modifierIndex<this._legend.tokenModifiers.length;modifierIndex++)1&modifierSet&&tokenModifiers.push(this._legend.tokenModifiers[modifierIndex]),modifierSet>>=1;modifierSet>0&&this._logService.getLevel()===log_1.LogLevel.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${tokenModifierSet.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),tokenModifiers.push("not-in-legend"));const tokenStyle=this._themeService.getColorTheme().getTokenStyleMetadata(tokenType,tokenModifiers,languageId);if(void 0===tokenStyle)metadata=2147483647;else{if(metadata=0,void 0!==tokenStyle.italic){metadata|=1|(tokenStyle.italic?1:0)<<10}if(void 0!==tokenStyle.bold){metadata|=2|(tokenStyle.bold?2:0)<<10}if(void 0!==tokenStyle.underline){metadata|=4|(tokenStyle.underline?4:0)<<10}if(void 0!==tokenStyle.strikethrough){metadata|=8|(tokenStyle.strikethrough?8:0)<<10}if(tokenStyle.foreground){metadata|=16|tokenStyle.foreground<<14}0===metadata&&(metadata=2147483647)}}else this._logService.getLevel()===log_1.LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${tokenTypeIndex} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),metadata=2147483647,tokenType="not-in-legend";this._hashTable.add(tokenTypeIndex,tokenModifierSet,encodedLanguageId,metadata),this._logService.getLevel()===log_1.LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${tokenTypeIndex} (${tokenType}) / ${tokenModifierSet} (${tokenModifiers.join(" ")}): foreground ${languages_1.TokenMetadata.getForeground(metadata)}, fontStyle ${languages_1.TokenMetadata.getFontStyle(metadata).toString(2)}`)}return metadata}warnOverlappingSemanticTokens(lineNumber,startColumn){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${lineNumber}, column ${startColumn}`))}};SemanticTokensProviderStyling=__decorate([__param(1,themeService_1.IThemeService),__param(2,language_1.ILanguageService),__param(3,log_1.ILogService)],SemanticTokensProviderStyling),exports.SemanticTokensProviderStyling=SemanticTokensProviderStyling,exports.toMultilineTokens2=function toMultilineTokens2(tokens,styling,languageId){const srcData=tokens.data,tokenCount=tokens.data.length/5|0,tokensPerArea=Math.max(Math.ceil(tokenCount/1024),400),result=[];let tokenIndex=0,lastLineNumber=1,lastStartCharacter=0;for(;tokenIndex<tokenCount;){const tokenStartIndex=tokenIndex;let tokenEndIndex=Math.min(tokenStartIndex+tokensPerArea,tokenCount);if(tokenEndIndex<tokenCount){let smallTokenEndIndex=tokenEndIndex;for(;smallTokenEndIndex-1>tokenStartIndex&&0===srcData[5*smallTokenEndIndex];)smallTokenEndIndex--;if(smallTokenEndIndex-1===tokenStartIndex){let bigTokenEndIndex=tokenEndIndex;for(;bigTokenEndIndex+1<tokenCount&&0===srcData[5*bigTokenEndIndex];)bigTokenEndIndex++;tokenEndIndex=bigTokenEndIndex}else tokenEndIndex=smallTokenEndIndex}let destData=new Uint32Array(4*(tokenEndIndex-tokenStartIndex)),destOffset=0,areaLine=0,prevLineNumber=0,prevStartCharacter=0,prevEndCharacter=0;for(;tokenIndex<tokenEndIndex;){const srcOffset=5*tokenIndex,deltaLine=srcData[srcOffset],deltaCharacter=srcData[srcOffset+1],lineNumber=lastLineNumber+deltaLine|0,startCharacter=0===deltaLine?lastStartCharacter+deltaCharacter|0:deltaCharacter,length=srcData[srcOffset+2],tokenTypeIndex=srcData[srcOffset+3],tokenModifierSet=srcData[srcOffset+4],metadata=styling.getMetadata(tokenTypeIndex,tokenModifierSet,languageId);2147483647!==metadata&&(0===areaLine&&(areaLine=lineNumber),prevLineNumber===lineNumber&&prevEndCharacter>startCharacter&&(styling.warnOverlappingSemanticTokens(lineNumber,startCharacter+1),prevStartCharacter<startCharacter?destData[destOffset-4+2]=startCharacter:destOffset-=4),destData[destOffset]=lineNumber-areaLine,destData[destOffset+1]=startCharacter,destData[destOffset+2]=startCharacter+length,destData[destOffset+3]=metadata,destOffset+=4,prevLineNumber=lineNumber,prevStartCharacter=startCharacter,prevEndCharacter=startCharacter+length),lastLineNumber=lineNumber,lastStartCharacter=startCharacter,tokenIndex++}destOffset!==destData.length&&(destData=destData.subarray(0,destOffset));const tokens=sparseMultilineTokens_1.SparseMultilineTokens.create(areaLine,destData);result.push(tokens)}return result};class HashTableEntry{constructor(tokenTypeIndex,tokenModifierSet,languageId,metadata){this.tokenTypeIndex=tokenTypeIndex,this.tokenModifierSet=tokenModifierSet,this.languageId=languageId,this.metadata=metadata,this.next=null}}class HashTable{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(entries,length){for(let i=0;i<length;i++)entries[i]=null}_hash2(n1,n2){return(n1<<5)-n1+n2|0}_hashFunc(tokenTypeIndex,tokenModifierSet,languageId){return this._hash2(this._hash2(tokenTypeIndex,tokenModifierSet),languageId)%this._currentLength}get(tokenTypeIndex,tokenModifierSet,languageId){const hash=this._hashFunc(tokenTypeIndex,tokenModifierSet,languageId);let p=this._elements[hash];for(;p;){if(p.tokenTypeIndex===tokenTypeIndex&&p.tokenModifierSet===tokenModifierSet&&p.languageId===languageId)return p;p=p.next}return null}add(tokenTypeIndex,tokenModifierSet,languageId,metadata){if(this._elementsCount++,0!==this._growCount&&this._elementsCount>=this._growCount){const oldElements=this._elements;this._currentLengthIndex++,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength);for(const first of oldElements){let p=first;for(;p;){const oldNext=p.next;p.next=null,this._add(p),p=oldNext}}}this._add(new HashTableEntry(tokenTypeIndex,tokenModifierSet,languageId,metadata))}_add(element){const hash=this._hashFunc(element.tokenTypeIndex,element.tokenModifierSet,element.languageId);element.next=this._elements[hash],this._elements[hash]=element}}HashTable._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143]})),define(__m[660],__M([1,0,7,98,60,28,4,2,184,529,43,23,14,373]),(function(require,exports,dom,globalMouseMoveMonitor_1,touch_1,codicons_1,event_1,lifecycle_1,utils_1,nls,keybinding_1,colorRegistry_1,themeService_1){"use strict";var LightBulbState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LightBulbWidget=void 0,function(LightBulbState){LightBulbState.Hidden={type:0};LightBulbState.Showing=class Showing{constructor(actions,trigger,editorPosition,widgetPosition){this.actions=actions,this.trigger=trigger,this.editorPosition=editorPosition,this.widgetPosition=widgetPosition,this.type=1}}}(LightBulbState||(LightBulbState={}));let LightBulbWidget=class LightBulbWidget extends lifecycle_1.Disposable{constructor(_editor,_quickFixActionId,_preferredFixActionId,_keybindingService){super(),this._editor=_editor,this._quickFixActionId=_quickFixActionId,this._preferredFixActionId=_preferredFixActionId,this._keybindingService=_keybindingService,this._onClick=this._register(new event_1.Emitter),this.onClick=this._onClick.event,this._state=LightBulbState.Hidden,this._domNode=document.createElement("div"),this._domNode.className=codicons_1.Codicon.lightBulb.classNames,this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent((_=>{const editorModel=this._editor.getModel();(1!==this.state.type||!editorModel||this.state.editorPosition.lineNumber>=editorModel.getLineCount())&&this.hide()}))),touch_1.Gesture.ignoreTarget(this._domNode),this._register(dom.addStandardDisposableGenericMouseDownListener(this._domNode,(e=>{if(1!==this.state.type)return;this._editor.focus(),e.preventDefault();const{top,height}=dom.getDomNodePagePosition(this._domNode),lineHeight=this._editor.getOption(59);let pad=Math.floor(lineHeight/3);null!==this.state.widgetPosition.position&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(pad+=lineHeight),this._onClick.fire({x:e.posx,y:top+height+pad,actions:this.state.actions,trigger:this.state.trigger})}))),this._register(dom.addDisposableListener(this._domNode,"mouseenter",(e=>{if(1!=(1&e.buttons))return;this.hide();const monitor=new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor;monitor.startMonitoring(e.target,e.buttons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(()=>{}),(()=>{monitor.dispose()}))}))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(57)&&!this._editor.getOption(57).enabled&&this.hide()}))),this._updateLightBulbTitleAndIcon(),this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon,this))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return 1===this._state.type?this._state.widgetPosition:null}update(actions,trigger,atPosition){if(actions.validActions.length<=0)return this.hide();const options=this._editor.getOptions();if(!options.get(57).enabled)return this.hide();const model=this._editor.getModel();if(!model)return this.hide();const{lineNumber,column}=model.validatePosition(atPosition),tabSize=model.getOptions().tabSize,fontInfo=options.get(44),lineContent=model.getLineContent(lineNumber),indent=(0,utils_1.computeIndentLevel)(lineContent,tabSize),isFolded=lineNumber=>lineNumber>2&&this._editor.getTopForLineNumber(lineNumber)===this._editor.getTopForLineNumber(lineNumber-1);let effectiveLineNumber=lineNumber;if(!(fontInfo.spaceWidth*indent>22))if(lineNumber>1&&!isFolded(lineNumber-1))effectiveLineNumber-=1;else if(isFolded(lineNumber+1)){if(column*fontInfo.spaceWidth<22)return this.hide()}else effectiveLineNumber+=1;this.state=new LightBulbState.Showing(actions,trigger,atPosition,{position:{lineNumber:effectiveLineNumber,column:1},preference:LightBulbWidget._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state=LightBulbState.Hidden,this._editor.layoutContentWidget(this)}get state(){return this._state}set state(value){this._state=value,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(1===this.state.type&&this.state.actions.hasAutoFix){this._domNode.classList.remove(...codicons_1.Codicon.lightBulb.classNamesArray),this._domNode.classList.add(...codicons_1.Codicon.lightbulbAutofix.classNamesArray);const preferredKb=this._keybindingService.lookupKeybinding(this._preferredFixActionId);if(preferredKb)return void(this.title=nls.localize(0,null,preferredKb.getLabel()))}this._domNode.classList.remove(...codicons_1.Codicon.lightbulbAutofix.classNamesArray),this._domNode.classList.add(...codicons_1.Codicon.lightBulb.classNamesArray);const kb=this._keybindingService.lookupKeybinding(this._quickFixActionId);this.title=kb?nls.localize(1,null,kb.getLabel()):nls.localize(2,null)}set title(value){this._domNode.title=value}};LightBulbWidget._posPref=[0],LightBulbWidget=__decorate([__param(3,keybinding_1.IKeybindingService)],LightBulbWidget),exports.LightBulbWidget=LightBulbWidget,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{var _a;const editorBackgroundColor=null===(_a=theme.getColor(colorRegistry_1.editorBackground))||void 0===_a?void 0:_a.transparent(.7),editorLightBulbForegroundColor=theme.getColor(colorRegistry_1.editorLightBulbForeground);editorLightBulbForegroundColor&&collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${codicons_1.Codicon.lightBulb.cssSelector} {\n\t\t\tcolor: ${editorLightBulbForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`);const editorLightBulbAutoFixForegroundColor=theme.getColor(colorRegistry_1.editorLightBulbAutoFixForeground);editorLightBulbAutoFixForegroundColor&&collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${codicons_1.Codicon.lightbulbAutofix.cssSelector} {\n\t\t\tcolor: ${editorLightBulbAutoFixForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`)}))})),define(__m[661],__M([1,0,34,7,98,62,30,4,2,531,23,14,375]),(function(require,exports,browser_1,dom,globalMouseMoveMonitor_1,widget_1,color_1,event_1,lifecycle_1,nls_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorPickerWidget=exports.ColorPickerBody=exports.ColorPickerHeader=void 0;const $=dom.$;class ColorPickerHeader extends lifecycle_1.Disposable{constructor(container,model,themeService){super(),this.model=model,this.domNode=$(".colorpicker-header"),dom.append(container,this.domNode),this.pickedColorNode=dom.append(this.domNode,$(".picked-color"));const tooltip=(0,nls_1.localize)(0,null);this.pickedColorNode.setAttribute("title",tooltip);const colorBox=dom.append(this.domNode,$(".original-color"));colorBox.style.backgroundColor=color_1.Color.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=themeService.getColorTheme().getColor(colorRegistry_1.editorHoverBackground)||color_1.Color.white,this._register((0,themeService_1.registerThemingParticipant)(((theme,collector)=>{this.backgroundColor=theme.getColor(colorRegistry_1.editorHoverBackground)||color_1.Color.white}))),this._register(dom.addDisposableListener(this.pickedColorNode,dom.EventType.CLICK,(()=>this.model.selectNextColorPresentation()))),this._register(dom.addDisposableListener(colorBox,dom.EventType.CLICK,(()=>{this.model.color=this.model.originalColor,this.model.flushColor()}))),this._register(model.onDidChangeColor(this.onDidChangeColor,this)),this._register(model.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=color_1.Color.Format.CSS.format(model.color)||"",this.pickedColorNode.classList.toggle("light",model.color.rgba.a<.5?this.backgroundColor.isLighter():model.color.isLighter()),this.onDidChangeColor(this.model.color)}onDidChangeColor(color){this.pickedColorNode.style.backgroundColor=color_1.Color.Format.CSS.format(color)||"",this.pickedColorNode.classList.toggle("light",color.rgba.a<.5?this.backgroundColor.isLighter():color.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:"",this.pickedColorNode.prepend($(".codicon.codicon-color-mode"))}}exports.ColorPickerHeader=ColorPickerHeader;class ColorPickerBody extends lifecycle_1.Disposable{constructor(container,model,pixelRatio){super(),this.model=model,this.pixelRatio=pixelRatio,this.domNode=$(".colorpicker-body"),dom.append(container,this.domNode),this.saturationBox=new SaturationBox(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new OpacityStrip(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new HueStrip(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s,v}){const hsva=this.model.color.hsva;this.model.color=new color_1.Color(new color_1.HSVA(hsva.h,s,v,hsva.a))}onDidOpacityChange(a){const hsva=this.model.color.hsva;this.model.color=new color_1.Color(new color_1.HSVA(hsva.h,hsva.s,hsva.v,a))}onDidHueChange(value){const hsva=this.model.color.hsva,h=360*(1-value);this.model.color=new color_1.Color(new color_1.HSVA(360===h?0:h,hsva.s,hsva.v,hsva.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}}exports.ColorPickerBody=ColorPickerBody;class SaturationBox extends lifecycle_1.Disposable{constructor(container,model,pixelRatio){super(),this.model=model,this.pixelRatio=pixelRatio,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new event_1.Emitter,this.onColorFlushed=this._onColorFlushed.event,this.domNode=$(".saturation-wrap"),dom.append(container,this.domNode),this.canvas=document.createElement("canvas"),this.canvas.className="saturation-box",dom.append(this.domNode,this.canvas),this.selection=$(".saturation-selection"),dom.append(this.domNode,this.selection),this.layout(),this._register(dom.addDisposableGenericMouseDownListener(this.domNode,(e=>this.onMouseDown(e)))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor);const origin=dom.getDomNodePagePosition(this.domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.buttons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(event=>this.onDidChangePosition(event.posx-origin.left,event.posy-origin.top)),(()=>null));const mouseUpListener=dom.addDisposableGenericMouseUpListener(document,(()=>{this._onColorFlushed.fire(),mouseUpListener.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)}),!0)}onDidChangePosition(left,top){const s=Math.max(0,Math.min(1,left/this.width)),v=Math.max(0,Math.min(1,1-top/this.height));this.paintSelection(s,v),this._onDidChange.fire({s,v})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint();const hsva=this.model.color.hsva;this.paintSelection(hsva.s,hsva.v)}paint(){const hsva=this.model.color.hsva,saturatedColor=new color_1.Color(new color_1.HSVA(hsva.h,1,1,1)),ctx=this.canvas.getContext("2d"),whiteGradient=ctx.createLinearGradient(0,0,this.canvas.width,0);whiteGradient.addColorStop(0,"rgba(255, 255, 255, 1)"),whiteGradient.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),whiteGradient.addColorStop(1,"rgba(255, 255, 255, 0)");const blackGradient=ctx.createLinearGradient(0,0,0,this.canvas.height);blackGradient.addColorStop(0,"rgba(0, 0, 0, 0)"),blackGradient.addColorStop(1,"rgba(0, 0, 0, 1)"),ctx.rect(0,0,this.canvas.width,this.canvas.height),ctx.fillStyle=color_1.Color.Format.CSS.format(saturatedColor),ctx.fill(),ctx.fillStyle=whiteGradient,ctx.fill(),ctx.fillStyle=blackGradient,ctx.fill()}paintSelection(s,v){this.selection.style.left=s*this.width+"px",this.selection.style.top=this.height-v*this.height+"px"}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class Strip extends lifecycle_1.Disposable{constructor(container,model){super(),this.model=model,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new event_1.Emitter,this.onColorFlushed=this._onColorFlushed.event,this.domNode=dom.append(container,$(".strip")),this.overlay=dom.append(this.domNode,$(".overlay")),this.slider=dom.append(this.domNode,$(".slider")),this.slider.style.top="0px",this._register(dom.addDisposableGenericMouseDownListener(this.domNode,(e=>this.onMouseDown(e)))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const value=this.getValue(this.model.color);this.updateSliderPosition(value)}onMouseDown(e){const monitor=this._register(new globalMouseMoveMonitor_1.GlobalMouseMoveMonitor),origin=dom.getDomNodePagePosition(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),monitor.startMonitoring(e.target,e.buttons,globalMouseMoveMonitor_1.standardMouseMoveMerger,(event=>this.onDidChangeTop(event.posy-origin.top)),(()=>null));const mouseUpListener=dom.addDisposableGenericMouseUpListener(document,(()=>{this._onColorFlushed.fire(),mouseUpListener.dispose(),monitor.stopMonitoring(!0),this.domNode.classList.remove("grabbing")}),!0)}onDidChangeTop(top){const value=Math.max(0,Math.min(1,1-top/this.height));this.updateSliderPosition(value),this._onDidChange.fire(value)}updateSliderPosition(value){this.slider.style.top=(1-value)*this.height+"px"}}class OpacityStrip extends Strip{constructor(container,model){super(container,model),this.domNode.classList.add("opacity-strip"),this._register(model.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(color){const{r,g,b}=color.rgba,opaque=new color_1.Color(new color_1.RGBA(r,g,b,1)),transparent=new color_1.Color(new color_1.RGBA(r,g,b,0));this.overlay.style.background=`linear-gradient(to bottom, ${opaque} 0%, ${transparent} 100%)`}getValue(color){return color.hsva.a}}class HueStrip extends Strip{constructor(container,model){super(container,model),this.domNode.classList.add("hue-strip")}getValue(color){return 1-color.hsva.h/360}}class ColorPickerWidget extends widget_1.Widget{constructor(container,model,pixelRatio,themeService){super(),this.model=model,this.pixelRatio=pixelRatio,this._register(browser_1.PixelRatio.onDidChange((()=>this.layout())));const element=$(".colorpicker-widget");container.appendChild(element);const header=new ColorPickerHeader(element,this.model,themeService);this.body=new ColorPickerBody(element,this.model,this.pixelRatio),this._register(header),this._register(this.body)}layout(){this.body.layout()}}exports.ColorPickerWidget=ColorPickerWidget})),define(__m[662],__M([1,0,7,226,220,195,75,173,2,42,56,548,9,43,131,134,14,129]),(function(require,exports,dom,countBadge_1,highlightedLabel_1,iconLabel_1,filters_1,labels_1,lifecycle_1,resources_1,resolverService_1,nls_1,instantiation_1,keybinding_1,label_1,styler_1,themeService_1,referencesModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessibilityProvider=exports.OneReferenceRenderer=exports.FileReferencesRenderer=exports.IdentityProvider=exports.StringRepresentationProvider=exports.Delegate=exports.DataSource=void 0;let DataSource=class DataSource{constructor(_resolverService){this._resolverService=_resolverService}hasChildren(element){return element instanceof referencesModel_1.ReferencesModel||element instanceof referencesModel_1.FileReferences}getChildren(element){if(element instanceof referencesModel_1.ReferencesModel)return element.groups;if(element instanceof referencesModel_1.FileReferences)return element.resolve(this._resolverService).then((val=>val.children));throw new Error("bad tree")}};DataSource=__decorate([__param(0,resolverService_1.ITextModelService)],DataSource),exports.DataSource=DataSource;exports.Delegate=class Delegate{getHeight(){return 23}getTemplateId(element){return element instanceof referencesModel_1.FileReferences?FileReferencesRenderer.id:OneReferenceRenderer.id}};let StringRepresentationProvider=class StringRepresentationProvider{constructor(_keybindingService){this._keybindingService=_keybindingService}getKeyboardNavigationLabel(element){var _a;if(element instanceof referencesModel_1.OneReference){const parts=null===(_a=element.parent.getPreview(element))||void 0===_a?void 0:_a.preview(element.range);if(parts)return parts.value}return(0,resources_1.basename)(element.uri)}};StringRepresentationProvider=__decorate([__param(0,keybinding_1.IKeybindingService)],StringRepresentationProvider),exports.StringRepresentationProvider=StringRepresentationProvider;exports.IdentityProvider=class IdentityProvider{getId(element){return element instanceof referencesModel_1.OneReference?element.id:element.uri}};let FileReferencesTemplate=class FileReferencesTemplate extends lifecycle_1.Disposable{constructor(container,_uriLabel,themeService){super(),this._uriLabel=_uriLabel;const parent=document.createElement("div");parent.classList.add("reference-file"),this.file=this._register(new iconLabel_1.IconLabel(parent,{supportHighlights:!0})),this.badge=new countBadge_1.CountBadge(dom.append(parent,dom.$(".count"))),this._register((0,styler_1.attachBadgeStyler)(this.badge,themeService)),container.appendChild(parent)}set(element,matches){let parent=(0,resources_1.dirname)(element.uri);this.file.setLabel((0,labels_1.getBaseLabel)(element.uri),this._uriLabel.getUriLabel(parent,{relative:!0}),{title:this._uriLabel.getUriLabel(element.uri),matches});const len=element.children.length;this.badge.setCount(len),len>1?this.badge.setTitleFormat((0,nls_1.localize)(0,null,len)):this.badge.setTitleFormat((0,nls_1.localize)(1,null,len))}};FileReferencesTemplate=__decorate([__param(1,label_1.ILabelService),__param(2,themeService_1.IThemeService)],FileReferencesTemplate);let FileReferencesRenderer=class FileReferencesRenderer{constructor(_instantiationService){this._instantiationService=_instantiationService,this.templateId=FileReferencesRenderer.id}renderTemplate(container){return this._instantiationService.createInstance(FileReferencesTemplate,container)}renderElement(node,index,template){template.set(node.element,(0,filters_1.createMatches)(node.filterData))}disposeTemplate(templateData){templateData.dispose()}};FileReferencesRenderer.id="FileReferencesRenderer",FileReferencesRenderer=__decorate([__param(0,instantiation_1.IInstantiationService)],FileReferencesRenderer),exports.FileReferencesRenderer=FileReferencesRenderer;class OneReferenceTemplate{constructor(container){this.label=new highlightedLabel_1.HighlightedLabel(container)}set(element,score){var _a;const preview=null===(_a=element.parent.getPreview(element))||void 0===_a?void 0:_a.preview(element.range);if(preview&&preview.value){const{value,highlight}=preview;score&&!filters_1.FuzzyScore.isDefault(score)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(value,(0,filters_1.createMatches)(score))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(value,[highlight]))}else this.label.set(`${(0,resources_1.basename)(element.uri)}:${element.range.startLineNumber+1}:${element.range.startColumn+1}`)}}class OneReferenceRenderer{constructor(){this.templateId=OneReferenceRenderer.id}renderTemplate(container){return new OneReferenceTemplate(container)}renderElement(node,index,templateData){templateData.set(node.element,node.filterData)}disposeTemplate(){}}exports.OneReferenceRenderer=OneReferenceRenderer,OneReferenceRenderer.id="OneReferenceRenderer";exports.AccessibilityProvider=class AccessibilityProvider{getWidgetAriaLabel(){return(0,nls_1.localize)(2,null)}getAriaLabel(element){return element.ariaMessage}}})),define(__m[663],__M([1,0,7,2,8,64,32,77,11,3,93,35,54,154,126,9,14,382]),(function(require,exports,dom,lifecycle_1,strings,domFontInfo_1,editorOptions_1,lineTokens_1,position_1,range_1,stringBuilder_1,language_1,editorColorRegistry_1,lineDecorations_1,viewLineRenderer_1,instantiation_1,themeService_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.GhostTextWidget=void 0;const ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("editorGhostText",{createHTML:value=>value});let GhostTextWidget=class GhostTextWidget extends lifecycle_1.Disposable{constructor(editor,model,instantiationService,languageService){super(),this.editor=editor,this.model=model,this.instantiationService=instantiationService,this.languageService=languageService,this.disposed=!1,this.partsWidget=this._register(this.instantiationService.createInstance(DecorationsWidget,this.editor)),this.additionalLinesWidget=this._register(new AdditionalLinesWidget(this.editor,this.languageService.languageIdCodec)),this.viewMoreContentWidget=void 0,this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(29)||e.hasChanged(105)||e.hasChanged(88)||e.hasChanged(83)||e.hasChanged(45)||e.hasChanged(44)||e.hasChanged(59))&&this.update()}))),this._register((0,lifecycle_1.toDisposable)((()=>{var _a;this.disposed=!0,this.update(),null===(_a=this.viewMoreContentWidget)||void 0===_a||_a.dispose(),this.viewMoreContentWidget=void 0}))),this._register(model.onDidChange((()=>{this.update()}))),this.update()}shouldShowHoverAtViewZone(viewZoneId){return this.additionalLinesWidget.viewZoneId===viewZoneId}update(){var _a;const ghostText=this.model.ghostText;if(!this.editor.hasModel()||!ghostText||this.disposed)return this.partsWidget.clear(),void this.additionalLinesWidget.clear();const inlineTexts=new Array,additionalLines=new Array;function addToAdditionalLines(lines,className){if(additionalLines.length>0){const lastLine=additionalLines[additionalLines.length-1];className&&lastLine.decorations.push(new lineDecorations_1.LineDecoration(lastLine.content.length+1,lastLine.content.length+1+lines[0].length,className,0)),lastLine.content+=lines[0],lines=lines.slice(1)}for(const line of lines)additionalLines.push({content:line,decorations:className?[new lineDecorations_1.LineDecoration(1,line.length+1,className,0)]:[]})}const textBufferLine=this.editor.getModel().getLineContent(ghostText.lineNumber);let hiddenTextStartColumn;this.editor.getModel().getLineTokens(ghostText.lineNumber);let lastIdx=0;for(const part of ghostText.parts){let lines=part.lines;void 0===hiddenTextStartColumn?(inlineTexts.push({column:part.column,text:lines[0],preview:part.preview}),lines=lines.slice(1)):addToAdditionalLines([textBufferLine.substring(lastIdx,part.column-1)],void 0),lines.length>0&&(addToAdditionalLines(lines,"ghost-text"),void 0===hiddenTextStartColumn&&part.column<=textBufferLine.length&&(hiddenTextStartColumn=part.column)),lastIdx=part.column-1}void 0!==hiddenTextStartColumn&&addToAdditionalLines([textBufferLine.substring(lastIdx)],void 0),this.partsWidget.setParts(ghostText.lineNumber,inlineTexts,void 0!==hiddenTextStartColumn?{column:hiddenTextStartColumn,length:textBufferLine.length+1-hiddenTextStartColumn}:void 0),this.additionalLinesWidget.updateLines(ghostText.lineNumber,additionalLines,ghostText.additionalReservedLineCount),ghostText.parts.some((p=>p.lines.length<0))?this.viewMoreContentWidget=this.renderViewMoreLines(new position_1.Position(ghostText.lineNumber,this.editor.getModel().getLineMaxColumn(ghostText.lineNumber)),"",0):(null===(_a=this.viewMoreContentWidget)||void 0===_a||_a.dispose(),this.viewMoreContentWidget=void 0)}renderViewMoreLines(position,firstLineText,remainingLinesLength){const fontInfo=this.editor.getOption(44),domNode=document.createElement("div");domNode.className="suggest-preview-additional-widget",(0,domFontInfo_1.applyFontInfo)(domNode,fontInfo);const spacer=document.createElement("span");spacer.className="content-spacer",spacer.append(firstLineText),domNode.append(spacer);const newline=document.createElement("span");newline.className="content-newline suggest-preview-text",newline.append("⏎  "),domNode.append(newline);const disposableStore=new lifecycle_1.DisposableStore,button=document.createElement("div");return button.className="button suggest-preview-text",button.append(`+${remainingLinesLength} lines…`),disposableStore.add(dom.addStandardDisposableListener(button,"mousedown",(e=>{var _a;null===(_a=this.model)||void 0===_a||_a.setExpanded(!0),e.preventDefault(),this.editor.focus()}))),domNode.append(button),new ViewMoreLinesContentWidget(this.editor,position,domNode,disposableStore)}};GhostTextWidget=__decorate([__param(2,instantiation_1.IInstantiationService),__param(3,language_1.ILanguageService)],GhostTextWidget),exports.GhostTextWidget=GhostTextWidget;class DecorationsWidget{constructor(editor){this.editor=editor,this.decorationIds=[],this.disposableStore=new lifecycle_1.DisposableStore}dispose(){this.clear(),this.disposableStore.dispose()}clear(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}setParts(lineNumber,parts,hiddenText){this.disposableStore.clear();if(!this.editor.getModel())return;const hiddenTextDecorations=new Array;hiddenText&&hiddenTextDecorations.push({range:range_1.Range.fromPositions(new position_1.Position(lineNumber,hiddenText.column),new position_1.Position(lineNumber,hiddenText.column+hiddenText.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}}),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,parts.map((p=>({range:range_1.Range.fromPositions(new position_1.Position(lineNumber,p.column)),options:{description:"ghost-text",after:{content:p.text,inlineClassName:p.preview?"ghost-text-decoration-preview":"ghost-text-decoration"},showIfCollapsed:!0}}))).concat(hiddenTextDecorations))}}class AdditionalLinesWidget{constructor(editor,languageIdCodec){this.editor=editor,this.languageIdCodec=languageIdCodec,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones((changeAccessor=>{this._viewZoneId&&(changeAccessor.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(lineNumber,additionalLines,minReservedLineCount){const textModel=this.editor.getModel();if(!textModel)return;const{tabSize}=textModel.getOptions();this.editor.changeViewZones((changeAccessor=>{this._viewZoneId&&(changeAccessor.removeZone(this._viewZoneId),this._viewZoneId=void 0);const heightInLines=Math.max(additionalLines.length,minReservedLineCount);if(heightInLines>0){const domNode=document.createElement("div");!function renderLines(domNode,tabSize,lines,opts,languageIdCodec){const disableMonospaceOptimizations=opts.get(29),stopRenderingLineAfter=opts.get(105),renderWhitespace="none",renderControlCharacters=opts.get(83),fontLigatures=opts.get(45),fontInfo=opts.get(44),lineHeight=opts.get(59),sb=(0,stringBuilder_1.createStringBuilder)(1e4);sb.appendASCIIString('<div class="suggest-preview-text">');for(let i=0,len=lines.length;i<len;i++){const lineData=lines[i],line=lineData.content;sb.appendASCIIString('<div class="view-line'),sb.appendASCIIString('" style="top:'),sb.appendASCIIString(String(i*lineHeight)),sb.appendASCIIString('px;width:1000000px;">');const isBasicASCII=strings.isBasicASCII(line),containsRTL=strings.containsRTL(line),lineTokens=lineTokens_1.LineTokens.createEmpty(line,languageIdCodec);(0,viewLineRenderer_1.renderViewLine)(new viewLineRenderer_1.RenderLineInput(fontInfo.isMonospace&&!disableMonospaceOptimizations,fontInfo.canUseHalfwidthRightwardsArrow,line,!1,isBasicASCII,containsRTL,0,lineTokens,lineData.decorations,tabSize,0,fontInfo.spaceWidth,fontInfo.middotWidth,fontInfo.wsmiddotWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures!==editorOptions_1.EditorFontLigatures.OFF,null),sb),sb.appendASCIIString("</div>")}sb.appendASCIIString("</div>"),(0,domFontInfo_1.applyFontInfo)(domNode,fontInfo);const html=sb.build(),trustedhtml=ttPolicy?ttPolicy.createHTML(html):html;domNode.innerHTML=trustedhtml}(domNode,tabSize,additionalLines,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=changeAccessor.addZone({afterLineNumber:lineNumber,heightInLines,domNode,afterColumnAffinity:1})}}))}}class ViewMoreLinesContentWidget extends lifecycle_1.Disposable{constructor(editor,position,domNode,disposableStore){super(),this.editor=editor,this.position=position,this.domNode=domNode,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(disposableStore),this._register((0,lifecycle_1.toDisposable)((()=>{this.editor.removeContentWidget(this)}))),this.editor.addContentWidget(this)}getId(){return"editor.widget.viewMoreLinesWidget"}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}}(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const foreground=theme.getColor(editorColorRegistry_1.ghostTextForeground);foreground&&(collector.addRule(`.monaco-editor .ghost-text-decoration { color: ${foreground.toString()} !important; }`),collector.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${foreground.toString()} !important; }`),collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { color: ${foreground.toString()} !important; }`));const background=theme.getColor(editorColorRegistry_1.ghostTextBackground);background&&(collector.addRule(`.monaco-editor .ghost-text-decoration { background-color: ${background.toString()}; }`),collector.addRule(`.monaco-editor .ghost-text-decoration-preview { background-color: ${background.toString()}; }`),collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { background-color: ${background.toString()}; }`));const border=theme.getColor(editorColorRegistry_1.ghostTextBorder);border&&(collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${border}; }`),collector.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${border}; }`),collector.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${border}; }`))}))})),define(__m[288],__M([1,0,91,2,19,150,50,54,14]),(function(require,exports,functional_1,lifecycle_1,types_1,editorBrowser_1,model_1,editorColorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractEditorNavigationQuickAccessProvider=void 0;exports.AbstractEditorNavigationQuickAccessProvider=class AbstractEditorNavigationQuickAccessProvider{constructor(options){this.options=options,this.rangeHighlightDecorationId=void 0}provide(picker,token){var _a;const disposables=new lifecycle_1.DisposableStore;picker.canAcceptInBackground=!!(null===(_a=this.options)||void 0===_a?void 0:_a.canAcceptInBackground),picker.matchOnLabel=picker.matchOnDescription=picker.matchOnDetail=picker.sortByLabel=!1;const pickerDisposable=disposables.add(new lifecycle_1.MutableDisposable);return pickerDisposable.value=this.doProvide(picker,token),disposables.add(this.onDidActiveTextEditorControlChange((()=>{pickerDisposable.value=void 0,pickerDisposable.value=this.doProvide(picker,token)}))),disposables}doProvide(picker,token){const disposables=new lifecycle_1.DisposableStore,editor=this.activeTextEditorControl;if(editor&&this.canProvideWithTextEditor(editor)){const context={editor},codeEditor=(0,editorBrowser_1.getCodeEditor)(editor);if(codeEditor){let lastKnownEditorViewState=(0,types_1.withNullAsUndefined)(editor.saveViewState());disposables.add(codeEditor.onDidChangeCursorPosition((()=>{lastKnownEditorViewState=(0,types_1.withNullAsUndefined)(editor.saveViewState())}))),context.restoreViewState=()=>{lastKnownEditorViewState&&editor===this.activeTextEditorControl&&editor.restoreViewState(lastKnownEditorViewState)},disposables.add((0,functional_1.once)(token.onCancellationRequested)((()=>{var _a;return null===(_a=context.restoreViewState)||void 0===_a?void 0:_a.call(context)})))}disposables.add((0,lifecycle_1.toDisposable)((()=>this.clearDecorations(editor)))),disposables.add(this.provideWithTextEditor(context,picker,token))}else disposables.add(this.provideWithoutTextEditor(picker,token));return disposables}canProvideWithTextEditor(editor){return!0}gotoLocation({editor},options){editor.setSelection(options.range),editor.revealRangeInCenter(options.range,0),options.preserveFocus||editor.focus()}getModel(editor){var _a;return(0,editorBrowser_1.isDiffEditor)(editor)?null===(_a=editor.getModel())||void 0===_a?void 0:_a.modified:editor.getModel()}addDecorations(editor,range){editor.changeDecorations((changeAccessor=>{const deleteDecorations=[];this.rangeHighlightDecorationId&&(deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const newDecorations=[{range,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:(0,themeService_1.themeColorFromId)(editorColorRegistry_1.overviewRulerRangeHighlight),position:model_1.OverviewRulerLane.Full}}}],[rangeHighlightId,overviewRulerDecorationId]=changeAccessor.deltaDecorations(deleteDecorations,newDecorations);this.rangeHighlightDecorationId={rangeHighlightId,overviewRulerDecorationId}}))}clearDecorations(editor){const rangeHighlightDecorationId=this.rangeHighlightDecorationId;rangeHighlightDecorationId&&(editor.changeDecorations((changeAccessor=>{changeAccessor.deltaDecorations([rangeHighlightDecorationId.overviewRulerDecorationId,rangeHighlightDecorationId.rangeHighlightId],[])})),this.rangeHighlightDecorationId=void 0)}}})),define(__m[664],__M([1,0,2,150,288,569]),(function(require,exports,lifecycle_1,editorBrowser_1,editorNavigationQuickAccess_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractGotoLineQuickAccessProvider=void 0;class AbstractGotoLineQuickAccessProvider extends editorNavigationQuickAccess_1.AbstractEditorNavigationQuickAccessProvider{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(picker){const label=(0,nls_1.localize)(0,null);return picker.items=[{label}],picker.ariaLabel=label,lifecycle_1.Disposable.None}provideWithTextEditor(context,picker,token){const editor=context.editor,disposables=new lifecycle_1.DisposableStore;disposables.add(picker.onDidAccept((event=>{const[item]=picker.selectedItems;if(item){if(!this.isValidLineNumber(editor,item.lineNumber))return;this.gotoLocation(context,{range:this.toRange(item.lineNumber,item.column),keyMods:picker.keyMods,preserveFocus:event.inBackground}),event.inBackground||picker.hide()}})));const updatePickerAndEditor=()=>{const position=this.parsePosition(editor,picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length)),label=this.getPickLabel(editor,position.lineNumber,position.column);if(picker.items=[{lineNumber:position.lineNumber,column:position.column,label}],picker.ariaLabel=label,!this.isValidLineNumber(editor,position.lineNumber))return void this.clearDecorations(editor);const range=this.toRange(position.lineNumber,position.column);editor.revealRangeInCenter(range,0),this.addDecorations(editor,range)};updatePickerAndEditor(),disposables.add(picker.onDidChangeValue((()=>updatePickerAndEditor())));const codeEditor=(0,editorBrowser_1.getCodeEditor)(editor);if(codeEditor){2===codeEditor.getOptions().get(60).renderType&&(codeEditor.updateOptions({lineNumbers:"on"}),disposables.add((0,lifecycle_1.toDisposable)((()=>codeEditor.updateOptions({lineNumbers:"relative"})))))}return disposables}toRange(lineNumber=1,column=1){return{startLineNumber:lineNumber,startColumn:column,endLineNumber:lineNumber,endColumn:column}}parsePosition(editor,value){const numbers=value.split(/,|:|#/).map((part=>parseInt(part,10))).filter((part=>!isNaN(part))),endLine=this.lineCount(editor)+1;return{lineNumber:numbers[0]>0?numbers[0]:endLine+numbers[0],column:numbers[1]}}getPickLabel(editor,lineNumber,column){if(this.isValidLineNumber(editor,lineNumber))return this.isValidColumn(editor,lineNumber,column)?(0,nls_1.localize)(1,null,lineNumber,column):(0,nls_1.localize)(2,null,lineNumber);const position=editor.getPosition()||{lineNumber:1,column:1},lineCount=this.lineCount(editor);return lineCount>1?(0,nls_1.localize)(3,null,position.lineNumber,position.column,lineCount):(0,nls_1.localize)(4,null,position.lineNumber,position.column)}isValidLineNumber(editor,lineNumber){return!(!lineNumber||"number"!=typeof lineNumber)&&(lineNumber>0&&lineNumber<=this.lineCount(editor))}isValidColumn(editor,lineNumber,column){if(!column||"number"!=typeof column)return!1;const model=this.getModel(editor);if(!model)return!1;const positionCandidate={lineNumber,column};return model.validatePosition(positionCandidate).equals(positionCandidate)}lineCount(editor){var _a,_b;return null!==(_b=null===(_a=this.getModel(editor))||void 0===_a?void 0:_a.getLineCount())&&void 0!==_b?_b:0}}exports.AbstractGotoLineQuickAccessProvider=AbstractGotoLineQuickAccessProvider,AbstractGotoLineQuickAccessProvider.PREFIX=":"})),define(__m[665],__M([1,0,10,21,28,322,2,8,3,27,205,288,570,20]),(function(require,exports,async_1,cancellation_1,codicons_1,fuzzyScorer_1,lifecycle_1,strings_1,range_1,languages_1,outlineModel_1,editorNavigationQuickAccess_1,nls_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractGotoSymbolQuickAccessProvider=void 0;let AbstractGotoSymbolQuickAccessProvider=class AbstractGotoSymbolQuickAccessProvider extends editorNavigationQuickAccess_1.AbstractEditorNavigationQuickAccessProvider{constructor(_languageFeaturesService,_outlineModelService,options=Object.create(null)){super(options),this._languageFeaturesService=_languageFeaturesService,this._outlineModelService=_outlineModelService,this.options=options,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(picker){return this.provideLabelPick(picker,(0,nls_1.localize)(0,null)),lifecycle_1.Disposable.None}provideWithTextEditor(context,picker,token){const editor=context.editor,model=this.getModel(editor);return model?this._languageFeaturesService.documentSymbolProvider.has(model)?this.doProvideWithEditorSymbols(context,model,picker,token):this.doProvideWithoutEditorSymbols(context,model,picker,token):lifecycle_1.Disposable.None}doProvideWithoutEditorSymbols(context,model,picker,token){const disposables=new lifecycle_1.DisposableStore;return this.provideLabelPick(picker,(0,nls_1.localize)(1,null)),(()=>{__awaiter(this,void 0,void 0,(function*(){(yield this.waitForLanguageSymbolRegistry(model,disposables))&&!token.isCancellationRequested&&disposables.add(this.doProvideWithEditorSymbols(context,model,picker,token))}))})(),disposables}provideLabelPick(picker,label){picker.items=[{label,index:0,kind:14}],picker.ariaLabel=label}waitForLanguageSymbolRegistry(model,disposables){return __awaiter(this,void 0,void 0,(function*(){if(this._languageFeaturesService.documentSymbolProvider.has(model))return!0;const symbolProviderRegistryPromise=new async_1.DeferredPromise,symbolProviderListener=disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange((()=>{this._languageFeaturesService.documentSymbolProvider.has(model)&&(symbolProviderListener.dispose(),symbolProviderRegistryPromise.complete(!0))})));return disposables.add((0,lifecycle_1.toDisposable)((()=>symbolProviderRegistryPromise.complete(!1)))),symbolProviderRegistryPromise.p}))}doProvideWithEditorSymbols(context,model,picker,token){const editor=context.editor,disposables=new lifecycle_1.DisposableStore;disposables.add(picker.onDidAccept((event=>{const[item]=picker.selectedItems;item&&item.range&&(this.gotoLocation(context,{range:item.range.selection,keyMods:picker.keyMods,preserveFocus:event.inBackground}),event.inBackground||picker.hide())}))),disposables.add(picker.onDidTriggerItemButton((({item})=>{item&&item.range&&(this.gotoLocation(context,{range:item.range.selection,keyMods:picker.keyMods,forceSideBySide:!0}),picker.hide())})));const symbolsPromise=this.getDocumentSymbols(model,token);let picksCts;const updatePickerItems=()=>__awaiter(this,void 0,void 0,(function*(){null==picksCts||picksCts.dispose(!0),picker.busy=!1,picksCts=new cancellation_1.CancellationTokenSource(token),picker.busy=!0;try{const query=(0,fuzzyScorer_1.prepareQuery)(picker.value.substr(AbstractGotoSymbolQuickAccessProvider.PREFIX.length).trim()),items=yield this.doGetSymbolPicks(symbolsPromise,query,void 0,picksCts.token);if(token.isCancellationRequested)return;items.length>0?picker.items=items:query.original.length>0?this.provideLabelPick(picker,(0,nls_1.localize)(2,null)):this.provideLabelPick(picker,(0,nls_1.localize)(3,null))}finally{token.isCancellationRequested||(picker.busy=!1)}}));disposables.add(picker.onDidChangeValue((()=>updatePickerItems()))),updatePickerItems();let ignoreFirstActiveEvent=!0;return disposables.add(picker.onDidChangeActive((()=>{const[item]=picker.activeItems;if(item&&item.range){if(ignoreFirstActiveEvent)return void(ignoreFirstActiveEvent=!1);editor.revealRangeInCenter(item.range.selection,0),this.addDecorations(editor,item.range.decoration)}}))),disposables}doGetSymbolPicks(symbolsPromise,query,options,token){return __awaiter(this,void 0,void 0,(function*(){const symbols=yield symbolsPromise;if(token.isCancellationRequested)return[];const filterBySymbolKind=0===query.original.indexOf(AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX),filterPos=filterBySymbolKind?1:0;let symbolQuery,containerQuery;query.values&&query.values.length>1?(symbolQuery=(0,fuzzyScorer_1.pieceToQuery)(query.values[0]),containerQuery=(0,fuzzyScorer_1.pieceToQuery)(query.values.slice(1))):symbolQuery=query;const filteredSymbolPicks=[];for(let index=0;index<symbols.length;index++){const symbol=symbols[index],symbolLabel=(0,strings_1.trim)(symbol.name),symbolLabelWithIcon=`$(${languages_1.SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`,symbolLabelIconOffset=symbolLabelWithIcon.length-symbolLabel.length;let symbolScore,symbolMatches,containerScore,containerMatches,containerLabel=symbol.containerName;if((null==options?void 0:options.extraContainerLabel)&&(containerLabel=containerLabel?`${options.extraContainerLabel} • ${containerLabel}`:options.extraContainerLabel),query.original.length>filterPos){let skipContainerQuery=!1;if(symbolQuery!==query&&([symbolScore,symbolMatches]=(0,fuzzyScorer_1.scoreFuzzy2)(symbolLabelWithIcon,Object.assign(Object.assign({},query),{values:void 0}),filterPos,symbolLabelIconOffset),"number"==typeof symbolScore&&(skipContainerQuery=!0)),"number"!=typeof symbolScore&&([symbolScore,symbolMatches]=(0,fuzzyScorer_1.scoreFuzzy2)(symbolLabelWithIcon,symbolQuery,filterPos,symbolLabelIconOffset),"number"!=typeof symbolScore))continue;if(!skipContainerQuery&&containerQuery){if(containerLabel&&containerQuery.original.length>0&&([containerScore,containerMatches]=(0,fuzzyScorer_1.scoreFuzzy2)(containerLabel,containerQuery)),"number"!=typeof containerScore)continue;"number"==typeof symbolScore&&(symbolScore+=containerScore)}}const deprecated=symbol.tags&&symbol.tags.indexOf(1)>=0;filteredSymbolPicks.push({index,kind:symbol.kind,score:symbolScore,label:symbolLabelWithIcon,ariaLabel:symbolLabel,description:containerLabel,highlights:deprecated?void 0:{label:symbolMatches,description:containerMatches},range:{selection:range_1.Range.collapseToStart(symbol.selectionRange),decoration:symbol.range},strikethrough:deprecated,buttons:(()=>{var _a,_b;const openSideBySideDirection=(null===(_a=this.options)||void 0===_a?void 0:_a.openSideBySideDirection)?null===(_b=this.options)||void 0===_b?void 0:_b.openSideBySideDirection():void 0;if(openSideBySideDirection)return[{iconClass:"right"===openSideBySideDirection?codicons_1.Codicon.splitHorizontal.classNames:codicons_1.Codicon.splitVertical.classNames,tooltip:"right"===openSideBySideDirection?(0,nls_1.localize)(4,null):(0,nls_1.localize)(5,null)}]})()})}const sortedFilteredSymbolPicks=filteredSymbolPicks.sort(((symbolA,symbolB)=>filterBySymbolKind?this.compareByKindAndScore(symbolA,symbolB):this.compareByScore(symbolA,symbolB)));let symbolPicks=[];if(filterBySymbolKind){let lastSymbolKind,lastSeparator,lastSymbolKindCounter=0;function updateLastSeparatorLabel(){lastSeparator&&"number"==typeof lastSymbolKind&&lastSymbolKindCounter>0&&(lastSeparator.label=(0,strings_1.format)(NLS_SYMBOL_KIND_CACHE[lastSymbolKind]||FALLBACK_NLS_SYMBOL_KIND,lastSymbolKindCounter))}for(const symbolPick of sortedFilteredSymbolPicks)lastSymbolKind!==symbolPick.kind?(updateLastSeparatorLabel(),lastSymbolKind=symbolPick.kind,lastSymbolKindCounter=1,lastSeparator={type:"separator"},symbolPicks.push(lastSeparator)):lastSymbolKindCounter++,symbolPicks.push(symbolPick);updateLastSeparatorLabel()}else sortedFilteredSymbolPicks.length>0&&(symbolPicks=[{label:(0,nls_1.localize)(6,null,filteredSymbolPicks.length),type:"separator"},...sortedFilteredSymbolPicks]);return symbolPicks}))}compareByScore(symbolA,symbolB){if("number"!=typeof symbolA.score&&"number"==typeof symbolB.score)return 1;if("number"==typeof symbolA.score&&"number"!=typeof symbolB.score)return-1;if("number"==typeof symbolA.score&&"number"==typeof symbolB.score){if(symbolA.score>symbolB.score)return-1;if(symbolA.score<symbolB.score)return 1}return symbolA.index<symbolB.index?-1:symbolA.index>symbolB.index?1:0}compareByKindAndScore(symbolA,symbolB){const kindA=NLS_SYMBOL_KIND_CACHE[symbolA.kind]||FALLBACK_NLS_SYMBOL_KIND,kindB=NLS_SYMBOL_KIND_CACHE[symbolB.kind]||FALLBACK_NLS_SYMBOL_KIND,result=kindA.localeCompare(kindB);return 0===result?this.compareByScore(symbolA,symbolB):result}getDocumentSymbols(document,token){return __awaiter(this,void 0,void 0,(function*(){const model=yield this._outlineModelService.getOrCreate(document,token);return token.isCancellationRequested?[]:model.asListOfDocumentSymbols()}))}};AbstractGotoSymbolQuickAccessProvider.PREFIX="@",AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX=":",AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY=`${AbstractGotoSymbolQuickAccessProvider.PREFIX}${AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX}`,AbstractGotoSymbolQuickAccessProvider=__decorate([__param(0,languageFeatures_1.ILanguageFeaturesService),__param(1,outlineModel_1.IOutlineModelService)],AbstractGotoSymbolQuickAccessProvider),exports.AbstractGotoSymbolQuickAccessProvider=AbstractGotoSymbolQuickAccessProvider;const FALLBACK_NLS_SYMBOL_KIND=(0,nls_1.localize)(7,null),NLS_SYMBOL_KIND_CACHE={5:(0,nls_1.localize)(8,null),11:(0,nls_1.localize)(9,null),8:(0,nls_1.localize)(10,null),12:(0,nls_1.localize)(11,null),4:(0,nls_1.localize)(12,null),22:(0,nls_1.localize)(13,null),23:(0,nls_1.localize)(14,null),24:(0,nls_1.localize)(15,null),10:(0,nls_1.localize)(16,null),2:(0,nls_1.localize)(17,null),3:(0,nls_1.localize)(18,null),25:(0,nls_1.localize)(19,null),1:(0,nls_1.localize)(20,null),6:(0,nls_1.localize)(21,null),9:(0,nls_1.localize)(22,null),21:(0,nls_1.localize)(23,null),14:(0,nls_1.localize)(24,null),0:(0,nls_1.localize)(25,null),17:(0,nls_1.localize)(26,null),15:(0,nls_1.localize)(27,null),16:(0,nls_1.localize)(28,null),18:(0,nls_1.localize)(29,null),19:(0,nls_1.localize)(30,null),7:(0,nls_1.localize)(31,null),13:(0,nls_1.localize)(32,null)}})),define(__m[666],__M([1,0,2,11,572,17,43,23,14,387]),(function(require,exports,lifecycle_1,position_1,nls_1,contextkey_1,keybinding_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenameInputField=exports.CONTEXT_RENAME_INPUT_VISIBLE=void 0,exports.CONTEXT_RENAME_INPUT_VISIBLE=new contextkey_1.RawContextKey("renameInputVisible",!1,(0,nls_1.localize)(0,null));let RenameInputField=class RenameInputField{constructor(_editor,_acceptKeybindings,_themeService,_keybindingService,contextKeyService){this._editor=_editor,this._acceptKeybindings=_acceptKeybindings,this._themeService=_themeService,this._keybindingService=_keybindingService,this._disposables=new lifecycle_1.DisposableStore,this.allowEditorOverflow=!0,this._visibleContextKey=exports.CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){if(!this._domNode){this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._input=document.createElement("input"),this._input.className="rename-input",this._input.type="text",this._input.setAttribute("aria-label",(0,nls_1.localize)(1,null)),this._domNode.appendChild(this._input),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label);const updateLabel=()=>{var _a,_b;const[accept,preview]=this._acceptKeybindings;this._keybindingService.lookupKeybinding(accept),this._label.innerText=(0,nls_1.localize)(2,null,null===(_a=this._keybindingService.lookupKeybinding(accept))||void 0===_a?void 0:_a.getLabel(),null===(_b=this._keybindingService.lookupKeybinding(preview))||void 0===_b?void 0:_b.getLabel())};updateLabel(),this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel)),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())}return this._domNode}_updateStyles(theme){var _a,_b,_c,_d;if(!this._input||!this._domNode)return;const widgetShadowColor=theme.getColor(colorRegistry_1.widgetShadow);this._domNode.style.backgroundColor=String(null!==(_a=theme.getColor(colorRegistry_1.editorWidgetBackground))&&void 0!==_a?_a:""),this._domNode.style.boxShadow=widgetShadowColor?` 0 0 8px 2px ${widgetShadowColor}`:"",this._domNode.style.color=String(null!==(_b=theme.getColor(colorRegistry_1.inputForeground))&&void 0!==_b?_b:""),this._input.style.backgroundColor=String(null!==(_c=theme.getColor(colorRegistry_1.inputBackground))&&void 0!==_c?_c:"");const border=theme.getColor(colorRegistry_1.inputBorder);this._input.style.borderWidth=border?"1px":"0px",this._input.style.borderStyle=border?"solid":"none",this._input.style.borderColor=null!==(_d=null==border?void 0:border.toString())&&void 0!==_d?_d:"none"}_updateFont(){if(!this._input||!this._label)return;const fontInfo=this._editor.getOption(44);this._input.style.fontFamily=fontInfo.fontFamily,this._input.style.fontWeight=fontInfo.fontWeight,this._input.style.fontSize=`${fontInfo.fontSize}px`,this._label.style.fontSize=.8*fontInfo.fontSize+"px"}getPosition(){return this._visible?{position:this._position,preference:[2,1]}:null}afterRender(position){position||this.cancelInput(!0)}acceptInput(wantsPreview){this._currentAcceptInput&&this._currentAcceptInput(wantsPreview)}cancelInput(focusEditor){this._currentCancelInput&&this._currentCancelInput(focusEditor)}getInput(where,value,selectionStart,selectionEnd,supportPreview,token){this._domNode.classList.toggle("preview",supportPreview),this._position=new position_1.Position(where.startLineNumber,where.startColumn),this._input.value=value,this._input.setAttribute("selectionStart",selectionStart.toString()),this._input.setAttribute("selectionEnd",selectionEnd.toString()),this._input.size=Math.max(1.1*(where.endColumn-where.startColumn),20);const disposeOnDone=new lifecycle_1.DisposableStore;return new Promise((resolve=>{this._currentCancelInput=focusEditor=>(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,resolve(focusEditor),!0),this._currentAcceptInput=wantsPreview=>{0!==this._input.value.trim().length&&this._input.value!==value?(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,resolve({newName:this._input.value,wantsPreview:supportPreview&&wantsPreview})):this.cancelInput(!0)},disposeOnDone.add(token.onCancellationRequested((()=>this.cancelInput(!0)))),disposeOnDone.add(this._editor.onDidBlurEditorWidget((()=>this.cancelInput(!1)))),this._show()})).finally((()=>{disposeOnDone.dispose(),this._hide()}))}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout((()=>{this._input.focus(),this._input.setSelectionRange(parseInt(this._input.getAttribute("selectionStart")),parseInt(this._input.getAttribute("selectionEnd")))}),100)}_hide(){this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}};RenameInputField=__decorate([__param(2,themeService_1.IThemeService),__param(3,keybinding_1.IKeybindingService),__param(4,contextkey_1.IContextKeyService)],RenameInputField),exports.RenameInputField=RenameInputField})),define(__m[289],__M([1,0,28,582,23,14]),(function(require,exports,codicons_1,nls_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SYMBOL_ICON_VARIABLE_FOREGROUND=exports.SYMBOL_ICON_UNIT_FOREGROUND=exports.SYMBOL_ICON_TYPEPARAMETER_FOREGROUND=exports.SYMBOL_ICON_TEXT_FOREGROUND=exports.SYMBOL_ICON_STRUCT_FOREGROUND=exports.SYMBOL_ICON_STRING_FOREGROUND=exports.SYMBOL_ICON_SNIPPET_FOREGROUND=exports.SYMBOL_ICON_REFERENCE_FOREGROUND=exports.SYMBOL_ICON_PROPERTY_FOREGROUND=exports.SYMBOL_ICON_PACKAGE_FOREGROUND=exports.SYMBOL_ICON_OPERATOR_FOREGROUND=exports.SYMBOL_ICON_OBJECT_FOREGROUND=exports.SYMBOL_ICON_NUMBER_FOREGROUND=exports.SYMBOL_ICON_NULL_FOREGROUND=exports.SYMBOL_ICON_NAMESPACE_FOREGROUND=exports.SYMBOL_ICON_MODULE_FOREGROUND=exports.SYMBOL_ICON_METHOD_FOREGROUND=exports.SYMBOL_ICON_KEYWORD_FOREGROUND=exports.SYMBOL_ICON_KEY_FOREGROUND=exports.SYMBOL_ICON_INTERFACE_FOREGROUND=exports.SYMBOL_ICON_FUNCTION_FOREGROUND=exports.SYMBOL_ICON_FOLDER_FOREGROUND=exports.SYMBOL_ICON_FILE_FOREGROUND=exports.SYMBOL_ICON_FIELD_FOREGROUND=exports.SYMBOL_ICON_EVENT_FOREGROUND=exports.SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND=exports.SYMBOL_ICON_ENUMERATOR_FOREGROUND=exports.SYMBOL_ICON_CONSTRUCTOR_FOREGROUND=exports.SYMBOL_ICON_CONSTANT_FOREGROUND=exports.SYMBOL_ICON_COLOR_FOREGROUND=exports.SYMBOL_ICON_CLASS_FOREGROUND=exports.SYMBOL_ICON_BOOLEAN_FOREGROUND=exports.SYMBOL_ICON_ARRAY_FOREGROUND=void 0,exports.SYMBOL_ICON_ARRAY_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.arrayForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(0,null)),exports.SYMBOL_ICON_BOOLEAN_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.booleanForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(1,null)),exports.SYMBOL_ICON_CLASS_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},(0,nls_1.localize)(2,null)),exports.SYMBOL_ICON_COLOR_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.colorForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(3,null)),exports.SYMBOL_ICON_CONSTANT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.constantForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(4,null)),exports.SYMBOL_ICON_CONSTRUCTOR_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},(0,nls_1.localize)(5,null)),exports.SYMBOL_ICON_ENUMERATOR_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},(0,nls_1.localize)(6,null)),exports.SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},(0,nls_1.localize)(7,null)),exports.SYMBOL_ICON_EVENT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},(0,nls_1.localize)(8,null)),exports.SYMBOL_ICON_FIELD_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},(0,nls_1.localize)(9,null)),exports.SYMBOL_ICON_FILE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.fileForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(10,null)),exports.SYMBOL_ICON_FOLDER_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.folderForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(11,null)),exports.SYMBOL_ICON_FUNCTION_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},(0,nls_1.localize)(12,null)),exports.SYMBOL_ICON_INTERFACE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},(0,nls_1.localize)(13,null)),exports.SYMBOL_ICON_KEY_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.keyForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(14,null)),exports.SYMBOL_ICON_KEYWORD_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.keywordForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(15,null)),exports.SYMBOL_ICON_METHOD_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},(0,nls_1.localize)(16,null)),exports.SYMBOL_ICON_MODULE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.moduleForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(17,null)),exports.SYMBOL_ICON_NAMESPACE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.namespaceForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(18,null)),exports.SYMBOL_ICON_NULL_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.nullForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(19,null)),exports.SYMBOL_ICON_NUMBER_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.numberForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(20,null)),exports.SYMBOL_ICON_OBJECT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.objectForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(21,null)),exports.SYMBOL_ICON_OPERATOR_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.operatorForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(22,null)),exports.SYMBOL_ICON_PACKAGE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.packageForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(23,null)),exports.SYMBOL_ICON_PROPERTY_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.propertyForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(24,null)),exports.SYMBOL_ICON_REFERENCE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.referenceForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(25,null)),exports.SYMBOL_ICON_SNIPPET_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.snippetForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(26,null)),exports.SYMBOL_ICON_STRING_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.stringForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(27,null)),exports.SYMBOL_ICON_STRUCT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.structForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(28,null)),exports.SYMBOL_ICON_TEXT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.textForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(29,null)),exports.SYMBOL_ICON_TYPEPARAMETER_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.typeParameterForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(30,null)),exports.SYMBOL_ICON_UNIT_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.unitForeground",{dark:colorRegistry_1.foreground,light:colorRegistry_1.foreground,hc:colorRegistry_1.foreground},(0,nls_1.localize)(31,null)),exports.SYMBOL_ICON_VARIABLE_FOREGROUND=(0,colorRegistry_1.registerColor)("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},(0,nls_1.localize)(32,null)),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const symbolIconArrayColor=theme.getColor(exports.SYMBOL_ICON_ARRAY_FOREGROUND);symbolIconArrayColor&&collector.addRule(`${codicons_1.Codicon.symbolArray.cssSelector} { color: ${symbolIconArrayColor}; }`);const symbolIconBooleanColor=theme.getColor(exports.SYMBOL_ICON_BOOLEAN_FOREGROUND);symbolIconBooleanColor&&collector.addRule(`${codicons_1.Codicon.symbolBoolean.cssSelector} { color: ${symbolIconBooleanColor}; }`);const symbolIconClassColor=theme.getColor(exports.SYMBOL_ICON_CLASS_FOREGROUND);symbolIconClassColor&&collector.addRule(`${codicons_1.Codicon.symbolClass.cssSelector} { color: ${symbolIconClassColor}; }`);const symbolIconMethodColor=theme.getColor(exports.SYMBOL_ICON_METHOD_FOREGROUND);symbolIconMethodColor&&collector.addRule(`${codicons_1.Codicon.symbolMethod.cssSelector} { color: ${symbolIconMethodColor}; }`);const symbolIconColorColor=theme.getColor(exports.SYMBOL_ICON_COLOR_FOREGROUND);symbolIconColorColor&&collector.addRule(`${codicons_1.Codicon.symbolColor.cssSelector} { color: ${symbolIconColorColor}; }`);const symbolIconConstantColor=theme.getColor(exports.SYMBOL_ICON_CONSTANT_FOREGROUND);symbolIconConstantColor&&collector.addRule(`${codicons_1.Codicon.symbolConstant.cssSelector} { color: ${symbolIconConstantColor}; }`);const symbolIconConstructorColor=theme.getColor(exports.SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);symbolIconConstructorColor&&collector.addRule(`${codicons_1.Codicon.symbolConstructor.cssSelector} { color: ${symbolIconConstructorColor}; }`);const symbolIconEnumeratorColor=theme.getColor(exports.SYMBOL_ICON_ENUMERATOR_FOREGROUND);symbolIconEnumeratorColor&&collector.addRule(`\n\t\t\t${codicons_1.Codicon.symbolValue.cssSelector},${codicons_1.Codicon.symbolEnum.cssSelector} { color: ${symbolIconEnumeratorColor}; }`);const symbolIconEnumeratorMemberColor=theme.getColor(exports.SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);symbolIconEnumeratorMemberColor&&collector.addRule(`${codicons_1.Codicon.symbolEnumMember.cssSelector} { color: ${symbolIconEnumeratorMemberColor}; }`);const symbolIconEventColor=theme.getColor(exports.SYMBOL_ICON_EVENT_FOREGROUND);symbolIconEventColor&&collector.addRule(`${codicons_1.Codicon.symbolEvent.cssSelector} { color: ${symbolIconEventColor}; }`);const symbolIconFieldColor=theme.getColor(exports.SYMBOL_ICON_FIELD_FOREGROUND);symbolIconFieldColor&&collector.addRule(`${codicons_1.Codicon.symbolField.cssSelector} { color: ${symbolIconFieldColor}; }`);const symbolIconFileColor=theme.getColor(exports.SYMBOL_ICON_FILE_FOREGROUND);symbolIconFileColor&&collector.addRule(`${codicons_1.Codicon.symbolFile.cssSelector} { color: ${symbolIconFileColor}; }`);const symbolIconFolderColor=theme.getColor(exports.SYMBOL_ICON_FOLDER_FOREGROUND);symbolIconFolderColor&&collector.addRule(`${codicons_1.Codicon.symbolFolder.cssSelector} { color: ${symbolIconFolderColor}; }`);const symbolIconFunctionColor=theme.getColor(exports.SYMBOL_ICON_FUNCTION_FOREGROUND);symbolIconFunctionColor&&collector.addRule(`${codicons_1.Codicon.symbolFunction.cssSelector} { color: ${symbolIconFunctionColor}; }`);const symbolIconInterfaceColor=theme.getColor(exports.SYMBOL_ICON_INTERFACE_FOREGROUND);symbolIconInterfaceColor&&collector.addRule(`${codicons_1.Codicon.symbolInterface.cssSelector} { color: ${symbolIconInterfaceColor}; }`);const symbolIconKeyColor=theme.getColor(exports.SYMBOL_ICON_KEY_FOREGROUND);symbolIconKeyColor&&collector.addRule(`${codicons_1.Codicon.symbolKey.cssSelector} { color: ${symbolIconKeyColor}; }`);const symbolIconKeywordColor=theme.getColor(exports.SYMBOL_ICON_KEYWORD_FOREGROUND);symbolIconKeywordColor&&collector.addRule(`${codicons_1.Codicon.symbolKeyword.cssSelector} { color: ${symbolIconKeywordColor}; }`);const symbolIconModuleColor=theme.getColor(exports.SYMBOL_ICON_MODULE_FOREGROUND);symbolIconModuleColor&&collector.addRule(`${codicons_1.Codicon.symbolModule.cssSelector} { color: ${symbolIconModuleColor}; }`);const outlineNamespaceColor=theme.getColor(exports.SYMBOL_ICON_NAMESPACE_FOREGROUND);outlineNamespaceColor&&collector.addRule(`${codicons_1.Codicon.symbolNamespace.cssSelector} { color: ${outlineNamespaceColor}; }`);const symbolIconNullColor=theme.getColor(exports.SYMBOL_ICON_NULL_FOREGROUND);symbolIconNullColor&&collector.addRule(`${codicons_1.Codicon.symbolNull.cssSelector} { color: ${symbolIconNullColor}; }`);const symbolIconNumberColor=theme.getColor(exports.SYMBOL_ICON_NUMBER_FOREGROUND);symbolIconNumberColor&&collector.addRule(`${codicons_1.Codicon.symbolNumber.cssSelector} { color: ${symbolIconNumberColor}; }`);const symbolIconObjectColor=theme.getColor(exports.SYMBOL_ICON_OBJECT_FOREGROUND);symbolIconObjectColor&&collector.addRule(`${codicons_1.Codicon.symbolObject.cssSelector} { color: ${symbolIconObjectColor}; }`);const symbolIconOperatorColor=theme.getColor(exports.SYMBOL_ICON_OPERATOR_FOREGROUND);symbolIconOperatorColor&&collector.addRule(`${codicons_1.Codicon.symbolOperator.cssSelector} { color: ${symbolIconOperatorColor}; }`);const symbolIconPackageColor=theme.getColor(exports.SYMBOL_ICON_PACKAGE_FOREGROUND);symbolIconPackageColor&&collector.addRule(`${codicons_1.Codicon.symbolPackage.cssSelector} { color: ${symbolIconPackageColor}; }`);const symbolIconPropertyColor=theme.getColor(exports.SYMBOL_ICON_PROPERTY_FOREGROUND);symbolIconPropertyColor&&collector.addRule(`${codicons_1.Codicon.symbolProperty.cssSelector} { color: ${symbolIconPropertyColor}; }`);const symbolIconReferenceColor=theme.getColor(exports.SYMBOL_ICON_REFERENCE_FOREGROUND);symbolIconReferenceColor&&collector.addRule(`${codicons_1.Codicon.symbolReference.cssSelector} { color: ${symbolIconReferenceColor}; }`);const symbolIconSnippetColor=theme.getColor(exports.SYMBOL_ICON_SNIPPET_FOREGROUND);symbolIconSnippetColor&&collector.addRule(`${codicons_1.Codicon.symbolSnippet.cssSelector} { color: ${symbolIconSnippetColor}; }`);const symbolIconStringColor=theme.getColor(exports.SYMBOL_ICON_STRING_FOREGROUND);symbolIconStringColor&&collector.addRule(`${codicons_1.Codicon.symbolString.cssSelector} { color: ${symbolIconStringColor}; }`);const symbolIconStructColor=theme.getColor(exports.SYMBOL_ICON_STRUCT_FOREGROUND);symbolIconStructColor&&collector.addRule(`${codicons_1.Codicon.symbolStruct.cssSelector} { color: ${symbolIconStructColor}; }`);const symbolIconTextColor=theme.getColor(exports.SYMBOL_ICON_TEXT_FOREGROUND);symbolIconTextColor&&collector.addRule(`${codicons_1.Codicon.symbolText.cssSelector} { color: ${symbolIconTextColor}; }`);const symbolIconTypeParameterColor=theme.getColor(exports.SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);symbolIconTypeParameterColor&&collector.addRule(`${codicons_1.Codicon.symbolTypeParameter.cssSelector} { color: ${symbolIconTypeParameterColor}; }`);const symbolIconUnitColor=theme.getColor(exports.SYMBOL_ICON_UNIT_FOREGROUND);symbolIconUnitColor&&collector.addRule(`${codicons_1.Codicon.symbolUnit.cssSelector} { color: ${symbolIconUnitColor}; }`);const symbolIconVariableColor=theme.getColor(exports.SYMBOL_ICON_VARIABLE_FOREGROUND);symbolIconVariableColor&&collector.addRule(`${codicons_1.Codicon.symbolVariable.cssSelector} { color: ${symbolIconVariableColor}; }`)}))})),define(__m[290],__M([1,0,7,45,647,29,17,52,14]),(function(require,exports,dom_1,network_1,abstractCodeEditorService_1,codeEditorService_1,contextkey_1,extensions_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandaloneCodeEditorService=void 0;let StandaloneCodeEditorService=class StandaloneCodeEditorService extends abstractCodeEditorService_1.AbstractCodeEditorService{constructor(contextKeyService,themeService){super(themeService),this.onCodeEditorAdd((()=>this._checkContextKey())),this.onCodeEditorRemove((()=>this._checkContextKey())),this._editorIsOpen=contextKeyService.createKey("editorIsOpen",!1),this._activeCodeEditor=null}_checkContextKey(){let hasCodeEditor=!1;for(const editor of this.listCodeEditors())if(!editor.isSimpleWidget){hasCodeEditor=!0;break}this._editorIsOpen.set(hasCodeEditor)}setActiveCodeEditor(activeCodeEditor){this._activeCodeEditor=activeCodeEditor}getActiveCodeEditor(){return this._activeCodeEditor}openCodeEditor(input,source,sideBySide){return source?Promise.resolve(this.doOpenEditor(source,input)):Promise.resolve(null)}doOpenEditor(editor,input){if(!this.findModel(editor,input.resource)){if(input.resource){const schema=input.resource.scheme;if(schema===network_1.Schemas.http||schema===network_1.Schemas.https)return(0,dom_1.windowOpenNoOpener)(input.resource.toString()),editor}return null}const selection=input.options?input.options.selection:null;if(selection)if("number"==typeof selection.endLineNumber&&"number"==typeof selection.endColumn)editor.setSelection(selection),editor.revealRangeInCenter(selection,1);else{const pos={lineNumber:selection.startLineNumber,column:selection.startColumn};editor.setPosition(pos),editor.revealPositionInCenter(pos,1)}return editor}findModel(editor,resource){const model=editor.getModel();return model&&model.uri.toString()!==resource.toString()?null:model}};StandaloneCodeEditorService=__decorate([__param(0,contextkey_1.IContextKeyService),__param(1,themeService_1.IThemeService)],StandaloneCodeEditorService),exports.StandaloneCodeEditorService=StandaloneCodeEditorService,(0,extensions_1.registerSingleton)(codeEditorService_1.ICodeEditorService,StandaloneCodeEditorService)})),define(__m[667],__M([1,0,54,23]),(function(require,exports,editorColorRegistry_1,colorRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hc_black=exports.vs_dark=exports.vs=void 0,exports.vs={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[colorRegistry_1.editorBackground]:"#FFFFFE",[colorRegistry_1.editorForeground]:"#000000",[colorRegistry_1.editorInactiveSelection]:"#E5EBF1",[editorColorRegistry_1.editorIndentGuides]:"#D3D3D3",[editorColorRegistry_1.editorActiveIndentGuides]:"#939393",[colorRegistry_1.editorSelectionHighlight]:"#ADD6FF4D"}},exports.vs_dark={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[colorRegistry_1.editorBackground]:"#1E1E1E",[colorRegistry_1.editorForeground]:"#D4D4D4",[colorRegistry_1.editorInactiveSelection]:"#3A3D41",[editorColorRegistry_1.editorIndentGuides]:"#404040",[editorColorRegistry_1.editorActiveIndentGuides]:"#707070",[colorRegistry_1.editorSelectionHighlight]:"#ADD6FF26"}},exports.hc_black={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[colorRegistry_1.editorBackground]:"#000000",[colorRegistry_1.editorForeground]:"#FFFFFF",[editorColorRegistry_1.editorIndentGuides]:"#FFFFFF",[editorColorRegistry_1.editorActiveIndentGuides]:"#FFFFFF"}}})),define(__m[37],__M([1,0,47,28,4,57,2,83,26,17,9,14]),(function(require,exports,actions_1,codicons_1,event_1,iterator_1,lifecycle_1,linkedList_1,commands_1,contextkey_1,instantiation_1,themeService_1){"use strict";function isIMenuItem(item){return void 0!==item.command}Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuItemAction=exports.SubmenuItemAction=exports.MenuRegistry=exports.IMenuService=exports.MenuId=exports.isIMenuItem=void 0,exports.isIMenuItem=isIMenuItem;class MenuId{constructor(debugName){this.id=MenuId._idPool++,this._debugName=debugName}}exports.MenuId=MenuId,MenuId._idPool=0,MenuId.CommandPalette=new MenuId("CommandPalette"),MenuId.DebugBreakpointsContext=new MenuId("DebugBreakpointsContext"),MenuId.DebugCallStackContext=new MenuId("DebugCallStackContext"),MenuId.DebugConsoleContext=new MenuId("DebugConsoleContext"),MenuId.DebugVariablesContext=new MenuId("DebugVariablesContext"),MenuId.DebugWatchContext=new MenuId("DebugWatchContext"),MenuId.DebugToolBar=new MenuId("DebugToolBar"),MenuId.EditorContext=new MenuId("EditorContext"),MenuId.SimpleEditorContext=new MenuId("SimpleEditorContext"),MenuId.EditorContextCopy=new MenuId("EditorContextCopy"),MenuId.EditorContextPeek=new MenuId("EditorContextPeek"),MenuId.EditorTitle=new MenuId("EditorTitle"),MenuId.EditorTitleRun=new MenuId("EditorTitleRun"),MenuId.EditorTitleContext=new MenuId("EditorTitleContext"),MenuId.EmptyEditorGroup=new MenuId("EmptyEditorGroup"),MenuId.EmptyEditorGroupContext=new MenuId("EmptyEditorGroupContext"),MenuId.ExplorerContext=new MenuId("ExplorerContext"),MenuId.ExtensionContext=new MenuId("ExtensionContext"),MenuId.GlobalActivity=new MenuId("GlobalActivity"),MenuId.LayoutControlMenuSubmenu=new MenuId("LayoutControlMenuSubmenu"),MenuId.LayoutControlMenu=new MenuId("LayoutControlMenu"),MenuId.MenubarMainMenu=new MenuId("MenubarMainMenu"),MenuId.MenubarAppearanceMenu=new MenuId("MenubarAppearanceMenu"),MenuId.MenubarDebugMenu=new MenuId("MenubarDebugMenu"),MenuId.MenubarEditMenu=new MenuId("MenubarEditMenu"),MenuId.MenubarCopy=new MenuId("MenubarCopy"),MenuId.MenubarFileMenu=new MenuId("MenubarFileMenu"),MenuId.MenubarGoMenu=new MenuId("MenubarGoMenu"),MenuId.MenubarHelpMenu=new MenuId("MenubarHelpMenu"),MenuId.MenubarLayoutMenu=new MenuId("MenubarLayoutMenu"),MenuId.MenubarNewBreakpointMenu=new MenuId("MenubarNewBreakpointMenu"),MenuId.MenubarPanelAlignmentMenu=new MenuId("MenubarPanelAlignmentMenu"),MenuId.MenubarPanelPositionMenu=new MenuId("MenubarPanelPositionMenu"),MenuId.MenubarPreferencesMenu=new MenuId("MenubarPreferencesMenu"),MenuId.MenubarRecentMenu=new MenuId("MenubarRecentMenu"),MenuId.MenubarSelectionMenu=new MenuId("MenubarSelectionMenu"),MenuId.MenubarSwitchEditorMenu=new MenuId("MenubarSwitchEditorMenu"),MenuId.MenubarSwitchGroupMenu=new MenuId("MenubarSwitchGroupMenu"),MenuId.MenubarTerminalMenu=new MenuId("MenubarTerminalMenu"),MenuId.MenubarViewMenu=new MenuId("MenubarViewMenu"),MenuId.MenubarHomeMenu=new MenuId("MenubarHomeMenu"),MenuId.OpenEditorsContext=new MenuId("OpenEditorsContext"),MenuId.ProblemsPanelContext=new MenuId("ProblemsPanelContext"),MenuId.SCMChangeContext=new MenuId("SCMChangeContext"),MenuId.SCMResourceContext=new MenuId("SCMResourceContext"),MenuId.SCMResourceFolderContext=new MenuId("SCMResourceFolderContext"),MenuId.SCMResourceGroupContext=new MenuId("SCMResourceGroupContext"),MenuId.SCMSourceControl=new MenuId("SCMSourceControl"),MenuId.SCMTitle=new MenuId("SCMTitle"),MenuId.SearchContext=new MenuId("SearchContext"),MenuId.StatusBarWindowIndicatorMenu=new MenuId("StatusBarWindowIndicatorMenu"),MenuId.StatusBarRemoteIndicatorMenu=new MenuId("StatusBarRemoteIndicatorMenu"),MenuId.TestItem=new MenuId("TestItem"),MenuId.TestItemGutter=new MenuId("TestItemGutter"),MenuId.TestPeekElement=new MenuId("TestPeekElement"),MenuId.TestPeekTitle=new MenuId("TestPeekTitle"),MenuId.TouchBarContext=new MenuId("TouchBarContext"),MenuId.TitleBarContext=new MenuId("TitleBarContext"),MenuId.TunnelContext=new MenuId("TunnelContext"),MenuId.TunnelPrivacy=new MenuId("TunnelPrivacy"),MenuId.TunnelProtocol=new MenuId("TunnelProtocol"),MenuId.TunnelPortInline=new MenuId("TunnelInline"),MenuId.TunnelTitle=new MenuId("TunnelTitle"),MenuId.TunnelLocalAddressInline=new MenuId("TunnelLocalAddressInline"),MenuId.TunnelOriginInline=new MenuId("TunnelOriginInline"),MenuId.ViewItemContext=new MenuId("ViewItemContext"),MenuId.ViewContainerTitle=new MenuId("ViewContainerTitle"),MenuId.ViewContainerTitleContext=new MenuId("ViewContainerTitleContext"),MenuId.ViewTitle=new MenuId("ViewTitle"),MenuId.ViewTitleContext=new MenuId("ViewTitleContext"),MenuId.CommentThreadTitle=new MenuId("CommentThreadTitle"),MenuId.CommentThreadActions=new MenuId("CommentThreadActions"),MenuId.CommentTitle=new MenuId("CommentTitle"),MenuId.CommentActions=new MenuId("CommentActions"),MenuId.InteractiveToolbar=new MenuId("InteractiveToolbar"),MenuId.InteractiveCellTitle=new MenuId("InteractiveCellTitle"),MenuId.InteractiveCellExecute=new MenuId("InteractiveCellExecute"),MenuId.InteractiveInputExecute=new MenuId("InteractiveInputExecute"),MenuId.NotebookToolbar=new MenuId("NotebookToolbar"),MenuId.NotebookCellTitle=new MenuId("NotebookCellTitle"),MenuId.NotebookCellInsert=new MenuId("NotebookCellInsert"),MenuId.NotebookCellBetween=new MenuId("NotebookCellBetween"),MenuId.NotebookCellListTop=new MenuId("NotebookCellTop"),MenuId.NotebookCellExecute=new MenuId("NotebookCellExecute"),MenuId.NotebookCellExecutePrimary=new MenuId("NotebookCellExecutePrimary"),MenuId.NotebookDiffCellInputTitle=new MenuId("NotebookDiffCellInputTitle"),MenuId.NotebookDiffCellMetadataTitle=new MenuId("NotebookDiffCellMetadataTitle"),MenuId.NotebookDiffCellOutputsTitle=new MenuId("NotebookDiffCellOutputsTitle"),MenuId.NotebookOutputToolbar=new MenuId("NotebookOutputToolbar"),MenuId.NotebookEditorLayoutConfigure=new MenuId("NotebookEditorLayoutConfigure"),MenuId.BulkEditTitle=new MenuId("BulkEditTitle"),MenuId.BulkEditContext=new MenuId("BulkEditContext"),MenuId.TimelineItemContext=new MenuId("TimelineItemContext"),MenuId.TimelineTitle=new MenuId("TimelineTitle"),MenuId.TimelineTitleContext=new MenuId("TimelineTitleContext"),MenuId.AccountsContext=new MenuId("AccountsContext"),MenuId.PanelTitle=new MenuId("PanelTitle"),MenuId.AuxiliaryBarTitle=new MenuId("AuxiliaryBarTitle"),MenuId.TerminalInstanceContext=new MenuId("TerminalInstanceContext"),MenuId.TerminalEditorInstanceContext=new MenuId("TerminalEditorInstanceContext"),MenuId.TerminalNewDropdownContext=new MenuId("TerminalNewDropdownContext"),MenuId.TerminalTabContext=new MenuId("TerminalTabContext"),MenuId.TerminalTabEmptyAreaContext=new MenuId("TerminalTabEmptyAreaContext"),MenuId.TerminalInlineTabContext=new MenuId("TerminalInlineTabContext"),MenuId.WebviewContext=new MenuId("WebviewContext"),MenuId.InlineCompletionsActions=new MenuId("InlineCompletionsActions"),MenuId.NewFile=new MenuId("NewFile"),exports.IMenuService=(0,instantiation_1.createDecorator)("menuService"),exports.MenuRegistry=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new event_1.Emitter,this.onDidChangeMenu=this._onDidChangeMenu.event,this._commandPaletteChangeEvent={has:id=>id===MenuId.CommandPalette}}addCommand(command){return this.addCommands(iterator_1.Iterable.single(command))}addCommands(commands){for(const command of commands)this._commands.set(command.id,command);return this._onDidChangeMenu.fire(this._commandPaletteChangeEvent),(0,lifecycle_1.toDisposable)((()=>{let didChange=!1;for(const command of commands)didChange=this._commands.delete(command.id)||didChange;didChange&&this._onDidChangeMenu.fire(this._commandPaletteChangeEvent)}))}getCommand(id){return this._commands.get(id)}getCommands(){const map=new Map;return this._commands.forEach(((value,key)=>map.set(key,value))),map}appendMenuItem(id,item){return this.appendMenuItems(iterator_1.Iterable.single({id,item}))}appendMenuItems(items){const changedIds=new Set,toRemove=new linkedList_1.LinkedList;for(const{id,item}of items){let list=this._menuItems.get(id);list||(list=new linkedList_1.LinkedList,this._menuItems.set(id,list)),toRemove.push(list.push(item)),changedIds.add(id)}return this._onDidChangeMenu.fire(changedIds),(0,lifecycle_1.toDisposable)((()=>{if(toRemove.size>0){for(let fn of toRemove)fn();this._onDidChangeMenu.fire(changedIds),toRemove.clear()}}))}getMenuItems(id){let result;return result=this._menuItems.has(id)?[...this._menuItems.get(id)]:[],id===MenuId.CommandPalette&&this._appendImplicitItems(result),result}_appendImplicitItems(result){const set=new Set;for(const item of result)isIMenuItem(item)&&(set.add(item.command.id),item.alt&&set.add(item.alt.id));this._commands.forEach(((command,id)=>{set.has(id)||result.push({command})}))}};class SubmenuItemAction extends actions_1.SubmenuAction{constructor(item,_menuService,_contextKeyService,_options){super(`submenuitem.${item.submenu.id}`,"string"==typeof item.title?item.title:item.title.value,[],"submenu"),this.item=item,this._menuService=_menuService,this._contextKeyService=_contextKeyService,this._options=_options}get actions(){const result=[],menu=this._menuService.createMenu(this.item.submenu,this._contextKeyService),groups=menu.getActions(this._options);menu.dispose();for(const[,actions]of groups)actions.length>0&&(result.push(...actions),result.push(new actions_1.Separator));return result.length&&result.pop(),result}}exports.SubmenuItemAction=SubmenuItemAction;let MenuItemAction=class MenuItemAction{constructor(item,alt,options,contextKeyService,_commandService){var _a,_b;if(this._commandService=_commandService,this.id=item.id,this.label=(null==options?void 0:options.renderShortTitle)&&item.shortTitle?"string"==typeof item.shortTitle?item.shortTitle:item.shortTitle.value:"string"==typeof item.title?item.title:item.title.value,this.tooltip=null!==(_b="string"==typeof item.tooltip?item.tooltip:null===(_a=item.tooltip)||void 0===_a?void 0:_a.value)&&void 0!==_b?_b:"",this.enabled=!item.precondition||contextKeyService.contextMatchesRules(item.precondition),this.checked=void 0,item.toggled){const toggled=item.toggled.condition?item.toggled:{condition:item.toggled};this.checked=contextKeyService.contextMatchesRules(toggled.condition),this.checked&&toggled.tooltip&&(this.tooltip="string"==typeof toggled.tooltip?toggled.tooltip:toggled.tooltip.value),toggled.title&&(this.label="string"==typeof toggled.title?toggled.title:toggled.title.value)}this.item=item,this.alt=alt?new MenuItemAction(alt,void 0,options,contextKeyService,_commandService):void 0,this._options=options,themeService_1.ThemeIcon.isThemeIcon(item.icon)&&(this.class=codicons_1.CSSIcon.asClassName(item.icon))}dispose(){}run(...args){var _a,_b;let runArgs=[];return(null===(_a=this._options)||void 0===_a?void 0:_a.arg)&&(runArgs=[...runArgs,this._options.arg]),(null===(_b=this._options)||void 0===_b?void 0:_b.shouldForwardArgs)&&(runArgs=[...runArgs,...args]),this._commandService.executeCommand(this.id,...runArgs)}};MenuItemAction=__decorate([__param(3,contextkey_1.IContextKeyService),__param(4,commands_1.ICommandService)],MenuItemAction),exports.MenuItemAction=MenuItemAction})),define(__m[15],__M([1,0,506,25,29,11,48,56,37,26,17,9,89,36,90,19,66]),(function(require,exports,nls,uri_1,codeEditorService_1,position_1,model_1,resolverService_1,actions_1,commands_1,contextkey_1,instantiation_1,keybindingsRegistry_1,platform_1,telemetry_1,types_1,log_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectAllCommand=exports.RedoCommand=exports.UndoCommand=exports.EditorExtensionsRegistry=exports.registerEditorContribution=exports.registerInstantiatedEditorAction=exports.registerMultiEditorAction=exports.registerEditorAction=exports.registerEditorCommand=exports.registerModelAndPositionCommand=exports.MultiEditorAction=exports.EditorAction=exports.EditorCommand=exports.ProxyCommand=exports.MultiCommand=exports.Command=void 0;class Command{constructor(opts){this.id=opts.id,this.precondition=opts.precondition,this._kbOpts=opts.kbOpts,this._menuOpts=opts.menuOpts,this._description=opts.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const kbOptsArr=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const kbOpts of kbOptsArr){let kbWhen=kbOpts.kbExpr;this.precondition&&(kbWhen=kbWhen?contextkey_1.ContextKeyExpr.and(kbWhen,this.precondition):this.precondition);const desc={id:this.id,weight:kbOpts.weight,args:kbOpts.args,when:kbWhen,primary:kbOpts.primary,secondary:kbOpts.secondary,win:kbOpts.win,linux:kbOpts.linux,mac:kbOpts.mac};keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule(desc)}}commands_1.CommandsRegistry.registerCommand({id:this.id,handler:(accessor,args)=>this.runCommand(accessor,args),description:this._description})}_registerMenuItem(item){actions_1.MenuRegistry.appendMenuItem(item.menuId,{group:item.group,command:{id:this.id,title:item.title,icon:item.icon,precondition:this.precondition},when:item.when,order:item.order})}}exports.Command=Command;class MultiCommand extends Command{constructor(){super(...arguments),this._implementations=[]}addImplementation(priority,name,implementation){return this._implementations.push({priority,name,implementation}),this._implementations.sort(((a,b)=>b.priority-a.priority)),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i].implementation===implementation)return void this._implementations.splice(i,1)}}}runCommand(accessor,args){const logService=accessor.get(log_1.ILogService);logService.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const impl of this._implementations){const result=impl.implementation(accessor,args);if(result){if(logService.trace(`Command '${this.id}' was handled by '${impl.name}'.`),"boolean"==typeof result)return;return result}}logService.trace(`The Command '${this.id}' was not handled by any implementation.`)}}exports.MultiCommand=MultiCommand;class ProxyCommand extends Command{constructor(command,opts){super(opts),this.command=command}runCommand(accessor,args){return this.command.runCommand(accessor,args)}}exports.ProxyCommand=ProxyCommand;class EditorCommand extends Command{static bindToContribution(controllerGetter){return class EditorControllerCommandImpl extends EditorCommand{constructor(opts){super(opts),this._callback=opts.handler}runEditorCommand(accessor,editor,args){const controller=controllerGetter(editor);controller&&this._callback(controller,args)}}}runCommand(accessor,args){const codeEditorService=accessor.get(codeEditorService_1.ICodeEditorService),editor=codeEditorService.getFocusedCodeEditor()||codeEditorService.getActiveCodeEditor();if(editor)return editor.invokeWithinContext((editorAccessor=>{if(editorAccessor.get(contextkey_1.IContextKeyService).contextMatchesRules((0,types_1.withNullAsUndefined)(this.precondition)))return this.runEditorCommand(editorAccessor,editor,args)}))}}exports.EditorCommand=EditorCommand;class EditorAction extends EditorCommand{constructor(opts){super(EditorAction.convertOptions(opts)),this.label=opts.label,this.alias=opts.alias}static convertOptions(opts){let menuOpts;function withDefaults(item){return item.menuId||(item.menuId=actions_1.MenuId.EditorContext),item.title||(item.title=opts.label),item.when=contextkey_1.ContextKeyExpr.and(opts.precondition,item.when),item}return menuOpts=Array.isArray(opts.menuOpts)?opts.menuOpts:opts.menuOpts?[opts.menuOpts]:[],Array.isArray(opts.contextMenuOpts)?menuOpts.push(...opts.contextMenuOpts.map(withDefaults)):opts.contextMenuOpts&&menuOpts.push(withDefaults(opts.contextMenuOpts)),opts.menuOpts=menuOpts,opts}runEditorCommand(accessor,editor,args){return this.reportTelemetry(accessor,editor),this.run(accessor,editor,args||{})}reportTelemetry(accessor,editor){accessor.get(telemetry_1.ITelemetryService).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}exports.EditorAction=EditorAction;exports.MultiEditorAction=class MultiEditorAction extends EditorAction{constructor(){super(...arguments),this._implementations=[]}addImplementation(priority,implementation){return this._implementations.push([priority,implementation]),this._implementations.sort(((a,b)=>b[0]-a[0])),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===implementation)return void this._implementations.splice(i,1)}}}run(accessor,editor,args){for(const impl of this._implementations){const result=impl[1](accessor,editor,args);if(result){if("boolean"==typeof result)return;return result}}}},exports.registerModelAndPositionCommand=function registerModelAndPositionCommand(id,handler){commands_1.CommandsRegistry.registerCommand(id,(function(accessor,...args){const instaService=accessor.get(instantiation_1.IInstantiationService),[resource,position]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource)),(0,types_1.assertType)(position_1.Position.isIPosition(position));const model=accessor.get(model_1.IModelService).getModel(resource);if(model){const editorPosition=position_1.Position.lift(position);return instaService.invokeFunction(handler,model,editorPosition,...args.slice(2))}return accessor.get(resolverService_1.ITextModelService).createModelReference(resource).then((reference=>new Promise(((resolve,reject)=>{try{resolve(instaService.invokeFunction(handler,reference.object.textEditorModel,position_1.Position.lift(position),args.slice(2)))}catch(err){reject(err)}})).finally((()=>{reference.dispose()}))))}))},exports.registerEditorCommand=function registerEditorCommand(editorCommand){return EditorContributionRegistry.INSTANCE.registerEditorCommand(editorCommand),editorCommand},exports.registerEditorAction=function registerEditorAction(ctor){const action=new ctor;return EditorContributionRegistry.INSTANCE.registerEditorAction(action),action},exports.registerMultiEditorAction=function registerMultiEditorAction(action){return EditorContributionRegistry.INSTANCE.registerEditorAction(action),action},exports.registerInstantiatedEditorAction=function registerInstantiatedEditorAction(editorAction){EditorContributionRegistry.INSTANCE.registerEditorAction(editorAction)},exports.registerEditorContribution=function registerEditorContribution(id,ctor){EditorContributionRegistry.INSTANCE.registerEditorContribution(id,ctor)},function(EditorExtensionsRegistry){EditorExtensionsRegistry.getEditorCommand=function getEditorCommand(commandId){return EditorContributionRegistry.INSTANCE.getEditorCommand(commandId)},EditorExtensionsRegistry.getEditorActions=function getEditorActions(){return EditorContributionRegistry.INSTANCE.getEditorActions()},EditorExtensionsRegistry.getEditorContributions=function getEditorContributions(){return EditorContributionRegistry.INSTANCE.getEditorContributions()},EditorExtensionsRegistry.getSomeEditorContributions=function getSomeEditorContributions(ids){return EditorContributionRegistry.INSTANCE.getEditorContributions().filter((c=>ids.indexOf(c.id)>=0))},EditorExtensionsRegistry.getDiffEditorContributions=function getDiffEditorContributions(){return EditorContributionRegistry.INSTANCE.getDiffEditorContributions()}}(exports.EditorExtensionsRegistry||(exports.EditorExtensionsRegistry={}));class EditorContributionRegistry{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(id,ctor){this.editorContributions.push({id,ctor})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(action){action.register(),this.editorActions.push(action)}getEditorActions(){return this.editorActions.slice(0)}registerEditorCommand(editorCommand){editorCommand.register(),this.editorCommands[editorCommand.id]=editorCommand}getEditorCommand(commandId){return this.editorCommands[commandId]||null}}function registerCommand(command){return command.register(),command}EditorContributionRegistry.INSTANCE=new EditorContributionRegistry,platform_1.Registry.add("editor.contributions",EditorContributionRegistry.INSTANCE),exports.UndoCommand=registerCommand(new MultiCommand({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:actions_1.MenuId.MenubarEditMenu,group:"1_do",title:nls.localize(0,null),order:1},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(1,null),order:1}]})),registerCommand(new ProxyCommand(exports.UndoCommand,{id:"default:undo",precondition:void 0})),exports.RedoCommand=registerCommand(new MultiCommand({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:actions_1.MenuId.MenubarEditMenu,group:"1_do",title:nls.localize(2,null),order:2},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(3,null),order:1}]})),registerCommand(new ProxyCommand(exports.RedoCommand,{id:"default:redo",precondition:void 0})),exports.SelectAllCommand=registerCommand(new MultiCommand({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"1_basic",title:nls.localize(4,null),order:1},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(5,null),order:1}]}))})),define(__m[158],__M([1,0,505,34,19,46,15,29,412,61,181,182,203,11,3,24,17,89]),(function(require,exports,nls,browser_1,types,aria_1,editorExtensions_1,codeEditorService_1,cursorColumnSelection_1,cursorCommon_1,cursorDeleteOperations_1,cursorMoveCommands_1,cursorTypeOperations_1,position_1,range_1,editorContextKeys_1,contextkey_1,keybindingsRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CoreEditingCommands=exports.CoreNavigationCommands=exports.RevealLine_=exports.EditorScroll_=exports.CoreEditorCommand=void 0;class CoreEditorCommand extends editorExtensions_1.EditorCommand{runEditorCommand(accessor,editor,args){const viewModel=editor._getViewModel();viewModel&&this.runCoreEditorCommand(viewModel,args||{})}}var EditorScroll_,RevealLine_,CoreNavigationCommands;exports.CoreEditorCommand=CoreEditorCommand,function(EditorScroll_){EditorScroll_.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t",constraint:function(arg){if(!types.isObject(arg))return!1;const scrollArg=arg;return!!types.isString(scrollArg.to)&&(!(!types.isUndefined(scrollArg.by)&&!types.isString(scrollArg.by))&&(!(!types.isUndefined(scrollArg.value)&&!types.isNumber(scrollArg.value))&&!(!types.isUndefined(scrollArg.revealCursor)&&!types.isBoolean(scrollArg.revealCursor))))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},EditorScroll_.RawDirection={Up:"up",Down:"down"},EditorScroll_.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage"},EditorScroll_.parse=function parse(args){let direction,unit;switch(args.to){case EditorScroll_.RawDirection.Up:direction=1;break;case EditorScroll_.RawDirection.Down:direction=2;break;default:return null}switch(args.by){case EditorScroll_.RawUnit.Line:unit=1;break;case EditorScroll_.RawUnit.WrappedLine:unit=2;break;case EditorScroll_.RawUnit.Page:unit=3;break;case EditorScroll_.RawUnit.HalfPage:unit=4;break;default:unit=2}return{direction,unit,value:Math.floor(args.value||1),revealCursor:!!args.revealCursor,select:!!args.select}}}(EditorScroll_=exports.EditorScroll_||(exports.EditorScroll_={})),function(RevealLine_){RevealLine_.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t```\n\t\t\t\t",constraint:function(arg){if(!types.isObject(arg))return!1;const reveaLineArg=arg;return!(!types.isNumber(reveaLineArg.lineNumber)&&!types.isString(reveaLineArg.lineNumber))&&!(!types.isUndefined(reveaLineArg.at)&&!types.isString(reveaLineArg.at))},schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},RevealLine_.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}}(RevealLine_=exports.RevealLine_||(exports.RevealLine_={}));class EditorOrNativeTextInputCommand{constructor(target){target.addImplementation(1e4,"code-editor",((accessor,args)=>{const focusedEditor=accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();return!(!focusedEditor||!focusedEditor.hasTextFocus())&&this._runEditorCommand(accessor,focusedEditor,args)})),target.addImplementation(1e3,"generic-dom-input-textarea",((accessor,args)=>{const activeElement=document.activeElement;return!!(activeElement&&["input","textarea"].indexOf(activeElement.tagName.toLowerCase())>=0)&&(this.runDOMCommand(),!0)})),target.addImplementation(0,"generic-dom",((accessor,args)=>{const activeEditor=accessor.get(codeEditorService_1.ICodeEditorService).getActiveCodeEditor();return!!activeEditor&&(activeEditor.focus(),this._runEditorCommand(accessor,activeEditor,args))}))}_runEditorCommand(accessor,editor,args){const result=this.runEditorCommand(accessor,editor,args);return result||!0}}!function(CoreNavigationCommands){class BaseMoveToCommand extends CoreEditorCommand{constructor(opts){super(opts),this._minimalReveal=opts.minimalReveal,this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement();viewModel.setCursorStates(args.source,3,[cursorMoveCommands_1.CursorMoveCommands.moveTo(viewModel,viewModel.getPrimaryCursorState(),this._inSelectionMode,args.position,args.viewPosition)])&&viewModel.revealPrimaryCursor(args.source,!0,this._minimalReveal)}}CoreNavigationCommands.MoveTo=(0,editorExtensions_1.registerEditorCommand)(new BaseMoveToCommand({id:"_moveTo",minimalReveal:!0,inSelectionMode:!1,precondition:void 0})),CoreNavigationCommands.MoveToSelect=(0,editorExtensions_1.registerEditorCommand)(new BaseMoveToCommand({id:"_moveToSelect",minimalReveal:!1,inSelectionMode:!0,precondition:void 0}));class ColumnSelectCommand extends CoreEditorCommand{runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement();const result=this._getColumnSelectResult(viewModel,viewModel.getPrimaryCursorState(),viewModel.getCursorColumnSelectData(),args);viewModel.setCursorStates(args.source,3,result.viewStates.map((viewState=>cursorCommon_1.CursorState.fromViewState(viewState)))),viewModel.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:result.fromLineNumber,fromViewVisualColumn:result.fromVisualColumn,toViewLineNumber:result.toLineNumber,toViewVisualColumn:result.toVisualColumn}),result.reversed?viewModel.revealTopMostCursor(args.source):viewModel.revealBottomMostCursor(args.source)}}CoreNavigationCommands.ColumnSelect=(0,editorExtensions_1.registerEditorCommand)(new class extends ColumnSelectCommand{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(viewModel,primary,prevColumnSelectData,args){const validatedPosition=viewModel.model.validatePosition(args.position),validatedViewPosition=viewModel.coordinatesConverter.validateViewPosition(new position_1.Position(args.viewPosition.lineNumber,args.viewPosition.column),validatedPosition),fromViewLineNumber=args.doColumnSelect?prevColumnSelectData.fromViewLineNumber:validatedViewPosition.lineNumber,fromViewVisualColumn=args.doColumnSelect?prevColumnSelectData.fromViewVisualColumn:args.mouseColumn-1;return cursorColumnSelection_1.ColumnSelection.columnSelect(viewModel.cursorConfig,viewModel,fromViewLineNumber,fromViewVisualColumn,validatedViewPosition.lineNumber,args.mouseColumn-1)}}),CoreNavigationCommands.CursorColumnSelectLeft=(0,editorExtensions_1.registerEditorCommand)(new class extends ColumnSelectCommand{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(viewModel,primary,prevColumnSelectData,args){return cursorColumnSelection_1.ColumnSelection.columnSelectLeft(viewModel.cursorConfig,viewModel,prevColumnSelectData)}}),CoreNavigationCommands.CursorColumnSelectRight=(0,editorExtensions_1.registerEditorCommand)(new class extends ColumnSelectCommand{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(viewModel,primary,prevColumnSelectData,args){return cursorColumnSelection_1.ColumnSelection.columnSelectRight(viewModel.cursorConfig,viewModel,prevColumnSelectData)}});class ColumnSelectUpCommand extends ColumnSelectCommand{constructor(opts){super(opts),this._isPaged=opts.isPaged}_getColumnSelectResult(viewModel,primary,prevColumnSelectData,args){return cursorColumnSelection_1.ColumnSelection.columnSelectUp(viewModel.cursorConfig,viewModel,prevColumnSelectData,this._isPaged)}}CoreNavigationCommands.CursorColumnSelectUp=(0,editorExtensions_1.registerEditorCommand)(new ColumnSelectUpCommand({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3600,linux:{primary:0}}})),CoreNavigationCommands.CursorColumnSelectPageUp=(0,editorExtensions_1.registerEditorCommand)(new ColumnSelectUpCommand({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3595,linux:{primary:0}}}));class ColumnSelectDownCommand extends ColumnSelectCommand{constructor(opts){super(opts),this._isPaged=opts.isPaged}_getColumnSelectResult(viewModel,primary,prevColumnSelectData,args){return cursorColumnSelection_1.ColumnSelection.columnSelectDown(viewModel.cursorConfig,viewModel,prevColumnSelectData,this._isPaged)}}CoreNavigationCommands.CursorColumnSelectDown=(0,editorExtensions_1.registerEditorCommand)(new ColumnSelectDownCommand({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3602,linux:{primary:0}}})),CoreNavigationCommands.CursorColumnSelectPageDown=(0,editorExtensions_1.registerEditorCommand)(new ColumnSelectDownCommand({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3596,linux:{primary:0}}}));class CursorMoveImpl extends CoreEditorCommand{constructor(){super({id:"cursorMove",precondition:void 0,description:cursorMoveCommands_1.CursorMove.description})}runCoreEditorCommand(viewModel,args){const parsed=cursorMoveCommands_1.CursorMove.parse(args);parsed&&this._runCursorMove(viewModel,args.source,parsed)}_runCursorMove(viewModel,source,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(source,3,CursorMoveImpl._move(viewModel,viewModel.getCursorStates(),args)),viewModel.revealPrimaryCursor(source,!0)}static _move(viewModel,cursors,args){const inSelectionMode=args.select,value=args.value;switch(args.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return cursorMoveCommands_1.CursorMoveCommands.simpleMove(viewModel,cursors,args.direction,inSelectionMode,value,args.unit);case 11:case 13:case 12:case 14:return cursorMoveCommands_1.CursorMoveCommands.viewportMove(viewModel,cursors,args.direction,inSelectionMode,value);default:return null}}}CoreNavigationCommands.CursorMoveImpl=CursorMoveImpl,CoreNavigationCommands.CursorMove=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveImpl);class CursorMoveBasedCommand extends CoreEditorCommand{constructor(opts){super(opts),this._staticArgs=opts.args}runCoreEditorCommand(viewModel,dynamicArgs){let args=this._staticArgs;-1===this._staticArgs.value&&(args={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:dynamicArgs.pageSize||viewModel.cursorConfig.pageSize}),viewModel.model.pushStackElement(),viewModel.setCursorStates(dynamicArgs.source,3,cursorMoveCommands_1.CursorMoveCommands.simpleMove(viewModel,viewModel.getCursorStates(),args.direction,args.select,args.value,args.unit)),viewModel.revealPrimaryCursor(dynamicArgs.source,!0)}}CoreNavigationCommands.CursorLeft=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),CoreNavigationCommands.CursorLeftSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1039}})),CoreNavigationCommands.CursorRight=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),CoreNavigationCommands.CursorRightSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1041}})),CoreNavigationCommands.CursorUp=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),CoreNavigationCommands.CursorUpSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),CoreNavigationCommands.CursorPageUp=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:11}})),CoreNavigationCommands.CursorPageUpSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1035}})),CoreNavigationCommands.CursorDown=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),CoreNavigationCommands.CursorDownSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),CoreNavigationCommands.CursorPageDown=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:12}})),CoreNavigationCommands.CursorPageDownSelect=(0,editorExtensions_1.registerEditorCommand)(new CursorMoveBasedCommand({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1036}})),CoreNavigationCommands.CreateCursor=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(viewModel,args){let newState;newState=args.wholeLine?cursorMoveCommands_1.CursorMoveCommands.line(viewModel,viewModel.getPrimaryCursorState(),!1,args.position,args.viewPosition):cursorMoveCommands_1.CursorMoveCommands.moveTo(viewModel,viewModel.getPrimaryCursorState(),!1,args.position,args.viewPosition);const states=viewModel.getCursorStates();if(states.length>1){const newModelPosition=newState.modelState?newState.modelState.position:null,newViewPosition=newState.viewState?newState.viewState.position:null;for(let i=0,len=states.length;i<len;i++){const state=states[i];if((!newModelPosition||state.modelState.selection.containsPosition(newModelPosition))&&(!newViewPosition||state.viewState.selection.containsPosition(newViewPosition)))return states.splice(i,1),viewModel.model.pushStackElement(),void viewModel.setCursorStates(args.source,3,states)}}states.push(newState),viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,states)}}),CoreNavigationCommands.LastCursorMoveToSelect=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(viewModel,args){const lastAddedCursorIndex=viewModel.getLastAddedCursorIndex(),states=viewModel.getCursorStates(),newStates=states.slice(0);newStates[lastAddedCursorIndex]=cursorMoveCommands_1.CursorMoveCommands.moveTo(viewModel,states[lastAddedCursorIndex],!0,args.position,args.viewPosition),viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,newStates)}});class HomeCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.moveToBeginningOfLine(viewModel,viewModel.getCursorStates(),this._inSelectionMode)),viewModel.revealPrimaryCursor(args.source,!0)}}CoreNavigationCommands.CursorHome=(0,editorExtensions_1.registerEditorCommand)(new HomeCommand({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),CoreNavigationCommands.CursorHomeSelect=(0,editorExtensions_1.registerEditorCommand)(new HomeCommand({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class LineStartCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,this._exec(viewModel.getCursorStates())),viewModel.revealPrimaryCursor(args.source,!0)}_exec(cursors){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],lineNumber=cursor.modelState.position.lineNumber;result[i]=cursorCommon_1.CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode,lineNumber,1,0))}return result}}CoreNavigationCommands.CursorLineStart=(0,editorExtensions_1.registerEditorCommand)(new LineStartCommand({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:287}}})),CoreNavigationCommands.CursorLineStartSelect=(0,editorExtensions_1.registerEditorCommand)(new LineStartCommand({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:1311}}}));class EndCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.moveToEndOfLine(viewModel,viewModel.getCursorStates(),this._inSelectionMode,args.sticky||!1)),viewModel.revealPrimaryCursor(args.source,!0)}}CoreNavigationCommands.CursorEnd=(0,editorExtensions_1.registerEditorCommand)(new EndCommand({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:nls.localize(0,null),type:"boolean",default:!1}}}}]}})),CoreNavigationCommands.CursorEndSelect=(0,editorExtensions_1.registerEditorCommand)(new EndCommand({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:nls.localize(1,null),type:"boolean",default:!1}}}}]}}));class LineEndCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,this._exec(viewModel,viewModel.getCursorStates())),viewModel.revealPrimaryCursor(args.source,!0)}_exec(viewModel,cursors){const result=[];for(let i=0,len=cursors.length;i<len;i++){const cursor=cursors[i],lineNumber=cursor.modelState.position.lineNumber,maxColumn=viewModel.model.getLineMaxColumn(lineNumber);result[i]=cursorCommon_1.CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode,lineNumber,maxColumn,0))}return result}}CoreNavigationCommands.CursorLineEnd=(0,editorExtensions_1.registerEditorCommand)(new LineEndCommand({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:291}}})),CoreNavigationCommands.CursorLineEndSelect=(0,editorExtensions_1.registerEditorCommand)(new LineEndCommand({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:1315}}}));class TopCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.moveToBeginningOfBuffer(viewModel,viewModel.getCursorStates(),this._inSelectionMode)),viewModel.revealPrimaryCursor(args.source,!0)}}CoreNavigationCommands.CursorTop=(0,editorExtensions_1.registerEditorCommand)(new TopCommand({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2062,mac:{primary:2064}}})),CoreNavigationCommands.CursorTopSelect=(0,editorExtensions_1.registerEditorCommand)(new TopCommand({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3086,mac:{primary:3088}}}));class BottomCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.moveToEndOfBuffer(viewModel,viewModel.getCursorStates(),this._inSelectionMode)),viewModel.revealPrimaryCursor(args.source,!0)}}CoreNavigationCommands.CursorBottom=(0,editorExtensions_1.registerEditorCommand)(new BottomCommand({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2061,mac:{primary:2066}}})),CoreNavigationCommands.CursorBottomSelect=(0,editorExtensions_1.registerEditorCommand)(new BottomCommand({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3085,mac:{primary:3090}}}));class EditorScrollImpl extends CoreEditorCommand{constructor(){super({id:"editorScroll",precondition:void 0,description:EditorScroll_.description})}runCoreEditorCommand(viewModel,args){const parsed=EditorScroll_.parse(args);parsed&&this._runEditorScroll(viewModel,args.source,parsed)}_runEditorScroll(viewModel,source,args){const desiredScrollTop=this._computeDesiredScrollTop(viewModel,args);if(args.revealCursor){const desiredVisibleViewRange=viewModel.getCompletelyVisibleViewRangeAtScrollTop(desiredScrollTop);viewModel.setCursorStates(source,3,[cursorMoveCommands_1.CursorMoveCommands.findPositionInViewportIfOutside(viewModel,viewModel.getPrimaryCursorState(),desiredVisibleViewRange,args.select)])}viewModel.viewLayout.setScrollPosition({scrollTop:desiredScrollTop},0)}_computeDesiredScrollTop(viewModel,args){if(1===args.unit){const visibleViewRange=viewModel.getCompletelyVisibleViewRange(),visibleModelRange=viewModel.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);let desiredTopModelLineNumber;desiredTopModelLineNumber=1===args.direction?Math.max(1,visibleModelRange.startLineNumber-args.value):Math.min(viewModel.model.getLineCount(),visibleModelRange.startLineNumber+args.value);const viewPosition=viewModel.coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(desiredTopModelLineNumber,1));return viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber)}let noOfLines;noOfLines=3===args.unit?viewModel.cursorConfig.pageSize*args.value:4===args.unit?Math.round(viewModel.cursorConfig.pageSize/2)*args.value:args.value;const deltaLines=(1===args.direction?-1:1)*noOfLines;return viewModel.viewLayout.getCurrentScrollTop()+deltaLines*viewModel.cursorConfig.lineHeight}}CoreNavigationCommands.EditorScrollImpl=EditorScrollImpl,CoreNavigationCommands.EditorScroll=(0,editorExtensions_1.registerEditorCommand)(new EditorScrollImpl),CoreNavigationCommands.ScrollLineUp=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(viewModel,args){CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel,args.source,{direction:1,unit:2,value:1,revealCursor:!1,select:!1})}}),CoreNavigationCommands.ScrollPageUp=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(viewModel,args){CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel,args.source,{direction:1,unit:3,value:1,revealCursor:!1,select:!1})}}),CoreNavigationCommands.ScrollLineDown=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(viewModel,args){CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel,args.source,{direction:2,unit:2,value:1,revealCursor:!1,select:!1})}}),CoreNavigationCommands.ScrollPageDown=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(viewModel,args){CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel,args.source,{direction:2,unit:3,value:1,revealCursor:!1,select:!1})}});class WordCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,[cursorMoveCommands_1.CursorMoveCommands.word(viewModel,viewModel.getPrimaryCursorState(),this._inSelectionMode,args.position)]),viewModel.revealPrimaryCursor(args.source,!0)}}CoreNavigationCommands.WordSelect=(0,editorExtensions_1.registerEditorCommand)(new WordCommand({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),CoreNavigationCommands.WordSelectDrag=(0,editorExtensions_1.registerEditorCommand)(new WordCommand({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),CoreNavigationCommands.LastCursorWordSelect=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(viewModel,args){const lastAddedCursorIndex=viewModel.getLastAddedCursorIndex(),states=viewModel.getCursorStates(),newStates=states.slice(0),lastAddedState=states[lastAddedCursorIndex];newStates[lastAddedCursorIndex]=cursorMoveCommands_1.CursorMoveCommands.word(viewModel,lastAddedState,lastAddedState.modelState.hasSelection(),args.position),viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,newStates)}});class LineCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,[cursorMoveCommands_1.CursorMoveCommands.line(viewModel,viewModel.getPrimaryCursorState(),this._inSelectionMode,args.position,args.viewPosition)]),viewModel.revealPrimaryCursor(args.source,!1)}}CoreNavigationCommands.LineSelect=(0,editorExtensions_1.registerEditorCommand)(new LineCommand({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),CoreNavigationCommands.LineSelectDrag=(0,editorExtensions_1.registerEditorCommand)(new LineCommand({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class LastCursorLineCommand extends CoreEditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode}runCoreEditorCommand(viewModel,args){const lastAddedCursorIndex=viewModel.getLastAddedCursorIndex(),states=viewModel.getCursorStates(),newStates=states.slice(0);newStates[lastAddedCursorIndex]=cursorMoveCommands_1.CursorMoveCommands.line(viewModel,states[lastAddedCursorIndex],this._inSelectionMode,args.position,args.viewPosition),viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,newStates)}}CoreNavigationCommands.LastCursorLineSelect=(0,editorExtensions_1.registerEditorCommand)(new LastCursorLineCommand({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),CoreNavigationCommands.LastCursorLineSelectDrag=(0,editorExtensions_1.registerEditorCommand)(new LastCursorLineCommand({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),CoreNavigationCommands.CancelSelection=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"cancelSelection",precondition:editorContextKeys_1.EditorContextKeys.hasNonEmptySelection,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,[cursorMoveCommands_1.CursorMoveCommands.cancelSelection(viewModel,viewModel.getPrimaryCursorState())]),viewModel.revealPrimaryCursor(args.source,!0)}}),CoreNavigationCommands.RemoveSecondaryCursors=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"removeSecondaryCursors",precondition:editorContextKeys_1.EditorContextKeys.hasMultipleSelections,kbOpts:{weight:1,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,[viewModel.getPrimaryCursorState()]),viewModel.revealPrimaryCursor(args.source,!0),(0,aria_1.status)(nls.localize(2,null))}}),CoreNavigationCommands.RevealLine=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"revealLine",precondition:void 0,description:RevealLine_.description})}runCoreEditorCommand(viewModel,args){const revealLineArg=args,lineNumberArg=revealLineArg.lineNumber||0;let lineNumber="number"==typeof lineNumberArg?lineNumberArg+1:parseInt(lineNumberArg)+1;lineNumber<1&&(lineNumber=1);const lineCount=viewModel.model.getLineCount();lineNumber>lineCount&&(lineNumber=lineCount);const range=new range_1.Range(lineNumber,1,lineNumber,viewModel.model.getLineMaxColumn(lineNumber));let revealAt=0;if(revealLineArg.at)switch(revealLineArg.at){case RevealLine_.RawAtArgument.Top:revealAt=3;break;case RevealLine_.RawAtArgument.Center:revealAt=1;break;case RevealLine_.RawAtArgument.Bottom:revealAt=4}const viewRange=viewModel.coordinatesConverter.convertModelRangeToViewRange(range);viewModel.revealRange(args.source,!1,viewRange,revealAt,0)}}),CoreNavigationCommands.SelectAll=new class extends EditorOrNativeTextInputCommand{constructor(){super(editorExtensions_1.SelectAllCommand)}runDOMCommand(){browser_1.isFirefox&&(document.activeElement.focus(),document.activeElement.select()),document.execCommand("selectAll")}runEditorCommand(accessor,editor,args){const viewModel=editor._getViewModel();viewModel&&this.runCoreEditorCommand(viewModel,args)}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates("keyboard",3,[cursorMoveCommands_1.CursorMoveCommands.selectAll(viewModel,viewModel.getPrimaryCursorState())])}},CoreNavigationCommands.SetSelection=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditorCommand{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(viewModel,args){viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,[cursorCommon_1.CursorState.fromModelSelection(args.selection)])}})}(CoreNavigationCommands=exports.CoreNavigationCommands||(exports.CoreNavigationCommands={}));const columnSelectionCondition=contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,editorContextKeys_1.EditorContextKeys.columnSelection);function registerColumnSelection(id,keybinding){keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({id,primary:keybinding,when:columnSelectionCondition,weight:1})}function registerCommand(command){return command.register(),command}registerColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id,1039),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id,1041),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id,1040),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id,1035),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id,1042),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id,1036),function(CoreEditingCommands){class CoreEditingCommand extends editorExtensions_1.EditorCommand{runEditorCommand(accessor,editor,args){const viewModel=editor._getViewModel();viewModel&&this.runCoreEditingCommand(editor,viewModel,args||{})}}CoreEditingCommands.CoreEditingCommand=CoreEditingCommand,CoreEditingCommands.LineBreakInsert=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditingCommand{constructor(){super({id:"lineBreakInsert",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(editor,viewModel,args){editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.lineBreakInsert(viewModel.cursorConfig,viewModel.model,viewModel.getCursorStates().map((s=>s.modelState.selection))))}}),CoreEditingCommands.Outdent=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditingCommand{constructor(){super({id:"outdent",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{weight:0,kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.editorTextFocus,editorContextKeys_1.EditorContextKeys.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(editor,viewModel,args){editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.outdent(viewModel.cursorConfig,viewModel.model,viewModel.getCursorStates().map((s=>s.modelState.selection)))),editor.pushUndoStop()}}),CoreEditingCommands.Tab=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditingCommand{constructor(){super({id:"tab",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{weight:0,kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.editorTextFocus,editorContextKeys_1.EditorContextKeys.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(editor,viewModel,args){editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.tab(viewModel.cursorConfig,viewModel.model,viewModel.getCursorStates().map((s=>s.modelState.selection)))),editor.pushUndoStop()}}),CoreEditingCommands.DeleteLeft=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditingCommand{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(editor,viewModel,args){const[shouldPushStackElementBefore,commands]=cursorDeleteOperations_1.DeleteOperations.deleteLeft(viewModel.getPrevEditOperationType(),viewModel.cursorConfig,viewModel.model,viewModel.getCursorStates().map((s=>s.modelState.selection)),viewModel.getCursorAutoClosedCharacters());shouldPushStackElementBefore&&editor.pushUndoStop(),editor.executeCommands(this.id,commands),viewModel.setPrevEditOperationType(2)}}),CoreEditingCommands.DeleteRight=(0,editorExtensions_1.registerEditorCommand)(new class extends CoreEditingCommand{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(editor,viewModel,args){const[shouldPushStackElementBefore,commands]=cursorDeleteOperations_1.DeleteOperations.deleteRight(viewModel.getPrevEditOperationType(),viewModel.cursorConfig,viewModel.model,viewModel.getCursorStates().map((s=>s.modelState.selection)));shouldPushStackElementBefore&&editor.pushUndoStop(),editor.executeCommands(this.id,commands),viewModel.setPrevEditOperationType(3)}}),CoreEditingCommands.Undo=new class extends EditorOrNativeTextInputCommand{constructor(){super(editorExtensions_1.UndoCommand)}runDOMCommand(){document.execCommand("undo")}runEditorCommand(accessor,editor,args){if(editor.hasModel()&&!0!==editor.getOption(81))return editor.getModel().undo()}},CoreEditingCommands.Redo=new class extends EditorOrNativeTextInputCommand{constructor(){super(editorExtensions_1.RedoCommand)}runDOMCommand(){document.execCommand("redo")}runEditorCommand(accessor,editor,args){if(editor.hasModel()&&!0!==editor.getOption(81))return editor.getModel().redo()}}}(exports.CoreEditingCommands||(exports.CoreEditingCommands={}));class EditorHandlerCommand extends editorExtensions_1.Command{constructor(id,handlerId,description){super({id,precondition:void 0,description}),this._handlerId=handlerId}runCommand(accessor,args){const editor=accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();editor&&editor.trigger("keyboard",this._handlerId,args)}}function registerOverwritableCommand(handlerId,description){registerCommand(new EditorHandlerCommand("default:"+handlerId,handlerId)),registerCommand(new EditorHandlerCommand(handlerId,handlerId,description))}registerOverwritableCommand("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]}),registerOverwritableCommand("replacePreviousChar"),registerOverwritableCommand("compositionType"),registerOverwritableCommand("compositionStart"),registerOverwritableCommand("compositionEnd"),registerOverwritableCommand("paste"),registerOverwritableCommand("cut")})),define(__m[668],__M([1,0,201,15]),(function(require,exports,markerDecorations_1,editorExtensions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkerDecorationsContribution=void 0;let MarkerDecorationsContribution=class MarkerDecorationsContribution{constructor(_editor,_markerDecorationsService){}dispose(){}};MarkerDecorationsContribution.ID="editor.contrib.markerDecorations",MarkerDecorationsContribution=__decorate([__param(1,markerDecorations_1.IMarkerDecorationsService)],MarkerDecorationsContribution),exports.MarkerDecorationsContribution=MarkerDecorationsContribution,(0,editorExtensions_1.registerEditorContribution)(MarkerDecorationsContribution.ID,MarkerDecorationsContribution)})),define(__m[669],__M([1,0,158,11,16]),(function(require,exports,coreCommands_1,position_1,platform){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewController=void 0;exports.ViewController=class ViewController{constructor(configuration,viewModel,userInputEvents,commandDelegate){this.configuration=configuration,this.viewModel=viewModel,this.userInputEvents=userInputEvents,this.commandDelegate=commandDelegate}paste(text,pasteOnNewLine,multicursorText,mode){this.commandDelegate.paste(text,pasteOnNewLine,multicursorText,mode)}type(text){this.commandDelegate.type(text)}compositionType(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta){this.commandDelegate.compositionType(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(modelSelection){coreCommands_1.CoreNavigationCommands.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:modelSelection})}_validateViewColumn(viewPosition){const minColumn=this.viewModel.getLineMinColumn(viewPosition.lineNumber);return viewPosition.column<minColumn?new position_1.Position(viewPosition.lineNumber,minColumn):viewPosition}_hasMulticursorModifier(data){switch(this.configuration.options.get(70)){case"altKey":return data.altKey;case"ctrlKey":return data.ctrlKey;case"metaKey":return data.metaKey;default:return!1}}_hasNonMulticursorModifier(data){switch(this.configuration.options.get(70)){case"altKey":return data.ctrlKey||data.metaKey;case"ctrlKey":return data.altKey||data.metaKey;case"metaKey":return data.ctrlKey||data.altKey;default:return!1}}dispatchMouse(data){const options=this.configuration.options,selectionClipboardIsOn=platform.isLinux&&options.get(96),columnSelection=options.get(18);data.middleButton&&!selectionClipboardIsOn?this._columnSelect(data.position,data.mouseColumn,data.inSelectionMode):data.startedOnLineNumbers?this._hasMulticursorModifier(data)?data.inSelectionMode?this._lastCursorLineSelect(data.position):this._createCursor(data.position,!0):data.inSelectionMode?this._lineSelectDrag(data.position):this._lineSelect(data.position):data.mouseDownCount>=4?this._selectAll():3===data.mouseDownCount?this._hasMulticursorModifier(data)?data.inSelectionMode?this._lastCursorLineSelectDrag(data.position):this._lastCursorLineSelect(data.position):data.inSelectionMode?this._lineSelectDrag(data.position):this._lineSelect(data.position):2===data.mouseDownCount?data.onInjectedText||(this._hasMulticursorModifier(data)?this._lastCursorWordSelect(data.position):data.inSelectionMode?this._wordSelectDrag(data.position):this._wordSelect(data.position)):this._hasMulticursorModifier(data)?this._hasNonMulticursorModifier(data)||(data.shiftKey?this._columnSelect(data.position,data.mouseColumn,!0):data.inSelectionMode?this._lastCursorMoveToSelect(data.position):this._createCursor(data.position,!1)):data.inSelectionMode?data.altKey||columnSelection?this._columnSelect(data.position,data.mouseColumn,!0):this._moveToSelect(data.position):this.moveTo(data.position)}_usualArgs(viewPosition){return viewPosition=this._validateViewColumn(viewPosition),{source:"mouse",position:this._convertViewToModelPosition(viewPosition),viewPosition}}moveTo(viewPosition){coreCommands_1.CoreNavigationCommands.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_moveToSelect(viewPosition){coreCommands_1.CoreNavigationCommands.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_columnSelect(viewPosition,mouseColumn,doColumnSelect){viewPosition=this._validateViewColumn(viewPosition),coreCommands_1.CoreNavigationCommands.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(viewPosition),viewPosition,mouseColumn,doColumnSelect})}_createCursor(viewPosition,wholeLine){viewPosition=this._validateViewColumn(viewPosition),coreCommands_1.CoreNavigationCommands.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(viewPosition),viewPosition,wholeLine})}_lastCursorMoveToSelect(viewPosition){coreCommands_1.CoreNavigationCommands.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_wordSelect(viewPosition){coreCommands_1.CoreNavigationCommands.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_wordSelectDrag(viewPosition){coreCommands_1.CoreNavigationCommands.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_lastCursorWordSelect(viewPosition){coreCommands_1.CoreNavigationCommands.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_lineSelect(viewPosition){coreCommands_1.CoreNavigationCommands.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_lineSelectDrag(viewPosition){coreCommands_1.CoreNavigationCommands.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_lastCursorLineSelect(viewPosition){coreCommands_1.CoreNavigationCommands.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_lastCursorLineSelectDrag(viewPosition){coreCommands_1.CoreNavigationCommands.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(viewPosition))}_selectAll(){coreCommands_1.CoreNavigationCommands.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(viewPosition){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(viewPosition)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}})),define(__m[670],__M([1,0,7,22,31,13,645,654,669,235,516,51,445,652,446,648,188,653,286,646,447,254,448,649,449,655,455,656,650,651,657,450,11,3,118,456,452,125,14,285]),(function(require,exports,dom,selection_1,fastDomNode_1,errors_1,pointerHandler_1,textAreaHandler_1,viewController_1,viewUserInputEvents_1,viewOverlays_1,viewPart_1,contentWidgets_1,currentLineHighlight_1,decorations_1,editorScrollbar_1,glyphMargin_1,indentGuides_1,lineNumbers_1,viewLines_1,linesDecorations_1,margin_1,marginDecorations_1,minimap_1,overlayWidgets_1,decorationsOverviewRuler_1,overviewRuler_1,rulers_1,scrollDecoration_1,selections_1,viewCursors_1,viewZones_1,position_1,range_1,renderingContext_1,viewContext_1,viewLinesViewportData_1,viewEventHandler_1,themeService_1,mouseTarget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.View=void 0;class View extends viewEventHandler_1.ViewEventHandler{constructor(commandDelegate,configuration,colorTheme,model,userInputEvents,overflowWidgetsDomNode){super(),this._selections=[new selection_1.Selection(1,1,1,1)],this._renderAnimationFrame=null;const viewController=new viewController_1.ViewController(configuration,model,userInputEvents,commandDelegate);this._context=new viewContext_1.ViewContext(configuration,colorTheme,model),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=new textAreaHandler_1.TextAreaHandler(this._context,viewController,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),viewPart_1.PartFingerprints.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new editorScrollbar_1.EditorScrollbar(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new viewLines_1.ViewLines(this._context,this._linesContent),this._viewZones=new viewZones_1.ViewZones(this._context),this._viewParts.push(this._viewZones);const decorationsOverviewRuler=new decorationsOverviewRuler_1.DecorationsOverviewRuler(this._context);this._viewParts.push(decorationsOverviewRuler);const scrollDecoration=new scrollDecoration_1.ScrollDecorationViewPart(this._context);this._viewParts.push(scrollDecoration);const contentViewOverlays=new viewOverlays_1.ContentViewOverlays(this._context);this._viewParts.push(contentViewOverlays),contentViewOverlays.addDynamicOverlay(new currentLineHighlight_1.CurrentLineHighlightOverlay(this._context)),contentViewOverlays.addDynamicOverlay(new selections_1.SelectionsOverlay(this._context)),contentViewOverlays.addDynamicOverlay(new indentGuides_1.IndentGuidesOverlay(this._context)),contentViewOverlays.addDynamicOverlay(new decorations_1.DecorationsOverlay(this._context));const marginViewOverlays=new viewOverlays_1.MarginViewOverlays(this._context);this._viewParts.push(marginViewOverlays),marginViewOverlays.addDynamicOverlay(new currentLineHighlight_1.CurrentLineMarginHighlightOverlay(this._context)),marginViewOverlays.addDynamicOverlay(new glyphMargin_1.GlyphMarginOverlay(this._context)),marginViewOverlays.addDynamicOverlay(new marginDecorations_1.MarginViewLineDecorationsOverlay(this._context)),marginViewOverlays.addDynamicOverlay(new linesDecorations_1.LinesDecorationsOverlay(this._context)),marginViewOverlays.addDynamicOverlay(new lineNumbers_1.LineNumbersOverlay(this._context));const margin=new margin_1.Margin(this._context);margin.getDomNode().appendChild(this._viewZones.marginDomNode),margin.getDomNode().appendChild(marginViewOverlays.getDomNode()),this._viewParts.push(margin),this._contentWidgets=new contentWidgets_1.ViewContentWidgets(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new viewCursors_1.ViewCursors(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new overlayWidgets_1.ViewOverlayWidgets(this._context),this._viewParts.push(this._overlayWidgets);const rulers=new rulers_1.Rulers(this._context);this._viewParts.push(rulers);const minimap=new minimap_1.Minimap(this._context);if(this._viewParts.push(minimap),decorationsOverviewRuler){const overviewRulerData=this._scrollbar.getOverviewRulerLayoutInfo();overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(),overviewRulerData.insertBefore)}this._linesContent.appendChild(contentViewOverlays.getDomNode()),this._linesContent.appendChild(rulers.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(margin.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(scrollDecoration.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(minimap.getDomNode()),this.domNode.appendChild(this._overflowGuardContainer),overflowWidgetsDomNode?overflowWidgetsDomNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new pointerHandler_1.PointerHandler(this._context,viewController,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:event=>{this._textAreaHandler.textArea.domNode.dispatchEvent(event)},getLastRenderData:()=>{const lastViewCursorsRenderData=this._viewCursors.getLastRenderData()||[],lastTextareaPosition=this._textAreaHandler.getLastRenderData();return new mouseTarget_1.PointerHandlerLastRenderData(lastViewCursorsRenderData,lastTextareaPosition)},shouldSuppressMouseDownOnViewZone:viewZoneId=>this._viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId),shouldSuppressMouseDownOnWidget:widgetId=>this._contentWidgets.shouldSuppressMouseDownOnWidget(widgetId),getPositionFromDOMInfo:(spanNode,offset)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(spanNode,offset)),visibleRangeForPosition:(lineNumber,column)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new position_1.Position(lineNumber,column))),getLineWidth:lineNumber=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(lineNumber))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:position=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(position))}}_applyLayout(){const layoutInfo=this._context.configuration.options.get(131);this.domNode.setWidth(layoutInfo.width),this.domNode.setHeight(layoutInfo.height),this._overflowGuardContainer.setWidth(layoutInfo.width),this._overflowGuardContainer.setHeight(layoutInfo.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const focused=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(128)+" "+(0,themeService_1.getThemeTypeSelector)(this._context.theme.type)+focused}handleEvents(events){super.handleEvents(events),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const viewPart of this._viewParts)viewPart.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=dom.runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){!function safeInvokeNoArg(func){try{return func()}catch(e){(0,errors_1.onUnexpectedError)(e)}}((()=>this._actualRender()))}_getViewPartsToRender(){const result=[];let resultLen=0;for(const viewPart of this._viewParts)viewPart.shouldRender()&&(result[resultLen++]=viewPart);return result}_actualRender(){if(!dom.isInDOM(this.domNode.domNode))return;let viewPartsToRender=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===viewPartsToRender.length)return;const partialViewportData=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(partialViewportData.startLineNumber,partialViewportData.endLineNumber,partialViewportData.centeredLineNumber);const viewportData=new viewLinesViewportData_1.ViewportData(this._selections,partialViewportData,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(viewportData),this._viewLines.shouldRender()&&(this._viewLines.renderText(viewportData),this._viewLines.onDidRender(),viewPartsToRender=this._getViewPartsToRender());const renderingContext=new renderingContext_1.RenderingContext(this._context.viewLayout,viewportData,this._viewLines);for(const viewPart of viewPartsToRender)viewPart.prepareRender(renderingContext);for(const viewPart of viewPartsToRender)viewPart.render(renderingContext),viewPart.onDidRender()}delegateVerticalScrollbarMouseDown(browserEvent){this._scrollbar.delegateVerticalScrollbarMouseDown(browserEvent)}restoreState(scrollPosition){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:scrollPosition.scrollTop},1),this._context.viewModel.tokenizeViewport(),this._renderNow(),this._viewLines.updateLineWidths(),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:scrollPosition.scrollLeft},1)}getOffsetForColumn(modelLineNumber,modelColumn){const modelPosition=this._context.viewModel.model.validatePosition({lineNumber:modelLineNumber,column:modelColumn}),viewPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);this._flushAccumulatedAndRenderNow();const visibleRange=this._viewLines.visibleRangeForPosition(new position_1.Position(viewPosition.lineNumber,viewPosition.column));return visibleRange?visibleRange.left:-1}getTargetAtClientPoint(clientX,clientY){const mouseTarget=this._pointerHandler.getTargetAtClientPoint(clientX,clientY);return mouseTarget?viewUserInputEvents_1.ViewUserInputEvents.convertViewToModelMouseTarget(mouseTarget,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(cssClassName){return new overviewRuler_1.OverviewRuler(this._context,cssClassName)}change(callback){this._viewZones.changeViewZones(callback),this._scheduleRender()}render(now,everything){if(everything){this._viewLines.forceShouldRender();for(const viewPart of this._viewParts)viewPart.forceShouldRender()}now?this._flushAccumulatedAndRenderNow():this._scheduleRender()}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(options){this._textAreaHandler.setAriaOptions(options)}addContentWidget(widgetData){this._contentWidgets.addWidget(widgetData.widget),this.layoutContentWidget(widgetData),this._scheduleRender()}layoutContentWidget(widgetData){let newRange=widgetData.position&&widgetData.position.range||null;if(null===newRange){const newPosition=widgetData.position?widgetData.position.position:null;null!==newPosition&&(newRange=new range_1.Range(newPosition.lineNumber,newPosition.column,newPosition.lineNumber,newPosition.column))}const newPreference=widgetData.position?widgetData.position.preference:null;this._contentWidgets.setWidgetPosition(widgetData.widget,newRange,newPreference),this._scheduleRender()}removeContentWidget(widgetData){this._contentWidgets.removeWidget(widgetData.widget),this._scheduleRender()}addOverlayWidget(widgetData){this._overlayWidgets.addWidget(widgetData.widget),this.layoutOverlayWidget(widgetData),this._scheduleRender()}layoutOverlayWidget(widgetData){const newPreference=widgetData.position?widgetData.position.preference:null;this._overlayWidgets.setWidgetPosition(widgetData.widget,newPreference)&&this._scheduleRender()}removeOverlayWidget(widgetData){this._overlayWidgets.removeWidget(widgetData.widget),this._scheduleRender()}}exports.View=View})),define(__m[671],__M([1,0,46,68,58,15,22,24,523,17,371]),(function(require,exports,aria_1,htmlContent_1,keyCodes_1,editorExtensions_1,selection_1,editorContextKeys_1,nls_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectionAnchorSet=void 0,exports.SelectionAnchorSet=new contextkey_1.RawContextKey("selectionAnchorSet",!1);let SelectionAnchorController=class SelectionAnchorController{constructor(editor,contextKeyService){this.editor=editor,this.selectionAnchorSetContextKey=exports.SelectionAnchorSet.bindTo(contextKeyService),this.modelChangeListener=editor.onDidChangeModel((()=>this.selectionAnchorSetContextKey.reset()))}static get(editor){return editor.getContribution(SelectionAnchorController.ID)}setSelectionAnchor(){if(this.editor.hasModel()){const position=this.editor.getPosition(),previousDecorations=this.decorationId?[this.decorationId]:[],newDecorationId=this.editor.deltaDecorations(previousDecorations,[{range:selection_1.Selection.fromPositions(position,position),options:{description:"selection-anchor",stickiness:1,hoverMessage:(new htmlContent_1.MarkdownString).appendText((0,nls_1.localize)(0,null)),className:"selection-anchor"}}]);this.decorationId=newDecorationId[0],this.selectionAnchorSetContextKey.set(!!this.decorationId),(0,aria_1.alert)((0,nls_1.localize)(1,null,position.lineNumber,position.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const anchorPosition=this.editor.getModel().getDecorationRange(this.decorationId);anchorPosition&&this.editor.setPosition(anchorPosition.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const start=this.editor.getModel().getDecorationRange(this.decorationId);if(start){const end=this.editor.getPosition();this.editor.setSelection(selection_1.Selection.fromPositions(start.getStartPosition(),end)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){this.decorationId&&(this.editor.deltaDecorations([this.decorationId],[]),this.decorationId=void 0,this.selectionAnchorSetContextKey.set(!1))}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};SelectionAnchorController.ID="editor.contrib.selectionAnchorController",SelectionAnchorController=__decorate([__param(1,contextkey_1.IContextKeyService)],SelectionAnchorController);class SetSelectionAnchor extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.setSelectionAnchor",label:(0,nls_1.localize)(2,null),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2080),weight:100}})}run(_accessor,editor){var _a;return __awaiter(this,void 0,void 0,(function*(){null===(_a=SelectionAnchorController.get(editor))||void 0===_a||_a.setSelectionAnchor()}))}}class GoToSelectionAnchor extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.goToSelectionAnchor",label:(0,nls_1.localize)(3,null),alias:"Go to Selection Anchor",precondition:exports.SelectionAnchorSet})}run(_accessor,editor){var _a;return __awaiter(this,void 0,void 0,(function*(){null===(_a=SelectionAnchorController.get(editor))||void 0===_a||_a.goToSelectionAnchor()}))}}class SelectFromAnchorToCursor extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:(0,nls_1.localize)(4,null),alias:"Select from Anchor to Cursor",precondition:exports.SelectionAnchorSet,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2089),weight:100}})}run(_accessor,editor){var _a;return __awaiter(this,void 0,void 0,(function*(){null===(_a=SelectionAnchorController.get(editor))||void 0===_a||_a.selectFromAnchorToCursor()}))}}class CancelSelectionAnchor extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:(0,nls_1.localize)(5,null),alias:"Cancel Selection Anchor",precondition:exports.SelectionAnchorSet,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:9,weight:100}})}run(_accessor,editor){var _a;return __awaiter(this,void 0,void 0,(function*(){null===(_a=SelectionAnchorController.get(editor))||void 0===_a||_a.cancelSelectionAnchor()}))}}(0,editorExtensions_1.registerEditorContribution)(SelectionAnchorController.ID,SelectionAnchorController),(0,editorExtensions_1.registerEditorAction)(SetSelectionAnchor),(0,editorExtensions_1.registerEditorAction)(GoToSelectionAnchor),(0,editorExtensions_1.registerEditorAction)(SelectFromAnchorToCursor),(0,editorExtensions_1.registerEditorAction)(CancelSelectionAnchor)})),define(__m[672],__M([1,0,15,24,458,525]),(function(require,exports,editorExtensions_1,editorContextKeys_1,moveCaretCommand_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class MoveCaretAction extends editorExtensions_1.EditorAction{constructor(left,opts){super(opts),this.left=left}run(accessor,editor){if(!editor.hasModel())return;const commands=[],selections=editor.getSelections();for(const selection of selections)commands.push(new moveCaretCommand_1.MoveCaretCommand(selection,this.left));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}(0,editorExtensions_1.registerEditorAction)(class MoveCaretLeftAction extends MoveCaretAction{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:nls.localize(0,null),alias:"Move Selected Text Left",precondition:editorContextKeys_1.EditorContextKeys.writable})}}),(0,editorExtensions_1.registerEditorAction)(class MoveCaretRightAction extends MoveCaretAction{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:nls.localize(1,null),alias:"Move Selected Text Right",precondition:editorContextKeys_1.EditorContextKeys.writable})}})})),define(__m[673],__M([1,0,15,100,180,3,24,526]),(function(require,exports,editorExtensions_1,replaceCommand_1,cursorMoveOperations_1,range_1,editorContextKeys_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class TransposeLettersAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.transposeLetters",label:nls.localize(0,null),alias:"Transpose Letters",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(accessor,editor){if(!editor.hasModel())return;let model=editor.getModel(),commands=[],selections=editor.getSelections();for(let selection of selections){if(!selection.isEmpty())continue;let lineNumber=selection.startLineNumber,column=selection.startColumn,lastColumn=model.getLineMaxColumn(lineNumber);if(1===lineNumber&&(1===column||2===column&&2===lastColumn))continue;let endPosition=column===lastColumn?selection.getPosition():cursorMoveOperations_1.MoveOperations.rightPosition(model,selection.getPosition().lineNumber,selection.getPosition().column),middlePosition=cursorMoveOperations_1.MoveOperations.leftPosition(model,endPosition),beginPosition=cursorMoveOperations_1.MoveOperations.leftPosition(model,middlePosition),leftChar=model.getValueInRange(range_1.Range.fromPositions(beginPosition,middlePosition)),rightChar=model.getValueInRange(range_1.Range.fromPositions(middlePosition,endPosition)),replaceRange=range_1.Range.fromPositions(beginPosition,endPosition);commands.push(new replaceCommand_1.ReplaceCommand(replaceRange,rightChar+leftChar))}commands.length>0&&(editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop())}}(0,editorExtensions_1.registerEditorAction)(TransposeLettersAction)})),define(__m[674],__M([1,0,34,16,178,15,29,24,527,37,104]),(function(require,exports,browser,platform,textAreaInput_1,editorExtensions_1,codeEditorService_1,editorContextKeys_1,nls,actions_1,clipboardService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PasteAction=exports.CopyAction=exports.CutAction=void 0;const supportsCut=platform.isNative||document.queryCommandSupported("cut"),supportsCopy=platform.isNative||document.queryCommandSupported("copy"),supportsPaste=void 0!==navigator.clipboard&&!browser.isFirefox||document.queryCommandSupported("paste");function registerCommand(command){return command.register(),command}exports.CutAction=supportsCut?registerCommand(new editorExtensions_1.MultiCommand({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:platform.isNative?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:actions_1.MenuId.MenubarEditMenu,group:"2_ccp",title:nls.localize(0,null),order:1},{menuId:actions_1.MenuId.EditorContext,group:"9_cutcopypaste",title:nls.localize(1,null),when:editorContextKeys_1.EditorContextKeys.writable,order:1},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(2,null),order:1},{menuId:actions_1.MenuId.SimpleEditorContext,group:"9_cutcopypaste",title:nls.localize(3,null),when:editorContextKeys_1.EditorContextKeys.writable,order:1}]})):void 0,exports.CopyAction=supportsCopy?registerCommand(new editorExtensions_1.MultiCommand({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:platform.isNative?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:actions_1.MenuId.MenubarEditMenu,group:"2_ccp",title:nls.localize(4,null),order:2},{menuId:actions_1.MenuId.EditorContext,group:"9_cutcopypaste",title:nls.localize(5,null),order:2},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(6,null),order:1},{menuId:actions_1.MenuId.SimpleEditorContext,group:"9_cutcopypaste",title:nls.localize(7,null),order:2}]})):void 0,actions_1.MenuRegistry.appendMenuItem(actions_1.MenuId.MenubarEditMenu,{submenu:actions_1.MenuId.MenubarCopy,title:{value:nls.localize(8,null),original:"Copy As"},group:"2_ccp",order:3}),actions_1.MenuRegistry.appendMenuItem(actions_1.MenuId.EditorContext,{submenu:actions_1.MenuId.EditorContextCopy,title:{value:nls.localize(9,null),original:"Copy As"},group:"9_cutcopypaste",order:3}),exports.PasteAction=supportsPaste?registerCommand(new editorExtensions_1.MultiCommand({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:platform.isNative?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:actions_1.MenuId.MenubarEditMenu,group:"2_ccp",title:nls.localize(10,null),order:4},{menuId:actions_1.MenuId.EditorContext,group:"9_cutcopypaste",title:nls.localize(11,null),when:editorContextKeys_1.EditorContextKeys.writable,order:4},{menuId:actions_1.MenuId.CommandPalette,group:"",title:nls.localize(12,null),order:1},{menuId:actions_1.MenuId.SimpleEditorContext,group:"9_cutcopypaste",title:nls.localize(13,null),when:editorContextKeys_1.EditorContextKeys.writable,order:4}]})):void 0;class ExecCommandCopyWithSyntaxHighlightingAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:nls.localize(14,null),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,weight:100}})}run(accessor,editor){if(!editor.hasModel())return;!editor.getOption(32)&&editor.getSelection().isEmpty()||(textAreaInput_1.CopyOptions.forceCopyWithSyntaxHighlighting=!0,editor.focus(),document.execCommand("copy"),textAreaInput_1.CopyOptions.forceCopyWithSyntaxHighlighting=!1)}}function registerExecCommandImpl(target,browserCommand){target&&(target.addImplementation(1e4,"code-editor",((accessor,args)=>{const focusedEditor=accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();if(focusedEditor&&focusedEditor.hasTextFocus()){const emptySelectionClipboard=focusedEditor.getOption(32),selection=focusedEditor.getSelection();return selection&&selection.isEmpty()&&!emptySelectionClipboard||document.execCommand(browserCommand),!0}return!1})),target.addImplementation(0,"generic-dom",((accessor,args)=>(document.execCommand(browserCommand),!0))))}registerExecCommandImpl(exports.CutAction,"cut"),registerExecCommandImpl(exports.CopyAction,"copy"),exports.PasteAction&&(exports.PasteAction.addImplementation(1e4,"code-editor",((accessor,args)=>{const codeEditorService=accessor.get(codeEditorService_1.ICodeEditorService),clipboardService=accessor.get(clipboardService_1.IClipboardService),focusedEditor=codeEditorService.getFocusedCodeEditor();if(focusedEditor&&focusedEditor.hasTextFocus()){return!(!document.execCommand("paste")&&platform.isWeb)||__awaiter(void 0,void 0,void 0,(function*(){const clipboardText=yield clipboardService.readText();if(""!==clipboardText){const metadata=textAreaInput_1.InMemoryClipboardMetadataManager.INSTANCE.get(clipboardText);let pasteOnNewLine=!1,multicursorText=null,mode=null;metadata&&(pasteOnNewLine=focusedEditor.getOption(32)&&!!metadata.isFromEmptySelection,multicursorText=void 0!==metadata.multicursorText?metadata.multicursorText:null,mode=metadata.mode),focusedEditor.trigger("keyboard","paste",{text:clipboardText,pasteOnNewLine,multicursorText,mode})}}))}return!1})),exports.PasteAction.addImplementation(0,"generic-dom",((accessor,args)=>(document.execCommand("paste"),!0)))),supportsCopy&&(0,editorExtensions_1.registerEditorAction)(ExecCommandCopyWithSyntaxHighlightingAction)})),define(__m[675],__M([1,0,58,15,3,24,33,257,609,532,37]),(function(require,exports,keyCodes_1,editorExtensions_1,range_1,editorContextKeys_1,languageConfigurationRegistry_1,blockCommentCommand_1,lineCommentCommand_1,nls,actions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class CommentLineAction extends editorExtensions_1.EditorAction{constructor(type,opts){super(opts),this._type=type}run(accessor,editor){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService);if(!editor.hasModel())return;const commands=[],modelOptions=editor.getModel().getOptions(),commentsOptions=editor.getOption(19),selections=editor.getSelections().map(((selection,index)=>({selection,index,ignoreFirstLine:!1})));selections.sort(((a,b)=>range_1.Range.compareRangesUsingStarts(a.selection,b.selection)));let prev=selections[0];for(let i=1;i<selections.length;i++){const curr=selections[i];prev.selection.endLineNumber===curr.selection.startLineNumber&&(prev.index<curr.index?curr.ignoreFirstLine=!0:(prev.ignoreFirstLine=!0,prev=curr))}for(const selection of selections)commands.push(new lineCommentCommand_1.LineCommentCommand(languageConfigurationService,selection.selection,modelOptions.tabSize,this._type,commentsOptions.insertSpace,commentsOptions.ignoreEmptyLines,selection.ignoreFirstLine));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}class BlockCommentAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.blockComment",label:nls.localize(4,null),alias:"Toggle Block Comment",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarEditMenu,group:"5_insert",title:nls.localize(5,null),order:2}})}run(accessor,editor){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService);if(!editor.hasModel())return;const commentsOptions=editor.getOption(19),commands=[],selections=editor.getSelections();for(const selection of selections)commands.push(new blockCommentCommand_1.BlockCommentCommand(selection,commentsOptions.insertSpace,languageConfigurationService));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}(0,editorExtensions_1.registerEditorAction)(class ToggleCommentLineAction extends CommentLineAction{constructor(){super(0,{id:"editor.action.commentLine",label:nls.localize(0,null),alias:"Toggle Line Comment",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarEditMenu,group:"5_insert",title:nls.localize(1,null),order:1}})}}),(0,editorExtensions_1.registerEditorAction)(class AddLineCommentAction extends CommentLineAction{constructor(){super(1,{id:"editor.action.addCommentLine",label:nls.localize(2,null),alias:"Add Line Comment",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2081),weight:100}})}}),(0,editorExtensions_1.registerEditorAction)(class RemoveLineCommentAction extends CommentLineAction{constructor(){super(2,{id:"editor.action.removeCommentLine",label:nls.localize(3,null),alias:"Remove Line Comment",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2099),weight:100}})}}),(0,editorExtensions_1.registerEditorAction)(BlockCommentAction)})),define(__m[676],__M([1,0,7,128,47,2,16,15,24,533,37,17,78,43]),(function(require,exports,dom,actionViewItems_1,actions_1,lifecycle_1,platform_1,editorExtensions_1,editorContextKeys_1,nls,actions_2,contextkey_1,contextView_1,keybinding_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextMenuController=void 0;let ContextMenuController=class ContextMenuController{constructor(editor,_contextMenuService,_contextViewService,_contextKeyService,_keybindingService,_menuService){this._contextMenuService=_contextMenuService,this._contextViewService=_contextViewService,this._contextKeyService=_contextKeyService,this._keybindingService=_keybindingService,this._menuService=_menuService,this._toDispose=new lifecycle_1.DisposableStore,this._contextMenuIsBeingShownCount=0,this._editor=editor,this._toDispose.add(this._editor.onContextMenu((e=>this._onContextMenu(e)))),this._toDispose.add(this._editor.onMouseWheel((e=>{if(this._contextMenuIsBeingShownCount>0){const view=this._contextViewService.getContextViewElement(),target=e.srcElement;target.shadowRoot&&dom.getShadowRoot(view)===target.shadowRoot||this._contextViewService.hideContextView()}}))),this._toDispose.add(this._editor.onKeyDown((e=>{58===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showContextMenu())})))}static get(editor){return editor.getContribution(ContextMenuController.ID)}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(20))return this._editor.focus(),void(e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position));if(12===e.target.type)return;if(6===e.target.type&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),6!==e.target.type&&7!==e.target.type&&1!==e.target.type)return;if(this._editor.focus(),e.target.position){let hasSelectionAtPosition=!1;for(const selection of this._editor.getSelections())if(selection.containsPosition(e.target.position)){hasSelectionAtPosition=!0;break}hasSelectionAtPosition||this._editor.setPosition(e.target.position)}let anchor=null;1!==e.target.type&&(anchor={x:e.event.posx-1,width:2,y:e.event.posy-1,height:2}),this.showContextMenu(anchor)}showContextMenu(anchor){if(!this._editor.getOption(20))return;if(!this._editor.hasModel())return;if(!this._contextMenuService)return void this._editor.focus();const menuActions=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?actions_2.MenuId.SimpleEditorContext:actions_2.MenuId.EditorContext);menuActions.length>0&&this._doShowContextMenu(menuActions,anchor)}_getMenuActions(model,menuId){const result=[],menu=this._menuService.createMenu(menuId,this._contextKeyService),groups=menu.getActions({arg:model.uri});menu.dispose();for(let group of groups){const[,actions]=group;let addedItems=0;for(const action of actions)if(action instanceof actions_2.SubmenuItemAction){const subActions=this._getMenuActions(model,action.item.submenu);subActions.length>0&&(result.push(new actions_1.SubmenuAction(action.id,action.label,subActions)),addedItems++)}else result.push(action),addedItems++;addedItems&&result.push(new actions_1.Separator)}return result.length&&result.pop(),result}_doShowContextMenu(actions,anchor=null){if(!this._editor.hasModel())return;const oldHoverSetting=this._editor.getOption(53);if(this._editor.updateOptions({hover:{enabled:!1}}),!anchor){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const cursorCoords=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),editorCoords=dom.getDomNodePagePosition(this._editor.getDomNode()),posx=editorCoords.left+cursorCoords.left,posy=editorCoords.top+cursorCoords.top+cursorCoords.height;anchor={x:posx,y:posy}}const useShadowDOM=this._editor.getOption(115)&&!platform_1.isIOS;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:useShadowDOM?this._editor.getDomNode():void 0,getAnchor:()=>anchor,getActions:()=>actions,getActionViewItem:action=>{const keybinding=this._keybindingFor(action);if(keybinding)return new actionViewItems_1.ActionViewItem(action,action,{label:!0,keybinding:keybinding.getLabel(),isMenu:!0});const customActionViewItem=action;return"function"==typeof customActionViewItem.getActionViewItem?customActionViewItem.getActionViewItem():new actionViewItems_1.ActionViewItem(action,action,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:action=>this._keybindingFor(action),onHide:wasCancelled=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:oldHoverSetting})}})}_keybindingFor(action){return this._keybindingService.lookupKeybinding(action.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};ContextMenuController.ID="editor.contrib.contextmenu",ContextMenuController=__decorate([__param(1,contextView_1.IContextMenuService),__param(2,contextView_1.IContextViewService),__param(3,contextkey_1.IContextKeyService),__param(4,keybinding_1.IKeybindingService),__param(5,actions_2.IMenuService)],ContextMenuController),exports.ContextMenuController=ContextMenuController;class ShowContextMenu extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.showContextMenu",label:nls.localize(0,null),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1092,weight:100}})}run(accessor,editor){var _a;null===(_a=ContextMenuController.get(editor))||void 0===_a||_a.showContextMenu()}}(0,editorExtensions_1.registerEditorContribution)(ContextMenuController.ID,ContextMenuController),(0,editorExtensions_1.registerEditorAction)(ShowContextMenu)})),define(__m[677],__M([1,0,2,15,24,534]),(function(require,exports,lifecycle_1,editorExtensions_1,editorContextKeys_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorRedo=exports.CursorUndo=exports.CursorUndoRedoController=void 0;class CursorState{constructor(selections){this.selections=selections}equals(other){const thisLen=this.selections.length;if(thisLen!==other.selections.length)return!1;for(let i=0;i<thisLen;i++)if(!this.selections[i].equalsSelection(other.selections[i]))return!1;return!0}}class StackElement{constructor(cursorState,scrollTop,scrollLeft){this.cursorState=cursorState,this.scrollTop=scrollTop,this.scrollLeft=scrollLeft}}class CursorUndoRedoController extends lifecycle_1.Disposable{constructor(editor){super(),this._editor=editor,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(editor.onDidChangeModel((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(editor.onDidChangeModelContent((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(editor.onDidChangeCursorSelection((e=>{if(this._isCursorUndoRedo)return;if(!e.oldSelections)return;if(e.oldModelVersionId!==e.modelVersionId)return;const prevState=new CursorState(e.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(prevState)||(this._undoStack.push(new StackElement(prevState,editor.getScrollTop(),editor.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())})))}static get(editor){return editor.getContribution(CursorUndoRedoController.ID)}cursorUndo(){this._editor.hasModel()&&0!==this._undoStack.length&&(this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){this._editor.hasModel()&&0!==this._redoStack.length&&(this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(stackElement){this._isCursorUndoRedo=!0,this._editor.setSelections(stackElement.cursorState.selections),this._editor.setScrollPosition({scrollTop:stackElement.scrollTop,scrollLeft:stackElement.scrollLeft}),this._isCursorUndoRedo=!1}}exports.CursorUndoRedoController=CursorUndoRedoController,CursorUndoRedoController.ID="editor.contrib.cursorUndoRedoController";class CursorUndo extends editorExtensions_1.EditorAction{constructor(){super({id:"cursorUndo",label:nls.localize(0,null),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2099,weight:100}})}run(accessor,editor,args){var _a;null===(_a=CursorUndoRedoController.get(editor))||void 0===_a||_a.cursorUndo()}}exports.CursorUndo=CursorUndo;class CursorRedo extends editorExtensions_1.EditorAction{constructor(){super({id:"cursorRedo",label:nls.localize(1,null),alias:"Cursor Redo",precondition:void 0})}run(accessor,editor,args){var _a;null===(_a=CursorUndoRedoController.get(editor))||void 0===_a||_a.cursorRedo()}}exports.CursorRedo=CursorRedo,(0,editorExtensions_1.registerEditorContribution)(CursorUndoRedoController.ID,CursorUndoRedoController),(0,editorExtensions_1.registerEditorAction)(CursorUndo),(0,editorExtensions_1.registerEditorAction)(CursorRedo)})),define(__m[678],__M([1,0,15,17,21,83,9,52,535]),(function(require,exports,editorExtensions_1,contextkey_1,cancellation_1,linkedList_1,instantiation_1,extensions_1,nls_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorKeybindingCancellationTokenSource=void 0;const IEditorCancellationTokens=(0,instantiation_1.createDecorator)("IEditorCancelService"),ctxCancellableOperation=new contextkey_1.RawContextKey("cancellableOperation",!1,(0,nls_1.localize)(0,null));(0,extensions_1.registerSingleton)(IEditorCancellationTokens,class{constructor(){this._tokens=new WeakMap}add(editor,cts){let removeFn,data=this._tokens.get(editor);return data||(data=editor.invokeWithinContext((accessor=>({key:ctxCancellableOperation.bindTo(accessor.get(contextkey_1.IContextKeyService)),tokens:new linkedList_1.LinkedList}))),this._tokens.set(editor,data)),data.key.set(!0),removeFn=data.tokens.push(cts),()=>{removeFn&&(removeFn(),data.key.set(!data.tokens.isEmpty()),removeFn=void 0)}}cancel(editor){const data=this._tokens.get(editor);if(!data)return;const cts=data.tokens.pop();cts&&(cts.cancel(),data.key.set(!data.tokens.isEmpty()))}},!0);class EditorKeybindingCancellationTokenSource extends cancellation_1.CancellationTokenSource{constructor(editor,parent){super(parent),this.editor=editor,this._unregister=editor.invokeWithinContext((accessor=>accessor.get(IEditorCancellationTokens).add(editor,this)))}dispose(){this._unregister(),super.dispose()}}exports.EditorKeybindingCancellationTokenSource=EditorKeybindingCancellationTokenSource,(0,editorExtensions_1.registerEditorCommand)(new class extends editorExtensions_1.EditorCommand{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:ctxCancellableOperation})}runEditorCommand(accessor,editor){accessor.get(IEditorCancellationTokens).cancel(editor)}})})),define(__m[108],__M([1,0,8,3,21,2,678]),(function(require,exports,strings,range_1,cancellation_1,lifecycle_1,keybindingCancellation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextModelCancellationTokenSource=exports.EditorStateCancellationTokenSource=exports.EditorState=void 0;class EditorState{constructor(editor,flags){if(this.flags=flags,0!=(1&this.flags)){const model=editor.getModel();this.modelVersionId=model?strings.format("{0}#{1}",model.uri.toString(),model.getVersionId()):null}else this.modelVersionId=null;0!=(4&this.flags)?this.position=editor.getPosition():this.position=null,0!=(2&this.flags)?this.selection=editor.getSelection():this.selection=null,0!=(8&this.flags)?(this.scrollLeft=editor.getScrollLeft(),this.scrollTop=editor.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(other){if(!(other instanceof EditorState))return!1;const state=other;return this.modelVersionId===state.modelVersionId&&(this.scrollLeft===state.scrollLeft&&this.scrollTop===state.scrollTop&&(!(!this.position&&state.position||this.position&&!state.position||this.position&&state.position&&!this.position.equals(state.position))&&!(!this.selection&&state.selection||this.selection&&!state.selection||this.selection&&state.selection&&!this.selection.equalsRange(state.selection))))}validate(editor){return this._equals(new EditorState(editor,this.flags))}}exports.EditorState=EditorState;class EditorStateCancellationTokenSource extends keybindingCancellation_1.EditorKeybindingCancellationTokenSource{constructor(editor,flags,range,parent){super(editor,parent),this._listener=new lifecycle_1.DisposableStore,4&flags&&this._listener.add(editor.onDidChangeCursorPosition((e=>{range&&range_1.Range.containsPosition(range,e.position)||this.cancel()}))),2&flags&&this._listener.add(editor.onDidChangeCursorSelection((e=>{range&&range_1.Range.containsRange(range,e.selection)||this.cancel()}))),8&flags&&this._listener.add(editor.onDidScrollChange((_=>this.cancel()))),1&flags&&(this._listener.add(editor.onDidChangeModel((_=>this.cancel()))),this._listener.add(editor.onDidChangeModelContent((_=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}exports.EditorStateCancellationTokenSource=EditorStateCancellationTokenSource;class TextModelCancellationTokenSource extends cancellation_1.CancellationTokenSource{constructor(model,parent){super(parent),this._listener=model.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}exports.TextModelCancellationTokenSource=TextModelCancellationTokenSource})),define(__m[159],__M([1,0,18,21,13,2,25,108,3,22,48,26,73,155,20]),(function(require,exports,arrays_1,cancellation_1,errors_1,lifecycle_1,uri_1,editorState_1,range_1,selection_1,model_1,commands_1,progress_1,types_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCodeActions=exports.CodeActionItem=exports.fixAllCommandId=exports.organizeImportsCommandId=exports.sourceActionCommandId=exports.refactorCommandId=exports.codeActionCommandId=void 0,exports.codeActionCommandId="editor.action.codeAction",exports.refactorCommandId="editor.action.refactor",exports.sourceActionCommandId="editor.action.sourceAction",exports.organizeImportsCommandId="editor.action.organizeImports",exports.fixAllCommandId="editor.action.fixAll";class CodeActionItem{constructor(action,provider){this.action=action,this.provider=provider}resolve(token){var _a;return __awaiter(this,void 0,void 0,(function*(){if((null===(_a=this.provider)||void 0===_a?void 0:_a.resolveCodeAction)&&!this.action.edit){let action;try{action=yield this.provider.resolveCodeAction(this.action,token)}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}action&&(this.action.edit=action.edit)}return this}))}}exports.CodeActionItem=CodeActionItem;class ManagedCodeActionSet extends lifecycle_1.Disposable{constructor(actions,documentation,disposables){super(),this.documentation=documentation,this._register(disposables),this.allActions=[...actions].sort(ManagedCodeActionSet.codeActionsComparator),this.validActions=this.allActions.filter((({action})=>!action.disabled))}static codeActionsComparator({action:a},{action:b}){return a.isPreferred&&!b.isPreferred?-1:!a.isPreferred&&b.isPreferred?1:(0,arrays_1.isNonEmptyArray)(a.diagnostics)?(0,arrays_1.isNonEmptyArray)(b.diagnostics)?a.diagnostics[0].message.localeCompare(b.diagnostics[0].message):-1:(0,arrays_1.isNonEmptyArray)(b.diagnostics)?1:0}get hasAutoFix(){return this.validActions.some((({action:fix})=>!!fix.kind&&types_1.CodeActionKind.QuickFix.contains(new types_1.CodeActionKind(fix.kind))&&!!fix.isPreferred))}}const emptyCodeActionsResponse={actions:[],documentation:void 0};function getCodeActions(registry,model,rangeOrSelection,trigger,progress,token){var _a;const filter=trigger.filter||{},codeActionContext={only:null===(_a=filter.include)||void 0===_a?void 0:_a.value,trigger:trigger.type},cts=new editorState_1.TextModelCancellationTokenSource(model,token),providers=function getCodeActionProviders(registry,model,filter){return registry.all(model).filter((provider=>!provider.providedCodeActionKinds||provider.providedCodeActionKinds.some((kind=>(0,types_1.mayIncludeActionsOfKind)(filter,new types_1.CodeActionKind(kind))))))}(registry,model,filter),disposables=new lifecycle_1.DisposableStore,promises=providers.map((provider=>__awaiter(this,void 0,void 0,(function*(){try{progress.report(provider);const providedCodeActions=yield provider.provideCodeActions(model,rangeOrSelection,codeActionContext,cts.token);if(providedCodeActions&&disposables.add(providedCodeActions),cts.token.isCancellationRequested)return emptyCodeActionsResponse;const filteredActions=((null==providedCodeActions?void 0:providedCodeActions.actions)||[]).filter((action=>action&&(0,types_1.filtersAction)(filter,action))),documentation=function getDocumentation(provider,providedCodeActions,only){if(!provider.documentation)return;const documentation=provider.documentation.map((entry=>({kind:new types_1.CodeActionKind(entry.kind),command:entry.command})));if(only){let currentBest;for(const entry of documentation)entry.kind.contains(only)&&(currentBest?currentBest.kind.contains(entry.kind)&&(currentBest=entry):currentBest=entry);if(currentBest)return null==currentBest?void 0:currentBest.command}for(const action of providedCodeActions)if(action.kind)for(const entry of documentation)if(entry.kind.contains(new types_1.CodeActionKind(action.kind)))return entry.command;return}(provider,filteredActions,filter.include);return{actions:filteredActions.map((action=>new CodeActionItem(action,provider))),documentation}}catch(err){if((0,errors_1.isCancellationError)(err))throw err;return(0,errors_1.onUnexpectedExternalError)(err),emptyCodeActionsResponse}})))),listener=registry.onDidChange((()=>{const newProviders=registry.all(model);(0,arrays_1.equals)(newProviders,providers)||cts.cancel()}));return Promise.all(promises).then((actions=>{const allActions=(0,arrays_1.flatten)(actions.map((x=>x.actions))),allDocumentation=(0,arrays_1.coalesce)(actions.map((x=>x.documentation)));return new ManagedCodeActionSet(allActions,allDocumentation,disposables)})).finally((()=>{listener.dispose(),cts.dispose()}))}exports.getCodeActions=getCodeActions,commands_1.CommandsRegistry.registerCommand("_executeCodeActionProvider",(function(accessor,resource,rangeOrSelection,kind,itemResolveCount){return __awaiter(this,void 0,void 0,(function*(){if(!(resource instanceof uri_1.URI))throw(0,errors_1.illegalArgument)();const{codeActionProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=accessor.get(model_1.IModelService).getModel(resource);if(!model)throw(0,errors_1.illegalArgument)();const validatedRangeOrSelection=selection_1.Selection.isISelection(rangeOrSelection)?selection_1.Selection.liftSelection(rangeOrSelection):range_1.Range.isIRange(rangeOrSelection)?model.validateRange(rangeOrSelection):void 0;if(!validatedRangeOrSelection)throw(0,errors_1.illegalArgument)();const include="string"==typeof kind?new types_1.CodeActionKind(kind):void 0,codeActionSet=yield getCodeActions(codeActionProvider,model,validatedRangeOrSelection,{type:1,filter:{includeSourceActions:!0,include}},progress_1.Progress.None,cancellation_1.CancellationToken.None),resolving=[],resolveCount=Math.min(codeActionSet.validActions.length,"number"==typeof itemResolveCount?itemResolveCount:0);for(let i=0;i<resolveCount;i++)resolving.push(codeActionSet.validActions[i].resolve(cancellation_1.CancellationToken.None));try{return yield Promise.all(resolving),codeActionSet.validActions.map((item=>item.action))}finally{setTimeout((()=>codeActionSet.dispose()),100)}}))}))})),define(__m[679],__M([1,0,7,47,13,137,2,11,20,159,155,78,43]),(function(require,exports,dom_1,actions_1,errors_1,lazy_1,lifecycle_1,position_1,languageFeatures_1,codeAction_1,types_1,contextView_1,keybinding_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeActionKeybindingResolver=exports.CodeActionMenu=void 0;class CodeActionAction extends actions_1.Action{constructor(action,callback){super(action.command?action.command.id:action.title,function stripNewlines(str){return str.replace(/\r\n|\r|\n/g," ")}(action.title),void 0,!action.disabled,callback),this.action=action}}let CodeActionMenu=class CodeActionMenu extends lifecycle_1.Disposable{constructor(_editor,_delegate,_contextMenuService,keybindingService,_languageFeaturesService){super(),this._editor=_editor,this._delegate=_delegate,this._contextMenuService=_contextMenuService,this._languageFeaturesService=_languageFeaturesService,this._visible=!1,this._showingActions=this._register(new lifecycle_1.MutableDisposable),this._keybindingResolver=new CodeActionKeybindingResolver({getKeybindings:()=>keybindingService.getKeybindings()})}get isVisible(){return this._visible}show(trigger,codeActions,at,options){return __awaiter(this,void 0,void 0,(function*(){const actionsToShow=options.includeDisabledActions?codeActions.allActions:codeActions.validActions;if(!actionsToShow.length)return void(this._visible=!1);if(!this._editor.getDomNode())throw this._visible=!1,(0,errors_1.canceled)();this._visible=!0,this._showingActions.value=codeActions;const menuActions=this.getMenuActions(trigger,actionsToShow,codeActions.documentation),anchor=position_1.Position.isIPosition(at)?this._toCoords(at):at||{x:0,y:0},resolver=this._keybindingResolver.getResolver(),useShadowDOM=this._editor.getOption(115);this._contextMenuService.showContextMenu({domForShadowRoot:useShadowDOM?this._editor.getDomNode():void 0,getAnchor:()=>anchor,getActions:()=>menuActions,onHide:()=>{this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:action=>action instanceof CodeActionAction?resolver(action.action):void 0})}))}getMenuActions(trigger,actionsToShow,documentation){var _a,_b;const toCodeActionAction=item=>new CodeActionAction(item.action,(()=>this._delegate.onSelectCodeAction(item))),result=actionsToShow.map(toCodeActionAction),allDocumentation=[...documentation],model=this._editor.getModel();if(model&&result.length)for(const provider of this._languageFeaturesService.codeActionProvider.all(model))provider._getAdditionalMenuItems&&allDocumentation.push(...provider._getAdditionalMenuItems({trigger:trigger.type,only:null===(_b=null===(_a=trigger.filter)||void 0===_a?void 0:_a.include)||void 0===_b?void 0:_b.value},actionsToShow.map((item=>item.action))));return allDocumentation.length&&result.push(new actions_1.Separator,...allDocumentation.map((command=>toCodeActionAction(new codeAction_1.CodeActionItem({title:command.title,command},void 0))))),result}_toCoords(position){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(position,1),this._editor.render();const cursorCoords=this._editor.getScrolledVisiblePosition(position),editorCoords=(0,dom_1.getDomNodePagePosition)(this._editor.getDomNode());return{x:editorCoords.left+cursorCoords.left,y:editorCoords.top+cursorCoords.top+cursorCoords.height}}};CodeActionMenu=__decorate([__param(2,contextView_1.IContextMenuService),__param(3,keybinding_1.IKeybindingService),__param(4,languageFeatures_1.ILanguageFeaturesService)],CodeActionMenu),exports.CodeActionMenu=CodeActionMenu;class CodeActionKeybindingResolver{constructor(_keybindingProvider){this._keybindingProvider=_keybindingProvider}getResolver(){const allCodeActionBindings=new lazy_1.Lazy((()=>this._keybindingProvider.getKeybindings().filter((item=>CodeActionKeybindingResolver.codeActionCommands.indexOf(item.command)>=0)).filter((item=>item.resolvedKeybinding)).map((item=>{let commandArgs=item.commandArgs;return item.command===codeAction_1.organizeImportsCommandId?commandArgs={kind:types_1.CodeActionKind.SourceOrganizeImports.value}:item.command===codeAction_1.fixAllCommandId&&(commandArgs={kind:types_1.CodeActionKind.SourceFixAll.value}),Object.assign({resolvedKeybinding:item.resolvedKeybinding},types_1.CodeActionCommandArgs.fromUser(commandArgs,{kind:types_1.CodeActionKind.None,apply:"never"}))}))));return action=>{if(action.kind){const binding=this.bestKeybindingForCodeAction(action,allCodeActionBindings.getValue());return null==binding?void 0:binding.resolvedKeybinding}}}bestKeybindingForCodeAction(action,candidates){if(!action.kind)return;const kind=new types_1.CodeActionKind(action.kind);return candidates.filter((candidate=>candidate.kind.contains(kind))).filter((candidate=>!candidate.preferred||action.isPreferred)).reduceRight(((currentBest,candidate)=>currentBest?currentBest.kind.contains(candidate.kind)?candidate:currentBest:candidate),void 0)}}exports.CodeActionKeybindingResolver=CodeActionKeybindingResolver,CodeActionKeybindingResolver.codeActionCommands=[codeAction_1.refactorCommandId,codeAction_1.codeActionCommandId,codeAction_1.sourceActionCommandId,codeAction_1.organizeImportsCommandId,codeAction_1.fixAllCommandId]}));var __classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver)},__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(receiver,state,value,kind,f){if("m"===kind)throw new TypeError("Private method is not writable");if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===kind?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value};define(__m[680],__M([1,0,10,13,4,2,42,3,17,73,159]),(function(require,exports,async_1,errors_1,event_1,lifecycle_1,resources_1,range_1,contextkey_1,progress_1,codeAction_1){"use strict";var _CodeActionModel_isDisposed,CodeActionsState;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeActionModel=exports.CodeActionsState=exports.SUPPORTED_CODE_ACTIONS=void 0,exports.SUPPORTED_CODE_ACTIONS=new contextkey_1.RawContextKey("supportedCodeAction","");class CodeActionOracle extends lifecycle_1.Disposable{constructor(_editor,_markerService,_signalChange,_delay=250){super(),this._editor=_editor,this._markerService=_markerService,this._signalChange=_signalChange,this._delay=_delay,this._autoTriggerTimer=this._register(new async_1.TimeoutTimer),this._register(this._markerService.onMarkerChanged((e=>this._onMarkerChanges(e)))),this._register(this._editor.onDidChangeCursorPosition((()=>this._onCursorChange())))}trigger(trigger){const selection=this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);return this._createEventAndSignalChange(trigger,selection)}_onMarkerChanges(resources){const model=this._editor.getModel();model&&resources.some((resource=>(0,resources_1.isEqual)(resource,model.uri)))&&this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_getRangeOfMarker(selection){const model=this._editor.getModel();if(model)for(const marker of this._markerService.read({resource:model.uri})){const markerRange=model.validateRange(marker);if(range_1.Range.intersectRanges(markerRange,selection))return range_1.Range.lift(markerRange)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(trigger){if(!this._editor.hasModel())return;const model=this._editor.getModel(),selection=this._editor.getSelection();if(selection.isEmpty()&&2===trigger.type){const{lineNumber,column}=selection.getPosition(),line=model.getLineContent(lineNumber);if(0===line.length)return;if(1===column){if(/\s/.test(line[0]))return}else if(column===model.getLineMaxColumn(lineNumber)){if(/\s/.test(line[line.length-1]))return}else if(/\s/.test(line[column-2])&&/\s/.test(line[column-1]))return}return selection}_createEventAndSignalChange(trigger,selection){const model=this._editor.getModel();if(!selection||!model)return void this._signalChange(void 0);const markerRange=this._getRangeOfMarker(selection),position=markerRange?markerRange.getStartPosition():selection.getStartPosition(),e={trigger,selection,position};return this._signalChange(e),e}}!function(CodeActionsState){CodeActionsState.Empty={type:0};CodeActionsState.Triggered=class Triggered{constructor(trigger,rangeOrSelection,position,_cancellablePromise){this.trigger=trigger,this.rangeOrSelection=rangeOrSelection,this.position=position,this._cancellablePromise=_cancellablePromise,this.type=1,this.actions=_cancellablePromise.catch((e=>{if((0,errors_1.isCancellationError)(e))return emptyCodeActionSet;throw e}))}cancel(){this._cancellablePromise.cancel()}}}(CodeActionsState=exports.CodeActionsState||(exports.CodeActionsState={}));const emptyCodeActionSet={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1};class CodeActionModel extends lifecycle_1.Disposable{constructor(_editor,_registry,_markerService,contextKeyService,_progressService){super(),this._editor=_editor,this._registry=_registry,this._markerService=_markerService,this._progressService=_progressService,this._codeActionOracle=this._register(new lifecycle_1.MutableDisposable),this._state=CodeActionsState.Empty,this._onDidChangeState=this._register(new event_1.Emitter),this.onDidChangeState=this._onDidChangeState.event,_CodeActionModel_isDisposed.set(this,!1),this._supportedCodeActions=exports.SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService),this._register(this._editor.onDidChangeModel((()=>this._update()))),this._register(this._editor.onDidChangeModelLanguage((()=>this._update()))),this._register(this._registry.onDidChange((()=>this._update()))),this._update()}dispose(){__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")||(__classPrivateFieldSet(this,_CodeActionModel_isDisposed,!0,"f"),super.dispose(),this.setState(CodeActionsState.Empty,!0))}_update(){if(__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f"))return;this._codeActionOracle.value=void 0,this.setState(CodeActionsState.Empty);const model=this._editor.getModel();if(model&&this._registry.has(model)&&!this._editor.getOption(81)){const supportedActions=[];for(const provider of this._registry.all(model))Array.isArray(provider.providedCodeActionKinds)&&supportedActions.push(...provider.providedCodeActionKinds);this._supportedCodeActions.set(supportedActions.join(" ")),this._codeActionOracle.value=new CodeActionOracle(this._editor,this._markerService,(trigger=>{var _a;if(!trigger)return void this.setState(CodeActionsState.Empty);const actions=(0,async_1.createCancelablePromise)((token=>(0,codeAction_1.getCodeActions)(this._registry,model,trigger.selection,trigger.trigger,progress_1.Progress.None,token)));1===trigger.trigger.type&&(null===(_a=this._progressService)||void 0===_a||_a.showWhile(actions,250)),this.setState(new CodeActionsState.Triggered(trigger.trigger,trigger.selection,trigger.position,actions))}),void 0),this._codeActionOracle.value.trigger({type:2})}else this._supportedCodeActions.reset()}trigger(trigger){this._codeActionOracle.value&&this._codeActionOracle.value.trigger(trigger)}setState(newState,skipNotify){newState!==this._state&&(1===this._state.type&&this._state.cancel(),this._state=newState,skipNotify||__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")||this._onDidChangeState.fire(newState))}}exports.CodeActionModel=CodeActionModel,_CodeActionModel_isDisposed=new WeakMap})),define(__m[681],__M([1,0,15,147,540]),(function(require,exports,editorExtensions_1,editorZoom_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class EditorFontZoomIn extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.fontZoomIn",label:nls.localize(0,null),alias:"Editor Font Zoom In",precondition:void 0})}run(accessor,editor){editorZoom_1.EditorZoom.setZoomLevel(editorZoom_1.EditorZoom.getZoomLevel()+1)}}class EditorFontZoomOut extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.fontZoomOut",label:nls.localize(1,null),alias:"Editor Font Zoom Out",precondition:void 0})}run(accessor,editor){editorZoom_1.EditorZoom.setZoomLevel(editorZoom_1.EditorZoom.getZoomLevel()-1)}}class EditorFontZoomReset extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.fontZoomReset",label:nls.localize(2,null),alias:"Editor Font Zoom Reset",precondition:void 0})}run(accessor,editor){editorZoom_1.EditorZoom.setZoomLevel(0)}}(0,editorExtensions_1.registerEditorAction)(EditorFontZoomIn),(0,editorExtensions_1.registerEditorAction)(EditorFontZoomOut),(0,editorExtensions_1.registerEditorAction)(EditorFontZoomReset)})),define(__m[291],__M([1,0,46,18,21,13,57,83,19,25,108,150,11,3,22,88,56,259,541,26,604,9,20]),(function(require,exports,aria_1,arrays_1,cancellation_1,errors_1,iterator_1,linkedList_1,types_1,uri_1,editorState_1,editorBrowser_1,position_1,range_1,selection_1,editorWorker_1,resolverService_1,formattingEdit_1,nls,commands_1,extensions_1,instantiation_1,languageFeatures_1){"use strict";function alertFormattingEdits(edits){if(!(edits=edits.filter((edit=>edit.range))).length)return;let{range}=edits[0];for(let i=1;i<edits.length;i++)range=range_1.Range.plusRange(range,edits[i].range);const{startLineNumber,endLineNumber}=range;startLineNumber===endLineNumber?1===edits.length?(0,aria_1.alert)(nls.localize(0,null,startLineNumber)):(0,aria_1.alert)(nls.localize(1,null,edits.length,startLineNumber)):1===edits.length?(0,aria_1.alert)(nls.localize(2,null,startLineNumber,endLineNumber)):(0,aria_1.alert)(nls.localize(3,null,edits.length,startLineNumber,endLineNumber))}function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider,documentRangeFormattingEditProvider,model){const result=[],seen=new Set,docFormatter=documentFormattingEditProvider.ordered(model);for(const formatter of docFormatter)result.push(formatter),formatter.extensionId&&seen.add(extensions_1.ExtensionIdentifier.toKey(formatter.extensionId));const rangeFormatter=documentRangeFormattingEditProvider.ordered(model);for(const formatter of rangeFormatter){if(formatter.extensionId){if(seen.has(extensions_1.ExtensionIdentifier.toKey(formatter.extensionId)))continue;seen.add(extensions_1.ExtensionIdentifier.toKey(formatter.extensionId))}result.push({displayName:formatter.displayName,extensionId:formatter.extensionId,provideDocumentFormattingEdits:(model,options,token)=>formatter.provideDocumentRangeFormattingEdits(model,model.getFullModelRange(),options,token)})}return result}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOnTypeFormattingEdits=exports.getDocumentFormattingEditsUntilResult=exports.getDocumentRangeFormattingEditsUntilResult=exports.formatDocumentWithProvider=exports.formatDocumentWithSelectedProvider=exports.formatDocumentRangesWithProvider=exports.formatDocumentRangesWithSelectedProvider=exports.FormattingConflicts=exports.getRealAndSyntheticDocumentFormattersOrdered=exports.alertFormattingEdits=void 0,exports.alertFormattingEdits=alertFormattingEdits,exports.getRealAndSyntheticDocumentFormattersOrdered=getRealAndSyntheticDocumentFormattersOrdered;class FormattingConflicts{static setFormatterSelector(selector){return{dispose:FormattingConflicts._selectors.unshift(selector)}}static select(formatter,document,mode){return __awaiter(this,void 0,void 0,(function*(){if(0===formatter.length)return;const selector=iterator_1.Iterable.first(FormattingConflicts._selectors);return selector?yield selector(formatter,document,mode):void 0}))}}function formatDocumentRangesWithProvider(accessor,provider,editorOrModel,rangeOrRanges,token){return __awaiter(this,void 0,void 0,(function*(){const workerService=accessor.get(editorWorker_1.IEditorWorkerService);let model,cts;(0,editorBrowser_1.isCodeEditor)(editorOrModel)?(model=editorOrModel.getModel(),cts=new editorState_1.EditorStateCancellationTokenSource(editorOrModel,5,void 0,token)):(model=editorOrModel,cts=new editorState_1.TextModelCancellationTokenSource(editorOrModel,token));let ranges=[],len=0;for(let range of(0,arrays_1.asArray)(rangeOrRanges).sort(range_1.Range.compareRangesUsingStarts))len>0&&range_1.Range.areIntersectingOrTouching(ranges[len-1],range)?ranges[len-1]=range_1.Range.fromPositions(ranges[len-1].getStartPosition(),range.getEndPosition()):len=ranges.push(range);const computeEdits=range=>__awaiter(this,void 0,void 0,(function*(){return(yield provider.provideDocumentRangeFormattingEdits(model,range,model.getFormattingOptions(),cts.token))||[]})),hasIntersectingEdit=(a,b)=>{if(!a.length||!b.length)return!1;const mergedA=a.reduce(((acc,val)=>range_1.Range.plusRange(acc,val.range)),a[0].range);if(!b.some((x=>range_1.Range.intersectRanges(mergedA,x.range))))return!1;for(let edit of a)for(let otherEdit of b)if(range_1.Range.intersectRanges(edit.range,otherEdit.range))return!0;return!1},allEdits=[],rawEditsList=[];try{for(let range of ranges){if(cts.token.isCancellationRequested)return!0;rawEditsList.push(yield computeEdits(range))}for(let i=0;i<ranges.length;++i)for(let j=i+1;j<ranges.length;++j){if(cts.token.isCancellationRequested)return!0;if(hasIntersectingEdit(rawEditsList[i],rawEditsList[j])){const mergedRange=range_1.Range.plusRange(ranges[i],ranges[j]),edits=yield computeEdits(mergedRange);ranges.splice(j,1),ranges.splice(i,1),ranges.push(mergedRange),rawEditsList.splice(j,1),rawEditsList.splice(i,1),rawEditsList.push(edits),i=0,j=0}}for(let rawEdits of rawEditsList){if(cts.token.isCancellationRequested)return!0;const minimalEdits=yield workerService.computeMoreMinimalEdits(model.uri,rawEdits);minimalEdits&&allEdits.push(...minimalEdits)}}finally{cts.dispose()}if(0===allEdits.length)return!1;if((0,editorBrowser_1.isCodeEditor)(editorOrModel))formattingEdit_1.FormattingEdit.execute(editorOrModel,allEdits,!0),alertFormattingEdits(allEdits),editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(),1);else{const[{range}]=allEdits,initialSelection=new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn);model.pushEditOperations([initialSelection],allEdits.map((edit=>({text:edit.text,range:range_1.Range.lift(edit.range),forceMoveMarkers:!0}))),(undoEdits=>{for(const{range}of undoEdits)if(range_1.Range.areIntersectingOrTouching(range,initialSelection))return[new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn)];return null}))}return!0}))}function formatDocumentWithProvider(accessor,provider,editorOrModel,mode,token){return __awaiter(this,void 0,void 0,(function*(){const workerService=accessor.get(editorWorker_1.IEditorWorkerService);let model,cts,edits;(0,editorBrowser_1.isCodeEditor)(editorOrModel)?(model=editorOrModel.getModel(),cts=new editorState_1.EditorStateCancellationTokenSource(editorOrModel,5,void 0,token)):(model=editorOrModel,cts=new editorState_1.TextModelCancellationTokenSource(editorOrModel,token));try{const rawEdits=yield provider.provideDocumentFormattingEdits(model,model.getFormattingOptions(),cts.token);if(edits=yield workerService.computeMoreMinimalEdits(model.uri,rawEdits),cts.token.isCancellationRequested)return!0}finally{cts.dispose()}if(!edits||0===edits.length)return!1;if((0,editorBrowser_1.isCodeEditor)(editorOrModel))formattingEdit_1.FormattingEdit.execute(editorOrModel,edits,2!==mode),2!==mode&&(alertFormattingEdits(edits),editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(),1));else{const[{range}]=edits,initialSelection=new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn);model.pushEditOperations([initialSelection],edits.map((edit=>({text:edit.text,range:range_1.Range.lift(edit.range),forceMoveMarkers:!0}))),(undoEdits=>{for(const{range}of undoEdits)if(range_1.Range.areIntersectingOrTouching(range,initialSelection))return[new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn)];return null}))}return!0}))}function getDocumentRangeFormattingEditsUntilResult(workerService,languageFeaturesService,model,range,options,token){return __awaiter(this,void 0,void 0,(function*(){const providers=languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);for(const provider of providers){let rawEdits=yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model,range,options,token)).catch(errors_1.onUnexpectedExternalError);if((0,arrays_1.isNonEmptyArray)(rawEdits))return yield workerService.computeMoreMinimalEdits(model.uri,rawEdits)}}))}function getDocumentFormattingEditsUntilResult(workerService,languageFeaturesService,model,options,token){return __awaiter(this,void 0,void 0,(function*(){const providers=getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider,languageFeaturesService.documentRangeFormattingEditProvider,model);for(const provider of providers){let rawEdits=yield Promise.resolve(provider.provideDocumentFormattingEdits(model,options,token)).catch(errors_1.onUnexpectedExternalError);if((0,arrays_1.isNonEmptyArray)(rawEdits))return yield workerService.computeMoreMinimalEdits(model.uri,rawEdits)}}))}function getOnTypeFormattingEdits(workerService,languageFeaturesService,model,position,ch,options,token){const providers=languageFeaturesService.onTypeFormattingEditProvider.ordered(model);return 0===providers.length||providers[0].autoFormatTriggerCharacters.indexOf(ch)<0?Promise.resolve(void 0):Promise.resolve(providers[0].provideOnTypeFormattingEdits(model,position,ch,options,token)).catch(errors_1.onUnexpectedExternalError).then((edits=>workerService.computeMoreMinimalEdits(model.uri,edits)))}exports.FormattingConflicts=FormattingConflicts,FormattingConflicts._selectors=new linkedList_1.LinkedList,exports.formatDocumentRangesWithSelectedProvider=function formatDocumentRangesWithSelectedProvider(accessor,editorOrModel,rangeOrRanges,mode,progress,token){return __awaiter(this,void 0,void 0,(function*(){const instaService=accessor.get(instantiation_1.IInstantiationService),{documentRangeFormattingEditProvider:documentRangeFormattingEditProviderRegistry}=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=(0,editorBrowser_1.isCodeEditor)(editorOrModel)?editorOrModel.getModel():editorOrModel,provider=documentRangeFormattingEditProviderRegistry.ordered(model),selected=yield FormattingConflicts.select(provider,model,mode);selected&&(progress.report(selected),yield instaService.invokeFunction(formatDocumentRangesWithProvider,selected,editorOrModel,rangeOrRanges,token))}))},exports.formatDocumentRangesWithProvider=formatDocumentRangesWithProvider,exports.formatDocumentWithSelectedProvider=function formatDocumentWithSelectedProvider(accessor,editorOrModel,mode,progress,token){return __awaiter(this,void 0,void 0,(function*(){const instaService=accessor.get(instantiation_1.IInstantiationService),languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=(0,editorBrowser_1.isCodeEditor)(editorOrModel)?editorOrModel.getModel():editorOrModel,provider=getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider,languageFeaturesService.documentRangeFormattingEditProvider,model),selected=yield FormattingConflicts.select(provider,model,mode);selected&&(progress.report(selected),yield instaService.invokeFunction(formatDocumentWithProvider,selected,editorOrModel,mode,token))}))},exports.formatDocumentWithProvider=formatDocumentWithProvider,exports.getDocumentRangeFormattingEditsUntilResult=getDocumentRangeFormattingEditsUntilResult,exports.getDocumentFormattingEditsUntilResult=getDocumentFormattingEditsUntilResult,exports.getOnTypeFormattingEdits=getOnTypeFormattingEdits,commands_1.CommandsRegistry.registerCommand("_executeFormatRangeProvider",(function(accessor,...args){return __awaiter(this,void 0,void 0,(function*(){const[resource,range,options]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource)),(0,types_1.assertType)(range_1.Range.isIRange(range));const resolverService=accessor.get(resolverService_1.ITextModelService),workerService=accessor.get(editorWorker_1.IEditorWorkerService),languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),reference=yield resolverService.createModelReference(resource);try{return getDocumentRangeFormattingEditsUntilResult(workerService,languageFeaturesService,reference.object.textEditorModel,range_1.Range.lift(range),options,cancellation_1.CancellationToken.None)}finally{reference.dispose()}}))})),commands_1.CommandsRegistry.registerCommand("_executeFormatDocumentProvider",(function(accessor,...args){return __awaiter(this,void 0,void 0,(function*(){const[resource,options]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource));const resolverService=accessor.get(resolverService_1.ITextModelService),workerService=accessor.get(editorWorker_1.IEditorWorkerService),languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),reference=yield resolverService.createModelReference(resource);try{return getDocumentFormattingEditsUntilResult(workerService,languageFeaturesService,reference.object.textEditorModel,options,cancellation_1.CancellationToken.None)}finally{reference.dispose()}}))})),commands_1.CommandsRegistry.registerCommand("_executeFormatOnTypeProvider",(function(accessor,...args){return __awaiter(this,void 0,void 0,(function*(){const[resource,position,ch,options]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource)),(0,types_1.assertType)(position_1.Position.isIPosition(position)),(0,types_1.assertType)("string"==typeof ch);const resolverService=accessor.get(resolverService_1.ITextModelService),workerService=accessor.get(editorWorker_1.IEditorWorkerService),languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),reference=yield resolverService.createModelReference(resource);try{return getOnTypeFormattingEdits(workerService,languageFeaturesService,reference.object.textEditorModel,position_1.Position.lift(position),ch,options,cancellation_1.CancellationToken.None)}finally{reference.dispose()}}))}))})),define(__m[682],__M([1,0,18,21,13,58,2,15,29,99,3,24,88,20,291,259,542,26,17,9,73]),(function(require,exports,arrays_1,cancellation_1,errors_1,keyCodes_1,lifecycle_1,editorExtensions_1,codeEditorService_1,characterClassifier_1,range_1,editorContextKeys_1,editorWorker_1,languageFeatures_1,format_1,formattingEdit_1,nls,commands_1,contextkey_1,instantiation_1,progress_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let FormatOnType=class FormatOnType{constructor(_editor,_languageFeaturesService,_workerService){this._editor=_editor,this._languageFeaturesService=_languageFeaturesService,this._workerService=_workerService,this._disposables=new lifecycle_1.DisposableStore,this._sessionDisposables=new lifecycle_1.DisposableStore,this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(_editor.onDidChangeModel((()=>this._update()))),this._disposables.add(_editor.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(_editor.onDidChangeConfiguration((e=>{e.hasChanged(49)&&this._update()})))}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(49))return;if(!this._editor.hasModel())return;const model=this._editor.getModel(),[support]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);if(!support||!support.autoFormatTriggerCharacters)return;let triggerChars=new characterClassifier_1.CharacterSet;for(let ch of support.autoFormatTriggerCharacters)triggerChars.add(ch.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType((text=>{let lastCharCode=text.charCodeAt(text.length-1);triggerChars.has(lastCharCode)&&this._trigger(String.fromCharCode(lastCharCode))})))}_trigger(ch){if(!this._editor.hasModel())return;if(this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const model=this._editor.getModel(),position=this._editor.getPosition(),cts=new cancellation_1.CancellationTokenSource,unbind=this._editor.onDidChangeModelContent((e=>{if(e.isFlush)return cts.cancel(),void unbind.dispose();for(let i=0,len=e.changes.length;i<len;i++){if(e.changes[i].range.endLineNumber<=position.lineNumber)return cts.cancel(),void unbind.dispose()}}));(0,format_1.getOnTypeFormattingEdits)(this._workerService,this._languageFeaturesService,model,position,ch,model.getFormattingOptions(),cts.token).then((edits=>{cts.token.isCancellationRequested||(0,arrays_1.isNonEmptyArray)(edits)&&(formattingEdit_1.FormattingEdit.execute(this._editor,edits,!0),(0,format_1.alertFormattingEdits)(edits))})).finally((()=>{unbind.dispose()}))}};FormatOnType.ID="editor.contrib.autoFormat",FormatOnType=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService),__param(2,editorWorker_1.IEditorWorkerService)],FormatOnType);let FormatOnPaste=class FormatOnPaste{constructor(editor,_languageFeaturesService,_instantiationService){this.editor=editor,this._languageFeaturesService=_languageFeaturesService,this._instantiationService=_instantiationService,this._callOnDispose=new lifecycle_1.DisposableStore,this._callOnModel=new lifecycle_1.DisposableStore,this._callOnDispose.add(editor.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(editor.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(editor.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(48)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range})=>this._trigger(range))))}_trigger(range){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(format_1.formatDocumentRangesWithSelectedProvider,this.editor,range,2,progress_1.Progress.None,cancellation_1.CancellationToken.None).catch(errors_1.onUnexpectedError))}};FormatOnPaste.ID="editor.contrib.formatOnPaste",FormatOnPaste=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService),__param(2,instantiation_1.IInstantiationService)],FormatOnPaste);class FormatDocumentAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.formatDocument",label:nls.localize(0,null),alias:"Format Document",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.notInCompositeEditor,editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasDocumentFormattingProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){if(editor.hasModel()){const instaService=accessor.get(instantiation_1.IInstantiationService),progressService=accessor.get(progress_1.IEditorProgressService);yield progressService.showWhile(instaService.invokeFunction(format_1.formatDocumentWithSelectedProvider,editor,1,progress_1.Progress.None,cancellation_1.CancellationToken.None),250)}}))}}class FormatSelectionAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.formatSelection",label:nls.localize(1,null),alias:"Format Selection",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2084),weight:100},contextMenuOpts:{when:editorContextKeys_1.EditorContextKeys.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){if(!editor.hasModel())return;const instaService=accessor.get(instantiation_1.IInstantiationService),model=editor.getModel(),ranges=editor.getSelections().map((range=>range.isEmpty()?new range_1.Range(range.startLineNumber,1,range.startLineNumber,model.getLineMaxColumn(range.startLineNumber)):range)),progressService=accessor.get(progress_1.IEditorProgressService);yield progressService.showWhile(instaService.invokeFunction(format_1.formatDocumentRangesWithSelectedProvider,editor,ranges,1,progress_1.Progress.None,cancellation_1.CancellationToken.None),250)}))}}(0,editorExtensions_1.registerEditorContribution)(FormatOnType.ID,FormatOnType),(0,editorExtensions_1.registerEditorContribution)(FormatOnPaste.ID,FormatOnPaste),(0,editorExtensions_1.registerEditorAction)(FormatDocumentAction),(0,editorExtensions_1.registerEditorAction)(FormatSelectionAction),commands_1.CommandsRegistry.registerCommand("editor.action.format",(accessor=>__awaiter(void 0,void 0,void 0,(function*(){const editor=accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();if(!editor||!editor.hasModel())return;const commandService=accessor.get(commands_1.ICommandService);editor.getSelection().isEmpty()?yield commandService.executeCommand("editor.action.formatDocument"):yield commandService.executeCommand("editor.action.formatSelection")}))))})),define(__m[292],__M([1,0,21,13,15,129,20]),(function(require,exports,cancellation_1,errors_1,editorExtensions_1,referencesModel_1,languageFeatures_1){"use strict";function getLocationLinks(model,position,registry,provide){const promises=registry.ordered(model).map((provider=>Promise.resolve(provide(provider,model,position)).then(void 0,(err=>{(0,errors_1.onUnexpectedExternalError)(err)}))));return Promise.all(promises).then((values=>{const result=[];for(let value of values)Array.isArray(value)?result.push(...value):value&&result.push(value);return result}))}function getDefinitionsAtPosition(registry,model,position,token){return getLocationLinks(model,position,registry,((provider,model,position)=>provider.provideDefinition(model,position,token)))}function getDeclarationsAtPosition(registry,model,position,token){return getLocationLinks(model,position,registry,((provider,model,position)=>provider.provideDeclaration(model,position,token)))}function getImplementationsAtPosition(registry,model,position,token){return getLocationLinks(model,position,registry,((provider,model,position)=>provider.provideImplementation(model,position,token)))}function getTypeDefinitionsAtPosition(registry,model,position,token){return getLocationLinks(model,position,registry,((provider,model,position)=>provider.provideTypeDefinition(model,position,token)))}function getReferencesAtPosition(registry,model,position,compact,token){return getLocationLinks(model,position,registry,((provider,model,position)=>__awaiter(this,void 0,void 0,(function*(){const result=yield provider.provideReferences(model,position,{includeDeclaration:!0},token);if(!compact||!result||2!==result.length)return result;const resultWithoutDeclaration=yield provider.provideReferences(model,position,{includeDeclaration:!1},token);return resultWithoutDeclaration&&1===resultWithoutDeclaration.length?resultWithoutDeclaration:result}))))}function _sortedAndDeduped(callback){return __awaiter(this,void 0,void 0,(function*(){const rawLinks=yield callback(),model=new referencesModel_1.ReferencesModel(rawLinks,""),modelLinks=model.references.map((ref=>ref.link));return model.dispose(),modelLinks}))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getReferencesAtPosition=exports.getTypeDefinitionsAtPosition=exports.getImplementationsAtPosition=exports.getDeclarationsAtPosition=exports.getDefinitionsAtPosition=void 0,exports.getDefinitionsAtPosition=getDefinitionsAtPosition,exports.getDeclarationsAtPosition=getDeclarationsAtPosition,exports.getImplementationsAtPosition=getImplementationsAtPosition,exports.getTypeDefinitionsAtPosition=getTypeDefinitionsAtPosition,exports.getReferencesAtPosition=getReferencesAtPosition,(0,editorExtensions_1.registerModelAndPositionCommand)("_executeDefinitionProvider",((accessor,model,position)=>{const promise=getDefinitionsAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).definitionProvider,model,position,cancellation_1.CancellationToken.None);return _sortedAndDeduped((()=>promise))})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeTypeDefinitionProvider",((accessor,model,position)=>{const promise=getTypeDefinitionsAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).typeDefinitionProvider,model,position,cancellation_1.CancellationToken.None);return _sortedAndDeduped((()=>promise))})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeDeclarationProvider",((accessor,model,position)=>{const promise=getDeclarationsAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).declarationProvider,model,position,cancellation_1.CancellationToken.None);return _sortedAndDeduped((()=>promise))})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeReferenceProvider",((accessor,model,position)=>{const promise=getReferencesAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).referenceProvider,model,position,!1,cancellation_1.CancellationToken.None);return _sortedAndDeduped((()=>promise))})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeImplementationProvider",((accessor,model,position)=>{const promise=getImplementationsAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).implementationProvider,model,position,cancellation_1.CancellationToken.None);return _sortedAndDeduped((()=>promise))}))})),define(__m[683],__M([1,0,4,2,42,15,29,3,551,17,52,9,43,89,39]),(function(require,exports,event_1,lifecycle_1,resources_1,editorExtensions_1,codeEditorService_1,range_1,nls_1,contextkey_1,extensions_1,instantiation_1,keybinding_1,keybindingsRegistry_1,notification_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ISymbolNavigationService=exports.ctxHasSymbols=void 0,exports.ctxHasSymbols=new contextkey_1.RawContextKey("hasSymbols",!1,(0,nls_1.localize)(0,null)),exports.ISymbolNavigationService=(0,instantiation_1.createDecorator)("ISymbolNavigationService");let SymbolNavigationService=class SymbolNavigationService{constructor(contextKeyService,_editorService,_notificationService,_keybindingService){this._editorService=_editorService,this._notificationService=_notificationService,this._keybindingService=_keybindingService,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=exports.ctxHasSymbols.bindTo(contextKeyService)}reset(){var _a,_b;this._ctxHasSymbols.reset(),null===(_a=this._currentState)||void 0===_a||_a.dispose(),null===(_b=this._currentMessage)||void 0===_b||_b.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(anchor){const refModel=anchor.parent.parent;if(refModel.references.length<=1)return void this.reset();this._currentModel=refModel,this._currentIdx=refModel.references.indexOf(anchor),this._ctxHasSymbols.set(!0),this._showMessage();const editorState=new EditorState(this._editorService),listener=editorState.onDidChange((_=>{if(this._ignoreEditorChange)return;const editor=this._editorService.getActiveCodeEditor();if(!editor)return;const model=editor.getModel(),position=editor.getPosition();if(!model||!position)return;let seenUri=!1,seenPosition=!1;for(const reference of refModel.references)if((0,resources_1.isEqual)(reference.uri,model.uri))seenUri=!0,seenPosition=seenPosition||range_1.Range.containsPosition(reference.range,position);else if(seenUri)break;seenUri&&seenPosition||this.reset()}));this._currentState=(0,lifecycle_1.combinedDisposable)(editorState,listener)}revealNext(source){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const reference=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:reference.uri,options:{selection:range_1.Range.collapseToStart(reference.range),selectionRevealType:3}},source).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var _a;null===(_a=this._currentMessage)||void 0===_a||_a.dispose();const kb=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),message=kb?(0,nls_1.localize)(1,null,this._currentIdx+1,this._currentModel.references.length,kb.getLabel()):(0,nls_1.localize)(2,null,this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(message)}};SymbolNavigationService=__decorate([__param(0,contextkey_1.IContextKeyService),__param(1,codeEditorService_1.ICodeEditorService),__param(2,notification_1.INotificationService),__param(3,keybinding_1.IKeybindingService)],SymbolNavigationService),(0,extensions_1.registerSingleton)(exports.ISymbolNavigationService,SymbolNavigationService,!0),(0,editorExtensions_1.registerEditorCommand)(new class extends editorExtensions_1.EditorCommand{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:exports.ctxHasSymbols,kbOpts:{weight:100,primary:70}})}runEditorCommand(accessor,editor){return accessor.get(exports.ISymbolNavigationService).revealNext(editor)}}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:exports.ctxHasSymbols,primary:9,handler(accessor){accessor.get(exports.ISymbolNavigationService).reset()}});let EditorState=class EditorState{constructor(editorService){this._listener=new Map,this._disposables=new lifecycle_1.DisposableStore,this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor,this)),editorService.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),(0,lifecycle_1.dispose)(this._listener.values())}_onDidAddEditor(editor){this._listener.set(editor,(0,lifecycle_1.combinedDisposable)(editor.onDidChangeCursorPosition((_=>this._onDidChange.fire({editor}))),editor.onDidChangeModelContent((_=>this._onDidChange.fire({editor})))))}_onDidRemoveEditor(editor){var _a;null===(_a=this._listener.get(editor))||void 0===_a||_a.dispose(),this._listener.delete(editor)}};EditorState=__decorate([__param(0,codeEditorService_1.ICodeEditorService)],EditorState)})),define(__m[293],__M([1,0,10,21,13,15,20]),(function(require,exports,async_1,cancellation_1,errors_1,editorExtensions_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getHoverPromise=exports.getHover=exports.HoverProviderResult=void 0;class HoverProviderResult{constructor(provider,hover,ordinal){this.provider=provider,this.hover=hover,this.ordinal=ordinal}}function getHover(registry,model,position,token){const promises=registry.ordered(model).map(((provider,index)=>function executeProvider(provider,ordinal,model,position,token){return __awaiter(this,void 0,void 0,(function*(){try{const result=yield Promise.resolve(provider.provideHover(model,position,token));if(result&&function isValid(result){const hasRange=void 0!==result.range,hasHtmlContent=void 0!==result.contents&&result.contents&&result.contents.length>0;return hasRange&&hasHtmlContent}(result))return new HoverProviderResult(provider,result,ordinal)}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}}))}(provider,index,model,position,token)));return async_1.AsyncIterableObject.fromPromises(promises).coalesce()}function getHoverPromise(registry,model,position,token){return getHover(registry,model,position,token).map((item=>item.hover)).toPromise()}exports.HoverProviderResult=HoverProviderResult,exports.getHover=getHover,exports.getHoverPromise=getHoverPromise,(0,editorExtensions_1.registerModelAndPositionCommand)("_executeHoverProvider",((accessor,model,position)=>getHoverPromise(accessor.get(languageFeatures_1.ILanguageFeaturesService).hoverProvider,model,position,cancellation_1.CancellationToken.None)))})),define(__m[207],__M([1,0,7,18,10,68,2,106,11,3,35,293,553,41,53,20]),(function(require,exports,dom,arrays_1,async_1,htmlContent_1,lifecycle_1,markdownRenderer_1,position_1,range_1,language_1,getHover_1,nls,configuration_1,opener_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderMarkdownHovers=exports.MarkdownHoverParticipant=exports.MarkdownHover=void 0;const $=dom.$;class MarkdownHover{constructor(owner,range,contents,ordinal){this.owner=owner,this.range=range,this.contents=contents,this.ordinal=ordinal}isValidForHoverAnchor(anchor){return 1===anchor.type&&this.range.startColumn<=anchor.range.startColumn&&this.range.endColumn>=anchor.range.endColumn}}exports.MarkdownHover=MarkdownHover;let MarkdownHoverParticipant=class MarkdownHoverParticipant{constructor(_editor,_languageService,_openerService,_configurationService,_languageFeaturesService){this._editor=_editor,this._languageService=_languageService,this._openerService=_openerService,this._configurationService=_configurationService,this._languageFeaturesService=_languageFeaturesService,this.hoverOrdinal=2}createLoadingMessage(anchor){return new MarkdownHover(this,anchor.range,[(new htmlContent_1.MarkdownString).appendText(nls.localize(0,null))],2e3)}computeSync(anchor,lineDecorations){if(!this._editor.hasModel()||1!==anchor.type)return[];const model=this._editor.getModel(),lineNumber=anchor.range.startLineNumber,maxColumn=model.getLineMaxColumn(lineNumber),result=[];let index=1e3;const lineLength=model.getLineLength(lineNumber),languageId=model.getLanguageIdAtPosition(anchor.range.startLineNumber,anchor.range.startColumn),maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:languageId});"number"==typeof maxTokenizationLineLength&&lineLength>=maxTokenizationLineLength&&result.push(new MarkdownHover(this,anchor.range,[{value:nls.localize(1,null)}],index++));for(const d of lineDecorations){const startColumn=d.range.startLineNumber===lineNumber?d.range.startColumn:1,endColumn=d.range.endLineNumber===lineNumber?d.range.endColumn:maxColumn,hoverMessage=d.options.hoverMessage;if(!hoverMessage||(0,htmlContent_1.isEmptyMarkdownString)(hoverMessage))continue;const range=new range_1.Range(anchor.range.startLineNumber,startColumn,anchor.range.startLineNumber,endColumn);result.push(new MarkdownHover(this,range,(0,arrays_1.asArray)(hoverMessage),index++))}return result}computeAsync(anchor,lineDecorations,token){if(!this._editor.hasModel()||1!==anchor.type)return async_1.AsyncIterableObject.EMPTY;const model=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(model))return async_1.AsyncIterableObject.EMPTY;const position=new position_1.Position(anchor.range.startLineNumber,anchor.range.startColumn);return(0,getHover_1.getHover)(this._languageFeaturesService.hoverProvider,model,position,token).filter((item=>!(0,htmlContent_1.isEmptyMarkdownString)(item.hover.contents))).map((item=>{const rng=item.hover.range?range_1.Range.lift(item.hover.range):anchor.range;return new MarkdownHover(this,rng,item.hover.contents,item.ordinal)}))}renderHoverParts(context,hoverParts){return renderMarkdownHovers(context,hoverParts,this._editor,this._languageService,this._openerService)}};function renderMarkdownHovers(context,hoverParts,editor,languageService,openerService){hoverParts.sort(((a,b)=>a.ordinal-b.ordinal));const disposables=new lifecycle_1.DisposableStore;for(const hoverPart of hoverParts)for(const contents of hoverPart.contents){if((0,htmlContent_1.isEmptyMarkdownString)(contents))continue;const markdownHoverElement=$("div.hover-row.markdown-hover"),hoverContentsElement=dom.append(markdownHoverElement,$("div.hover-contents")),renderer=disposables.add(new markdownRenderer_1.MarkdownRenderer({editor},languageService,openerService));disposables.add(renderer.onDidRenderAsync((()=>{hoverContentsElement.className="hover-contents code-hover-contents",context.onContentsChanged()})));const renderedContents=disposables.add(renderer.render(contents));hoverContentsElement.appendChild(renderedContents.element),context.fragment.appendChild(markdownHoverElement)}return disposables}MarkdownHoverParticipant=__decorate([__param(1,language_1.ILanguageService),__param(2,opener_1.IOpenerService),__param(3,configuration_1.IConfigurationService),__param(4,languageFeatures_1.ILanguageFeaturesService)],MarkdownHoverParticipant),exports.MarkdownHoverParticipant=MarkdownHoverParticipant,exports.renderMarkdownHovers=renderMarkdownHovers})),define(__m[684],__M([1,0,2,8,15,202,63,3,22,24,33,48,261,556,80,177]),(function(require,exports,lifecycle_1,strings,editorExtensions_1,shiftCommand_1,editOperation_1,range_1,selection_1,editorContextKeys_1,languageConfigurationRegistry_1,model_1,indentUtils,nls,quickInput_1,indentation_1){"use strict";function getReindentEditOperations(model,languageConfigurationService,startLineNumber,endLineNumber,inheritedIndent){if(1===model.getLineCount()&&1===model.getLineMaxColumn(1))return[];const indentationRules=languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentationRules;if(!indentationRules)return[];for(endLineNumber=Math.min(endLineNumber,model.getLineCount());startLineNumber<=endLineNumber&&indentationRules.unIndentedLinePattern;){let text=model.getLineContent(startLineNumber);if(!indentationRules.unIndentedLinePattern.test(text))break;startLineNumber++}if(startLineNumber>endLineNumber-1)return[];const{tabSize,indentSize,insertSpaces}=model.getOptions(),shiftIndent=(indentation,count)=>(count=count||1,shiftCommand_1.ShiftCommand.shiftIndent(indentation,indentation.length+count,tabSize,indentSize,insertSpaces)),unshiftIndent=(indentation,count)=>(count=count||1,shiftCommand_1.ShiftCommand.unshiftIndent(indentation,indentation.length+count,tabSize,indentSize,insertSpaces));let globalIndent,indentEdits=[],currentLineText=model.getLineContent(startLineNumber),adjustedLineContent=currentLineText;if(null!=inheritedIndent){globalIndent=inheritedIndent;let oldIndentation=strings.getLeadingWhitespace(currentLineText);adjustedLineContent=globalIndent+currentLineText.substring(oldIndentation.length),indentationRules.decreaseIndentPattern&&indentationRules.decreaseIndentPattern.test(adjustedLineContent)&&(globalIndent=unshiftIndent(globalIndent),adjustedLineContent=globalIndent+currentLineText.substring(oldIndentation.length)),currentLineText!==adjustedLineContent&&indentEdits.push(editOperation_1.EditOperation.replaceMove(new selection_1.Selection(startLineNumber,1,startLineNumber,oldIndentation.length+1),(0,indentation_1.normalizeIndentation)(globalIndent,indentSize,insertSpaces)))}else globalIndent=strings.getLeadingWhitespace(currentLineText);let idealIndentForNextLine=globalIndent;indentationRules.increaseIndentPattern&&indentationRules.increaseIndentPattern.test(adjustedLineContent)?(idealIndentForNextLine=shiftIndent(idealIndentForNextLine),globalIndent=shiftIndent(globalIndent)):indentationRules.indentNextLinePattern&&indentationRules.indentNextLinePattern.test(adjustedLineContent)&&(idealIndentForNextLine=shiftIndent(idealIndentForNextLine));for(let lineNumber=++startLineNumber;lineNumber<=endLineNumber;lineNumber++){let text=model.getLineContent(lineNumber),oldIndentation=strings.getLeadingWhitespace(text),adjustedLineContent=idealIndentForNextLine+text.substring(oldIndentation.length);indentationRules.decreaseIndentPattern&&indentationRules.decreaseIndentPattern.test(adjustedLineContent)&&(idealIndentForNextLine=unshiftIndent(idealIndentForNextLine),globalIndent=unshiftIndent(globalIndent)),oldIndentation!==idealIndentForNextLine&&indentEdits.push(editOperation_1.EditOperation.replaceMove(new selection_1.Selection(lineNumber,1,lineNumber,oldIndentation.length+1),(0,indentation_1.normalizeIndentation)(idealIndentForNextLine,indentSize,insertSpaces))),indentationRules.unIndentedLinePattern&&indentationRules.unIndentedLinePattern.test(text)||(indentationRules.increaseIndentPattern&&indentationRules.increaseIndentPattern.test(adjustedLineContent)?(globalIndent=shiftIndent(globalIndent),idealIndentForNextLine=globalIndent):idealIndentForNextLine=indentationRules.indentNextLinePattern&&indentationRules.indentNextLinePattern.test(adjustedLineContent)?shiftIndent(idealIndentForNextLine):globalIndent)}return indentEdits}Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndentationToTabsCommand=exports.IndentationToSpacesCommand=exports.AutoIndentOnPaste=exports.AutoIndentOnPasteCommand=exports.ReindentSelectedLinesAction=exports.ReindentLinesAction=exports.DetectIndentation=exports.IndentUsingSpaces=exports.IndentUsingTabs=exports.ChangeIndentationSizeAction=exports.IndentationToTabsAction=exports.IndentationToSpacesAction=exports.getReindentEditOperations=void 0,exports.getReindentEditOperations=getReindentEditOperations;class IndentationToSpacesAction extends editorExtensions_1.EditorAction{constructor(){super({id:IndentationToSpacesAction.ID,label:nls.localize(0,null),alias:"Convert Indentation to Spaces",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(accessor,editor){let model=editor.getModel();if(!model)return;let modelOpts=model.getOptions(),selection=editor.getSelection();if(!selection)return;const command=new IndentationToSpacesCommand(selection,modelOpts.tabSize);editor.pushUndoStop(),editor.executeCommands(this.id,[command]),editor.pushUndoStop(),model.updateOptions({insertSpaces:!0})}}exports.IndentationToSpacesAction=IndentationToSpacesAction,IndentationToSpacesAction.ID="editor.action.indentationToSpaces";class IndentationToTabsAction extends editorExtensions_1.EditorAction{constructor(){super({id:IndentationToTabsAction.ID,label:nls.localize(1,null),alias:"Convert Indentation to Tabs",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(accessor,editor){let model=editor.getModel();if(!model)return;let modelOpts=model.getOptions(),selection=editor.getSelection();if(!selection)return;const command=new IndentationToTabsCommand(selection,modelOpts.tabSize);editor.pushUndoStop(),editor.executeCommands(this.id,[command]),editor.pushUndoStop(),model.updateOptions({insertSpaces:!1})}}exports.IndentationToTabsAction=IndentationToTabsAction,IndentationToTabsAction.ID="editor.action.indentationToTabs";class ChangeIndentationSizeAction extends editorExtensions_1.EditorAction{constructor(insertSpaces,opts){super(opts),this.insertSpaces=insertSpaces}run(accessor,editor){const quickInputService=accessor.get(quickInput_1.IQuickInputService),modelService=accessor.get(model_1.IModelService);let model=editor.getModel();if(!model)return;const creationOpts=modelService.getCreationOptions(model.getLanguageId(),model.uri,model.isForSimpleWidget),picks=[1,2,3,4,5,6,7,8].map((n=>({id:n.toString(),label:n.toString(),description:n===creationOpts.tabSize?nls.localize(2,null):void 0}))),autoFocusIndex=Math.min(model.getOptions().tabSize-1,7);setTimeout((()=>{quickInputService.pick(picks,{placeHolder:nls.localize(3,null),activeItem:picks[autoFocusIndex]}).then((pick=>{pick&&model&&!model.isDisposed()&&model.updateOptions({tabSize:parseInt(pick.label,10),insertSpaces:this.insertSpaces})}))}),50)}}exports.ChangeIndentationSizeAction=ChangeIndentationSizeAction;class IndentUsingTabs extends ChangeIndentationSizeAction{constructor(){super(!1,{id:IndentUsingTabs.ID,label:nls.localize(4,null),alias:"Indent Using Tabs",precondition:void 0})}}exports.IndentUsingTabs=IndentUsingTabs,IndentUsingTabs.ID="editor.action.indentUsingTabs";class IndentUsingSpaces extends ChangeIndentationSizeAction{constructor(){super(!0,{id:IndentUsingSpaces.ID,label:nls.localize(5,null),alias:"Indent Using Spaces",precondition:void 0})}}exports.IndentUsingSpaces=IndentUsingSpaces,IndentUsingSpaces.ID="editor.action.indentUsingSpaces";class DetectIndentation extends editorExtensions_1.EditorAction{constructor(){super({id:DetectIndentation.ID,label:nls.localize(6,null),alias:"Detect Indentation from Content",precondition:void 0})}run(accessor,editor){const modelService=accessor.get(model_1.IModelService);let model=editor.getModel();if(!model)return;const creationOpts=modelService.getCreationOptions(model.getLanguageId(),model.uri,model.isForSimpleWidget);model.detectIndentation(creationOpts.insertSpaces,creationOpts.tabSize)}}exports.DetectIndentation=DetectIndentation,DetectIndentation.ID="editor.action.detectIndentation";class ReindentLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.reindentlines",label:nls.localize(7,null),alias:"Reindent Lines",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(accessor,editor){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService);let model=editor.getModel();if(!model)return;let edits=getReindentEditOperations(model,languageConfigurationService,1,model.getLineCount());edits.length>0&&(editor.pushUndoStop(),editor.executeEdits(this.id,edits),editor.pushUndoStop())}}exports.ReindentLinesAction=ReindentLinesAction;class ReindentSelectedLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.reindentselectedlines",label:nls.localize(8,null),alias:"Reindent Selected Lines",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(accessor,editor){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService);let model=editor.getModel();if(!model)return;let selections=editor.getSelections();if(null===selections)return;let edits=[];for(let selection of selections){let startLineNumber=selection.startLineNumber,endLineNumber=selection.endLineNumber;if(startLineNumber!==endLineNumber&&1===selection.endColumn&&endLineNumber--,1===startLineNumber){if(startLineNumber===endLineNumber)continue}else startLineNumber--;let editOperations=getReindentEditOperations(model,languageConfigurationService,startLineNumber,endLineNumber);edits.push(...editOperations)}edits.length>0&&(editor.pushUndoStop(),editor.executeEdits(this.id,edits),editor.pushUndoStop())}}exports.ReindentSelectedLinesAction=ReindentSelectedLinesAction;class AutoIndentOnPasteCommand{constructor(edits,initialSelection){this._initialSelection=initialSelection,this._edits=[],this._selectionId=null;for(let edit of edits)edit.range&&"string"==typeof edit.text&&this._edits.push(edit)}getEditOperations(model,builder){for(let edit of this._edits)builder.addEditOperation(range_1.Range.lift(edit.range),edit.text);let selectionIsSet=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(selectionIsSet=!0,this._selectionId=builder.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(selectionIsSet=!0,this._selectionId=builder.trackSelection(this._initialSelection,!1))),selectionIsSet||(this._selectionId=builder.trackSelection(this._initialSelection))}computeCursorState(model,helper){return helper.getTrackedSelection(this._selectionId)}}exports.AutoIndentOnPasteCommand=AutoIndentOnPasteCommand;class AutoIndentOnPaste{constructor(editor){this.callOnDispose=new lifecycle_1.DisposableStore,this.callOnModel=new lifecycle_1.DisposableStore,this.editor=editor,this.callOnDispose.add(editor.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(editor.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(editor.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(9)<4||this.editor.getOption(48)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range})=>{this.trigger(range)})))}trigger(range){let selections=this.editor.getSelections();if(null===selections||selections.length>1)return;const model=this.editor.getModel();if(!model)return;if(!model.isCheapToTokenize(range.getStartPosition().lineNumber))return;const autoIndent=this.editor.getOption(9),{tabSize,indentSize,insertSpaces}=model.getOptions();let textEdits=[],indentConverter={shiftIndent:indentation=>shiftCommand_1.ShiftCommand.shiftIndent(indentation,indentation.length+1,tabSize,indentSize,insertSpaces),unshiftIndent:indentation=>shiftCommand_1.ShiftCommand.unshiftIndent(indentation,indentation.length+1,tabSize,indentSize,insertSpaces)},startLineNumber=range.startLineNumber;for(;startLineNumber<=range.endLineNumber&&this.shouldIgnoreLine(model,startLineNumber);)startLineNumber++;if(startLineNumber>range.endLineNumber)return;let firstLineText=model.getLineContent(startLineNumber);if(!/\S/.test(firstLineText.substring(0,range.startColumn-1))){const indentOfFirstLine=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent,model,model.getLanguageId(),startLineNumber,indentConverter);if(null!==indentOfFirstLine){let oldIndentation=strings.getLeadingWhitespace(firstLineText),newSpaceCnt=indentUtils.getSpaceCnt(indentOfFirstLine,tabSize);if(newSpaceCnt!==indentUtils.getSpaceCnt(oldIndentation,tabSize)){let newIndent=indentUtils.generateIndent(newSpaceCnt,tabSize,insertSpaces);textEdits.push({range:new range_1.Range(startLineNumber,1,startLineNumber,oldIndentation.length+1),text:newIndent}),firstLineText=newIndent+firstLineText.substr(oldIndentation.length)}else{let indentMetadata=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getIndentMetadata(model,startLineNumber);if(0===indentMetadata||8===indentMetadata)return}}}const firstLineNumber=startLineNumber;for(;startLineNumber<range.endLineNumber&&!/\S/.test(model.getLineContent(startLineNumber+1));)startLineNumber++;if(startLineNumber!==range.endLineNumber){let virtualModel={getLineTokens:lineNumber=>model.getLineTokens(lineNumber),getLanguageId:()=>model.getLanguageId(),getLanguageIdAtPosition:(lineNumber,column)=>model.getLanguageIdAtPosition(lineNumber,column),getLineContent:lineNumber=>lineNumber===firstLineNumber?firstLineText:model.getLineContent(lineNumber)},indentOfSecondLine=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent,virtualModel,model.getLanguageId(),startLineNumber+1,indentConverter);if(null!==indentOfSecondLine){let newSpaceCntOfSecondLine=indentUtils.getSpaceCnt(indentOfSecondLine,tabSize),oldSpaceCntOfSecondLine=indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber+1)),tabSize);if(newSpaceCntOfSecondLine!==oldSpaceCntOfSecondLine){let spaceCntOffset=newSpaceCntOfSecondLine-oldSpaceCntOfSecondLine;for(let i=startLineNumber+1;i<=range.endLineNumber;i++){let lineContent=model.getLineContent(i),originalIndent=strings.getLeadingWhitespace(lineContent),newSpacesCnt=indentUtils.getSpaceCnt(originalIndent,tabSize)+spaceCntOffset,newIndent=indentUtils.generateIndent(newSpacesCnt,tabSize,insertSpaces);newIndent!==originalIndent&&textEdits.push({range:new range_1.Range(i,1,i,originalIndent.length+1),text:newIndent})}}}}if(textEdits.length>0){this.editor.pushUndoStop();let cmd=new AutoIndentOnPasteCommand(textEdits,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",cmd),this.editor.pushUndoStop()}}shouldIgnoreLine(model,lineNumber){model.forceTokenization(lineNumber);let nonWhitespaceColumn=model.getLineFirstNonWhitespaceColumn(lineNumber);if(0===nonWhitespaceColumn)return!0;let tokens=model.getLineTokens(lineNumber);if(tokens.getCount()>0){let firstNonWhitespaceTokenIndex=tokens.findTokenIndexAtOffset(nonWhitespaceColumn);if(firstNonWhitespaceTokenIndex>=0&&1===tokens.getStandardTokenType(firstNonWhitespaceTokenIndex))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}}function getIndentationEditOperations(model,builder,tabSize,tabsToSpaces){if(1===model.getLineCount()&&1===model.getLineMaxColumn(1))return;let spaces="";for(let i=0;i<tabSize;i++)spaces+=" ";let spacesRegExp=new RegExp(spaces,"gi");for(let lineNumber=1,lineCount=model.getLineCount();lineNumber<=lineCount;lineNumber++){let lastIndentationColumn=model.getLineFirstNonWhitespaceColumn(lineNumber);if(0===lastIndentationColumn&&(lastIndentationColumn=model.getLineMaxColumn(lineNumber)),1===lastIndentationColumn)continue;const originalIndentationRange=new range_1.Range(lineNumber,1,lineNumber,lastIndentationColumn),originalIndentation=model.getValueInRange(originalIndentationRange),newIndentation=tabsToSpaces?originalIndentation.replace(/\t/gi,spaces):originalIndentation.replace(spacesRegExp,"\t");builder.addEditOperation(originalIndentationRange,newIndentation)}}exports.AutoIndentOnPaste=AutoIndentOnPaste,AutoIndentOnPaste.ID="editor.contrib.autoIndentOnPaste";class IndentationToSpacesCommand{constructor(selection,tabSize){this.selection=selection,this.tabSize=tabSize,this.selectionId=null}getEditOperations(model,builder){this.selectionId=builder.trackSelection(this.selection),getIndentationEditOperations(model,builder,this.tabSize,!0)}computeCursorState(model,helper){return helper.getTrackedSelection(this.selectionId)}}exports.IndentationToSpacesCommand=IndentationToSpacesCommand;class IndentationToTabsCommand{constructor(selection,tabSize){this.selection=selection,this.tabSize=tabSize,this.selectionId=null}getEditOperations(model,builder){this.selectionId=builder.trackSelection(this.selection),getIndentationEditOperations(model,builder,this.tabSize,!1)}computeCursorState(model,helper){return helper.getTrackedSelection(this.selectionId)}}exports.IndentationToTabsCommand=IndentationToTabsCommand,(0,editorExtensions_1.registerEditorContribution)(AutoIndentOnPaste.ID,AutoIndentOnPaste),(0,editorExtensions_1.registerEditorAction)(IndentationToSpacesAction),(0,editorExtensions_1.registerEditorAction)(IndentationToTabsAction),(0,editorExtensions_1.registerEditorAction)(IndentUsingTabs),(0,editorExtensions_1.registerEditorAction)(IndentUsingSpaces),(0,editorExtensions_1.registerEditorAction)(DetectIndentation),(0,editorExtensions_1.registerEditorAction)(ReindentLinesAction),(0,editorExtensions_1.registerEditorAction)(ReindentSelectedLinesAction)})),define(__m[208],__M([1,0,10,21,13,4,2,8,158,63,3,27,193,26,263,194,33,436,20,67]),(function(require,exports,async_1,cancellation_1,errors_1,event_1,lifecycle_1,strings_1,coreCommands_1,editOperation_1,range_1,languages_1,ghostText_1,commands_1,consts_1,inlineCompletionToGhostText_1,languageConfigurationRegistry_1,fixBrackets_1,languageFeatures_1,languageFeatureDebounce_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.minimizeInlineCompletion=exports.provideInlineCompletions=exports.SynchronizedInlineCompletionsCache=exports.UpdateOperation=exports.InlineCompletionsSession=exports.InlineCompletionsModel=void 0;let InlineCompletionsModel=class InlineCompletionsModel extends lifecycle_1.Disposable{constructor(editor,cache,commandService,languageConfigurationService,languageFeaturesService,debounceService){super(),this.editor=editor,this.cache=cache,this.commandService=commandService,this.languageConfigurationService=languageConfigurationService,this.languageFeaturesService=languageFeaturesService,this.debounceService=debounceService,this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new lifecycle_1.MutableDisposable),this.active=!1,this.disposed=!1,this.debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:200}),this._register(commandService.onDidExecuteCommand((e=>{new Set([coreCommands_1.CoreEditingCommands.Tab.id,coreCommands_1.CoreEditingCommands.DeleteLeft.id,coreCommands_1.CoreEditingCommands.DeleteRight.id,consts_1.inlineSuggestCommitId,"acceptSelectedSuggestion"]).has(e.commandId)&&editor.hasTextFocus()&&this.handleUserInput()}))),this._register(this.editor.onDidType((e=>{this.handleUserInput()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.session&&!this.session.isValid&&this.hide()}))),this._register((0,lifecycle_1.toDisposable)((()=>{this.disposed=!0}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this.hide()})))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout((()=>{this.disposed||this.startSessionIfTriggered()}),0)}get session(){return this.completionSession.value}get ghostText(){var _a;return null===(_a=this.session)||void 0===_a?void 0:_a.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(expanded){var _a;null===(_a=this.session)||void 0===_a||_a.setExpanded(expanded)}setActive(active){var _a;this.active=active,active&&(null===(_a=this.session)||void 0===_a||_a.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(55).enabled&&(this.session&&this.session.isValid||this.trigger(languages_1.InlineCompletionTriggerKind.Automatic))}trigger(triggerKind){this.completionSession.value?triggerKind===languages_1.InlineCompletionTriggerKind.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext():(this.completionSession.value=new InlineCompletionsSession(this.editor,this.editor.getPosition(),(()=>this.active),this.commandService,this.cache,triggerKind,this.languageConfigurationService,this.languageFeaturesService.inlineCompletionsProvider,this.debounceValue),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((()=>{this.onDidChangeEmitter.fire()}))))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var _a;null===(_a=this.session)||void 0===_a||_a.commitCurrentCompletion()}showNext(){var _a;null===(_a=this.session)||void 0===_a||_a.showNextInlineCompletion()}showPrevious(){var _a;null===(_a=this.session)||void 0===_a||_a.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var _a;return __awaiter(this,void 0,void 0,(function*(){const result=yield null===(_a=this.session)||void 0===_a?void 0:_a.hasMultipleInlineCompletions();return void 0!==result&&result}))}};InlineCompletionsModel=__decorate([__param(2,commands_1.ICommandService),__param(3,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(4,languageFeatures_1.ILanguageFeaturesService),__param(5,languageFeatureDebounce_1.ILanguageFeatureDebounceService)],InlineCompletionsModel),exports.InlineCompletionsModel=InlineCompletionsModel;class InlineCompletionsSession extends ghostText_1.BaseGhostTextWidgetModel{constructor(editor,triggerPosition,shouldUpdate,commandService,cache,initialTriggerKind,languageConfigurationService,registry,debounce){let lastCompletionItem;super(editor),this.triggerPosition=triggerPosition,this.shouldUpdate=shouldUpdate,this.commandService=commandService,this.cache=cache,this.initialTriggerKind=initialTriggerKind,this.languageConfigurationService=languageConfigurationService,this.registry=registry,this.debounce=debounce,this.minReservedLineCount=0,this.updateOperation=this._register(new lifecycle_1.MutableDisposable),this.updateSoon=this._register(new async_1.RunOnceScheduler((()=>{let triggerKind=this.initialTriggerKind;return this.initialTriggerKind=languages_1.InlineCompletionTriggerKind.Automatic,this.update(triggerKind)}),50)),this.currentlySelectedCompletionId=void 0,this._register(this.onDidChange((()=>{const currentCompletion=this.currentCompletion;if(currentCompletion&&currentCompletion.sourceInlineCompletion!==lastCompletionItem){lastCompletionItem=currentCompletion.sourceInlineCompletion;const provider=currentCompletion.sourceProvider;provider.handleItemDidShow&&provider.handleItemDidShow(currentCompletion.sourceInlineCompletions,lastCompletionItem)}}))),this._register((0,lifecycle_1.toDisposable)((()=>{this.cache.clear()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.cache.value&&this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeModelContent((e=>{this.scheduleAutomaticUpdate()}))),this._register(this.registry.onDidChange((()=>{this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}))),this.scheduleAutomaticUpdate()}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;const idx=this.cache.value.completions.findIndex((v=>v.semanticId===this.currentlySelectedCompletionId));return-1===idx?(this.currentlySelectedCompletionId=void 0,0):idx}get currentCachedCompletion(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){var _a;return __awaiter(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const completions=(null===(_a=this.cache.value)||void 0===_a?void 0:_a.completions)||[];if(completions.length>0){const newIdx=(this.fixAndGetIndexOfCurrentSelection()+1)%completions.length;this.currentlySelectedCompletionId=completions[newIdx].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}showPreviousInlineCompletion(){var _a;return __awaiter(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const completions=(null===(_a=this.cache.value)||void 0===_a?void 0:_a.completions)||[];if(completions.length>0){const newIdx=(this.fixAndGetIndexOfCurrentSelection()+completions.length-1)%completions.length;this.currentlySelectedCompletionId=completions[newIdx].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}ensureUpdateWithExplicitContext(){var _a;return __awaiter(this,void 0,void 0,(function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===languages_1.InlineCompletionTriggerKind.Explicit?yield this.updateOperation.value.promise:yield this.update(languages_1.InlineCompletionTriggerKind.Explicit):(null===(_a=this.cache.value)||void 0===_a?void 0:_a.triggerKind)!==languages_1.InlineCompletionTriggerKind.Explicit&&(yield this.update(languages_1.InlineCompletionTriggerKind.Explicit))}))}hasMultipleInlineCompletions(){var _a;return __awaiter(this,void 0,void 0,(function*(){return yield this.ensureUpdateWithExplicitContext(),((null===(_a=this.cache.value)||void 0===_a?void 0:_a.completions.length)||0)>1}))}get ghostText(){const currentCompletion=this.currentCompletion,mode=this.editor.getOptions().get(55).mode;return currentCompletion?(0,inlineCompletionToGhostText_1.inlineCompletionToGhostText)(currentCompletion,this.editor.getModel(),mode,this.editor.getPosition()):void 0}get currentCompletion(){const completion=this.currentCachedCompletion;if(completion)return completion.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}update(triggerKind){return __awaiter(this,void 0,void 0,(function*(){if(!this.shouldUpdate())return;const position=this.editor.getPosition(),startTime=new Date,promise=(0,async_1.createCancelablePromise)((token=>__awaiter(this,void 0,void 0,(function*(){let result;try{result=yield provideInlineCompletions(this.registry,position,this.editor.getModel(),{triggerKind,selectedSuggestionInfo:void 0},token,this.languageConfigurationService);const endTime=new Date;this.debounce.update(this.editor.getModel(),endTime.getTime()-startTime.getTime())}catch(e){return void(0,errors_1.onUnexpectedError)(e)}token.isCancellationRequested||(this.cache.setValue(this.editor,result,triggerKind),this.onDidChangeEmitter.fire())})))),operation=new UpdateOperation(promise,triggerKind);this.updateOperation.value=operation,yield promise,this.updateOperation.value===operation&&this.updateOperation.clear()}))}takeOwnership(disposable){this._register(disposable)}commitCurrentCompletion(){if(!this.ghostText)return;const completion=this.currentCompletion;completion&&this.commit(completion)}commit(completion){const cache=this.cache.clearAndLeak();this.editor.executeEdits("inlineSuggestion.accept",[editOperation_1.EditOperation.replaceMove(completion.range,completion.text)]),completion.command?this.commandService.executeCommand(completion.command.id,...completion.command.arguments||[]).finally((()=>{null==cache||cache.dispose()})).then(void 0,errors_1.onUnexpectedExternalError):null==cache||cache.dispose(),this.onDidChangeEmitter.fire()}}exports.InlineCompletionsSession=InlineCompletionsSession;class UpdateOperation{constructor(promise,triggerKind){this.promise=promise,this.triggerKind=triggerKind}dispose(){this.promise.cancel()}}exports.UpdateOperation=UpdateOperation;class SynchronizedInlineCompletionsCache extends lifecycle_1.Disposable{constructor(editor,completionsSource,onChange,triggerKind){super(),this.triggerKind=triggerKind;const decorationIds=editor.deltaDecorations([],completionsSource.items.map((i=>({range:i.range,options:{description:"inline-completion-tracking-range"}}))));this._register((0,lifecycle_1.toDisposable)((()=>{editor.deltaDecorations(decorationIds,[])}))),this.completions=completionsSource.items.map(((c,idx)=>new CachedInlineCompletion(c,decorationIds[idx]))),this._register(editor.onDidChangeModelContent((()=>{let hasChanged=!1;const model=editor.getModel();for(const c of this.completions){const newRange=model.getDecorationRange(c.decorationId);newRange?c.synchronizedRange.equalsRange(newRange)||(hasChanged=!0,c.synchronizedRange=newRange):(0,errors_1.onUnexpectedError)(new Error("Decoration has no range"))}hasChanged&&onChange()}))),this._register(completionsSource)}}exports.SynchronizedInlineCompletionsCache=SynchronizedInlineCompletionsCache;class CachedInlineCompletion{constructor(inlineCompletion,decorationId){this.inlineCompletion=inlineCompletion,this.decorationId=decorationId,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=inlineCompletion.range}toLiveInlineCompletion(){return{text:this.inlineCompletion.text,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion}}}function provideInlineCompletions(registry,position,model,context,token=cancellation_1.CancellationToken.None,languageConfigurationService){return __awaiter(this,void 0,void 0,(function*(){const defaultReplaceRange=function getDefaultRange(position,model){const word=model.getWordAtPosition(position),maxColumn=model.getLineMaxColumn(position.lineNumber);return word?new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,maxColumn):range_1.Range.fromPositions(position,position.with(void 0,maxColumn))}(position,model),providers=registry.all(model),results=yield Promise.all(providers.map((provider=>__awaiter(this,void 0,void 0,(function*(){const completions=yield Promise.resolve(provider.provideInlineCompletions(model,position,context,token)).catch(errors_1.onUnexpectedExternalError);return{completions,provider,dispose:()=>{completions&&provider.freeInlineCompletions(completions)}}}))))),itemsByHash=new Map;for(const result of results){const completions=result.completions;if(completions)for(const item of completions.items){const range=item.range?range_1.Range.lift(item.range):defaultReplaceRange;if(range.startLineNumber!==range.endLineNumber)continue;const text=languageConfigurationService&&item.completeBracketPairs?closeBrackets(item.text,range.getStartPosition(),model,languageConfigurationService):item.text,trackedItem={text,range,command:item.command,sourceProvider:result.provider,sourceInlineCompletions:completions,sourceInlineCompletion:item};itemsByHash.set(JSON.stringify({text,range:item.range}),trackedItem)}}return{items:[...itemsByHash.values()],dispose:()=>{for(const result of results)result.dispose()}}}))}function closeBrackets(text,position,model,languageConfigurationService){const newLine=model.getLineContent(position.lineNumber).substring(0,position.column-1)+text,newTokens=model.tokenizeLineWithEdit(position,newLine.length-(position.column-1),text),slicedTokens=null==newTokens?void 0:newTokens.sliceAndInflate(position.column-1,newLine.length,0);if(!slicedTokens)return text;console.log(slicedTokens);return(0,fixBrackets_1.fixBracketsInLine)(slicedTokens,languageConfigurationService)}exports.provideInlineCompletions=provideInlineCompletions,exports.minimizeInlineCompletion=function minimizeInlineCompletion(model,inlineCompletion){if(!inlineCompletion)return inlineCompletion;const valueToReplace=model.getValueInRange(inlineCompletion.range),commonPrefixLen=(0,strings_1.commonPrefixLength)(valueToReplace,inlineCompletion.text),startOffset=model.getOffsetAt(inlineCompletion.range.getStartPosition())+commonPrefixLen,start=model.getPositionAt(startOffset),remainingValueToReplace=valueToReplace.substr(commonPrefixLen),commonSuffixLen=(0,strings_1.commonSuffixLength)(remainingValueToReplace,inlineCompletion.text),end=model.getPositionAt(Math.max(startOffset,model.getOffsetAt(inlineCompletion.range.getEndPosition())-commonSuffixLen));return{range:range_1.Range.fromPositions(start,end),text:inlineCompletion.text.substr(commonPrefixLen,inlineCompletion.text.length-commonPrefixLen-commonSuffixLen)}}})),define(__m[685],__M([1,0,15,182,24,560]),(function(require,exports,editorExtensions_1,cursorMoveCommands_1,editorContextKeys_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpandLineSelectionAction=void 0;class ExpandLineSelectionAction extends editorExtensions_1.EditorAction{constructor(){super({id:"expandLineSelection",label:nls.localize(0,null),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2090}})}run(_accessor,editor,args){if(args=args||{},!editor.hasModel())return;const viewModel=editor._getViewModel();viewModel.model.pushStackElement(),viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.expandLineSelection(viewModel,viewModel.getCursorStates())),viewModel.revealPrimaryCursor(args.source,!0)}}exports.ExpandLineSelectionAction=ExpandLineSelectionAction,(0,editorExtensions_1.registerEditorAction)(ExpandLineSelectionAction)})),define(__m[686],__M([1,0,58,158,15,100,405,203,63,11,3,22,24,469,610,470,561,37]),(function(require,exports,keyCodes_1,coreCommands_1,editorExtensions_1,replaceCommand_1,trimTrailingWhitespaceCommand_1,cursorTypeOperations_1,editOperation_1,position_1,range_1,selection_1,editorContextKeys_1,copyLinesCommand_1,moveLinesCommand_1,sortLinesCommand_1,nls,actions_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SnakeCaseAction=exports.TitleCaseAction=exports.LowerCaseAction=exports.UpperCaseAction=exports.AbstractCaseAction=exports.TransposeAction=exports.JoinLinesAction=exports.DeleteAllRightAction=exports.DeleteAllLeftAction=exports.AbstractDeleteAllToBoundaryAction=exports.InsertLineAfterAction=exports.InsertLineBeforeAction=exports.IndentLinesAction=exports.DeleteLinesAction=exports.TrimTrailingWhitespaceAction=exports.DeleteDuplicateLinesAction=exports.SortLinesDescendingAction=exports.SortLinesAscendingAction=exports.AbstractSortLinesAction=exports.DuplicateSelectionAction=void 0;class AbstractCopyLinesAction extends editorExtensions_1.EditorAction{constructor(down,opts){super(opts),this.down=down}run(_accessor,editor){if(!editor.hasModel())return;const selections=editor.getSelections().map(((selection,index)=>({selection,index,ignore:!1})));selections.sort(((a,b)=>range_1.Range.compareRangesUsingStarts(a.selection,b.selection)));let prev=selections[0];for(let i=1;i<selections.length;i++){const curr=selections[i];prev.selection.endLineNumber===curr.selection.startLineNumber&&(prev.index<curr.index?curr.ignore=!0:(prev.ignore=!0,prev=curr))}const commands=[];for(const selection of selections)commands.push(new copyLinesCommand_1.CopyLinesCommand(selection.selection,this.down,selection.ignore));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}class DuplicateSelectionAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.duplicateSelection",label:nls.localize(4,null),alias:"Duplicate Selection",precondition:editorContextKeys_1.EditorContextKeys.writable,menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"2_line",title:nls.localize(5,null),order:5}})}run(accessor,editor,args){if(!editor.hasModel())return;const commands=[],selections=editor.getSelections(),model=editor.getModel();for(const selection of selections)if(selection.isEmpty())commands.push(new copyLinesCommand_1.CopyLinesCommand(selection,!0));else{const insertSelection=new selection_1.Selection(selection.endLineNumber,selection.endColumn,selection.endLineNumber,selection.endColumn);commands.push(new replaceCommand_1.ReplaceCommandThatSelectsText(insertSelection,model.getValueInRange(selection)))}editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}exports.DuplicateSelectionAction=DuplicateSelectionAction;class AbstractMoveLinesAction extends editorExtensions_1.EditorAction{constructor(down,opts){super(opts),this.down=down}run(_accessor,editor){let commands=[],selections=editor.getSelections()||[];const autoIndent=editor.getOption(9);for(const selection of selections)commands.push(new moveLinesCommand_1.MoveLinesCommand(selection,this.down,autoIndent));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}class AbstractSortLinesAction extends editorExtensions_1.EditorAction{constructor(descending,opts){super(opts),this.descending=descending}run(_accessor,editor){const selections=editor.getSelections()||[];for(const selection of selections)if(!sortLinesCommand_1.SortLinesCommand.canRun(editor.getModel(),selection,this.descending))return;let commands=[];for(let i=0,len=selections.length;i<len;i++)commands[i]=new sortLinesCommand_1.SortLinesCommand(selections[i],this.descending);editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}exports.AbstractSortLinesAction=AbstractSortLinesAction;class SortLinesAscendingAction extends AbstractSortLinesAction{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:nls.localize(10,null),alias:"Sort Lines Ascending",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.SortLinesAscendingAction=SortLinesAscendingAction;class SortLinesDescendingAction extends AbstractSortLinesAction{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:nls.localize(11,null),alias:"Sort Lines Descending",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.SortLinesDescendingAction=SortLinesDescendingAction;class DeleteDuplicateLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.removeDuplicateLines",label:nls.localize(12,null),alias:"Delete Duplicate Lines",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(_accessor,editor){if(!editor.hasModel())return;let model=editor.getModel();if(1===model.getLineCount()&&1===model.getLineMaxColumn(1))return;let edits=[],endCursorState=[],linesDeleted=0;for(let selection of editor.getSelections()){let uniqueLines=new Set,lines=[];for(let i=selection.startLineNumber;i<=selection.endLineNumber;i++){let line=model.getLineContent(i);uniqueLines.has(line)||(lines.push(line),uniqueLines.add(line))}let selectionToReplace=new selection_1.Selection(selection.startLineNumber,1,selection.endLineNumber,model.getLineMaxColumn(selection.endLineNumber)),adjustedSelectionStart=selection.startLineNumber-linesDeleted,finalSelection=new selection_1.Selection(adjustedSelectionStart,1,adjustedSelectionStart+lines.length-1,lines[lines.length-1].length);edits.push(editOperation_1.EditOperation.replace(selectionToReplace,lines.join("\n"))),endCursorState.push(finalSelection),linesDeleted+=selection.endLineNumber-selection.startLineNumber+1-lines.length}editor.pushUndoStop(),editor.executeEdits(this.id,edits,endCursorState),editor.pushUndoStop()}}exports.DeleteDuplicateLinesAction=DeleteDuplicateLinesAction;class TrimTrailingWhitespaceAction extends editorExtensions_1.EditorAction{constructor(){super({id:TrimTrailingWhitespaceAction.ID,label:nls.localize(13,null),alias:"Trim Trailing Whitespace",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2102),weight:100}})}run(_accessor,editor,args){let cursors=[];"auto-save"===args.reason&&(cursors=(editor.getSelections()||[]).map((s=>new position_1.Position(s.positionLineNumber,s.positionColumn))));let selection=editor.getSelection();if(null===selection)return;let command=new trimTrailingWhitespaceCommand_1.TrimTrailingWhitespaceCommand(selection,cursors);editor.pushUndoStop(),editor.executeCommands(this.id,[command]),editor.pushUndoStop()}}exports.TrimTrailingWhitespaceAction=TrimTrailingWhitespaceAction,TrimTrailingWhitespaceAction.ID="editor.action.trimTrailingWhitespace";class DeleteLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.deleteLines",label:nls.localize(14,null),alias:"Delete Line",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:3113,weight:100}})}run(_accessor,editor){if(!editor.hasModel())return;let ops=this._getLinesToRemove(editor),model=editor.getModel();if(1===model.getLineCount()&&1===model.getLineMaxColumn(1))return;let linesDeleted=0,edits=[],cursorState=[];for(let i=0,len=ops.length;i<len;i++){const op=ops[i];let startLineNumber=op.startLineNumber,endLineNumber=op.endLineNumber,startColumn=1,endColumn=model.getLineMaxColumn(endLineNumber);endLineNumber<model.getLineCount()?(endLineNumber+=1,endColumn=1):startLineNumber>1&&(startLineNumber-=1,startColumn=model.getLineMaxColumn(startLineNumber)),edits.push(editOperation_1.EditOperation.replace(new selection_1.Selection(startLineNumber,startColumn,endLineNumber,endColumn),"")),cursorState.push(new selection_1.Selection(startLineNumber-linesDeleted,op.positionColumn,startLineNumber-linesDeleted,op.positionColumn)),linesDeleted+=op.endLineNumber-op.startLineNumber+1}editor.pushUndoStop(),editor.executeEdits(this.id,edits,cursorState),editor.pushUndoStop()}_getLinesToRemove(editor){let operations=editor.getSelections().map((s=>{let endLineNumber=s.endLineNumber;return s.startLineNumber<s.endLineNumber&&1===s.endColumn&&(endLineNumber-=1),{startLineNumber:s.startLineNumber,selectionStartColumn:s.selectionStartColumn,endLineNumber,positionColumn:s.positionColumn}}));operations.sort(((a,b)=>a.startLineNumber===b.startLineNumber?a.endLineNumber-b.endLineNumber:a.startLineNumber-b.startLineNumber));let mergedOperations=[],previousOperation=operations[0];for(let i=1;i<operations.length;i++)previousOperation.endLineNumber+1>=operations[i].startLineNumber?previousOperation.endLineNumber=operations[i].endLineNumber:(mergedOperations.push(previousOperation),previousOperation=operations[i]);return mergedOperations.push(previousOperation),mergedOperations}}exports.DeleteLinesAction=DeleteLinesAction;class IndentLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.indentLines",label:nls.localize(15,null),alias:"Indent Line",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2137,weight:100}})}run(_accessor,editor){const viewModel=editor._getViewModel();viewModel&&(editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.indent(viewModel.cursorConfig,editor.getModel(),editor.getSelections())),editor.pushUndoStop())}}exports.IndentLinesAction=IndentLinesAction;class OutdentLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.outdentLines",label:nls.localize(16,null),alias:"Outdent Line",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2135,weight:100}})}run(_accessor,editor){coreCommands_1.CoreEditingCommands.Outdent.runEditorCommand(_accessor,editor,null)}}class InsertLineBeforeAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.insertLineBefore",label:nls.localize(17,null),alias:"Insert Line Above",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3075,weight:100}})}run(_accessor,editor){const viewModel=editor._getViewModel();viewModel&&(editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.lineInsertBefore(viewModel.cursorConfig,editor.getModel(),editor.getSelections())))}}exports.InsertLineBeforeAction=InsertLineBeforeAction;class InsertLineAfterAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.insertLineAfter",label:nls.localize(18,null),alias:"Insert Line Below",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2051,weight:100}})}run(_accessor,editor){const viewModel=editor._getViewModel();viewModel&&(editor.pushUndoStop(),editor.executeCommands(this.id,cursorTypeOperations_1.TypeOperations.lineInsertAfter(viewModel.cursorConfig,editor.getModel(),editor.getSelections())))}}exports.InsertLineAfterAction=InsertLineAfterAction;class AbstractDeleteAllToBoundaryAction extends editorExtensions_1.EditorAction{run(_accessor,editor){if(!editor.hasModel())return;const primaryCursor=editor.getSelection();let rangesToDelete=this._getRangesToDelete(editor),effectiveRanges=[];for(let i=0,count=rangesToDelete.length-1;i<count;i++){let range=rangesToDelete[i],nextRange=rangesToDelete[i+1];null===range_1.Range.intersectRanges(range,nextRange)?effectiveRanges.push(range):rangesToDelete[i+1]=range_1.Range.plusRange(range,nextRange)}effectiveRanges.push(rangesToDelete[rangesToDelete.length-1]);let endCursorState=this._getEndCursorState(primaryCursor,effectiveRanges),edits=effectiveRanges.map((range=>editOperation_1.EditOperation.replace(range,"")));editor.pushUndoStop(),editor.executeEdits(this.id,edits,endCursorState),editor.pushUndoStop()}}exports.AbstractDeleteAllToBoundaryAction=AbstractDeleteAllToBoundaryAction;class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllLeft",label:nls.localize(19,null),alias:"Delete All Left",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(primaryCursor,rangesToDelete){let endPrimaryCursor=null,endCursorState=[],deletedLines=0;return rangesToDelete.forEach((range=>{let endCursor;if(1===range.endColumn&&deletedLines>0){let newStartLine=range.startLineNumber-deletedLines;endCursor=new selection_1.Selection(newStartLine,range.startColumn,newStartLine,range.startColumn)}else endCursor=new selection_1.Selection(range.startLineNumber,range.startColumn,range.startLineNumber,range.startColumn);deletedLines+=range.endLineNumber-range.startLineNumber,range.intersectRanges(primaryCursor)?endPrimaryCursor=endCursor:endCursorState.push(endCursor)})),endPrimaryCursor&&endCursorState.unshift(endPrimaryCursor),endCursorState}_getRangesToDelete(editor){let selections=editor.getSelections();if(null===selections)return[];let rangesToDelete=selections,model=editor.getModel();return null===model?[]:(rangesToDelete.sort(range_1.Range.compareRangesUsingStarts),rangesToDelete=rangesToDelete.map((selection=>{if(selection.isEmpty()){if(1===selection.startColumn){let deleteFromLine=Math.max(1,selection.startLineNumber-1),deleteFromColumn=1===selection.startLineNumber?1:model.getLineContent(deleteFromLine).length+1;return new range_1.Range(deleteFromLine,deleteFromColumn,selection.startLineNumber,1)}return new range_1.Range(selection.startLineNumber,1,selection.startLineNumber,selection.startColumn)}return new range_1.Range(selection.startLineNumber,1,selection.endLineNumber,selection.endColumn)})),rangesToDelete)}}exports.DeleteAllLeftAction=DeleteAllLeftAction;class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllRight",label:nls.localize(20,null),alias:"Delete All Right",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(primaryCursor,rangesToDelete){let endPrimaryCursor=null,endCursorState=[];for(let i=0,len=rangesToDelete.length,offset=0;i<len;i++){let range=rangesToDelete[i],endCursor=new selection_1.Selection(range.startLineNumber-offset,range.startColumn,range.startLineNumber-offset,range.startColumn);range.intersectRanges(primaryCursor)?endPrimaryCursor=endCursor:endCursorState.push(endCursor)}return endPrimaryCursor&&endCursorState.unshift(endPrimaryCursor),endCursorState}_getRangesToDelete(editor){let model=editor.getModel();if(null===model)return[];let selections=editor.getSelections();if(null===selections)return[];let rangesToDelete=selections.map((sel=>{if(sel.isEmpty()){const maxColumn=model.getLineMaxColumn(sel.startLineNumber);return sel.startColumn===maxColumn?new range_1.Range(sel.startLineNumber,sel.startColumn,sel.startLineNumber+1,1):new range_1.Range(sel.startLineNumber,sel.startColumn,sel.startLineNumber,maxColumn)}return sel}));return rangesToDelete.sort(range_1.Range.compareRangesUsingStarts),rangesToDelete}}exports.DeleteAllRightAction=DeleteAllRightAction;class JoinLinesAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.joinLines",label:nls.localize(21,null),alias:"Join Lines",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(_accessor,editor){let selections=editor.getSelections();if(null===selections)return;let primaryCursor=editor.getSelection();if(null===primaryCursor)return;selections.sort(range_1.Range.compareRangesUsingStarts);let reducedSelections=[],lastSelection=selections.reduce(((previousValue,currentValue)=>previousValue.isEmpty()?previousValue.endLineNumber===currentValue.startLineNumber?(primaryCursor.equalsSelection(previousValue)&&(primaryCursor=currentValue),currentValue):currentValue.startLineNumber>previousValue.endLineNumber+1?(reducedSelections.push(previousValue),currentValue):new selection_1.Selection(previousValue.startLineNumber,previousValue.startColumn,currentValue.endLineNumber,currentValue.endColumn):currentValue.startLineNumber>previousValue.endLineNumber?(reducedSelections.push(previousValue),currentValue):new selection_1.Selection(previousValue.startLineNumber,previousValue.startColumn,currentValue.endLineNumber,currentValue.endColumn)));reducedSelections.push(lastSelection);let model=editor.getModel();if(null===model)return;let edits=[],endCursorState=[],endPrimaryCursor=primaryCursor,lineOffset=0;for(let i=0,len=reducedSelections.length;i<len;i++){let endLineNumber,endColumn,selection=reducedSelections[i],startLineNumber=selection.startLineNumber,startColumn=1,columnDeltaOffset=0,selectionEndPositionOffset=model.getLineContent(selection.endLineNumber).length-selection.endColumn;if(selection.isEmpty()||selection.startLineNumber===selection.endLineNumber){let position=selection.getStartPosition();position.lineNumber<model.getLineCount()?(endLineNumber=startLineNumber+1,endColumn=model.getLineMaxColumn(endLineNumber)):(endLineNumber=position.lineNumber,endColumn=model.getLineMaxColumn(position.lineNumber))}else endLineNumber=selection.endLineNumber,endColumn=model.getLineMaxColumn(endLineNumber);let trimmedLinesContent=model.getLineContent(startLineNumber);for(let i=startLineNumber+1;i<=endLineNumber;i++){let lineText=model.getLineContent(i),firstNonWhitespaceIdx=model.getLineFirstNonWhitespaceColumn(i);if(firstNonWhitespaceIdx>=1){let insertSpace=!0;""===trimmedLinesContent&&(insertSpace=!1),!insertSpace||" "!==trimmedLinesContent.charAt(trimmedLinesContent.length-1)&&"\t"!==trimmedLinesContent.charAt(trimmedLinesContent.length-1)||(insertSpace=!1,trimmedLinesContent=trimmedLinesContent.replace(/[\s\uFEFF\xA0]+$/g," "));let lineTextWithoutIndent=lineText.substr(firstNonWhitespaceIdx-1);trimmedLinesContent+=(insertSpace?" ":"")+lineTextWithoutIndent,columnDeltaOffset=insertSpace?lineTextWithoutIndent.length+1:lineTextWithoutIndent.length}else columnDeltaOffset=0}let deleteSelection=new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn);if(!deleteSelection.isEmpty()){let resultSelection;selection.isEmpty()?(edits.push(editOperation_1.EditOperation.replace(deleteSelection,trimmedLinesContent)),resultSelection=new selection_1.Selection(deleteSelection.startLineNumber-lineOffset,trimmedLinesContent.length-columnDeltaOffset+1,startLineNumber-lineOffset,trimmedLinesContent.length-columnDeltaOffset+1)):selection.startLineNumber===selection.endLineNumber?(edits.push(editOperation_1.EditOperation.replace(deleteSelection,trimmedLinesContent)),resultSelection=new selection_1.Selection(selection.startLineNumber-lineOffset,selection.startColumn,selection.endLineNumber-lineOffset,selection.endColumn)):(edits.push(editOperation_1.EditOperation.replace(deleteSelection,trimmedLinesContent)),resultSelection=new selection_1.Selection(selection.startLineNumber-lineOffset,selection.startColumn,selection.startLineNumber-lineOffset,trimmedLinesContent.length-selectionEndPositionOffset)),null!==range_1.Range.intersectRanges(deleteSelection,primaryCursor)?endPrimaryCursor=resultSelection:endCursorState.push(resultSelection)}lineOffset+=deleteSelection.endLineNumber-deleteSelection.startLineNumber}endCursorState.unshift(endPrimaryCursor),editor.pushUndoStop(),editor.executeEdits(this.id,edits,endCursorState),editor.pushUndoStop()}}exports.JoinLinesAction=JoinLinesAction;class TransposeAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.transpose",label:nls.localize(22,null),alias:"Transpose characters around the cursor",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(_accessor,editor){let selections=editor.getSelections();if(null===selections)return;let model=editor.getModel();if(null===model)return;let commands=[];for(let i=0,len=selections.length;i<len;i++){let selection=selections[i];if(!selection.isEmpty())continue;let cursor=selection.getStartPosition(),maxColumn=model.getLineMaxColumn(cursor.lineNumber);if(cursor.column>=maxColumn){if(cursor.lineNumber===model.getLineCount())continue;let deleteSelection=new range_1.Range(cursor.lineNumber,Math.max(1,cursor.column-1),cursor.lineNumber+1,1),chars=model.getValueInRange(deleteSelection).split("").reverse().join("");commands.push(new replaceCommand_1.ReplaceCommand(new selection_1.Selection(cursor.lineNumber,Math.max(1,cursor.column-1),cursor.lineNumber+1,1),chars))}else{let deleteSelection=new range_1.Range(cursor.lineNumber,Math.max(1,cursor.column-1),cursor.lineNumber,cursor.column+1),chars=model.getValueInRange(deleteSelection).split("").reverse().join("");commands.push(new replaceCommand_1.ReplaceCommandThatPreservesSelection(deleteSelection,chars,new selection_1.Selection(cursor.lineNumber,cursor.column+1,cursor.lineNumber,cursor.column+1)))}}editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}exports.TransposeAction=TransposeAction;class AbstractCaseAction extends editorExtensions_1.EditorAction{run(_accessor,editor){const selections=editor.getSelections();if(null===selections)return;const model=editor.getModel();if(null===model)return;const wordSeparators=editor.getOption(117),textEdits=[];for(const selection of selections)if(selection.isEmpty()){const cursor=selection.getStartPosition(),word=editor.getConfiguredWordAtPosition(cursor);if(!word)continue;const wordRange=new range_1.Range(cursor.lineNumber,word.startColumn,cursor.lineNumber,word.endColumn),text=model.getValueInRange(wordRange);textEdits.push(editOperation_1.EditOperation.replace(wordRange,this._modifyText(text,wordSeparators)))}else{const text=model.getValueInRange(selection);textEdits.push(editOperation_1.EditOperation.replace(selection,this._modifyText(text,wordSeparators)))}editor.pushUndoStop(),editor.executeEdits(this.id,textEdits),editor.pushUndoStop()}}exports.AbstractCaseAction=AbstractCaseAction;class UpperCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToUppercase",label:nls.localize(23,null),alias:"Transform to Uppercase",precondition:editorContextKeys_1.EditorContextKeys.writable})}_modifyText(text,wordSeparators){return text.toLocaleUpperCase()}}exports.UpperCaseAction=UpperCaseAction;class LowerCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToLowercase",label:nls.localize(24,null),alias:"Transform to Lowercase",precondition:editorContextKeys_1.EditorContextKeys.writable})}_modifyText(text,wordSeparators){return text.toLocaleLowerCase()}}exports.LowerCaseAction=LowerCaseAction;class BackwardsCompatibleRegExp{constructor(_pattern,_flags){this._pattern=_pattern,this._flags=_flags,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(err){}}return this._actual}isSupported(){return null!==this.get()}}class TitleCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToTitlecase",label:nls.localize(25,null),alias:"Transform to Title Case",precondition:editorContextKeys_1.EditorContextKeys.writable})}_modifyText(text,wordSeparators){const titleBoundary=TitleCaseAction.titleBoundary.get();return titleBoundary?text.toLocaleLowerCase().replace(titleBoundary,(b=>b.toLocaleUpperCase())):text}}exports.TitleCaseAction=TitleCaseAction,TitleCaseAction.titleBoundary=new BackwardsCompatibleRegExp("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class SnakeCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToSnakecase",label:nls.localize(26,null),alias:"Transform to Snake Case",precondition:editorContextKeys_1.EditorContextKeys.writable})}_modifyText(text,wordSeparators){const caseBoundary=SnakeCaseAction.caseBoundary.get(),singleLetters=SnakeCaseAction.singleLetters.get();return caseBoundary&&singleLetters?text.replace(caseBoundary,"$1_$2").replace(singleLetters,"$1_$2$3").toLocaleLowerCase():text}}exports.SnakeCaseAction=SnakeCaseAction,SnakeCaseAction.caseBoundary=new BackwardsCompatibleRegExp("(\\p{Ll})(\\p{Lu})","gmu"),SnakeCaseAction.singleLetters=new BackwardsCompatibleRegExp("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu"),(0,editorExtensions_1.registerEditorAction)(class CopyLinesUpAction extends AbstractCopyLinesAction{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:nls.localize(0,null),alias:"Copy Line Up",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"2_line",title:nls.localize(1,null),order:1}})}}),(0,editorExtensions_1.registerEditorAction)(class CopyLinesDownAction extends AbstractCopyLinesAction{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:nls.localize(2,null),alias:"Copy Line Down",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"2_line",title:nls.localize(3,null),order:2}})}}),(0,editorExtensions_1.registerEditorAction)(DuplicateSelectionAction),(0,editorExtensions_1.registerEditorAction)(class MoveLinesUpAction extends AbstractMoveLinesAction{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:nls.localize(6,null),alias:"Move Line Up",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"2_line",title:nls.localize(7,null),order:3}})}}),(0,editorExtensions_1.registerEditorAction)(class MoveLinesDownAction extends AbstractMoveLinesAction{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:nls.localize(8,null),alias:"Move Line Down",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"2_line",title:nls.localize(9,null),order:4}})}}),(0,editorExtensions_1.registerEditorAction)(SortLinesAscendingAction),(0,editorExtensions_1.registerEditorAction)(SortLinesDescendingAction),(0,editorExtensions_1.registerEditorAction)(DeleteDuplicateLinesAction),(0,editorExtensions_1.registerEditorAction)(TrimTrailingWhitespaceAction),(0,editorExtensions_1.registerEditorAction)(DeleteLinesAction),(0,editorExtensions_1.registerEditorAction)(IndentLinesAction),(0,editorExtensions_1.registerEditorAction)(OutdentLinesAction),(0,editorExtensions_1.registerEditorAction)(InsertLineBeforeAction),(0,editorExtensions_1.registerEditorAction)(InsertLineAfterAction),(0,editorExtensions_1.registerEditorAction)(DeleteAllLeftAction),(0,editorExtensions_1.registerEditorAction)(DeleteAllRightAction),(0,editorExtensions_1.registerEditorAction)(JoinLinesAction),(0,editorExtensions_1.registerEditorAction)(TransposeAction),(0,editorExtensions_1.registerEditorAction)(UpperCaseAction),(0,editorExtensions_1.registerEditorAction)(LowerCaseAction),SnakeCaseAction.caseBoundary.isSupported()&&SnakeCaseAction.singleLetters.isSupported()&&(0,editorExtensions_1.registerEditorAction)(SnakeCaseAction),TitleCaseAction.titleBoundary.isSupported()&&(0,editorExtensions_1.registerEditorAction)(TitleCaseAction)})),define(__m[160],__M([1,0,46,10,2,15,3,564,17,384]),(function(require,exports,aria_1,async_1,lifecycle_1,editorExtensions_1,range_1,nls,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageController=void 0;let MessageController=class MessageController{constructor(editor,contextKeyService){this._messageWidget=new lifecycle_1.MutableDisposable,this._messageListeners=new lifecycle_1.DisposableStore,this._editor=editor,this._visible=MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService),this._editorListener=this._editor.onDidAttemptReadOnlyEdit((()=>this._onDidAttemptReadOnlyEdit()))}static get(editor){return editor.getContribution(MessageController.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(message,position){let bounds;(0,aria_1.alert)(message),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new MessageWidget(this._editor,position,message),this._messageListeners.add(this._editor.onDidBlurEditorText((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(new async_1.TimeoutTimer((()=>this.closeMessage()),3e3)),this._messageListeners.add(this._editor.onMouseMove((e=>{e.target.position&&(bounds?bounds.containsPosition(e.target.position)||this.closeMessage():bounds=new range_1.Range(position.lineNumber-3,1,e.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(nls.localize(1,null),this._editor.getPosition())}};MessageController.ID="editor.contrib.messageController",MessageController.MESSAGE_VISIBLE=new contextkey_1.RawContextKey("messageVisible",!1,nls.localize(0,null)),MessageController=__decorate([__param(1,contextkey_1.IContextKeyService)],MessageController),exports.MessageController=MessageController;const MessageCommand=editorExtensions_1.EditorCommand.bindToContribution(MessageController.get);(0,editorExtensions_1.registerEditorCommand)(new MessageCommand({id:"leaveEditorMessage",precondition:MessageController.MESSAGE_VISIBLE,handler:c=>c.closeMessage(),kbOpts:{weight:130,primary:9}}));class MessageWidget{constructor(editor,{lineNumber,column},text){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=editor,this._editor.revealLinesInCenterIfOutsideViewport(lineNumber,lineNumber,0),this._position={lineNumber,column:column-1},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage");const anchorTop=document.createElement("div");anchorTop.classList.add("anchor","top"),this._domNode.appendChild(anchorTop);const message=document.createElement("div");message.classList.add("message"),message.textContent=text,this._domNode.appendChild(message);const anchorBottom=document.createElement("div");anchorBottom.classList.add("anchor","below"),this._domNode.appendChild(anchorBottom),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(messageWidget){let handle;const dispose=()=>{messageWidget.dispose(),clearTimeout(handle),messageWidget.getDomNode().removeEventListener("animationend",dispose)};return handle=setTimeout(dispose,110),messageWidget.getDomNode().addEventListener("animationend",dispose),messageWidget.getDomNode().classList.add("fadeOut"),{dispose}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(position){this._domNode.classList.toggle("below",2===position)}}(0,editorExtensions_1.registerEditorContribution)(MessageController.ID,MessageController)}));__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(receiver,state,value,kind,f){if("m"===kind)throw new TypeError("Private method is not writable");if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===kind?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value},__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver)};define(__m[687],__M([1,0,13,137,2,160,9,679,660]),(function(require,exports,errors_1,lazy_1,lifecycle_1,messageController_1,instantiation_1,codeActionMenu_1,lightBulbWidget_1){"use strict";var _CodeActionUi_disposed;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeActionUi=void 0;let CodeActionUi=class CodeActionUi extends lifecycle_1.Disposable{constructor(_editor,quickFixActionId,preferredFixActionId,delegate,instantiationService){super(),this._editor=_editor,this.delegate=delegate,this._activeCodeActions=this._register(new lifecycle_1.MutableDisposable),_CodeActionUi_disposed.set(this,!1),this._codeActionWidget=new lazy_1.Lazy((()=>this._register(instantiationService.createInstance(codeActionMenu_1.CodeActionMenu,this._editor,{onSelectCodeAction:action=>__awaiter(this,void 0,void 0,(function*(){this.delegate.applyCodeAction(action,!0)}))})))),this._lightBulbWidget=new lazy_1.Lazy((()=>{const widget=this._register(instantiationService.createInstance(lightBulbWidget_1.LightBulbWidget,this._editor,quickFixActionId,preferredFixActionId));return this._register(widget.onClick((e=>this.showCodeActionList(e.trigger,e.actions,e,{includeDisabledActions:!1})))),widget}))}dispose(){__classPrivateFieldSet(this,_CodeActionUi_disposed,!0,"f"),super.dispose()}update(newState){var _a,_b,_c,_d,_e;return __awaiter(this,void 0,void 0,(function*(){if(1!==newState.type)return void(null===(_a=this._lightBulbWidget.rawValue)||void 0===_a||_a.hide());let actions;try{actions=yield newState.actions}catch(e){return void(0,errors_1.onUnexpectedError)(e)}if(!__classPrivateFieldGet(this,_CodeActionUi_disposed,"f"))if(this._lightBulbWidget.getValue().update(actions,newState.trigger,newState.position),1===newState.trigger.type){if(null===(_b=newState.trigger.filter)||void 0===_b?void 0:_b.include){const validActionToApply=this.tryGetValidActionToApply(newState.trigger,actions);if(validActionToApply){try{this._lightBulbWidget.getValue().hide(),yield this.delegate.applyCodeAction(validActionToApply,!1)}finally{actions.dispose()}return}if(newState.trigger.context){const invalidAction=this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger,actions);if(invalidAction&&invalidAction.action.disabled)return null===(_c=messageController_1.MessageController.get(this._editor))||void 0===_c||_c.showMessage(invalidAction.action.disabled,newState.trigger.context.position),void actions.dispose()}}const includeDisabledActions=!!(null===(_d=newState.trigger.filter)||void 0===_d?void 0:_d.include);if(newState.trigger.context&&(!actions.allActions.length||!includeDisabledActions&&!actions.validActions.length))return null===(_e=messageController_1.MessageController.get(this._editor))||void 0===_e||_e.showMessage(newState.trigger.context.notAvailableMessage,newState.trigger.context.position),this._activeCodeActions.value=actions,void actions.dispose();this._activeCodeActions.value=actions,this._codeActionWidget.getValue().show(newState.trigger,actions,newState.position,{includeDisabledActions})}else this._codeActionWidget.getValue().isVisible?actions.dispose():this._activeCodeActions.value=actions}))}getInvalidActionThatWouldHaveBeenApplied(trigger,actions){if(actions.allActions.length)return"first"===trigger.autoApply&&0===actions.validActions.length||"ifSingle"===trigger.autoApply&&1===actions.allActions.length?actions.allActions.find((({action})=>action.disabled)):void 0}tryGetValidActionToApply(trigger,actions){if(actions.validActions.length)return"first"===trigger.autoApply&&actions.validActions.length>0||"ifSingle"===trigger.autoApply&&1===actions.validActions.length?actions.validActions[0]:void 0}showCodeActionList(trigger,actions,at,options){return __awaiter(this,void 0,void 0,(function*(){this._codeActionWidget.getValue().show(trigger,actions,at,options)}))}};_CodeActionUi_disposed=new WeakMap,CodeActionUi=__decorate([__param(4,instantiation_1.IInstantiationService)],CodeActionUi),exports.CodeActionUi=CodeActionUi})),define(__m[294],__M([1,0,21,137,2,8,15,200,24,20,159,687,160,528,26,17,9,79,39,73,90,680,155]),(function(require,exports,cancellation_1,lazy_1,lifecycle_1,strings_1,editorExtensions_1,bulkEditService_1,editorContextKeys_1,languageFeatures_1,codeAction_1,codeActionUi_1,messageController_1,nls,commands_1,contextkey_1,instantiation_1,markers_1,notification_1,progress_1,telemetry_1,codeActionModel_1,types_1){"use strict";function contextKeyForSupportedActions(kind){return contextkey_1.ContextKeyExpr.regex(codeActionModel_1.SUPPORTED_CODE_ACTIONS.keys()[0],new RegExp("(\\s|^)"+(0,strings_1.escapeRegExpCharacters)(kind.value)+"\\b"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AutoFixAction=exports.FixAllAction=exports.OrganizeImportsAction=exports.SourceAction=exports.RefactorAction=exports.CodeActionCommand=exports.QuickFixAction=exports.applyCodeAction=exports.QuickFixController=void 0;const argsSchema={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:nls.localize(0,null)},apply:{type:"string",description:nls.localize(1,null),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[nls.localize(2,null),nls.localize(3,null),nls.localize(4,null)]},preferred:{type:"boolean",default:!1,description:nls.localize(5,null)}}};let QuickFixController=class QuickFixController extends lifecycle_1.Disposable{constructor(editor,markerService,contextKeyService,progressService,_instantiationService,languageFeaturesService){super(),this._instantiationService=_instantiationService,this._editor=editor,this._model=this._register(new codeActionModel_1.CodeActionModel(this._editor,languageFeaturesService.codeActionProvider,markerService,contextKeyService,progressService)),this._register(this._model.onDidChangeState((newState=>this.update(newState)))),this._ui=new lazy_1.Lazy((()=>this._register(new codeActionUi_1.CodeActionUi(editor,QuickFixAction.Id,AutoFixAction.Id,{applyCodeAction:(action,retrigger)=>__awaiter(this,void 0,void 0,(function*(){try{yield this._applyCodeAction(action)}finally{retrigger&&this._trigger({type:2,filter:{}})}}))},this._instantiationService))))}static get(editor){return editor.getContribution(QuickFixController.ID)}update(newState){this._ui.getValue().update(newState)}showCodeActions(trigger,actions,at){return this._ui.getValue().showCodeActionList(trigger,actions,at,{includeDisabledActions:!1})}manualTriggerAtCurrentPosition(notAvailableMessage,filter,autoApply){var _a;if(!this._editor.hasModel())return;null===(_a=messageController_1.MessageController.get(this._editor))||void 0===_a||_a.closeMessage();const triggerPosition=this._editor.getPosition();this._trigger({type:1,filter,autoApply,context:{notAvailableMessage,position:triggerPosition}})}_trigger(trigger){return this._model.trigger(trigger)}_applyCodeAction(action){return this._instantiationService.invokeFunction(applyCodeAction,action,this._editor)}};function applyCodeAction(accessor,item,editor){return __awaiter(this,void 0,void 0,(function*(){const bulkEditService=accessor.get(bulkEditService_1.IBulkEditService),commandService=accessor.get(commands_1.ICommandService),telemetryService=accessor.get(telemetry_1.ITelemetryService),notificationService=accessor.get(notification_1.INotificationService);if(telemetryService.publicLog2("codeAction.applyCodeAction",{codeActionTitle:item.action.title,codeActionKind:item.action.kind,codeActionIsPreferred:!!item.action.isPreferred}),yield item.resolve(cancellation_1.CancellationToken.None),item.action.edit&&(yield bulkEditService.apply(bulkEditService_1.ResourceEdit.convert(item.action.edit),{editor,label:item.action.title})),item.action.command)try{yield commandService.executeCommand(item.action.command.id,...item.action.command.arguments||[])}catch(err){const message=function asMessage(err){return"string"==typeof err?err:err instanceof Error&&"string"==typeof err.message?err.message:void 0}(err);notificationService.error("string"==typeof message?message:nls.localize(6,null))}}))}function triggerCodeActionsForEditorSelection(editor,notAvailableMessage,filter,autoApply){if(editor.hasModel()){const controller=QuickFixController.get(editor);controller&&controller.manualTriggerAtCurrentPosition(notAvailableMessage,filter,autoApply)}}QuickFixController.ID="editor.contrib.quickFixController",QuickFixController=__decorate([__param(1,markers_1.IMarkerService),__param(2,contextkey_1.IContextKeyService),__param(3,progress_1.IEditorProgressService),__param(4,instantiation_1.IInstantiationService),__param(5,languageFeatures_1.ILanguageFeaturesService)],QuickFixController),exports.QuickFixController=QuickFixController,exports.applyCodeAction=applyCodeAction;class QuickFixAction extends editorExtensions_1.EditorAction{constructor(){super({id:QuickFixAction.Id,label:nls.localize(7,null),alias:"Quick Fix...",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2132,weight:100}})}run(_accessor,editor){return triggerCodeActionsForEditorSelection(editor,nls.localize(8,null),void 0,void 0)}}exports.QuickFixAction=QuickFixAction,QuickFixAction.Id="editor.action.quickFix";class CodeActionCommand extends editorExtensions_1.EditorCommand{constructor(){super({id:codeAction_1.codeActionCommandId,precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider),description:{description:"Trigger a code action",args:[{name:"args",schema:argsSchema}]}})}runEditorCommand(_accessor,editor,userArgs){const args=types_1.CodeActionCommandArgs.fromUser(userArgs,{kind:types_1.CodeActionKind.Empty,apply:"ifSingle"});return triggerCodeActionsForEditorSelection(editor,"string"==typeof(null==userArgs?void 0:userArgs.kind)?args.preferred?nls.localize(9,null,userArgs.kind):nls.localize(10,null,userArgs.kind):args.preferred?nls.localize(11,null):nls.localize(12,null),{include:args.kind,includeSourceActions:!0,onlyIncludePreferredActions:args.preferred},args.apply)}}exports.CodeActionCommand=CodeActionCommand;class RefactorAction extends editorExtensions_1.EditorAction{constructor(){super({id:codeAction_1.refactorCommandId,label:nls.localize(13,null),alias:"Refactor...",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,contextKeyForSupportedActions(types_1.CodeActionKind.Refactor))},description:{description:"Refactor...",args:[{name:"args",schema:argsSchema}]}})}run(_accessor,editor,userArgs){const args=types_1.CodeActionCommandArgs.fromUser(userArgs,{kind:types_1.CodeActionKind.Refactor,apply:"never"});return triggerCodeActionsForEditorSelection(editor,"string"==typeof(null==userArgs?void 0:userArgs.kind)?args.preferred?nls.localize(14,null,userArgs.kind):nls.localize(15,null,userArgs.kind):args.preferred?nls.localize(16,null):nls.localize(17,null),{include:types_1.CodeActionKind.Refactor.contains(args.kind)?args.kind:types_1.CodeActionKind.None,onlyIncludePreferredActions:args.preferred},args.apply)}}exports.RefactorAction=RefactorAction;class SourceAction extends editorExtensions_1.EditorAction{constructor(){super({id:codeAction_1.sourceActionCommandId,label:nls.localize(18,null),alias:"Source Action...",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,contextKeyForSupportedActions(types_1.CodeActionKind.Source))},description:{description:"Source Action...",args:[{name:"args",schema:argsSchema}]}})}run(_accessor,editor,userArgs){const args=types_1.CodeActionCommandArgs.fromUser(userArgs,{kind:types_1.CodeActionKind.Source,apply:"never"});return triggerCodeActionsForEditorSelection(editor,"string"==typeof(null==userArgs?void 0:userArgs.kind)?args.preferred?nls.localize(19,null,userArgs.kind):nls.localize(20,null,userArgs.kind):args.preferred?nls.localize(21,null):nls.localize(22,null),{include:types_1.CodeActionKind.Source.contains(args.kind)?args.kind:types_1.CodeActionKind.None,includeSourceActions:!0,onlyIncludePreferredActions:args.preferred},args.apply)}}exports.SourceAction=SourceAction;class OrganizeImportsAction extends editorExtensions_1.EditorAction{constructor(){super({id:codeAction_1.organizeImportsCommandId,label:nls.localize(23,null),alias:"Organize Imports",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,contextKeyForSupportedActions(types_1.CodeActionKind.SourceOrganizeImports)),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1581,weight:100}})}run(_accessor,editor){return triggerCodeActionsForEditorSelection(editor,nls.localize(24,null),{include:types_1.CodeActionKind.SourceOrganizeImports,includeSourceActions:!0},"ifSingle")}}exports.OrganizeImportsAction=OrganizeImportsAction;class FixAllAction extends editorExtensions_1.EditorAction{constructor(){super({id:codeAction_1.fixAllCommandId,label:nls.localize(25,null),alias:"Fix All",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,contextKeyForSupportedActions(types_1.CodeActionKind.SourceFixAll))})}run(_accessor,editor){return triggerCodeActionsForEditorSelection(editor,nls.localize(26,null),{include:types_1.CodeActionKind.SourceFixAll,includeSourceActions:!0},"ifSingle")}}exports.FixAllAction=FixAllAction;class AutoFixAction extends editorExtensions_1.EditorAction{constructor(){super({id:AutoFixAction.Id,label:nls.localize(27,null),alias:"Auto Fix...",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,contextKeyForSupportedActions(types_1.CodeActionKind.QuickFix)),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1620,mac:{primary:2644},weight:100}})}run(_accessor,editor){return triggerCodeActionsForEditorSelection(editor,nls.localize(28,null),{include:types_1.CodeActionKind.QuickFix,onlyIncludePreferredActions:!0},"ifSingle")}}exports.AutoFixAction=AutoFixAction,AutoFixAction.Id="editor.action.autoFix"})),define(__m[688],__M([1,0,15,294]),(function(require,exports,editorExtensions_1,codeActionCommands_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(0,editorExtensions_1.registerEditorContribution)(codeActionCommands_1.QuickFixController.ID,codeActionCommands_1.QuickFixController),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.QuickFixAction),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.RefactorAction),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.SourceAction),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.OrganizeImportsAction),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.AutoFixAction),(0,editorExtensions_1.registerEditorAction)(codeActionCommands_1.FixAllAction),(0,editorExtensions_1.registerEditorCommand)(new codeActionCommands_1.CodeActionCommand)})),define(__m[689],__M([1,0,46,10,21,13,2,19,25,108,15,200,29,11,3,24,156,160,571,105,17,9,66,39,73,36,666,20]),(function(require,exports,aria_1,async_1,cancellation_1,errors_1,lifecycle_1,types_1,uri_1,editorState_1,editorExtensions_1,bulkEditService_1,codeEditorService_1,position_1,range_1,editorContextKeys_1,textResourceConfiguration_1,messageController_1,nls,configurationRegistry_1,contextkey_1,instantiation_1,log_1,notification_1,progress_1,platform_1,renameInputField_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenameAction=exports.rename=void 0;class RenameSkeleton{constructor(model,position,registry){this.model=model,this.position=position,this._providerRenameIdx=0,this._providers=registry.ordered(model)}hasProvider(){return this._providers.length>0}resolveRenameLocation(token){return __awaiter(this,void 0,void 0,(function*(){const rejects=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const provider=this._providers[this._providerRenameIdx];if(!provider.resolveRenameLocation)break;let res=yield provider.resolveRenameLocation(this.model,this.position,token);if(res){if(!res.rejectReason)return res;rejects.push(res.rejectReason)}}const word=this.model.getWordAtPosition(this.position);return word?{range:new range_1.Range(this.position.lineNumber,word.startColumn,this.position.lineNumber,word.endColumn),text:word.word,rejectReason:rejects.length>0?rejects.join("\n"):void 0}:{range:range_1.Range.fromPositions(this.position),text:"",rejectReason:rejects.length>0?rejects.join("\n"):void 0}}))}provideRenameEdits(newName,token){return __awaiter(this,void 0,void 0,(function*(){return this._provideRenameEdits(newName,this._providerRenameIdx,[],token)}))}_provideRenameEdits(newName,i,rejects,token){return __awaiter(this,void 0,void 0,(function*(){const provider=this._providers[i];if(!provider)return{edits:[],rejectReason:rejects.join("\n")};const result=yield provider.provideRenameEdits(this.model,this.position,newName,token);return result?result.rejectReason?this._provideRenameEdits(newName,i+1,rejects.concat(result.rejectReason),token):result:this._provideRenameEdits(newName,i+1,rejects.concat(nls.localize(0,null)),token)}))}}function rename(registry,model,position,newName){return __awaiter(this,void 0,void 0,(function*(){const skeleton=new RenameSkeleton(model,position,registry),loc=yield skeleton.resolveRenameLocation(cancellation_1.CancellationToken.None);return(null==loc?void 0:loc.rejectReason)?{edits:[],rejectReason:loc.rejectReason}:skeleton.provideRenameEdits(newName,cancellation_1.CancellationToken.None)}))}exports.rename=rename;let RenameController=class RenameController{constructor(editor,_instaService,_notificationService,_bulkEditService,_progressService,_logService,_configService,_languageFeaturesService){this.editor=editor,this._instaService=_instaService,this._notificationService=_notificationService,this._bulkEditService=_bulkEditService,this._progressService=_progressService,this._logService=_logService,this._configService=_configService,this._languageFeaturesService=_languageFeaturesService,this._dispoableStore=new lifecycle_1.DisposableStore,this._cts=new cancellation_1.CancellationTokenSource,this._renameInputField=this._dispoableStore.add(new async_1.IdleValue((()=>this._dispoableStore.add(this._instaService.createInstance(renameInputField_1.RenameInputField,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"])))))}static get(editor){return editor.getContribution(RenameController.ID)}dispose(){this._dispoableStore.dispose(),this._cts.dispose(!0)}run(){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){if(this._cts.dispose(!0),!this.editor.hasModel())return;const position=this.editor.getPosition(),skeleton=new RenameSkeleton(this.editor.getModel(),position,this._languageFeaturesService.renameProvider);if(!skeleton.hasProvider())return;let loc;this._cts=new editorState_1.EditorStateCancellationTokenSource(this.editor,5);try{const resolveLocationOperation=skeleton.resolveRenameLocation(this._cts.token);this._progressService.showWhile(resolveLocationOperation,250),loc=yield resolveLocationOperation}catch(e){return void(null===(_a=messageController_1.MessageController.get(this.editor))||void 0===_a||_a.showMessage(e||nls.localize(1,null),position))}if(!loc)return;if(loc.rejectReason)return void(null===(_b=messageController_1.MessageController.get(this.editor))||void 0===_b||_b.showMessage(loc.rejectReason,position));if(this._cts.token.isCancellationRequested)return;this._cts.dispose(),this._cts=new editorState_1.EditorStateCancellationTokenSource(this.editor,5,loc.range);let selection=this.editor.getSelection(),selectionStart=0,selectionEnd=loc.text.length;range_1.Range.isEmpty(selection)||range_1.Range.spansMultipleLines(selection)||!range_1.Range.containsRange(loc.range,selection)||(selectionStart=Math.max(0,selection.startColumn-loc.range.startColumn),selectionEnd=Math.min(loc.range.endColumn,selection.endColumn)-loc.range.startColumn);const supportPreview=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),inputFieldResult=yield this._renameInputField.value.getInput(loc.range,loc.text,selectionStart,selectionEnd,supportPreview,this._cts.token);if("boolean"==typeof inputFieldResult)return void(inputFieldResult&&this.editor.focus());this.editor.focus();const renameOperation=(0,async_1.raceCancellation)(skeleton.provideRenameEdits(inputFieldResult.newName,this._cts.token),this._cts.token).then((renameResult=>__awaiter(this,void 0,void 0,(function*(){renameResult&&this.editor.hasModel()&&(renameResult.rejectReason?this._notificationService.info(renameResult.rejectReason):(this.editor.setSelection(range_1.Range.fromPositions(this.editor.getSelection().getPosition())),this._bulkEditService.apply(bulkEditService_1.ResourceEdit.convert(renameResult),{editor:this.editor,showPreview:inputFieldResult.wantsPreview,label:nls.localize(2,null,null==loc?void 0:loc.text),quotableLabel:nls.localize(3,null,null==loc?void 0:loc.text)}).then((result=>{result.ariaSummary&&(0,aria_1.alert)(nls.localize(4,null,loc.text,inputFieldResult.newName,result.ariaSummary))})).catch((err=>{this._notificationService.error(nls.localize(5,null)),this._logService.error(err)}))))}))),(err=>{this._notificationService.error(nls.localize(6,null)),this._logService.error(err)}));return this._progressService.showWhile(renameOperation,250),renameOperation}))}acceptRenameInput(wantsPreview){this._renameInputField.value.acceptInput(wantsPreview)}cancelRenameInput(){this._renameInputField.value.cancelInput(!0)}};RenameController.ID="editor.contrib.renameController",RenameController=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,notification_1.INotificationService),__param(3,bulkEditService_1.IBulkEditService),__param(4,progress_1.IEditorProgressService),__param(5,log_1.ILogService),__param(6,textResourceConfiguration_1.ITextResourceConfigurationService),__param(7,languageFeatures_1.ILanguageFeaturesService)],RenameController);class RenameAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.rename",label:nls.localize(7,null),alias:"Rename Symbol",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(accessor,args){const editorService=accessor.get(codeEditorService_1.ICodeEditorService),[uri,pos]=Array.isArray(args)&&args||[void 0,void 0];return uri_1.URI.isUri(uri)&&position_1.Position.isIPosition(pos)?editorService.openCodeEditor({resource:uri},editorService.getActiveCodeEditor()).then((editor=>{editor&&(editor.setPosition(pos),editor.invokeWithinContext((accessor=>(this.reportTelemetry(accessor,editor),this.run(accessor,editor)))))}),errors_1.onUnexpectedError):super.runCommand(accessor,args)}run(accessor,editor){const controller=RenameController.get(editor);return controller?controller.run():Promise.resolve()}}exports.RenameAction=RenameAction,(0,editorExtensions_1.registerEditorContribution)(RenameController.ID,RenameController),(0,editorExtensions_1.registerEditorAction)(RenameAction);const RenameCommand=editorExtensions_1.EditorCommand.bindToContribution(RenameController.get);(0,editorExtensions_1.registerEditorCommand)(new RenameCommand({id:"acceptRenameInput",precondition:renameInputField_1.CONTEXT_RENAME_INPUT_VISIBLE,handler:x=>x.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:3}})),(0,editorExtensions_1.registerEditorCommand)(new RenameCommand({id:"acceptRenameInputWithPreview",precondition:contextkey_1.ContextKeyExpr.and(renameInputField_1.CONTEXT_RENAME_INPUT_VISIBLE,contextkey_1.ContextKeyExpr.has("config.editor.rename.enablePreview")),handler:x=>x.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:1027}})),(0,editorExtensions_1.registerEditorCommand)(new RenameCommand({id:"cancelRenameInput",precondition:renameInputField_1.CONTEXT_RENAME_INPUT_VISIBLE,handler:x=>x.cancelRenameInput(),kbOpts:{weight:199,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:9,secondary:[1033]}})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeDocumentRenameProvider",(function(accessor,model,position,...args){const[newName]=args;(0,types_1.assertType)("string"==typeof newName);const{renameProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService);return rename(renameProvider,model,position,newName)})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executePrepareRename",(function(accessor,model,position){return __awaiter(this,void 0,void 0,(function*(){const{renameProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),skeleton=new RenameSkeleton(model,position,renameProvider),loc=yield skeleton.resolveRenameLocation(cancellation_1.CancellationToken.None);if(null==loc?void 0:loc.rejectReason)throw new Error(loc.rejectReason);return loc}))})),platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:nls.localize(8,null),default:!0,type:"boolean"}}})})),define(__m[690],__M([1,0,18,21,13,15,11,3,22,24,264,471,573,37,26,20,56,19,25]),(function(require,exports,arrays,cancellation_1,errors_1,editorExtensions_1,position_1,range_1,selection_1,editorContextKeys_1,bracketSelections_1,wordSelections_1,nls,actions_1,commands_1,languageFeatures_1,resolverService_1,types_1,uri_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.provideSelectionRanges=void 0;class SelectionRanges{constructor(index,ranges){this.index=index,this.ranges=ranges}mov(fwd){let index=this.index+(fwd?1:-1);if(index<0||index>=this.ranges.length)return this;const res=new SelectionRanges(index,this.ranges);return res.ranges[index].equalsRange(this.ranges[this.index])?res.mov(fwd):res}}let SmartSelectController=class SmartSelectController{constructor(_editor,_languageFeaturesService){this._editor=_editor,this._languageFeaturesService=_languageFeaturesService,this._ignoreSelection=!1}static get(editor){return editor.getContribution(SmartSelectController.ID)}dispose(){var _a;null===(_a=this._selectionListener)||void 0===_a||_a.dispose()}run(forward){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return;const selections=this._editor.getSelections(),model=this._editor.getModel();if(this._state||(yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider,model,selections.map((s=>s.getPosition())),this._editor.getOption(102),cancellation_1.CancellationToken.None).then((ranges=>{var _a;if(arrays.isNonEmptyArray(ranges)&&ranges.length===selections.length&&this._editor.hasModel()&&arrays.equals(this._editor.getSelections(),selections,((a,b)=>a.equalsSelection(b)))){for(let i=0;i<ranges.length;i++)ranges[i]=ranges[i].filter((range=>range.containsPosition(selections[i].getStartPosition())&&range.containsPosition(selections[i].getEndPosition()))),ranges[i].unshift(selections[i]);this._state=ranges.map((ranges=>new SelectionRanges(0,ranges))),null===(_a=this._selectionListener)||void 0===_a||_a.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition((()=>{var _a;this._ignoreSelection||(null===(_a=this._selectionListener)||void 0===_a||_a.dispose(),this._state=void 0)}))}}))),!this._state)return;this._state=this._state.map((state=>state.mov(forward)));const newSelections=this._state.map((state=>selection_1.Selection.fromPositions(state.ranges[state.index].getStartPosition(),state.ranges[state.index].getEndPosition())));this._ignoreSelection=!0;try{this._editor.setSelections(newSelections)}finally{this._ignoreSelection=!1}}))}};SmartSelectController.ID="editor.contrib.smartSelectController",SmartSelectController=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService)],SmartSelectController);class AbstractSmartSelect extends editorExtensions_1.EditorAction{constructor(forward,opts){super(opts),this._forward=forward}run(_accessor,editor){return __awaiter(this,void 0,void 0,(function*(){let controller=SmartSelectController.get(editor);controller&&(yield controller.run(this._forward))}))}}commands_1.CommandsRegistry.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");function provideSelectionRanges(registry,model,positions,options,token){return __awaiter(this,void 0,void 0,(function*(){const providers=registry.all(model).concat(new wordSelections_1.WordSelectionRangeProvider);1===providers.length&&providers.unshift(new bracketSelections_1.BracketSelectionRangeProvider);let work=[],allRawRanges=[];for(const provider of providers)work.push(Promise.resolve(provider.provideSelectionRanges(model,positions,token)).then((allProviderRanges=>{if(arrays.isNonEmptyArray(allProviderRanges)&&allProviderRanges.length===positions.length)for(let i=0;i<positions.length;i++){allRawRanges[i]||(allRawRanges[i]=[]);for(const oneProviderRanges of allProviderRanges[i])range_1.Range.isIRange(oneProviderRanges.range)&&range_1.Range.containsPosition(oneProviderRanges.range,positions[i])&&allRawRanges[i].push(range_1.Range.lift(oneProviderRanges.range))}}),errors_1.onUnexpectedExternalError));return yield Promise.all(work),allRawRanges.map((oneRawRanges=>{if(0===oneRawRanges.length)return[];oneRawRanges.sort(((a,b)=>position_1.Position.isBefore(a.getStartPosition(),b.getStartPosition())?1:position_1.Position.isBefore(b.getStartPosition(),a.getStartPosition())||position_1.Position.isBefore(a.getEndPosition(),b.getEndPosition())?-1:position_1.Position.isBefore(b.getEndPosition(),a.getEndPosition())?1:0));let last,oneRanges=[];for(const range of oneRawRanges)(!last||range_1.Range.containsRange(range,last)&&!range_1.Range.equalsRange(range,last))&&(oneRanges.push(range),last=range);if(!options.selectLeadingAndTrailingWhitespace)return oneRanges;let oneRangesWithTrivia=[oneRanges[0]];for(let i=1;i<oneRanges.length;i++){const prev=oneRanges[i-1],cur=oneRanges[i];if(cur.startLineNumber!==prev.startLineNumber||cur.endLineNumber!==prev.endLineNumber){const rangeNoWhitespace=new range_1.Range(prev.startLineNumber,model.getLineFirstNonWhitespaceColumn(prev.startLineNumber),prev.endLineNumber,model.getLineLastNonWhitespaceColumn(prev.endLineNumber));rangeNoWhitespace.containsRange(prev)&&!rangeNoWhitespace.equalsRange(prev)&&cur.containsRange(rangeNoWhitespace)&&!cur.equalsRange(rangeNoWhitespace)&&oneRangesWithTrivia.push(rangeNoWhitespace);const rangeFull=new range_1.Range(prev.startLineNumber,1,prev.endLineNumber,model.getLineMaxColumn(prev.endLineNumber));rangeFull.containsRange(prev)&&!rangeFull.equalsRange(rangeNoWhitespace)&&cur.containsRange(rangeFull)&&!cur.equalsRange(rangeFull)&&oneRangesWithTrivia.push(rangeFull)}oneRangesWithTrivia.push(cur)}return oneRangesWithTrivia}))}))}(0,editorExtensions_1.registerEditorContribution)(SmartSelectController.ID,SmartSelectController),(0,editorExtensions_1.registerEditorAction)(class GrowSelectionAction extends AbstractSmartSelect{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:nls.localize(0,null),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"1_basic",title:nls.localize(1,null),order:2}})}}),(0,editorExtensions_1.registerEditorAction)(class ShrinkSelectionAction extends AbstractSmartSelect{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:nls.localize(2,null),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"1_basic",title:nls.localize(3,null),order:3}})}}),exports.provideSelectionRanges=provideSelectionRanges,commands_1.CommandsRegistry.registerCommand("_executeSelectionRangeProvider",(function(accessor,...args){return __awaiter(this,void 0,void 0,(function*(){const[resource,positions]=args;(0,types_1.assertType)(uri_1.URI.isUri(resource));const registry=accessor.get(languageFeatures_1.ILanguageFeaturesService).selectionRangeProvider,reference=yield accessor.get(resolverService_1.ITextModelService).createModelReference(resource);try{return provideSelectionRanges(registry,reference.object.textEditorModel,positions,{selectLeadingAndTrailingWhitespace:!0},cancellation_1.CancellationToken.None)}finally{reference.dispose()}}))}))})),define(__m[109],__M([1,0,21,13,75,2,55,19,25,11,3,56,127,576,37,26,17,20,283]),(function(require,exports,cancellation_1,errors_1,filters_1,lifecycle_1,stopwatch_1,types_1,uri_1,position_1,range_1,resolverService_1,snippetParser_1,nls_1,actions_1,commands_1,contextkey_1,languageFeatures_1,contextScopedHistoryWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.showSimpleSuggestions=exports.getSuggestionComparator=exports.provideSuggestionItems=exports.CompletionItemModel=exports.getSnippetSuggestSupport=exports.CompletionOptions=exports.CompletionItem=exports.suggestWidgetStatusbarMenu=exports.Context=void 0,exports.Context={Visible:contextScopedHistoryWidget_1.historyNavigationVisible,DetailsVisible:new contextkey_1.RawContextKey("suggestWidgetDetailsVisible",!1,(0,nls_1.localize)(0,null)),MultipleSuggestions:new contextkey_1.RawContextKey("suggestWidgetMultipleSuggestions",!1,(0,nls_1.localize)(1,null)),MakesTextEdit:new contextkey_1.RawContextKey("suggestionMakesTextEdit",!0,(0,nls_1.localize)(2,null)),AcceptSuggestionsOnEnter:new contextkey_1.RawContextKey("acceptSuggestionOnEnter",!0,(0,nls_1.localize)(3,null)),HasInsertAndReplaceRange:new contextkey_1.RawContextKey("suggestionHasInsertAndReplaceRange",!1,(0,nls_1.localize)(4,null)),InsertMode:new contextkey_1.RawContextKey("suggestionInsertMode",void 0,{type:"string",description:(0,nls_1.localize)(5,null)}),CanResolve:new contextkey_1.RawContextKey("suggestionCanResolve",!1,(0,nls_1.localize)(6,null))},exports.suggestWidgetStatusbarMenu=new actions_1.MenuId("suggestWidgetStatusBar");class CompletionItem{constructor(position,completion,container,provider){this.position=position,this.completion=completion,this.container=container,this.provider=provider,this.isInvalid=!1,this.score=filters_1.FuzzyScore.Default,this.distance=0,this.textLabel="string"==typeof completion.label?completion.label:completion.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=completion.sortText&&completion.sortText.toLowerCase(),this.filterTextLow=completion.filterText&&completion.filterText.toLowerCase(),range_1.Range.isIRange(completion.range)?(this.editStart=new position_1.Position(completion.range.startLineNumber,completion.range.startColumn),this.editInsertEnd=new position_1.Position(completion.range.endLineNumber,completion.range.endColumn),this.editReplaceEnd=new position_1.Position(completion.range.endLineNumber,completion.range.endColumn),this.isInvalid=this.isInvalid||range_1.Range.spansMultipleLines(completion.range)||completion.range.startLineNumber!==position.lineNumber):(this.editStart=new position_1.Position(completion.range.insert.startLineNumber,completion.range.insert.startColumn),this.editInsertEnd=new position_1.Position(completion.range.insert.endLineNumber,completion.range.insert.endColumn),this.editReplaceEnd=new position_1.Position(completion.range.replace.endLineNumber,completion.range.replace.endColumn),this.isInvalid=this.isInvalid||range_1.Range.spansMultipleLines(completion.range.insert)||range_1.Range.spansMultipleLines(completion.range.replace)||completion.range.insert.startLineNumber!==position.lineNumber||completion.range.replace.startLineNumber!==position.lineNumber||completion.range.insert.startColumn!==completion.range.replace.startColumn),"function"!=typeof provider.resolveCompletionItem&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(token){return __awaiter(this,void 0,void 0,(function*(){if(!this._resolveCache){const sub=token.onCancellationRequested((()=>{this._resolveCache=void 0,this._isResolved=!1}));this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,token)).then((value=>{Object.assign(this.completion,value),this._isResolved=!0,sub.dispose()}),(err=>{(0,errors_1.isCancellationError)(err)&&(this._resolveCache=void 0,this._isResolved=!1)}))}return this._resolveCache}))}}exports.CompletionItem=CompletionItem;class CompletionOptions{constructor(snippetSortOrder=2,kindFilter=new Set,providerFilter=new Set,showDeprecated=!0){this.snippetSortOrder=snippetSortOrder,this.kindFilter=kindFilter,this.providerFilter=providerFilter,this.showDeprecated=showDeprecated}}exports.CompletionOptions=CompletionOptions,CompletionOptions.default=new CompletionOptions,exports.getSnippetSuggestSupport=function getSnippetSuggestSupport(){};class CompletionItemModel{constructor(items,needsClipboard,durations,disposable){this.items=items,this.needsClipboard=needsClipboard,this.durations=durations,this.disposable=disposable}}function provideSuggestionItems(registry,model,position,options=CompletionOptions.default,context={triggerKind:0},token=cancellation_1.CancellationToken.None){return __awaiter(this,void 0,void 0,(function*(){const sw=new stopwatch_1.StopWatch(!0);position=position.clone();const word=model.getWordAtPosition(position),defaultReplaceRange=word?new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,word.endColumn):range_1.Range.fromPositions(position),defaultRange={replace:defaultReplaceRange,insert:defaultReplaceRange.setEndPosition(position.lineNumber,position.column)},result=[],disposables=new lifecycle_1.DisposableStore,durations=[];let needsClipboard=!1;const onCompletionList=(provider,container,sw)=>{var _a,_b,_c;let didAddResult=!1;if(!container)return didAddResult;for(let suggestion of container.suggestions)if(!options.kindFilter.has(suggestion.kind)){if(!options.showDeprecated&&(null===(_a=null==suggestion?void 0:suggestion.tags)||void 0===_a?void 0:_a.includes(1)))continue;suggestion.range||(suggestion.range=defaultRange),suggestion.sortText||(suggestion.sortText="string"==typeof suggestion.label?suggestion.label:suggestion.label.label),!needsClipboard&&suggestion.insertTextRules&&4&suggestion.insertTextRules&&(needsClipboard=snippetParser_1.SnippetParser.guessNeedsClipboard(suggestion.insertText)),result.push(new CompletionItem(position,suggestion,container,provider)),didAddResult=!0}return(0,lifecycle_1.isDisposable)(container)&&disposables.add(container),durations.push({providerName:null!==(_b=provider._debugDisplayName)&&void 0!==_b?_b:"unknown_provider",elapsedProvider:null!==(_c=container.duration)&&void 0!==_c?_c:-1,elapsedOverall:sw.elapsed()}),didAddResult},snippetCompletions=(()=>__awaiter(this,void 0,void 0,(function*(){})))();for(let providerGroup of registry.orderedGroups(model)){let didAddResult=!1;if(yield Promise.all(providerGroup.map((provider=>__awaiter(this,void 0,void 0,(function*(){if(!(options.providerFilter.size>0)||options.providerFilter.has(provider))try{const sw=new stopwatch_1.StopWatch(!0),list=yield provider.provideCompletionItems(model,position,context,token);didAddResult=onCompletionList(provider,list,sw)||didAddResult}catch(err){(0,errors_1.onUnexpectedExternalError)(err)}}))))),didAddResult||token.isCancellationRequested)break}return yield snippetCompletions,token.isCancellationRequested?(disposables.dispose(),Promise.reject((0,errors_1.canceled)())):new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)),needsClipboard,{entries:durations,elapsed:sw.elapsed()},disposables)}))}function defaultComparator(a,b){if(a.sortTextLow&&b.sortTextLow){if(a.sortTextLow<b.sortTextLow)return-1;if(a.sortTextLow>b.sortTextLow)return 1}return a.completion.label<b.completion.label?-1:a.completion.label>b.completion.label?1:a.completion.kind-b.completion.kind}exports.CompletionItemModel=CompletionItemModel,exports.provideSuggestionItems=provideSuggestionItems;const _snippetComparators=new Map;function getSuggestionComparator(snippetConfig){return _snippetComparators.get(snippetConfig)}let _onlyOnceProvider;_snippetComparators.set(0,(function snippetUpComparator(a,b){if(a.completion.kind!==b.completion.kind){if(27===a.completion.kind)return-1;if(27===b.completion.kind)return 1}return defaultComparator(a,b)})),_snippetComparators.set(2,(function snippetDownComparator(a,b){if(a.completion.kind!==b.completion.kind){if(27===a.completion.kind)return 1;if(27===b.completion.kind)return-1}return defaultComparator(a,b)})),_snippetComparators.set(1,defaultComparator),exports.getSuggestionComparator=getSuggestionComparator,commands_1.CommandsRegistry.registerCommand("_executeCompletionItemProvider",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri,position,triggerCharacter,maxItemsToResolve]=args;(0,types_1.assertType)(uri_1.URI.isUri(uri)),(0,types_1.assertType)(position_1.Position.isIPosition(position)),(0,types_1.assertType)("string"==typeof triggerCharacter||!triggerCharacter),(0,types_1.assertType)("number"==typeof maxItemsToResolve||!maxItemsToResolve);const{completionProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),ref=yield accessor.get(resolverService_1.ITextModelService).createModelReference(uri);try{const result={incomplete:!1,suggestions:[]},resolving=[],completions=yield provideSuggestionItems(completionProvider,ref.object.textEditorModel,position_1.Position.lift(position),void 0,{triggerCharacter,triggerKind:triggerCharacter?1:0});for(const item of completions.items)resolving.length<(null!=maxItemsToResolve?maxItemsToResolve:0)&&resolving.push(item.resolve(cancellation_1.CancellationToken.None)),result.incomplete=result.incomplete||item.container.incomplete,result.suggestions.push(item.completion);try{return yield Promise.all(resolving),result}finally{setTimeout((()=>completions.disposable.dispose()),100)}}finally{ref.dispose()}}))));let _onlyOnceSuggestions=[];exports.showSimpleSuggestions=function showSimpleSuggestions(accessor,editor,suggestions){const{completionProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService);_onlyOnceProvider||(_onlyOnceProvider=new class{provideCompletionItems(){let result={suggestions:_onlyOnceSuggestions.slice(0)};return _onlyOnceSuggestions.length=0,result}},completionProvider.register("*",_onlyOnceProvider)),setTimeout((()=>{var _a;_onlyOnceSuggestions.push(...suggestions),null===(_a=editor.getContribution("editor.contrib.suggestController"))||void 0===_a||_a.triggerSuggest((new Set).add(_onlyOnceProvider))}),0)}})),define(__m[295],__M([1,0,46,234,15,583]),(function(require,exports,aria_1,tabFocus_1,editorExtensions_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ToggleTabFocusModeAction=void 0;class ToggleTabFocusModeAction extends editorExtensions_1.EditorAction{constructor(){super({id:ToggleTabFocusModeAction.ID,label:nls.localize(0,null),alias:"Toggle Tab Key Moves Focus",precondition:void 0,kbOpts:{kbExpr:null,primary:2091,mac:{primary:1323},weight:100}})}run(accessor,editor){const newValue=!tabFocus_1.TabFocus.getTabFocusMode();tabFocus_1.TabFocus.setTabFocusMode(newValue),newValue?(0,aria_1.alert)(nls.localize(1,null)):(0,aria_1.alert)(nls.localize(2,null))}}exports.ToggleTabFocusModeAction=ToggleTabFocusModeAction,ToggleTabFocusModeAction.ID="editor.action.toggleTabFocusMode",(0,editorExtensions_1.registerEditorAction)(ToggleTabFocusModeAction)})),define(__m[691],__M([1,0,55,15,584]),(function(require,exports,stopwatch_1,editorExtensions_1,nls){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class ForceRetokenizeAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.forceRetokenize",label:nls.localize(0,null),alias:"Developer: Force Retokenize",precondition:void 0})}run(accessor,editor){if(!editor.hasModel())return;const model=editor.getModel();model.resetTokenization();const sw=new stopwatch_1.StopWatch(!0);model.forceTokenization(model.getLineCount()),sw.stop(),console.log(`tokenization took ${sw.elapsed()}`)}}(0,editorExtensions_1.registerEditorAction)(ForceRetokenizeAction)})),define(__m[692],__M([1,0,2,42,15,29,586,130]),(function(require,exports,lifecycle_1,resources_1,editorExtensions_1,codeEditorService_1,nls,dialogs_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnusualLineTerminatorsDetector=void 0;let UnusualLineTerminatorsDetector=class UnusualLineTerminatorsDetector extends lifecycle_1.Disposable{constructor(_editor,_dialogService,_codeEditorService){super(),this._editor=_editor,this._dialogService=_dialogService,this._codeEditorService=_codeEditorService,this._config=this._editor.getOption(114),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(114)&&(this._config=this._editor.getOption(114),this._checkForUnusualLineTerminators())}))),this._register(this._editor.onDidChangeModel((()=>{this._checkForUnusualLineTerminators()}))),this._register(this._editor.onDidChangeModelContent((e=>{e.isUndoing||this._checkForUnusualLineTerminators()})))}_checkForUnusualLineTerminators(){return __awaiter(this,void 0,void 0,(function*(){if("off"===this._config)return;if(!this._editor.hasModel())return;const model=this._editor.getModel();if(!model.mightContainUnusualLineTerminators())return;const ignoreState=function readIgnoreState(codeEditorService,model){return codeEditorService.getModelProperty(model.uri,"ignoreUnusualLineTerminators")}(this._codeEditorService,model);if(!0===ignoreState)return;if(this._editor.getOption(81))return;if("auto"===this._config)return void model.removeUnusualLineTerminators(this._editor.getSelections());(yield this._dialogService.confirm({title:nls.localize(0,null),message:nls.localize(1,null),detail:nls.localize(2,null,(0,resources_1.basename)(model.uri)),primaryButton:nls.localize(3,null),secondaryButton:nls.localize(4,null)})).confirmed?model.removeUnusualLineTerminators(this._editor.getSelections()):function writeIgnoreState(codeEditorService,model,state){codeEditorService.setModelProperty(model.uri,"ignoreUnusualLineTerminators",state)}(this._codeEditorService,model,!0)}))}};UnusualLineTerminatorsDetector.ID="editor.contrib.unusualLineTerminatorsDetector",UnusualLineTerminatorsDetector=__decorate([__param(1,dialogs_1.IDialogService),__param(2,codeEditorService_1.ICodeEditorService)],UnusualLineTerminatorsDetector),exports.UnusualLineTerminatorsDetector=UnusualLineTerminatorsDetector,(0,editorExtensions_1.registerEditorContribution)(UnusualLineTerminatorsDetector.ID,UnusualLineTerminatorsDetector)})),define(__m[296],__M([1,0,15,100,32,61,151,120,11,3,22,24,33,588,65,17,278]),(function(require,exports,editorExtensions_1,replaceCommand_1,editorOptions_1,cursorCommon_1,cursorWordOperations_1,wordCharacterClassifier_1,position_1,range_1,selection_1,editorContextKeys_1,languageConfigurationRegistry_1,nls,accessibility_1,contextkey_1,contextkeys_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteInsideWord=exports.DeleteWordRight=exports.DeleteWordEndRight=exports.DeleteWordStartRight=exports.DeleteWordLeft=exports.DeleteWordEndLeft=exports.DeleteWordStartLeft=exports.DeleteWordRightCommand=exports.DeleteWordLeftCommand=exports.DeleteWordCommand=exports.CursorWordAccessibilityRightSelect=exports.CursorWordAccessibilityRight=exports.CursorWordRightSelect=exports.CursorWordEndRightSelect=exports.CursorWordStartRightSelect=exports.CursorWordRight=exports.CursorWordEndRight=exports.CursorWordStartRight=exports.CursorWordAccessibilityLeftSelect=exports.CursorWordAccessibilityLeft=exports.CursorWordLeftSelect=exports.CursorWordEndLeftSelect=exports.CursorWordStartLeftSelect=exports.CursorWordLeft=exports.CursorWordEndLeft=exports.CursorWordStartLeft=exports.WordRightCommand=exports.WordLeftCommand=exports.MoveWordCommand=void 0;class MoveWordCommand extends editorExtensions_1.EditorCommand{constructor(opts){super(opts),this._inSelectionMode=opts.inSelectionMode,this._wordNavigationType=opts.wordNavigationType}runEditorCommand(accessor,editor,args){if(!editor.hasModel())return;const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(editor.getOption(117)),model=editor.getModel(),result=editor.getSelections().map((sel=>{const inPosition=new position_1.Position(sel.positionLineNumber,sel.positionColumn),outPosition=this._move(wordSeparators,model,inPosition,this._wordNavigationType);return this._moveTo(sel,outPosition,this._inSelectionMode)}));if(model.pushStackElement(),editor._getViewModel().setCursorStates("moveWordCommand",3,result.map((r=>cursorCommon_1.CursorState.fromModelSelection(r)))),1===result.length){const pos=new position_1.Position(result[0].positionLineNumber,result[0].positionColumn);editor.revealPosition(pos,0)}}_moveTo(from,to,inSelectionMode){return inSelectionMode?new selection_1.Selection(from.selectionStartLineNumber,from.selectionStartColumn,to.lineNumber,to.column):new selection_1.Selection(to.lineNumber,to.column,to.lineNumber,to.column)}}exports.MoveWordCommand=MoveWordCommand;class WordLeftCommand extends MoveWordCommand{_move(wordSeparators,model,position,wordNavigationType){return cursorWordOperations_1.WordOperations.moveWordLeft(wordSeparators,model,position,wordNavigationType)}}exports.WordLeftCommand=WordLeftCommand;class WordRightCommand extends MoveWordCommand{_move(wordSeparators,model,position,wordNavigationType){return cursorWordOperations_1.WordOperations.moveWordRight(wordSeparators,model,position,wordNavigationType)}}exports.WordRightCommand=WordRightCommand;class CursorWordStartLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}exports.CursorWordStartLeft=CursorWordStartLeft;class CursorWordEndLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}exports.CursorWordEndLeft=CursorWordEndLeft;class CursorWordLeft extends WordLeftCommand{constructor(){var _a;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,null===(_a=contextkey_1.ContextKeyExpr.and(accessibility_1.CONTEXT_ACCESSIBILITY_MODE_ENABLED,contextkeys_1.IsWindowsContext))||void 0===_a?void 0:_a.negate()),primary:2063,mac:{primary:527},weight:100}})}}exports.CursorWordLeft=CursorWordLeft;class CursorWordStartLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}exports.CursorWordStartLeftSelect=CursorWordStartLeftSelect;class CursorWordEndLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}exports.CursorWordEndLeftSelect=CursorWordEndLeftSelect;class CursorWordLeftSelect extends WordLeftCommand{constructor(){var _a;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,null===(_a=contextkey_1.ContextKeyExpr.and(accessibility_1.CONTEXT_ACCESSIBILITY_MODE_ENABLED,contextkeys_1.IsWindowsContext))||void 0===_a?void 0:_a.negate()),primary:3087,mac:{primary:1551},weight:100}})}}exports.CursorWordLeftSelect=CursorWordLeftSelect;class CursorWordAccessibilityLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(_,model,position,wordNavigationType){return super._move((0,wordCharacterClassifier_1.getMapForWordSeparators)(editorOptions_1.EditorOptions.wordSeparators.defaultValue),model,position,wordNavigationType)}}exports.CursorWordAccessibilityLeft=CursorWordAccessibilityLeft;class CursorWordAccessibilityLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(_,model,position,wordNavigationType){return super._move((0,wordCharacterClassifier_1.getMapForWordSeparators)(editorOptions_1.EditorOptions.wordSeparators.defaultValue),model,position,wordNavigationType)}}exports.CursorWordAccessibilityLeftSelect=CursorWordAccessibilityLeftSelect;class CursorWordStartRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}exports.CursorWordStartRight=CursorWordStartRight;class CursorWordEndRight extends WordRightCommand{constructor(){var _a;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,null===(_a=contextkey_1.ContextKeyExpr.and(accessibility_1.CONTEXT_ACCESSIBILITY_MODE_ENABLED,contextkeys_1.IsWindowsContext))||void 0===_a?void 0:_a.negate()),primary:2065,mac:{primary:529},weight:100}})}}exports.CursorWordEndRight=CursorWordEndRight;class CursorWordRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}exports.CursorWordRight=CursorWordRight;class CursorWordStartRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}exports.CursorWordStartRightSelect=CursorWordStartRightSelect;class CursorWordEndRightSelect extends WordRightCommand{constructor(){var _a;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,null===(_a=contextkey_1.ContextKeyExpr.and(accessibility_1.CONTEXT_ACCESSIBILITY_MODE_ENABLED,contextkeys_1.IsWindowsContext))||void 0===_a?void 0:_a.negate()),primary:3089,mac:{primary:1553},weight:100}})}}exports.CursorWordEndRightSelect=CursorWordEndRightSelect;class CursorWordRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}exports.CursorWordRightSelect=CursorWordRightSelect;class CursorWordAccessibilityRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(_,model,position,wordNavigationType){return super._move((0,wordCharacterClassifier_1.getMapForWordSeparators)(editorOptions_1.EditorOptions.wordSeparators.defaultValue),model,position,wordNavigationType)}}exports.CursorWordAccessibilityRight=CursorWordAccessibilityRight;class CursorWordAccessibilityRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(_,model,position,wordNavigationType){return super._move((0,wordCharacterClassifier_1.getMapForWordSeparators)(editorOptions_1.EditorOptions.wordSeparators.defaultValue),model,position,wordNavigationType)}}exports.CursorWordAccessibilityRightSelect=CursorWordAccessibilityRightSelect;class DeleteWordCommand extends editorExtensions_1.EditorCommand{constructor(opts){super(opts),this._whitespaceHeuristics=opts.whitespaceHeuristics,this._wordNavigationType=opts.wordNavigationType}runEditorCommand(accessor,editor,args){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService);if(!editor.hasModel())return;const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(editor.getOption(117)),model=editor.getModel(),selections=editor.getSelections(),autoClosingBrackets=editor.getOption(5),autoClosingQuotes=editor.getOption(8),autoClosingPairs=languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getAutoClosingPairs(),viewModel=editor._getViewModel(),commands=selections.map((sel=>{const deleteRange=this._delete({wordSeparators,model,selection:sel,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:editor.getOption(6),autoClosingBrackets,autoClosingQuotes,autoClosingPairs,autoClosedCharacters:viewModel.getCursorAutoClosedCharacters()},this._wordNavigationType);return new replaceCommand_1.ReplaceCommand(deleteRange,"")}));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}exports.DeleteWordCommand=DeleteWordCommand;class DeleteWordLeftCommand extends DeleteWordCommand{_delete(ctx,wordNavigationType){let r=cursorWordOperations_1.WordOperations.deleteWordLeft(ctx,wordNavigationType);return r||new range_1.Range(1,1,1,1)}}exports.DeleteWordLeftCommand=DeleteWordLeftCommand;class DeleteWordRightCommand extends DeleteWordCommand{_delete(ctx,wordNavigationType){let r=cursorWordOperations_1.WordOperations.deleteWordRight(ctx,wordNavigationType);if(r)return r;const lineCount=ctx.model.getLineCount(),maxColumn=ctx.model.getLineMaxColumn(lineCount);return new range_1.Range(lineCount,maxColumn,lineCount,maxColumn)}}exports.DeleteWordRightCommand=DeleteWordRightCommand;class DeleteWordStartLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.DeleteWordStartLeft=DeleteWordStartLeft;class DeleteWordEndLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.DeleteWordEndLeft=DeleteWordEndLeft;class DeleteWordLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}exports.DeleteWordLeft=DeleteWordLeft;class DeleteWordStartRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.DeleteWordStartRight=DeleteWordStartRight;class DeleteWordEndRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:editorContextKeys_1.EditorContextKeys.writable})}}exports.DeleteWordEndRight=DeleteWordEndRight;class DeleteWordRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}exports.DeleteWordRight=DeleteWordRight;class DeleteInsideWord extends editorExtensions_1.EditorAction{constructor(){super({id:"deleteInsideWord",precondition:editorContextKeys_1.EditorContextKeys.writable,label:nls.localize(0,null),alias:"Delete Word"})}run(accessor,editor,args){if(!editor.hasModel())return;const wordSeparators=(0,wordCharacterClassifier_1.getMapForWordSeparators)(editor.getOption(117)),model=editor.getModel(),commands=editor.getSelections().map((sel=>{const deleteRange=cursorWordOperations_1.WordOperations.deleteInsideWord(wordSeparators,model,sel);return new replaceCommand_1.ReplaceCommand(deleteRange,"")}));editor.pushUndoStop(),editor.executeCommands(this.id,commands),editor.pushUndoStop()}}exports.DeleteInsideWord=DeleteInsideWord,(0,editorExtensions_1.registerEditorCommand)(new CursorWordStartLeft),(0,editorExtensions_1.registerEditorCommand)(new CursorWordEndLeft),(0,editorExtensions_1.registerEditorCommand)(new CursorWordLeft),(0,editorExtensions_1.registerEditorCommand)(new CursorWordStartLeftSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordEndLeftSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordLeftSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordStartRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordEndRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordStartRightSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordEndRightSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordRightSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordAccessibilityLeft),(0,editorExtensions_1.registerEditorCommand)(new CursorWordAccessibilityLeftSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordAccessibilityRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordAccessibilityRightSelect),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordStartLeft),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordEndLeft),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordLeft),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordStartRight),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordEndRight),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordRight),(0,editorExtensions_1.registerEditorAction)(DeleteInsideWord)})),define(__m[693],__M([1,0,15,151,3,24,296,26]),(function(require,exports,editorExtensions_1,cursorWordOperations_1,range_1,editorContextKeys_1,wordOperations_1,commands_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorWordPartRightSelect=exports.CursorWordPartRight=exports.WordPartRightCommand=exports.CursorWordPartLeftSelect=exports.CursorWordPartLeft=exports.WordPartLeftCommand=exports.DeleteWordPartRight=exports.DeleteWordPartLeft=void 0;class DeleteWordPartLeft extends wordOperations_1.DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(ctx,wordNavigationType){let r=cursorWordOperations_1.WordPartOperations.deleteWordPartLeft(ctx);return r||new range_1.Range(1,1,1,1)}}exports.DeleteWordPartLeft=DeleteWordPartLeft;class DeleteWordPartRight extends wordOperations_1.DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(ctx,wordNavigationType){let r=cursorWordOperations_1.WordPartOperations.deleteWordPartRight(ctx);if(r)return r;const lineCount=ctx.model.getLineCount(),maxColumn=ctx.model.getLineMaxColumn(lineCount);return new range_1.Range(lineCount,maxColumn,lineCount,maxColumn)}}exports.DeleteWordPartRight=DeleteWordPartRight;class WordPartLeftCommand extends wordOperations_1.MoveWordCommand{_move(wordSeparators,model,position,wordNavigationType){return cursorWordOperations_1.WordPartOperations.moveWordPartLeft(wordSeparators,model,position)}}exports.WordPartLeftCommand=WordPartLeftCommand;class CursorWordPartLeft extends WordPartLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}exports.CursorWordPartLeft=CursorWordPartLeft,commands_1.CommandsRegistry.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class CursorWordPartLeftSelect extends WordPartLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}exports.CursorWordPartLeftSelect=CursorWordPartLeftSelect,commands_1.CommandsRegistry.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class WordPartRightCommand extends wordOperations_1.MoveWordCommand{_move(wordSeparators,model,position,wordNavigationType){return cursorWordOperations_1.WordPartOperations.moveWordPartRight(wordSeparators,model,position)}}exports.WordPartRightCommand=WordPartRightCommand;class CursorWordPartRight extends WordPartRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}exports.CursorWordPartRight=CursorWordPartRight;class CursorWordPartRightSelect extends WordPartRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}exports.CursorWordPartRightSelect=CursorWordPartRightSelect,(0,editorExtensions_1.registerEditorCommand)(new DeleteWordPartLeft),(0,editorExtensions_1.registerEditorCommand)(new DeleteWordPartRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordPartLeft),(0,editorExtensions_1.registerEditorCommand)(new CursorWordPartLeftSelect),(0,editorExtensions_1.registerEditorCommand)(new CursorWordPartRight),(0,editorExtensions_1.registerEditorCommand)(new CursorWordPartRightSelect)})),define(__m[694],__M([1,0,7,31,171,46,62,2,16,8,25,15,24,295,17,9,43,53,23,14,72,393]),(function(require,exports,dom,fastDomNode_1,formattedTextRenderer_1,aria_1,widget_1,lifecycle_1,platform,strings,uri_1,editorExtensions_1,editorContextKeys_1,toggleTabFocusMode_1,contextkey_1,instantiation_1,keybinding_1,opener_1,colorRegistry_1,themeService_1,standaloneStrings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE=new contextkey_1.RawContextKey("accessibilityHelpWidgetVisible",!1);let AccessibilityHelpController=class AccessibilityHelpController extends lifecycle_1.Disposable{constructor(editor,instantiationService){super(),this._editor=editor,this._widget=this._register(instantiationService.createInstance(AccessibilityHelpWidget,this._editor))}static get(editor){return editor.getContribution(AccessibilityHelpController.ID)}show(){this._widget.show()}hide(){this._widget.hide()}};AccessibilityHelpController.ID="editor.contrib.accessibilityHelpController",AccessibilityHelpController=__decorate([__param(1,instantiation_1.IInstantiationService)],AccessibilityHelpController);let AccessibilityHelpWidget=class AccessibilityHelpWidget extends widget_1.Widget{constructor(editor,_contextKeyService,_keybindingService,_openerService){super(),this._contextKeyService=_contextKeyService,this._keybindingService=_keybindingService,this._openerService=_openerService,this._editor=editor,this._isVisibleKey=CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE.bindTo(this._contextKeyService),this._domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._domNode.setClassName("accessibilityHelpWidget"),this._domNode.setDisplay("none"),this._domNode.setAttribute("role","dialog"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._contentDomNode.setAttribute("role","document"),this._domNode.appendChild(this._contentDomNode),this._isVisible=!1,this._register(this._editor.onDidLayoutChange((()=>{this._isVisible&&this._layout()}))),this._register(dom.addStandardDisposableListener(this._contentDomNode.domNode,"keydown",(e=>{if(this._isVisible&&(e.equals(2083)&&((0,aria_1.alert)(standaloneStrings_1.AccessibilityHelpNLS.emergencyConfOn),this._editor.updateOptions({accessibilitySupport:"on"}),dom.clearNode(this._contentDomNode.domNode),this._buildContent(),this._contentDomNode.domNode.focus(),e.preventDefault(),e.stopPropagation()),e.equals(2086))){(0,aria_1.alert)(standaloneStrings_1.AccessibilityHelpNLS.openingDocs);let url=this._editor.getRawOptions().accessibilityHelpUrl;void 0===url&&(url="https://go.microsoft.com/fwlink/?linkid=852450"),this._openerService.open(uri_1.URI.parse(url)),e.preventDefault(),e.stopPropagation()}}))),this.onblur(this._contentDomNode.domNode,(()=>{this.hide()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return AccessibilityHelpWidget.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay("block"),this._domNode.setAttribute("aria-hidden","false"),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(commandId,msg,noKbMsg){const kb=this._keybindingService.lookupKeybinding(commandId);return kb?strings.format(msg,kb.getAriaLabel()):strings.format(noKbMsg,commandId)}_buildContent(){const options=this._editor.getOptions(),selections=this._editor.getSelections();let charactersSelected=0;if(selections){const model=this._editor.getModel();model&&selections.forEach((selection=>{charactersSelected+=model.getValueLengthInRange(selection)}))}let text=function getSelectionLabel(selections,charactersSelected){return selections&&0!==selections.length?1===selections.length?charactersSelected?strings.format(standaloneStrings_1.AccessibilityHelpNLS.singleSelectionRange,selections[0].positionLineNumber,selections[0].positionColumn,charactersSelected):strings.format(standaloneStrings_1.AccessibilityHelpNLS.singleSelection,selections[0].positionLineNumber,selections[0].positionColumn):charactersSelected?strings.format(standaloneStrings_1.AccessibilityHelpNLS.multiSelectionRange,selections.length,charactersSelected):selections.length>0?strings.format(standaloneStrings_1.AccessibilityHelpNLS.multiSelection,selections.length):"":standaloneStrings_1.AccessibilityHelpNLS.noSelection}(selections,charactersSelected);options.get(54)?options.get(81)?text+=standaloneStrings_1.AccessibilityHelpNLS.readonlyDiffEditor:text+=standaloneStrings_1.AccessibilityHelpNLS.editableDiffEditor:options.get(81)?text+=standaloneStrings_1.AccessibilityHelpNLS.readonlyEditor:text+=standaloneStrings_1.AccessibilityHelpNLS.editableEditor;const turnOnMessage=platform.isMacintosh?standaloneStrings_1.AccessibilityHelpNLS.changeConfigToOnMac:standaloneStrings_1.AccessibilityHelpNLS.changeConfigToOnWinLinux;switch(options.get(2)){case 0:text+="\n\n - "+turnOnMessage;break;case 2:text+="\n\n - "+standaloneStrings_1.AccessibilityHelpNLS.auto_on;break;case 1:text+="\n\n - "+standaloneStrings_1.AccessibilityHelpNLS.auto_off,text+=" "+turnOnMessage}options.get(130)?text+="\n\n - "+this._descriptionForCommand(toggleTabFocusMode_1.ToggleTabFocusModeAction.ID,standaloneStrings_1.AccessibilityHelpNLS.tabFocusModeOnMsg,standaloneStrings_1.AccessibilityHelpNLS.tabFocusModeOnMsgNoKb):text+="\n\n - "+this._descriptionForCommand(toggleTabFocusMode_1.ToggleTabFocusModeAction.ID,standaloneStrings_1.AccessibilityHelpNLS.tabFocusModeOffMsg,standaloneStrings_1.AccessibilityHelpNLS.tabFocusModeOffMsgNoKb);text+="\n\n - "+(platform.isMacintosh?standaloneStrings_1.AccessibilityHelpNLS.openDocMac:standaloneStrings_1.AccessibilityHelpNLS.openDocWinLinux),text+="\n\n"+standaloneStrings_1.AccessibilityHelpNLS.outroMsg,this._contentDomNode.domNode.appendChild((0,formattedTextRenderer_1.renderFormattedText)(text)),this._contentDomNode.domNode.setAttribute("aria-label",text)}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay("none"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode.domNode.tabIndex=-1,dom.clearNode(this._contentDomNode.domNode),this._editor.focus())}_layout(){const editorLayout=this._editor.getLayoutInfo(),w=Math.max(5,Math.min(AccessibilityHelpWidget.WIDTH,editorLayout.width-40)),h=Math.max(5,Math.min(AccessibilityHelpWidget.HEIGHT,editorLayout.height-40));this._domNode.setWidth(w),this._domNode.setHeight(h);const top=Math.round((editorLayout.height-h)/2);this._domNode.setTop(top);const left=Math.round((editorLayout.width-w)/2);this._domNode.setLeft(left)}};AccessibilityHelpWidget.ID="editor.contrib.accessibilityHelpWidget",AccessibilityHelpWidget.WIDTH=500,AccessibilityHelpWidget.HEIGHT=300,AccessibilityHelpWidget=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,keybinding_1.IKeybindingService),__param(3,opener_1.IOpenerService)],AccessibilityHelpWidget);class ShowAccessibilityHelpAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.showAccessibilityHelp",label:standaloneStrings_1.AccessibilityHelpNLS.showAccessibilityHelpAction,alias:"Show Accessibility Help",precondition:void 0,kbOpts:{primary:571,weight:100,linux:{primary:1595,secondary:[571]}}})}run(accessor,editor){const controller=AccessibilityHelpController.get(editor);controller&&controller.show()}}(0,editorExtensions_1.registerEditorContribution)(AccessibilityHelpController.ID,AccessibilityHelpController),(0,editorExtensions_1.registerEditorAction)(ShowAccessibilityHelpAction);const AccessibilityHelpCommand=editorExtensions_1.EditorCommand.bindToContribution(AccessibilityHelpController.get);(0,editorExtensions_1.registerEditorCommand)(new AccessibilityHelpCommand({id:"closeAccessibilityHelp",precondition:CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE,handler:x=>x.hide(),kbOpts:{weight:200,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:9,secondary:[1033]}})),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const widgetBackground=theme.getColor(colorRegistry_1.editorWidgetBackground);widgetBackground&&collector.addRule(`.monaco-editor .accessibilityHelpWidget { background-color: ${widgetBackground}; }`);const widgetForeground=theme.getColor(colorRegistry_1.editorWidgetForeground);widgetForeground&&collector.addRule(`.monaco-editor .accessibilityHelpWidget { color: ${widgetForeground}; }`);const widgetShadowColor=theme.getColor(colorRegistry_1.widgetShadow);widgetShadowColor&&collector.addRule(`.monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px ${widgetShadowColor}; }`);const hcBorder=theme.getColor(colorRegistry_1.contrastBorder);hcBorder&&collector.addRule(`.monaco-editor .accessibilityHelpWidget { border: 2px solid ${hcBorder}; }`)}))})),define(__m[695],__M([1,0,7,2,15,16,394]),(function(require,exports,dom,lifecycle_1,editorExtensions_1,platform_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IPadShowKeyboard=void 0;class IPadShowKeyboard extends lifecycle_1.Disposable{constructor(editor){super(),this.editor=editor,this.widget=null,platform_1.isIOS&&(this._register(editor.onDidChangeConfiguration((()=>this.update()))),this.update())}update(){const shouldHaveWidget=!this.editor.getOption(81);!this.widget&&shouldHaveWidget?this.widget=new ShowKeyboardWidget(this.editor):this.widget&&!shouldHaveWidget&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}}exports.IPadShowKeyboard=IPadShowKeyboard,IPadShowKeyboard.ID="editor.contrib.iPadShowKeyboard";class ShowKeyboardWidget extends lifecycle_1.Disposable{constructor(editor){super(),this.editor=editor,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(dom.addDisposableListener(this._domNode,"touchstart",(e=>{this.editor.focus()}))),this._register(dom.addDisposableListener(this._domNode,"focus",(e=>{this.editor.focus()}))),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return ShowKeyboardWidget.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}}ShowKeyboardWidget.ID="editor.contrib.ShowKeyboardWidget",(0,editorExtensions_1.registerEditorContribution)(IPadShowKeyboard.ID,IPadShowKeyboard)})),define(__m[696],__M([1,0,7,30,2,15,27,124,35,103,23,14,72,135,395]),(function(require,exports,dom_1,color_1,lifecycle_1,editorExtensions_1,languages_1,nullTokenize_1,language_1,standaloneTheme_1,colorRegistry_1,themeService_1,standaloneStrings_1,theme_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let InspectTokensController=class InspectTokensController extends lifecycle_1.Disposable{constructor(editor,standaloneColorService,languageService){super(),this._editor=editor,this._languageService=languageService,this._widget=null,this._register(this._editor.onDidChangeModel((e=>this.stop()))),this._register(this._editor.onDidChangeModelLanguage((e=>this.stop()))),this._register(languages_1.TokenizationRegistry.onDidChange((e=>this.stop()))),this._register(this._editor.onKeyUp((e=>9===e.keyCode&&this.stop())))}static get(editor){return editor.getContribution(InspectTokensController.ID)}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new InspectTokensWidget(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}};InspectTokensController.ID="editor.contrib.inspectTokens",InspectTokensController=__decorate([__param(1,standaloneTheme_1.IStandaloneThemeService),__param(2,language_1.ILanguageService)],InspectTokensController);class InspectTokens extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.inspectTokens",label:standaloneStrings_1.InspectTokensNLS.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(accessor,editor){const controller=InspectTokensController.get(editor);controller&&controller.launch()}}class InspectTokensWidget extends lifecycle_1.Disposable{constructor(editor,languageService){super(),this.allowEditorOverflow=!0,this._editor=editor,this._languageService=languageService,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=function getSafeTokenizationSupport(languageIdCodec,languageId){const tokenizationSupport=languages_1.TokenizationRegistry.get(languageId);if(tokenizationSupport)return tokenizationSupport;const encodedLanguageId=languageIdCodec.encodeLanguageId(languageId);return{getInitialState:()=>nullTokenize_1.NullState,tokenize:(line,hasEOL,state)=>(0,nullTokenize_1.nullTokenize)(languageId,state),tokenizeEncoded:(line,hasEOL,state)=>(0,nullTokenize_1.nullTokenizeEncoded)(encodedLanguageId,state)}}(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition((e=>this._compute(this._editor.getPosition())))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return InspectTokensWidget._ID}_compute(position){const data=this._getTokensAtLine(position.lineNumber);let token1Index=0;for(let i=data.tokens1.length-1;i>=0;i--){const t=data.tokens1[i];if(position.column-1>=t.offset){token1Index=i;break}}let token2Index=0;for(let i=data.tokens2.length>>>1;i>=0;i--)if(position.column-1>=data.tokens2[i<<1]){token2Index=i;break}const lineContent=this._model.getLineContent(position.lineNumber);let tokenText="";if(token1Index<data.tokens1.length){const tokenStartIndex=data.tokens1[token1Index].offset,tokenEndIndex=token1Index+1<data.tokens1.length?data.tokens1[token1Index+1].offset:lineContent.length;tokenText=lineContent.substring(tokenStartIndex,tokenEndIndex)}(0,dom_1.reset)(this._domNode,(0,dom_1.$)("h2.tm-token",void 0,function renderTokenText(tokenText){let result="";for(let charIndex=0,len=tokenText.length;charIndex<len;charIndex++){const charCode=tokenText.charCodeAt(charIndex);switch(charCode){case 9:result+="→";break;case 32:result+="·";break;default:result+=String.fromCharCode(charCode)}}return result}(tokenText),(0,dom_1.$)("span.tm-token-length",void 0,`${tokenText.length} ${1===tokenText.length?"char":"chars"}`))),(0,dom_1.append)(this._domNode,(0,dom_1.$)("hr.tokens-inspect-separator",{style:"clear:both"}));const metadata=1+(token2Index<<1)<data.tokens2.length?this._decodeMetadata(data.tokens2[1+(token2Index<<1)]):null;(0,dom_1.append)(this._domNode,(0,dom_1.$)("table.tm-metadata-table",void 0,(0,dom_1.$)("tbody",void 0,(0,dom_1.$)("tr",void 0,(0,dom_1.$)("td.tm-metadata-key",void 0,"language"),(0,dom_1.$)("td.tm-metadata-value",void 0,`${metadata?metadata.languageId:"-?-"}`)),(0,dom_1.$)("tr",void 0,(0,dom_1.$)("td.tm-metadata-key",void 0,"token type"),(0,dom_1.$)("td.tm-metadata-value",void 0,`${metadata?this._tokenTypeToString(metadata.tokenType):"-?-"}`)),(0,dom_1.$)("tr",void 0,(0,dom_1.$)("td.tm-metadata-key",void 0,"font style"),(0,dom_1.$)("td.tm-metadata-value",void 0,`${metadata?this._fontStyleToString(metadata.fontStyle):"-?-"}`)),(0,dom_1.$)("tr",void 0,(0,dom_1.$)("td.tm-metadata-key",void 0,"foreground"),(0,dom_1.$)("td.tm-metadata-value",void 0,`${metadata?color_1.Color.Format.CSS.formatHex(metadata.foreground):"-?-"}`)),(0,dom_1.$)("tr",void 0,(0,dom_1.$)("td.tm-metadata-key",void 0,"background"),(0,dom_1.$)("td.tm-metadata-value",void 0,`${metadata?color_1.Color.Format.CSS.formatHex(metadata.background):"-?-"}`))))),(0,dom_1.append)(this._domNode,(0,dom_1.$)("hr.tokens-inspect-separator")),token1Index<data.tokens1.length&&(0,dom_1.append)(this._domNode,(0,dom_1.$)("span.tm-token-type",void 0,data.tokens1[token1Index].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(metadata){const colorMap=languages_1.TokenizationRegistry.getColorMap(),languageId=languages_1.TokenMetadata.getLanguageId(metadata),tokenType=languages_1.TokenMetadata.getTokenType(metadata),fontStyle=languages_1.TokenMetadata.getFontStyle(metadata),foreground=languages_1.TokenMetadata.getForeground(metadata),background=languages_1.TokenMetadata.getBackground(metadata);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(languageId),tokenType,fontStyle,foreground:colorMap[foreground],background:colorMap[background]}}_tokenTypeToString(tokenType){switch(tokenType){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(fontStyle){let r="";return 1&fontStyle&&(r+="italic "),2&fontStyle&&(r+="bold "),4&fontStyle&&(r+="underline "),8&fontStyle&&(r+="strikethrough "),0===r.length&&(r="---"),r}_getTokensAtLine(lineNumber){const stateBeforeLine=this._getStateBeforeLine(lineNumber),tokenizationResult1=this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber),!0,stateBeforeLine),tokenizationResult2=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(lineNumber),!0,stateBeforeLine);return{startState:stateBeforeLine,tokens1:tokenizationResult1.tokens,tokens2:tokenizationResult2.tokens,endState:tokenizationResult1.endState}}_getStateBeforeLine(lineNumber){let state=this._tokenizationSupport.getInitialState();for(let i=1;i<lineNumber;i++){state=this._tokenizationSupport.tokenize(this._model.getLineContent(i),!0,state).endState}return state}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}}InspectTokensWidget._ID="editor.contrib.inspectTokensWidget",(0,editorExtensions_1.registerEditorContribution)(InspectTokensController.ID,InspectTokensController),(0,editorExtensions_1.registerEditorAction)(InspectTokens),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const border=theme.getColor(colorRegistry_1.editorHoverBorder);if(border){const borderWidth=theme.type===theme_1.ColorScheme.HIGH_CONTRAST?2:1;collector.addRule(`.monaco-editor .tokens-inspect-widget { border: ${borderWidth}px solid ${border}; }`),collector.addRule(`.monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: ${border}; }`)}const background=theme.getColor(colorRegistry_1.editorHoverBackground);background&&collector.addRule(`.monaco-editor .tokens-inspect-widget { background-color: ${background}; }`);const foreground=theme.getColor(colorRegistry_1.editorHoverForeground);foreground&&collector.addRule(`.monaco-editor .tokens-inspect-widget { color: ${foreground}; }`)}))})),define(__m[697],__M([1,0,36,107,72,29,642,19,9,43,26,90,130,15,24,80]),(function(require,exports,platform_1,quickAccess_1,standaloneStrings_1,codeEditorService_1,commandsQuickAccess_1,types_1,instantiation_1,keybinding_1,commands_1,telemetry_1,dialogs_1,editorExtensions_1,editorContextKeys_1,quickInput_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GotoLineAction=exports.StandaloneCommandsQuickAccessProvider=void 0;let StandaloneCommandsQuickAccessProvider=class StandaloneCommandsQuickAccessProvider extends commandsQuickAccess_1.AbstractEditorCommandsQuickAccessProvider{constructor(instantiationService,codeEditorService,keybindingService,commandService,telemetryService,dialogService){super({showAlias:!1},instantiationService,keybindingService,commandService,telemetryService,dialogService),this.codeEditorService=codeEditorService}get activeTextEditorControl(){return(0,types_1.withNullAsUndefined)(this.codeEditorService.getFocusedCodeEditor())}getCommandPicks(){return __awaiter(this,void 0,void 0,(function*(){return this.getCodeEditorCommandPicks()}))}};StandaloneCommandsQuickAccessProvider=__decorate([__param(0,instantiation_1.IInstantiationService),__param(1,codeEditorService_1.ICodeEditorService),__param(2,keybinding_1.IKeybindingService),__param(3,commands_1.ICommandService),__param(4,telemetry_1.ITelemetryService),__param(5,dialogs_1.IDialogService)],StandaloneCommandsQuickAccessProvider),exports.StandaloneCommandsQuickAccessProvider=StandaloneCommandsQuickAccessProvider,platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess).registerQuickAccessProvider({ctor:StandaloneCommandsQuickAccessProvider,prefix:StandaloneCommandsQuickAccessProvider.PREFIX,helpEntries:[{description:standaloneStrings_1.QuickCommandNLS.quickCommandHelp,needsEditor:!0}]});class GotoLineAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.quickCommand",label:standaloneStrings_1.QuickCommandNLS.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(accessor){accessor.get(quickInput_1.IQuickInputService).quickAccess.show(StandaloneCommandsQuickAccessProvider.PREFIX)}}exports.GotoLineAction=GotoLineAction,(0,editorExtensions_1.registerEditorAction)(GotoLineAction)})),define(__m[698],__M([1,0,664,36,107,29,19,72,4,15,24,80]),(function(require,exports,gotoLineQuickAccess_1,platform_1,quickAccess_1,codeEditorService_1,types_1,standaloneStrings_1,event_1,editorExtensions_1,editorContextKeys_1,quickInput_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GotoLineAction=exports.StandaloneGotoLineQuickAccessProvider=void 0;let StandaloneGotoLineQuickAccessProvider=class StandaloneGotoLineQuickAccessProvider extends gotoLineQuickAccess_1.AbstractGotoLineQuickAccessProvider{constructor(editorService){super(),this.editorService=editorService,this.onDidActiveTextEditorControlChange=event_1.Event.None}get activeTextEditorControl(){return(0,types_1.withNullAsUndefined)(this.editorService.getFocusedCodeEditor())}};StandaloneGotoLineQuickAccessProvider=__decorate([__param(0,codeEditorService_1.ICodeEditorService)],StandaloneGotoLineQuickAccessProvider),exports.StandaloneGotoLineQuickAccessProvider=StandaloneGotoLineQuickAccessProvider,platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess).registerQuickAccessProvider({ctor:StandaloneGotoLineQuickAccessProvider,prefix:StandaloneGotoLineQuickAccessProvider.PREFIX,helpEntries:[{description:standaloneStrings_1.GoToLineNLS.gotoLineActionLabel,needsEditor:!0}]});class GotoLineAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.gotoLine",label:standaloneStrings_1.GoToLineNLS.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:2085,mac:{primary:293},weight:100}})}run(accessor){accessor.get(quickInput_1.IQuickInputService).quickAccess.show(StandaloneGotoLineQuickAccessProvider.PREFIX)}}exports.GotoLineAction=GotoLineAction,(0,editorExtensions_1.registerEditorAction)(GotoLineAction)})),define(__m[699],__M([1,0,665,36,107,29,19,72,4,15,24,80,205,20,143,289]),(function(require,exports,gotoSymbolQuickAccess_1,platform_1,quickAccess_1,codeEditorService_1,types_1,standaloneStrings_1,event_1,editorExtensions_1,editorContextKeys_1,quickInput_1,outlineModel_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GotoLineAction=exports.StandaloneGotoSymbolQuickAccessProvider=void 0;let StandaloneGotoSymbolQuickAccessProvider=class StandaloneGotoSymbolQuickAccessProvider extends gotoSymbolQuickAccess_1.AbstractGotoSymbolQuickAccessProvider{constructor(editorService,languageFeaturesService,outlineModelService){super(languageFeaturesService,outlineModelService),this.editorService=editorService,this.onDidActiveTextEditorControlChange=event_1.Event.None}get activeTextEditorControl(){return(0,types_1.withNullAsUndefined)(this.editorService.getFocusedCodeEditor())}};StandaloneGotoSymbolQuickAccessProvider=__decorate([__param(0,codeEditorService_1.ICodeEditorService),__param(1,languageFeatures_1.ILanguageFeaturesService),__param(2,outlineModel_1.IOutlineModelService)],StandaloneGotoSymbolQuickAccessProvider),exports.StandaloneGotoSymbolQuickAccessProvider=StandaloneGotoSymbolQuickAccessProvider,platform_1.Registry.as(quickAccess_1.Extensions.Quickaccess).registerQuickAccessProvider({ctor:StandaloneGotoSymbolQuickAccessProvider,prefix:gotoSymbolQuickAccess_1.AbstractGotoSymbolQuickAccessProvider.PREFIX,helpEntries:[{description:standaloneStrings_1.QuickOutlineNLS.quickOutlineActionLabel,prefix:gotoSymbolQuickAccess_1.AbstractGotoSymbolQuickAccessProvider.PREFIX,needsEditor:!0},{description:standaloneStrings_1.QuickOutlineNLS.quickOutlineByCategoryActionLabel,prefix:gotoSymbolQuickAccess_1.AbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY,needsEditor:!0}]});class GotoLineAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.quickOutline",label:standaloneStrings_1.QuickOutlineNLS.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:editorContextKeys_1.EditorContextKeys.hasDocumentSymbolProvider,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(accessor){accessor.get(quickInput_1.IQuickInputService).quickAccess.show(gotoSymbolQuickAccess_1.AbstractGotoSymbolQuickAccessProvider.PREFIX)}}exports.GotoLineAction=GotoLineAction,(0,editorExtensions_1.registerEditorAction)(GotoLineAction)})),define(__m[700],__M([1,0,15,103,72]),(function(require,exports,editorExtensions_1,standaloneTheme_1,standaloneStrings_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class ToggleHighContrast extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.toggleHighContrast",label:standaloneStrings_1.ToggleHighContrastNLS.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(accessor,editor){const standaloneThemeService=accessor.get(standaloneTheme_1.IStandaloneThemeService);this._originalThemeName?(standaloneThemeService.setTheme(this._originalThemeName),this._originalThemeName=null):(this._originalThemeName=standaloneThemeService.getColorTheme().themeName,standaloneThemeService.setTheme("hc-black"))}}(0,editorExtensions_1.registerEditorAction)(ToggleHighContrast)})),define(__m[209],__M([1,0,7,44,128,491,47,198,2,16,589,37,17,78,9,43,39,82,14,398]),(function(require,exports,dom_1,keyboardEvent_1,actionViewItems_1,dropdownActionViewItem_1,actions_1,keybindingLabels_1,lifecycle_1,platform_1,nls_1,actions_2,contextkey_1,contextView_1,instantiation_1,keybinding_1,notification_1,storage_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createActionViewItem=exports.SubmenuEntryActionViewItem=exports.MenuEntryActionViewItem=exports.createAndFillInActionBarActions=void 0,exports.createAndFillInActionBarActions=function createAndFillInActionBarActions(menu,options,target,primaryGroup,primaryMaxCount,shouldInlineSubmenu,useSeparatorsInPrimaryActions){const groups=menu.getActions(options);return function fillInActions(groups,target,useAlternativeActions,isPrimaryAction=(actionGroup=>"navigation"===actionGroup),primaryMaxCount=Number.MAX_SAFE_INTEGER,shouldInlineSubmenu=(()=>!1),useSeparatorsInPrimaryActions=!1){let primaryBucket,secondaryBucket;Array.isArray(target)?(primaryBucket=target,secondaryBucket=target):(primaryBucket=target.primary,secondaryBucket=target.secondary);const submenuInfo=new Set;for(const[group,actions]of groups){let target;isPrimaryAction(group)?(target=primaryBucket,target.length>0&&useSeparatorsInPrimaryActions&&target.push(new actions_1.Separator)):(target=secondaryBucket,target.length>0&&target.push(new actions_1.Separator));for(let action of actions){useAlternativeActions&&(action=action instanceof actions_2.MenuItemAction&&action.alt?action.alt:action);const newLen=target.push(action);action instanceof actions_1.SubmenuAction&&submenuInfo.add({group,action,index:newLen-1})}}for(const{group,action,index}of submenuInfo){const target=isPrimaryAction(group)?primaryBucket:secondaryBucket,submenuActions=action.actions;(submenuActions.length<=1||target.length+submenuActions.length-2<=primaryMaxCount)&&shouldInlineSubmenu(action,group,target.length)&&target.splice(index,1,...submenuActions)}if(primaryBucket!==secondaryBucket&&primaryBucket.length>primaryMaxCount){const overflow=primaryBucket.splice(primaryMaxCount,primaryBucket.length-primaryMaxCount);secondaryBucket.unshift(...overflow,new actions_1.Separator)}}(groups,target,!1,"string"==typeof primaryGroup?actionGroup=>actionGroup===primaryGroup:primaryGroup,primaryMaxCount,shouldInlineSubmenu,useSeparatorsInPrimaryActions),function asDisposable(groups){const disposables=new lifecycle_1.DisposableStore;for(const[,actions]of groups)for(const action of actions)disposables.add(action);return disposables}(groups)};let MenuEntryActionViewItem=class MenuEntryActionViewItem extends actionViewItems_1.ActionViewItem{constructor(_action,options,_keybindingService,_notificationService,_contextKeyService){super(void 0,_action,{icon:!(!_action.class&&!_action.item.icon),label:!_action.class&&!_action.item.icon,draggable:null==options?void 0:options.draggable}),this._keybindingService=_keybindingService,this._notificationService=_notificationService,this._contextKeyService=_contextKeyService,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new lifecycle_1.MutableDisposable),this._altKey=dom_1.ModifierKeyEmitter.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(event){return __awaiter(this,void 0,void 0,(function*(){event.preventDefault(),event.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(err){this._notificationService.error(err)}}))}render(container){super.render(container),container.classList.add("menu-entry"),this._updateItemClass(this._menuItemAction.item);let mouseOver=!1,alternativeKeyDown=this._altKey.keyStatus.altKey||(platform_1.isWindows||platform_1.isLinux)&&this._altKey.keyStatus.shiftKey;const updateAltState=()=>{const wantsAltCommand=mouseOver&&alternativeKeyDown;wantsAltCommand!==this._wantsAltCommand&&(this._wantsAltCommand=wantsAltCommand,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event((value=>{alternativeKeyDown=value.altKey||(platform_1.isWindows||platform_1.isLinux)&&value.shiftKey,updateAltState()}))),this._register((0,dom_1.addDisposableListener)(container,"mouseleave",(_=>{mouseOver=!1,updateAltState()}))),this._register((0,dom_1.addDisposableListener)(container,"mouseenter",(_=>{mouseOver=!0,updateAltState()})))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}updateTooltip(){if(this.label){const keybinding=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),keybindingLabel=keybinding&&keybinding.getLabel(),tooltip=this._commandAction.tooltip||this._commandAction.label;let title=keybindingLabel?(0,nls_1.localize)(0,null,tooltip,keybindingLabel):tooltip;if(!this._wantsAltCommand&&this._menuItemAction.alt){const altTooltip=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,altKeybinding=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),altKeybindingLabel=altKeybinding&&altKeybinding.getLabel(),altTitleSection=altKeybindingLabel?(0,nls_1.localize)(1,null,altTooltip,altKeybindingLabel):altTooltip;title+=`\n[${keybindingLabels_1.UILabelProvider.modifierLabels[platform_1.OS].altKey}] ${altTitleSection}`}this.label.title=title}}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.item))}_updateItemClass(item){var _a;this._itemClassDispose.value=void 0;const{element,label}=this;if(!element||!label)return;const icon=this._commandAction.checked&&(null===(_a=item.toggled)||void 0===_a?void 0:_a.icon)?item.toggled.icon:item.icon;if(icon)if(themeService_1.ThemeIcon.isThemeIcon(icon)){const iconClasses=themeService_1.ThemeIcon.asClassNameArray(icon);label.classList.add(...iconClasses),this._itemClassDispose.value=(0,lifecycle_1.toDisposable)((()=>{label.classList.remove(...iconClasses)}))}else icon.light&&label.style.setProperty("--menu-entry-icon-light",(0,dom_1.asCSSUrl)(icon.light)),icon.dark&&label.style.setProperty("--menu-entry-icon-dark",(0,dom_1.asCSSUrl)(icon.dark)),label.classList.add("icon"),this._itemClassDispose.value=(0,lifecycle_1.toDisposable)((()=>{label.classList.remove("icon"),label.style.removeProperty("--menu-entry-icon-light"),label.style.removeProperty("--menu-entry-icon-dark")}))}};MenuEntryActionViewItem=__decorate([__param(2,keybinding_1.IKeybindingService),__param(3,notification_1.INotificationService),__param(4,contextkey_1.IContextKeyService)],MenuEntryActionViewItem),exports.MenuEntryActionViewItem=MenuEntryActionViewItem;let SubmenuEntryActionViewItem=class SubmenuEntryActionViewItem extends dropdownActionViewItem_1.DropdownMenuActionViewItem{constructor(action,options,contextMenuService){var _a,_b;const dropdownOptions=Object.assign({},null!=options?options:Object.create(null),{menuAsChild:null!==(_a=null==options?void 0:options.menuAsChild)&&void 0!==_a&&_a,classNames:null!==(_b=null==options?void 0:options.classNames)&&void 0!==_b?_b:themeService_1.ThemeIcon.isThemeIcon(action.item.icon)?themeService_1.ThemeIcon.asClassName(action.item.icon):void 0});super(action,{getActions:()=>action.actions},contextMenuService,dropdownOptions)}render(container){if(super.render(container),this.element){container.classList.add("menu-entry");const{icon}=this._action.item;icon&&!themeService_1.ThemeIcon.isThemeIcon(icon)&&(this.element.classList.add("icon"),icon.light&&this.element.style.setProperty("--menu-entry-icon-light",(0,dom_1.asCSSUrl)(icon.light)),icon.dark&&this.element.style.setProperty("--menu-entry-icon-dark",(0,dom_1.asCSSUrl)(icon.dark)))}}};SubmenuEntryActionViewItem=__decorate([__param(2,contextView_1.IContextMenuService)],SubmenuEntryActionViewItem),exports.SubmenuEntryActionViewItem=SubmenuEntryActionViewItem;let DropdownWithDefaultActionViewItem=class DropdownWithDefaultActionViewItem extends actionViewItems_1.BaseActionViewItem{constructor(submenuAction,options,_keybindingService,_notificationService,_contextMenuService,_menuService,_instaService,_storageService){var _a,_b,_c;let defaultAction;super(null,submenuAction),this._keybindingService=_keybindingService,this._notificationService=_notificationService,this._contextMenuService=_contextMenuService,this._menuService=_menuService,this._instaService=_instaService,this._storageService=_storageService,this._container=null,this._storageKey=`${submenuAction.item.submenu._debugName}_lastActionId`;let defaultActionId=_storageService.get(this._storageKey,1);defaultActionId&&(defaultAction=submenuAction.actions.find((a=>defaultActionId===a.id))),defaultAction||(defaultAction=submenuAction.actions[0]),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,defaultAction,void 0);const dropdownOptions=Object.assign({},null!=options?options:Object.create(null),{menuAsChild:null===(_a=null==options?void 0:options.menuAsChild)||void 0===_a||_a,classNames:null!==(_b=null==options?void 0:options.classNames)&&void 0!==_b?_b:["codicon","codicon-chevron-down"],actionRunner:null!==(_c=null==options?void 0:options.actionRunner)&&void 0!==_c?_c:new actions_1.ActionRunner});this._dropdown=new dropdownActionViewItem_1.DropdownMenuActionViewItem(submenuAction,submenuAction.actions,this._contextMenuService,dropdownOptions),this._dropdown.actionRunner.onDidRun((e=>{e.action instanceof actions_2.MenuItemAction&&this.update(e.action)}))}update(lastAction){this._storageService.store(this._storageKey,lastAction.id,1,0),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,lastAction,void 0),this._defaultAction.actionRunner=new class extends actions_1.ActionRunner{runAction(action,context){return __awaiter(this,void 0,void 0,(function*(){yield action.run(void 0)}))}},this._container&&this._defaultAction.render((0,dom_1.prepend)(this._container,(0,dom_1.$)(".action-container")))}setActionContext(newContext){super.setActionContext(newContext),this._defaultAction.setActionContext(newContext),this._dropdown.setActionContext(newContext)}render(container){this._container=container,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const primaryContainer=(0,dom_1.$)(".action-container");this._defaultAction.render((0,dom_1.append)(this._container,primaryContainer)),this._register((0,dom_1.addDisposableListener)(primaryContainer,dom_1.EventType.KEY_DOWN,(e=>{const event=new keyboardEvent_1.StandardKeyboardEvent(e);event.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),event.stopPropagation())})));const dropdownContainer=(0,dom_1.$)(".dropdown-action-container");this._dropdown.render((0,dom_1.append)(this._container,dropdownContainer)),this._register((0,dom_1.addDisposableListener)(dropdownContainer,dom_1.EventType.KEY_DOWN,(e=>{var _a;const event=new keyboardEvent_1.StandardKeyboardEvent(e);event.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),null===(_a=this._defaultAction.element)||void 0===_a||_a.focus(),event.stopPropagation())})))}focus(fromRight){fromRight?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(focusable){focusable?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};DropdownWithDefaultActionViewItem=__decorate([__param(2,keybinding_1.IKeybindingService),__param(3,notification_1.INotificationService),__param(4,contextView_1.IContextMenuService),__param(5,actions_2.IMenuService),__param(6,instantiation_1.IInstantiationService),__param(7,storage_1.IStorageService)],DropdownWithDefaultActionViewItem),exports.createActionViewItem=function createActionViewItem(instaService,action,options){return action instanceof actions_2.MenuItemAction?instaService.createInstance(MenuEntryActionViewItem,action,void 0):action instanceof actions_2.SubmenuItemAction?action.item.rememberDefaultAction?instaService.createInstance(DropdownWithDefaultActionViewItem,action,options):instaService.createInstance(SubmenuEntryActionViewItem,action,options):void 0}})),define(__m[701],__M([1,0,7,87,2,109,581,209,37,17,9]),(function(require,exports,dom,actionbar_1,lifecycle_1,suggest_1,nls_1,menuEntryActionViewItem_1,actions_1,contextkey_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestWidgetStatus=void 0;class StatusBarViewItem extends menuEntryActionViewItem_1.MenuEntryActionViewItem{updateLabel(){const kb=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!kb)return super.updateLabel();this.label&&(this.label.textContent=(0,nls_1.localize)(0,null,this._action.label,StatusBarViewItem.symbolPrintEnter(kb)))}static symbolPrintEnter(kb){var _a;return null===(_a=kb.getLabel())||void 0===_a?void 0:_a.replace(/\benter\b/gi,"⏎")}}let SuggestWidgetStatus=class SuggestWidgetStatus{constructor(container,instantiationService,_menuService,_contextKeyService){this._menuService=_menuService,this._contextKeyService=_contextKeyService,this._menuDisposables=new lifecycle_1.DisposableStore,this.element=dom.append(container,dom.$(".suggest-status-bar"));const actionViewItemProvider=action=>action instanceof actions_1.MenuItemAction?instantiationService.createInstance(StatusBarViewItem,action,void 0):void 0;this._leftActions=new actionbar_1.ActionBar(this.element,{actionViewItemProvider}),this._rightActions=new actionbar_1.ActionBar(this.element,{actionViewItemProvider}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){const menu=this._menuService.createMenu(suggest_1.suggestWidgetStatusbarMenu,this._contextKeyService),renderMenu=()=>{const left=[],right=[];for(let[group,actions]of menu.getActions())"left"===group?left.push(...actions):right.push(...actions);this._leftActions.clear(),this._leftActions.push(left),this._rightActions.clear(),this._rightActions.push(right)};this._menuDisposables.add(menu.onDidChange((()=>renderMenu()))),this._menuDisposables.add(menu)}hide(){this._menuDisposables.clear()}};SuggestWidgetStatus=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,actions_1.IMenuService),__param(3,contextkey_1.IContextKeyService)],SuggestWidgetStatus),exports.SuggestWidgetStatus=SuggestWidgetStatus})),define(__m[702],__M([1,0,10,4,2,37,26,17]),(function(require,exports,async_1,event_1,lifecycle_1,actions_1,commands_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuService=void 0;let MenuService=class MenuService{constructor(_commandService){this._commandService=_commandService}createMenu(id,contextKeyService,options){return new Menu(id,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},options),this._commandService,contextKeyService,this)}};MenuService=__decorate([__param(0,commands_1.ICommandService)],MenuService),exports.MenuService=MenuService;let Menu=class Menu{constructor(_id,_options,_commandService,_contextKeyService,_menuService){this._id=_id,this._options=_options,this._commandService=_commandService,this._contextKeyService=_contextKeyService,this._menuService=_menuService,this._disposables=new lifecycle_1.DisposableStore,this._menuGroups=[],this._contextKeys=new Set,this._build();const rebuildMenuSoon=new async_1.RunOnceScheduler((()=>{this._build(),this._onDidChange.fire(this)}),_options.eventDebounceDelay);this._disposables.add(rebuildMenuSoon),this._disposables.add(actions_1.MenuRegistry.onDidChangeMenu((e=>{e.has(_id)&&rebuildMenuSoon.schedule()})));const contextKeyListener=this._disposables.add(new lifecycle_1.DisposableStore);this._onDidChange=new event_1.Emitter({onFirstListenerAdd:()=>{const fireChangeSoon=new async_1.RunOnceScheduler((()=>this._onDidChange.fire(this)),_options.eventDebounceDelay);contextKeyListener.add(fireChangeSoon),contextKeyListener.add(_contextKeyService.onDidChangeContext((e=>{e.affectsSome(this._contextKeys)&&fireChangeSoon.schedule()})))},onLastListenerRemove:contextKeyListener.clear.bind(contextKeyListener)}),this.onDidChange=this._onDidChange.event}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}_build(){this._menuGroups.length=0,this._contextKeys.clear();const menuItems=actions_1.MenuRegistry.getMenuItems(this._id);let group;menuItems.sort(Menu._compareMenuItems);for(const item of menuItems){const groupName=item.group||"";group&&group[0]===groupName||(group=[groupName,[]],this._menuGroups.push(group)),group[1].push(item),this._collectContextKeys(item)}}_collectContextKeys(item){if(Menu._fillInKbExprKeys(item.when,this._contextKeys),(0,actions_1.isIMenuItem)(item)){if(item.command.precondition&&Menu._fillInKbExprKeys(item.command.precondition,this._contextKeys),item.command.toggled){const toggledExpression=item.command.toggled.condition||item.command.toggled;Menu._fillInKbExprKeys(toggledExpression,this._contextKeys)}}else this._options.emitEventsForSubmenuChanges&&actions_1.MenuRegistry.getMenuItems(item.submenu).forEach(this._collectContextKeys,this)}getActions(options){const result=[];for(let group of this._menuGroups){const[id,items]=group,activeActions=[];for(const item of items)if(this._contextKeyService.contextMatchesRules(item.when)){const action=(0,actions_1.isIMenuItem)(item)?new actions_1.MenuItemAction(item.command,item.alt,options,this._contextKeyService,this._commandService):new actions_1.SubmenuItemAction(item,this._menuService,this._contextKeyService,options);activeActions.push(action)}activeActions.length>0&&result.push([id,activeActions])}return result}static _fillInKbExprKeys(exp,set){if(exp)for(let key of exp.keys())set.add(key)}static _compareMenuItems(a,b){let aGroup=a.group,bGroup=b.group;if(aGroup!==bGroup){if(!aGroup)return 1;if(!bGroup)return-1;if("navigation"===aGroup)return-1;if("navigation"===bGroup)return 1;let value=aGroup.localeCompare(bGroup);if(0!==value)return value}let aPrio=a.order||0,bPrio=b.order||0;return aPrio<bPrio?-1:aPrio>bPrio?1:Menu._compareTitles((0,actions_1.isIMenuItem)(a)?a.command.title:a.title,(0,actions_1.isIMenuItem)(b)?b.command.title:b.title)}static _compareTitles(a,b){const aStr="string"==typeof a?a:a.original,bStr="string"==typeof b?b:b.original;return aStr.localeCompare(bStr)}};Menu=__decorate([__param(2,commands_1.ICommandService),__param(3,contextkey_1.IContextKeyService),__param(4,actions_1.IMenuService)],Menu)})),define(__m[703],__M([1,0,7,4,2,43,39,90,14,643,78]),(function(require,exports,dom_1,event_1,lifecycle_1,keybinding_1,notification_1,telemetry_1,themeService_1,contextMenuHandler_1,contextView_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContextMenuService=void 0;let ContextMenuService=class ContextMenuService extends lifecycle_1.Disposable{constructor(telemetryService,notificationService,contextViewService,keybindingService,themeService){super(),this._onDidShowContextMenu=new event_1.Emitter,this._onDidHideContextMenu=new event_1.Emitter,this.contextMenuHandler=new contextMenuHandler_1.ContextMenuHandler(contextViewService,telemetryService,notificationService,keybindingService,themeService)}configure(options){this.contextMenuHandler.configure(options)}showContextMenu(delegate){this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},delegate),{onHide:didCancel=>{delegate.onHide&&delegate.onHide(didCancel),this._onDidHideContextMenu.fire()}})),dom_1.ModifierKeyEmitter.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};ContextMenuService=__decorate([__param(0,telemetry_1.ITelemetryService),__param(1,notification_1.INotificationService),__param(2,contextView_1.IContextViewService),__param(3,keybinding_1.IKeybindingService),__param(4,themeService_1.IThemeService)],ContextMenuService),exports.ContextMenuService=ContextMenuService})),define(__m[161],__M([1,0,7,348,117,351,488,487,269,4,2,595,65,41,105,17,278,9,43,36,134,14]),(function(require,exports,dom_1,listPaging_1,listWidget_1,tableWidget_1,asyncDataTree_1,dataTree_1,objectTree_1,event_1,lifecycle_1,nls_1,accessibility_1,configuration_1,configurationRegistry_1,contextkey_1,contextkeys_1,instantiation_1,keybinding_1,platform_1,styler_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorkbenchCompressibleAsyncDataTree=exports.WorkbenchAsyncDataTree=exports.WorkbenchDataTree=exports.WorkbenchCompressibleObjectTree=exports.WorkbenchObjectTree=exports.WorkbenchTable=exports.WorkbenchPagedList=exports.WorkbenchList=exports.WorkbenchListAutomaticKeyboardNavigationKey=exports.WorkbenchTreeElementHasChild=exports.WorkbenchTreeElementCanExpand=exports.WorkbenchTreeElementHasParent=exports.WorkbenchTreeElementCanCollapse=exports.WorkbenchListSelectionNavigation=exports.WorkbenchListMultiSelection=exports.WorkbenchListDoubleSelection=exports.WorkbenchListHasSelectionOrFocus=exports.WorkbenchListFocusContextKey=exports.WorkbenchListSupportsMultiSelectContextKey=exports.ListService=exports.IListService=void 0,exports.IListService=(0,instantiation_1.createDecorator)("listService");let ListService=class ListService{constructor(_themeService){this._themeService=_themeService,this.disposables=new lifecycle_1.DisposableStore,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}get lastFocusedList(){return this._lastFocusedWidget}setLastFocusedList(widget){var _a,_b;widget!==this._lastFocusedWidget&&(null===(_a=this._lastFocusedWidget)||void 0===_a||_a.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=widget,null===(_b=this._lastFocusedWidget)||void 0===_b||_b.getHTMLElement().classList.add("last-focused"))}register(widget,extraContextKeys){if(!this._hasCreatedStyleController){this._hasCreatedStyleController=!0;const styleController=new listWidget_1.DefaultStyleController((0,dom_1.createStyleSheet)(),"");this.disposables.add((0,styler_1.attachListStyler)(styleController,this._themeService))}if(this.lists.some((l=>l.widget===widget)))throw new Error("Cannot register the same widget multiple times");const registeredList={widget,extraContextKeys};return this.lists.push(registeredList),widget.getHTMLElement()===document.activeElement&&this.setLastFocusedList(widget),(0,lifecycle_1.combinedDisposable)(widget.onDidFocus((()=>this.setLastFocusedList(widget))),(0,lifecycle_1.toDisposable)((()=>this.lists.splice(this.lists.indexOf(registeredList),1))),widget.onDidDispose((()=>{this.lists=this.lists.filter((l=>l!==registeredList)),this._lastFocusedWidget===widget&&this.setLastFocusedList(void 0)})))}dispose(){this.disposables.dispose()}};ListService=__decorate([__param(0,themeService_1.IThemeService)],ListService),exports.ListService=ListService;const RawWorkbenchListFocusContextKey=new contextkey_1.RawContextKey("listFocus",!0);function createScopedContextKeyService(contextKeyService,widget){const result=contextKeyService.createScoped(widget.getHTMLElement());return RawWorkbenchListFocusContextKey.bindTo(result),result}exports.WorkbenchListSupportsMultiSelectContextKey=new contextkey_1.RawContextKey("listSupportsMultiselect",!0),exports.WorkbenchListFocusContextKey=contextkey_1.ContextKeyExpr.and(RawWorkbenchListFocusContextKey,contextkey_1.ContextKeyExpr.not(contextkeys_1.InputFocusedContextKey)),exports.WorkbenchListHasSelectionOrFocus=new contextkey_1.RawContextKey("listHasSelectionOrFocus",!1),exports.WorkbenchListDoubleSelection=new contextkey_1.RawContextKey("listDoubleSelection",!1),exports.WorkbenchListMultiSelection=new contextkey_1.RawContextKey("listMultiSelection",!1),exports.WorkbenchListSelectionNavigation=new contextkey_1.RawContextKey("listSelectionNavigation",!1),exports.WorkbenchTreeElementCanCollapse=new contextkey_1.RawContextKey("treeElementCanCollapse",!1),exports.WorkbenchTreeElementHasParent=new contextkey_1.RawContextKey("treeElementHasParent",!1),exports.WorkbenchTreeElementCanExpand=new contextkey_1.RawContextKey("treeElementCanExpand",!1),exports.WorkbenchTreeElementHasChild=new contextkey_1.RawContextKey("treeElementHasChild",!1),exports.WorkbenchListAutomaticKeyboardNavigationKey="listAutomaticKeyboardNavigation";const horizontalScrollingKey="workbench.list.horizontalScrolling",treeIndentKey="workbench.tree.indent",listSmoothScrolling="workbench.list.smoothScrolling",mouseWheelScrollSensitivityKey="workbench.list.mouseWheelScrollSensitivity",fastScrollSensitivityKey="workbench.list.fastScrollSensitivity",treeExpandMode="workbench.tree.expandMode";function useAltAsMultipleSelectionModifier(configurationService){return"alt"===configurationService.getValue("workbench.list.multiSelectModifier")}class MultipleSelectionController extends lifecycle_1.Disposable{constructor(configurationService){super(),this.configurationService=configurationService,this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(this.configurationService))})))}isSelectionSingleChangeEvent(event){return this.useAltAsMultipleSelectionModifier?event.browserEvent.altKey:(0,listWidget_1.isSelectionSingleChangeEvent)(event)}isSelectionRangeChangeEvent(event){return(0,listWidget_1.isSelectionRangeChangeEvent)(event)}}function toWorkbenchListOptions(options,configurationService,keybindingService){var _a;const disposables=new lifecycle_1.DisposableStore;return[Object.assign(Object.assign({},options),{keyboardNavigationDelegate:{mightProducePrintableCharacter:e=>keybindingService.mightProducePrintableCharacter(e)},smoothScrolling:Boolean(configurationService.getValue(listSmoothScrolling)),mouseWheelScrollSensitivity:configurationService.getValue(mouseWheelScrollSensitivityKey),fastScrollSensitivity:configurationService.getValue(fastScrollSensitivityKey),multipleSelectionController:null!==(_a=options.multipleSelectionController)&&void 0!==_a?_a:disposables.add(new MultipleSelectionController(configurationService))}),disposables]}let WorkbenchList=class WorkbenchList extends listWidget_1.List{constructor(user,container,delegate,renderers,options,contextKeyService,listService,themeService,configurationService,keybindingService){const horizontalScrolling=void 0!==options.horizontalScrolling?options.horizontalScrolling:Boolean(configurationService.getValue(horizontalScrollingKey)),[workbenchListOptions,workbenchListOptionsDisposable]=toWorkbenchListOptions(options,configurationService,keybindingService);super(user,container,delegate,renderers,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},(0,styler_1.computeStyles)(themeService.getColorTheme(),styler_1.defaultListStyles)),workbenchListOptions),{horizontalScrolling})),this.disposables.add(workbenchListOptionsDisposable),this.contextKeyService=createScopedContextKeyService(contextKeyService,this),this.themeService=themeService,this.listSupportsMultiSelect=exports.WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==options.multipleSelectionSupport);exports.WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(options.selectionNavigation)),this.listHasSelectionOrFocus=exports.WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=exports.WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=exports.WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=options.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService),this.disposables.add(this.contextKeyService),this.disposables.add(listService.register(this)),options.overrideStyles&&this.updateStyles(options.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const selection=this.getSelection(),focus=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(selection.length>0||focus.length>0),this.listMultiSelection.set(selection.length>1),this.listDoubleSelection.set(2===selection.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const selection=this.getSelection(),focus=this.getFocus();this.listHasSelectionOrFocus.set(selection.length>0||focus.length>0)}))),this.disposables.add(configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService));let options={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const horizontalScrolling=Boolean(configurationService.getValue(horizontalScrollingKey));options=Object.assign(Object.assign({},options),{horizontalScrolling})}if(e.affectsConfiguration(listSmoothScrolling)){const smoothScrolling=Boolean(configurationService.getValue(listSmoothScrolling));options=Object.assign(Object.assign({},options),{smoothScrolling})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const mouseWheelScrollSensitivity=configurationService.getValue(mouseWheelScrollSensitivityKey);options=Object.assign(Object.assign({},options),{mouseWheelScrollSensitivity})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const fastScrollSensitivity=configurationService.getValue(fastScrollSensitivityKey);options=Object.assign(Object.assign({},options),{fastScrollSensitivity})}Object.keys(options).length>0&&this.updateOptions(options)}))),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService},options)),this.disposables.add(this.navigator)}updateOptions(options){super.updateOptions(options),options.overrideStyles&&this.updateStyles(options.overrideStyles),void 0!==options.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!options.multipleSelectionSupport)}updateStyles(styles){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),this._styler=(0,styler_1.attachListStyler)(this,this.themeService,styles)}dispose(){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),super.dispose()}};WorkbenchList=__decorate([__param(5,contextkey_1.IContextKeyService),__param(6,exports.IListService),__param(7,themeService_1.IThemeService),__param(8,configuration_1.IConfigurationService),__param(9,keybinding_1.IKeybindingService)],WorkbenchList),exports.WorkbenchList=WorkbenchList;let WorkbenchPagedList=class WorkbenchPagedList extends listPaging_1.PagedList{constructor(user,container,delegate,renderers,options,contextKeyService,listService,themeService,configurationService,keybindingService){const horizontalScrolling=void 0!==options.horizontalScrolling?options.horizontalScrolling:Boolean(configurationService.getValue(horizontalScrollingKey)),[workbenchListOptions,workbenchListOptionsDisposable]=toWorkbenchListOptions(options,configurationService,keybindingService);super(user,container,delegate,renderers,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},(0,styler_1.computeStyles)(themeService.getColorTheme(),styler_1.defaultListStyles)),workbenchListOptions),{horizontalScrolling})),this.disposables=new lifecycle_1.DisposableStore,this.disposables.add(workbenchListOptionsDisposable),this.contextKeyService=createScopedContextKeyService(contextKeyService,this),this.themeService=themeService,this.horizontalScrolling=options.horizontalScrolling,this.listSupportsMultiSelect=exports.WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==options.multipleSelectionSupport);exports.WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(options.selectionNavigation)),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService),this.disposables.add(this.contextKeyService),this.disposables.add(listService.register(this)),options.overrideStyles&&this.updateStyles(options.overrideStyles),options.overrideStyles&&this.disposables.add((0,styler_1.attachListStyler)(this,themeService,options.overrideStyles)),this.disposables.add(configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService));let options={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const horizontalScrolling=Boolean(configurationService.getValue(horizontalScrollingKey));options=Object.assign(Object.assign({},options),{horizontalScrolling})}if(e.affectsConfiguration(listSmoothScrolling)){const smoothScrolling=Boolean(configurationService.getValue(listSmoothScrolling));options=Object.assign(Object.assign({},options),{smoothScrolling})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const mouseWheelScrollSensitivity=configurationService.getValue(mouseWheelScrollSensitivityKey);options=Object.assign(Object.assign({},options),{mouseWheelScrollSensitivity})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const fastScrollSensitivity=configurationService.getValue(fastScrollSensitivityKey);options=Object.assign(Object.assign({},options),{fastScrollSensitivity})}Object.keys(options).length>0&&this.updateOptions(options)}))),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService},options)),this.disposables.add(this.navigator)}updateOptions(options){super.updateOptions(options),options.overrideStyles&&this.updateStyles(options.overrideStyles),void 0!==options.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!options.multipleSelectionSupport)}updateStyles(styles){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),this._styler=(0,styler_1.attachListStyler)(this,this.themeService,styles)}dispose(){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),this.disposables.dispose(),super.dispose()}};WorkbenchPagedList=__decorate([__param(5,contextkey_1.IContextKeyService),__param(6,exports.IListService),__param(7,themeService_1.IThemeService),__param(8,configuration_1.IConfigurationService),__param(9,keybinding_1.IKeybindingService)],WorkbenchPagedList),exports.WorkbenchPagedList=WorkbenchPagedList;let WorkbenchTable=class WorkbenchTable extends tableWidget_1.Table{constructor(user,container,delegate,columns,renderers,options,contextKeyService,listService,themeService,configurationService,keybindingService){const horizontalScrolling=void 0!==options.horizontalScrolling?options.horizontalScrolling:Boolean(configurationService.getValue(horizontalScrollingKey)),[workbenchListOptions,workbenchListOptionsDisposable]=toWorkbenchListOptions(options,configurationService,keybindingService);super(user,container,delegate,columns,renderers,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},(0,styler_1.computeStyles)(themeService.getColorTheme(),styler_1.defaultListStyles)),workbenchListOptions),{horizontalScrolling})),this.disposables.add(workbenchListOptionsDisposable),this.contextKeyService=createScopedContextKeyService(contextKeyService,this),this.themeService=themeService,this.listSupportsMultiSelect=exports.WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==options.multipleSelectionSupport);exports.WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(options.selectionNavigation)),this.listHasSelectionOrFocus=exports.WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=exports.WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=exports.WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=options.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService),this.disposables.add(this.contextKeyService),this.disposables.add(listService.register(this)),options.overrideStyles&&this.updateStyles(options.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const selection=this.getSelection(),focus=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(selection.length>0||focus.length>0),this.listMultiSelection.set(selection.length>1),this.listDoubleSelection.set(2===selection.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const selection=this.getSelection(),focus=this.getFocus();this.listHasSelectionOrFocus.set(selection.length>0||focus.length>0)}))),this.disposables.add(configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService));let options={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const horizontalScrolling=Boolean(configurationService.getValue(horizontalScrollingKey));options=Object.assign(Object.assign({},options),{horizontalScrolling})}if(e.affectsConfiguration(listSmoothScrolling)){const smoothScrolling=Boolean(configurationService.getValue(listSmoothScrolling));options=Object.assign(Object.assign({},options),{smoothScrolling})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const mouseWheelScrollSensitivity=configurationService.getValue(mouseWheelScrollSensitivityKey);options=Object.assign(Object.assign({},options),{mouseWheelScrollSensitivity})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const fastScrollSensitivity=configurationService.getValue(fastScrollSensitivityKey);options=Object.assign(Object.assign({},options),{fastScrollSensitivity})}Object.keys(options).length>0&&this.updateOptions(options)}))),this.navigator=new TableResourceNavigator(this,Object.assign({configurationService},options)),this.disposables.add(this.navigator)}updateOptions(options){super.updateOptions(options),options.overrideStyles&&this.updateStyles(options.overrideStyles),void 0!==options.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!options.multipleSelectionSupport)}updateStyles(styles){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),this._styler=(0,styler_1.attachListStyler)(this,this.themeService,styles)}dispose(){var _a;null===(_a=this._styler)||void 0===_a||_a.dispose(),this.disposables.dispose(),super.dispose()}};WorkbenchTable=__decorate([__param(6,contextkey_1.IContextKeyService),__param(7,exports.IListService),__param(8,themeService_1.IThemeService),__param(9,configuration_1.IConfigurationService),__param(10,keybinding_1.IKeybindingService)],WorkbenchTable),exports.WorkbenchTable=WorkbenchTable;class ResourceNavigator extends lifecycle_1.Disposable{constructor(widget,options){var _a;super(),this.widget=widget,this._onDidOpen=this._register(new event_1.Emitter),this.onDidOpen=this._onDidOpen.event,this._register(event_1.Event.filter(this.widget.onDidChangeSelection,(e=>e.browserEvent instanceof KeyboardEvent))((e=>this.onSelectionFromKeyboard(e)))),this._register(this.widget.onPointer((e=>this.onPointer(e.element,e.browserEvent)))),this._register(this.widget.onMouseDblClick((e=>this.onMouseDblClick(e.element,e.browserEvent)))),"boolean"!=typeof(null==options?void 0:options.openOnSingleClick)&&(null==options?void 0:options.configurationService)?(this.openOnSingleClick="doubleClick"!==(null==options?void 0:options.configurationService.getValue("workbench.list.openMode")),this._register(null==options?void 0:options.configurationService.onDidChangeConfiguration((()=>{this.openOnSingleClick="doubleClick"!==(null==options?void 0:options.configurationService.getValue("workbench.list.openMode"))})))):this.openOnSingleClick=null===(_a=null==options?void 0:options.openOnSingleClick)||void 0===_a||_a}onSelectionFromKeyboard(event){if(1!==event.elements.length)return;const selectionKeyboardEvent=event.browserEvent,preserveFocus="boolean"!=typeof selectionKeyboardEvent.preserveFocus||selectionKeyboardEvent.preserveFocus,pinned="boolean"==typeof selectionKeyboardEvent.pinned?selectionKeyboardEvent.pinned:!preserveFocus;this._open(this.getSelectedElement(),preserveFocus,pinned,!1,event.browserEvent)}onPointer(element,browserEvent){if(!this.openOnSingleClick)return;if(2===browserEvent.detail)return;const pinned=1===browserEvent.button,sideBySide=browserEvent.ctrlKey||browserEvent.metaKey||browserEvent.altKey;this._open(element,!0,pinned,sideBySide,browserEvent)}onMouseDblClick(element,browserEvent){if(!browserEvent)return;const target=browserEvent.target;if(target.classList.contains("monaco-tl-twistie")||target.classList.contains("monaco-icon-label")&&target.classList.contains("folder-icon")&&browserEvent.offsetX<16)return;const sideBySide=browserEvent.ctrlKey||browserEvent.metaKey||browserEvent.altKey;this._open(element,!1,!0,sideBySide,browserEvent)}_open(element,preserveFocus,pinned,sideBySide,browserEvent){element&&this._onDidOpen.fire({editorOptions:{preserveFocus,pinned,revealIfVisible:!0},sideBySide,element,browserEvent})}}class ListResourceNavigator extends ResourceNavigator{constructor(widget,options){super(widget,options),this.widget=widget}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TableResourceNavigator extends ResourceNavigator{constructor(widget,options){super(widget,options)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TreeResourceNavigator extends ResourceNavigator{constructor(widget,options){super(widget,options)}getSelectedElement(){var _a;return null!==(_a=this.widget.getSelection()[0])&&void 0!==_a?_a:void 0}}function createKeyboardNavigationEventFilter(container,keybindingService){let inChord=!1;return event=>{if(event.toKeybinding().isModifierKey())return!1;if(inChord)return inChord=!1,!1;const result=keybindingService.softDispatch(event,container);return result&&result.enterChord?(inChord=!0,!1):(inChord=!1,!0)}}let WorkbenchObjectTree=class WorkbenchObjectTree extends objectTree_1.ObjectTree{constructor(user,container,delegate,renderers,options,contextKeyService,listService,themeService,configurationService,keybindingService,accessibilityService){const{options:treeOptions,getAutomaticKeyboardNavigation,disposable}=workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService);super(user,container,delegate,renderers,treeOptions),this.disposables.add(disposable),this.internals=new WorkbenchTreeInternals(this,options,getAutomaticKeyboardNavigation,options.overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService),this.disposables.add(this.internals)}updateOptions(options){super.updateOptions(options),this.internals.updateOptions(options)}};WorkbenchObjectTree=__decorate([__param(5,contextkey_1.IContextKeyService),__param(6,exports.IListService),__param(7,themeService_1.IThemeService),__param(8,configuration_1.IConfigurationService),__param(9,keybinding_1.IKeybindingService),__param(10,accessibility_1.IAccessibilityService)],WorkbenchObjectTree),exports.WorkbenchObjectTree=WorkbenchObjectTree;let WorkbenchCompressibleObjectTree=class WorkbenchCompressibleObjectTree extends objectTree_1.CompressibleObjectTree{constructor(user,container,delegate,renderers,options,contextKeyService,listService,themeService,configurationService,keybindingService,accessibilityService){const{options:treeOptions,getAutomaticKeyboardNavigation,disposable}=workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService);super(user,container,delegate,renderers,treeOptions),this.disposables.add(disposable),this.internals=new WorkbenchTreeInternals(this,options,getAutomaticKeyboardNavigation,options.overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService),this.disposables.add(this.internals)}updateOptions(options={}){super.updateOptions(options),options.overrideStyles&&this.internals.updateStyleOverrides(options.overrideStyles),this.internals.updateOptions(options)}};WorkbenchCompressibleObjectTree=__decorate([__param(5,contextkey_1.IContextKeyService),__param(6,exports.IListService),__param(7,themeService_1.IThemeService),__param(8,configuration_1.IConfigurationService),__param(9,keybinding_1.IKeybindingService),__param(10,accessibility_1.IAccessibilityService)],WorkbenchCompressibleObjectTree),exports.WorkbenchCompressibleObjectTree=WorkbenchCompressibleObjectTree;let WorkbenchDataTree=class WorkbenchDataTree extends dataTree_1.DataTree{constructor(user,container,delegate,renderers,dataSource,options,contextKeyService,listService,themeService,configurationService,keybindingService,accessibilityService){const{options:treeOptions,getAutomaticKeyboardNavigation,disposable}=workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService);super(user,container,delegate,renderers,dataSource,treeOptions),this.disposables.add(disposable),this.internals=new WorkbenchTreeInternals(this,options,getAutomaticKeyboardNavigation,options.overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService),this.disposables.add(this.internals)}updateOptions(options={}){super.updateOptions(options),options.overrideStyles&&this.internals.updateStyleOverrides(options.overrideStyles),this.internals.updateOptions(options)}};WorkbenchDataTree=__decorate([__param(6,contextkey_1.IContextKeyService),__param(7,exports.IListService),__param(8,themeService_1.IThemeService),__param(9,configuration_1.IConfigurationService),__param(10,keybinding_1.IKeybindingService),__param(11,accessibility_1.IAccessibilityService)],WorkbenchDataTree),exports.WorkbenchDataTree=WorkbenchDataTree;let WorkbenchAsyncDataTree=class WorkbenchAsyncDataTree extends asyncDataTree_1.AsyncDataTree{constructor(user,container,delegate,renderers,dataSource,options,contextKeyService,listService,themeService,configurationService,keybindingService,accessibilityService){const{options:treeOptions,getAutomaticKeyboardNavigation,disposable}=workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService);super(user,container,delegate,renderers,dataSource,treeOptions),this.disposables.add(disposable),this.internals=new WorkbenchTreeInternals(this,options,getAutomaticKeyboardNavigation,options.overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService),this.disposables.add(this.internals)}get onDidOpen(){return this.internals.onDidOpen}updateOptions(options={}){super.updateOptions(options),options.overrideStyles&&this.internals.updateStyleOverrides(options.overrideStyles),this.internals.updateOptions(options)}};WorkbenchAsyncDataTree=__decorate([__param(6,contextkey_1.IContextKeyService),__param(7,exports.IListService),__param(8,themeService_1.IThemeService),__param(9,configuration_1.IConfigurationService),__param(10,keybinding_1.IKeybindingService),__param(11,accessibility_1.IAccessibilityService)],WorkbenchAsyncDataTree),exports.WorkbenchAsyncDataTree=WorkbenchAsyncDataTree;let WorkbenchCompressibleAsyncDataTree=class WorkbenchCompressibleAsyncDataTree extends asyncDataTree_1.CompressibleAsyncDataTree{constructor(user,container,virtualDelegate,compressionDelegate,renderers,dataSource,options,contextKeyService,listService,themeService,configurationService,keybindingService,accessibilityService){const{options:treeOptions,getAutomaticKeyboardNavigation,disposable}=workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService);super(user,container,virtualDelegate,compressionDelegate,renderers,dataSource,treeOptions),this.disposables.add(disposable),this.internals=new WorkbenchTreeInternals(this,options,getAutomaticKeyboardNavigation,options.overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService),this.disposables.add(this.internals)}updateOptions(options){super.updateOptions(options),this.internals.updateOptions(options)}};function workbenchTreeDataPreamble(container,options,contextKeyService,configurationService,keybindingService,accessibilityService){var _a;const getAutomaticKeyboardNavigation=()=>{let automaticKeyboardNavigation=Boolean(contextKeyService.getContextKeyValue(exports.WorkbenchListAutomaticKeyboardNavigationKey));return automaticKeyboardNavigation&&(automaticKeyboardNavigation=Boolean(configurationService.getValue("workbench.list.automaticKeyboardNavigation"))),automaticKeyboardNavigation},accessibilityOn=accessibilityService.isScreenReaderOptimized(),keyboardNavigation=options.simpleKeyboardNavigation||accessibilityOn?"simple":configurationService.getValue("workbench.list.keyboardNavigation"),horizontalScrolling=void 0!==options.horizontalScrolling?options.horizontalScrolling:Boolean(configurationService.getValue(horizontalScrollingKey)),[workbenchListOptions,disposable]=toWorkbenchListOptions(options,configurationService,keybindingService),additionalScrollHeight=options.additionalScrollHeight;return{getAutomaticKeyboardNavigation,disposable,options:Object.assign(Object.assign({keyboardSupport:!1},workbenchListOptions),{indent:"number"==typeof configurationService.getValue(treeIndentKey)?configurationService.getValue(treeIndentKey):void 0,renderIndentGuides:configurationService.getValue("workbench.tree.renderIndentGuides"),smoothScrolling:Boolean(configurationService.getValue(listSmoothScrolling)),automaticKeyboardNavigation:getAutomaticKeyboardNavigation(),simpleKeyboardNavigation:"simple"===keyboardNavigation,filterOnType:"filter"===keyboardNavigation,horizontalScrolling,keyboardNavigationEventFilter:createKeyboardNavigationEventFilter(container,keybindingService),additionalScrollHeight,hideTwistiesOfChildlessElements:options.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:null!==(_a=options.expandOnlyOnTwistieClick)&&void 0!==_a?_a:"doubleClick"===configurationService.getValue(treeExpandMode)})}}WorkbenchCompressibleAsyncDataTree=__decorate([__param(7,contextkey_1.IContextKeyService),__param(8,exports.IListService),__param(9,themeService_1.IThemeService),__param(10,configuration_1.IConfigurationService),__param(11,keybinding_1.IKeybindingService),__param(12,accessibility_1.IAccessibilityService)],WorkbenchCompressibleAsyncDataTree),exports.WorkbenchCompressibleAsyncDataTree=WorkbenchCompressibleAsyncDataTree;let WorkbenchTreeInternals=class WorkbenchTreeInternals{constructor(tree,options,getAutomaticKeyboardNavigation,overrideStyles,contextKeyService,listService,themeService,configurationService,accessibilityService){this.tree=tree,this.themeService=themeService,this.disposables=[],this.contextKeyService=createScopedContextKeyService(contextKeyService,tree),this.listSupportsMultiSelect=exports.WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==options.multipleSelectionSupport);exports.WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(options.selectionNavigation)),this.hasSelectionOrFocus=exports.WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.hasDoubleSelection=exports.WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.hasMultiSelection=exports.WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.treeElementCanCollapse=exports.WorkbenchTreeElementCanCollapse.bindTo(this.contextKeyService),this.treeElementHasParent=exports.WorkbenchTreeElementHasParent.bindTo(this.contextKeyService),this.treeElementCanExpand=exports.WorkbenchTreeElementCanExpand.bindTo(this.contextKeyService),this.treeElementHasChild=exports.WorkbenchTreeElementHasChild.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService);const interestingContextKeys=new Set;interestingContextKeys.add(exports.WorkbenchListAutomaticKeyboardNavigationKey);const updateKeyboardNavigation=()=>{const keyboardNavigation=accessibilityService.isScreenReaderOptimized()?"simple":configurationService.getValue("workbench.list.keyboardNavigation");tree.updateOptions({simpleKeyboardNavigation:"simple"===keyboardNavigation,filterOnType:"filter"===keyboardNavigation})};this.updateStyleOverrides(overrideStyles);const updateCollapseContextKeys=()=>{const focus=tree.getFocus()[0];if(!focus)return;const node=tree.getNode(focus);this.treeElementCanCollapse.set(node.collapsible&&!node.collapsed),this.treeElementHasParent.set(!!tree.getParentElement(focus)),this.treeElementCanExpand.set(node.collapsible&&node.collapsed),this.treeElementHasChild.set(!!tree.getFirstElementChild(focus))};this.disposables.push(this.contextKeyService,listService.register(tree),tree.onDidChangeSelection((()=>{const selection=tree.getSelection(),focus=tree.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.hasSelectionOrFocus.set(selection.length>0||focus.length>0),this.hasMultiSelection.set(selection.length>1),this.hasDoubleSelection.set(2===selection.length)}))})),tree.onDidChangeFocus((()=>{const selection=tree.getSelection(),focus=tree.getFocus();this.hasSelectionOrFocus.set(selection.length>0||focus.length>0),updateCollapseContextKeys()})),tree.onDidChangeCollapseState(updateCollapseContextKeys),tree.onDidChangeModel(updateCollapseContextKeys),configurationService.onDidChangeConfiguration((e=>{let newOptions={};if(e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(configurationService)),e.affectsConfiguration(treeIndentKey)){const indent=configurationService.getValue(treeIndentKey);newOptions=Object.assign(Object.assign({},newOptions),{indent})}if(e.affectsConfiguration("workbench.tree.renderIndentGuides")){const renderIndentGuides=configurationService.getValue("workbench.tree.renderIndentGuides");newOptions=Object.assign(Object.assign({},newOptions),{renderIndentGuides})}if(e.affectsConfiguration(listSmoothScrolling)){const smoothScrolling=Boolean(configurationService.getValue(listSmoothScrolling));newOptions=Object.assign(Object.assign({},newOptions),{smoothScrolling})}if(e.affectsConfiguration("workbench.list.keyboardNavigation")&&updateKeyboardNavigation(),e.affectsConfiguration("workbench.list.automaticKeyboardNavigation")&&(newOptions=Object.assign(Object.assign({},newOptions),{automaticKeyboardNavigation:getAutomaticKeyboardNavigation()})),e.affectsConfiguration(horizontalScrollingKey)&&void 0===options.horizontalScrolling){const horizontalScrolling=Boolean(configurationService.getValue(horizontalScrollingKey));newOptions=Object.assign(Object.assign({},newOptions),{horizontalScrolling})}if(e.affectsConfiguration(treeExpandMode)&&void 0===options.expandOnlyOnTwistieClick&&(newOptions=Object.assign(Object.assign({},newOptions),{expandOnlyOnTwistieClick:"doubleClick"===configurationService.getValue(treeExpandMode)})),e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const mouseWheelScrollSensitivity=configurationService.getValue(mouseWheelScrollSensitivityKey);newOptions=Object.assign(Object.assign({},newOptions),{mouseWheelScrollSensitivity})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const fastScrollSensitivity=configurationService.getValue(fastScrollSensitivityKey);newOptions=Object.assign(Object.assign({},newOptions),{fastScrollSensitivity})}Object.keys(newOptions).length>0&&tree.updateOptions(newOptions)})),this.contextKeyService.onDidChangeContext((e=>{e.affectsSome(interestingContextKeys)&&tree.updateOptions({automaticKeyboardNavigation:getAutomaticKeyboardNavigation()})})),accessibilityService.onDidChangeScreenReaderOptimized((()=>updateKeyboardNavigation()))),this.navigator=new TreeResourceNavigator(tree,Object.assign({configurationService},options)),this.disposables.push(this.navigator)}get onDidOpen(){return this.navigator.onDidOpen}updateOptions(options){void 0!==options.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!options.multipleSelectionSupport)}updateStyleOverrides(overrideStyles){(0,lifecycle_1.dispose)(this.styler),this.styler=overrideStyles?(0,styler_1.attachListStyler)(this.tree,this.themeService,overrideStyles):lifecycle_1.Disposable.None}dispose(){this.disposables=(0,lifecycle_1.dispose)(this.disposables),(0,lifecycle_1.dispose)(this.styler),this.styler=void 0}};WorkbenchTreeInternals=__decorate([__param(4,contextkey_1.IContextKeyService),__param(5,exports.IListService),__param(6,themeService_1.IThemeService),__param(7,configuration_1.IConfigurationService),__param(8,accessibility_1.IAccessibilityService)],WorkbenchTreeInternals);platform_1.Registry.as(configurationRegistry_1.Extensions.Configuration).registerConfiguration({id:"workbench",order:7,title:(0,nls_1.localize)(0,null),type:"object",properties:{"workbench.list.multiSelectModifier":{type:"string",enum:["ctrlCmd","alt"],enumDescriptions:[(0,nls_1.localize)(1,null),(0,nls_1.localize)(2,null)],default:"ctrlCmd",description:(0,nls_1.localize)(3,null)},"workbench.list.openMode":{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:(0,nls_1.localize)(4,null)},[horizontalScrollingKey]:{type:"boolean",default:!1,description:(0,nls_1.localize)(5,null)},[treeIndentKey]:{type:"number",default:8,minimum:4,maximum:40,description:(0,nls_1.localize)(6,null)},"workbench.tree.renderIndentGuides":{type:"string",enum:["none","onHover","always"],default:"onHover",description:(0,nls_1.localize)(7,null)},[listSmoothScrolling]:{type:"boolean",default:!1,description:(0,nls_1.localize)(8,null)},[mouseWheelScrollSensitivityKey]:{type:"number",default:1,description:(0,nls_1.localize)(9,null)},[fastScrollSensitivityKey]:{type:"number",default:5,description:(0,nls_1.localize)(10,null)},"workbench.list.keyboardNavigation":{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[(0,nls_1.localize)(11,null),(0,nls_1.localize)(12,null),(0,nls_1.localize)(13,null)],default:"highlight",description:(0,nls_1.localize)(14,null)},"workbench.list.automaticKeyboardNavigation":{type:"boolean",default:!0,markdownDescription:(0,nls_1.localize)(15,null)},[treeExpandMode]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:(0,nls_1.localize)(16,null)}}})})),define(__m[704],__M([1,0,7,92,44,60,4,2,53,23,14]),(function(require,exports,dom_1,event_1,keyboardEvent_1,touch_1,event_2,lifecycle_1,opener_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Link=void 0;let Link=class Link extends lifecycle_1.Disposable{constructor(container,_link,options={},openerService){var _a;super(),this._link=_link,this._enabled=!0,this.el=(0,dom_1.append)(container,(0,dom_1.$)("a.monaco-link",{tabIndex:null!==(_a=_link.tabIndex)&&void 0!==_a?_a:0,href:_link.href,title:_link.title},_link.label)),this.el.setAttribute("role","button");const onClickEmitter=this._register(new event_1.DomEmitter(this.el,"click")),onKeyPress=this._register(new event_1.DomEmitter(this.el,"keypress")),onEnterPress=event_2.Event.chain(onKeyPress.event).map((e=>new keyboardEvent_1.StandardKeyboardEvent(e))).filter((e=>3===e.keyCode)).event,onTap=this._register(new event_1.DomEmitter(this.el,touch_1.EventType.Tap)).event;this._register(touch_1.Gesture.addTarget(this.el));const onOpen=event_2.Event.any(onClickEmitter.event,onEnterPress,onTap);this._register(onOpen((e=>{this.enabled&&(dom_1.EventHelper.stop(e,!0),(null==options?void 0:options.opener)?options.opener(this._link.href):openerService.open(this._link.href,{allowCommands:!0}))}))),this.enabled=!0}get enabled(){return this._enabled}set enabled(enabled){enabled?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=enabled}};Link=__decorate([__param(3,opener_1.IOpenerService)],Link),exports.Link=Link,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const textLinkForegroundColor=theme.getColor(colorRegistry_1.textLinkForeground);textLinkForegroundColor&&collector.addRule(`.monaco-link { color: ${textLinkForegroundColor}; }`);const textLinkActiveForegroundColor=theme.getColor(colorRegistry_1.textLinkActiveForeground);textLinkActiveForegroundColor&&collector.addRule(`.monaco-link:hover { color: ${textLinkActiveForegroundColor}; }`)}))})),define(__m[705],__M([1,0,21,503,65,17,9,132,161,638,23,134,14]),(function(require,exports,cancellation_1,quickInput_1,accessibility_1,contextkey_1,instantiation_1,layoutService_1,listService_1,quickAccess_1,colorRegistry_1,styler_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickInputService=void 0;let QuickInputService=class QuickInputService extends themeService_1.Themable{constructor(instantiationService,contextKeyService,themeService,accessibilityService,layoutService){super(themeService),this.instantiationService=instantiationService,this.contextKeyService=contextKeyService,this.accessibilityService=accessibilityService,this.layoutService=layoutService,this.contexts=new Map}get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(quickAccess_1.QuickAccessController))),this._quickAccess}createController(host=this.layoutService,options){var _a,_b;const defaultOptions={idPrefix:"quickInput_",container:host.container,ignoreFocusOut:()=>!1,isScreenReaderOptimized:()=>this.accessibilityService.isScreenReaderOptimized(),backKeybindingLabel:()=>{},setContextKey:id=>this.setContextKey(id),returnFocus:()=>host.focus(),createList:(user,container,delegate,renderers,options)=>this.instantiationService.createInstance(listService_1.WorkbenchList,user,container,delegate,renderers,options),styles:this.computeStyles()},controller=this._register(new quickInput_1.QuickInputController(Object.assign(Object.assign({},defaultOptions),options)));return controller.layout(host.dimension,null!==(_b=null===(_a=host.offset)||void 0===_a?void 0:_a.top)&&void 0!==_b?_b:0),this._register(host.onDidLayout((dimension=>{var _a,_b;return controller.layout(dimension,null!==(_b=null===(_a=host.offset)||void 0===_a?void 0:_a.top)&&void 0!==_b?_b:0)}))),this._register(controller.onShow((()=>this.resetContextKeys()))),this._register(controller.onHide((()=>this.resetContextKeys()))),controller}setContextKey(id){let key;id&&(key=this.contexts.get(id),key||(key=new contextkey_1.RawContextKey(id,!1).bindTo(this.contextKeyService),this.contexts.set(id,key))),key&&key.get()||(this.resetContextKeys(),key&&key.set(!0))}resetContextKeys(){this.contexts.forEach((context=>{context.get()&&context.reset()}))}pick(picks,options={},token=cancellation_1.CancellationToken.None){return this.controller.pick(picks,options,token)}createQuickPick(){return this.controller.createQuickPick()}updateStyles(){this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:Object.assign({},(0,styler_1.computeStyles)(this.theme,{quickInputBackground:colorRegistry_1.quickInputBackground,quickInputForeground:colorRegistry_1.quickInputForeground,quickInputTitleBackground:colorRegistry_1.quickInputTitleBackground,contrastBorder:colorRegistry_1.contrastBorder,widgetShadow:colorRegistry_1.widgetShadow})),inputBox:(0,styler_1.computeStyles)(this.theme,{inputForeground:colorRegistry_1.inputForeground,inputBackground:colorRegistry_1.inputBackground,inputBorder:colorRegistry_1.inputBorder,inputValidationInfoBackground:colorRegistry_1.inputValidationInfoBackground,inputValidationInfoForeground:colorRegistry_1.inputValidationInfoForeground,inputValidationInfoBorder:colorRegistry_1.inputValidationInfoBorder,inputValidationWarningBackground:colorRegistry_1.inputValidationWarningBackground,inputValidationWarningForeground:colorRegistry_1.inputValidationWarningForeground,inputValidationWarningBorder:colorRegistry_1.inputValidationWarningBorder,inputValidationErrorBackground:colorRegistry_1.inputValidationErrorBackground,inputValidationErrorForeground:colorRegistry_1.inputValidationErrorForeground,inputValidationErrorBorder:colorRegistry_1.inputValidationErrorBorder}),countBadge:(0,styler_1.computeStyles)(this.theme,{badgeBackground:colorRegistry_1.badgeBackground,badgeForeground:colorRegistry_1.badgeForeground,badgeBorder:colorRegistry_1.contrastBorder}),button:(0,styler_1.computeStyles)(this.theme,{buttonForeground:colorRegistry_1.buttonForeground,buttonBackground:colorRegistry_1.buttonBackground,buttonHoverBackground:colorRegistry_1.buttonHoverBackground,buttonBorder:colorRegistry_1.contrastBorder}),progressBar:(0,styler_1.computeStyles)(this.theme,{progressBarBackground:colorRegistry_1.progressBarBackground}),keybindingLabel:(0,styler_1.computeStyles)(this.theme,{keybindingLabelBackground:colorRegistry_1.keybindingLabelBackground,keybindingLabelForeground:colorRegistry_1.keybindingLabelForeground,keybindingLabelBorder:colorRegistry_1.keybindingLabelBorder,keybindingLabelBottomBorder:colorRegistry_1.keybindingLabelBottomBorder,keybindingLabelShadow:colorRegistry_1.widgetShadow}),list:(0,styler_1.computeStyles)(this.theme,{listBackground:colorRegistry_1.quickInputBackground,listInactiveFocusForeground:colorRegistry_1.quickInputListFocusForeground,listInactiveSelectionIconForeground:colorRegistry_1.quickInputListFocusIconForeground,listInactiveFocusBackground:colorRegistry_1.quickInputListFocusBackground,listFocusOutline:colorRegistry_1.activeContrastBorder,listInactiveFocusOutline:colorRegistry_1.activeContrastBorder,pickerGroupBorder:colorRegistry_1.pickerGroupBorder,pickerGroupForeground:colorRegistry_1.pickerGroupForeground})}}};QuickInputService=__decorate([__param(0,instantiation_1.IInstantiationService),__param(1,contextkey_1.IContextKeyService),__param(2,themeService_1.IThemeService),__param(3,accessibility_1.IAccessibilityService),__param(4,layoutService_1.ILayoutService)],QuickInputService),exports.QuickInputService=QuickInputService})),define(__m[706],__M([1,0,15,14,21,9,17,65,280,29,705,91,396]),(function(require,exports,editorExtensions_1,themeService_1,cancellation_1,instantiation_1,contextkey_1,accessibility_1,standaloneLayoutService_1,codeEditorService_1,quickInput_1,functional_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuickInputEditorWidget=exports.QuickInputEditorContribution=exports.StandaloneQuickInputService=exports.EditorScopedQuickInputService=void 0;let EditorScopedQuickInputService=class EditorScopedQuickInputService extends quickInput_1.QuickInputService{constructor(editor,instantiationService,contextKeyService,themeService,accessibilityService,codeEditorService){super(instantiationService,contextKeyService,themeService,accessibilityService,new standaloneLayoutService_1.EditorScopedLayoutService(editor.getContainerDomNode(),codeEditorService)),this.host=void 0;const contribution=QuickInputEditorContribution.get(editor);if(contribution){const widget=contribution.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return widget.getDomNode()},get dimension(){return editor.getLayoutInfo()},get onDidLayout(){return editor.onDidLayoutChange},focus:()=>editor.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};EditorScopedQuickInputService=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,contextkey_1.IContextKeyService),__param(3,themeService_1.IThemeService),__param(4,accessibility_1.IAccessibilityService),__param(5,codeEditorService_1.ICodeEditorService)],EditorScopedQuickInputService),exports.EditorScopedQuickInputService=EditorScopedQuickInputService;let StandaloneQuickInputService=class StandaloneQuickInputService{constructor(instantiationService,codeEditorService){this.instantiationService=instantiationService,this.codeEditorService=codeEditorService,this.mapEditorToService=new Map}get activeService(){const editor=this.codeEditorService.getFocusedCodeEditor();if(!editor)throw new Error("Quick input service needs a focused editor to work.");let quickInputService=this.mapEditorToService.get(editor);if(!quickInputService){const newQuickInputService=quickInputService=this.instantiationService.createInstance(EditorScopedQuickInputService,editor);this.mapEditorToService.set(editor,quickInputService),(0,functional_1.once)(editor.onDidDispose)((()=>{newQuickInputService.dispose(),this.mapEditorToService.delete(editor)}))}return quickInputService}get quickAccess(){return this.activeService.quickAccess}pick(picks,options={},token=cancellation_1.CancellationToken.None){return this.activeService.pick(picks,options,token)}createQuickPick(){return this.activeService.createQuickPick()}};StandaloneQuickInputService=__decorate([__param(0,instantiation_1.IInstantiationService),__param(1,codeEditorService_1.ICodeEditorService)],StandaloneQuickInputService),exports.StandaloneQuickInputService=StandaloneQuickInputService;class QuickInputEditorContribution{constructor(editor){this.editor=editor,this.widget=new QuickInputEditorWidget(this.editor)}static get(editor){return editor.getContribution(QuickInputEditorContribution.ID)}dispose(){this.widget.dispose()}}exports.QuickInputEditorContribution=QuickInputEditorContribution,QuickInputEditorContribution.ID="editor.controller.quickInput";class QuickInputEditorWidget{constructor(codeEditor){this.codeEditor=codeEditor,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return QuickInputEditorWidget.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}exports.QuickInputEditorWidget=QuickInputEditorWidget,QuickInputEditorWidget.ID="editor.contrib.quickInputWidget",(0,editorExtensions_1.registerEditorContribution)(QuickInputEditorContribution.ID,QuickInputEditorContribution)})),define(__m[707],__M([1,0,28,76,23,14]),(function(require,exports,codicons_1,severity_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SeverityIcon=void 0,function(SeverityIcon){SeverityIcon.className=function className(severity){switch(severity){case severity_1.default.Ignore:return"severity-ignore "+codicons_1.Codicon.info.classNames;case severity_1.default.Info:return codicons_1.Codicon.info.classNames;case severity_1.default.Warning:return codicons_1.Codicon.warning.classNames;case severity_1.default.Error:return codicons_1.Codicon.error.classNames;default:return""}}}(exports.SeverityIcon||(exports.SeverityIcon={})),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const errorIconForeground=theme.getColor(colorRegistry_1.problemsErrorIconForeground);if(errorIconForeground){const errorCodiconSelector=codicons_1.Codicon.error.cssSelector;collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${errorCodiconSelector},\n\t\t\t.markers-panel .marker-icon${errorCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${errorCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${errorCodiconSelector} {\n\t\t\t\tcolor: ${errorIconForeground};\n\t\t\t}\n\t\t`)}const warningIconForeground=theme.getColor(colorRegistry_1.problemsWarningIconForeground);if(warningIconForeground){const warningCodiconSelector=codicons_1.Codicon.warning.cssSelector;collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${warningCodiconSelector},\n\t\t\t.markers-panel .marker-icon${warningCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${warningCodiconSelector},\n\t\t\t.extension-editor ${warningCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${warningCodiconSelector},\n\t\t\t.preferences-editor ${warningCodiconSelector} {\n\t\t\t\tcolor: ${warningIconForeground};\n\t\t\t}\n\t\t`)}const infoIconForeground=theme.getColor(colorRegistry_1.problemsInfoIconForeground);if(infoIconForeground){const infoCodiconSelector=codicons_1.Codicon.info.cssSelector;collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${infoCodiconSelector},\n\t\t\t.markers-panel .marker-icon${infoCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${infoCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${infoCodiconSelector},\n\t\t\t.extension-editor ${infoCodiconSelector} {\n\t\t\t\tcolor: ${infoIconForeground};\n\t\t\t}\n\t\t`)}}))})),define(__m[74],__M([1,0,10,28,4,600,206,36,14]),(function(require,exports,async_1,codicons_1,event_1,nls_1,jsonContributionRegistry_1,platform,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.spinningLoading=exports.syncing=exports.gotoNextLocation=exports.gotoPreviousLocation=exports.widgetClose=exports.iconsSchemaId=exports.getIconRegistry=exports.registerIcon=exports.IconContribution=exports.Extensions=void 0,exports.Extensions={IconContribution:"base.contributions.icons"},function(IconContribution){IconContribution.getDefinition=function getDefinition(contribution,registry){let definition=contribution.defaults;for(;themeService_1.ThemeIcon.isThemeIcon(definition);){const c=iconRegistry.getIcon(definition.id);if(!c)return;definition=c.defaults}return definition}}(exports.IconContribution||(exports.IconContribution={}));const iconRegistry=new class IconRegistry{constructor(){this._onDidChange=new event_1.Emitter,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:(0,nls_1.localize)(0,null)},fontCharacter:{type:"string",description:(0,nls_1.localize)(1,null)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${codicons_1.CSSIcon.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(id,defaults,description,deprecationMessage){const existing=this.iconsById[id];if(existing){if(description&&!existing.description){existing.description=description,this.iconSchema.properties[id].markdownDescription=`${description} $(${id})`;const enumIndex=this.iconReferenceSchema.enum.indexOf(id);-1!==enumIndex&&(this.iconReferenceSchema.enumDescriptions[enumIndex]=description),this._onDidChange.fire()}return existing}let iconContribution={id,description,defaults,deprecationMessage};this.iconsById[id]=iconContribution;let propertySchema={$ref:"#/definitions/icons"};return deprecationMessage&&(propertySchema.deprecationMessage=deprecationMessage),description&&(propertySchema.markdownDescription=`${description}: $(${id})`),this.iconSchema.properties[id]=propertySchema,this.iconReferenceSchema.enum.push(id),this.iconReferenceSchema.enumDescriptions.push(description||""),this._onDidChange.fire(),{id}}getIcons(){return Object.keys(this.iconsById).map((id=>this.iconsById[id]))}getIcon(id){return this.iconsById[id]}getIconSchema(){return this.iconSchema}toString(){const sorter=(i1,i2)=>i1.id.localeCompare(i2.id),classNames=i=>{for(;themeService_1.ThemeIcon.isThemeIcon(i.defaults);)i=this.iconsById[i.defaults.id];return`codicon codicon-${i?i.id:""}`};let reference=[];reference.push("| preview     | identifier                        | default codicon ID                | description"),reference.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const contributions=Object.keys(this.iconsById).map((key=>this.iconsById[key]));for(const i of contributions.filter((i=>!!i.description)).sort(sorter))reference.push(`|<i class="${classNames(i)}"></i>|${i.id}|${themeService_1.ThemeIcon.isThemeIcon(i.defaults)?i.defaults.id:i.id}|${i.description||""}|`);reference.push("| preview     | identifier                        "),reference.push("| ----------- | --------------------------------- |");for(const i of contributions.filter((i=>!themeService_1.ThemeIcon.isThemeIcon(i.defaults))).sort(sorter))reference.push(`|<i class="${classNames(i)}"></i>|${i.id}|`);return reference.join("\n")}};function registerIcon(id,defaults,description,deprecationMessage){return iconRegistry.registerIcon(id,defaults,description,deprecationMessage)}platform.Registry.add(exports.Extensions.IconContribution,iconRegistry),exports.registerIcon=registerIcon,exports.getIconRegistry=function getIconRegistry(){return iconRegistry},function initialize(){for(const icon of codicons_1.Codicon.getAll())iconRegistry.registerIcon(icon.id,icon.definition,icon.description)}(),exports.iconsSchemaId="vscode://schemas/icons";let schemaRegistry=platform.Registry.as(jsonContributionRegistry_1.Extensions.JSONContribution);schemaRegistry.registerSchema(exports.iconsSchemaId,iconRegistry.getIconSchema());const delayer=new async_1.RunOnceScheduler((()=>schemaRegistry.notifySchemaChanged(exports.iconsSchemaId)),200);iconRegistry.onDidChange((()=>{delayer.isScheduled()||delayer.schedule()})),exports.widgetClose=registerIcon("widget-close",codicons_1.Codicon.close,(0,nls_1.localize)(2,null)),exports.gotoPreviousLocation=registerIcon("goto-previous-location",codicons_1.Codicon.arrowUp,(0,nls_1.localize)(3,null)),exports.gotoNextLocation=registerIcon("goto-next-location",codicons_1.Codicon.arrowDown,(0,nls_1.localize)(4,null)),exports.syncing=themeService_1.ThemeIcon.modify(codicons_1.Codicon.sync,"spin"),exports.spinningLoading=themeService_1.ThemeIcon.modify(codicons_1.Codicon.loading,"spin")})),define(__m[708],__M([1,0,509,7,31,87,69,47,2,64,15,29,32,77,11,54,126,71,17,23,14,28,74,35,369]),(function(require,exports,nls,dom,fastDomNode_1,actionbar_1,scrollableElement_1,actions_1,lifecycle_1,domFontInfo_1,editorExtensions_1,codeEditorService_1,editorOptions_1,lineTokens_1,position_1,editorColorRegistry_1,viewLineRenderer_1,viewModel_1,contextkey_1,colorRegistry_1,themeService_1,codicons_1,iconRegistry_1,language_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DiffReview=void 0;class DiffEntry{constructor(originalLineStart,originalLineEnd,modifiedLineStart,modifiedLineEnd){this.originalLineStart=originalLineStart,this.originalLineEnd=originalLineEnd,this.modifiedLineStart=modifiedLineStart,this.modifiedLineEnd=modifiedLineEnd}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class Diff{constructor(entries){this.entries=entries}}const diffReviewInsertIcon=(0,iconRegistry_1.registerIcon)("diff-review-insert",codicons_1.Codicon.add,nls.localize(0,null)),diffReviewRemoveIcon=(0,iconRegistry_1.registerIcon)("diff-review-remove",codicons_1.Codicon.remove,nls.localize(1,null)),diffReviewCloseIcon=(0,iconRegistry_1.registerIcon)("diff-review-close",codicons_1.Codicon.close,nls.localize(2,null));let DiffReview=class DiffReview extends lifecycle_1.Disposable{constructor(diffEditor,_languageService){super(),this._languageService=_languageService,this._width=0,this._diffEditor=diffEditor,this._isVisible=!1,this.shadow=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new actionbar_1.ActionBar(this.actionBarContainer.domNode)),this._actionBar.push(new actions_1.Action("diffreview.close",nls.localize(3,null),"close-diff-review "+themeService_1.ThemeIcon.asClassName(diffReviewCloseIcon),!0,(()=>__awaiter(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new scrollableElement_1.DomScrollableElement(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(diffEditor.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(diffEditor.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(dom.addStandardDisposableListener(this.domNode.domNode,"click",(e=>{e.preventDefault();const row=dom.findParentWithClass(e.target,"diff-review-row");row&&this._goToRow(row)}))),this._register(dom.addStandardDisposableListener(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow())),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow())),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this.hide()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._diffs=[],this._currentDiff=null}prev(){let index=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let currentIndex=-1;for(let i=0,len=this._diffs.length;i<len;i++)if(this._diffs[i]===this._currentDiff){currentIndex=i;break}index=this._diffs.length+currentIndex-1}else index=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;index%=this._diffs.length;const entries=this._diffs[index].entries;this._diffEditor.setPosition(new position_1.Position(entries[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:entries[0].modifiedLineStart,endColumn:1073741824,endLineNumber:entries[entries.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}next(){let index=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let currentIndex=-1;for(let i=0,len=this._diffs.length;i<len;i++)if(this._diffs[i]===this._currentDiff){currentIndex=i;break}index=currentIndex+1}else index=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;index%=this._diffs.length;const entries=this._diffs[index].entries;this._diffEditor.setPosition(new position_1.Position(entries[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:entries[0].modifiedLineStart,endColumn:1073741824,endLineNumber:entries[entries.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}accept(){let jumpToLineNumber=-1;const current=this._getCurrentFocusedRow();if(current){const lineNumber=parseInt(current.getAttribute("data-line"),10);isNaN(lineNumber)||(jumpToLineNumber=lineNumber)}this.hide(),-1!==jumpToLineNumber&&(this._diffEditor.setPosition(new position_1.Position(jumpToLineNumber,1)),this._diffEditor.revealPosition(new position_1.Position(jumpToLineNumber,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const current=this._getCurrentFocusedRow();return current?current.previousElementSibling?current.previousElementSibling:current:this._getFirstRow()}_getNextRow(){const current=this._getCurrentFocusedRow();return current?current.nextElementSibling?current.nextElementSibling:current:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const result=document.activeElement;return result&&/diff-review-row/.test(result.className)?result:null}_goToRow(row){const prev=this._getCurrentFocusedRow();row.tabIndex=0,row.focus(),prev&&prev!==row&&(prev.tabIndex=-1),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(top,width,height){this._width=width,this.shadow.setTop(top-6),this.shadow.setWidth(width),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(top),this.domNode.setWidth(width),this.domNode.setHeight(height),this._content.setHeight(height),this._content.setWidth(width),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const lineChanges=this._diffEditor.getLineChanges();if(!lineChanges||0===lineChanges.length)return[];const originalModel=this._diffEditor.getOriginalEditor().getModel(),modifiedModel=this._diffEditor.getModifiedEditor().getModel();return originalModel&&modifiedModel?DiffReview._mergeAdjacent(lineChanges,originalModel.getLineCount(),modifiedModel.getLineCount()):[]}static _mergeAdjacent(lineChanges,originalLineCount,modifiedLineCount){if(!lineChanges||0===lineChanges.length)return[];const diffs=[];let diffsLength=0;for(let i=0,len=lineChanges.length;i<len;i++){const lineChange=lineChanges[i],originalStart=lineChange.originalStartLineNumber,originalEnd=lineChange.originalEndLineNumber,modifiedStart=lineChange.modifiedStartLineNumber,modifiedEnd=lineChange.modifiedEndLineNumber,r=[];let rLength=0;{const originalEqualAbove=0===originalEnd?originalStart:originalStart-1,modifiedEqualAbove=0===modifiedEnd?modifiedStart:modifiedStart-1;let minOriginal=1,minModified=1;if(i>0){const prevLineChange=lineChanges[i-1];minOriginal=0===prevLineChange.originalEndLineNumber?prevLineChange.originalStartLineNumber+1:prevLineChange.originalEndLineNumber+1,minModified=0===prevLineChange.modifiedEndLineNumber?prevLineChange.modifiedStartLineNumber+1:prevLineChange.modifiedEndLineNumber+1}let fromOriginal=originalEqualAbove-3+1,fromModified=modifiedEqualAbove-3+1;if(fromOriginal<minOriginal){const delta=minOriginal-fromOriginal;fromOriginal+=delta,fromModified+=delta}if(fromModified<minModified){const delta=minModified-fromModified;fromOriginal+=delta,fromModified+=delta}r[rLength++]=new DiffEntry(fromOriginal,originalEqualAbove,fromModified,modifiedEqualAbove)}0!==originalEnd&&(r[rLength++]=new DiffEntry(originalStart,originalEnd,0,0)),0!==modifiedEnd&&(r[rLength++]=new DiffEntry(0,0,modifiedStart,modifiedEnd));{const originalEqualBelow=0===originalEnd?originalStart+1:originalEnd+1,modifiedEqualBelow=0===modifiedEnd?modifiedStart+1:modifiedEnd+1;let maxOriginal=originalLineCount,maxModified=modifiedLineCount;if(i+1<len){const nextLineChange=lineChanges[i+1];maxOriginal=0===nextLineChange.originalEndLineNumber?nextLineChange.originalStartLineNumber:nextLineChange.originalStartLineNumber-1,maxModified=0===nextLineChange.modifiedEndLineNumber?nextLineChange.modifiedStartLineNumber:nextLineChange.modifiedStartLineNumber-1}let toOriginal=originalEqualBelow+3-1,toModified=modifiedEqualBelow+3-1;if(toOriginal>maxOriginal){const delta=maxOriginal-toOriginal;toOriginal+=delta,toModified+=delta}if(toModified>maxModified){const delta=maxModified-toModified;toOriginal+=delta,toModified+=delta}r[rLength++]=new DiffEntry(originalEqualBelow,toOriginal,modifiedEqualBelow,toModified)}diffs[diffsLength++]=new Diff(r)}let curr=diffs[0].entries;const r=[];let rLength=0;for(let i=1,len=diffs.length;i<len;i++){const thisDiff=diffs[i].entries,currLast=curr[curr.length-1],thisFirst=thisDiff[0];0===currLast.getType()&&0===thisFirst.getType()&&thisFirst.originalLineStart<=currLast.originalLineEnd?(curr[curr.length-1]=new DiffEntry(currLast.originalLineStart,thisFirst.originalLineEnd,currLast.modifiedLineStart,thisFirst.modifiedLineEnd),curr=curr.concat(thisDiff.slice(1))):(r[rLength++]=new Diff(curr),curr=thisDiff)}return r[rLength++]=new Diff(curr),r}_findDiffIndex(pos){const lineNumber=pos.lineNumber;for(let i=0,len=this._diffs.length;i<len;i++){const diff=this._diffs[i].entries;if(lineNumber<=diff[diff.length-1].modifiedLineEnd)return i}return 0}_render(){const originalOptions=this._diffEditor.getOriginalEditor().getOptions(),modifiedOptions=this._diffEditor.getModifiedEditor().getOptions(),originalModel=this._diffEditor.getOriginalEditor().getModel(),modifiedModel=this._diffEditor.getModifiedEditor().getModel(),originalModelOpts=originalModel.getOptions(),modifiedModelOpts=modifiedModel.getOptions();if(!this._isVisible||!originalModel||!modifiedModel)return dom.clearNode(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const diffIndex=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[diffIndex]===this._currentDiff)return;this._currentDiff=this._diffs[diffIndex];const diffs=this._diffs[diffIndex].entries,container=document.createElement("div");container.className="diff-review-table",container.setAttribute("role","list"),container.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,domFontInfo_1.applyFontInfo)(container,modifiedOptions.get(44));let minOriginalLine=0,maxOriginalLine=0,minModifiedLine=0,maxModifiedLine=0;for(let i=0,len=diffs.length;i<len;i++){const diffEntry=diffs[i],originalLineStart=diffEntry.originalLineStart,originalLineEnd=diffEntry.originalLineEnd,modifiedLineStart=diffEntry.modifiedLineStart,modifiedLineEnd=diffEntry.modifiedLineEnd;0!==originalLineStart&&(0===minOriginalLine||originalLineStart<minOriginalLine)&&(minOriginalLine=originalLineStart),0!==originalLineEnd&&(0===maxOriginalLine||originalLineEnd>maxOriginalLine)&&(maxOriginalLine=originalLineEnd),0!==modifiedLineStart&&(0===minModifiedLine||modifiedLineStart<minModifiedLine)&&(minModifiedLine=modifiedLineStart),0!==modifiedLineEnd&&(0===maxModifiedLine||modifiedLineEnd>maxModifiedLine)&&(maxModifiedLine=modifiedLineEnd)}const header=document.createElement("div");header.className="diff-review-row";const cell=document.createElement("div");cell.className="diff-review-cell diff-review-summary";const originalChangedLinesCnt=maxOriginalLine-minOriginalLine+1,modifiedChangedLinesCnt=maxModifiedLine-minModifiedLine+1;cell.appendChild(document.createTextNode(`${diffIndex+1}/${this._diffs.length}: @@ -${minOriginalLine},${originalChangedLinesCnt} +${minModifiedLine},${modifiedChangedLinesCnt} @@`)),header.setAttribute("data-line",String(minModifiedLine));const getAriaLines=lines=>0===lines?nls.localize(4,null):1===lines?nls.localize(5,null):nls.localize(6,null,lines),originalChangedLinesCntAria=getAriaLines(originalChangedLinesCnt),modifiedChangedLinesCntAria=getAriaLines(modifiedChangedLinesCnt);header.setAttribute("aria-label",nls.localize(7,null,diffIndex+1,this._diffs.length,minOriginalLine,originalChangedLinesCntAria,minModifiedLine,modifiedChangedLinesCntAria)),header.appendChild(cell),header.setAttribute("role","listitem"),container.appendChild(header);const lineHeight=modifiedOptions.get(59);let modLine=minModifiedLine;for(let i=0,len=diffs.length;i<len;i++){const diffEntry=diffs[i];DiffReview._renderSection(container,diffEntry,modLine,lineHeight,this._width,originalOptions,originalModel,originalModelOpts,modifiedOptions,modifiedModel,modifiedModelOpts,this._languageService.languageIdCodec),0!==diffEntry.modifiedLineStart&&(modLine=diffEntry.modifiedLineEnd)}dom.clearNode(this._content.domNode),this._content.domNode.appendChild(container),this.scrollbar.scanDomNode()}static _renderSection(dest,diffEntry,modLine,lineHeight,width,originalOptions,originalModel,originalModelOpts,modifiedOptions,modifiedModel,modifiedModelOpts,languageIdCodec){const type=diffEntry.getType();let rowClassName="diff-review-row",lineNumbersExtraClassName="";let spacerIcon=null;switch(type){case 1:rowClassName="diff-review-row line-insert",lineNumbersExtraClassName=" char-insert",spacerIcon=diffReviewInsertIcon;break;case 2:rowClassName="diff-review-row line-delete",lineNumbersExtraClassName=" char-delete",spacerIcon=diffReviewRemoveIcon}const originalLineStart=diffEntry.originalLineStart,originalLineEnd=diffEntry.originalLineEnd,modifiedLineStart=diffEntry.modifiedLineStart,modifiedLineEnd=diffEntry.modifiedLineEnd,cnt=Math.max(modifiedLineEnd-modifiedLineStart,originalLineEnd-originalLineStart),originalLayoutInfo=originalOptions.get(131),originalLineNumbersWidth=originalLayoutInfo.glyphMarginWidth+originalLayoutInfo.lineNumbersWidth,modifiedLayoutInfo=modifiedOptions.get(131),modifiedLineNumbersWidth=10+modifiedLayoutInfo.glyphMarginWidth+modifiedLayoutInfo.lineNumbersWidth;for(let i=0;i<=cnt;i++){const originalLine=0===originalLineStart?0:originalLineStart+i,modifiedLine=0===modifiedLineStart?0:modifiedLineStart+i,row=document.createElement("div");row.style.minWidth=width+"px",row.className=rowClassName,row.setAttribute("role","listitem"),0!==modifiedLine&&(modLine=modifiedLine),row.setAttribute("data-line",String(modLine));const cell=document.createElement("div");cell.className="diff-review-cell",cell.style.height=`${lineHeight}px`,row.appendChild(cell);const originalLineNumber=document.createElement("span");originalLineNumber.style.width=originalLineNumbersWidth+"px",originalLineNumber.style.minWidth=originalLineNumbersWidth+"px",originalLineNumber.className="diff-review-line-number"+lineNumbersExtraClassName,0!==originalLine?originalLineNumber.appendChild(document.createTextNode(String(originalLine))):originalLineNumber.innerText=" ",cell.appendChild(originalLineNumber);const modifiedLineNumber=document.createElement("span");modifiedLineNumber.style.width=modifiedLineNumbersWidth+"px",modifiedLineNumber.style.minWidth=modifiedLineNumbersWidth+"px",modifiedLineNumber.style.paddingRight="10px",modifiedLineNumber.className="diff-review-line-number"+lineNumbersExtraClassName,0!==modifiedLine?modifiedLineNumber.appendChild(document.createTextNode(String(modifiedLine))):modifiedLineNumber.innerText=" ",cell.appendChild(modifiedLineNumber);const spacer=document.createElement("span");if(spacer.className="diff-review-spacer",spacerIcon){const spacerCodicon=document.createElement("span");spacerCodicon.className=themeService_1.ThemeIcon.asClassName(spacerIcon),spacerCodicon.innerText="  ",spacer.appendChild(spacerCodicon)}else spacer.innerText="  ";let lineContent;if(cell.appendChild(spacer),0!==modifiedLine){let html=this._renderLine(modifiedModel,modifiedOptions,modifiedModelOpts.tabSize,modifiedLine,languageIdCodec);DiffReview._ttPolicy&&(html=DiffReview._ttPolicy.createHTML(html)),cell.insertAdjacentHTML("beforeend",html),lineContent=modifiedModel.getLineContent(modifiedLine)}else{let html=this._renderLine(originalModel,originalOptions,originalModelOpts.tabSize,originalLine,languageIdCodec);DiffReview._ttPolicy&&(html=DiffReview._ttPolicy.createHTML(html)),cell.insertAdjacentHTML("beforeend",html),lineContent=originalModel.getLineContent(originalLine)}0===lineContent.length&&(lineContent=nls.localize(8,null));let ariaLabel="";switch(type){case 0:ariaLabel=originalLine===modifiedLine?nls.localize(9,null,lineContent,originalLine):nls.localize(10,null,lineContent,originalLine,modifiedLine);break;case 1:ariaLabel=nls.localize(11,null,lineContent,modifiedLine);break;case 2:ariaLabel=nls.localize(12,null,lineContent,originalLine)}row.setAttribute("aria-label",ariaLabel),dest.appendChild(row)}}static _renderLine(model,options,tabSize,lineNumber,languageIdCodec){const lineContent=model.getLineContent(lineNumber),fontInfo=options.get(44),lineTokens=lineTokens_1.LineTokens.createEmpty(lineContent,languageIdCodec),isBasicASCII=viewModel_1.ViewLineRenderingData.isBasicASCII(lineContent,model.mightContainNonBasicASCII()),containsRTL=viewModel_1.ViewLineRenderingData.containsRTL(lineContent,isBasicASCII,model.mightContainRTL());return(0,viewLineRenderer_1.renderViewLine2)(new viewLineRenderer_1.RenderLineInput(fontInfo.isMonospace&&!options.get(29),fontInfo.canUseHalfwidthRightwardsArrow,lineContent,!1,isBasicASCII,containsRTL,0,lineTokens,[],tabSize,0,fontInfo.spaceWidth,fontInfo.middotWidth,fontInfo.wsmiddotWidth,options.get(105),options.get(88),options.get(83),options.get(45)!==editorOptions_1.EditorFontLigatures.OFF,null)).html}};DiffReview._ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("diffReview",{createHTML:value=>value}),DiffReview=__decorate([__param(1,language_1.ILanguageService)],DiffReview),exports.DiffReview=DiffReview,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const lineNumbers=theme.getColor(editorColorRegistry_1.editorLineNumbers);lineNumbers&&collector.addRule(`.monaco-diff-editor .diff-review-line-number { color: ${lineNumbers}; }`);const shadow=theme.getColor(colorRegistry_1.scrollbarShadow);shadow&&collector.addRule(`.monaco-diff-editor .diff-review-shadow { box-shadow: ${shadow} 0 -6px 6px -6px inset; }`)}));class DiffReviewNext extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.diffReview.next",label:nls.localize(13,null),alias:"Go to Next Difference",precondition:contextkey_1.ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(accessor,editor){const diffEditor=findFocusedDiffEditor(accessor);diffEditor&&diffEditor.diffReviewNext()}}class DiffReviewPrev extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.diffReview.prev",label:nls.localize(14,null),alias:"Go to Previous Difference",precondition:contextkey_1.ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(accessor,editor){const diffEditor=findFocusedDiffEditor(accessor);diffEditor&&diffEditor.diffReviewPrev()}}function findFocusedDiffEditor(accessor){const codeEditorService=accessor.get(codeEditorService_1.ICodeEditorService),diffEditors=codeEditorService.listDiffEditors(),activeCodeEditor=codeEditorService.getActiveCodeEditor();if(!activeCodeEditor)return null;for(let i=0,len=diffEditors.length;i<len;i++){const diffEditor=diffEditors[i];if(diffEditor.getModifiedEditor().getId()===activeCodeEditor.getId()||diffEditor.getOriginalEditor().getId()===activeCodeEditor.getId())return diffEditor}return null}(0,editorExtensions_1.registerEditorAction)(DiffReviewNext),(0,editorExtensions_1.registerEditorAction)(DiffReviewPrev)})),define(__m[709],__M([1,0,7,46,69,28,4,2,8,19,106,35,611,204,567,17,53,23,74,135,14,20,385]),(function(require,exports,dom,aria,scrollableElement_1,codicons_1,event_1,lifecycle_1,strings_1,types_1,markdownRenderer_1,language_1,parameterHintsModel_1,provideSignatureHelp_1,nls,contextkey_1,opener_1,colorRegistry_1,iconRegistry_1,theme_1,themeService_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorHoverWidgetHighlightForeground=exports.ParameterHintsWidget=void 0;const $=dom.$,parameterHintsNextIcon=(0,iconRegistry_1.registerIcon)("parameter-hints-next",codicons_1.Codicon.chevronDown,nls.localize(0,null)),parameterHintsPreviousIcon=(0,iconRegistry_1.registerIcon)("parameter-hints-previous",codicons_1.Codicon.chevronUp,nls.localize(1,null));let ParameterHintsWidget=class ParameterHintsWidget extends lifecycle_1.Disposable{constructor(editor,contextKeyService,openerService,languageService,languageFeaturesService){super(),this.editor=editor,this.renderDisposeables=this._register(new lifecycle_1.DisposableStore),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new markdownRenderer_1.MarkdownRenderer({editor},languageService,openerService)),this.model=this._register(new parameterHintsModel_1.ParameterHintsModel(editor,languageFeaturesService.signatureHelpProvider)),this.keyVisible=provideSignatureHelp_1.Context.Visible.bindTo(contextKeyService),this.keyMultipleSignatures=provideSignatureHelp_1.Context.MultipleSignatures.bindTo(contextKeyService),this._register(this.model.onChangedHints((newParameterHints=>{newParameterHints?(this.show(),this.render(newParameterHints)):this.hide()})))}createParameterHintDOMNodes(){const element=$(".editor-widget.parameter-hints-widget"),wrapper=dom.append(element,$(".phwrapper"));wrapper.tabIndex=-1;const controls=dom.append(wrapper,$(".controls")),previous=dom.append(controls,$(".button"+themeService_1.ThemeIcon.asCSSSelector(parameterHintsPreviousIcon))),overloads=dom.append(controls,$(".overloads")),next=dom.append(controls,$(".button"+themeService_1.ThemeIcon.asCSSSelector(parameterHintsNextIcon)));this._register(dom.addDisposableListener(previous,"click",(e=>{dom.EventHelper.stop(e),this.previous()}))),this._register(dom.addDisposableListener(next,"click",(e=>{dom.EventHelper.stop(e),this.next()})));const body=$(".body"),scrollbar=new scrollableElement_1.DomScrollableElement(body,{});this._register(scrollbar),wrapper.appendChild(scrollbar.getDomNode());const signature=dom.append(body,$(".signature")),docs=dom.append(body,$(".docs"));element.style.userSelect="text",this.domNodes={element,signature,overloads,docs,scrollbar},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection((e=>{this.visible&&this.editor.layoutContentWidget(this)})));const updateFont=()=>{if(!this.domNodes)return;const fontInfo=this.editor.getOption(44);this.domNodes.element.style.fontSize=`${fontInfo.fontSize}px`,this.domNodes.element.style.lineHeight=""+fontInfo.lineHeight/fontInfo.fontSize};updateFont(),this._register(event_1.Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter((e=>e.hasChanged(44))).on(updateFont,null)),this._register(this.editor.onDidLayoutChange((e=>this.updateMaxHeight()))),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout((()=>{this.domNodes&&this.domNodes.element.classList.add("visible")}),100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes&&this.domNodes.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(hints){var _a;if(this.renderDisposeables.clear(),!this.domNodes)return;const multiple=hints.signatures.length>1;this.domNodes.element.classList.toggle("multiple",multiple),this.keyMultipleSignatures.set(multiple),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const signature=hints.signatures[hints.activeSignature];if(!signature)return;const code=dom.append(this.domNodes.signature,$(".code")),fontInfo=this.editor.getOption(44);code.style.fontSize=`${fontInfo.fontSize}px`,code.style.fontFamily=fontInfo.fontFamily;const hasParameters=signature.parameters.length>0,activeParameterIndex=null!==(_a=signature.activeParameter)&&void 0!==_a?_a:hints.activeParameter;if(hasParameters)this.renderParameters(code,signature,activeParameterIndex);else{dom.append(code,$("span")).textContent=signature.label}const activeParameter=signature.parameters[activeParameterIndex];if(null==activeParameter?void 0:activeParameter.documentation){const documentation=$("span.documentation");if("string"==typeof activeParameter.documentation)documentation.textContent=activeParameter.documentation;else{const renderedContents=this.renderMarkdownDocs(activeParameter.documentation);documentation.appendChild(renderedContents.element)}dom.append(this.domNodes.docs,$("p",{},documentation))}if(void 0===signature.documentation);else if("string"==typeof signature.documentation)dom.append(this.domNodes.docs,$("p",{},signature.documentation));else{const renderedContents=this.renderMarkdownDocs(signature.documentation);dom.append(this.domNodes.docs,renderedContents.element)}const hasDocs=this.hasDocs(signature,activeParameter);if(this.domNodes.signature.classList.toggle("has-docs",hasDocs),this.domNodes.docs.classList.toggle("empty",!hasDocs),this.domNodes.overloads.textContent=String(hints.activeSignature+1).padStart(hints.signatures.length.toString().length,"0")+"/"+hints.signatures.length,activeParameter){let labelToAnnounce="";const param=signature.parameters[activeParameterIndex];labelToAnnounce=Array.isArray(param.label)?signature.label.substring(param.label[0],param.label[1]):param.label,param.documentation&&(labelToAnnounce+="string"==typeof param.documentation?`, ${param.documentation}`:`, ${param.documentation.value}`),signature.documentation&&(labelToAnnounce+="string"==typeof signature.documentation?`, ${signature.documentation}`:`, ${signature.documentation.value}`),this.announcedLabel!==labelToAnnounce&&(aria.alert(nls.localize(2,null,labelToAnnounce)),this.announcedLabel=labelToAnnounce)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(markdown){const renderedContents=this.renderDisposeables.add(this.markdownRenderer.render(markdown,{asyncRenderCallback:()=>{var _a;null===(_a=this.domNodes)||void 0===_a||_a.scrollbar.scanDomNode()}}));return renderedContents.element.classList.add("markdown-docs"),renderedContents}hasDocs(signature,activeParameter){return!!(activeParameter&&"string"==typeof activeParameter.documentation&&(0,types_1.assertIsDefined)(activeParameter.documentation).length>0)||(!!(activeParameter&&"object"==typeof activeParameter.documentation&&(0,types_1.assertIsDefined)(activeParameter.documentation).value.length>0)||(!!(signature.documentation&&"string"==typeof signature.documentation&&(0,types_1.assertIsDefined)(signature.documentation).length>0)||!!(signature.documentation&&"object"==typeof signature.documentation&&(0,types_1.assertIsDefined)(signature.documentation.value).length>0)))}renderParameters(parent,signature,activeParameterIndex){const[start,end]=this.getParameterLabelOffsets(signature,activeParameterIndex),beforeSpan=document.createElement("span");beforeSpan.textContent=signature.label.substring(0,start);const paramSpan=document.createElement("span");paramSpan.textContent=signature.label.substring(start,end),paramSpan.className="parameter active";const afterSpan=document.createElement("span");afterSpan.textContent=signature.label.substring(end),dom.append(parent,beforeSpan,paramSpan,afterSpan)}getParameterLabelOffsets(signature,paramIdx){const param=signature.parameters[paramIdx];if(param){if(Array.isArray(param.label))return param.label;if(param.label.length){const regex=new RegExp(`(\\W|^)${(0,strings_1.escapeRegExpCharacters)(param.label)}(?=\\W|$)`,"g");regex.test(signature.label);const idx=regex.lastIndex-param.label.length;return idx>=0?[idx,regex.lastIndex]:[0,0]}return[0,0]}return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}cancel(){this.model.cancel()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return ParameterHintsWidget.ID}trigger(context){this.model.trigger(context,0)}updateMaxHeight(){if(!this.domNodes)return;const maxHeight=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=maxHeight;const wrapper=this.domNodes.element.getElementsByClassName("phwrapper");wrapper.length&&(wrapper[0].style.maxHeight=maxHeight)}};ParameterHintsWidget.ID="editor.widget.parameterHintsWidget",ParameterHintsWidget=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,opener_1.IOpenerService),__param(3,language_1.ILanguageService),__param(4,languageFeatures_1.ILanguageFeaturesService)],ParameterHintsWidget),exports.ParameterHintsWidget=ParameterHintsWidget,exports.editorHoverWidgetHighlightForeground=(0,colorRegistry_1.registerColor)("editorHoverWidget.highlightForeground",{dark:colorRegistry_1.listHighlightForeground,light:colorRegistry_1.listHighlightForeground,hc:colorRegistry_1.listHighlightForeground},nls.localize(3,null)),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const border=theme.getColor(colorRegistry_1.editorHoverBorder);if(border){const borderWidth=theme.type===theme_1.ColorScheme.HIGH_CONTRAST?2:1;collector.addRule(`.monaco-editor .parameter-hints-widget { border: ${borderWidth}px solid ${border}; }`),collector.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${border.transparent(.5)}; }`),collector.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${border.transparent(.5)}; }`)}const background=theme.getColor(colorRegistry_1.editorHoverBackground);background&&collector.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${background}; }`);const link=theme.getColor(colorRegistry_1.textLinkForeground);link&&collector.addRule(`.monaco-editor .parameter-hints-widget a { color: ${link}; }`);const linkHover=theme.getColor(colorRegistry_1.textLinkActiveForeground);linkHover&&collector.addRule(`.monaco-editor .parameter-hints-widget a:hover { color: ${linkHover}; }`);const foreground=theme.getColor(colorRegistry_1.editorHoverForeground);foreground&&collector.addRule(`.monaco-editor .parameter-hints-widget { color: ${foreground}; }`);const codeBackground=theme.getColor(colorRegistry_1.textCodeBlockBackground);codeBackground&&collector.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${codeBackground}; }`);const parameterHighlightColor=theme.getColor(exports.editorHoverWidgetHighlightForeground);parameterHighlightColor&&collector.addRule(`.monaco-editor .parameter-hints-widget .parameter.active { color: ${parameterHighlightColor}}`)}))})),define(__m[710],__M([1,0,2,15,24,27,204,566,17,9,709]),(function(require,exports,lifecycle_1,editorExtensions_1,editorContextKeys_1,languages,provideSignatureHelp_1,nls,contextkey_1,instantiation_1,parameterHintsWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TriggerParameterHintsAction=void 0;let ParameterHintsController=class ParameterHintsController extends lifecycle_1.Disposable{constructor(editor,instantiationService){super(),this.editor=editor,this.widget=this._register(instantiationService.createInstance(parameterHintsWidget_1.ParameterHintsWidget,this.editor))}static get(editor){return editor.getContribution(ParameterHintsController.ID)}cancel(){this.widget.cancel()}previous(){this.widget.previous()}next(){this.widget.next()}trigger(context){this.widget.trigger(context)}};ParameterHintsController.ID="editor.controller.parameterHints",ParameterHintsController=__decorate([__param(1,instantiation_1.IInstantiationService)],ParameterHintsController);class TriggerParameterHintsAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.triggerParameterHints",label:nls.localize(0,null),alias:"Trigger Parameter Hints",precondition:editorContextKeys_1.EditorContextKeys.hasSignatureHelpProvider,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3082,weight:100}})}run(accessor,editor){const controller=ParameterHintsController.get(editor);controller&&controller.trigger({triggerKind:languages.SignatureHelpTriggerKind.Invoke})}}exports.TriggerParameterHintsAction=TriggerParameterHintsAction,(0,editorExtensions_1.registerEditorContribution)(ParameterHintsController.ID,ParameterHintsController),(0,editorExtensions_1.registerEditorAction)(TriggerParameterHintsAction);const ParameterHintsCommand=editorExtensions_1.EditorCommand.bindToContribution(ParameterHintsController.get);(0,editorExtensions_1.registerEditorCommand)(new ParameterHintsCommand({id:"closeParameterHints",precondition:provideSignatureHelp_1.Context.Visible,handler:x=>x.cancel(),kbOpts:{weight:175,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:9,secondary:[1033]}})),(0,editorExtensions_1.registerEditorCommand)(new ParameterHintsCommand({id:"showPrevParameterHint",precondition:contextkey_1.ContextKeyExpr.and(provideSignatureHelp_1.Context.Visible,provideSignatureHelp_1.Context.MultipleSignatures),handler:x=>x.previous(),kbOpts:{weight:175,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),(0,editorExtensions_1.registerEditorCommand)(new ParameterHintsCommand({id:"showNextParameterHint",precondition:contextkey_1.ContextKeyExpr.and(provideSignatureHelp_1.Context.Visible,provideSignatureHelp_1.Context.MultipleSignatures),handler:x=>x.next(),kbOpts:{weight:175,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}))})),define(__m[711],__M([1,0,34,7,195,18,28,4,75,2,25,32,27,631,48,35,580,273,74,14,282]),(function(require,exports,browser_1,dom_1,iconLabel_1,arrays_1,codicons_1,event_1,filters_1,lifecycle_1,uri_1,editorOptions_1,languages_1,getIconClasses_1,model_1,language_1,nls,files_1,iconRegistry_1,themeService_1,suggestWidgetDetails_1){"use strict";var _a;function getAriaId(index){return`suggest-aria-id:${index}`}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ItemRenderer=exports.suggestMoreInfoIcon=exports.getAriaId=void 0,exports.getAriaId=getAriaId,exports.suggestMoreInfoIcon=(0,iconRegistry_1.registerIcon)("suggest-more-info",codicons_1.Codicon.chevronRight,nls.localize(0,null));const _completionItemColor=new((_a=class ColorExtractor{extract(item,out){if(item.textLabel.match(ColorExtractor._regexStrict))return out[0]=item.textLabel,!0;if(item.completion.detail&&item.completion.detail.match(ColorExtractor._regexStrict))return out[0]=item.completion.detail,!0;if("string"==typeof item.completion.documentation){const match=ColorExtractor._regexRelaxed.exec(item.completion.documentation);if(match&&(0===match.index||match.index+match[0].length===item.completion.documentation.length))return out[0]=match[0],!0}return!1}})._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,_a._regexStrict=new RegExp(`^${_a._regexRelaxed.source}$`,"i"),_a);let ItemRenderer=class ItemRenderer{constructor(_editor,_modelService,_languageService,_themeService){this._editor=_editor,this._modelService=_modelService,this._languageService=_languageService,this._themeService=_themeService,this._onDidToggleDetails=new event_1.Emitter,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(container){const data=Object.create(null);data.disposables=new lifecycle_1.DisposableStore,data.root=container,data.root.classList.add("show-file-icons"),data.icon=(0,dom_1.append)(container,(0,dom_1.$)(".icon")),data.colorspan=(0,dom_1.append)(data.icon,(0,dom_1.$)("span.colorspan"));const text=(0,dom_1.append)(container,(0,dom_1.$)(".contents")),main=(0,dom_1.append)(text,(0,dom_1.$)(".main"));data.iconContainer=(0,dom_1.append)(main,(0,dom_1.$)(".icon-label.codicon")),data.left=(0,dom_1.append)(main,(0,dom_1.$)("span.left")),data.right=(0,dom_1.append)(main,(0,dom_1.$)("span.right")),data.iconLabel=new iconLabel_1.IconLabel(data.left,{supportHighlights:!0,supportIcons:!0}),data.disposables.add(data.iconLabel),data.parametersLabel=(0,dom_1.append)(data.left,(0,dom_1.$)("span.signature-label")),data.qualifierLabel=(0,dom_1.append)(data.left,(0,dom_1.$)("span.qualifier-label")),data.detailsLabel=(0,dom_1.append)(data.right,(0,dom_1.$)("span.details-label")),data.readMore=(0,dom_1.append)(data.right,(0,dom_1.$)("span.readMore"+themeService_1.ThemeIcon.asCSSSelector(exports.suggestMoreInfoIcon))),data.readMore.title=nls.localize(1,null);const configureFont=()=>{const options=this._editor.getOptions(),fontInfo=options.get(44),fontFamily=fontInfo.getMassagedFontFamily(browser_1.isSafari?editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily:null),fontFeatureSettings=fontInfo.fontFeatureSettings,fontSize=options.get(107)||fontInfo.fontSize,lineHeight=options.get(108)||fontInfo.lineHeight,fontWeight=fontInfo.fontWeight,fontSizePx=`${fontSize}px`,lineHeightPx=`${lineHeight}px`;data.root.style.fontSize=fontSizePx,data.root.style.fontWeight=fontWeight,main.style.fontFamily=fontFamily,main.style.fontFeatureSettings=fontFeatureSettings,main.style.lineHeight=lineHeightPx,data.icon.style.height=lineHeightPx,data.icon.style.width=lineHeightPx,data.readMore.style.height=lineHeightPx,data.readMore.style.width=lineHeightPx};return configureFont(),data.disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(44)||e.hasChanged(107)||e.hasChanged(108))&&configureFont()}))),data}renderElement(element,index,data){const{completion}=element;data.root.id=getAriaId(index),data.colorspan.style.backgroundColor="";const labelOptions={labelEscapeNewLines:!0,matches:(0,filters_1.createMatches)(element.score)};let color=[];if(19===completion.kind&&_completionItemColor.extract(element,color))data.icon.className="icon customcolor",data.iconContainer.className="icon hide",data.colorspan.style.backgroundColor=color[0];else if(20===completion.kind&&this._themeService.getFileIconTheme().hasFileIcons){data.icon.className="icon hide",data.iconContainer.className="icon hide";const labelClasses=(0,getIconClasses_1.getIconClasses)(this._modelService,this._languageService,uri_1.URI.from({scheme:"fake",path:element.textLabel}),files_1.FileKind.FILE),detailClasses=(0,getIconClasses_1.getIconClasses)(this._modelService,this._languageService,uri_1.URI.from({scheme:"fake",path:completion.detail}),files_1.FileKind.FILE);labelOptions.extraClasses=labelClasses.length>detailClasses.length?labelClasses:detailClasses}else 23===completion.kind&&this._themeService.getFileIconTheme().hasFolderIcons?(data.icon.className="icon hide",data.iconContainer.className="icon hide",labelOptions.extraClasses=(0,arrays_1.flatten)([(0,getIconClasses_1.getIconClasses)(this._modelService,this._languageService,uri_1.URI.from({scheme:"fake",path:element.textLabel}),files_1.FileKind.FOLDER),(0,getIconClasses_1.getIconClasses)(this._modelService,this._languageService,uri_1.URI.from({scheme:"fake",path:completion.detail}),files_1.FileKind.FOLDER)])):(data.icon.className="icon hide",data.iconContainer.className="",data.iconContainer.classList.add("suggest-icon",...codicons_1.CSSIcon.asClassNameArray(languages_1.CompletionItemKinds.toIcon(completion.kind))));completion.tags&&completion.tags.indexOf(1)>=0&&(labelOptions.extraClasses=(labelOptions.extraClasses||[]).concat(["deprecated"]),labelOptions.matches=[]),data.iconLabel.setLabel(element.textLabel,void 0,labelOptions),"string"==typeof completion.label?(data.parametersLabel.textContent="",data.detailsLabel.textContent=stripNewLines(completion.detail||""),data.root.classList.add("string-label")):(data.parametersLabel.textContent=stripNewLines(completion.label.detail||""),data.detailsLabel.textContent=stripNewLines(completion.label.description||""),data.root.classList.remove("string-label")),this._editor.getOption(106).showInlineDetails?(0,dom_1.show)(data.detailsLabel):(0,dom_1.hide)(data.detailsLabel),(0,suggestWidgetDetails_1.canExpandCompletionItem)(element)?(data.right.classList.add("can-expand-details"),(0,dom_1.show)(data.readMore),data.readMore.onmousedown=e=>{e.stopPropagation(),e.preventDefault()},data.readMore.onclick=e=>{e.stopPropagation(),e.preventDefault(),this._onDidToggleDetails.fire()}):(data.right.classList.remove("can-expand-details"),(0,dom_1.hide)(data.readMore),data.readMore.onmousedown=null,data.readMore.onclick=null)}disposeTemplate(templateData){templateData.disposables.dispose()}};function stripNewLines(str){return str.replace(/\r\n|\r|\n/g,"")}ItemRenderer=__decorate([__param(1,model_1.IModelService),__param(2,language_1.ILanguageService),__param(3,themeService_1.IThemeService)],ItemRenderer),exports.ItemRenderer=ItemRenderer})),define(__m[712],__M([1,0,7,87,47,2,106,9,704,74,14,390]),(function(require,exports,dom_1,actionbar_1,actions_1,lifecycle_1,markdownRenderer_1,instantiation_1,link_1,iconRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BannerController=void 0;let BannerController=class BannerController extends lifecycle_1.Disposable{constructor(_editor,instantiationService){super(),this._editor=_editor,this.instantiationService=instantiationService,this.banner=this._register(this.instantiationService.createInstance(Banner))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(item){this.banner.show(Object.assign(Object.assign({},item),{onClose:()=>{this.hide(),item.onClose&&item.onClose()}})),this._editor.setBanner(this.banner.element,26)}};BannerController=__decorate([__param(1,instantiation_1.IInstantiationService)],BannerController),exports.BannerController=BannerController;let Banner=class Banner extends lifecycle_1.Disposable{constructor(instantiationService){super(),this.instantiationService=instantiationService,this.markdownRenderer=this.instantiationService.createInstance(markdownRenderer_1.MarkdownRenderer,{}),this.element=(0,dom_1.$)("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(item){return item.ariaLabel?item.ariaLabel:"string"==typeof item.message?item.message:void 0}getBannerMessage(message){if("string"==typeof message){const element=(0,dom_1.$)("span");return element.innerText=message,element}return this.markdownRenderer.render(message).element}clear(){(0,dom_1.clearNode)(this.element)}show(item){(0,dom_1.clearNode)(this.element);const ariaLabel=this.getAriaLabel(item);ariaLabel&&this.element.setAttribute("aria-label",ariaLabel);const iconContainer=(0,dom_1.append)(this.element,(0,dom_1.$)("div.icon-container"));iconContainer.setAttribute("aria-hidden","true"),item.icon&&iconContainer.appendChild((0,dom_1.$)(`div${themeService_1.ThemeIcon.asCSSSelector(item.icon)}`));const messageContainer=(0,dom_1.append)(this.element,(0,dom_1.$)("div.message-container"));if(messageContainer.setAttribute("aria-hidden","true"),messageContainer.appendChild(this.getBannerMessage(item.message)),this.messageActionsContainer=(0,dom_1.append)(this.element,(0,dom_1.$)("div.message-actions-container")),item.actions)for(const action of item.actions)this._register(this.instantiationService.createInstance(link_1.Link,this.messageActionsContainer,Object.assign(Object.assign({},action),{tabIndex:-1}),{}));const actionBarContainer=(0,dom_1.append)(this.element,(0,dom_1.$)("div.action-container"));this.actionBar=this._register(new actionbar_1.ActionBar(actionBarContainer)),this.actionBar.push(this._register(new actions_1.Action("banner.close","Close Banner",themeService_1.ThemeIcon.asClassName(iconRegistry_1.widgetClose),!0,(()=>{"function"==typeof item.onClose&&item.onClose()}))),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};Banner=__decorate([__param(0,instantiation_1.IInstantiationService)],Banner)})),define(__m[713],__M([1,0,7,4,74,14]),(function(require,exports,dom_1,event_1,iconRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnthemedProductIconTheme=exports.getIconsStyleSheet=void 0,exports.getIconsStyleSheet=function getIconsStyleSheet(themeService){const onDidChangeEmmiter=new event_1.Emitter,iconRegistry=(0,iconRegistry_1.getIconRegistry)();return iconRegistry.onDidChange((()=>onDidChangeEmmiter.fire())),null==themeService||themeService.onDidProductIconThemeChange((()=>onDidChangeEmmiter.fire())),{onDidChange:onDidChangeEmmiter.event,getCSS(){const productIconTheme=themeService?themeService.getProductIconTheme():new UnthemedProductIconTheme,usedFontIds={},formatIconRule=contribution=>{const definition=productIconTheme.getIcon(contribution);if(!definition)return;const fontContribution=definition.font;return fontContribution?(usedFontIds[fontContribution.id]=fontContribution.definition,`.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; font-family: ${(0,dom_1.asCSSPropertyValue)(fontContribution.id)}; }`):`.codicon-${contribution.id}:before { content: '${definition.fontCharacter}'; }`},rules=[];for(let contribution of iconRegistry.getIcons()){const rule=formatIconRule(contribution);rule&&rules.push(rule)}for(let id in usedFontIds){const definition=usedFontIds[id],fontWeight=definition.weight?`font-weight: ${definition.weight};`:"",fontStyle=definition.style?`font-style: ${definition.style};`:"",src=definition.src.map((l=>`${(0,dom_1.asCSSUrl)(l.location)} format('${l.format}')`)).join(", ");rules.push(`@font-face { src: ${src}; font-family: ${(0,dom_1.asCSSPropertyValue)(id)};${fontWeight}${fontStyle} font-display: block; }`)}return rules.join("\n")}}};class UnthemedProductIconTheme{getIcon(contribution){const iconRegistry=(0,iconRegistry_1.getIconRegistry)();let definition=contribution.defaults;for(;themeService_1.ThemeIcon.isThemeIcon(definition);){const c=iconRegistry.getIcon(definition.id);if(!c)return;definition=c.defaults}return definition}}exports.UnthemedProductIconTheme=UnthemedProductIconTheme})),define(__m[714],__M([1,0,7,30,4,27,420,667,36,23,14,2,135,713]),(function(require,exports,dom,color_1,event_1,languages_1,tokenization_1,themes_1,platform_1,colorRegistry_1,themeService_1,lifecycle_1,theme_1,iconsStyleSheet_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandaloneThemeService=void 0;const colorRegistry=platform_1.Registry.as(colorRegistry_1.Extensions.ColorContribution),themingRegistry=platform_1.Registry.as(themeService_1.Extensions.ThemingContribution);class StandaloneTheme{constructor(name,standaloneThemeData){this.semanticHighlighting=!1,this.themeData=standaloneThemeData;const base=standaloneThemeData.base;name.length>0?(isBuiltinTheme(name)?this.id=name:this.id=base+" "+name,this.themeName=name):(this.id=base,this.themeName=base),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const colors=new Map;for(let id in this.themeData.colors)colors.set(id,color_1.Color.fromHex(this.themeData.colors[id]));if(this.themeData.inherit){const baseData=getBuiltinRules(this.themeData.base);for(let id in baseData.colors)colors.has(id)||colors.set(id,color_1.Color.fromHex(baseData.colors[id]))}this.colors=colors}return this.colors}getColor(colorId,useDefault){const color=this.getColors().get(colorId);return color||(!1!==useDefault?this.getDefault(colorId):void 0)}getDefault(colorId){let color=this.defaultColors[colorId];return color||(color=colorRegistry.resolveDefaultColor(colorId,this),this.defaultColors[colorId]=color,color)}defines(colorId){return Object.prototype.hasOwnProperty.call(this.getColors(),colorId)}get type(){switch(this.base){case"vs":return theme_1.ColorScheme.LIGHT;case"hc-black":return theme_1.ColorScheme.HIGH_CONTRAST;default:return theme_1.ColorScheme.DARK}}get tokenTheme(){if(!this._tokenTheme){let rules=[],encodedTokensColors=[];if(this.themeData.inherit){const baseData=getBuiltinRules(this.themeData.base);rules=baseData.rules,baseData.encodedTokensColors&&(encodedTokensColors=baseData.encodedTokensColors)}const editorForeground=this.themeData.colors["editor.foreground"],editorBackground=this.themeData.colors["editor.background"];if(editorForeground||editorBackground){const rule={token:""};editorForeground&&(rule.foreground=editorForeground),editorBackground&&(rule.background=editorBackground),rules.push(rule)}rules=rules.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(encodedTokensColors=this.themeData.encodedTokensColors),this._tokenTheme=tokenization_1.TokenTheme.createFromRawTokenTheme(rules,encodedTokensColors)}return this._tokenTheme}getTokenStyleMetadata(type,modifiers,modelLanguage){const metadata=this.tokenTheme._match([type].concat(modifiers).join(".")).metadata,foreground=languages_1.TokenMetadata.getForeground(metadata),fontStyle=languages_1.TokenMetadata.getFontStyle(metadata);return{foreground,italic:Boolean(1&fontStyle),bold:Boolean(2&fontStyle),underline:Boolean(4&fontStyle),strikethrough:Boolean(8&fontStyle)}}}function isBuiltinTheme(themeName){return"vs"===themeName||"vs-dark"===themeName||"hc-black"===themeName}function getBuiltinRules(builtinTheme){switch(builtinTheme){case"vs":return themes_1.vs;case"vs-dark":return themes_1.vs_dark;case"hc-black":return themes_1.hc_black}}function newBuiltInTheme(builtinTheme){const themeData=getBuiltinRules(builtinTheme);return new StandaloneTheme(builtinTheme,themeData)}class StandaloneThemeService extends lifecycle_1.Disposable{constructor(){super(),this._onColorThemeChange=this._register(new event_1.Emitter),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new event_1.Emitter),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new iconsStyleSheet_1.UnthemedProductIconTheme,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set("vs",newBuiltInTheme("vs")),this._knownThemes.set("vs-dark",newBuiltInTheme("vs-dark")),this._knownThemes.set("hc-black",newBuiltInTheme("hc-black"));const iconsStyleSheet=(0,iconsStyleSheet_1.getIconsStyleSheet)(this);this._codiconCSS=iconsStyleSheet.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme("vs"),iconsStyleSheet.onDidChange((()=>{this._codiconCSS=iconsStyleSheet.getCSS(),this._updateCSS()})),dom.addMatchMediaChangeListener("(forced-colors: active)",(()=>{this._updateActualTheme()}))}registerEditorContainer(domNode){return dom.isInShadowDOM(domNode)?this._registerShadowDomContainer(domNode):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=dom.createStyleSheet(),this._globalStyleElement.className="monaco-colors",this._globalStyleElement.textContent=this._allCSS,this._styleElements.push(this._globalStyleElement)),lifecycle_1.Disposable.None}_registerShadowDomContainer(domNode){const styleElement=dom.createStyleSheet(domNode);return styleElement.className="monaco-colors",styleElement.textContent=this._allCSS,this._styleElements.push(styleElement),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===styleElement)return void this._styleElements.splice(i,1)}}}defineTheme(themeName,themeData){if(!/^[a-z0-9\-]+$/i.test(themeName))throw new Error("Illegal theme name!");if(!isBuiltinTheme(themeData.base)&&!isBuiltinTheme(themeName))throw new Error("Illegal theme base!");this._knownThemes.set(themeName,new StandaloneTheme(themeName,themeData)),isBuiltinTheme(themeName)&&this._knownThemes.forEach((theme=>{theme.base===themeName&&theme.notifyBaseUpdated()})),this._theme.themeName===themeName&&this.setTheme(themeName)}getColorTheme(){return this._theme}setColorMapOverride(colorMapOverride){this._colorMapOverride=colorMapOverride,this._updateThemeOrColorMap()}setTheme(themeName){let theme;theme=this._knownThemes.has(themeName)?this._knownThemes.get(themeName):this._knownThemes.get("vs"),this._desiredTheme=theme,this._updateActualTheme()}_updateActualTheme(){const theme=this._autoDetectHighContrast&&window.matchMedia("(forced-colors: active)").matches?this._knownThemes.get("hc-black"):this._desiredTheme;this._theme!==theme&&(this._theme=theme,this._updateThemeOrColorMap())}setAutoDetectHighContrast(autoDetectHighContrast){this._autoDetectHighContrast=autoDetectHighContrast,this._updateActualTheme()}_updateThemeOrColorMap(){const cssRules=[],hasRule={},ruleCollector={addRule:rule=>{hasRule[rule]||(cssRules.push(rule),hasRule[rule]=!0)}};themingRegistry.getThemingParticipants().forEach((p=>p(this._theme,ruleCollector,this._environment)));const colorVariables=[];for(const item of colorRegistry.getColors()){const color=this._theme.getColor(item.id,!0);color&&colorVariables.push(`${(0,colorRegistry_1.asCssVariableName)(item.id)}: ${color.toString()};`)}ruleCollector.addRule(`.monaco-editor { ${colorVariables.join("\n")} }`);const colorMap=this._colorMapOverride||this._theme.tokenTheme.getColorMap();ruleCollector.addRule((0,tokenization_1.generateTokensCSSForColorMap)(colorMap)),this._themeCSS=cssRules.join("\n"),this._updateCSS(),languages_1.TokenizationRegistry.setColorMap(colorMap),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._styleElements.forEach((styleElement=>styleElement.textContent=this._allCSS))}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}exports.StandaloneThemeService=StandaloneThemeService})),define(__m[162],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UndoRedoSource=exports.UndoRedoGroup=exports.ResourceEditStackSnapshot=exports.IUndoRedoService=void 0,exports.IUndoRedoService=(0,instantiation_1.createDecorator)("undoRedoService");exports.ResourceEditStackSnapshot=class ResourceEditStackSnapshot{constructor(resource,elements){this.resource=resource,this.elements=elements}};class UndoRedoGroup{constructor(){this.id=UndoRedoGroup._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}exports.UndoRedoGroup=UndoRedoGroup,UndoRedoGroup._ID=0,UndoRedoGroup.None=new UndoRedoGroup;class UndoRedoSource{constructor(){this.id=UndoRedoSource._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}exports.UndoRedoSource=UndoRedoSource,UndoRedoSource._ID=0,UndoRedoSource.None=new UndoRedoSource})),define(__m[38],__M([1,0,18,30,13,4,2,8,25,11,3,22,50,435,658,272,250,424,425,247,429,94,153,440,119,442,444,121,33,35,162,148,177]),(function(require,exports,arrays_1,color_1,errors_1,event_1,lifecycle_1,strings,uri_1,position_1,range_1,selection_1,model,bracketPairsImpl_1,colorizedBracketPairsDecorationProvider_1,editStack_1,guidesTextModelPart_1,indentationGuesser_1,intervalTree_1,pieceTreeTextBuffer_1,pieceTreeTextBufferBuilder_1,textModelEvents_1,textModelSearch_1,textModelTokens_1,eolCounter_1,contiguousTokensStore_1,sparseTokensStore_1,wordHelper_1,languageConfigurationRegistry_1,language_1,undoRedo_1,textModelDefaults_1,indentation_1){"use strict";function createTextBufferFactory(text){const builder=function createTextBufferBuilder(){return new pieceTreeTextBufferBuilder_1.PieceTreeTextBufferBuilder}();return builder.acceptChunk(text),builder.finish()}function createTextBuffer(value,defaultEOL){return("string"==typeof value?createTextBufferFactory(value):value).create(defaultEOL)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DidChangeContentEmitter=exports.DidChangeDecorationsEmitter=exports.ModelDecorationOptions=exports.ModelDecorationInjectedTextOptions=exports.ModelDecorationMinimapOptions=exports.ModelDecorationOverviewRulerOptions=exports.TextModel=exports.LONG_LINE_BOUNDARY=exports.createTextBuffer=exports.createTextBufferFactory=void 0,exports.createTextBufferFactory=createTextBufferFactory,exports.createTextBuffer=createTextBuffer;let MODEL_ID=0;exports.LONG_LINE_BOUNDARY=1e4;class TextModelSnapshot{constructor(source){this._source=source,this._eos=!1}read(){if(this._eos)return null;const result=[];let resultCnt=0,resultLength=0;for(;;){const tmp=this._source.read();if(null===tmp)return this._eos=!0,0===resultCnt?null:result.join("");if(tmp.length>0&&(result[resultCnt++]=tmp,resultLength+=tmp.length),resultLength>=65536)return result.join("")}}}const invalidFunc=()=>{throw new Error("Invalid change accessor")};let TextModel=class TextModel extends lifecycle_1.Disposable{constructor(source,languageId,creationOptions,associatedResource=null,_undoRedoService,_languageService,_languageConfigurationService){super(),this._undoRedoService=_undoRedoService,this._languageService=_languageService,this._languageConfigurationService=_languageConfigurationService,this._onWillDispose=this._register(new event_1.Emitter),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new DidChangeDecorationsEmitter((affectedInjectedTextLines=>this.handleBeforeFireDecorationsChangedEvent(affectedInjectedTextLines)))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeLanguage=this._register(new event_1.Emitter),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new event_1.Emitter),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new event_1.Emitter),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidChangeOptions=this._register(new event_1.Emitter),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new event_1.Emitter),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new event_1.Emitter),this._eventEmitter=this._register(new DidChangeContentEmitter),this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new event_1.Emitter),MODEL_ID++,this.id="$model"+MODEL_ID,this.isForSimpleWidget=creationOptions.isForSimpleWidget,this._associatedResource=null==associatedResource?uri_1.URI.parse("inmemory://model/"+MODEL_ID):associatedResource,this._attachedEditorCount=0;const{textBuffer,disposable}=createTextBuffer(source,creationOptions.defaultEOL);this._buffer=textBuffer,this._bufferDisposable=disposable,this._options=TextModel.resolveOptions(this._buffer,creationOptions);const bufferLineCount=this._buffer.getLineCount(),bufferTextLength=this._buffer.getValueLengthInRange(new range_1.Range(1,1,bufferLineCount,this._buffer.getLineLength(bufferLineCount)+1),0);creationOptions.largeFileOptimizations?this._isTooLargeForTokenization=bufferTextLength>TextModel.LARGE_FILE_SIZE_THRESHOLD||bufferLineCount>TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=bufferTextLength>TextModel.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this._isDisposing=!1,this._languageId=languageId,this._languageRegistryListener=this._languageConfigurationService.onDidChange((e=>{e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._instanceId=strings.singleLetterHash(MODEL_ID),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager=new editStack_1.EditStack(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._tokens=new contiguousTokensStore_1.ContiguousTokensStore(this._languageService.languageIdCodec),this._semanticTokens=new sparseTokensStore_1.SparseTokensStore(this._languageService.languageIdCodec),this._tokenization=new textModelTokens_1.TextModelTokenization(this,this._languageService.languageIdCodec),this._bracketPairColorizer=this._register(new bracketPairsImpl_1.BracketPairsTextModelPart(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new guidesTextModelPart_1.GuidesTextModelPart(this,this._languageConfigurationService)),this._decorationProvider=this._register(new colorizedBracketPairsDecorationProvider_1.ColorizedBracketPairsDecorationProvider(this)),this._register(this._decorationProvider.onDidChange((()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})))}static resolveOptions(textBuffer,options){if(options.detectIndentation){const guessedIndentation=(0,indentationGuesser_1.guessIndentation)(textBuffer,options.tabSize,options.insertSpaces);return new model.TextModelResolvedOptions({tabSize:guessedIndentation.tabSize,indentSize:guessedIndentation.tabSize,insertSpaces:guessedIndentation.insertSpaces,trimAutoWhitespace:options.trimAutoWhitespace,defaultEOL:options.defaultEOL,bracketPairColorizationOptions:options.bracketPairColorizationOptions})}return new model.TextModelResolvedOptions({tabSize:options.tabSize,indentSize:options.indentSize,insertSpaces:options.insertSpaces,trimAutoWhitespace:options.trimAutoWhitespace,defaultEOL:options.defaultEOL,bracketPairColorizationOptions:options.bracketPairColorizationOptions})}onDidChangeContent(listener){return this._eventEmitter.slowEvent((e=>listener(e.contentChangedEvent)))}onDidChangeContentOrInjectedText(listener){return(0,lifecycle_1.combinedDisposable)(this._eventEmitter.fastEvent((e=>listener(e.rawContentChangedEvent))),this._onDidChangeInjectedText.event((e=>listener(e))))}get bracketPairs(){return this._bracketPairColorizer}get guides(){return this._guidesTextModelPart}get backgroundTokenizationState(){return this._backgroundTokenizationState}handleTokenizationProgress(completed){if(2===this._backgroundTokenizationState)return;const newState=completed?2:1;this._backgroundTokenizationState!==newState&&(this._backgroundTokenizationState=newState,this._bracketPairColorizer.handleDidChangeBackgroundTokenizationState(),this._onBackgroundTokenizationStateChanged.fire())}dispose(){this._isDisposing=!0,this._onWillDispose.fire(),this._languageRegistryListener.dispose(),this._tokenization.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this._isDisposing=!1;const emptyDisposedTextBuffer=new pieceTreeTextBuffer_1.PieceTreeTextBuffer([],"","\n",!1,!1,!0,!0);emptyDisposedTextBuffer.dispose(),this._buffer=emptyDisposedTextBuffer,this._bufferDisposable=lifecycle_1.Disposable.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(rawChange,change){this._isDisposing||(this._bracketPairColorizer.handleDidChangeContent(change),this._tokenization.handleDidChangeContent(change),this._eventEmitter.fire(new textModelEvents_1.InternalModelContentChangeEvent(rawChange,change)))}setValue(value){if(this._assertNotDisposed(),null===value)return;const{textBuffer,disposable}=createTextBuffer(value,this._options.defaultEOL);this._setValueFromTextBuffer(textBuffer,disposable)}_createContentChanged2(range,rangeOffset,rangeLength,text,isUndoing,isRedoing,isFlush){return{changes:[{range,rangeOffset,rangeLength,text}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing,isRedoing,isFlush}}_setValueFromTextBuffer(textBuffer,textBufferDisposable){this._assertNotDisposed();const oldFullModelRange=this.getFullModelRange(),oldModelValueLength=this.getValueLengthInRange(oldFullModelRange),endLineNumber=this.getLineCount(),endColumn=this.getLineMaxColumn(endLineNumber);this._buffer=textBuffer,this._bufferDisposable.dispose(),this._bufferDisposable=textBufferDisposable,this._increaseVersionId(),this._tokens.flush(),this._semanticTokens.flush(),this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new textModelEvents_1.ModelRawContentChangedEvent([new textModelEvents_1.ModelRawFlush],this._versionId,!1,!1),this._createContentChanged2(new range_1.Range(1,1,endLineNumber,endColumn),0,oldModelValueLength,this.getValue(),!1,!1,!0))}setEOL(eol){this._assertNotDisposed();const newEOL=1===eol?"\r\n":"\n";if(this._buffer.getEOL()===newEOL)return;const oldFullModelRange=this.getFullModelRange(),oldModelValueLength=this.getValueLengthInRange(oldFullModelRange),endLineNumber=this.getLineCount(),endColumn=this.getLineMaxColumn(endLineNumber);this._onBeforeEOLChange(),this._buffer.setEOL(newEOL),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new textModelEvents_1.ModelRawContentChangedEvent([new textModelEvents_1.ModelRawEOLChanged],this._versionId,!1,!1),this._createContentChanged2(new range_1.Range(1,1,endLineNumber,endColumn),0,oldModelValueLength,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const versionId=this.getVersionId(),allDecorations=this._decorationsTree.collectNodesPostOrder();for(let i=0,len=allDecorations.length;i<len;i++){const node=allDecorations[i],range=node.range,delta=node.cachedAbsoluteStart-node.start,startOffset=this._buffer.getOffsetAt(range.startLineNumber,range.startColumn),endOffset=this._buffer.getOffsetAt(range.endLineNumber,range.endColumn);node.cachedAbsoluteStart=startOffset,node.cachedAbsoluteEnd=endOffset,node.cachedVersionId=versionId,node.start=startOffset-delta,node.end=endOffset-delta,(0,intervalTree_1.recomputeMaxEnd)(node)}}onBeforeAttached(){this._attachedEditorCount++,1===this._attachedEditorCount&&(this._tokenization.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}onBeforeDetached(){this._attachedEditorCount--,0===this._attachedEditorCount&&(this._tokenization.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let smallLineCharCount=0,longLineCharCount=0;const lineCount=this._buffer.getLineCount();for(let lineNumber=1;lineNumber<=lineCount;lineNumber++){const lineLength=this._buffer.getLineLength(lineNumber);lineLength>=exports.LONG_LINE_BOUNDARY?longLineCharCount+=lineLength:smallLineCharCount+=lineLength}return longLineCharCount>smallLineCharCount}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(_newOpts){this._assertNotDisposed();const tabSize=void 0!==_newOpts.tabSize?_newOpts.tabSize:this._options.tabSize,indentSize=void 0!==_newOpts.indentSize?_newOpts.indentSize:this._options.indentSize,insertSpaces=void 0!==_newOpts.insertSpaces?_newOpts.insertSpaces:this._options.insertSpaces,trimAutoWhitespace=void 0!==_newOpts.trimAutoWhitespace?_newOpts.trimAutoWhitespace:this._options.trimAutoWhitespace,bracketPairColorizationOptions=void 0!==_newOpts.bracketColorizationOptions?_newOpts.bracketColorizationOptions:this._options.bracketPairColorizationOptions,newOpts=new model.TextModelResolvedOptions({tabSize,indentSize,insertSpaces,defaultEOL:this._options.defaultEOL,trimAutoWhitespace,bracketPairColorizationOptions});if(this._options.equals(newOpts))return;const e=this._options.createChangeEvent(newOpts);this._options=newOpts,this._bracketPairColorizer.handleDidChangeOptions(e),this._decorationProvider.handleDidChangeOptions(e),this._onDidChangeOptions.fire(e)}detectIndentation(defaultInsertSpaces,defaultTabSize){this._assertNotDisposed();const guessedIndentation=(0,indentationGuesser_1.guessIndentation)(this._buffer,defaultTabSize,defaultInsertSpaces);this.updateOptions({insertSpaces:guessedIndentation.insertSpaces,tabSize:guessedIndentation.tabSize,indentSize:guessedIndentation.tabSize})}normalizeIndentation(str){return this._assertNotDisposed(),(0,indentation_1.normalizeIndentation)(str,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(selections=null){const matches=this.findMatches(strings.UNUSUAL_LINE_TERMINATORS.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(selections,matches.map((m=>({range:m.range,text:null}))),(()=>null))}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(rawPosition){this._assertNotDisposed();const position=this._validatePosition(rawPosition.lineNumber,rawPosition.column,0);return this._buffer.getOffsetAt(position.lineNumber,position.column)}getPositionAt(rawOffset){this._assertNotDisposed();const offset=Math.min(this._buffer.getLength(),Math.max(0,rawOffset));return this._buffer.getPositionAt(offset)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(versionId){this._versionId=versionId}_overwriteAlternativeVersionId(newAlternativeVersionId){this._alternativeVersionId=newAlternativeVersionId}_overwriteInitialUndoRedoSnapshot(newInitialUndoRedoSnapshot){this._initialUndoRedoSnapshot=newInitialUndoRedoSnapshot}getValue(eol,preserveBOM=!1){this._assertNotDisposed();const fullModelRange=this.getFullModelRange(),fullModelValue=this.getValueInRange(fullModelRange,eol);return preserveBOM?this._buffer.getBOM()+fullModelValue:fullModelValue}createSnapshot(preserveBOM=!1){return new TextModelSnapshot(this._buffer.createSnapshot(preserveBOM))}getValueLength(eol,preserveBOM=!1){this._assertNotDisposed();const fullModelRange=this.getFullModelRange(),fullModelValue=this.getValueLengthInRange(fullModelRange,eol);return preserveBOM?this._buffer.getBOM().length+fullModelValue:fullModelValue}getValueInRange(rawRange,eol=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(rawRange),eol)}getValueLengthInRange(rawRange,eol=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(rawRange),eol)}getCharacterCountInRange(rawRange,eol=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(rawRange),eol)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(lineNumber){if(this._assertNotDisposed(),lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(lineNumber)}getLineLength(lineNumber){if(this._assertNotDisposed(),lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(lineNumber)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),"\n"===this._buffer.getEOL()?0:1}getLineMinColumn(lineNumber){return this._assertNotDisposed(),1}getLineMaxColumn(lineNumber){if(this._assertNotDisposed(),lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(lineNumber)+1}getLineFirstNonWhitespaceColumn(lineNumber){if(this._assertNotDisposed(),lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(lineNumber)}getLineLastNonWhitespaceColumn(lineNumber){if(this._assertNotDisposed(),lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(lineNumber)}_validateRangeRelaxedNoAllocations(range){const linesCount=this._buffer.getLineCount(),initialStartLineNumber=range.startLineNumber,initialStartColumn=range.startColumn;let startLineNumber=Math.floor("number"!=typeof initialStartLineNumber||isNaN(initialStartLineNumber)?1:initialStartLineNumber),startColumn=Math.floor("number"!=typeof initialStartColumn||isNaN(initialStartColumn)?1:initialStartColumn);if(startLineNumber<1)startLineNumber=1,startColumn=1;else if(startLineNumber>linesCount)startLineNumber=linesCount,startColumn=this.getLineMaxColumn(startLineNumber);else if(startColumn<=1)startColumn=1;else{const maxColumn=this.getLineMaxColumn(startLineNumber);startColumn>=maxColumn&&(startColumn=maxColumn)}const initialEndLineNumber=range.endLineNumber,initialEndColumn=range.endColumn;let endLineNumber=Math.floor("number"!=typeof initialEndLineNumber||isNaN(initialEndLineNumber)?1:initialEndLineNumber),endColumn=Math.floor("number"!=typeof initialEndColumn||isNaN(initialEndColumn)?1:initialEndColumn);if(endLineNumber<1)endLineNumber=1,endColumn=1;else if(endLineNumber>linesCount)endLineNumber=linesCount,endColumn=this.getLineMaxColumn(endLineNumber);else if(endColumn<=1)endColumn=1;else{const maxColumn=this.getLineMaxColumn(endLineNumber);endColumn>=maxColumn&&(endColumn=maxColumn)}return initialStartLineNumber===startLineNumber&&initialStartColumn===startColumn&&initialEndLineNumber===endLineNumber&&initialEndColumn===endColumn&&range instanceof range_1.Range&&!(range instanceof selection_1.Selection)?range:new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn)}_isValidPosition(lineNumber,column,validationType){if("number"!=typeof lineNumber||"number"!=typeof column)return!1;if(isNaN(lineNumber)||isNaN(column))return!1;if(lineNumber<1||column<1)return!1;if((0|lineNumber)!==lineNumber||(0|column)!==column)return!1;if(lineNumber>this._buffer.getLineCount())return!1;if(1===column)return!0;if(column>this.getLineMaxColumn(lineNumber))return!1;if(1===validationType){const charCodeBefore=this._buffer.getLineCharCode(lineNumber,column-2);if(strings.isHighSurrogate(charCodeBefore))return!1}return!0}_validatePosition(_lineNumber,_column,validationType){const lineNumber=Math.floor("number"!=typeof _lineNumber||isNaN(_lineNumber)?1:_lineNumber),column=Math.floor("number"!=typeof _column||isNaN(_column)?1:_column),lineCount=this._buffer.getLineCount();if(lineNumber<1)return new position_1.Position(1,1);if(lineNumber>lineCount)return new position_1.Position(lineCount,this.getLineMaxColumn(lineCount));if(column<=1)return new position_1.Position(lineNumber,1);const maxColumn=this.getLineMaxColumn(lineNumber);if(column>=maxColumn)return new position_1.Position(lineNumber,maxColumn);if(1===validationType){const charCodeBefore=this._buffer.getLineCharCode(lineNumber,column-2);if(strings.isHighSurrogate(charCodeBefore))return new position_1.Position(lineNumber,column-1)}return new position_1.Position(lineNumber,column)}validatePosition(position){return this._assertNotDisposed(),position instanceof position_1.Position&&this._isValidPosition(position.lineNumber,position.column,1)?position:this._validatePosition(position.lineNumber,position.column,1)}_isValidRange(range,validationType){const startLineNumber=range.startLineNumber,startColumn=range.startColumn,endLineNumber=range.endLineNumber,endColumn=range.endColumn;if(!this._isValidPosition(startLineNumber,startColumn,0))return!1;if(!this._isValidPosition(endLineNumber,endColumn,0))return!1;if(1===validationType){const charCodeBeforeStart=startColumn>1?this._buffer.getLineCharCode(startLineNumber,startColumn-2):0,charCodeBeforeEnd=endColumn>1&&endColumn<=this._buffer.getLineLength(endLineNumber)?this._buffer.getLineCharCode(endLineNumber,endColumn-2):0,startInsideSurrogatePair=strings.isHighSurrogate(charCodeBeforeStart),endInsideSurrogatePair=strings.isHighSurrogate(charCodeBeforeEnd);return!startInsideSurrogatePair&&!endInsideSurrogatePair}return!0}validateRange(_range){if(this._assertNotDisposed(),_range instanceof range_1.Range&&!(_range instanceof selection_1.Selection)&&this._isValidRange(_range,1))return _range;const start=this._validatePosition(_range.startLineNumber,_range.startColumn,0),end=this._validatePosition(_range.endLineNumber,_range.endColumn,0),startLineNumber=start.lineNumber,startColumn=start.column,endLineNumber=end.lineNumber,endColumn=end.column;{const charCodeBeforeStart=startColumn>1?this._buffer.getLineCharCode(startLineNumber,startColumn-2):0,charCodeBeforeEnd=endColumn>1&&endColumn<=this._buffer.getLineLength(endLineNumber)?this._buffer.getLineCharCode(endLineNumber,endColumn-2):0,startInsideSurrogatePair=strings.isHighSurrogate(charCodeBeforeStart),endInsideSurrogatePair=strings.isHighSurrogate(charCodeBeforeEnd);return startInsideSurrogatePair||endInsideSurrogatePair?startLineNumber===endLineNumber&&startColumn===endColumn?new range_1.Range(startLineNumber,startColumn-1,endLineNumber,endColumn-1):startInsideSurrogatePair&&endInsideSurrogatePair?new range_1.Range(startLineNumber,startColumn-1,endLineNumber,endColumn+1):startInsideSurrogatePair?new range_1.Range(startLineNumber,startColumn-1,endLineNumber,endColumn):new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn+1):new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn)}}modifyPosition(rawPosition,offset){this._assertNotDisposed();const candidate=this.getOffsetAt(rawPosition)+offset;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,candidate)))}getFullModelRange(){this._assertNotDisposed();const lineCount=this.getLineCount();return new range_1.Range(1,1,lineCount,this.getLineMaxColumn(lineCount))}findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount){return this._buffer.findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount)}findMatches(searchString,rawSearchScope,isRegex,matchCase,wordSeparators,captureMatches,limitResultCount=999){this._assertNotDisposed();let searchRanges=null;null!==rawSearchScope&&(Array.isArray(rawSearchScope)||(rawSearchScope=[rawSearchScope]),rawSearchScope.every((searchScope=>range_1.Range.isIRange(searchScope)))&&(searchRanges=rawSearchScope.map((searchScope=>this.validateRange(searchScope))))),null===searchRanges&&(searchRanges=[this.getFullModelRange()]),searchRanges=searchRanges.sort(((d1,d2)=>d1.startLineNumber-d2.startLineNumber||d1.startColumn-d2.startColumn));const uniqueSearchRanges=[];let matchMapper;if(uniqueSearchRanges.push(searchRanges.reduce(((prev,curr)=>range_1.Range.areIntersecting(prev,curr)?prev.plusRange(curr):(uniqueSearchRanges.push(prev),curr)))),!isRegex&&searchString.indexOf("\n")<0){const searchData=new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators).parseSearchRequest();if(!searchData)return[];matchMapper=searchRange=>this.findMatchesLineByLine(searchRange,searchData,captureMatches,limitResultCount)}else matchMapper=searchRange=>textModelSearch_1.TextModelSearch.findMatches(this,new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators),searchRange,captureMatches,limitResultCount);return uniqueSearchRanges.map(matchMapper).reduce(((arr,matches)=>arr.concat(matches)),[])}findNextMatch(searchString,rawSearchStart,isRegex,matchCase,wordSeparators,captureMatches){this._assertNotDisposed();const searchStart=this.validatePosition(rawSearchStart);if(!isRegex&&searchString.indexOf("\n")<0){const searchData=new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators).parseSearchRequest();if(!searchData)return null;const lineCount=this.getLineCount();let searchRange=new range_1.Range(searchStart.lineNumber,searchStart.column,lineCount,this.getLineMaxColumn(lineCount)),ret=this.findMatchesLineByLine(searchRange,searchData,captureMatches,1);return textModelSearch_1.TextModelSearch.findNextMatch(this,new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators),searchStart,captureMatches),ret.length>0?ret[0]:(searchRange=new range_1.Range(1,1,searchStart.lineNumber,this.getLineMaxColumn(searchStart.lineNumber)),ret=this.findMatchesLineByLine(searchRange,searchData,captureMatches,1),ret.length>0?ret[0]:null)}return textModelSearch_1.TextModelSearch.findNextMatch(this,new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators),searchStart,captureMatches)}findPreviousMatch(searchString,rawSearchStart,isRegex,matchCase,wordSeparators,captureMatches){this._assertNotDisposed();const searchStart=this.validatePosition(rawSearchStart);return textModelSearch_1.TextModelSearch.findPreviousMatch(this,new textModelSearch_1.SearchParams(searchString,isRegex,matchCase,wordSeparators),searchStart,captureMatches)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(eol){if(("\n"===this.getEOL()?0:1)!==eol)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(eol)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(rawOperation){return rawOperation instanceof model.ValidAnnotatedEditOperation?rawOperation:new model.ValidAnnotatedEditOperation(rawOperation.identifier||null,this.validateRange(rawOperation.range),rawOperation.text,rawOperation.forceMoveMarkers||!1,rawOperation.isAutoWhitespaceEdit||!1,rawOperation._isTracked||!1)}_validateEditOperations(rawOperations){const result=[];for(let i=0,len=rawOperations.length;i<len;i++)result[i]=this._validateEditOperation(rawOperations[i]);return result}pushEditOperations(beforeCursorState,editOperations,cursorStateComputer){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(beforeCursorState,this._validateEditOperations(editOperations),cursorStateComputer)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(beforeCursorState,editOperations,cursorStateComputer){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const incomingEdits=editOperations.map((op=>({range:this.validateRange(op.range),text:op.text})));let editsAreNearCursors=!0;if(beforeCursorState)for(let i=0,len=beforeCursorState.length;i<len;i++){const sel=beforeCursorState[i];let foundEditNearSel=!1;for(let j=0,lenJ=incomingEdits.length;j<lenJ;j++){const editRange=incomingEdits[j].range,selIsAbove=editRange.startLineNumber>sel.endLineNumber,selIsBelow=sel.startLineNumber>editRange.endLineNumber;if(!selIsAbove&&!selIsBelow){foundEditNearSel=!0;break}}if(!foundEditNearSel){editsAreNearCursors=!1;break}}if(editsAreNearCursors)for(let i=0,len=this._trimAutoWhitespaceLines.length;i<len;i++){const trimLineNumber=this._trimAutoWhitespaceLines[i],maxLineColumn=this.getLineMaxColumn(trimLineNumber);let allowTrimLine=!0;for(let j=0,lenJ=incomingEdits.length;j<lenJ;j++){const editRange=incomingEdits[j].range,editText=incomingEdits[j].text;if(!(trimLineNumber<editRange.startLineNumber||trimLineNumber>editRange.endLineNumber)&&!(trimLineNumber===editRange.startLineNumber&&editRange.startColumn===maxLineColumn&&editRange.isEmpty()&&editText&&editText.length>0&&"\n"===editText.charAt(0)||trimLineNumber===editRange.startLineNumber&&1===editRange.startColumn&&editRange.isEmpty()&&editText&&editText.length>0&&"\n"===editText.charAt(editText.length-1))){allowTrimLine=!1;break}}if(allowTrimLine){const trimRange=new range_1.Range(trimLineNumber,1,trimLineNumber,maxLineColumn);editOperations.push(new model.ValidAnnotatedEditOperation(null,trimRange,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(beforeCursorState,editOperations,cursorStateComputer)}_applyUndo(changes,eol,resultingAlternativeVersionId,resultingSelection){const edits=changes.map((change=>{const rangeStart=this.getPositionAt(change.newPosition),rangeEnd=this.getPositionAt(change.newEnd);return{range:new range_1.Range(rangeStart.lineNumber,rangeStart.column,rangeEnd.lineNumber,rangeEnd.column),text:change.oldText}}));this._applyUndoRedoEdits(edits,eol,!0,!1,resultingAlternativeVersionId,resultingSelection)}_applyRedo(changes,eol,resultingAlternativeVersionId,resultingSelection){const edits=changes.map((change=>{const rangeStart=this.getPositionAt(change.oldPosition),rangeEnd=this.getPositionAt(change.oldEnd);return{range:new range_1.Range(rangeStart.lineNumber,rangeStart.column,rangeEnd.lineNumber,rangeEnd.column),text:change.newText}}));this._applyUndoRedoEdits(edits,eol,!1,!0,resultingAlternativeVersionId,resultingSelection)}_applyUndoRedoEdits(edits,eol,isUndoing,isRedoing,resultingAlternativeVersionId,resultingSelection){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=isUndoing,this._isRedoing=isRedoing,this.applyEdits(edits,!1),this.setEOL(eol),this._overwriteAlternativeVersionId(resultingAlternativeVersionId)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(resultingSelection),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(rawOperations,computeUndoEdits=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const operations=this._validateEditOperations(rawOperations);return this._doApplyEdits(operations,computeUndoEdits)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(rawOperations,computeUndoEdits){const oldLineCount=this._buffer.getLineCount(),result=this._buffer.applyEdits(rawOperations,this._options.trimAutoWhitespace,computeUndoEdits),newLineCount=this._buffer.getLineCount(),contentChanges=result.changes;if(this._trimAutoWhitespaceLines=result.trimAutoWhitespaceLineNumbers,0!==contentChanges.length){for(let i=0,len=contentChanges.length;i<len;i++){const change=contentChanges[i],[eolCount,firstLineLength,lastLineLength]=(0,eolCounter_1.countEOL)(change.text);this._tokens.acceptEdit(change.range,eolCount,firstLineLength),this._semanticTokens.acceptEdit(change.range,eolCount,firstLineLength,lastLineLength,change.text.length>0?change.text.charCodeAt(0):0),this._decorationsTree.acceptReplace(change.rangeOffset,change.rangeLength,change.text.length,change.forceMoveMarkers)}const rawContentChanges=[];this._increaseVersionId();let lineCount=oldLineCount;for(let i=0,len=contentChanges.length;i<len;i++){const change=contentChanges[i],[eolCount]=(0,eolCounter_1.countEOL)(change.text);this._onDidChangeDecorations.fire();const startLineNumber=change.range.startLineNumber,endLineNumber=change.range.endLineNumber,deletingLinesCnt=endLineNumber-startLineNumber,insertingLinesCnt=eolCount,editingLinesCnt=Math.min(deletingLinesCnt,insertingLinesCnt),changeLineCountDelta=insertingLinesCnt-deletingLinesCnt,currentEditStartLineNumber=newLineCount-lineCount-changeLineCountDelta+startLineNumber,firstEditLineNumber=currentEditStartLineNumber,lastInsertedLineNumber=currentEditStartLineNumber+insertingLinesCnt,decorationsWithInjectedTextInEditedRange=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new position_1.Position(firstEditLineNumber,1)),this.getOffsetAt(new position_1.Position(lastInsertedLineNumber,this.getLineMaxColumn(lastInsertedLineNumber))),0),injectedTextInEditedRange=textModelEvents_1.LineInjectedText.fromDecorations(decorationsWithInjectedTextInEditedRange),injectedTextInEditedRangeQueue=new arrays_1.ArrayQueue(injectedTextInEditedRange);for(let j=editingLinesCnt;j>=0;j--){const editLineNumber=startLineNumber+j,currentEditLineNumber=currentEditStartLineNumber+j;injectedTextInEditedRangeQueue.takeFromEndWhile((r=>r.lineNumber>currentEditLineNumber));const decorationsInCurrentLine=injectedTextInEditedRangeQueue.takeFromEndWhile((r=>r.lineNumber===currentEditLineNumber));rawContentChanges.push(new textModelEvents_1.ModelRawLineChanged(editLineNumber,this.getLineContent(currentEditLineNumber),decorationsInCurrentLine))}if(editingLinesCnt<deletingLinesCnt){const spliceStartLineNumber=startLineNumber+editingLinesCnt;rawContentChanges.push(new textModelEvents_1.ModelRawLinesDeleted(spliceStartLineNumber+1,endLineNumber))}if(editingLinesCnt<insertingLinesCnt){const injectedTextInEditedRangeQueue=new arrays_1.ArrayQueue(injectedTextInEditedRange),spliceLineNumber=startLineNumber+editingLinesCnt,cnt=insertingLinesCnt-editingLinesCnt,fromLineNumber=newLineCount-lineCount-cnt+spliceLineNumber+1,injectedTexts=[],newLines=[];for(let i=0;i<cnt;i++){const lineNumber=fromLineNumber+i;newLines[i]=this.getLineContent(lineNumber),injectedTextInEditedRangeQueue.takeWhile((r=>r.lineNumber<lineNumber)),injectedTexts[i]=injectedTextInEditedRangeQueue.takeWhile((r=>r.lineNumber===lineNumber))}rawContentChanges.push(new textModelEvents_1.ModelRawLinesInserted(spliceLineNumber+1,startLineNumber+insertingLinesCnt,newLines,injectedTexts))}lineCount+=changeLineCountDelta}this._emitContentChangedEvent(new textModelEvents_1.ModelRawContentChangedEvent(rawContentChanges,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:contentChanges,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return null===result.reverseEdits?void 0:result.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(affectedInjectedTextLines){if(null===affectedInjectedTextLines||0===affectedInjectedTextLines.size)return;const lineChangeEvents=[...affectedInjectedTextLines].map((lineNumber=>new textModelEvents_1.ModelRawLineChanged(lineNumber,this.getLineContent(lineNumber),this._getInjectedTextInLine(lineNumber))));this._onDidChangeInjectedText.fire(new textModelEvents_1.ModelInjectedTextChangedEvent(lineChangeEvents))}changeDecorations(callback,ownerId=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(ownerId,callback)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(ownerId,callback){const changeAccessor={addDecoration:(range,options)=>this._deltaDecorationsImpl(ownerId,[],[{range,options}])[0],changeDecoration:(id,newRange)=>{this._changeDecorationImpl(id,newRange)},changeDecorationOptions:(id,options)=>{this._changeDecorationOptionsImpl(id,_normalizeOptions(options))},removeDecoration:id=>{this._deltaDecorationsImpl(ownerId,[id],[])},deltaDecorations:(oldDecorations,newDecorations)=>0===oldDecorations.length&&0===newDecorations.length?[]:this._deltaDecorationsImpl(ownerId,oldDecorations,newDecorations)};let result=null;try{result=callback(changeAccessor)}catch(e){(0,errors_1.onUnexpectedError)(e)}return changeAccessor.addDecoration=invalidFunc,changeAccessor.changeDecoration=invalidFunc,changeAccessor.changeDecorationOptions=invalidFunc,changeAccessor.removeDecoration=invalidFunc,changeAccessor.deltaDecorations=invalidFunc,result}deltaDecorations(oldDecorations,newDecorations,ownerId=0){if(this._assertNotDisposed(),oldDecorations||(oldDecorations=[]),0===oldDecorations.length&&0===newDecorations.length)return[];try{return this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(ownerId,oldDecorations,newDecorations)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_getTrackedRange(id){return this.getDecorationRange(id)}_setTrackedRange(id,newRange,newStickiness){const node=id?this._decorations[id]:null;if(!node)return newRange?this._deltaDecorationsImpl(0,[],[{range:newRange,options:TRACKED_RANGE_OPTIONS[newStickiness]}])[0]:null;if(!newRange)return this._decorationsTree.delete(node),delete this._decorations[node.id],null;const range=this._validateRangeRelaxedNoAllocations(newRange),startOffset=this._buffer.getOffsetAt(range.startLineNumber,range.startColumn),endOffset=this._buffer.getOffsetAt(range.endLineNumber,range.endColumn);return this._decorationsTree.delete(node),node.reset(this.getVersionId(),startOffset,endOffset,range),node.setOptions(TRACKED_RANGE_OPTIONS[newStickiness]),this._decorationsTree.insert(node),node.id}removeAllDecorationsWithOwnerId(ownerId){if(this._isDisposed)return;const nodes=this._decorationsTree.collectNodesFromOwner(ownerId);for(let i=0,len=nodes.length;i<len;i++){const node=nodes[i];this._decorationsTree.delete(node),delete this._decorations[node.id]}}getDecorationOptions(decorationId){const node=this._decorations[decorationId];return node?node.options:null}getDecorationRange(decorationId){const node=this._decorations[decorationId];return node?this._decorationsTree.getNodeRange(this,node):null}getLineDecorations(lineNumber,ownerId=0,filterOutValidation=!1){return lineNumber<1||lineNumber>this.getLineCount()?[]:this.getLinesDecorations(lineNumber,lineNumber,ownerId,filterOutValidation)}getLinesDecorations(_startLineNumber,_endLineNumber,ownerId=0,filterOutValidation=!1){const lineCount=this.getLineCount(),startLineNumber=Math.min(lineCount,Math.max(1,_startLineNumber)),endLineNumber=Math.min(lineCount,Math.max(1,_endLineNumber)),endColumn=this.getLineMaxColumn(endLineNumber),range=new range_1.Range(startLineNumber,1,endLineNumber,endColumn),decorations=this._getDecorationsInRange(range,ownerId,filterOutValidation);return decorations.push(...this._decorationProvider.getDecorationsInRange(range,ownerId,filterOutValidation)),decorations}getDecorationsInRange(range,ownerId=0,filterOutValidation=!1){const validatedRange=this.validateRange(range),decorations=this._getDecorationsInRange(validatedRange,ownerId,filterOutValidation);return decorations.push(...this._decorationProvider.getDecorationsInRange(validatedRange,ownerId,filterOutValidation)),decorations}getOverviewRulerDecorations(ownerId=0,filterOutValidation=!1){return this._decorationsTree.getAll(this,ownerId,filterOutValidation,!0)}getInjectedTextDecorations(ownerId=0){return this._decorationsTree.getAllInjectedText(this,ownerId)}_getInjectedTextInLine(lineNumber){const startOffset=this._buffer.getOffsetAt(lineNumber,1),endOffset=startOffset+this._buffer.getLineLength(lineNumber),result=this._decorationsTree.getInjectedTextInInterval(this,startOffset,endOffset,0);return textModelEvents_1.LineInjectedText.fromDecorations(result).filter((t=>t.lineNumber===lineNumber))}getAllDecorations(ownerId=0,filterOutValidation=!1){let result=this._decorationsTree.getAll(this,ownerId,filterOutValidation,!1);return result=result.concat(this._decorationProvider.getAllDecorations(ownerId,filterOutValidation)),result}_getDecorationsInRange(filterRange,filterOwnerId,filterOutValidation){const startOffset=this._buffer.getOffsetAt(filterRange.startLineNumber,filterRange.startColumn),endOffset=this._buffer.getOffsetAt(filterRange.endLineNumber,filterRange.endColumn);return this._decorationsTree.getAllInInterval(this,startOffset,endOffset,filterOwnerId,filterOutValidation)}getRangeAt(start,end){return this._buffer.getRangeAt(start,end-start)}_changeDecorationImpl(decorationId,_range){const node=this._decorations[decorationId];if(!node)return;if(node.options.after){const oldRange=this.getDecorationRange(decorationId);this._onDidChangeDecorations.recordLineAffectedByInjectedText(oldRange.endLineNumber)}if(node.options.before){const oldRange=this.getDecorationRange(decorationId);this._onDidChangeDecorations.recordLineAffectedByInjectedText(oldRange.startLineNumber)}const range=this._validateRangeRelaxedNoAllocations(_range),startOffset=this._buffer.getOffsetAt(range.startLineNumber,range.startColumn),endOffset=this._buffer.getOffsetAt(range.endLineNumber,range.endColumn);this._decorationsTree.delete(node),node.reset(this.getVersionId(),startOffset,endOffset,range),this._decorationsTree.insert(node),this._onDidChangeDecorations.checkAffectedAndFire(node.options),node.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(range.endLineNumber),node.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(range.startLineNumber)}_changeDecorationOptionsImpl(decorationId,options){const node=this._decorations[decorationId];if(!node)return;const nodeWasInOverviewRuler=!(!node.options.overviewRuler||!node.options.overviewRuler.color),nodeIsInOverviewRuler=!(!options.overviewRuler||!options.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(node.options),this._onDidChangeDecorations.checkAffectedAndFire(options),node.options.after||options.after){const nodeRange=this._decorationsTree.getNodeRange(this,node);this._onDidChangeDecorations.recordLineAffectedByInjectedText(nodeRange.endLineNumber)}if(node.options.before||options.before){const nodeRange=this._decorationsTree.getNodeRange(this,node);this._onDidChangeDecorations.recordLineAffectedByInjectedText(nodeRange.startLineNumber)}nodeWasInOverviewRuler!==nodeIsInOverviewRuler?(this._decorationsTree.delete(node),node.setOptions(options),this._decorationsTree.insert(node)):node.setOptions(options)}_deltaDecorationsImpl(ownerId,oldDecorationsIds,newDecorations){const versionId=this.getVersionId(),oldDecorationsLen=oldDecorationsIds.length;let oldDecorationIndex=0;const newDecorationsLen=newDecorations.length;let newDecorationIndex=0;const result=new Array(newDecorationsLen);for(;oldDecorationIndex<oldDecorationsLen||newDecorationIndex<newDecorationsLen;){let node=null;if(oldDecorationIndex<oldDecorationsLen){do{node=this._decorations[oldDecorationsIds[oldDecorationIndex++]]}while(!node&&oldDecorationIndex<oldDecorationsLen);if(node){if(node.options.after){const nodeRange=this._decorationsTree.getNodeRange(this,node);this._onDidChangeDecorations.recordLineAffectedByInjectedText(nodeRange.endLineNumber)}if(node.options.before){const nodeRange=this._decorationsTree.getNodeRange(this,node);this._onDidChangeDecorations.recordLineAffectedByInjectedText(nodeRange.startLineNumber)}this._decorationsTree.delete(node),this._onDidChangeDecorations.checkAffectedAndFire(node.options)}}if(newDecorationIndex<newDecorationsLen){if(!node){const internalDecorationId=++this._lastDecorationId,decorationId=`${this._instanceId};${internalDecorationId}`;node=new intervalTree_1.IntervalNode(decorationId,0,0),this._decorations[decorationId]=node}const newDecoration=newDecorations[newDecorationIndex],range=this._validateRangeRelaxedNoAllocations(newDecoration.range),options=_normalizeOptions(newDecoration.options),startOffset=this._buffer.getOffsetAt(range.startLineNumber,range.startColumn),endOffset=this._buffer.getOffsetAt(range.endLineNumber,range.endColumn);node.ownerId=ownerId,node.reset(versionId,startOffset,endOffset,range),node.setOptions(options),node.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(range.endLineNumber),node.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(range.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(options),this._decorationsTree.insert(node),result[newDecorationIndex]=node.id,newDecorationIndex++}else node&&delete this._decorations[node.id]}return result}setTokens(tokens,backgroundTokenizationCompleted=!1){if(0!==tokens.length){const ranges=[];for(let i=0,len=tokens.length;i<len;i++){const element=tokens[i];let minChangedLineNumber=0,maxChangedLineNumber=0,hasChange=!1;for(let lineNumber=element.startLineNumber;lineNumber<=element.endLineNumber;lineNumber++)if(hasChange)this._tokens.setTokens(this._languageId,lineNumber-1,this._buffer.getLineLength(lineNumber),element.getLineTokens(lineNumber),!1),maxChangedLineNumber=lineNumber;else{this._tokens.setTokens(this._languageId,lineNumber-1,this._buffer.getLineLength(lineNumber),element.getLineTokens(lineNumber),!0)&&(hasChange=!0,minChangedLineNumber=lineNumber,maxChangedLineNumber=lineNumber)}hasChange&&ranges.push({fromLineNumber:minChangedLineNumber,toLineNumber:maxChangedLineNumber})}ranges.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges})}this.handleTokenizationProgress(backgroundTokenizationCompleted)}setSemanticTokens(tokens,isComplete){this._semanticTokens.set(tokens,isComplete),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==tokens,ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(range,tokens){if(this.hasCompleteSemanticTokens())return;const changedRange=this.validateRange(this._semanticTokens.setPartial(range,tokens));this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:changedRange.startLineNumber,toLineNumber:changedRange.endLineNumber}]})}tokenizeViewport(startLineNumber,endLineNumber){startLineNumber=Math.max(1,startLineNumber),endLineNumber=Math.min(this._buffer.getLineCount(),endLineNumber),this._tokenization.tokenizeViewport(startLineNumber,endLineNumber)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._buffer.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._isDisposing||(this._bracketPairColorizer.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}resetTokenization(){this._tokenization.reset()}forceTokenization(lineNumber){if(lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(lineNumber)}isCheapToTokenize(lineNumber){return this._tokenization.isCheapToTokenize(lineNumber)}tokenizeIfCheap(lineNumber){this.isCheapToTokenize(lineNumber)&&this.forceTokenization(lineNumber)}getLineTokens(lineNumber){if(lineNumber<1||lineNumber>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(lineNumber)}_getLineTokens(lineNumber){const lineText=this.getLineContent(lineNumber),syntacticTokens=this._tokens.getTokens(this._languageId,lineNumber-1,lineText);return this._semanticTokens.addSparseTokens(lineNumber,syntacticTokens)}getLanguageId(){return this._languageId}setMode(languageId){if(this._languageId===languageId)return;const e={oldLanguage:this._languageId,newLanguage:languageId};this._languageId=languageId,this._bracketPairColorizer.handleDidChangeLanguage(e),this._tokenization.handleDidChangeLanguage(e),this._onDidChangeLanguage.fire(e),this._onDidChangeLanguageConfiguration.fire({})}getLanguageIdAtPosition(lineNumber,column){const position=this.validatePosition(new position_1.Position(lineNumber,column)),lineTokens=this.getLineTokens(position.lineNumber);return lineTokens.getLanguageId(lineTokens.findTokenIndexAtOffset(position.column-1))}getTokenTypeIfInsertingCharacter(lineNumber,column,character){const position=this.validatePosition(new position_1.Position(lineNumber,column));return this._tokenization.getTokenTypeIfInsertingCharacter(position,character)}tokenizeLineWithEdit(position,length,newText){const validatedPosition=this.validatePosition(position);return this._tokenization.tokenizeLineWithEdit(validatedPosition,length,newText)}getLanguageConfiguration(languageId){return this._languageConfigurationService.getLanguageConfiguration(languageId)}getWordAtPosition(_position){this._assertNotDisposed();const position=this.validatePosition(_position),lineContent=this.getLineContent(position.lineNumber),lineTokens=this._getLineTokens(position.lineNumber),tokenIndex=lineTokens.findTokenIndexAtOffset(position.column-1),[rbStartOffset,rbEndOffset]=TextModel._findLanguageBoundaries(lineTokens,tokenIndex),rightBiasedWord=(0,wordHelper_1.getWordAtText)(position.column,this.getLanguageConfiguration(lineTokens.getLanguageId(tokenIndex)).getWordDefinition(),lineContent.substring(rbStartOffset,rbEndOffset),rbStartOffset);if(rightBiasedWord&&rightBiasedWord.startColumn<=_position.column&&_position.column<=rightBiasedWord.endColumn)return rightBiasedWord;if(tokenIndex>0&&rbStartOffset===position.column-1){const[lbStartOffset,lbEndOffset]=TextModel._findLanguageBoundaries(lineTokens,tokenIndex-1),leftBiasedWord=(0,wordHelper_1.getWordAtText)(position.column,this.getLanguageConfiguration(lineTokens.getLanguageId(tokenIndex-1)).getWordDefinition(),lineContent.substring(lbStartOffset,lbEndOffset),lbStartOffset);if(leftBiasedWord&&leftBiasedWord.startColumn<=_position.column&&_position.column<=leftBiasedWord.endColumn)return leftBiasedWord}return null}static _findLanguageBoundaries(lineTokens,tokenIndex){const languageId=lineTokens.getLanguageId(tokenIndex);let startOffset=0;for(let i=tokenIndex;i>=0&&lineTokens.getLanguageId(i)===languageId;i--)startOffset=lineTokens.getStartOffset(i);let endOffset=lineTokens.getLineContent().length;for(let i=tokenIndex,tokenCount=lineTokens.getCount();i<tokenCount&&lineTokens.getLanguageId(i)===languageId;i++)endOffset=lineTokens.getEndOffset(i);return[startOffset,endOffset]}getWordUntilPosition(position){const wordAtPosition=this.getWordAtPosition(position);return wordAtPosition?{word:wordAtPosition.word.substr(0,position.column-wordAtPosition.startColumn),startColumn:wordAtPosition.startColumn,endColumn:position.column}:{word:"",startColumn:position.column,endColumn:position.column}}normalizePosition(position,affinity){return position}getLineIndentColumn(lineNumber){return function indentOfLine(line){let indent=0;for(const c of line){if(" "!==c&&"\t"!==c)break;indent++}return indent}(this.getLineContent(lineNumber))+1}};function isNodeInOverviewRuler(node){return!(!node.options.overviewRuler||!node.options.overviewRuler.color)}function isNodeInjectedText(node){return!!node.options.after||!!node.options.before}TextModel.MODEL_SYNC_LIMIT=52428800,TextModel.LARGE_FILE_SIZE_THRESHOLD=20971520,TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,TextModel.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.tabSize,indentSize:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.indentSize,insertSpaces:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,largeFileOptimizations:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.largeFileOptimizations,bracketPairColorizationOptions:textModelDefaults_1.EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions},TextModel=__decorate([__param(4,undoRedo_1.IUndoRedoService),__param(5,language_1.ILanguageService),__param(6,languageConfigurationRegistry_1.ILanguageConfigurationService)],TextModel),exports.TextModel=TextModel;class DecorationsTrees{constructor(){this._decorationsTree0=new intervalTree_1.IntervalTree,this._decorationsTree1=new intervalTree_1.IntervalTree,this._injectedTextDecorationsTree=new intervalTree_1.IntervalTree}ensureAllNodesHaveRanges(host){this.getAll(host,0,!1,!1)}_ensureNodesHaveRanges(host,nodes){for(const node of nodes)null===node.range&&(node.range=host.getRangeAt(node.cachedAbsoluteStart,node.cachedAbsoluteEnd));return nodes}getAllInInterval(host,start,end,filterOwnerId,filterOutValidation){const versionId=host.getVersionId(),result=this._intervalSearch(start,end,filterOwnerId,filterOutValidation,versionId);return this._ensureNodesHaveRanges(host,result)}_intervalSearch(start,end,filterOwnerId,filterOutValidation,cachedVersionId){const r0=this._decorationsTree0.intervalSearch(start,end,filterOwnerId,filterOutValidation,cachedVersionId),r1=this._decorationsTree1.intervalSearch(start,end,filterOwnerId,filterOutValidation,cachedVersionId),r2=this._injectedTextDecorationsTree.intervalSearch(start,end,filterOwnerId,filterOutValidation,cachedVersionId);return r0.concat(r1).concat(r2)}getInjectedTextInInterval(host,start,end,filterOwnerId){const versionId=host.getVersionId(),result=this._injectedTextDecorationsTree.intervalSearch(start,end,filterOwnerId,!1,versionId);return this._ensureNodesHaveRanges(host,result).filter((i=>i.options.showIfCollapsed||!i.range.isEmpty()))}getAllInjectedText(host,filterOwnerId){const versionId=host.getVersionId(),result=this._injectedTextDecorationsTree.search(filterOwnerId,!1,versionId);return this._ensureNodesHaveRanges(host,result).filter((i=>i.options.showIfCollapsed||!i.range.isEmpty()))}getAll(host,filterOwnerId,filterOutValidation,overviewRulerOnly){const versionId=host.getVersionId(),result=this._search(filterOwnerId,filterOutValidation,overviewRulerOnly,versionId);return this._ensureNodesHaveRanges(host,result)}_search(filterOwnerId,filterOutValidation,overviewRulerOnly,cachedVersionId){if(overviewRulerOnly)return this._decorationsTree1.search(filterOwnerId,filterOutValidation,cachedVersionId);{const r0=this._decorationsTree0.search(filterOwnerId,filterOutValidation,cachedVersionId),r1=this._decorationsTree1.search(filterOwnerId,filterOutValidation,cachedVersionId),r2=this._injectedTextDecorationsTree.search(filterOwnerId,filterOutValidation,cachedVersionId);return r0.concat(r1).concat(r2)}}collectNodesFromOwner(ownerId){const r0=this._decorationsTree0.collectNodesFromOwner(ownerId),r1=this._decorationsTree1.collectNodesFromOwner(ownerId),r2=this._injectedTextDecorationsTree.collectNodesFromOwner(ownerId);return r0.concat(r1).concat(r2)}collectNodesPostOrder(){const r0=this._decorationsTree0.collectNodesPostOrder(),r1=this._decorationsTree1.collectNodesPostOrder(),r2=this._injectedTextDecorationsTree.collectNodesPostOrder();return r0.concat(r1).concat(r2)}insert(node){isNodeInjectedText(node)?this._injectedTextDecorationsTree.insert(node):isNodeInOverviewRuler(node)?this._decorationsTree1.insert(node):this._decorationsTree0.insert(node)}delete(node){isNodeInjectedText(node)?this._injectedTextDecorationsTree.delete(node):isNodeInOverviewRuler(node)?this._decorationsTree1.delete(node):this._decorationsTree0.delete(node)}getNodeRange(host,node){const versionId=host.getVersionId();return node.cachedVersionId!==versionId&&this._resolveNode(node,versionId),null===node.range&&(node.range=host.getRangeAt(node.cachedAbsoluteStart,node.cachedAbsoluteEnd)),node.range}_resolveNode(node,cachedVersionId){isNodeInjectedText(node)?this._injectedTextDecorationsTree.resolveNode(node,cachedVersionId):isNodeInOverviewRuler(node)?this._decorationsTree1.resolveNode(node,cachedVersionId):this._decorationsTree0.resolveNode(node,cachedVersionId)}acceptReplace(offset,length,textLength,forceMoveMarkers){this._decorationsTree0.acceptReplace(offset,length,textLength,forceMoveMarkers),this._decorationsTree1.acceptReplace(offset,length,textLength,forceMoveMarkers),this._injectedTextDecorationsTree.acceptReplace(offset,length,textLength,forceMoveMarkers)}}function cleanClassName(className){return className.replace(/[^a-z0-9\-_]/gi," ")}class DecorationOptions{constructor(options){this.color=options.color||"",this.darkColor=options.darkColor||""}}class ModelDecorationOverviewRulerOptions extends DecorationOptions{constructor(options){super(options),this._resolvedColor=null,this.position="number"==typeof options.position?options.position:model.OverviewRulerLane.Center}getColor(theme){return this._resolvedColor||("light"!==theme.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,theme):this._resolvedColor=this._resolveColor(this.color,theme)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(color,theme){if("string"==typeof color)return color;const c=color?theme.getColor(color.id):null;return c?c.toString():""}}exports.ModelDecorationOverviewRulerOptions=ModelDecorationOverviewRulerOptions;class ModelDecorationMinimapOptions extends DecorationOptions{constructor(options){super(options),this.position=options.position}getColor(theme){return this._resolvedColor||("light"!==theme.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,theme):this._resolvedColor=this._resolveColor(this.color,theme)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(color,theme){return"string"==typeof color?color_1.Color.fromHex(color):theme.getColor(color.id)}}exports.ModelDecorationMinimapOptions=ModelDecorationMinimapOptions;class ModelDecorationInjectedTextOptions{constructor(options){this.content=options.content||"",this.inlineClassName=options.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=options.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=options.attachedData||null,this.cursorStops=options.cursorStops||null}static from(options){return options instanceof ModelDecorationInjectedTextOptions?options:new ModelDecorationInjectedTextOptions(options)}}exports.ModelDecorationInjectedTextOptions=ModelDecorationInjectedTextOptions;class ModelDecorationOptions{constructor(options){var _a,_b;this.description=options.description,this.stickiness=options.stickiness||0,this.zIndex=options.zIndex||0,this.className=options.className?cleanClassName(options.className):null,this.hoverMessage=options.hoverMessage||null,this.glyphMarginHoverMessage=options.glyphMarginHoverMessage||null,this.isWholeLine=options.isWholeLine||!1,this.showIfCollapsed=options.showIfCollapsed||!1,this.collapseOnReplaceEdit=options.collapseOnReplaceEdit||!1,this.overviewRuler=options.overviewRuler?new ModelDecorationOverviewRulerOptions(options.overviewRuler):null,this.minimap=options.minimap?new ModelDecorationMinimapOptions(options.minimap):null,this.glyphMarginClassName=options.glyphMarginClassName?cleanClassName(options.glyphMarginClassName):null,this.linesDecorationsClassName=options.linesDecorationsClassName?cleanClassName(options.linesDecorationsClassName):null,this.firstLineDecorationClassName=options.firstLineDecorationClassName?cleanClassName(options.firstLineDecorationClassName):null,this.marginClassName=options.marginClassName?cleanClassName(options.marginClassName):null,this.inlineClassName=options.inlineClassName?cleanClassName(options.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=options.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=options.beforeContentClassName?cleanClassName(options.beforeContentClassName):null,this.afterContentClassName=options.afterContentClassName?cleanClassName(options.afterContentClassName):null,this.after=options.after?ModelDecorationInjectedTextOptions.from(options.after):null,this.before=options.before?ModelDecorationInjectedTextOptions.from(options.before):null,this.hideInCommentTokens=null!==(_a=options.hideInCommentTokens)&&void 0!==_a&&_a,this.hideInStringTokens=null!==(_b=options.hideInStringTokens)&&void 0!==_b&&_b}static register(options){return new ModelDecorationOptions(options)}static createDynamic(options){return new ModelDecorationOptions(options)}}exports.ModelDecorationOptions=ModelDecorationOptions,ModelDecorationOptions.EMPTY=ModelDecorationOptions.register({description:"empty"});const TRACKED_RANGE_OPTIONS=[ModelDecorationOptions.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ModelDecorationOptions.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function _normalizeOptions(options){return options instanceof ModelDecorationOptions?options:ModelDecorationOptions.createDynamic(options)}class DidChangeDecorationsEmitter extends lifecycle_1.Disposable{constructor(handleBeforeFire){super(),this.handleBeforeFire=handleBeforeFire,this._actual=this._register(new event_1.Emitter),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var _a;if(this._deferredCnt--,0===this._deferredCnt){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const event={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(event)}null===(_a=this._affectedInjectedTextLines)||void 0===_a||_a.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(lineNumber){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(lineNumber)}checkAffectedAndFire(options){this._affectsMinimap||(this._affectsMinimap=!(!options.minimap||!options.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!(!options.overviewRuler||!options.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}exports.DidChangeDecorationsEmitter=DidChangeDecorationsEmitter;class DidChangeContentEmitter extends lifecycle_1.Disposable{constructor(){super(),this._fastEmitter=this._register(new event_1.Emitter),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new event_1.Emitter),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(resultingSelection=null){if(this._deferredCnt--,0===this._deferredCnt&&null!==this._deferredEvent){this._deferredEvent.rawContentChangedEvent.resultingSelection=resultingSelection;const e=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}fire(e){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e:(this._fastEmitter.fire(e),this._slowEmitter.fire(e))}}exports.DidChangeContentEmitter=DidChangeContentEmitter})),define(__m[297],__M([1,0,4,2,16,13,38,148,81,35,48,156,41,10,21,14,66,162,114,272,45,287,274,40,33,67,55,20]),(function(require,exports,event_1,lifecycle_1,platform,errors,textModel_1,textModelDefaults_1,modesRegistry_1,language_1,model_1,textResourceConfiguration_1,configuration_1,async_1,cancellation_1,themeService_1,log_1,undoRedo_1,hash_1,editStack_1,network_1,semanticTokensProviderStyling_1,getSemanticTokens_1,objects_1,languageConfigurationRegistry_1,languageFeatureDebounce_1,stopwatch_1,languageFeatures_1){"use strict";function MODEL_ID(resource){return resource.toString()}function computeModelSha1(model){const shaComputer=new hash_1.StringSHA1,snapshot=model.createSnapshot();let text;for(;text=snapshot.read();)shaComputer.update(text);return shaComputer.digest()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelSemanticColoring=exports.isSemanticColoringEnabled=exports.SEMANTIC_HIGHLIGHTING_SETTING_ID=exports.ModelService=void 0;class ModelData{constructor(model,onWillDispose,onDidChangeLanguage){this._modelEventListeners=new lifecycle_1.DisposableStore,this.model=model,this._languageSelection=null,this._languageSelectionListener=null,this._modelEventListeners.add(model.onWillDispose((()=>onWillDispose(model)))),this._modelEventListeners.add(model.onDidChangeLanguage((e=>onDidChangeLanguage(model,e))))}_disposeLanguageSelection(){this._languageSelectionListener&&(this._languageSelectionListener.dispose(),this._languageSelectionListener=null)}dispose(){this._modelEventListeners.dispose(),this._disposeLanguageSelection()}setLanguage(languageSelection){this._disposeLanguageSelection(),this._languageSelection=languageSelection,this._languageSelectionListener=this._languageSelection.onDidChange((()=>this.model.setMode(languageSelection.languageId))),this.model.setMode(languageSelection.languageId)}}const DEFAULT_EOL=platform.isLinux||platform.isMacintosh?1:2;class DisposedModelInfo{constructor(uri,initialUndoRedoSnapshot,time,sharesUndoRedoStack,heapSize,sha1,versionId,alternativeVersionId){this.uri=uri,this.initialUndoRedoSnapshot=initialUndoRedoSnapshot,this.time=time,this.sharesUndoRedoStack=sharesUndoRedoStack,this.heapSize=heapSize,this.sha1=sha1,this.versionId=versionId,this.alternativeVersionId=alternativeVersionId}}let ModelService=class ModelService extends lifecycle_1.Disposable{constructor(_configurationService,_resourcePropertiesService,_themeService,_logService,_undoRedoService,_languageService,_languageConfigurationService,_languageFeatureDebounceService,languageFeaturesService){super(),this._configurationService=_configurationService,this._resourcePropertiesService=_resourcePropertiesService,this._themeService=_themeService,this._logService=_logService,this._undoRedoService=_undoRedoService,this._languageService=_languageService,this._languageConfigurationService=_languageConfigurationService,this._languageFeatureDebounceService=_languageFeatureDebounceService,this._onModelAdded=this._register(new event_1.Emitter),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new event_1.Emitter),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new event_1.Emitter),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._semanticStyling=this._register(new SemanticStyling(this._themeService,this._languageService,this._logService)),this._register(this._configurationService.onDidChangeConfiguration((()=>this._updateModelOptions()))),this._updateModelOptions(),this._register(new SemanticColoringFeature(this._semanticStyling,this,this._themeService,this._configurationService,this._languageFeatureDebounceService,languageFeaturesService))}static _readModelOptions(config,isForSimpleWidget){var _a;let tabSize=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.tabSize;if(config.editor&&void 0!==config.editor.tabSize){const parsedTabSize=parseInt(config.editor.tabSize,10);isNaN(parsedTabSize)||(tabSize=parsedTabSize),tabSize<1&&(tabSize=1)}let indentSize=tabSize;if(config.editor&&void 0!==config.editor.indentSize&&"tabSize"!==config.editor.indentSize){const parsedIndentSize=parseInt(config.editor.indentSize,10);isNaN(parsedIndentSize)||(indentSize=parsedIndentSize),indentSize<1&&(indentSize=1)}let insertSpaces=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.insertSpaces;config.editor&&void 0!==config.editor.insertSpaces&&(insertSpaces="false"!==config.editor.insertSpaces&&Boolean(config.editor.insertSpaces));let newDefaultEOL=DEFAULT_EOL;const eol=config.eol;"\r\n"===eol?newDefaultEOL=2:"\n"===eol&&(newDefaultEOL=1);let trimAutoWhitespace=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.trimAutoWhitespace;config.editor&&void 0!==config.editor.trimAutoWhitespace&&(trimAutoWhitespace="false"!==config.editor.trimAutoWhitespace&&Boolean(config.editor.trimAutoWhitespace));let detectIndentation=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.detectIndentation;config.editor&&void 0!==config.editor.detectIndentation&&(detectIndentation="false"!==config.editor.detectIndentation&&Boolean(config.editor.detectIndentation));let largeFileOptimizations=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.largeFileOptimizations;config.editor&&void 0!==config.editor.largeFileOptimizations&&(largeFileOptimizations="false"!==config.editor.largeFileOptimizations&&Boolean(config.editor.largeFileOptimizations));let bracketPairColorizationOptions=textModelDefaults_1.EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions;return(null===(_a=config.editor)||void 0===_a?void 0:_a.bracketPairColorization)&&"object"==typeof config.editor.bracketPairColorization&&(bracketPairColorizationOptions={enabled:!!config.editor.bracketPairColorization.enabled}),{isForSimpleWidget,tabSize,indentSize,insertSpaces,detectIndentation,defaultEOL:newDefaultEOL,trimAutoWhitespace,largeFileOptimizations,bracketPairColorizationOptions}}_getEOL(resource,language){if(resource)return this._resourcePropertiesService.getEOL(resource,language);const eol=this._configurationService.getValue("files.eol",{overrideIdentifier:language});return eol&&"string"==typeof eol&&"auto"!==eol?eol:3===platform.OS||2===platform.OS?"\n":"\r\n"}_shouldRestoreUndoStack(){const result=this._configurationService.getValue("files.restoreUndoStack");return"boolean"!=typeof result||result}getCreationOptions(language,resource,isForSimpleWidget){let creationOptions=this._modelCreationOptionsByLanguageAndResource[language+resource];if(!creationOptions){const editor=this._configurationService.getValue("editor",{overrideIdentifier:language,resource}),eol=this._getEOL(resource,language);creationOptions=ModelService._readModelOptions({editor,eol},isForSimpleWidget),this._modelCreationOptionsByLanguageAndResource[language+resource]=creationOptions}return creationOptions}_updateModelOptions(){const oldOptionsByLanguageAndResource=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const keys=Object.keys(this._models);for(let i=0,len=keys.length;i<len;i++){const modelId=keys[i],modelData=this._models[modelId],language=modelData.model.getLanguageId(),uri=modelData.model.uri,oldOptions=oldOptionsByLanguageAndResource[language+uri],newOptions=this.getCreationOptions(language,uri,modelData.model.isForSimpleWidget);ModelService._setModelOptionsForModel(modelData.model,newOptions,oldOptions)}}static _setModelOptionsForModel(model,newOptions,currentOptions){currentOptions&&currentOptions.defaultEOL!==newOptions.defaultEOL&&1===model.getLineCount()&&model.setEOL(1===newOptions.defaultEOL?0:1),currentOptions&&currentOptions.detectIndentation===newOptions.detectIndentation&&currentOptions.insertSpaces===newOptions.insertSpaces&&currentOptions.tabSize===newOptions.tabSize&&currentOptions.indentSize===newOptions.indentSize&&currentOptions.trimAutoWhitespace===newOptions.trimAutoWhitespace&&(0,objects_1.equals)(currentOptions.bracketPairColorizationOptions,newOptions.bracketPairColorizationOptions)||(newOptions.detectIndentation?(model.detectIndentation(newOptions.insertSpaces,newOptions.tabSize),model.updateOptions({trimAutoWhitespace:newOptions.trimAutoWhitespace,bracketColorizationOptions:newOptions.bracketPairColorizationOptions})):model.updateOptions({insertSpaces:newOptions.insertSpaces,tabSize:newOptions.tabSize,indentSize:newOptions.indentSize,trimAutoWhitespace:newOptions.trimAutoWhitespace,bracketColorizationOptions:newOptions.bracketPairColorizationOptions}))}_insertDisposedModel(disposedModelData){this._disposedModels.set(MODEL_ID(disposedModelData.uri),disposedModelData),this._disposedModelsHeapSize+=disposedModelData.heapSize}_removeDisposedModel(resource){const disposedModelData=this._disposedModels.get(MODEL_ID(resource));return disposedModelData&&(this._disposedModelsHeapSize-=disposedModelData.heapSize),this._disposedModels.delete(MODEL_ID(resource)),disposedModelData}_ensureDisposedModelsHeapSize(maxModelsHeapSize){if(this._disposedModelsHeapSize>maxModelsHeapSize){const disposedModels=[];for(this._disposedModels.forEach((entry=>{entry.sharesUndoRedoStack||disposedModels.push(entry)})),disposedModels.sort(((a,b)=>a.time-b.time));disposedModels.length>0&&this._disposedModelsHeapSize>maxModelsHeapSize;){const disposedModel=disposedModels.shift();this._removeDisposedModel(disposedModel.uri),null!==disposedModel.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(disposedModel.initialUndoRedoSnapshot)}}}_createModelData(value,languageId,resource,isForSimpleWidget){const options=this.getCreationOptions(languageId,resource,isForSimpleWidget),model=new textModel_1.TextModel(value,languageId,options,resource,this._undoRedoService,this._languageService,this._languageConfigurationService);if(resource&&this._disposedModels.has(MODEL_ID(resource))){const disposedModelData=this._removeDisposedModel(resource),elements=this._undoRedoService.getElements(resource),sha1IsEqual=computeModelSha1(model)===disposedModelData.sha1;if(sha1IsEqual||disposedModelData.sharesUndoRedoStack){for(const element of elements.past)(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(resource)&&element.setModel(model);for(const element of elements.future)(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(resource)&&element.setModel(model);this._undoRedoService.setElementsValidFlag(resource,!0,(element=>(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(resource))),sha1IsEqual&&(model._overwriteVersionId(disposedModelData.versionId),model._overwriteAlternativeVersionId(disposedModelData.alternativeVersionId),model._overwriteInitialUndoRedoSnapshot(disposedModelData.initialUndoRedoSnapshot))}else null!==disposedModelData.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(disposedModelData.initialUndoRedoSnapshot)}const modelId=MODEL_ID(model.uri);if(this._models[modelId])throw new Error("ModelService: Cannot add model because it already exists!");const modelData=new ModelData(model,(model=>this._onWillDispose(model)),((model,e)=>this._onDidChangeLanguage(model,e)));return this._models[modelId]=modelData,modelData}createModel(value,languageSelection,resource,isForSimpleWidget=!1){let modelData;return languageSelection?(modelData=this._createModelData(value,languageSelection.languageId,resource,isForSimpleWidget),this.setMode(modelData.model,languageSelection)):modelData=this._createModelData(value,modesRegistry_1.PLAINTEXT_LANGUAGE_ID,resource,isForSimpleWidget),this._onModelAdded.fire(modelData.model),modelData.model}setMode(model,languageSelection){if(!languageSelection)return;const modelData=this._models[MODEL_ID(model.uri)];modelData&&modelData.setLanguage(languageSelection)}getModels(){const ret=[],keys=Object.keys(this._models);for(let i=0,len=keys.length;i<len;i++){const modelId=keys[i];ret.push(this._models[modelId].model)}return ret}getModel(resource){const modelId=MODEL_ID(resource),modelData=this._models[modelId];return modelData?modelData.model:null}getSemanticTokensProviderStyling(provider){return this._semanticStyling.get(provider)}_schemaShouldMaintainUndoRedoElements(resource){return resource.scheme===network_1.Schemas.file||resource.scheme===network_1.Schemas.vscodeRemote||resource.scheme===network_1.Schemas.userData||resource.scheme===network_1.Schemas.vscodeNotebookCell||"fake-fs"===resource.scheme}_onWillDispose(model){const modelId=MODEL_ID(model.uri),modelData=this._models[modelId],sharesUndoRedoStack=this._undoRedoService.getUriComparisonKey(model.uri)!==model.uri.toString();let maintainUndoRedoStack=!1,heapSize=0;if(sharesUndoRedoStack||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(model.uri)){const elements=this._undoRedoService.getElements(model.uri);if(elements.past.length>0||elements.future.length>0){for(const element of elements.past)(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(model.uri)&&(maintainUndoRedoStack=!0,heapSize+=element.heapSize(model.uri),element.setModel(model.uri));for(const element of elements.future)(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(model.uri)&&(maintainUndoRedoStack=!0,heapSize+=element.heapSize(model.uri),element.setModel(model.uri))}}const maxMemory=ModelService.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK;if(maintainUndoRedoStack)if(!sharesUndoRedoStack&&heapSize>maxMemory){const initialUndoRedoSnapshot=modelData.model.getInitialUndoRedoSnapshot();null!==initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(initialUndoRedoSnapshot)}else this._ensureDisposedModelsHeapSize(maxMemory-heapSize),this._undoRedoService.setElementsValidFlag(model.uri,!1,(element=>(0,editStack_1.isEditStackElement)(element)&&element.matchesResource(model.uri))),this._insertDisposedModel(new DisposedModelInfo(model.uri,modelData.model.getInitialUndoRedoSnapshot(),Date.now(),sharesUndoRedoStack,heapSize,computeModelSha1(model),model.getVersionId(),model.getAlternativeVersionId()));else if(!sharesUndoRedoStack){const initialUndoRedoSnapshot=modelData.model.getInitialUndoRedoSnapshot();null!==initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(initialUndoRedoSnapshot)}delete this._models[modelId],modelData.dispose(),delete this._modelCreationOptionsByLanguageAndResource[model.getLanguageId()+model.uri],this._onModelRemoved.fire(model)}_onDidChangeLanguage(model,e){const oldLanguageId=e.oldLanguage,newLanguageId=model.getLanguageId(),oldOptions=this.getCreationOptions(oldLanguageId,model.uri,model.isForSimpleWidget),newOptions=this.getCreationOptions(newLanguageId,model.uri,model.isForSimpleWidget);ModelService._setModelOptionsForModel(model,newOptions,oldOptions),this._onModelModeChanged.fire({model,oldLanguageId})}};function isSemanticColoringEnabled(model,themeService,configurationService){var _a;const setting=null===(_a=configurationService.getValue(exports.SEMANTIC_HIGHLIGHTING_SETTING_ID,{overrideIdentifier:model.getLanguageId(),resource:model.uri}))||void 0===_a?void 0:_a.enabled;return"boolean"==typeof setting?setting:themeService.getColorTheme().semanticHighlighting}ModelService.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20971520,ModelService=__decorate([__param(0,configuration_1.IConfigurationService),__param(1,textResourceConfiguration_1.ITextResourcePropertiesService),__param(2,themeService_1.IThemeService),__param(3,log_1.ILogService),__param(4,undoRedo_1.IUndoRedoService),__param(5,language_1.ILanguageService),__param(6,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(7,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(8,languageFeatures_1.ILanguageFeaturesService)],ModelService),exports.ModelService=ModelService,exports.SEMANTIC_HIGHLIGHTING_SETTING_ID="editor.semanticHighlighting",exports.isSemanticColoringEnabled=isSemanticColoringEnabled;let SemanticColoringFeature=class SemanticColoringFeature extends lifecycle_1.Disposable{constructor(semanticStyling,modelService,themeService,configurationService,languageFeatureDebounceService,languageFeaturesService){super(),this._watchers=Object.create(null),this._semanticStyling=semanticStyling;const register=model=>{this._watchers[model.uri.toString()]=new ModelSemanticColoring(model,this._semanticStyling,themeService,languageFeatureDebounceService,languageFeaturesService)},deregister=(model,modelSemanticColoring)=>{modelSemanticColoring.dispose(),delete this._watchers[model.uri.toString()]},handleSettingOrThemeChange=()=>{for(let model of modelService.getModels()){const curr=this._watchers[model.uri.toString()];isSemanticColoringEnabled(model,themeService,configurationService)?curr||register(model):curr&&deregister(model,curr)}};this._register(modelService.onModelAdded((model=>{isSemanticColoringEnabled(model,themeService,configurationService)&&register(model)}))),this._register(modelService.onModelRemoved((model=>{const curr=this._watchers[model.uri.toString()];curr&&deregister(model,curr)}))),this._register(configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration(exports.SEMANTIC_HIGHLIGHTING_SETTING_ID)&&handleSettingOrThemeChange()}))),this._register(themeService.onDidColorThemeChange(handleSettingOrThemeChange))}};SemanticColoringFeature=__decorate([__param(1,model_1.IModelService),__param(2,themeService_1.IThemeService),__param(3,configuration_1.IConfigurationService),__param(4,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(5,languageFeatures_1.ILanguageFeaturesService)],SemanticColoringFeature);class SemanticStyling extends lifecycle_1.Disposable{constructor(_themeService,_languageService,_logService){super(),this._themeService=_themeService,this._languageService=_languageService,this._logService=_logService,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange((()=>{this._caches=new WeakMap})))}get(provider){return this._caches.has(provider)||this._caches.set(provider,new semanticTokensProviderStyling_1.SemanticTokensProviderStyling(provider.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(provider)}}class SemanticTokensResponse{constructor(provider,resultId,data){this.provider=provider,this.resultId=resultId,this.data=data}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}let ModelSemanticColoring=class ModelSemanticColoring extends lifecycle_1.Disposable{constructor(model,stylingProvider,themeService,languageFeatureDebounceService,languageFeaturesService){super(),this._isDisposed=!1,this._model=model,this._semanticStyling=stylingProvider,this._provider=languageFeaturesService.documentSemanticTokensProvider,this._debounceInformation=languageFeatureDebounceService.for(this._provider,"DocumentSemanticTokens",{min:ModelSemanticColoring.REQUEST_MIN_DELAY,max:ModelSemanticColoring.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new async_1.RunOnceScheduler((()=>this._fetchDocumentSemanticTokensNow()),ModelSemanticColoring.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._register(this._model.onDidChangeContent((()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(this._model.onDidChangeLanguage((()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)})));const bindDocumentChangeListeners=()=>{(0,lifecycle_1.dispose)(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const provider of this._provider.all(model))"function"==typeof provider.onDidChange&&this._documentProvidersChangeListeners.push(provider.onDidChange((()=>this._fetchDocumentSemanticTokens.schedule(0))))};bindDocumentChangeListeners(),this._register(this._provider.onDidChange((()=>{bindDocumentChangeListeners(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(themeService.onDidColorThemeChange((_=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!(0,getSemanticTokens_1.hasDocumentSemanticTokensProvider)(this._provider,this._model))return void(this._currentDocumentResponse&&this._model.setSemanticTokens(null,!1));const cancellationTokenSource=new cancellation_1.CancellationTokenSource,lastProvider=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,lastResultId=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,request=(0,getSemanticTokens_1.getDocumentSemanticTokens)(this._provider,this._model,lastProvider,lastResultId,cancellationTokenSource.token);this._currentDocumentRequestCancellationTokenSource=cancellationTokenSource;const pendingChanges=[],contentChangeListener=this._model.onDidChangeContent((e=>{pendingChanges.push(e)})),sw=new stopwatch_1.StopWatch(!1);request.then((res=>{if(this._debounceInformation.update(this._model,sw.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,contentChangeListener.dispose(),res){const{provider,tokens}=res,styling=this._semanticStyling.get(provider);this._setDocumentSemanticTokens(provider,tokens||null,styling,pendingChanges)}else this._setDocumentSemanticTokens(null,null,null,pendingChanges)}),(err=>{err&&(errors.isCancellationError(err)||"string"==typeof err.message&&-1!==err.message.indexOf("busy"))||errors.onUnexpectedError(err),this._currentDocumentRequestCancellationTokenSource=null,contentChangeListener.dispose(),pendingChanges.length>0&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))}))}static _copy(src,srcOffset,dest,destOffset,length){for(let i=0;i<length;i++)dest[destOffset+i]=src[srcOffset+i]}_setDocumentSemanticTokens(provider,tokens,styling,pendingChanges){const currentResponse=this._currentDocumentResponse,rescheduleIfNeeded=()=>{pendingChanges.length>0&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed)provider&&tokens&&provider.releaseDocumentSemanticTokens(tokens.resultId);else if(provider&&styling){if(!tokens)return this._model.setSemanticTokens(null,!0),void rescheduleIfNeeded();if((0,getSemanticTokens_1.isSemanticTokensEdits)(tokens)){if(!currentResponse)return void this._model.setSemanticTokens(null,!0);if(0===tokens.edits.length)tokens={resultId:tokens.resultId,data:currentResponse.data};else{let deltaLength=0;for(const edit of tokens.edits)deltaLength+=(edit.data?edit.data.length:0)-edit.deleteCount;const srcData=currentResponse.data,destData=new Uint32Array(srcData.length+deltaLength);let srcLastStart=srcData.length,destLastStart=destData.length;for(let i=tokens.edits.length-1;i>=0;i--){const edit=tokens.edits[i],copyCount=srcLastStart-(edit.start+edit.deleteCount);copyCount>0&&(ModelSemanticColoring._copy(srcData,srcLastStart-copyCount,destData,destLastStart-copyCount,copyCount),destLastStart-=copyCount),edit.data&&(ModelSemanticColoring._copy(edit.data,0,destData,destLastStart-edit.data.length,edit.data.length),destLastStart-=edit.data.length),srcLastStart=edit.start}srcLastStart>0&&ModelSemanticColoring._copy(srcData,0,destData,0,srcLastStart),tokens={resultId:tokens.resultId,data:destData}}}if((0,getSemanticTokens_1.isSemanticTokens)(tokens)){this._currentDocumentResponse=new SemanticTokensResponse(provider,tokens.resultId,tokens.data);const result=(0,semanticTokensProviderStyling_1.toMultilineTokens2)(tokens,styling,this._model.getLanguageId());if(pendingChanges.length>0)for(const change of pendingChanges)for(const area of result)for(const singleChange of change.changes)area.applyEdit(singleChange.range,singleChange.text);this._model.setSemanticTokens(result,!0)}else this._model.setSemanticTokens(null,!0);rescheduleIfNeeded()}else this._model.setSemanticTokens(null,!1)}};ModelSemanticColoring.REQUEST_MIN_DELAY=300,ModelSemanticColoring.REQUEST_MAX_DELAY=2e3,ModelSemanticColoring=__decorate([__param(2,themeService_1.IThemeService),__param(3,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(4,languageFeatures_1.ILanguageFeaturesService)],ModelSemanticColoring),exports.ModelSemanticColoring=ModelSemanticColoring})),define(__m[715],__M([1,0,18,11,3,186,38,94,189,453,245,71]),(function(require,exports,arrays,position_1,range_1,textModelGuides_1,textModel_1,textModelEvents_1,viewEvents,modelLineProjection_1,prefixSumComputer_1,viewModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewModelLinesFromModelAsIs=exports.ViewModelLinesFromProjectedModel=void 0;exports.ViewModelLinesFromProjectedModel=class ViewModelLinesFromProjectedModel{constructor(editorId,model,domLineBreaksComputerFactory,monospaceLineBreaksComputerFactory,fontInfo,tabSize,wrappingStrategy,wrappingColumn,wrappingIndent){this._editorId=editorId,this.model=model,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=domLineBreaksComputerFactory,this._monospaceLineBreaksComputerFactory=monospaceLineBreaksComputerFactory,this.fontInfo=fontInfo,this.tabSize=tabSize,this.wrappingStrategy=wrappingStrategy,this.wrappingColumn=wrappingColumn,this.wrappingIndent=wrappingIndent,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new CoordinatesConverter(this)}_constructLines(resetHiddenAreas,previousLineBreaks){this.modelLineProjections=[],resetHiddenAreas&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const linesContent=this.model.getLinesContent(),injectedTextDecorations=this.model.getInjectedTextDecorations(this._editorId),lineCount=linesContent.length,lineBreaksComputer=this.createLineBreaksComputer(),injectedTextQueue=new arrays.ArrayQueue(textModelEvents_1.LineInjectedText.fromDecorations(injectedTextDecorations));for(let i=0;i<lineCount;i++){const lineInjectedText=injectedTextQueue.takeWhile((t=>t.lineNumber===i+1));lineBreaksComputer.addRequest(linesContent[i],lineInjectedText,previousLineBreaks?previousLineBreaks[i]:null)}const linesBreaks=lineBreaksComputer.finalize(),values=[],hiddenAreas=this.hiddenAreasDecorationIds.map((areaId=>this.model.getDecorationRange(areaId))).sort(range_1.Range.compareRangesUsingStarts);let hiddenAreaStart=1,hiddenAreaEnd=0,hiddenAreaIdx=-1,nextLineNumberToUpdateHiddenArea=hiddenAreaIdx+1<hiddenAreas.length?hiddenAreaEnd+1:lineCount+2;for(let i=0;i<lineCount;i++){const lineNumber=i+1;lineNumber===nextLineNumberToUpdateHiddenArea&&(hiddenAreaIdx++,hiddenAreaStart=hiddenAreas[hiddenAreaIdx].startLineNumber,hiddenAreaEnd=hiddenAreas[hiddenAreaIdx].endLineNumber,nextLineNumberToUpdateHiddenArea=hiddenAreaIdx+1<hiddenAreas.length?hiddenAreaEnd+1:lineCount+2);const isInHiddenArea=lineNumber>=hiddenAreaStart&&lineNumber<=hiddenAreaEnd,line=(0,modelLineProjection_1.createModelLineProjection)(linesBreaks[i],!isInHiddenArea);values[i]=line.getViewLineCount(),this.modelLineProjections[i]=line}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new prefixSumComputer_1.ConstantTimePrefixSumComputer(values)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map((decId=>this.model.getDecorationRange(decId)))}setHiddenAreas(_ranges){const newRanges=function normalizeLineRanges(ranges){if(0===ranges.length)return[];const sortedRanges=ranges.slice();sortedRanges.sort(range_1.Range.compareRangesUsingStarts);const result=[];let currentRangeStart=sortedRanges[0].startLineNumber,currentRangeEnd=sortedRanges[0].endLineNumber;for(let i=1,len=sortedRanges.length;i<len;i++){const range=sortedRanges[i];range.startLineNumber>currentRangeEnd+1?(result.push(new range_1.Range(currentRangeStart,1,currentRangeEnd,1)),currentRangeStart=range.startLineNumber,currentRangeEnd=range.endLineNumber):range.endLineNumber>currentRangeEnd&&(currentRangeEnd=range.endLineNumber)}return result.push(new range_1.Range(currentRangeStart,1,currentRangeEnd,1)),result}(_ranges.map((r=>this.model.validateRange(r)))),oldRanges=this.hiddenAreasDecorationIds.map((areaId=>this.model.getDecorationRange(areaId))).sort(range_1.Range.compareRangesUsingStarts);if(newRanges.length===oldRanges.length){let hasDifference=!1;for(let i=0;i<newRanges.length;i++)if(!newRanges[i].equalsRange(oldRanges[i])){hasDifference=!0;break}if(!hasDifference)return!1}const newDecorations=newRanges.map((r=>({range:r,options:textModel_1.ModelDecorationOptions.EMPTY})));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,newDecorations);const hiddenAreas=newRanges;let hiddenAreaStart=1,hiddenAreaEnd=0,hiddenAreaIdx=-1,nextLineNumberToUpdateHiddenArea=hiddenAreaIdx+1<hiddenAreas.length?hiddenAreaEnd+1:this.modelLineProjections.length+2,hasVisibleLine=!1;for(let i=0;i<this.modelLineProjections.length;i++){const lineNumber=i+1;lineNumber===nextLineNumberToUpdateHiddenArea&&(hiddenAreaIdx++,hiddenAreaStart=hiddenAreas[hiddenAreaIdx].startLineNumber,hiddenAreaEnd=hiddenAreas[hiddenAreaIdx].endLineNumber,nextLineNumberToUpdateHiddenArea=hiddenAreaIdx+1<hiddenAreas.length?hiddenAreaEnd+1:this.modelLineProjections.length+2);let lineChanged=!1;if(lineNumber>=hiddenAreaStart&&lineNumber<=hiddenAreaEnd?this.modelLineProjections[i].isVisible()&&(this.modelLineProjections[i]=this.modelLineProjections[i].setVisible(!1),lineChanged=!0):(hasVisibleLine=!0,this.modelLineProjections[i].isVisible()||(this.modelLineProjections[i]=this.modelLineProjections[i].setVisible(!0),lineChanged=!0)),lineChanged){const newOutputLineCount=this.modelLineProjections[i].getViewLineCount();this.projectedModelLineLineCounts.setValue(i,newOutputLineCount)}}return hasVisibleLine||this.setHiddenAreas([]),!0}modelPositionIsVisible(modelLineNumber,_modelColumn){return!(modelLineNumber<1||modelLineNumber>this.modelLineProjections.length)&&this.modelLineProjections[modelLineNumber-1].isVisible()}getModelLineViewLineCount(modelLineNumber){return modelLineNumber<1||modelLineNumber>this.modelLineProjections.length?1:this.modelLineProjections[modelLineNumber-1].getViewLineCount()}setTabSize(newTabSize){return this.tabSize!==newTabSize&&(this.tabSize=newTabSize,this._constructLines(!1,null),!0)}setWrappingSettings(fontInfo,wrappingStrategy,wrappingColumn,wrappingIndent){const equalFontInfo=this.fontInfo.equals(fontInfo),equalWrappingStrategy=this.wrappingStrategy===wrappingStrategy,equalWrappingColumn=this.wrappingColumn===wrappingColumn,equalWrappingIndent=this.wrappingIndent===wrappingIndent;if(equalFontInfo&&equalWrappingStrategy&&equalWrappingColumn&&equalWrappingIndent)return!1;const onlyWrappingColumnChanged=equalFontInfo&&equalWrappingStrategy&&!equalWrappingColumn&&equalWrappingIndent;this.fontInfo=fontInfo,this.wrappingStrategy=wrappingStrategy,this.wrappingColumn=wrappingColumn,this.wrappingIndent=wrappingIndent;let previousLineBreaks=null;if(onlyWrappingColumnChanged){previousLineBreaks=[];for(let i=0,len=this.modelLineProjections.length;i<len;i++)previousLineBreaks[i]=this.modelLineProjections[i].getProjectionData()}return this._constructLines(!1,previousLineBreaks),!0}createLineBreaksComputer(){return("advanced"===this.wrappingStrategy?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(versionId,fromLineNumber,toLineNumber){if(!versionId||versionId<=this._validModelVersionId)return null;const outputFromLineNumber=1===fromLineNumber?1:this.projectedModelLineLineCounts.getPrefixSum(fromLineNumber-1)+1,outputToLineNumber=this.projectedModelLineLineCounts.getPrefixSum(toLineNumber);return this.modelLineProjections.splice(fromLineNumber-1,toLineNumber-fromLineNumber+1),this.projectedModelLineLineCounts.removeValues(fromLineNumber-1,toLineNumber-fromLineNumber+1),new viewEvents.ViewLinesDeletedEvent(outputFromLineNumber,outputToLineNumber)}onModelLinesInserted(versionId,fromLineNumber,_toLineNumber,lineBreaks){if(!versionId||versionId<=this._validModelVersionId)return null;const isInHiddenArea=fromLineNumber>2&&!this.modelLineProjections[fromLineNumber-2].isVisible(),outputFromLineNumber=1===fromLineNumber?1:this.projectedModelLineLineCounts.getPrefixSum(fromLineNumber-1)+1;let totalOutputLineCount=0;const insertLines=[],insertPrefixSumValues=[];for(let i=0,len=lineBreaks.length;i<len;i++){const line=(0,modelLineProjection_1.createModelLineProjection)(lineBreaks[i],!isInHiddenArea);insertLines.push(line);const outputLineCount=line.getViewLineCount();totalOutputLineCount+=outputLineCount,insertPrefixSumValues[i]=outputLineCount}return this.modelLineProjections=this.modelLineProjections.slice(0,fromLineNumber-1).concat(insertLines).concat(this.modelLineProjections.slice(fromLineNumber-1)),this.projectedModelLineLineCounts.insertValues(fromLineNumber-1,insertPrefixSumValues),new viewEvents.ViewLinesInsertedEvent(outputFromLineNumber,outputFromLineNumber+totalOutputLineCount-1)}onModelLineChanged(versionId,lineNumber,lineBreakData){if(null!==versionId&&versionId<=this._validModelVersionId)return[!1,null,null,null];const lineIndex=lineNumber-1,oldOutputLineCount=this.modelLineProjections[lineIndex].getViewLineCount(),isVisible=this.modelLineProjections[lineIndex].isVisible(),line=(0,modelLineProjection_1.createModelLineProjection)(lineBreakData,isVisible);this.modelLineProjections[lineIndex]=line;const newOutputLineCount=this.modelLineProjections[lineIndex].getViewLineCount();let lineMappingChanged=!1,changeFrom=0,changeTo=-1,insertFrom=0,insertTo=-1,deleteFrom=0,deleteTo=-1;oldOutputLineCount>newOutputLineCount?(changeFrom=this.projectedModelLineLineCounts.getPrefixSum(lineNumber-1)+1,changeTo=changeFrom+newOutputLineCount-1,deleteFrom=changeTo+1,deleteTo=deleteFrom+(oldOutputLineCount-newOutputLineCount)-1,lineMappingChanged=!0):oldOutputLineCount<newOutputLineCount?(changeFrom=this.projectedModelLineLineCounts.getPrefixSum(lineNumber-1)+1,changeTo=changeFrom+oldOutputLineCount-1,insertFrom=changeTo+1,insertTo=insertFrom+(newOutputLineCount-oldOutputLineCount)-1,lineMappingChanged=!0):(changeFrom=this.projectedModelLineLineCounts.getPrefixSum(lineNumber-1)+1,changeTo=changeFrom+newOutputLineCount-1),this.projectedModelLineLineCounts.setValue(lineIndex,newOutputLineCount);return[lineMappingChanged,changeFrom<=changeTo?new viewEvents.ViewLinesChangedEvent(changeFrom,changeTo):null,insertFrom<=insertTo?new viewEvents.ViewLinesInsertedEvent(insertFrom,insertTo):null,deleteFrom<=deleteTo?new viewEvents.ViewLinesDeletedEvent(deleteFrom,deleteTo):null]}acceptVersionId(versionId){this._validModelVersionId=versionId,1!==this.modelLineProjections.length||this.modelLineProjections[0].isVisible()||this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(viewLineNumber){if(viewLineNumber<1)return 1;const viewLineCount=this.getViewLineCount();return viewLineNumber>viewLineCount?viewLineCount:0|viewLineNumber}getActiveIndentGuide(viewLineNumber,minLineNumber,maxLineNumber){viewLineNumber=this._toValidViewLineNumber(viewLineNumber),minLineNumber=this._toValidViewLineNumber(minLineNumber),maxLineNumber=this._toValidViewLineNumber(maxLineNumber);const modelPosition=this.convertViewPositionToModelPosition(viewLineNumber,this.getViewLineMinColumn(viewLineNumber)),modelMinPosition=this.convertViewPositionToModelPosition(minLineNumber,this.getViewLineMinColumn(minLineNumber)),modelMaxPosition=this.convertViewPositionToModelPosition(maxLineNumber,this.getViewLineMinColumn(maxLineNumber)),result=this.model.guides.getActiveIndentGuide(modelPosition.lineNumber,modelMinPosition.lineNumber,modelMaxPosition.lineNumber),viewStartPosition=this.convertModelPositionToViewPosition(result.startLineNumber,1),viewEndPosition=this.convertModelPositionToViewPosition(result.endLineNumber,this.model.getLineMaxColumn(result.endLineNumber));return{startLineNumber:viewStartPosition.lineNumber,endLineNumber:viewEndPosition.lineNumber,indent:result.indent}}getViewLineInfo(viewLineNumber){viewLineNumber=this._toValidViewLineNumber(viewLineNumber);const r=this.projectedModelLineLineCounts.getIndexOf(viewLineNumber-1),lineIndex=r.index,remainder=r.remainder;return new ViewLineInfo(lineIndex+1,remainder)}getMinColumnOfViewLine(viewLineInfo){return this.modelLineProjections[viewLineInfo.modelLineNumber-1].getViewLineMinColumn(this.model,viewLineInfo.modelLineNumber,viewLineInfo.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(viewLineInfo){const line=this.modelLineProjections[viewLineInfo.modelLineNumber-1],minViewColumn=line.getViewLineMinColumn(this.model,viewLineInfo.modelLineNumber,viewLineInfo.modelLineWrappedLineIdx),column=line.getModelColumnOfViewPosition(viewLineInfo.modelLineWrappedLineIdx,minViewColumn);return new position_1.Position(viewLineInfo.modelLineNumber,column)}getModelEndPositionOfViewLine(viewLineInfo){const line=this.modelLineProjections[viewLineInfo.modelLineNumber-1],maxViewColumn=line.getViewLineMaxColumn(this.model,viewLineInfo.modelLineNumber,viewLineInfo.modelLineWrappedLineIdx),column=line.getModelColumnOfViewPosition(viewLineInfo.modelLineWrappedLineIdx,maxViewColumn);return new position_1.Position(viewLineInfo.modelLineNumber,column)}getViewLineInfosGroupedByModelRanges(viewStartLineNumber,viewEndLineNumber){const startViewLine=this.getViewLineInfo(viewStartLineNumber),endViewLine=this.getViewLineInfo(viewEndLineNumber),result=new Array;let lastVisibleModelPos=this.getModelStartPositionOfViewLine(startViewLine),viewLines=new Array;for(let curModelLine=startViewLine.modelLineNumber;curModelLine<=endViewLine.modelLineNumber;curModelLine++){const line=this.modelLineProjections[curModelLine-1];if(line.isVisible()){const startOffset=curModelLine===startViewLine.modelLineNumber?startViewLine.modelLineWrappedLineIdx:0,endOffset=curModelLine===endViewLine.modelLineNumber?endViewLine.modelLineWrappedLineIdx+1:line.getViewLineCount();for(let i=startOffset;i<endOffset;i++)viewLines.push(new ViewLineInfo(curModelLine,i))}if(!line.isVisible()&&lastVisibleModelPos){const lastVisibleModelPos2=new position_1.Position(curModelLine-1,this.model.getLineMaxColumn(curModelLine-1)+1),modelRange=range_1.Range.fromPositions(lastVisibleModelPos,lastVisibleModelPos2);result.push(new ViewLineInfoGroupedByModelRange(modelRange,viewLines)),viewLines=[],lastVisibleModelPos=null}else line.isVisible()&&!lastVisibleModelPos&&(lastVisibleModelPos=new position_1.Position(curModelLine,1))}if(lastVisibleModelPos){const modelRange=range_1.Range.fromPositions(lastVisibleModelPos,this.getModelEndPositionOfViewLine(endViewLine));result.push(new ViewLineInfoGroupedByModelRange(modelRange,viewLines))}return result}getViewLinesBracketGuides(viewStartLineNumber,viewEndLineNumber,activeViewPosition,options){const modelActivePosition=activeViewPosition?this.convertViewPositionToModelPosition(activeViewPosition.lineNumber,activeViewPosition.column):null,resultPerViewLine=[];for(const group of this.getViewLineInfosGroupedByModelRanges(viewStartLineNumber,viewEndLineNumber)){const modelRangeStartLineNumber=group.modelRange.startLineNumber,bracketGuidesPerModelLine=this.model.guides.getLinesBracketGuides(modelRangeStartLineNumber,group.modelRange.endLineNumber,modelActivePosition,options);for(const viewLineInfo of group.viewLines)if(viewLineInfo.isWrappedLineContinuation&&1===this.getMinColumnOfViewLine(viewLineInfo))resultPerViewLine.push([]);else{let bracketGuides=bracketGuidesPerModelLine[viewLineInfo.modelLineNumber-modelRangeStartLineNumber];bracketGuides=bracketGuides.map((g=>g.horizontalLine?new textModelGuides_1.IndentGuide(g.visibleColumn,g.className,new textModelGuides_1.IndentGuideHorizontalLine(g.horizontalLine.top,this.convertModelPositionToViewPosition(viewLineInfo.modelLineNumber,g.horizontalLine.endColumn).column)):g)),resultPerViewLine.push(bracketGuides)}}return resultPerViewLine}getViewLinesIndentGuides(viewStartLineNumber,viewEndLineNumber){viewStartLineNumber=this._toValidViewLineNumber(viewStartLineNumber),viewEndLineNumber=this._toValidViewLineNumber(viewEndLineNumber);const modelStart=this.convertViewPositionToModelPosition(viewStartLineNumber,this.getViewLineMinColumn(viewStartLineNumber)),modelEnd=this.convertViewPositionToModelPosition(viewEndLineNumber,this.getViewLineMaxColumn(viewEndLineNumber));let result=[];const resultRepeatCount=[],resultRepeatOption=[],modelStartLineIndex=modelStart.lineNumber-1,modelEndLineIndex=modelEnd.lineNumber-1;let reqStart=null;for(let modelLineIndex=modelStartLineIndex;modelLineIndex<=modelEndLineIndex;modelLineIndex++){const line=this.modelLineProjections[modelLineIndex];if(line.isVisible()){const viewLineStartIndex=line.getViewLineNumberOfModelPosition(0,modelLineIndex===modelStartLineIndex?modelStart.column:1),viewLineEndIndex=line.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(modelLineIndex+1)),count=viewLineEndIndex-viewLineStartIndex+1;let option=0;count>1&&1===line.getViewLineMinColumn(this.model,modelLineIndex+1,viewLineEndIndex)&&(option=0===viewLineStartIndex?1:2),resultRepeatCount.push(count),resultRepeatOption.push(option),null===reqStart&&(reqStart=new position_1.Position(modelLineIndex+1,0))}else null!==reqStart&&(result=result.concat(this.model.guides.getLinesIndentGuides(reqStart.lineNumber,modelLineIndex)),reqStart=null)}null!==reqStart&&(result=result.concat(this.model.guides.getLinesIndentGuides(reqStart.lineNumber,modelEnd.lineNumber)),reqStart=null);const viewLineCount=viewEndLineNumber-viewStartLineNumber+1,viewIndents=new Array(viewLineCount);let currIndex=0;for(let i=0,len=result.length;i<len;i++){let value=result[i];const count=Math.min(viewLineCount-currIndex,resultRepeatCount[i]),option=resultRepeatOption[i];let blockAtIndex;blockAtIndex=2===option?0:1===option?1:count;for(let j=0;j<count;j++)j===blockAtIndex&&(value=0),viewIndents[currIndex++]=value}return viewIndents}getViewLineContent(viewLineNumber){const info=this.getViewLineInfo(viewLineNumber);return this.modelLineProjections[info.modelLineNumber-1].getViewLineContent(this.model,info.modelLineNumber,info.modelLineWrappedLineIdx)}getViewLineLength(viewLineNumber){const info=this.getViewLineInfo(viewLineNumber);return this.modelLineProjections[info.modelLineNumber-1].getViewLineLength(this.model,info.modelLineNumber,info.modelLineWrappedLineIdx)}getViewLineMinColumn(viewLineNumber){const info=this.getViewLineInfo(viewLineNumber);return this.modelLineProjections[info.modelLineNumber-1].getViewLineMinColumn(this.model,info.modelLineNumber,info.modelLineWrappedLineIdx)}getViewLineMaxColumn(viewLineNumber){const info=this.getViewLineInfo(viewLineNumber);return this.modelLineProjections[info.modelLineNumber-1].getViewLineMaxColumn(this.model,info.modelLineNumber,info.modelLineWrappedLineIdx)}getViewLineData(viewLineNumber){const info=this.getViewLineInfo(viewLineNumber);return this.modelLineProjections[info.modelLineNumber-1].getViewLineData(this.model,info.modelLineNumber,info.modelLineWrappedLineIdx)}getViewLinesData(viewStartLineNumber,viewEndLineNumber,needed){viewStartLineNumber=this._toValidViewLineNumber(viewStartLineNumber),viewEndLineNumber=this._toValidViewLineNumber(viewEndLineNumber);const start=this.projectedModelLineLineCounts.getIndexOf(viewStartLineNumber-1);let viewLineNumber=viewStartLineNumber;const startModelLineIndex=start.index,startRemainder=start.remainder,result=[];for(let modelLineIndex=startModelLineIndex,len=this.model.getLineCount();modelLineIndex<len;modelLineIndex++){const line=this.modelLineProjections[modelLineIndex];if(!line.isVisible())continue;const fromViewLineIndex=modelLineIndex===startModelLineIndex?startRemainder:0;let remainingViewLineCount=line.getViewLineCount()-fromViewLineIndex,lastLine=!1;if(viewLineNumber+remainingViewLineCount>viewEndLineNumber&&(lastLine=!0,remainingViewLineCount=viewEndLineNumber-viewLineNumber+1),line.getViewLinesData(this.model,modelLineIndex+1,fromViewLineIndex,remainingViewLineCount,viewLineNumber-viewStartLineNumber,needed,result),viewLineNumber+=remainingViewLineCount,lastLine)break}return result}validateViewPosition(viewLineNumber,viewColumn,expectedModelPosition){viewLineNumber=this._toValidViewLineNumber(viewLineNumber);const r=this.projectedModelLineLineCounts.getIndexOf(viewLineNumber-1),lineIndex=r.index,remainder=r.remainder,line=this.modelLineProjections[lineIndex],minColumn=line.getViewLineMinColumn(this.model,lineIndex+1,remainder),maxColumn=line.getViewLineMaxColumn(this.model,lineIndex+1,remainder);viewColumn<minColumn&&(viewColumn=minColumn),viewColumn>maxColumn&&(viewColumn=maxColumn);const computedModelColumn=line.getModelColumnOfViewPosition(remainder,viewColumn);return this.model.validatePosition(new position_1.Position(lineIndex+1,computedModelColumn)).equals(expectedModelPosition)?new position_1.Position(viewLineNumber,viewColumn):this.convertModelPositionToViewPosition(expectedModelPosition.lineNumber,expectedModelPosition.column)}validateViewRange(viewRange,expectedModelRange){const validViewStart=this.validateViewPosition(viewRange.startLineNumber,viewRange.startColumn,expectedModelRange.getStartPosition()),validViewEnd=this.validateViewPosition(viewRange.endLineNumber,viewRange.endColumn,expectedModelRange.getEndPosition());return new range_1.Range(validViewStart.lineNumber,validViewStart.column,validViewEnd.lineNumber,validViewEnd.column)}convertViewPositionToModelPosition(viewLineNumber,viewColumn){const info=this.getViewLineInfo(viewLineNumber),inputColumn=this.modelLineProjections[info.modelLineNumber-1].getModelColumnOfViewPosition(info.modelLineWrappedLineIdx,viewColumn);return this.model.validatePosition(new position_1.Position(info.modelLineNumber,inputColumn))}convertViewRangeToModelRange(viewRange){const start=this.convertViewPositionToModelPosition(viewRange.startLineNumber,viewRange.startColumn),end=this.convertViewPositionToModelPosition(viewRange.endLineNumber,viewRange.endColumn);return new range_1.Range(start.lineNumber,start.column,end.lineNumber,end.column)}convertModelPositionToViewPosition(_modelLineNumber,_modelColumn,affinity=2){const validPosition=this.model.validatePosition(new position_1.Position(_modelLineNumber,_modelColumn)),inputLineNumber=validPosition.lineNumber,inputColumn=validPosition.column;let lineIndex=inputLineNumber-1,lineIndexChanged=!1;for(;lineIndex>0&&!this.modelLineProjections[lineIndex].isVisible();)lineIndex--,lineIndexChanged=!0;if(0===lineIndex&&!this.modelLineProjections[lineIndex].isVisible())return new position_1.Position(1,1);const deltaLineNumber=1+this.projectedModelLineLineCounts.getPrefixSum(lineIndex);let r;return r=lineIndexChanged?this.modelLineProjections[lineIndex].getViewPositionOfModelPosition(deltaLineNumber,this.model.getLineMaxColumn(lineIndex+1),affinity):this.modelLineProjections[inputLineNumber-1].getViewPositionOfModelPosition(deltaLineNumber,inputColumn,affinity),r}convertModelRangeToViewRange(modelRange,affinity=0){if(modelRange.isEmpty()){const start=this.convertModelPositionToViewPosition(modelRange.startLineNumber,modelRange.startColumn,affinity);return range_1.Range.fromPositions(start)}{const start=this.convertModelPositionToViewPosition(modelRange.startLineNumber,modelRange.startColumn,1),end=this.convertModelPositionToViewPosition(modelRange.endLineNumber,modelRange.endColumn,0);return new range_1.Range(start.lineNumber,start.column,end.lineNumber,end.column)}}getViewLineNumberOfModelPosition(modelLineNumber,modelColumn){let lineIndex=modelLineNumber-1;if(this.modelLineProjections[lineIndex].isVisible()){const deltaLineNumber=1+this.projectedModelLineLineCounts.getPrefixSum(lineIndex);return this.modelLineProjections[lineIndex].getViewLineNumberOfModelPosition(deltaLineNumber,modelColumn)}for(;lineIndex>0&&!this.modelLineProjections[lineIndex].isVisible();)lineIndex--;if(0===lineIndex&&!this.modelLineProjections[lineIndex].isVisible())return 1;const deltaLineNumber=1+this.projectedModelLineLineCounts.getPrefixSum(lineIndex);return this.modelLineProjections[lineIndex].getViewLineNumberOfModelPosition(deltaLineNumber,this.model.getLineMaxColumn(lineIndex+1))}getDecorationsInRange(range,ownerId,filterOutValidation){const modelStart=this.convertViewPositionToModelPosition(range.startLineNumber,range.startColumn),modelEnd=this.convertViewPositionToModelPosition(range.endLineNumber,range.endColumn);if(modelEnd.lineNumber-modelStart.lineNumber<=range.endLineNumber-range.startLineNumber)return this.model.getDecorationsInRange(new range_1.Range(modelStart.lineNumber,1,modelEnd.lineNumber,modelEnd.column),ownerId,filterOutValidation);let result=[];const modelStartLineIndex=modelStart.lineNumber-1,modelEndLineIndex=modelEnd.lineNumber-1;let reqStart=null;for(let modelLineIndex=modelStartLineIndex;modelLineIndex<=modelEndLineIndex;modelLineIndex++){if(this.modelLineProjections[modelLineIndex].isVisible())null===reqStart&&(reqStart=new position_1.Position(modelLineIndex+1,modelLineIndex===modelStartLineIndex?modelStart.column:1));else if(null!==reqStart){const maxLineColumn=this.model.getLineMaxColumn(modelLineIndex);result=result.concat(this.model.getDecorationsInRange(new range_1.Range(reqStart.lineNumber,reqStart.column,modelLineIndex,maxLineColumn),ownerId,filterOutValidation)),reqStart=null}}null!==reqStart&&(result=result.concat(this.model.getDecorationsInRange(new range_1.Range(reqStart.lineNumber,reqStart.column,modelEnd.lineNumber,modelEnd.column),ownerId,filterOutValidation)),reqStart=null),result.sort(((a,b)=>{const res=range_1.Range.compareRangesUsingStarts(a.range,b.range);return 0===res?a.id<b.id?-1:a.id>b.id?1:0:res}));let finalResult=[],finalResultLen=0,prevDecId=null;for(const dec of result){const decId=dec.id;prevDecId!==decId&&(prevDecId=decId,finalResult[finalResultLen++]=dec)}return finalResult}getInjectedTextAt(position){const info=this.getViewLineInfo(position.lineNumber);return this.modelLineProjections[info.modelLineNumber-1].getInjectedTextAt(info.modelLineWrappedLineIdx,position.column)}normalizePosition(position,affinity){const info=this.getViewLineInfo(position.lineNumber);return this.modelLineProjections[info.modelLineNumber-1].normalizePosition(info.modelLineWrappedLineIdx,position,affinity)}getLineIndentColumn(lineNumber){const info=this.getViewLineInfo(lineNumber);return 0===info.modelLineWrappedLineIdx?this.model.getLineIndentColumn(info.modelLineNumber):0}};class ViewLineInfo{constructor(modelLineNumber,modelLineWrappedLineIdx){this.modelLineNumber=modelLineNumber,this.modelLineWrappedLineIdx=modelLineWrappedLineIdx}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}}class ViewLineInfoGroupedByModelRange{constructor(modelRange,viewLines){this.modelRange=modelRange,this.viewLines=viewLines}}class CoordinatesConverter{constructor(lines){this._lines=lines}convertViewPositionToModelPosition(viewPosition){return this._lines.convertViewPositionToModelPosition(viewPosition.lineNumber,viewPosition.column)}convertViewRangeToModelRange(viewRange){return this._lines.convertViewRangeToModelRange(viewRange)}validateViewPosition(viewPosition,expectedModelPosition){return this._lines.validateViewPosition(viewPosition.lineNumber,viewPosition.column,expectedModelPosition)}validateViewRange(viewRange,expectedModelRange){return this._lines.validateViewRange(viewRange,expectedModelRange)}convertModelPositionToViewPosition(modelPosition,affinity){return this._lines.convertModelPositionToViewPosition(modelPosition.lineNumber,modelPosition.column,affinity)}convertModelRangeToViewRange(modelRange,affinity){return this._lines.convertModelRangeToViewRange(modelRange,affinity)}modelPositionIsVisible(modelPosition){return this._lines.modelPositionIsVisible(modelPosition.lineNumber,modelPosition.column)}getModelLineViewLineCount(modelLineNumber){return this._lines.getModelLineViewLineCount(modelLineNumber)}getViewLineNumberOfModelPosition(modelLineNumber,modelColumn){return this._lines.getViewLineNumberOfModelPosition(modelLineNumber,modelColumn)}}exports.ViewModelLinesFromModelAsIs=class ViewModelLinesFromModelAsIs{constructor(model){this.model=model}dispose(){}createCoordinatesConverter(){return new IdentityCoordinatesConverter(this)}getHiddenAreas(){return[]}setHiddenAreas(_ranges){return!1}setTabSize(_newTabSize){return!1}setWrappingSettings(_fontInfo,_wrappingStrategy,_wrappingColumn,_wrappingIndent){return!1}createLineBreaksComputer(){const result=[];return{addRequest:(lineText,injectedText,previousLineBreakData)=>{result.push(null)},finalize:()=>result}}onModelFlushed(){}onModelLinesDeleted(_versionId,fromLineNumber,toLineNumber){return new viewEvents.ViewLinesDeletedEvent(fromLineNumber,toLineNumber)}onModelLinesInserted(_versionId,fromLineNumber,toLineNumber,lineBreaks){return new viewEvents.ViewLinesInsertedEvent(fromLineNumber,toLineNumber)}onModelLineChanged(_versionId,lineNumber,lineBreakData){return[!1,new viewEvents.ViewLinesChangedEvent(lineNumber,lineNumber),null,null]}acceptVersionId(_versionId){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(viewLineNumber,_minLineNumber,_maxLineNumber){return{startLineNumber:viewLineNumber,endLineNumber:viewLineNumber,indent:0}}getViewLinesBracketGuides(startLineNumber,endLineNumber,activePosition){return new Array(endLineNumber-startLineNumber+1).fill([])}getViewLinesIndentGuides(viewStartLineNumber,viewEndLineNumber){const viewLineCount=viewEndLineNumber-viewStartLineNumber+1,result=new Array(viewLineCount);for(let i=0;i<viewLineCount;i++)result[i]=0;return result}getViewLineContent(viewLineNumber){return this.model.getLineContent(viewLineNumber)}getViewLineLength(viewLineNumber){return this.model.getLineLength(viewLineNumber)}getViewLineMinColumn(viewLineNumber){return this.model.getLineMinColumn(viewLineNumber)}getViewLineMaxColumn(viewLineNumber){return this.model.getLineMaxColumn(viewLineNumber)}getViewLineData(viewLineNumber){const lineTokens=this.model.getLineTokens(viewLineNumber),lineContent=lineTokens.getLineContent();return new viewModel_1.ViewLineData(lineContent,!1,1,lineContent.length+1,0,lineTokens.inflate(),null)}getViewLinesData(viewStartLineNumber,viewEndLineNumber,needed){const lineCount=this.model.getLineCount();viewStartLineNumber=Math.min(Math.max(1,viewStartLineNumber),lineCount),viewEndLineNumber=Math.min(Math.max(1,viewEndLineNumber),lineCount);const result=[];for(let lineNumber=viewStartLineNumber;lineNumber<=viewEndLineNumber;lineNumber++){const idx=lineNumber-viewStartLineNumber;result[idx]=needed[idx]?this.getViewLineData(lineNumber):null}return result}getDecorationsInRange(range,ownerId,filterOutValidation){return this.model.getDecorationsInRange(range,ownerId,filterOutValidation)}normalizePosition(position,affinity){return this.model.normalizePosition(position,affinity)}getLineIndentColumn(lineNumber){return this.model.getLineIndentColumn(lineNumber)}getInjectedTextAt(position){return null}};class IdentityCoordinatesConverter{constructor(lines){this._lines=lines}_validPosition(pos){return this._lines.model.validatePosition(pos)}_validRange(range){return this._lines.model.validateRange(range)}convertViewPositionToModelPosition(viewPosition){return this._validPosition(viewPosition)}convertViewRangeToModelRange(viewRange){return this._validRange(viewRange)}validateViewPosition(_viewPosition,expectedModelPosition){return this._validPosition(expectedModelPosition)}validateViewRange(_viewRange,expectedModelRange){return this._validRange(expectedModelRange)}convertModelPositionToViewPosition(modelPosition){return this._validPosition(modelPosition)}convertModelRangeToViewRange(modelRange){return this._validRange(modelRange)}modelPositionIsVisible(modelPosition){const lineCount=this._lines.model.getLineCount();return!(modelPosition.lineNumber<1||modelPosition.lineNumber>lineCount)}getModelLineViewLineCount(modelLineNumber){return 1}getViewLineNumberOfModelPosition(modelLineNumber,modelColumn){return modelLineNumber}}})),define(__m[716],__M([1,0,18,10,30,2,16,8,32,277,61,11,3,94,27,81,253,189,457,255,71,271,190,715]),(function(require,exports,arrays_1,async_1,color_1,lifecycle_1,platform,strings,editorOptions_1,cursor_1,cursorCommon_1,position_1,range_1,textModelEvents,languages_1,modesRegistry_1,textToHtmlTokenizer_1,viewEvents,viewLayout_1,minimapTokensColorTracker_1,viewModel_1,viewModelDecorations_1,viewModelEventDispatcher_1,viewModelLines_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewModel=void 0;class ViewModel extends lifecycle_1.Disposable{constructor(editorId,configuration,model,domLineBreaksComputerFactory,monospaceLineBreaksComputerFactory,scheduleAtNextAnimationFrame,languageConfigurationService,_themeService){if(super(),this.languageConfigurationService=languageConfigurationService,this._themeService=_themeService,this._editorId=editorId,this._configuration=configuration,this.model=model,this._eventDispatcher=new viewModelEventDispatcher_1.ViewModelEventDispatcher,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new cursorCommon_1.CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._tokenizeViewportSoon=this._register(new async_1.RunOnceScheduler((()=>this.tokenizeViewport()),50)),this._updateConfigurationViewLineCount=this._register(new async_1.RunOnceScheduler((()=>this._updateConfigurationViewLineCountNow()),0)),this._hasFocus=!1,this._viewportStartLine=-1,this._viewportStartLineTrackedRange=null,this._viewportStartLineDelta=0,this.model.isTooLargeForTokenization())this._lines=new viewModelLines_1.ViewModelLinesFromModelAsIs(this.model);else{const options=this._configuration.options,fontInfo=options.get(44),wrappingStrategy=options.get(125),wrappingInfo=options.get(132),wrappingIndent=options.get(124);this._lines=new viewModelLines_1.ViewModelLinesFromProjectedModel(this._editorId,this.model,domLineBreaksComputerFactory,monospaceLineBreaksComputerFactory,fontInfo,this.model.getOptions().tabSize,wrappingStrategy,wrappingInfo.wrappingColumn,wrappingIndent)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new cursor_1.CursorsController(model,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new viewLayout_1.ViewLayout(this._configuration,this.getLineCount(),scheduleAtNextAnimationFrame)),this._register(this.viewLayout.onDidScroll((e=>{e.scrollTopChanged&&this._tokenizeViewportSoon.schedule(),this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewScrollChangedEvent(e)),this._eventDispatcher.emitOutgoingEvent(new viewModelEventDispatcher_1.ScrollChangedEvent(e.oldScrollWidth,e.oldScrollLeft,e.oldScrollHeight,e.oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop))}))),this._register(this.viewLayout.onDidContentSizeChange((e=>{this._eventDispatcher.emitOutgoingEvent(e)}))),this._decorations=new viewModelDecorations_1.ViewModelDecorations(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast((e=>{try{const eventsCollector=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(eventsCollector,e)}finally{this._eventDispatcher.endEmitViewEvents()}}))),this._register(minimapTokensColorTracker_1.MinimapTokensColorTracker.getInstance().onDidChange((()=>{this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewTokensColorsChangedEvent)}))),this._register(this._themeService.onDidColorThemeChange((theme=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewThemeChangedEvent(theme))}))),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,null,1),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(eventHandler){this._eventDispatcher.addViewEventHandler(eventHandler)}removeViewEventHandler(eventHandler){this._eventDispatcher.removeViewEventHandler(eventHandler)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}tokenizeViewport(){const linesViewportData=this.viewLayout.getLinesViewportData(),viewVisibleRange=new range_1.Range(linesViewportData.startLineNumber,this.getLineMinColumn(linesViewportData.startLineNumber),linesViewportData.endLineNumber,this.getLineMaxColumn(linesViewportData.endLineNumber)),modelVisibleRanges=this._toModelVisibleRanges(viewVisibleRange);for(const modelVisibleRange of modelVisibleRanges)this.model.tokenizeViewport(modelVisibleRange.startLineNumber,modelVisibleRange.endLineNumber)}setHasFocus(hasFocus){this._hasFocus=hasFocus,this._cursor.setHasFocus(hasFocus),this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewFocusChangedEvent(hasFocus)),this._eventDispatcher.emitOutgoingEvent(new viewModelEventDispatcher_1.FocusChangedEvent(!hasFocus,hasFocus))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewCompositionStartEvent)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewCompositionEndEvent)}_onConfigurationChanged(eventsCollector,e){let previousViewportStartModelPosition=null;if(-1!==this._viewportStartLine){const previousViewportStartViewPosition=new position_1.Position(this._viewportStartLine,this.getLineMinColumn(this._viewportStartLine));previousViewportStartModelPosition=this.coordinatesConverter.convertViewPositionToModelPosition(previousViewportStartViewPosition)}let restorePreviousViewportStart=!1;const options=this._configuration.options,fontInfo=options.get(44),wrappingStrategy=options.get(125),wrappingInfo=options.get(132),wrappingIndent=options.get(124);if(this._lines.setWrappingSettings(fontInfo,wrappingStrategy,wrappingInfo.wrappingColumn,wrappingIndent)&&(eventsCollector.emitViewEvent(new viewEvents.ViewFlushedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewLineMappingChangedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(eventsCollector),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),0!==this.viewLayout.getCurrentScrollTop()&&(restorePreviousViewportStart=!0),this._updateConfigurationViewLineCount.schedule()),e.hasChanged(81)&&(this._decorations.reset(),eventsCollector.emitViewEvent(new viewEvents.ViewDecorationsChangedEvent(null))),eventsCollector.emitViewEvent(new viewEvents.ViewConfigurationChangedEvent(e)),this.viewLayout.onConfigurationChanged(e),restorePreviousViewportStart&&previousViewportStartModelPosition){const viewPosition=this.coordinatesConverter.convertModelPositionToViewPosition(previousViewportStartModelPosition),viewPositionTop=this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);this.viewLayout.setScrollPosition({scrollTop:viewPositionTop+this._viewportStartLineDelta},1)}cursorCommon_1.CursorConfiguration.shouldRecreate(e)&&(this.cursorConfig=new cursorCommon_1.CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText((e=>{try{const eventsCollector=this._eventDispatcher.beginEmitViewEvents();let hadOtherModelChange=!1,hadModelLineChangeThatChangedLineMapping=!1;const changes=e.changes,versionId=e instanceof textModelEvents.ModelRawContentChangedEvent?e.versionId:null,lineBreaksComputer=this._lines.createLineBreaksComputer();for(const change of changes)switch(change.changeType){case 4:for(let lineIdx=0;lineIdx<change.detail.length;lineIdx++){const line=change.detail[lineIdx];let injectedText=change.injectedTexts[lineIdx];injectedText&&(injectedText=injectedText.filter((element=>!element.ownerId||element.ownerId===this._editorId))),lineBreaksComputer.addRequest(line,injectedText,null)}break;case 2:{let injectedText=null;change.injectedText&&(injectedText=change.injectedText.filter((element=>!element.ownerId||element.ownerId===this._editorId))),lineBreaksComputer.addRequest(change.detail,injectedText,null);break}}const lineBreaks=lineBreaksComputer.finalize(),lineBreakQueue=new arrays_1.ArrayQueue(lineBreaks);for(const change of changes)switch(change.changeType){case 1:this._lines.onModelFlushed(),eventsCollector.emitViewEvent(new viewEvents.ViewFlushedEvent),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),hadOtherModelChange=!0;break;case 3:{const linesDeletedEvent=this._lines.onModelLinesDeleted(versionId,change.fromLineNumber,change.toLineNumber);null!==linesDeletedEvent&&(eventsCollector.emitViewEvent(linesDeletedEvent),this.viewLayout.onLinesDeleted(linesDeletedEvent.fromLineNumber,linesDeletedEvent.toLineNumber)),hadOtherModelChange=!0;break}case 4:{const insertedLineBreaks=lineBreakQueue.takeCount(change.detail.length),linesInsertedEvent=this._lines.onModelLinesInserted(versionId,change.fromLineNumber,change.toLineNumber,insertedLineBreaks);null!==linesInsertedEvent&&(eventsCollector.emitViewEvent(linesInsertedEvent),this.viewLayout.onLinesInserted(linesInsertedEvent.fromLineNumber,linesInsertedEvent.toLineNumber)),hadOtherModelChange=!0;break}case 2:{const changedLineBreakData=lineBreakQueue.dequeue(),[lineMappingChanged,linesChangedEvent,linesInsertedEvent,linesDeletedEvent]=this._lines.onModelLineChanged(versionId,change.lineNumber,changedLineBreakData);hadModelLineChangeThatChangedLineMapping=lineMappingChanged,linesChangedEvent&&eventsCollector.emitViewEvent(linesChangedEvent),linesInsertedEvent&&(eventsCollector.emitViewEvent(linesInsertedEvent),this.viewLayout.onLinesInserted(linesInsertedEvent.fromLineNumber,linesInsertedEvent.toLineNumber)),linesDeletedEvent&&(eventsCollector.emitViewEvent(linesDeletedEvent),this.viewLayout.onLinesDeleted(linesDeletedEvent.fromLineNumber,linesDeletedEvent.toLineNumber));break}}null!==versionId&&this._lines.acceptVersionId(versionId),this.viewLayout.onHeightMaybeChanged(),!hadOtherModelChange&&hadModelLineChangeThatChangedLineMapping&&(eventsCollector.emitViewEvent(new viewEvents.ViewLineMappingChangedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(eventsCollector),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}if(this._viewportStartLine=-1,this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&this._viewportStartLineTrackedRange){const modelRange=this.model._getTrackedRange(this._viewportStartLineTrackedRange);if(modelRange){const viewPosition=this.coordinatesConverter.convertModelPositionToViewPosition(modelRange.getStartPosition()),viewPositionTop=this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);this.viewLayout.setScrollPosition({scrollTop:viewPositionTop+this._viewportStartLineDelta},1)}}try{const eventsCollector=this._eventDispatcher.beginEmitViewEvents();this._cursor.onModelContentChanged(eventsCollector,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._tokenizeViewportSoon.schedule()}))),this._register(this.model.onDidChangeTokens((e=>{const viewRanges=[];for(let j=0,lenJ=e.ranges.length;j<lenJ;j++){const modelRange=e.ranges[j],viewStartLineNumber=this.coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelRange.fromLineNumber,1)).lineNumber,viewEndLineNumber=this.coordinatesConverter.convertModelPositionToViewPosition(new position_1.Position(modelRange.toLineNumber,this.model.getLineMaxColumn(modelRange.toLineNumber))).lineNumber;viewRanges[j]={fromLineNumber:viewStartLineNumber,toLineNumber:viewEndLineNumber}}this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewTokensChangedEvent(viewRanges)),e.tokenizationSupportChanged&&this._tokenizeViewportSoon.schedule()}))),this._register(this.model.onDidChangeLanguageConfiguration((e=>{this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewLanguageConfigurationEvent),this.cursorConfig=new cursorCommon_1.CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeLanguage((e=>{this.cursorConfig=new cursorCommon_1.CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeOptions((e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const eventsCollector=this._eventDispatcher.beginEmitViewEvents();eventsCollector.emitViewEvent(new viewEvents.ViewFlushedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewLineMappingChangedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(eventsCollector),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new cursorCommon_1.CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeDecorations((e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewDecorationsChangedEvent(e))})))}setHiddenAreas(ranges){let lineMappingChanged=!1;try{const eventsCollector=this._eventDispatcher.beginEmitViewEvents();lineMappingChanged=this._lines.setHiddenAreas(ranges),lineMappingChanged&&(eventsCollector.emitViewEvent(new viewEvents.ViewFlushedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewLineMappingChangedEvent),eventsCollector.emitViewEvent(new viewEvents.ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(eventsCollector),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),lineMappingChanged&&this._eventDispatcher.emitOutgoingEvent(new viewModelEventDispatcher_1.ViewZonesChangedEvent)}getVisibleRangesPlusViewportAboveBelow(){const layoutInfo=this._configuration.options.get(131),lineHeight=this._configuration.options.get(59),linesAround=Math.max(20,Math.round(layoutInfo.height/lineHeight)),partialData=this.viewLayout.getLinesViewportData(),startViewLineNumber=Math.max(1,partialData.completelyVisibleStartLineNumber-linesAround),endViewLineNumber=Math.min(this.getLineCount(),partialData.completelyVisibleEndLineNumber+linesAround);return this._toModelVisibleRanges(new range_1.Range(startViewLineNumber,this.getLineMinColumn(startViewLineNumber),endViewLineNumber,this.getLineMaxColumn(endViewLineNumber)))}getVisibleRanges(){const visibleViewRange=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(visibleViewRange)}_toModelVisibleRanges(visibleViewRange){const visibleRange=this.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange),hiddenAreas=this._lines.getHiddenAreas();if(0===hiddenAreas.length)return[visibleRange];const result=[];let resultLen=0,startLineNumber=visibleRange.startLineNumber,startColumn=visibleRange.startColumn;const endLineNumber=visibleRange.endLineNumber,endColumn=visibleRange.endColumn;for(let i=0,len=hiddenAreas.length;i<len;i++){const hiddenStartLineNumber=hiddenAreas[i].startLineNumber,hiddenEndLineNumber=hiddenAreas[i].endLineNumber;hiddenEndLineNumber<startLineNumber||(hiddenStartLineNumber>endLineNumber||(startLineNumber<hiddenStartLineNumber&&(result[resultLen++]=new range_1.Range(startLineNumber,startColumn,hiddenStartLineNumber-1,this.model.getLineMaxColumn(hiddenStartLineNumber-1))),startLineNumber=hiddenEndLineNumber+1,startColumn=1))}return(startLineNumber<endLineNumber||startLineNumber===endLineNumber&&startColumn<endColumn)&&(result[resultLen++]=new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn)),result}getCompletelyVisibleViewRange(){const partialData=this.viewLayout.getLinesViewportData(),startViewLineNumber=partialData.completelyVisibleStartLineNumber,endViewLineNumber=partialData.completelyVisibleEndLineNumber;return new range_1.Range(startViewLineNumber,this.getLineMinColumn(startViewLineNumber),endViewLineNumber,this.getLineMaxColumn(endViewLineNumber))}getCompletelyVisibleViewRangeAtScrollTop(scrollTop){const partialData=this.viewLayout.getLinesViewportDataAtScrollTop(scrollTop),startViewLineNumber=partialData.completelyVisibleStartLineNumber,endViewLineNumber=partialData.completelyVisibleEndLineNumber;return new range_1.Range(startViewLineNumber,this.getLineMinColumn(startViewLineNumber),endViewLineNumber,this.getLineMaxColumn(endViewLineNumber))}saveState(){const compatViewState=this.viewLayout.saveState(),scrollTop=compatViewState.scrollTop,firstViewLineNumber=this.viewLayout.getLineNumberAtVerticalOffset(scrollTop),firstPosition=this.coordinatesConverter.convertViewPositionToModelPosition(new position_1.Position(firstViewLineNumber,this.getLineMinColumn(firstViewLineNumber))),firstPositionDeltaTop=this.viewLayout.getVerticalOffsetForLineNumber(firstViewLineNumber)-scrollTop;return{scrollLeft:compatViewState.scrollLeft,firstPosition,firstPositionDeltaTop}}reduceRestoreState(state){if(void 0===state.firstPosition)return this._reduceRestoreStateCompatibility(state);const modelPosition=this.model.validatePosition(state.firstPosition),viewPosition=this.coordinatesConverter.convertModelPositionToViewPosition(modelPosition),scrollTop=this.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber)-state.firstPositionDeltaTop;return{scrollLeft:state.scrollLeft,scrollTop}}_reduceRestoreStateCompatibility(state){return{scrollLeft:state.scrollLeft,scrollTop:state.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(startLineNumber,endLineNumber,centeredLineNumber){this._viewportStartLine=startLineNumber;const position=this.coordinatesConverter.convertViewPositionToModelPosition(new position_1.Position(startLineNumber,this.getLineMinColumn(startLineNumber)));this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),1);const viewportStartLineTop=this.viewLayout.getVerticalOffsetForLineNumber(startLineNumber),scrollTop=this.viewLayout.getCurrentScrollTop();this._viewportStartLineDelta=scrollTop-viewportStartLineTop}getActiveIndentGuide(lineNumber,minLineNumber,maxLineNumber){return this._lines.getActiveIndentGuide(lineNumber,minLineNumber,maxLineNumber)}getLinesIndentGuides(startLineNumber,endLineNumber){return this._lines.getViewLinesIndentGuides(startLineNumber,endLineNumber)}getBracketGuidesInRangeByLine(startLineNumber,endLineNumber,activePosition,options){return this._lines.getViewLinesBracketGuides(startLineNumber,endLineNumber,activePosition,options)}getLineContent(lineNumber){return this._lines.getViewLineContent(lineNumber)}getLineLength(lineNumber){return this._lines.getViewLineLength(lineNumber)}getLineMinColumn(lineNumber){return this._lines.getViewLineMinColumn(lineNumber)}getLineMaxColumn(lineNumber){return this._lines.getViewLineMaxColumn(lineNumber)}getLineFirstNonWhitespaceColumn(lineNumber){const result=strings.firstNonWhitespaceIndex(this.getLineContent(lineNumber));return-1===result?0:result+1}getLineLastNonWhitespaceColumn(lineNumber){const result=strings.lastNonWhitespaceIndex(this.getLineContent(lineNumber));return-1===result?0:result+2}getDecorationsInViewport(visibleRange){return this._decorations.getDecorationsViewportData(visibleRange).decorations}getInjectedTextAt(viewPosition){return this._lines.getInjectedTextAt(viewPosition)}getViewLineRenderingData(visibleRange,lineNumber){const mightContainRTL=this.model.mightContainRTL(),mightContainNonBasicASCII=this.model.mightContainNonBasicASCII(),tabSize=this.getTabSize(),lineData=this._lines.getViewLineData(lineNumber);let inlineDecorations=this._decorations.getDecorationsViewportData(visibleRange).inlineDecorations[lineNumber-visibleRange.startLineNumber];return lineData.inlineDecorations&&(inlineDecorations=[...inlineDecorations,...lineData.inlineDecorations.map((d=>d.toInlineDecoration(lineNumber)))]),new viewModel_1.ViewLineRenderingData(lineData.minColumn,lineData.maxColumn,lineData.content,lineData.continuesWithWrappedLine,mightContainRTL,mightContainNonBasicASCII,lineData.tokens,inlineDecorations,tabSize,lineData.startVisibleColumn)}getViewLineData(lineNumber){return this._lines.getViewLineData(lineNumber)}getMinimapLinesRenderingData(startLineNumber,endLineNumber,needed){const result=this._lines.getViewLinesData(startLineNumber,endLineNumber,needed);return new viewModel_1.MinimapLinesRenderingData(this.getTabSize(),result)}getAllOverviewRulerDecorations(theme){const decorations=this.model.getOverviewRulerDecorations(this._editorId,(0,editorOptions_1.filterValidationDecorations)(this._configuration.options)),result=new OverviewRulerDecorations;for(const decoration of decorations){const decorationOptions=decoration.options,opts=decorationOptions.overviewRuler;if(!opts)continue;const lane=opts.position;if(0===lane)continue;const color=opts.getColor(theme.value),viewStartLineNumber=this.coordinatesConverter.getViewLineNumberOfModelPosition(decoration.range.startLineNumber,decoration.range.startColumn),viewEndLineNumber=this.coordinatesConverter.getViewLineNumberOfModelPosition(decoration.range.endLineNumber,decoration.range.endColumn);result.accept(color,decorationOptions.zIndex,viewStartLineNumber,viewEndLineNumber,lane)}return result.asArray}_invalidateDecorationsColorCache(){const decorations=this.model.getOverviewRulerDecorations();for(const decoration of decorations){const opts1=decoration.options.overviewRuler;opts1&&opts1.invalidateCachedColor();const opts2=decoration.options.minimap;opts2&&opts2.invalidateCachedColor()}}getValueInRange(range,eol){const modelRange=this.coordinatesConverter.convertViewRangeToModelRange(range);return this.model.getValueInRange(modelRange,eol)}deduceModelPositionRelativeToViewPosition(viewAnchorPosition,deltaOffset,lineFeedCnt){const modelAnchor=this.coordinatesConverter.convertViewPositionToModelPosition(viewAnchorPosition);2===this.model.getEOL().length&&(deltaOffset<0?deltaOffset-=lineFeedCnt:deltaOffset+=lineFeedCnt);const resultOffset=this.model.getOffsetAt(modelAnchor)+deltaOffset;return this.model.getPositionAt(resultOffset)}getPlainTextToCopy(modelRanges,emptySelectionClipboard,forceCRLF){const newLineCharacter=forceCRLF?"\r\n":this.model.getEOL();(modelRanges=modelRanges.slice(0)).sort(range_1.Range.compareRangesUsingStarts);let hasEmptyRange=!1,hasNonEmptyRange=!1;for(const range of modelRanges)range.isEmpty()?hasEmptyRange=!0:hasNonEmptyRange=!0;if(!hasNonEmptyRange){if(!emptySelectionClipboard)return"";const modelLineNumbers=modelRanges.map((r=>r.startLineNumber));let result="";for(let i=0;i<modelLineNumbers.length;i++)i>0&&modelLineNumbers[i-1]===modelLineNumbers[i]||(result+=this.model.getLineContent(modelLineNumbers[i])+newLineCharacter);return result}if(hasEmptyRange&&emptySelectionClipboard){const result=[];let prevModelLineNumber=0;for(const modelRange of modelRanges){const modelLineNumber=modelRange.startLineNumber;modelRange.isEmpty()?modelLineNumber!==prevModelLineNumber&&result.push(this.model.getLineContent(modelLineNumber)):result.push(this.model.getValueInRange(modelRange,forceCRLF?2:0)),prevModelLineNumber=modelLineNumber}return 1===result.length?result[0]:result}const result=[];for(const modelRange of modelRanges)modelRange.isEmpty()||result.push(this.model.getValueInRange(modelRange,forceCRLF?2:0));return 1===result.length?result[0]:result}getRichTextToCopy(modelRanges,emptySelectionClipboard){const languageId=this.model.getLanguageId();if(languageId===modesRegistry_1.PLAINTEXT_LANGUAGE_ID)return null;if(1!==modelRanges.length)return null;let range=modelRanges[0];if(range.isEmpty()){if(!emptySelectionClipboard)return null;const lineNumber=range.startLineNumber;range=new range_1.Range(lineNumber,this.model.getLineMinColumn(lineNumber),lineNumber,this.model.getLineMaxColumn(lineNumber))}const fontInfo=this._configuration.options.get(44),colorMap=this._getColorMap();let fontFamily;if(/[:;\\\/<>]/.test(fontInfo.fontFamily)||fontInfo.fontFamily===editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily)fontFamily=editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily;else{fontFamily=fontInfo.fontFamily,fontFamily=fontFamily.replace(/"/g,"'");if(!/[,']/.test(fontFamily)){/[+ ]/.test(fontFamily)&&(fontFamily=`'${fontFamily}'`)}fontFamily=`${fontFamily}, ${editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily}`}return{mode:languageId,html:`<div style="color: ${colorMap[1]};background-color: ${colorMap[2]};font-family: ${fontFamily};font-weight: ${fontInfo.fontWeight};font-size: ${fontInfo.fontSize}px;line-height: ${fontInfo.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(range,colorMap)+"</div>"}}_getHTMLToCopy(modelRange,colorMap){const startLineNumber=modelRange.startLineNumber,startColumn=modelRange.startColumn,endLineNumber=modelRange.endLineNumber,endColumn=modelRange.endColumn,tabSize=this.getTabSize();let result="";for(let lineNumber=startLineNumber;lineNumber<=endLineNumber;lineNumber++){const lineTokens=this.model.getLineTokens(lineNumber),lineContent=lineTokens.getLineContent(),startOffset=lineNumber===startLineNumber?startColumn-1:0,endOffset=lineNumber===endLineNumber?endColumn-1:lineContent.length;result+=""===lineContent?"<br>":(0,textToHtmlTokenizer_1.tokenizeLineToHTML)(lineContent,lineTokens.inflate(),colorMap,startOffset,endOffset,tabSize,platform.isWindows)}return result}_getColorMap(){const colorMap=languages_1.TokenizationRegistry.getColorMap(),result=["#000000"];if(colorMap)for(let i=1,len=colorMap.length;i<len;i++)result[i]=color_1.Color.Format.CSS.formatHex(colorMap[i]);return result}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(source,reason,states){return this._withViewEventsCollector((eventsCollector=>this._cursor.setStates(eventsCollector,source,reason,states)))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(columnSelectData){this._cursor.setCursorColumnSelectData(columnSelectData)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(type){this._cursor.setPrevEditOperationType(type)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(source,selections,reason=0){this._withViewEventsCollector((eventsCollector=>this._cursor.setSelections(eventsCollector,source,selections,reason)))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(states){this._withViewEventsCollector((eventsCollector=>this._cursor.restoreState(eventsCollector,states)))}_executeCursorEdit(callback){this._cursor.context.cursorConfig.readOnly?this._eventDispatcher.emitOutgoingEvent(new viewModelEventDispatcher_1.ReadOnlyEditAttemptEvent):this._withViewEventsCollector(callback)}executeEdits(source,edits,cursorStateComputer){this._executeCursorEdit((eventsCollector=>this._cursor.executeEdits(eventsCollector,source,edits,cursorStateComputer)))}startComposition(){this._cursor.setIsDoingComposition(!0),this._executeCursorEdit((eventsCollector=>this._cursor.startComposition(eventsCollector)))}endComposition(source){this._cursor.setIsDoingComposition(!1),this._executeCursorEdit((eventsCollector=>this._cursor.endComposition(eventsCollector,source)))}type(text,source){this._executeCursorEdit((eventsCollector=>this._cursor.type(eventsCollector,text,source)))}compositionType(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta,source){this._executeCursorEdit((eventsCollector=>this._cursor.compositionType(eventsCollector,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta,source)))}paste(text,pasteOnNewLine,multicursorText,source){this._executeCursorEdit((eventsCollector=>this._cursor.paste(eventsCollector,text,pasteOnNewLine,multicursorText,source)))}cut(source){this._executeCursorEdit((eventsCollector=>this._cursor.cut(eventsCollector,source)))}executeCommand(command,source){this._executeCursorEdit((eventsCollector=>this._cursor.executeCommand(eventsCollector,command,source)))}executeCommands(commands,source){this._executeCursorEdit((eventsCollector=>this._cursor.executeCommands(eventsCollector,commands,source)))}revealPrimaryCursor(source,revealHorizontal,minimalReveal=!1){this._withViewEventsCollector((eventsCollector=>this._cursor.revealPrimary(eventsCollector,source,minimalReveal,0,revealHorizontal,0)))}revealTopMostCursor(source){const viewPosition=this._cursor.getTopMostViewPosition(),viewRange=new range_1.Range(viewPosition.lineNumber,viewPosition.column,viewPosition.lineNumber,viewPosition.column);this._withViewEventsCollector((eventsCollector=>eventsCollector.emitViewEvent(new viewEvents.ViewRevealRangeRequestEvent(source,!1,viewRange,null,0,!0,0))))}revealBottomMostCursor(source){const viewPosition=this._cursor.getBottomMostViewPosition(),viewRange=new range_1.Range(viewPosition.lineNumber,viewPosition.column,viewPosition.lineNumber,viewPosition.column);this._withViewEventsCollector((eventsCollector=>eventsCollector.emitViewEvent(new viewEvents.ViewRevealRangeRequestEvent(source,!1,viewRange,null,0,!0,0))))}revealRange(source,revealHorizontal,viewRange,verticalType,scrollType){this._withViewEventsCollector((eventsCollector=>eventsCollector.emitViewEvent(new viewEvents.ViewRevealRangeRequestEvent(source,!1,viewRange,null,verticalType,revealHorizontal,scrollType))))}changeWhitespace(callback){this.viewLayout.changeWhitespace(callback)&&(this._eventDispatcher.emitSingleViewEvent(new viewEvents.ViewZonesChangedEvent),this._eventDispatcher.emitOutgoingEvent(new viewModelEventDispatcher_1.ViewZonesChangedEvent))}_withViewEventsCollector(callback){try{return callback(this._eventDispatcher.beginEmitViewEvents())}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(position,affinity){return this._lines.normalizePosition(position,affinity)}getLineIndentColumn(lineNumber){return this._lines.getLineIndentColumn(lineNumber)}}exports.ViewModel=ViewModel;class OverviewRulerDecorations{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(color,zIndex,startLineNumber,endLineNumber,lane){const prevGroup=this._asMap[color];if(prevGroup){const prevData=prevGroup.data,prevLane=prevData[prevData.length-3],prevEndLineNumber=prevData[prevData.length-1];if(prevLane===lane&&prevEndLineNumber+1>=startLineNumber)return void(endLineNumber>prevEndLineNumber&&(prevData[prevData.length-1]=endLineNumber));prevData.push(lane,startLineNumber,endLineNumber)}else{const group=new viewModel_1.OverviewRulerDecorationsGroup(color,zIndex,[lane,startLineNumber,endLineNumber]);this._asMap[color]=group,this.asArray.push(group)}}}})),define(__m[163],__M([1,0,507,7,13,4,2,45,614,15,29,670,235,32,277,70,11,3,22,242,149,24,54,23,716,26,17,9,157,39,14,65,19,454,515,151,33,64,20,668,370]),(function(require,exports,nls,dom,errors_1,event_1,lifecycle_1,network_1,editorConfiguration_1,editorExtensions_1,codeEditorService_1,view_1,viewUserInputEvents_1,editorOptions_1,cursor_1,cursorColumns_1,position_1,range_1,selection_1,editorAction_1,editorCommon,editorContextKeys_1,editorColorRegistry_1,colorRegistry_1,viewModelImpl_1,commands_1,contextkey_1,instantiation_1,serviceCollection_1,notification_1,themeService_1,accessibility_1,types_1,monospaceLineBreaksComputer_1,domLineBreaksComputer_1,cursorWordOperations_1,languageConfigurationRegistry_1,domFontInfo_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EditorModeContext=exports.BooleanEventEmitter=exports.CodeEditorWidget=void 0;let EDITOR_ID=0;class ModelData{constructor(model,viewModel,view,hasRealView,listenersToRemove){this.model=model,this.viewModel=viewModel,this.view=view,this.hasRealView=hasRealView,this.listenersToRemove=listenersToRemove}dispose(){(0,lifecycle_1.dispose)(this.listenersToRemove),this.model.onBeforeDetached(),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let CodeEditorWidget=class CodeEditorWidget extends lifecycle_1.Disposable{constructor(domElement,_options,codeEditorWidgetOptions,instantiationService,codeEditorService,commandService,contextKeyService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService){super(),this.languageConfigurationService=languageConfigurationService,this._onDidDispose=this._register(new event_1.Emitter),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new event_1.Emitter),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new event_1.Emitter),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new event_1.Emitter),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new event_1.Emitter),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new event_1.Emitter),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeConfiguration=this._register(new event_1.Emitter),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new event_1.Emitter),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new event_1.Emitter),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new event_1.Emitter),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new event_1.Emitter),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new event_1.Emitter),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new BooleanEventEmitter),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new BooleanEventEmitter),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new event_1.Emitter),this.onWillType=this._onWillType.event,this._onDidType=this._register(new event_1.Emitter),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new event_1.Emitter),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new event_1.Emitter),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new event_1.Emitter),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new event_1.Emitter),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new event_1.Emitter),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new event_1.Emitter),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new event_1.Emitter),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new event_1.Emitter),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onContextMenu=this._register(new event_1.Emitter),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new event_1.Emitter),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new event_1.Emitter),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new event_1.Emitter),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new event_1.Emitter),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new event_1.Emitter),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new event_1.Emitter),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new event_1.Emitter),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new event_1.Emitter),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new event_1.Emitter),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._bannerDomNode=null;const options=Object.assign({},_options);let contributions;this._domElement=domElement,this._overflowWidgetsDomNode=options.overflowWidgetsDomNode,delete options.overflowWidgetsDomNode,this._id=++EDITOR_ID,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=codeEditorWidgetOptions.telemetryData,this._configuration=this._register(this._createConfiguration(codeEditorWidgetOptions.isSimpleWidget||!1,options,accessibilityService)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const options=this._configuration.options;if(e.hasChanged(131)){const layoutInfo=options.get(131);this._onDidLayoutChange.fire(layoutInfo)}}))),this._contextKeyService=this._register(contextKeyService.createScoped(this._domElement)),this._notificationService=notificationService,this._codeEditorService=codeEditorService,this._commandService=commandService,this._themeService=themeService,this._register(new EditorContextKeysManager(this,this._contextKeyService)),this._register(new EditorModeContext(this,this._contextKeyService,languageFeaturesService)),this._instantiationService=instantiationService.createChild(new serviceCollection_1.ServiceCollection([contextkey_1.IContextKeyService,this._contextKeyService])),this._modelData=null,this._contributions={},this._actions={},this._focusTracker=new CodeEditorWidgetFocusTracker(domElement),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},contributions=Array.isArray(codeEditorWidgetOptions.contributions)?codeEditorWidgetOptions.contributions:editorExtensions_1.EditorExtensionsRegistry.getEditorContributions();for(const desc of contributions)if(this._contributions[desc.id])(0,errors_1.onUnexpectedError)(new Error(`Cannot have two contributions with the same id ${desc.id}`));else try{const contribution=this._instantiationService.createInstance(desc.ctor,this);this._contributions[desc.id]=contribution}catch(err){(0,errors_1.onUnexpectedError)(err)}editorExtensions_1.EditorExtensionsRegistry.getEditorActions().forEach((action=>{if(this._actions[action.id])return void(0,errors_1.onUnexpectedError)(new Error(`Cannot have two actions with the same id ${action.id}`));const internalAction=new editorAction_1.InternalEditorAction(action.id,action.label,action.alias,(0,types_1.withNullAsUndefined)(action.precondition),(()=>this._instantiationService.invokeFunction((accessor=>Promise.resolve(action.runEditorCommand(accessor,this,null))))),this._contextKeyService);this._actions[internalAction.id]=internalAction})),this._codeEditorService.addCodeEditor(this)}get isSimpleWidget(){return this._configuration.isSimpleWidget}_createConfiguration(isSimpleWidget,options,accessibilityService){return new editorConfiguration_1.EditorConfiguration(isSimpleWidget,options,this._domElement,accessibilityService)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return editorCommon.EditorType.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose();const keys=Object.keys(this._contributions);for(let i=0,len=keys.length;i<len;i++){const contributionId=keys[i];this._contributions[contributionId].dispose()}this._contributions={},this._actions={},this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(fn){return this._instantiationService.invokeFunction(fn)}updateOptions(newOptions){this._configuration.updateOptions(newOptions||{})}getOptions(){return this._configuration.options}getOption(id){return this._configuration.options.get(id)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(position){return this._modelData?cursorWordOperations_1.WordOperations.getWordAtPosition(this._modelData.model,this._configuration.options.get(117),position):null}getValue(options=null){if(!this._modelData)return"";const preserveBOM=!(!options||!options.preserveBOM);let eolPreference=0;return options&&options.lineEnding&&"\n"===options.lineEnding?eolPreference=1:options&&options.lineEnding&&"\r\n"===options.lineEnding&&(eolPreference=2),this._modelData.model.getValue(eolPreference,preserveBOM)}setValue(newValue){this._modelData&&this._modelData.model.setValue(newValue)}getModel(){return this._modelData?this._modelData.model:null}setModel(_model=null){const model=_model;if(null===this._modelData&&null===model)return;if(this._modelData&&this._modelData.model===model)return;const hasTextFocus=this.hasTextFocus(),detachedModel=this._detachModel();this._attachModel(model),hasTextFocus&&this.hasModel()&&this.focus();const e={oldModelUrl:detachedModel?detachedModel.uri:null,newModelUrl:model?model.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(e),this._postDetachModelCleanup(detachedModel)}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let decorationType in this._decorationTypeSubtypes){const subTypes=this._decorationTypeSubtypes[decorationType];for(let subType in subTypes)this._removeDecorationType(decorationType+"-"+subType)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetForPosition(modelData,modelLineNumber,modelColumn){const modelPosition=modelData.model.validatePosition({lineNumber:modelLineNumber,column:modelColumn}),viewPosition=modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber)}getTopForLineNumber(lineNumber){return this._modelData?CodeEditorWidget._getVerticalOffsetForPosition(this._modelData,lineNumber,1):-1}getTopForPosition(lineNumber,column){return this._modelData?CodeEditorWidget._getVerticalOffsetForPosition(this._modelData,lineNumber,column):-1}setHiddenAreas(ranges){this._modelData&&this._modelData.viewModel.setHiddenAreas(ranges.map((r=>range_1.Range.lift(r))))}getVisibleColumnFromPosition(rawPosition){if(!this._modelData)return rawPosition.column;const position=this._modelData.model.validatePosition(rawPosition),tabSize=this._modelData.model.getOptions().tabSize;return cursorColumns_1.CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber),position.column,tabSize)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(position,source="api"){if(this._modelData){if(!position_1.Position.isIPosition(position))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(source,[{selectionStartLineNumber:position.lineNumber,selectionStartColumn:position.column,positionLineNumber:position.lineNumber,positionColumn:position.column}])}}_sendRevealRange(modelRange,verticalType,revealHorizontal,scrollType){if(!this._modelData)return;if(!range_1.Range.isIRange(modelRange))throw new Error("Invalid arguments");const validatedModelRange=this._modelData.model.validateRange(modelRange),viewRange=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);this._modelData.viewModel.revealRange("api",revealHorizontal,viewRange,verticalType,scrollType)}revealLine(lineNumber,scrollType=0){this._revealLine(lineNumber,0,scrollType)}revealLineInCenter(lineNumber,scrollType=0){this._revealLine(lineNumber,1,scrollType)}revealLineInCenterIfOutsideViewport(lineNumber,scrollType=0){this._revealLine(lineNumber,2,scrollType)}revealLineNearTop(lineNumber,scrollType=0){this._revealLine(lineNumber,5,scrollType)}_revealLine(lineNumber,revealType,scrollType){if("number"!=typeof lineNumber)throw new Error("Invalid arguments");this._sendRevealRange(new range_1.Range(lineNumber,1,lineNumber,1),revealType,!1,scrollType)}revealPosition(position,scrollType=0){this._revealPosition(position,0,!0,scrollType)}revealPositionInCenter(position,scrollType=0){this._revealPosition(position,1,!0,scrollType)}revealPositionInCenterIfOutsideViewport(position,scrollType=0){this._revealPosition(position,2,!0,scrollType)}revealPositionNearTop(position,scrollType=0){this._revealPosition(position,5,!0,scrollType)}_revealPosition(position,verticalType,revealHorizontal,scrollType){if(!position_1.Position.isIPosition(position))throw new Error("Invalid arguments");this._sendRevealRange(new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),verticalType,revealHorizontal,scrollType)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(something,source="api"){const isSelection=selection_1.Selection.isISelection(something),isRange=range_1.Range.isIRange(something);if(!isSelection&&!isRange)throw new Error("Invalid arguments");if(isSelection)this._setSelectionImpl(something,source);else if(isRange){const selection={selectionStartLineNumber:something.startLineNumber,selectionStartColumn:something.startColumn,positionLineNumber:something.endLineNumber,positionColumn:something.endColumn};this._setSelectionImpl(selection,source)}}_setSelectionImpl(sel,source){if(!this._modelData)return;const selection=new selection_1.Selection(sel.selectionStartLineNumber,sel.selectionStartColumn,sel.positionLineNumber,sel.positionColumn);this._modelData.viewModel.setSelections(source,[selection])}revealLines(startLineNumber,endLineNumber,scrollType=0){this._revealLines(startLineNumber,endLineNumber,0,scrollType)}revealLinesInCenter(startLineNumber,endLineNumber,scrollType=0){this._revealLines(startLineNumber,endLineNumber,1,scrollType)}revealLinesInCenterIfOutsideViewport(startLineNumber,endLineNumber,scrollType=0){this._revealLines(startLineNumber,endLineNumber,2,scrollType)}revealLinesNearTop(startLineNumber,endLineNumber,scrollType=0){this._revealLines(startLineNumber,endLineNumber,5,scrollType)}_revealLines(startLineNumber,endLineNumber,verticalType,scrollType){if("number"!=typeof startLineNumber||"number"!=typeof endLineNumber)throw new Error("Invalid arguments");this._sendRevealRange(new range_1.Range(startLineNumber,1,endLineNumber,1),verticalType,!1,scrollType)}revealRange(range,scrollType=0,revealVerticalInCenter=!1,revealHorizontal=!0){this._revealRange(range,revealVerticalInCenter?1:0,revealHorizontal,scrollType)}revealRangeInCenter(range,scrollType=0){this._revealRange(range,1,!0,scrollType)}revealRangeInCenterIfOutsideViewport(range,scrollType=0){this._revealRange(range,2,!0,scrollType)}revealRangeNearTop(range,scrollType=0){this._revealRange(range,5,!0,scrollType)}revealRangeNearTopIfOutsideViewport(range,scrollType=0){this._revealRange(range,6,!0,scrollType)}revealRangeAtTop(range,scrollType=0){this._revealRange(range,3,!0,scrollType)}_revealRange(range,verticalType,revealHorizontal,scrollType){if(!range_1.Range.isIRange(range))throw new Error("Invalid arguments");this._sendRevealRange(range_1.Range.lift(range),verticalType,revealHorizontal,scrollType)}setSelections(ranges,source="api",reason=0){if(this._modelData){if(!ranges||0===ranges.length)throw new Error("Invalid arguments");for(let i=0,len=ranges.length;i<len;i++)if(!selection_1.Selection.isISelection(ranges[i]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(source,ranges,reason)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(newScrollLeft,scrollType=1){if(this._modelData){if("number"!=typeof newScrollLeft)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:newScrollLeft},scrollType)}}setScrollTop(newScrollTop,scrollType=1){if(this._modelData){if("number"!=typeof newScrollTop)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:newScrollTop},scrollType)}}setScrollPosition(position,scrollType=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(position,scrollType)}saveViewState(){if(!this._modelData)return null;const contributionsState={},keys=Object.keys(this._contributions);for(const id of keys){const contribution=this._contributions[id];"function"==typeof contribution.saveViewState&&(contributionsState[id]=contribution.saveViewState())}return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState}}restoreViewState(s){if(!this._modelData||!this._modelData.hasRealView)return;const codeEditorState=s;if(codeEditorState&&codeEditorState.cursorState&&codeEditorState.viewState){const cursorState=codeEditorState.cursorState;Array.isArray(cursorState)?cursorState.length>0&&this._modelData.viewModel.restoreCursorState(cursorState):this._modelData.viewModel.restoreCursorState([cursorState]);const contributionsState=codeEditorState.contributionsState||{},keys=Object.keys(this._contributions);for(let i=0,len=keys.length;i<len;i++){const id=keys[i],contribution=this._contributions[id];"function"==typeof contribution.restoreViewState&&contribution.restoreViewState(contributionsState[id])}const reducedState=this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);this._modelData.view.restoreState(reducedState)}}getContribution(id){return this._contributions[id]||null}getActions(){const result=[],keys=Object.keys(this._actions);for(let i=0,len=keys.length;i<len;i++){const id=keys[i];result.push(this._actions[id])}return result}getSupportedActions(){let result=this.getActions();return result=result.filter((action=>action.isSupported())),result}getAction(id){return this._actions[id]||null}trigger(source,handlerId,payload){switch(payload=payload||{},handlerId){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(source);case"type":{const args=payload;return void this._type(source,args.text||"")}case"replacePreviousChar":{const args=payload;return void this._compositionType(source,args.text||"",args.replaceCharCnt||0,0,0)}case"compositionType":{const args=payload;return void this._compositionType(source,args.text||"",args.replacePrevCharCnt||0,args.replaceNextCharCnt||0,args.positionDelta||0)}case"paste":{const args=payload;return void this._paste(source,args.text||"",args.pasteOnNewLine||!1,args.multicursorText||null,args.mode||null)}case"cut":return void this._cut(source)}const action=this.getAction(handlerId);action?Promise.resolve(action.run()).then(void 0,errors_1.onUnexpectedError):this._modelData&&(this._triggerEditorCommand(source,handlerId,payload)||this._triggerCommand(handlerId,payload))}_triggerCommand(handlerId,payload){this._commandService.executeCommand(handlerId,payload)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(source){this._modelData&&(this._modelData.viewModel.endComposition(source),this._onDidCompositionEnd.fire())}_type(source,text){this._modelData&&0!==text.length&&("keyboard"===source&&this._onWillType.fire(text),this._modelData.viewModel.type(text,source),"keyboard"===source&&this._onDidType.fire(text))}_compositionType(source,text,replacePrevCharCnt,replaceNextCharCnt,positionDelta){this._modelData&&this._modelData.viewModel.compositionType(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta,source)}_paste(source,text,pasteOnNewLine,multicursorText,mode){if(!this._modelData||0===text.length)return;const startPosition=this._modelData.viewModel.getSelection().getStartPosition();this._modelData.viewModel.paste(text,pasteOnNewLine,multicursorText,source);const endPosition=this._modelData.viewModel.getSelection().getStartPosition();"keyboard"===source&&this._onDidPaste.fire({range:new range_1.Range(startPosition.lineNumber,startPosition.column,endPosition.lineNumber,endPosition.column),languageId:mode})}_cut(source){this._modelData&&this._modelData.viewModel.cut(source)}_triggerEditorCommand(source,handlerId,payload){const command=editorExtensions_1.EditorExtensionsRegistry.getEditorCommand(handlerId);return!!command&&((payload=payload||{}).source=source,this._instantiationService.invokeFunction((accessor=>{Promise.resolve(command.runEditorCommand(accessor,this,payload)).then(void 0,errors_1.onUnexpectedError)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(81)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(81)&&(this._modelData.model.popStackElement(),!0))}executeEdits(source,edits,endCursorState){if(!this._modelData)return!1;if(this._configuration.options.get(81))return!1;let cursorStateComputer;return cursorStateComputer=endCursorState?Array.isArray(endCursorState)?()=>endCursorState:endCursorState:()=>null,this._modelData.viewModel.executeEdits(source,edits,cursorStateComputer),!0}executeCommand(source,command){this._modelData&&this._modelData.viewModel.executeCommand(command,source)}executeCommands(source,commands){this._modelData&&this._modelData.viewModel.executeCommands(commands,source)}changeDecorations(callback){return this._modelData?this._modelData.model.changeDecorations(callback,this._id):null}getLineDecorations(lineNumber){return this._modelData?this._modelData.model.getLineDecorations(lineNumber,this._id,(0,editorOptions_1.filterValidationDecorations)(this._configuration.options)):null}getDecorationsInRange(range){return this._modelData?this._modelData.model.getDecorationsInRange(range,this._id,(0,editorOptions_1.filterValidationDecorations)(this._configuration.options)):null}deltaDecorations(oldDecorations,newDecorations){return this._modelData?0===oldDecorations.length&&0===newDecorations.length?oldDecorations:this._modelData.model.deltaDecorations(oldDecorations,newDecorations,this._id):[]}removeDecorations(decorationTypeKey){const oldDecorationsIds=this._decorationTypeKeysToIds[decorationTypeKey];oldDecorationsIds&&this.deltaDecorations(oldDecorationsIds,[]),this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)&&delete this._decorationTypeKeysToIds[decorationTypeKey],this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)&&delete this._decorationTypeSubtypes[decorationTypeKey]}getLayoutInfo(){return this._configuration.options.get(131)}createOverviewRuler(cssClassName){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(cssClassName):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarMouseDown(browserEvent){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent)}layout(dimension){this._configuration.observeContainer(dimension),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(widget){const widgetData={widget,position:widget.getPosition()};this._contentWidgets.hasOwnProperty(widget.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[widget.getId()]=widgetData,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(widgetData)}layoutContentWidget(widget){const widgetId=widget.getId();if(this._contentWidgets.hasOwnProperty(widgetId)){const widgetData=this._contentWidgets[widgetId];widgetData.position=widget.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(widgetData)}}removeContentWidget(widget){const widgetId=widget.getId();if(this._contentWidgets.hasOwnProperty(widgetId)){const widgetData=this._contentWidgets[widgetId];delete this._contentWidgets[widgetId],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(widgetData)}}addOverlayWidget(widget){const widgetData={widget,position:widget.getPosition()};this._overlayWidgets.hasOwnProperty(widget.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[widget.getId()]=widgetData,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(widgetData)}layoutOverlayWidget(widget){const widgetId=widget.getId();if(this._overlayWidgets.hasOwnProperty(widgetId)){const widgetData=this._overlayWidgets[widgetId];widgetData.position=widget.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(widgetData)}}removeOverlayWidget(widget){const widgetId=widget.getId();if(this._overlayWidgets.hasOwnProperty(widgetId)){const widgetData=this._overlayWidgets[widgetId];delete this._overlayWidgets[widgetId],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(widgetData)}}changeViewZones(callback){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(callback)}getTargetAtClientPoint(clientX,clientY){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(clientX,clientY):null}getScrolledVisiblePosition(rawPosition){if(!this._modelData||!this._modelData.hasRealView)return null;const position=this._modelData.model.validatePosition(rawPosition),options=this._configuration.options,layoutInfo=options.get(131);return{top:CodeEditorWidget._getVerticalOffsetForPosition(this._modelData,position.lineNumber,position.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(position.lineNumber,position.column)+layoutInfo.glyphMarginWidth+layoutInfo.lineNumbersWidth+layoutInfo.decorationsWidth-this.getScrollLeft(),height:options.get(59)}}getOffsetForColumn(lineNumber,column){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(lineNumber,column):-1}render(forceRedraw=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,forceRedraw)}setAriaOptions(options){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(options)}applyFontInfo(target){(0,domFontInfo_1.applyFontInfo)(target,this._configuration.options.get(44))}setBanner(domNode,domNodeHeight){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=domNode,this._configuration.setReservedHeight(domNode?domNodeHeight:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(model){if(!model)return void(this._modelData=null);const listenersToRemove=[];this._domElement.setAttribute("data-mode-id",model.getLanguageId()),this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines()),this._configuration.setModelLineCount(model.getLineCount()),model.onBeforeAttached();const viewModel=new viewModelImpl_1.ViewModel(this._id,this._configuration,model,domLineBreaksComputer_1.DOMLineBreaksComputerFactory.create(),monospaceLineBreaksComputer_1.MonospaceLineBreaksComputerFactory.create(this._configuration.options),(callback=>dom.scheduleAtNextAnimationFrame(callback)),this.languageConfigurationService,this._themeService);listenersToRemove.push(model.onDidChangeDecorations((e=>this._onDidChangeModelDecorations.fire(e)))),listenersToRemove.push(model.onDidChangeLanguage((e=>{this._domElement.setAttribute("data-mode-id",model.getLanguageId()),this._onDidChangeModelLanguage.fire(e)}))),listenersToRemove.push(model.onDidChangeLanguageConfiguration((e=>this._onDidChangeModelLanguageConfiguration.fire(e)))),listenersToRemove.push(model.onDidChangeContent((e=>this._onDidChangeModelContent.fire(e)))),listenersToRemove.push(model.onDidChangeOptions((e=>this._onDidChangeModelOptions.fire(e)))),listenersToRemove.push(model.onWillDispose((()=>this.setModel(null)))),listenersToRemove.push(viewModel.onEvent((e=>{switch(e.kind){case 0:this._onDidContentSizeChange.fire(e);break;case 1:this._editorTextFocus.setValue(e.hasFocus);break;case 2:this._onDidScrollChange.fire(e);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{e.reachedMaxCursorCount&&this._notificationService.warn(nls.localize(0,null,cursor_1.CursorsController.MAX_CURSOR_COUNT));const positions=[];for(let i=0,len=e.selections.length;i<len;i++)positions[i]=e.selections[i].getPosition();const e1={position:positions[0],secondaryPositions:positions.slice(1),reason:e.reason,source:e.source};this._onDidChangeCursorPosition.fire(e1);const e2={selection:e.selections[0],secondarySelections:e.selections.slice(1),modelVersionId:e.modelVersionId,oldSelections:e.oldSelections,oldModelVersionId:e.oldModelVersionId,source:e.source,reason:e.reason};this._onDidChangeCursorSelection.fire(e2);break}}})));const[view,hasRealView]=this._createView(viewModel);if(hasRealView){this._domElement.appendChild(view.domNode.domNode);let keys=Object.keys(this._contentWidgets);for(let i=0,len=keys.length;i<len;i++){const widgetId=keys[i];view.addContentWidget(this._contentWidgets[widgetId])}keys=Object.keys(this._overlayWidgets);for(let i=0,len=keys.length;i<len;i++){const widgetId=keys[i];view.addOverlayWidget(this._overlayWidgets[widgetId])}view.render(!1,!0),view.domNode.domNode.setAttribute("data-uri",model.uri.toString())}this._modelData=new ModelData(model,viewModel,view,hasRealView,listenersToRemove)}_createView(viewModel){let commandDelegate;commandDelegate=this.isSimpleWidget?{paste:(text,pasteOnNewLine,multicursorText,mode)=>{this._paste("keyboard",text,pasteOnNewLine,multicursorText,mode)},type:text=>{this._type("keyboard",text)},compositionType:(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta)=>{this._compositionType("keyboard",text,replacePrevCharCnt,replaceNextCharCnt,positionDelta)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(text,pasteOnNewLine,multicursorText,mode)=>{const payload={text,pasteOnNewLine,multicursorText,mode};this._commandService.executeCommand("paste",payload)},type:text=>{const payload={text};this._commandService.executeCommand("type",payload)},compositionType:(text,replacePrevCharCnt,replaceNextCharCnt,positionDelta)=>{if(replaceNextCharCnt||positionDelta){const payload={text,replacePrevCharCnt,replaceNextCharCnt,positionDelta};this._commandService.executeCommand("compositionType",payload)}else{const payload={text,replaceCharCnt:replacePrevCharCnt};this._commandService.executeCommand("replacePreviousChar",payload)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const viewUserInputEvents=new viewUserInputEvents_1.ViewUserInputEvents(viewModel.coordinatesConverter);viewUserInputEvents.onKeyDown=e=>this._onKeyDown.fire(e),viewUserInputEvents.onKeyUp=e=>this._onKeyUp.fire(e),viewUserInputEvents.onContextMenu=e=>this._onContextMenu.fire(e),viewUserInputEvents.onMouseMove=e=>this._onMouseMove.fire(e),viewUserInputEvents.onMouseLeave=e=>this._onMouseLeave.fire(e),viewUserInputEvents.onMouseDown=e=>this._onMouseDown.fire(e),viewUserInputEvents.onMouseUp=e=>this._onMouseUp.fire(e),viewUserInputEvents.onMouseDrag=e=>this._onMouseDrag.fire(e),viewUserInputEvents.onMouseDrop=e=>this._onMouseDrop.fire(e),viewUserInputEvents.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),viewUserInputEvents.onMouseWheel=e=>this._onMouseWheel.fire(e);return[new view_1.View(commandDelegate,this._configuration,this._themeService.getColorTheme(),viewModel,viewUserInputEvents,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(detachedModel){detachedModel&&detachedModel.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const model=this._modelData.model,removeDomNode=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),removeDomNode&&this._domElement.contains(removeDomNode)&&this._domElement.removeChild(removeDomNode),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),model}_removeDecorationType(key){this._codeEditorService.removeDecorationType(key)}hasModel(){return null!==this._modelData}};CodeEditorWidget=__decorate([__param(3,instantiation_1.IInstantiationService),__param(4,codeEditorService_1.ICodeEditorService),__param(5,commands_1.ICommandService),__param(6,contextkey_1.IContextKeyService),__param(7,themeService_1.IThemeService),__param(8,notification_1.INotificationService),__param(9,accessibility_1.IAccessibilityService),__param(10,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(11,languageFeatures_1.ILanguageFeaturesService)],CodeEditorWidget),exports.CodeEditorWidget=CodeEditorWidget;class BooleanEventEmitter extends lifecycle_1.Disposable{constructor(){super(),this._onDidChangeToTrue=this._register(new event_1.Emitter),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new event_1.Emitter),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(_value){const value=_value?2:1;this._value!==value&&(this._value=value,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}exports.BooleanEventEmitter=BooleanEventEmitter;class EditorContextKeysManager extends lifecycle_1.Disposable{constructor(editor,contextKeyService){super(),this._editor=editor,contextKeyService.createKey("editorId",editor.getId()),this._editorSimpleInput=editorContextKeys_1.EditorContextKeys.editorSimpleInput.bindTo(contextKeyService),this._editorFocus=editorContextKeys_1.EditorContextKeys.focus.bindTo(contextKeyService),this._textInputFocus=editorContextKeys_1.EditorContextKeys.textInputFocus.bindTo(contextKeyService),this._editorTextFocus=editorContextKeys_1.EditorContextKeys.editorTextFocus.bindTo(contextKeyService),this._editorTabMovesFocus=editorContextKeys_1.EditorContextKeys.tabMovesFocus.bindTo(contextKeyService),this._editorReadonly=editorContextKeys_1.EditorContextKeys.readOnly.bindTo(contextKeyService),this._inDiffEditor=editorContextKeys_1.EditorContextKeys.inDiffEditor.bindTo(contextKeyService),this._editorColumnSelection=editorContextKeys_1.EditorContextKeys.columnSelection.bindTo(contextKeyService),this._hasMultipleSelections=editorContextKeys_1.EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService),this._hasNonEmptySelection=editorContextKeys_1.EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService),this._canUndo=editorContextKeys_1.EditorContextKeys.canUndo.bindTo(contextKeyService),this._canRedo=editorContextKeys_1.EditorContextKeys.canRedo.bindTo(contextKeyService),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const options=this._editor.getOptions();this._editorTabMovesFocus.set(options.get(130)),this._editorReadonly.set(options.get(81)),this._inDiffEditor.set(options.get(54)),this._editorColumnSelection.set(options.get(18))}_updateFromSelection(){const selections=this._editor.getSelections();selections?(this._hasMultipleSelections.set(selections.length>1),this._hasNonEmptySelection.set(selections.some((s=>!s.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const model=this._editor.getModel();this._canUndo.set(Boolean(model&&model.canUndo())),this._canRedo.set(Boolean(model&&model.canRedo()))}}class EditorModeContext extends lifecycle_1.Disposable{constructor(_editor,_contextKeyService,_languageFeaturesService){super(),this._editor=_editor,this._contextKeyService=_contextKeyService,this._languageFeaturesService=_languageFeaturesService,this._langId=editorContextKeys_1.EditorContextKeys.languageId.bindTo(_contextKeyService),this._hasCompletionItemProvider=editorContextKeys_1.EditorContextKeys.hasCompletionItemProvider.bindTo(_contextKeyService),this._hasCodeActionsProvider=editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider.bindTo(_contextKeyService),this._hasCodeLensProvider=editorContextKeys_1.EditorContextKeys.hasCodeLensProvider.bindTo(_contextKeyService),this._hasDefinitionProvider=editorContextKeys_1.EditorContextKeys.hasDefinitionProvider.bindTo(_contextKeyService),this._hasDeclarationProvider=editorContextKeys_1.EditorContextKeys.hasDeclarationProvider.bindTo(_contextKeyService),this._hasImplementationProvider=editorContextKeys_1.EditorContextKeys.hasImplementationProvider.bindTo(_contextKeyService),this._hasTypeDefinitionProvider=editorContextKeys_1.EditorContextKeys.hasTypeDefinitionProvider.bindTo(_contextKeyService),this._hasHoverProvider=editorContextKeys_1.EditorContextKeys.hasHoverProvider.bindTo(_contextKeyService),this._hasDocumentHighlightProvider=editorContextKeys_1.EditorContextKeys.hasDocumentHighlightProvider.bindTo(_contextKeyService),this._hasDocumentSymbolProvider=editorContextKeys_1.EditorContextKeys.hasDocumentSymbolProvider.bindTo(_contextKeyService),this._hasReferenceProvider=editorContextKeys_1.EditorContextKeys.hasReferenceProvider.bindTo(_contextKeyService),this._hasRenameProvider=editorContextKeys_1.EditorContextKeys.hasRenameProvider.bindTo(_contextKeyService),this._hasSignatureHelpProvider=editorContextKeys_1.EditorContextKeys.hasSignatureHelpProvider.bindTo(_contextKeyService),this._hasInlayHintsProvider=editorContextKeys_1.EditorContextKeys.hasInlayHintsProvider.bindTo(_contextKeyService),this._hasDocumentFormattingProvider=editorContextKeys_1.EditorContextKeys.hasDocumentFormattingProvider.bindTo(_contextKeyService),this._hasDocumentSelectionFormattingProvider=editorContextKeys_1.EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(_contextKeyService),this._hasMultipleDocumentFormattingProvider=editorContextKeys_1.EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(_contextKeyService),this._hasMultipleDocumentSelectionFormattingProvider=editorContextKeys_1.EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(_contextKeyService),this._isInWalkThrough=editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.bindTo(_contextKeyService);const update=()=>this._update();this._register(_editor.onDidChangeModel(update)),this._register(_editor.onDidChangeModelLanguage(update)),this._register(_languageFeaturesService.completionProvider.onDidChange(update)),this._register(_languageFeaturesService.codeActionProvider.onDidChange(update)),this._register(_languageFeaturesService.codeLensProvider.onDidChange(update)),this._register(_languageFeaturesService.definitionProvider.onDidChange(update)),this._register(_languageFeaturesService.declarationProvider.onDidChange(update)),this._register(_languageFeaturesService.implementationProvider.onDidChange(update)),this._register(_languageFeaturesService.typeDefinitionProvider.onDidChange(update)),this._register(_languageFeaturesService.hoverProvider.onDidChange(update)),this._register(_languageFeaturesService.documentHighlightProvider.onDidChange(update)),this._register(_languageFeaturesService.documentSymbolProvider.onDidChange(update)),this._register(_languageFeaturesService.referenceProvider.onDidChange(update)),this._register(_languageFeaturesService.renameProvider.onDidChange(update)),this._register(_languageFeaturesService.documentFormattingEditProvider.onDidChange(update)),this._register(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(update)),this._register(_languageFeaturesService.signatureHelpProvider.onDidChange(update)),this._register(_languageFeaturesService.inlayHintsProvider.onDidChange(update)),update()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const model=this._editor.getModel();model?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(model.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(model)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(model)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(model)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(model)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(model)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(model)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(model)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(model)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(model)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(model)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(model)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(model)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(model)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(model)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(model)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(model)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(model)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(model).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(model).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(model).length>1),this._isInWalkThrough.set(model.uri.scheme===network_1.Schemas.walkThroughSnippet)})):this.reset()}}exports.EditorModeContext=EditorModeContext;class CodeEditorWidgetFocusTracker extends lifecycle_1.Disposable{constructor(domElement){super(),this._onChange=this._register(new event_1.Emitter),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(dom.trackFocus(domElement)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}const squigglyStart=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),squigglyEnd=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function getSquigglySVGData(color){return squigglyStart+encodeURIComponent(color.toString())+squigglyEnd}const dotdotdotStart=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),dotdotdotEnd=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const errorBorderColor=theme.getColor(colorRegistry_1.editorErrorBorder);errorBorderColor&&collector.addRule(`.monaco-editor .squiggly-error { border-bottom: 4px double ${errorBorderColor}; }`);const errorForeground=theme.getColor(colorRegistry_1.editorErrorForeground);errorForeground&&collector.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${getSquigglySVGData(errorForeground)}") repeat-x bottom left; }`);const errorBackground=theme.getColor(colorRegistry_1.editorErrorBackground);errorBackground&&collector.addRule(`.monaco-editor .squiggly-error::before { display: block; content: ''; width: 100%; height: 100%; background: ${errorBackground}; }`);const warningBorderColor=theme.getColor(colorRegistry_1.editorWarningBorder);warningBorderColor&&collector.addRule(`.monaco-editor .squiggly-warning { border-bottom: 4px double ${warningBorderColor}; }`);const warningForeground=theme.getColor(colorRegistry_1.editorWarningForeground);warningForeground&&collector.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${getSquigglySVGData(warningForeground)}") repeat-x bottom left; }`);const warningBackground=theme.getColor(colorRegistry_1.editorWarningBackground);warningBackground&&collector.addRule(`.monaco-editor .squiggly-warning::before { display: block; content: ''; width: 100%; height: 100%; background: ${warningBackground}; }`);const infoBorderColor=theme.getColor(colorRegistry_1.editorInfoBorder);infoBorderColor&&collector.addRule(`.monaco-editor .squiggly-info { border-bottom: 4px double ${infoBorderColor}; }`);const infoForeground=theme.getColor(colorRegistry_1.editorInfoForeground);infoForeground&&collector.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${getSquigglySVGData(infoForeground)}") repeat-x bottom left; }`);const infoBackground=theme.getColor(colorRegistry_1.editorInfoBackground);infoBackground&&collector.addRule(`.monaco-editor .squiggly-info::before { display: block; content: ''; width: 100%; height: 100%; background: ${infoBackground}; }`);const hintBorderColor=theme.getColor(colorRegistry_1.editorHintBorder);hintBorderColor&&collector.addRule(`.monaco-editor .squiggly-hint { border-bottom: 2px dotted ${hintBorderColor}; }`);const hintForeground=theme.getColor(colorRegistry_1.editorHintForeground);hintForeground&&collector.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${function getDotDotDotSVGData(color){return dotdotdotStart+encodeURIComponent(color.toString())+dotdotdotEnd}(hintForeground)}") no-repeat bottom left; }`);const unnecessaryForeground=theme.getColor(editorColorRegistry_1.editorUnnecessaryCodeOpacity);unnecessaryForeground&&collector.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${unnecessaryForeground.rgba.a}; }`);const unnecessaryBorder=theme.getColor(editorColorRegistry_1.editorUnnecessaryCodeBorder);unnecessaryBorder&&collector.addRule(`.monaco-editor.showUnused .squiggly-unnecessary { border-bottom: 2px dashed ${unnecessaryBorder}; }`);const deprecatedForeground=theme.getColor(colorRegistry_1.editorForeground)||"inherit";collector.addRule(`.monaco-editor.showDeprecated .squiggly-inline-deprecated { text-decoration: line-through; text-decoration-color: ${deprecatedForeground}}`)}))})),define(__m[298],__M([1,0,508,7,31,116,10,4,2,64,146,29,163,708,32,3,93,149,38,88,256,154,126,71,17,9,157,39,23,14,78,511,104,15,13,73,233,28,144,74,368]),(function(require,exports,nls,dom,fastDomNode_1,sash_1,async_1,event_1,lifecycle_1,domFontInfo_1,stableEditorScroll_1,codeEditorService_1,codeEditorWidget_1,diffReview_1,editorOptions_1,range_1,stringBuilder_1,editorCommon,textModel_1,editorWorker_1,overviewZoneManager_1,lineDecorations_1,viewLineRenderer_1,viewModel_1,contextkey_1,instantiation_1,serviceCollection_1,notification_1,colorRegistry_1,themeService_1,contextView_1,inlineDiffMargin_1,clipboardService_1,editorExtensions_1,errors_1,progress_1,elementSizeObserver_1,codicons_1,mouseCursor_1,iconRegistry_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DiffEditorWidget=void 0;class VisualEditorState{constructor(_contextMenuService,_clipboardService){this._contextMenuService=_contextMenuService,this._clipboardService=_clipboardService,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(allViewZones){return allViewZones.filter((z=>!this._zonesMap[String(z.id)]))}clean(editor){this._zones.length>0&&editor.changeViewZones((viewChangeAccessor=>{for(const zoneId of this._zones)viewChangeAccessor.removeZone(zoneId)})),this._zones=[],this._zonesMap={},this._decorations=editor.deltaDecorations(this._decorations,[])}apply(editor,overviewRuler,newDecorations,restoreScrollState){const scrollState=restoreScrollState?stableEditorScroll_1.StableEditorScrollState.capture(editor):null;editor.changeViewZones((viewChangeAccessor=>{var _a;for(const zoneId of this._zones)viewChangeAccessor.removeZone(zoneId);for(const inlineDiffMargin of this._inlineDiffMargins)inlineDiffMargin.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let i=0,length=newDecorations.zones.length;i<length;i++){const viewZone=newDecorations.zones[i];viewZone.suppressMouseDown=!0;const zoneId=viewChangeAccessor.addZone(viewZone);this._zones.push(zoneId),this._zonesMap[String(zoneId)]=!0,newDecorations.zones[i].diff&&viewZone.marginDomNode&&(viewZone.suppressMouseDown=!1,0!==(null===(_a=newDecorations.zones[i].diff)||void 0===_a?void 0:_a.originalModel.getValueLength())&&this._inlineDiffMargins.push(new inlineDiffMargin_1.InlineDiffMargin(zoneId,viewZone.marginDomNode,editor,newDecorations.zones[i].diff,this._contextMenuService,this._clipboardService)))}})),scrollState&&scrollState.restore(editor),this._decorations=editor.deltaDecorations(this._decorations,newDecorations.decorations),overviewRuler&&overviewRuler.setZones(newDecorations.overviewZones)}}let DIFF_EDITOR_ID=0;const diffInsertIcon=(0,iconRegistry_1.registerIcon)("diff-insert",codicons_1.Codicon.add,nls.localize(0,null)),diffRemoveIcon=(0,iconRegistry_1.registerIcon)("diff-remove",codicons_1.Codicon.remove,nls.localize(1,null)),ttPolicy=null===(_a=window.trustedTypes)||void 0===_a?void 0:_a.createPolicy("diffEditorWidget",{createHTML:value=>value});let DiffEditorWidget=class DiffEditorWidget extends lifecycle_1.Disposable{constructor(domElement,options,codeEditorWidgetOptions,clipboardService,editorWorkerService,contextKeyService,instantiationService,codeEditorService,themeService,notificationService,contextMenuService,_editorProgressService){super(),this._editorProgressService=_editorProgressService,this._onDidDispose=this._register(new event_1.Emitter),this.onDidDispose=this._onDidDispose.event,this._onDidUpdateDiff=this._register(new event_1.Emitter),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new event_1.Emitter),this._lastOriginalWarning=null,this._lastModifiedWarning=null,this._editorWorkerService=editorWorkerService,this._codeEditorService=codeEditorService,this._contextKeyService=this._register(contextKeyService.createScoped(domElement)),this._instantiationService=instantiationService.createChild(new serviceCollection_1.ServiceCollection([contextkey_1.IContextKeyService,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=themeService,this._notificationService=notificationService,this._id=++DIFF_EDITOR_ID,this._state=0,this._updatingDiffProgress=null,this._domElement=domElement,options=options||{},this._options=validateDiffEditorOptions(options,{enableSplitViewResizing:!0,renderSideBySide:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit"}),void 0!==options.isInEmbeddedEditor?this._contextKeyService.createKey("isInEmbeddedDiffEditor",options.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._updateDecorationsRunner=this._register(new async_1.RunOnceScheduler((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=DiffEditorWidget._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=(0,fastDomNode_1.createFastDomNode)(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(dom.addStandardDisposableListener(this._overviewDomElement,"mousedown",(e=>{this._modifiedEditor.delegateVerticalScrollbarMouseDown(e)}))),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new VisualEditorState(contextMenuService,clipboardService),this._modifiedEditorState=new VisualEditorState(contextMenuService,clipboardService),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new elementSizeObserver_1.ElementSizeObserver(this._containerDomElement,options.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),options.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(options,codeEditorWidgetOptions.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(options,codeEditorWidgetOptions.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=instantiationService.createInstance(diffReview_1.DiffReview,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(themeService.onDidColorThemeChange((t=>{this._strategy&&this._strategy.applyColors(t)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=DiffEditorWidget._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const contributions=editorExtensions_1.EditorExtensionsRegistry.getDiffEditorContributions();for(const desc of contributions)try{this._register(instantiationService.createInstance(desc.ctor,this))}catch(err){(0,errors_1.onUnexpectedError)(err)}this._codeEditorService.addDiffEditor(this)}_setState(newState){this._state!==newState&&(this._state=newState,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(theme,renderSideBySide){let result="monaco-diff-editor monaco-editor-background ";return renderSideBySide&&(result+="side-by-side "),result+=(0,themeService_1.getThemeTypeSelector)(theme.type),result}_recreateOverviewRulers(){this._options.renderOverviewRuler&&(this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(options,codeEditorWidgetOptions){const editor=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(options),codeEditorWidgetOptions);this._register(editor.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(editor.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(editor.onDidChangeConfiguration((e=>{editor.getModel()&&(e.hasChanged(44)&&this._updateDecorationsRunner.schedule(),e.hasChanged(132)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(editor.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(editor.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const isInDiffLeftEditorKey=this._contextKeyService.createKey("isInDiffLeftEditor",editor.hasWidgetFocus());return this._register(editor.onDidFocusEditorWidget((()=>isInDiffLeftEditorKey.set(!0)))),this._register(editor.onDidBlurEditorWidget((()=>isInDiffLeftEditorKey.set(!1)))),this._register(editor.onDidContentSizeChange((e=>{const width=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+DiffEditorWidget.ONE_OVERVIEW_WIDTH,height=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:height,contentWidth:width,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),editor}_createRightHandSideEditor(options,codeEditorWidgetOptions){const editor=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(options),codeEditorWidgetOptions);this._register(editor.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(editor.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(editor.onDidChangeConfiguration((e=>{editor.getModel()&&(e.hasChanged(44)&&this._updateDecorationsRunner.schedule(),e.hasChanged(132)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(editor.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(editor.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(editor.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const isInDiffRightEditorKey=this._contextKeyService.createKey("isInDiffRightEditor",editor.hasWidgetFocus());return this._register(editor.onDidFocusEditorWidget((()=>isInDiffRightEditorKey.set(!0)))),this._register(editor.onDidBlurEditorWidget((()=>isInDiffRightEditorKey.set(!1)))),this._register(editor.onDidContentSizeChange((e=>{const width=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+DiffEditorWidget.ONE_OVERVIEW_WIDTH,height=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:height,contentWidth:width,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),editor}_createInnerEditor(instantiationService,container,options,editorWidgetOptions){return instantiationService.createInstance(codeEditorWidget_1.CodeEditorWidget,container,options,editorWidgetOptions)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return editorCommon.EditorType.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(_newOptions){const newOptions=validateDiffEditorOptions(_newOptions,this._options),changed=function changedDiffEditorOptions(a,b){return{enableSplitViewResizing:a.enableSplitViewResizing!==b.enableSplitViewResizing,renderSideBySide:a.renderSideBySide!==b.renderSideBySide,maxComputationTime:a.maxComputationTime!==b.maxComputationTime,maxFileSize:a.maxFileSize!==b.maxFileSize,ignoreTrimWhitespace:a.ignoreTrimWhitespace!==b.ignoreTrimWhitespace,renderIndicators:a.renderIndicators!==b.renderIndicators,originalEditable:a.originalEditable!==b.originalEditable,diffCodeLens:a.diffCodeLens!==b.diffCodeLens,renderOverviewRuler:a.renderOverviewRuler!==b.renderOverviewRuler,diffWordWrap:a.diffWordWrap!==b.diffWordWrap}}(this._options,newOptions);this._options=newOptions;const beginUpdateDecorations=changed.ignoreTrimWhitespace||changed.renderIndicators,beginUpdateDecorationsSoon=this._isVisible&&(changed.maxComputationTime||changed.maxFileSize);beginUpdateDecorations?this._beginUpdateDecorations():beginUpdateDecorationsSoon&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(_newOptions)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(_newOptions)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing),changed.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=DiffEditorWidget._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),changed.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(model){if(model&&(!model.original||!model.modified))throw new Error(model.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._originalEditor.setModel(model?model.original:null),this._modifiedEditor.setModel(model?model.modified:null),this._updateDecorationsRunner.cancel(),model&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),model&&(this._recreateOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport()}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(position){return this._modifiedEditor.getVisibleColumnFromPosition(position)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(position,source="api"){this._modifiedEditor.setPosition(position,source)}revealLine(lineNumber,scrollType=0){this._modifiedEditor.revealLine(lineNumber,scrollType)}revealLineInCenter(lineNumber,scrollType=0){this._modifiedEditor.revealLineInCenter(lineNumber,scrollType)}revealLineInCenterIfOutsideViewport(lineNumber,scrollType=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(lineNumber,scrollType)}revealLineNearTop(lineNumber,scrollType=0){this._modifiedEditor.revealLineNearTop(lineNumber,scrollType)}revealPosition(position,scrollType=0){this._modifiedEditor.revealPosition(position,scrollType)}revealPositionInCenter(position,scrollType=0){this._modifiedEditor.revealPositionInCenter(position,scrollType)}revealPositionInCenterIfOutsideViewport(position,scrollType=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(position,scrollType)}revealPositionNearTop(position,scrollType=0){this._modifiedEditor.revealPositionNearTop(position,scrollType)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(something,source="api"){this._modifiedEditor.setSelection(something,source)}setSelections(ranges,source="api"){this._modifiedEditor.setSelections(ranges,source)}revealLines(startLineNumber,endLineNumber,scrollType=0){this._modifiedEditor.revealLines(startLineNumber,endLineNumber,scrollType)}revealLinesInCenter(startLineNumber,endLineNumber,scrollType=0){this._modifiedEditor.revealLinesInCenter(startLineNumber,endLineNumber,scrollType)}revealLinesInCenterIfOutsideViewport(startLineNumber,endLineNumber,scrollType=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(startLineNumber,endLineNumber,scrollType)}revealLinesNearTop(startLineNumber,endLineNumber,scrollType=0){this._modifiedEditor.revealLinesNearTop(startLineNumber,endLineNumber,scrollType)}revealRange(range,scrollType=0,revealVerticalInCenter=!1,revealHorizontal=!0){this._modifiedEditor.revealRange(range,scrollType,revealVerticalInCenter,revealHorizontal)}revealRangeInCenter(range,scrollType=0){this._modifiedEditor.revealRangeInCenter(range,scrollType)}revealRangeInCenterIfOutsideViewport(range,scrollType=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(range,scrollType)}revealRangeNearTop(range,scrollType=0){this._modifiedEditor.revealRangeNearTop(range,scrollType)}revealRangeNearTopIfOutsideViewport(range,scrollType=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(range,scrollType)}revealRangeAtTop(range,scrollType=0){this._modifiedEditor.revealRangeAtTop(range,scrollType)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}restoreViewState(s){if(s&&s.original&&s.modified){const diffEditorState=s;this._originalEditor.restoreViewState(diffEditorState.original),this._modifiedEditor.restoreViewState(diffEditorState.modified)}}layout(dimension){this._elementSizeObserver.observe(dimension)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(source,handlerId,payload){this._modifiedEditor.trigger(source,handlerId,payload)}changeDecorations(callback){return this._modifiedEditor.changeDecorations(callback)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const height=this._elementSizeObserver.getHeight(),reviewHeight=this._getReviewHeight(),freeSpace=DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH-2*DiffEditorWidget.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:DiffEditorWidget.ONE_OVERVIEW_WIDTH,right:freeSpace+DiffEditorWidget.ONE_OVERVIEW_WIDTH,height:height-reviewHeight}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:DiffEditorWidget.ONE_OVERVIEW_WIDTH,height:height-reviewHeight}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(a,b){return!a&&!b||!(!a||!b)&&a.toString()===b.toString()}_beginUpdateDecorations(){this._beginUpdateDecorationsTimeout=-1;const currentOriginalModel=this._originalEditor.getModel(),currentModifiedModel=this._modifiedEditor.getModel();if(!currentOriginalModel||!currentModifiedModel)return;this._diffComputationToken++;const currentToken=this._diffComputationToken,diffLimit=1024*this._options.maxFileSize*1024,canSyncModelForDiff=model=>{const bufferTextLength=model.getValueLength();return 0===diffLimit||bufferTextLength<=diffLimit};canSyncModelForDiff(currentOriginalModel)&&canSyncModelForDiff(currentModifiedModel)?(this._setState(1),this._editorWorkerService.computeDiff(currentOriginalModel.uri,currentModifiedModel.uri,this._options.ignoreTrimWhitespace,this._options.maxComputationTime).then((result=>{currentToken===this._diffComputationToken&&currentOriginalModel===this._originalEditor.getModel()&&currentModifiedModel===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=result,this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(error=>{currentToken===this._diffComputationToken&&currentOriginalModel===this._originalEditor.getModel()&&currentModifiedModel===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):DiffEditorWidget._equals(currentOriginalModel.uri,this._lastOriginalWarning)&&DiffEditorWidget._equals(currentModifiedModel.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=currentOriginalModel.uri,this._lastModifiedWarning=currentModifiedModel.uri,this._notificationService.warn(nls.localize(2,null)))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const lineChanges=this._diffComputationResult?this._diffComputationResult.changes:[],foreignOriginal=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),foreignModified=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),diffDecorations=this._strategy.getEditorsDiffDecorations(lineChanges,this._options.ignoreTrimWhitespace,this._options.renderIndicators,foreignOriginal,foreignModified);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,diffDecorations.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,diffDecorations.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(options){const clonedOptions=Object.assign({},options);return clonedOptions.inDiffEditor=!0,clonedOptions.automaticLayout=!1,clonedOptions.scrollbar=Object.assign({},clonedOptions.scrollbar||{}),clonedOptions.scrollbar.vertical="visible",clonedOptions.folding=!1,clonedOptions.codeLens=this._options.diffCodeLens,clonedOptions.fixedOverflowWidgets=!0,clonedOptions.minimap=Object.assign({},clonedOptions.minimap||{}),clonedOptions.minimap.enabled=!1,clonedOptions}_adjustOptionsForLeftHandSide(options){const result=this._adjustOptionsForSubEditor(options);return this._options.renderSideBySide?result.wordWrapOverride1=this._options.diffWordWrap:(result.wordWrapOverride1="off",result.wordWrapOverride2="off"),options.originalAriaLabel&&(result.ariaLabel=options.originalAriaLabel),result.readOnly=!this._options.originalEditable,result.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},result),{dimension:{height:0,width:0}})}_adjustOptionsForRightHandSide(options){const result=this._adjustOptionsForSubEditor(options);return options.modifiedAriaLabel&&(result.ariaLabel=options.modifiedAriaLabel),result.wordWrapOverride1=this._options.diffWordWrap,result.revealHorizontalRightPadding=editorOptions_1.EditorOptions.revealHorizontalRightPadding.defaultValue+DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH,result.scrollbar.verticalHasArrows=!1,result.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},result),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const width=this._elementSizeObserver.getWidth(),height=this._elementSizeObserver.getHeight(),reviewHeight=this._getReviewHeight(),splitPoint=this._strategy.layout();this._originalDomNode.style.width=splitPoint+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=width-splitPoint+"px",this._modifiedDomNode.style.left=splitPoint+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=height-reviewHeight+"px",this._overviewDomElement.style.width=DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=width-DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:splitPoint,height:height-reviewHeight}),this._modifiedEditor.layout({width:width-splitPoint-(this._options.renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:height-reviewHeight}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(height-reviewHeight,width,reviewHeight),this._layoutOverviewViewport()}_layoutOverviewViewport(){const layout=this._computeOverviewViewport();layout?(this._overviewViewportDomElement.setTop(layout.top),this._overviewViewportDomElement.setHeight(layout.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const layoutInfo=this._modifiedEditor.getLayoutInfo();if(!layoutInfo)return null;const scrollTop=this._modifiedEditor.getScrollTop(),scrollHeight=this._modifiedEditor.getScrollHeight(),computedAvailableSize=Math.max(0,layoutInfo.height),computedRepresentableSize=Math.max(0,computedAvailableSize-0),computedRatio=scrollHeight>0?computedRepresentableSize/scrollHeight:0;return{height:Math.max(0,Math.floor(layoutInfo.height*computedRatio)),top:Math.floor(scrollTop*computedRatio)}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(newStrategy){this._strategy&&this._strategy.dispose(),this._strategy=newStrategy,newStrategy.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(lineNumber,startLineNumberExtractor){const lineChanges=this._diffComputationResult?this._diffComputationResult.changes:[];if(0===lineChanges.length||lineNumber<startLineNumberExtractor(lineChanges[0]))return null;let min=0,max=lineChanges.length-1;for(;min<max;){const mid=Math.floor((min+max)/2),midStart=startLineNumberExtractor(lineChanges[mid]),midEnd=mid+1<=max?startLineNumberExtractor(lineChanges[mid+1]):1073741824;lineNumber<midStart?max=mid-1:lineNumber>=midEnd?min=mid+1:(min=mid,max=mid)}return lineChanges[min]}_getEquivalentLineForOriginalLineNumber(lineNumber){const lineChange=this._getLineChangeAtOrBeforeLineNumber(lineNumber,(lineChange=>lineChange.originalStartLineNumber));if(!lineChange)return lineNumber;const originalEquivalentLineNumber=lineChange.originalStartLineNumber+(lineChange.originalEndLineNumber>0?-1:0),modifiedEquivalentLineNumber=lineChange.modifiedStartLineNumber+(lineChange.modifiedEndLineNumber>0?-1:0),lineChangeOriginalLength=lineChange.originalEndLineNumber>0?lineChange.originalEndLineNumber-lineChange.originalStartLineNumber+1:0,lineChangeModifiedLength=lineChange.modifiedEndLineNumber>0?lineChange.modifiedEndLineNumber-lineChange.modifiedStartLineNumber+1:0,delta=lineNumber-originalEquivalentLineNumber;return delta<=lineChangeOriginalLength?modifiedEquivalentLineNumber+Math.min(delta,lineChangeModifiedLength):modifiedEquivalentLineNumber+lineChangeModifiedLength-lineChangeOriginalLength+delta}_getEquivalentLineForModifiedLineNumber(lineNumber){const lineChange=this._getLineChangeAtOrBeforeLineNumber(lineNumber,(lineChange=>lineChange.modifiedStartLineNumber));if(!lineChange)return lineNumber;const originalEquivalentLineNumber=lineChange.originalStartLineNumber+(lineChange.originalEndLineNumber>0?-1:0),modifiedEquivalentLineNumber=lineChange.modifiedStartLineNumber+(lineChange.modifiedEndLineNumber>0?-1:0),lineChangeOriginalLength=lineChange.originalEndLineNumber>0?lineChange.originalEndLineNumber-lineChange.originalStartLineNumber+1:0,lineChangeModifiedLength=lineChange.modifiedEndLineNumber>0?lineChange.modifiedEndLineNumber-lineChange.modifiedStartLineNumber+1:0,delta=lineNumber-modifiedEquivalentLineNumber;return delta<=lineChangeModifiedLength?originalEquivalentLineNumber+Math.min(delta,lineChangeOriginalLength):originalEquivalentLineNumber+lineChangeOriginalLength-lineChangeModifiedLength+delta}getDiffLineInformationForOriginal(lineNumber){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(lineNumber)}:null}getDiffLineInformationForModified(lineNumber){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(lineNumber)}:null}};DiffEditorWidget.ONE_OVERVIEW_WIDTH=15,DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH=30,DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY=200,DiffEditorWidget=__decorate([__param(3,clipboardService_1.IClipboardService),__param(4,editorWorker_1.IEditorWorkerService),__param(5,contextkey_1.IContextKeyService),__param(6,instantiation_1.IInstantiationService),__param(7,codeEditorService_1.ICodeEditorService),__param(8,themeService_1.IThemeService),__param(9,notification_1.INotificationService),__param(10,contextView_1.IContextMenuService),__param(11,progress_1.IEditorProgressService)],DiffEditorWidget),exports.DiffEditorWidget=DiffEditorWidget;class DiffEditorWidgetStyle extends lifecycle_1.Disposable{constructor(dataSource){super(),this._dataSource=dataSource,this._insertColor=null,this._removeColor=null}applyColors(theme){const newInsertColor=theme.getColor(colorRegistry_1.diffOverviewRulerInserted)||(theme.getColor(colorRegistry_1.diffInserted)||colorRegistry_1.defaultInsertColor).transparent(2),newRemoveColor=theme.getColor(colorRegistry_1.diffOverviewRulerRemoved)||(theme.getColor(colorRegistry_1.diffRemoved)||colorRegistry_1.defaultRemoveColor).transparent(2),hasChanges=!newInsertColor.equals(this._insertColor)||!newRemoveColor.equals(this._removeColor);return this._insertColor=newInsertColor,this._removeColor=newRemoveColor,hasChanges}getEditorsDiffDecorations(lineChanges,ignoreTrimWhitespace,renderIndicators,originalWhitespaces,modifiedWhitespaces){modifiedWhitespaces=modifiedWhitespaces.sort(((a,b)=>a.afterLineNumber-b.afterLineNumber)),originalWhitespaces=originalWhitespaces.sort(((a,b)=>a.afterLineNumber-b.afterLineNumber));const zones=this._getViewZones(lineChanges,originalWhitespaces,modifiedWhitespaces,renderIndicators),originalDecorations=this._getOriginalEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators),modifiedDecorations=this._getModifiedEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators);return{original:{decorations:originalDecorations.decorations,overviewZones:originalDecorations.overviewZones,zones:zones.original},modified:{decorations:modifiedDecorations.decorations,overviewZones:modifiedDecorations.overviewZones,zones:zones.modified}}}}class ForeignViewZonesIterator{constructor(source){this._source=source,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class ViewZonesComputer{constructor(_lineChanges,_originalForeignVZ,_modifiedForeignVZ,_originalEditor,_modifiedEditor){this._lineChanges=_lineChanges,this._originalForeignVZ=_originalForeignVZ,this._modifiedForeignVZ=_modifiedForeignVZ,this._originalEditor=_originalEditor,this._modifiedEditor=_modifiedEditor}static _getViewLineCount(editor,startLineNumber,endLineNumber){const model=editor.getModel(),viewModel=editor._getViewModel();if(model&&viewModel){const viewRange=getViewRange(model,viewModel,startLineNumber,endLineNumber);return viewRange.endLineNumber-viewRange.startLineNumber+1}return endLineNumber-startLineNumber+1}getViewZones(){const originalLineHeight=this._originalEditor.getOption(59),modifiedLineHeight=this._modifiedEditor.getOption(59),originalHasWrapping=-1!==this._originalEditor.getOption(132).wrappingColumn,modifiedHasWrapping=-1!==this._modifiedEditor.getOption(132).wrappingColumn,hasWrapping=originalHasWrapping||modifiedHasWrapping,originalModel=this._originalEditor.getModel(),originalCoordinatesConverter=this._originalEditor._getViewModel().coordinatesConverter,modifiedCoordinatesConverter=this._modifiedEditor._getViewModel().coordinatesConverter,result_original=[],result_modified=[];let lineChangeModifiedLength=0,lineChangeOriginalLength=0,originalEquivalentLineNumber=0,modifiedEquivalentLineNumber=0,originalEndEquivalentLineNumber=0,modifiedEndEquivalentLineNumber=0;const sortMyViewZones=(a,b)=>a.afterLineNumber-b.afterLineNumber,addAndCombineIfPossible=(destination,item)=>{if(null===item.domNode&&destination.length>0){const lastItem=destination[destination.length-1];if(lastItem.afterLineNumber===item.afterLineNumber&&null===lastItem.domNode)return void(lastItem.heightInLines+=item.heightInLines)}destination.push(item)},modifiedForeignVZ=new ForeignViewZonesIterator(this._modifiedForeignVZ),originalForeignVZ=new ForeignViewZonesIterator(this._originalForeignVZ);let lastOriginalLineNumber=1,lastModifiedLineNumber=1;for(let i=0,length=this._lineChanges.length;i<=length;i++){const lineChange=i<length?this._lineChanges[i]:null;null!==lineChange?(originalEquivalentLineNumber=lineChange.originalStartLineNumber+(lineChange.originalEndLineNumber>0?-1:0),modifiedEquivalentLineNumber=lineChange.modifiedStartLineNumber+(lineChange.modifiedEndLineNumber>0?-1:0),lineChangeOriginalLength=lineChange.originalEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._originalEditor,lineChange.originalStartLineNumber,lineChange.originalEndLineNumber):0,lineChangeModifiedLength=lineChange.modifiedEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._modifiedEditor,lineChange.modifiedStartLineNumber,lineChange.modifiedEndLineNumber):0,originalEndEquivalentLineNumber=Math.max(lineChange.originalStartLineNumber,lineChange.originalEndLineNumber),modifiedEndEquivalentLineNumber=Math.max(lineChange.modifiedStartLineNumber,lineChange.modifiedEndLineNumber)):(originalEquivalentLineNumber+=1e7+lineChangeOriginalLength,modifiedEquivalentLineNumber+=1e7+lineChangeModifiedLength,originalEndEquivalentLineNumber=originalEquivalentLineNumber,modifiedEndEquivalentLineNumber=modifiedEquivalentLineNumber);let stepOriginal=[],stepModified=[];if(hasWrapping){let count;count=lineChange?lineChange.originalEndLineNumber>0?lineChange.originalStartLineNumber-lastOriginalLineNumber:lineChange.modifiedStartLineNumber-lastModifiedLineNumber:originalModel.getLineCount()-lastOriginalLineNumber+1;for(let i=0;i<count;i++){const originalLineNumber=lastOriginalLineNumber+i,modifiedLineNumber=lastModifiedLineNumber+i,originalViewLineCount=originalCoordinatesConverter.getModelLineViewLineCount(originalLineNumber),modifiedViewLineCount=modifiedCoordinatesConverter.getModelLineViewLineCount(modifiedLineNumber);originalViewLineCount<modifiedViewLineCount?stepOriginal.push({afterLineNumber:originalLineNumber,heightInLines:modifiedViewLineCount-originalViewLineCount,domNode:null,marginDomNode:null}):originalViewLineCount>modifiedViewLineCount&&stepModified.push({afterLineNumber:modifiedLineNumber,heightInLines:originalViewLineCount-modifiedViewLineCount,domNode:null,marginDomNode:null})}lineChange&&(lastOriginalLineNumber=(lineChange.originalEndLineNumber>0?lineChange.originalEndLineNumber:lineChange.originalStartLineNumber)+1,lastModifiedLineNumber=(lineChange.modifiedEndLineNumber>0?lineChange.modifiedEndLineNumber:lineChange.modifiedStartLineNumber)+1)}for(;modifiedForeignVZ.current&&modifiedForeignVZ.current.afterLineNumber<=modifiedEndEquivalentLineNumber;){let viewZoneLineNumber;viewZoneLineNumber=modifiedForeignVZ.current.afterLineNumber<=modifiedEquivalentLineNumber?originalEquivalentLineNumber-modifiedEquivalentLineNumber+modifiedForeignVZ.current.afterLineNumber:originalEndEquivalentLineNumber;let marginDomNode=null;lineChange&&lineChange.modifiedStartLineNumber<=modifiedForeignVZ.current.afterLineNumber&&modifiedForeignVZ.current.afterLineNumber<=lineChange.modifiedEndLineNumber&&(marginDomNode=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),stepOriginal.push({afterLineNumber:viewZoneLineNumber,heightInLines:modifiedForeignVZ.current.height/modifiedLineHeight,domNode:null,marginDomNode}),modifiedForeignVZ.advance()}for(;originalForeignVZ.current&&originalForeignVZ.current.afterLineNumber<=originalEndEquivalentLineNumber;){let viewZoneLineNumber;viewZoneLineNumber=originalForeignVZ.current.afterLineNumber<=originalEquivalentLineNumber?modifiedEquivalentLineNumber-originalEquivalentLineNumber+originalForeignVZ.current.afterLineNumber:modifiedEndEquivalentLineNumber,stepModified.push({afterLineNumber:viewZoneLineNumber,heightInLines:originalForeignVZ.current.height/originalLineHeight,domNode:null}),originalForeignVZ.advance()}if(null!==lineChange&&isChangeOrInsert(lineChange)){const r=this._produceOriginalFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength);r&&stepOriginal.push(r)}if(null!==lineChange&&isChangeOrDelete(lineChange)){const r=this._produceModifiedFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength);r&&stepModified.push(r)}let stepOriginalIndex=0,stepModifiedIndex=0;for(stepOriginal=stepOriginal.sort(sortMyViewZones),stepModified=stepModified.sort(sortMyViewZones);stepOriginalIndex<stepOriginal.length&&stepModifiedIndex<stepModified.length;){const original=stepOriginal[stepOriginalIndex],modified=stepModified[stepModifiedIndex],originalDelta=original.afterLineNumber-originalEquivalentLineNumber,modifiedDelta=modified.afterLineNumber-modifiedEquivalentLineNumber;originalDelta<modifiedDelta?(addAndCombineIfPossible(result_original,original),stepOriginalIndex++):modifiedDelta<originalDelta?(addAndCombineIfPossible(result_modified,modified),stepModifiedIndex++):original.shouldNotShrink?(addAndCombineIfPossible(result_original,original),stepOriginalIndex++):modified.shouldNotShrink?(addAndCombineIfPossible(result_modified,modified),stepModifiedIndex++):original.heightInLines>=modified.heightInLines?(original.heightInLines-=modified.heightInLines,stepModifiedIndex++):(modified.heightInLines-=original.heightInLines,stepOriginalIndex++)}for(;stepOriginalIndex<stepOriginal.length;)addAndCombineIfPossible(result_original,stepOriginal[stepOriginalIndex]),stepOriginalIndex++;for(;stepModifiedIndex<stepModified.length;)addAndCombineIfPossible(result_modified,stepModified[stepModifiedIndex]),stepModifiedIndex++}return{original:ViewZonesComputer._ensureDomNodes(result_original),modified:ViewZonesComputer._ensureDomNodes(result_modified)}}static _ensureDomNodes(zones){return zones.map((z=>(z.domNode||(z.domNode=createFakeLinesDiv()),z)))}}function createDecoration(startLineNumber,startColumn,endLineNumber,endColumn,options){return{range:new range_1.Range(startLineNumber,startColumn,endLineNumber,endColumn),options}}const DECORATIONS={charDelete:textModel_1.ModelDecorationOptions.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:textModel_1.ModelDecorationOptions.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:textModel_1.ModelDecorationOptions.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:textModel_1.ModelDecorationOptions.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:textModel_1.ModelDecorationOptions.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:textModel_1.ModelDecorationOptions.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+themeService_1.ThemeIcon.asClassName(diffInsertIcon),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:textModel_1.ModelDecorationOptions.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:textModel_1.ModelDecorationOptions.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+themeService_1.ThemeIcon.asClassName(diffRemoveIcon),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:textModel_1.ModelDecorationOptions.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class DiffEditorWidgetSideBySide extends DiffEditorWidgetStyle{constructor(dataSource,enableSplitViewResizing){super(dataSource),this._disableSash=!1===enableSplitViewResizing,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new sash_1.Sash(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(enableSplitViewResizing){const newDisableSash=!1===enableSplitViewResizing;this._disableSash!==newDisableSash&&(this._disableSash=newDisableSash,this._sash.state=this._disableSash?0:3)}layout(sashRatio=this._sashRatio){const contentWidth=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let sashPosition=Math.floor((sashRatio||.5)*contentWidth);const midPoint=Math.floor(.5*contentWidth);return sashPosition=this._disableSash?midPoint:sashPosition||midPoint,contentWidth>2*DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH?(sashPosition<DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(sashPosition=DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH),sashPosition>contentWidth-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(sashPosition=contentWidth-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH)):sashPosition=midPoint,this._sashPosition!==sashPosition&&(this._sashPosition=sashPosition),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const contentWidth=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0),sashPosition=this.layout((this._startSashPosition+(e.currentX-e.startX))/contentWidth);this._sashRatio=sashPosition/contentWidth,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=.5,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(sash){return 0}getVerticalSashLeft(sash){return this._sashPosition}getVerticalSashHeight(sash){return this._dataSource.getHeight()}_getViewZones(lineChanges,originalForeignVZ,modifiedForeignVZ){const originalEditor=this._dataSource.getOriginalEditor(),modifiedEditor=this._dataSource.getModifiedEditor();return new SideBySideViewZonesComputer(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor).getViewZones()}_getOriginalEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators){const originalEditor=this._dataSource.getOriginalEditor(),overviewZoneColor=String(this._removeColor),result={decorations:[],overviewZones:[]},originalModel=originalEditor.getModel(),originalViewModel=originalEditor._getViewModel();for(const lineChange of lineChanges)if(isChangeOrDelete(lineChange)){result.decorations.push({range:new range_1.Range(lineChange.originalStartLineNumber,1,lineChange.originalEndLineNumber,1073741824),options:renderIndicators?DECORATIONS.lineDeleteWithSign:DECORATIONS.lineDelete}),isChangeOrInsert(lineChange)&&lineChange.charChanges||result.decorations.push(createDecoration(lineChange.originalStartLineNumber,1,lineChange.originalEndLineNumber,1073741824,DECORATIONS.charDeleteWholeLine));const viewRange=getViewRange(originalModel,originalViewModel,lineChange.originalStartLineNumber,lineChange.originalEndLineNumber);if(result.overviewZones.push(new overviewZoneManager_1.OverviewRulerZone(viewRange.startLineNumber,viewRange.endLineNumber,0,overviewZoneColor)),lineChange.charChanges)for(const charChange of lineChange.charChanges)if(isChangeOrDelete(charChange))if(ignoreTrimWhitespace)for(let lineNumber=charChange.originalStartLineNumber;lineNumber<=charChange.originalEndLineNumber;lineNumber++){let startColumn,endColumn;startColumn=lineNumber===charChange.originalStartLineNumber?charChange.originalStartColumn:originalModel.getLineFirstNonWhitespaceColumn(lineNumber),endColumn=lineNumber===charChange.originalEndLineNumber?charChange.originalEndColumn:originalModel.getLineLastNonWhitespaceColumn(lineNumber),result.decorations.push(createDecoration(lineNumber,startColumn,lineNumber,endColumn,DECORATIONS.charDelete))}else result.decorations.push(createDecoration(charChange.originalStartLineNumber,charChange.originalStartColumn,charChange.originalEndLineNumber,charChange.originalEndColumn,DECORATIONS.charDelete))}return result}_getModifiedEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators){const modifiedEditor=this._dataSource.getModifiedEditor(),overviewZoneColor=String(this._insertColor),result={decorations:[],overviewZones:[]},modifiedModel=modifiedEditor.getModel(),modifiedViewModel=modifiedEditor._getViewModel();for(const lineChange of lineChanges)if(isChangeOrInsert(lineChange)){result.decorations.push({range:new range_1.Range(lineChange.modifiedStartLineNumber,1,lineChange.modifiedEndLineNumber,1073741824),options:renderIndicators?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert}),isChangeOrDelete(lineChange)&&lineChange.charChanges||result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber,1,lineChange.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine));const viewRange=getViewRange(modifiedModel,modifiedViewModel,lineChange.modifiedStartLineNumber,lineChange.modifiedEndLineNumber);if(result.overviewZones.push(new overviewZoneManager_1.OverviewRulerZone(viewRange.startLineNumber,viewRange.endLineNumber,0,overviewZoneColor)),lineChange.charChanges)for(const charChange of lineChange.charChanges)if(isChangeOrInsert(charChange))if(ignoreTrimWhitespace)for(let lineNumber=charChange.modifiedStartLineNumber;lineNumber<=charChange.modifiedEndLineNumber;lineNumber++){let startColumn,endColumn;startColumn=lineNumber===charChange.modifiedStartLineNumber?charChange.modifiedStartColumn:modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber),endColumn=lineNumber===charChange.modifiedEndLineNumber?charChange.modifiedEndColumn:modifiedModel.getLineLastNonWhitespaceColumn(lineNumber),result.decorations.push(createDecoration(lineNumber,startColumn,lineNumber,endColumn,DECORATIONS.charInsert))}else result.decorations.push(createDecoration(charChange.modifiedStartLineNumber,charChange.modifiedStartColumn,charChange.modifiedEndLineNumber,charChange.modifiedEndColumn,DECORATIONS.charInsert))}return result}}DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH=100;class SideBySideViewZonesComputer extends ViewZonesComputer{constructor(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor){super(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength){return lineChangeModifiedLength>lineChangeOriginalLength?{afterLineNumber:Math.max(lineChange.originalStartLineNumber,lineChange.originalEndLineNumber),heightInLines:lineChangeModifiedLength-lineChangeOriginalLength,domNode:null}:null}_produceModifiedFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength){return lineChangeOriginalLength>lineChangeModifiedLength?{afterLineNumber:Math.max(lineChange.modifiedStartLineNumber,lineChange.modifiedEndLineNumber),heightInLines:lineChangeOriginalLength-lineChangeModifiedLength,domNode:null}:null}}class DiffEditorWidgetInline extends DiffEditorWidgetStyle{constructor(dataSource,enableSplitViewResizing){super(dataSource),this._decorationsLeft=dataSource.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(dataSource.getOriginalEditor().onDidLayoutChange((layoutInfo=>{this._decorationsLeft!==layoutInfo.decorationsLeft&&(this._decorationsLeft=layoutInfo.decorationsLeft,dataSource.relayoutEditors())})))}setEnableSplitViewResizing(enableSplitViewResizing){}_getViewZones(lineChanges,originalForeignVZ,modifiedForeignVZ,renderIndicators){const originalEditor=this._dataSource.getOriginalEditor(),modifiedEditor=this._dataSource.getModifiedEditor();return new InlineViewZonesComputer(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor,renderIndicators).getViewZones()}_getOriginalEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators){const overviewZoneColor=String(this._removeColor),result={decorations:[],overviewZones:[]},originalEditor=this._dataSource.getOriginalEditor(),originalModel=originalEditor.getModel(),originalViewModel=originalEditor._getViewModel();let zoneIndex=0;for(const lineChange of lineChanges)if(isChangeOrDelete(lineChange)){for(result.decorations.push({range:new range_1.Range(lineChange.originalStartLineNumber,1,lineChange.originalEndLineNumber,1073741824),options:DECORATIONS.lineDeleteMargin});zoneIndex<zones.modified.length;){const zone=zones.modified[zoneIndex];if(zone.diff&&zone.diff.originalStartLineNumber>=lineChange.originalStartLineNumber)break;zoneIndex++}let zoneHeightInLines=0;if(zoneIndex<zones.modified.length){const zone=zones.modified[zoneIndex];zone.diff&&zone.diff.originalStartLineNumber===lineChange.originalStartLineNumber&&zone.diff.originalEndLineNumber===lineChange.originalEndLineNumber&&zone.diff.modifiedStartLineNumber===lineChange.modifiedStartLineNumber&&zone.diff.modifiedEndLineNumber===lineChange.modifiedEndLineNumber&&(zoneHeightInLines=zone.heightInLines)}const viewRange=getViewRange(originalModel,originalViewModel,lineChange.originalStartLineNumber,lineChange.originalEndLineNumber);result.overviewZones.push(new overviewZoneManager_1.OverviewRulerZone(viewRange.startLineNumber,viewRange.endLineNumber,zoneHeightInLines,overviewZoneColor))}return result}_getModifiedEditorDecorations(zones,lineChanges,ignoreTrimWhitespace,renderIndicators){const modifiedEditor=this._dataSource.getModifiedEditor(),overviewZoneColor=String(this._insertColor),result={decorations:[],overviewZones:[]},modifiedModel=modifiedEditor.getModel(),modifiedViewModel=modifiedEditor._getViewModel();for(const lineChange of lineChanges)if(isChangeOrInsert(lineChange)){result.decorations.push({range:new range_1.Range(lineChange.modifiedStartLineNumber,1,lineChange.modifiedEndLineNumber,1073741824),options:renderIndicators?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert});const viewRange=getViewRange(modifiedModel,modifiedViewModel,lineChange.modifiedStartLineNumber,lineChange.modifiedEndLineNumber);if(result.overviewZones.push(new overviewZoneManager_1.OverviewRulerZone(viewRange.startLineNumber,viewRange.endLineNumber,0,overviewZoneColor)),lineChange.charChanges){for(const charChange of lineChange.charChanges)if(isChangeOrInsert(charChange))if(ignoreTrimWhitespace)for(let lineNumber=charChange.modifiedStartLineNumber;lineNumber<=charChange.modifiedEndLineNumber;lineNumber++){let startColumn,endColumn;startColumn=lineNumber===charChange.modifiedStartLineNumber?charChange.modifiedStartColumn:modifiedModel.getLineFirstNonWhitespaceColumn(lineNumber),endColumn=lineNumber===charChange.modifiedEndLineNumber?charChange.modifiedEndColumn:modifiedModel.getLineLastNonWhitespaceColumn(lineNumber),result.decorations.push(createDecoration(lineNumber,startColumn,lineNumber,endColumn,DECORATIONS.charInsert))}else result.decorations.push(createDecoration(charChange.modifiedStartLineNumber,charChange.modifiedStartColumn,charChange.modifiedEndLineNumber,charChange.modifiedEndColumn,DECORATIONS.charInsert))}else result.decorations.push(createDecoration(lineChange.modifiedStartLineNumber,1,lineChange.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine))}return result}layout(){return Math.max(5,this._decorationsLeft)}}class InlineViewZonesComputer extends ViewZonesComputer{constructor(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor,renderIndicators){super(lineChanges,originalForeignVZ,modifiedForeignVZ,originalEditor,modifiedEditor),this._originalModel=originalEditor.getModel(),this._renderIndicators=renderIndicators,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const result=super.getViewZones();return this._finalize(result),result}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const result=document.createElement("div");return result.className="inline-added-margin-view-zone",result}_produceOriginalFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength){const marginDomNode=document.createElement("div");return marginDomNode.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(lineChange.originalStartLineNumber,lineChange.originalEndLineNumber),heightInLines:lineChangeModifiedLength,domNode:document.createElement("div"),marginDomNode}}_produceModifiedFromDiff(lineChange,lineChangeOriginalLength,lineChangeModifiedLength){const domNode=document.createElement("div");domNode.className=`view-lines line-delete ${mouseCursor_1.MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`;const marginDomNode=document.createElement("div");marginDomNode.className="inline-deleted-margin-view-zone";const viewZone={shouldNotShrink:!0,afterLineNumber:0===lineChange.modifiedEndLineNumber?lineChange.modifiedStartLineNumber:lineChange.modifiedStartLineNumber-1,heightInLines:lineChangeOriginalLength,minWidthInPx:0,domNode,marginDomNode,diff:{originalStartLineNumber:lineChange.originalStartLineNumber,originalEndLineNumber:lineChange.originalEndLineNumber,modifiedStartLineNumber:lineChange.modifiedStartLineNumber,modifiedEndLineNumber:lineChange.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let lineNumber=lineChange.originalStartLineNumber;lineNumber<=lineChange.originalEndLineNumber;lineNumber++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(lineNumber),null,null);return this._pendingLineChange.push(lineChange),this._pendingViewZones.push(viewZone),viewZone}_finalize(result){const modifiedEditorOptions=this._modifiedEditor.getOptions(),tabSize=this._modifiedEditor.getModel().getOptions().tabSize,fontInfo=modifiedEditorOptions.get(44),disableMonospaceOptimizations=modifiedEditorOptions.get(29),typicalHalfwidthCharacterWidth=fontInfo.typicalHalfwidthCharacterWidth,scrollBeyondLastColumn=modifiedEditorOptions.get(93),mightContainNonBasicASCII=this._originalModel.mightContainNonBasicASCII(),mightContainRTL=this._originalModel.mightContainRTL(),lineHeight=modifiedEditorOptions.get(59),lineDecorationsWidth=modifiedEditorOptions.get(131).decorationsWidth,stopRenderingLineAfter=modifiedEditorOptions.get(105),renderWhitespace=modifiedEditorOptions.get(88),renderControlCharacters=modifiedEditorOptions.get(83),fontLigatures=modifiedEditorOptions.get(45),lineBreaks=this._lineBreaksComputer.finalize();let lineBreakIndex=0;for(let i=0;i<this._pendingLineChange.length;i++){const lineChange=this._pendingLineChange[i],viewZone=this._pendingViewZones[i],domNode=viewZone.domNode;(0,domFontInfo_1.applyFontInfo)(domNode,fontInfo);const marginDomNode=viewZone.marginDomNode;(0,domFontInfo_1.applyFontInfo)(marginDomNode,fontInfo);const decorations=[];if(lineChange.charChanges)for(const charChange of lineChange.charChanges)isChangeOrDelete(charChange)&&decorations.push(new viewModel_1.InlineDecoration(new range_1.Range(charChange.originalStartLineNumber,charChange.originalStartColumn,charChange.originalEndLineNumber,charChange.originalEndColumn),"char-delete",0));const hasCharChanges=decorations.length>0,sb=(0,stringBuilder_1.createStringBuilder)(1e4);let maxCharsPerLine=0,renderedLineCount=0,viewLineCounts=null;for(let lineNumber=lineChange.originalStartLineNumber;lineNumber<=lineChange.originalEndLineNumber;lineNumber++){const lineIndex=lineNumber-lineChange.originalStartLineNumber,lineTokens=this._originalModel.getLineTokens(lineNumber),lineContent=lineTokens.getLineContent(),lineBreakData=lineBreaks[lineBreakIndex++],actualDecorations=lineDecorations_1.LineDecoration.filter(decorations,lineNumber,1,lineContent.length+1);if(lineBreakData){let lastBreakOffset=0;for(const breakOffset of lineBreakData.breakOffsets){const viewLineTokens=lineTokens.sliceAndInflate(lastBreakOffset,breakOffset,0),viewLineContent=lineContent.substring(lastBreakOffset,breakOffset);maxCharsPerLine=Math.max(maxCharsPerLine,this._renderOriginalLine(renderedLineCount++,viewLineContent,viewLineTokens,lineDecorations_1.LineDecoration.extractWrapped(actualDecorations,lastBreakOffset,breakOffset),hasCharChanges,mightContainNonBasicASCII,mightContainRTL,fontInfo,disableMonospaceOptimizations,lineHeight,lineDecorationsWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures,tabSize,sb,marginDomNode)),lastBreakOffset=breakOffset}for(viewLineCounts||(viewLineCounts=[]);viewLineCounts.length<lineIndex;)viewLineCounts[viewLineCounts.length]=1;viewLineCounts[lineIndex]=lineBreakData.breakOffsets.length,viewZone.heightInLines+=lineBreakData.breakOffsets.length-1;const marginDomNode2=document.createElement("div");marginDomNode2.className="gutter-delete",result.original.push({afterLineNumber:lineNumber,afterColumn:0,heightInLines:lineBreakData.breakOffsets.length-1,domNode:createFakeLinesDiv(),marginDomNode:marginDomNode2})}else maxCharsPerLine=Math.max(maxCharsPerLine,this._renderOriginalLine(renderedLineCount++,lineContent,lineTokens,actualDecorations,hasCharChanges,mightContainNonBasicASCII,mightContainRTL,fontInfo,disableMonospaceOptimizations,lineHeight,lineDecorationsWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures,tabSize,sb,marginDomNode))}maxCharsPerLine+=scrollBeyondLastColumn;const html=sb.build(),trustedhtml=ttPolicy?ttPolicy.createHTML(html):html;if(domNode.innerHTML=trustedhtml,viewZone.minWidthInPx=maxCharsPerLine*typicalHalfwidthCharacterWidth,viewLineCounts){const cnt=lineChange.originalEndLineNumber-lineChange.originalStartLineNumber;for(;viewLineCounts.length<=cnt;)viewLineCounts[viewLineCounts.length]=1}viewZone.diff.viewLineCounts=viewLineCounts}result.original.sort(((a,b)=>a.afterLineNumber-b.afterLineNumber))}_renderOriginalLine(renderedLineCount,lineContent,lineTokens,decorations,hasCharChanges,mightContainNonBasicASCII,mightContainRTL,fontInfo,disableMonospaceOptimizations,lineHeight,lineDecorationsWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures,tabSize,sb,marginDomNode){sb.appendASCIIString('<div class="view-line'),hasCharChanges||sb.appendASCIIString(" char-delete"),sb.appendASCIIString('" style="top:'),sb.appendASCIIString(String(renderedLineCount*lineHeight)),sb.appendASCIIString('px;width:1000000px;">');const isBasicASCII=viewModel_1.ViewLineRenderingData.isBasicASCII(lineContent,mightContainNonBasicASCII),containsRTL=viewModel_1.ViewLineRenderingData.containsRTL(lineContent,isBasicASCII,mightContainRTL),output=(0,viewLineRenderer_1.renderViewLine)(new viewLineRenderer_1.RenderLineInput(fontInfo.isMonospace&&!disableMonospaceOptimizations,fontInfo.canUseHalfwidthRightwardsArrow,lineContent,!1,isBasicASCII,containsRTL,0,lineTokens,decorations,tabSize,0,fontInfo.spaceWidth,fontInfo.middotWidth,fontInfo.wsmiddotWidth,stopRenderingLineAfter,renderWhitespace,renderControlCharacters,fontLigatures!==editorOptions_1.EditorFontLigatures.OFF,null),sb);if(sb.appendASCIIString("</div>"),this._renderIndicators){const marginElement=document.createElement("div");marginElement.className=`delete-sign ${themeService_1.ThemeIcon.asClassName(diffRemoveIcon)}`,marginElement.setAttribute("style",`position:absolute;top:${renderedLineCount*lineHeight}px;width:${lineDecorationsWidth}px;height:${lineHeight}px;right:0;`),marginDomNode.appendChild(marginElement)}return output.characterMapping.getAbsoluteOffset(output.characterMapping.length)}}function isChangeOrInsert(lineChange){return lineChange.modifiedEndLineNumber>0}function isChangeOrDelete(lineChange){return lineChange.originalEndLineNumber>0}function createFakeLinesDiv(){const r=document.createElement("div");return r.className="diagonal-fill",r}function getViewRange(model,viewModel,startLineNumber,endLineNumber){const lineCount=model.getLineCount();return startLineNumber=Math.min(lineCount,Math.max(1,startLineNumber)),endLineNumber=Math.min(lineCount,Math.max(1,endLineNumber)),viewModel.coordinatesConverter.convertModelRangeToViewRange(new range_1.Range(startLineNumber,model.getLineMinColumn(startLineNumber),endLineNumber,model.getLineMaxColumn(endLineNumber)))}function validateDiffEditorOptions(options,defaults){return{enableSplitViewResizing:(0,editorOptions_1.boolean)(options.enableSplitViewResizing,defaults.enableSplitViewResizing),renderSideBySide:(0,editorOptions_1.boolean)(options.renderSideBySide,defaults.renderSideBySide),maxComputationTime:(0,editorOptions_1.clampedInt)(options.maxComputationTime,defaults.maxComputationTime,0,1073741824),maxFileSize:(0,editorOptions_1.clampedInt)(options.maxFileSize,defaults.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,editorOptions_1.boolean)(options.ignoreTrimWhitespace,defaults.ignoreTrimWhitespace),renderIndicators:(0,editorOptions_1.boolean)(options.renderIndicators,defaults.renderIndicators),originalEditable:(0,editorOptions_1.boolean)(options.originalEditable,defaults.originalEditable),diffCodeLens:(0,editorOptions_1.boolean)(options.diffCodeLens,defaults.diffCodeLens),renderOverviewRuler:(0,editorOptions_1.boolean)(options.renderOverviewRuler,defaults.renderOverviewRuler),diffWordWrap:(value=options.diffWordWrap,defaultValue=defaults.diffWordWrap,(0,editorOptions_1.stringSet)(value,defaultValue,["off","on","inherit"]))};var value,defaultValue}(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const added=theme.getColor(colorRegistry_1.diffInserted);added&&collector.addRule(`.monaco-editor .char-insert, .monaco-diff-editor .char-insert { background-color: ${added}; }`);const lineAdded=theme.getColor(colorRegistry_1.diffInsertedLine)||added;lineAdded&&collector.addRule(`.monaco-editor .line-insert, .monaco-diff-editor .line-insert { background-color: ${lineAdded}; }`);const gutterAdded=theme.getColor(colorRegistry_1.diffInsertedLineGutter)||lineAdded;gutterAdded&&(collector.addRule(`.monaco-editor .inline-added-margin-view-zone { background-color: ${gutterAdded}; }`),collector.addRule(`.monaco-editor .gutter-insert, .monaco-diff-editor .gutter-insert { background-color: ${gutterAdded}; }`));const removed=theme.getColor(colorRegistry_1.diffRemoved);removed&&collector.addRule(`.monaco-editor .char-delete, .monaco-diff-editor .char-delete { background-color: ${removed}; }`);const lineRemoved=theme.getColor(colorRegistry_1.diffRemovedLine)||removed;lineRemoved&&collector.addRule(`.monaco-editor .line-delete, .monaco-diff-editor .line-delete { background-color: ${lineRemoved}; }`);const gutterRemoved=theme.getColor(colorRegistry_1.diffRemovedLineGutter)||lineRemoved;gutterRemoved&&(collector.addRule(`.monaco-editor .inline-deleted-margin-view-zone { background-color: ${gutterRemoved}; }`),collector.addRule(`.monaco-editor .gutter-delete, .monaco-diff-editor .gutter-delete { background-color: ${gutterRemoved}; }`));const addedOutline=theme.getColor(colorRegistry_1.diffInsertedOutline);addedOutline&&collector.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px ${"hc"===theme.type?"dashed":"solid"} ${addedOutline}; }`);const removedOutline=theme.getColor(colorRegistry_1.diffRemovedOutline);removedOutline&&collector.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px ${"hc"===theme.type?"dashed":"solid"} ${removedOutline}; }`);const shadow=theme.getColor(colorRegistry_1.scrollbarShadow);shadow&&collector.addRule(`.monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px ${shadow}; }`);const border=theme.getColor(colorRegistry_1.diffBorder);border&&collector.addRule(`.monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid ${border}; }`);const scrollbarSliderBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderBackground);scrollbarSliderBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport {\n\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t}\n\t\t`);const scrollbarSliderHoverBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderHoverBackground);scrollbarSliderHoverBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:hover {\n\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t}\n\t\t`);const scrollbarSliderActiveBackgroundColor=theme.getColor(colorRegistry_1.scrollbarSliderActiveBackground);scrollbarSliderActiveBackgroundColor&&collector.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:active {\n\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t}\n\t\t`);const diffDiagonalFillColor=theme.getColor(colorRegistry_1.diffDiagonalFill);collector.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${diffDiagonalFillColor} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${diffDiagonalFillColor} 50%, ${diffDiagonalFillColor} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}))})),define(__m[164],__M([1,0,40,29,163,26,17,9,39,14,65,33,20]),(function(require,exports,objects,codeEditorService_1,codeEditorWidget_1,commands_1,contextkey_1,instantiation_1,notification_1,themeService_1,accessibility_1,languageConfigurationRegistry_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmbeddedCodeEditorWidget=void 0;let EmbeddedCodeEditorWidget=class EmbeddedCodeEditorWidget extends codeEditorWidget_1.CodeEditorWidget{constructor(domElement,options,parentEditor,instantiationService,codeEditorService,commandService,contextKeyService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService){super(domElement,Object.assign(Object.assign({},parentEditor.getRawOptions()),{overflowWidgetsDomNode:parentEditor.getOverflowWidgetsDomNode()}),{},instantiationService,codeEditorService,commandService,contextKeyService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService),this._parentEditor=parentEditor,this._overwriteOptions=options,super.updateOptions(this._overwriteOptions),this._register(parentEditor.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(newOptions){objects.mixin(this._overwriteOptions,newOptions,!0),super.updateOptions(this._overwriteOptions)}};EmbeddedCodeEditorWidget=__decorate([__param(3,instantiation_1.IInstantiationService),__param(4,codeEditorService_1.ICodeEditorService),__param(5,commands_1.ICommandService),__param(6,contextkey_1.IContextKeyService),__param(7,themeService_1.IThemeService),__param(8,notification_1.INotificationService),__param(9,accessibility_1.IAccessibilityService),__param(10,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(11,languageFeatures_1.ILanguageFeaturesService)],EmbeddedCodeEditorWidget),exports.EmbeddedCodeEditorWidget=EmbeddedCodeEditorWidget})),define(__m[717],__M([1,0,10,2,15,11,3,22,24,50,38,54,524,37,23,14,372]),(function(require,exports,async_1,lifecycle_1,editorExtensions_1,position_1,range_1,selection_1,editorContextKeys_1,model_1,textModel_1,editorColorRegistry_1,nls,actions_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracketMatchingController=void 0;const overviewRulerBracketMatchForeground=(0,colorRegistry_1.registerColor)("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},nls.localize(0,null));class JumpToBracketAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.jumpToBracket",label:nls.localize(1,null),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3160,weight:100}})}run(accessor,editor){var _a;null===(_a=BracketMatchingController.get(editor))||void 0===_a||_a.jumpToBracket()}}class SelectToBracketAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.selectToBracket",label:nls.localize(2,null),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(accessor,editor,args){var _a;let selectBrackets=!0;args&&!1===args.selectBrackets&&(selectBrackets=!1),null===(_a=BracketMatchingController.get(editor))||void 0===_a||_a.selectToBracket(selectBrackets)}}class BracketsData{constructor(position,brackets,options){this.position=position,this.brackets=brackets,this.options=options}}class BracketMatchingController extends lifecycle_1.Disposable{constructor(editor){super(),this._editor=editor,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new async_1.RunOnceScheduler((()=>this._updateBrackets()),50)),this._matchBrackets=this._editor.getOption(64),this._updateBracketsSoon.schedule(),this._register(editor.onDidChangeCursorPosition((e=>{"never"!==this._matchBrackets&&this._updateBracketsSoon.schedule()}))),this._register(editor.onDidChangeModelContent((e=>{this._updateBracketsSoon.schedule()}))),this._register(editor.onDidChangeModel((e=>{this._lastBracketsData=[],this._decorations=[],this._updateBracketsSoon.schedule()}))),this._register(editor.onDidChangeModelLanguageConfiguration((e=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()}))),this._register(editor.onDidChangeConfiguration((e=>{e.hasChanged(64)&&(this._matchBrackets=this._editor.getOption(64),this._decorations=this._editor.deltaDecorations(this._decorations,[]),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())}))),this._register(editor.onDidBlurEditorWidget((()=>{this._updateBracketsSoon.schedule()}))),this._register(editor.onDidFocusEditorWidget((()=>{this._updateBracketsSoon.schedule()})))}static get(editor){return editor.getContribution(BracketMatchingController.ID)}jumpToBracket(){if(!this._editor.hasModel())return;const model=this._editor.getModel(),newSelections=this._editor.getSelections().map((selection=>{const position=selection.getStartPosition(),brackets=model.bracketPairs.matchBracket(position);let newCursorPosition=null;if(brackets)brackets[0].containsPosition(position)?newCursorPosition=brackets[1].getStartPosition():brackets[1].containsPosition(position)&&(newCursorPosition=brackets[0].getStartPosition());else{const enclosingBrackets=model.bracketPairs.findEnclosingBrackets(position);if(enclosingBrackets)newCursorPosition=enclosingBrackets[0].getStartPosition();else{const nextBracket=model.bracketPairs.findNextBracket(position);nextBracket&&nextBracket.range&&(newCursorPosition=nextBracket.range.getStartPosition())}}return newCursorPosition?new selection_1.Selection(newCursorPosition.lineNumber,newCursorPosition.column,newCursorPosition.lineNumber,newCursorPosition.column):new selection_1.Selection(position.lineNumber,position.column,position.lineNumber,position.column)}));this._editor.setSelections(newSelections),this._editor.revealRange(newSelections[0])}selectToBracket(selectBrackets){if(!this._editor.hasModel())return;const model=this._editor.getModel(),newSelections=[];this._editor.getSelections().forEach((selection=>{const position=selection.getStartPosition();let brackets=model.bracketPairs.matchBracket(position);if(!brackets&&(brackets=model.bracketPairs.findEnclosingBrackets(position),!brackets)){const nextBracket=model.bracketPairs.findNextBracket(position);nextBracket&&nextBracket.range&&(brackets=model.bracketPairs.matchBracket(nextBracket.range.getStartPosition()))}let selectFrom=null,selectTo=null;if(brackets){brackets.sort(range_1.Range.compareRangesUsingStarts);const[open,close]=brackets;if(selectFrom=selectBrackets?open.getStartPosition():open.getEndPosition(),selectTo=selectBrackets?close.getEndPosition():close.getStartPosition(),close.containsPosition(position)){const tmp=selectFrom;selectFrom=selectTo,selectTo=tmp}}selectFrom&&selectTo&&newSelections.push(new selection_1.Selection(selectFrom.lineNumber,selectFrom.column,selectTo.lineNumber,selectTo.column))})),newSelections.length>0&&(this._editor.setSelections(newSelections),this._editor.revealRange(newSelections[0]))}_updateBrackets(){if("never"===this._matchBrackets)return;this._recomputeBrackets();let newDecorations=[],newDecorationsLen=0;for(const bracketData of this._lastBracketsData){let brackets=bracketData.brackets;brackets&&(newDecorations[newDecorationsLen++]={range:brackets[0],options:bracketData.options},newDecorations[newDecorationsLen++]={range:brackets[1],options:bracketData.options})}this._decorations=this._editor.deltaDecorations(this._decorations,newDecorations)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus())return this._lastBracketsData=[],void(this._lastVersionId=0);const selections=this._editor.getSelections();if(selections.length>100)return this._lastBracketsData=[],void(this._lastVersionId=0);const model=this._editor.getModel(),versionId=model.getVersionId();let previousData=[];this._lastVersionId===versionId&&(previousData=this._lastBracketsData);let positions=[],positionsLen=0;for(let i=0,len=selections.length;i<len;i++){let selection=selections[i];selection.isEmpty()&&(positions[positionsLen++]=selection.getStartPosition())}positions.length>1&&positions.sort(position_1.Position.compare);let newData=[],newDataLen=0,previousIndex=0,previousLen=previousData.length;for(let i=0,len=positions.length;i<len;i++){let position=positions[i];for(;previousIndex<previousLen&&previousData[previousIndex].position.isBefore(position);)previousIndex++;if(previousIndex<previousLen&&previousData[previousIndex].position.equals(position))newData[newDataLen++]=previousData[previousIndex];else{let brackets=model.bracketPairs.matchBracket(position,20),options=BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;brackets||"always"!==this._matchBrackets||(brackets=model.bracketPairs.findEnclosingBrackets(position,20),options=BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),newData[newDataLen++]=new BracketsData(position,brackets,options)}}this._lastBracketsData=newData,this._lastVersionId=versionId}}exports.BracketMatchingController=BracketMatchingController,BracketMatchingController.ID="editor.contrib.bracketMatchingController",BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=textModel_1.ModelDecorationOptions.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:(0,themeService_1.themeColorFromId)(overviewRulerBracketMatchForeground),position:model_1.OverviewRulerLane.Center}}),BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=textModel_1.ModelDecorationOptions.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"}),(0,editorExtensions_1.registerEditorContribution)(BracketMatchingController.ID,BracketMatchingController),(0,editorExtensions_1.registerEditorAction)(SelectToBracketAction),(0,editorExtensions_1.registerEditorAction)(JumpToBracketAction),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const bracketMatchBackground=theme.getColor(editorColorRegistry_1.editorBracketMatchBackground);bracketMatchBackground&&collector.addRule(`.monaco-editor .bracket-match { background-color: ${bracketMatchBackground}; }`);const bracketMatchBorder=theme.getColor(editorColorRegistry_1.editorBracketMatchBorder);bracketMatchBorder&&collector.addRule(`.monaco-editor .bracket-match { border: 1px solid ${bracketMatchBorder}; }`)})),actions_1.MenuRegistry.appendMenuItem(actions_1.MenuId.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:nls.localize(3,null)},order:2})})),define(__m[718],__M([1,0,7,115,3,38,374]),(function(require,exports,dom,iconLabels_1,range_1,textModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeLensWidget=exports.CodeLensHelper=void 0;class CodeLensViewZone{constructor(afterLineNumber,heightInPx,onHeight){this.afterColumn=1073741824,this.afterLineNumber=afterLineNumber,this.heightInPx=heightInPx,this._onHeight=onHeight,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(height){void 0===this._lastHeight?this._lastHeight=height:this._lastHeight!==height&&(this._lastHeight=height,this._onHeight())}isVisible(){return 0!==this._lastHeight&&this.domNode.hasAttribute("monaco-visible-view-zone")}}class CodeLensContentWidget{constructor(editor,className,line){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=editor,this._id="codelens.widget-"+CodeLensContentWidget._idPool++,this.updatePosition(line),this._domNode=document.createElement("span"),this._domNode.className=`codelens-decoration ${className}`}withCommands(lenses,animate){this._commands.clear();let children=[],hasSymbol=!1;for(let i=0;i<lenses.length;i++){const lens=lenses[i];if(lens&&(hasSymbol=!0,lens.command)){const title=(0,iconLabels_1.renderLabelWithIcons)(lens.command.title.trim());lens.command.id?(children.push(dom.$("a",{id:String(i),title:lens.command.tooltip},...title)),this._commands.set(String(i),lens.command)):children.push(dom.$("span",{title:lens.command.tooltip},...title)),i+1<lenses.length&&children.push(dom.$("span",void 0," | "))}}hasSymbol?(dom.reset(this._domNode,...children),this._isEmpty&&animate&&this._domNode.classList.add("fadein"),this._isEmpty=!1):dom.reset(this._domNode,dom.$("span",void 0,"no commands"))}getCommand(link){return link.parentElement===this._domNode?this._commands.get(link.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(line){const column=this._editor.getModel().getLineFirstNonWhitespaceColumn(line);this._widgetPosition={position:{lineNumber:line,column},preference:[1]}}getPosition(){return this._widgetPosition||null}}CodeLensContentWidget._idPool=0;exports.CodeLensHelper=class CodeLensHelper{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(decoration,callback){this._addDecorations.push(decoration),this._addDecorationsCallbacks.push(callback)}removeDecoration(decorationId){this._removeDecorations.push(decorationId)}commit(changeAccessor){let resultingDecorations=changeAccessor.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,len=resultingDecorations.length;i<len;i++)this._addDecorationsCallbacks[i](resultingDecorations[i])}};exports.CodeLensWidget=class CodeLensWidget{constructor(data,editor,className,helper,viewZoneChangeAccessor,heightInPx,updateCallback){let range;this._isDisposed=!1,this._editor=editor,this._className=className,this._data=data,this._decorationIds=[];let lenses=[];this._data.forEach(((codeLensData,i)=>{codeLensData.symbol.command&&lenses.push(codeLensData.symbol),helper.addDecoration({range:codeLensData.symbol.range,options:textModel_1.ModelDecorationOptions.EMPTY},(id=>this._decorationIds[i]=id)),range=range?range_1.Range.plusRange(range,codeLensData.symbol.range):range_1.Range.lift(codeLensData.symbol.range)})),this._viewZone=new CodeLensViewZone(range.startLineNumber-1,heightInPx,updateCallback),this._viewZoneId=viewZoneChangeAccessor.addZone(this._viewZone),lenses.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(lenses,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new CodeLensContentWidget(this._editor,this._className,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(helper,viewZoneChangeAccessor){this._decorationIds.forEach(helper.removeDecoration,helper),this._decorationIds=[],viewZoneChangeAccessor&&viewZoneChangeAccessor.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some(((id,i)=>{const range=this._editor.getModel().getDecorationRange(id),symbol=this._data[i].symbol;return!(!range||range_1.Range.isEmpty(symbol.range)!==range.isEmpty())}))}updateCodeLensSymbols(data,helper){this._decorationIds.forEach(helper.removeDecoration,helper),this._decorationIds=[],this._data=data,this._data.forEach(((codeLensData,i)=>{helper.addDecoration({range:codeLensData.symbol.range,options:textModel_1.ModelDecorationOptions.EMPTY},(id=>this._decorationIds[i]=id))}))}updateHeight(height,viewZoneChangeAccessor){this._viewZone.heightInPx=height,viewZoneChangeAccessor.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(model){if(!this._viewZone.isVisible())return null;for(let i=0;i<this._decorationIds.length;i++){const range=model.getDecorationRange(this._decorationIds[i]);range&&(this._data[i].symbol.range=range)}return this._data}updateCommands(symbols){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(symbols,!0);for(let i=0;i<this._data.length;i++){const resolved=symbols[i];if(resolved){const{symbol}=this._data[i];symbol.command=resolved.command||symbol.command}}}getCommand(link){var _a;return null===(_a=this._contentWidget)||void 0===_a?void 0:_a.getCommand(link)}getLineNumber(){const range=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return range?range.startLineNumber:-1}update(viewZoneChangeAccessor){if(this.isValid()){const range=this._editor.getModel().getDecorationRange(this._decorationIds[0]);range&&(this._viewZone.afterLineNumber=range.startLineNumber-1,viewZoneChangeAccessor.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(range.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}})),define(__m[719],__M([1,0,7,10,13,114,2,146,15,32,24,275,639,718,530,26,39,80,67,20]),(function(require,exports,dom,async_1,errors_1,hash_1,lifecycle_1,stableEditorScroll_1,editorExtensions_1,editorOptions_1,editorContextKeys_1,codelens_1,codeLensCache_1,codelensWidget_1,nls_1,commands_1,notification_1,quickInput_1,languageFeatureDebounce_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeLensContribution=void 0;let CodeLensContribution=class CodeLensContribution{constructor(_editor,_languageFeaturesService,debounceService,_commandService,_notificationService,_codeLensCache){this._editor=_editor,this._languageFeaturesService=_languageFeaturesService,this._commandService=_commandService,this._notificationService=_notificationService,this._codeLensCache=_codeLensCache,this._disposables=new lifecycle_1.DisposableStore,this._localToDispose=new lifecycle_1.DisposableStore,this._lenses=[],this._oldCodeLensModels=new lifecycle_1.DisposableStore,this._provideCodeLensDebounce=debounceService.for(_languageFeaturesService.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=debounceService.for(_languageFeaturesService.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new async_1.RunOnceScheduler((()=>this._resolveCodeLensesInViewport()),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(44)||e.hasChanged(16)||e.hasChanged(15))&&this._updateLensStyle(),e.hasChanged(14)&&this._onModelChange()}))),this._disposables.add(_languageFeaturesService.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._styleClassName="_"+(0,hash_1.hash)(this._editor.getId()).toString(16),this._styleElement=dom.createStyleSheet(dom.isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0),this._updateLensStyle()}dispose(){var _a;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),null===(_a=this._currentCodeLensModel)||void 0===_a||_a.dispose(),this._styleElement.remove()}_getLayoutInfo(){let codeLensHeight,fontSize=this._editor.getOption(16);return!fontSize||fontSize<5?(fontSize=.9*this._editor.getOption(46)|0,codeLensHeight=this._editor.getOption(59)):codeLensHeight=fontSize*Math.max(1.3,this._editor.getOption(59)/this._editor.getOption(46))|0,{codeLensHeight,fontSize}}_updateLensStyle(){const{codeLensHeight,fontSize}=this._getLayoutInfo(),fontFamily=this._editor.getOption(15),editorFontInfo=this._editor.getOption(44),fontFamilyVar=`--codelens-font-family${this._styleClassName}`,fontFeaturesVar=`--codelens-font-features${this._styleClassName}`;let newStyle=`\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; padding-right: ${Math.round(.5*fontSize)}px; font-feature-settings: var(${fontFeaturesVar}) }\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; }\n\t\t`;fontFamily&&(newStyle+=`.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${fontFamilyVar}), ${editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily}}`),this._styleElement.textContent=newStyle,this._editor.getContainerDomNode().style.setProperty(fontFamilyVar,null!=fontFamily?fontFamily:"inherit"),this._editor.getContainerDomNode().style.setProperty(fontFeaturesVar,editorFontInfo.fontFeatureSettings),this._editor.changeViewZones((accessor=>{for(let lens of this._lenses)lens.updateHeight(codeLensHeight,accessor)}))}_localDispose(){var _a,_b,_c;null===(_a=this._getCodeLensModelPromise)||void 0===_a||_a.cancel(),this._getCodeLensModelPromise=void 0,null===(_b=this._resolveCodeLensesPromise)||void 0===_b||_b.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),null===(_c=this._currentCodeLensModel)||void 0===_c||_c.dispose()}_onModelChange(){this._localDispose();const model=this._editor.getModel();if(!model)return;if(!this._editor.getOption(14))return;const cachedLenses=this._codeLensCache.get(model);if(cachedLenses&&this._renderCodeLensSymbols(cachedLenses),!this._languageFeaturesService.codeLensProvider.has(model))return void(cachedLenses&&this._localToDispose.add((0,async_1.disposableTimeout)((()=>{const cachedLensesNow=this._codeLensCache.get(model);cachedLenses===cachedLensesNow&&(this._codeLensCache.delete(model),this._onModelChange())}),3e4)));for(const provider of this._languageFeaturesService.codeLensProvider.all(model))if("function"==typeof provider.onDidChange){let registration=provider.onDidChange((()=>scheduler.schedule()));this._localToDispose.add(registration)}const scheduler=new async_1.RunOnceScheduler((()=>{var _a;const t1=Date.now();null===(_a=this._getCodeLensModelPromise)||void 0===_a||_a.cancel(),this._getCodeLensModelPromise=(0,async_1.createCancelablePromise)((token=>(0,codelens_1.getCodeLensModel)(this._languageFeaturesService.codeLensProvider,model,token))),this._getCodeLensModelPromise.then((result=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=result,this._codeLensCache.put(model,result);const newDelay=this._provideCodeLensDebounce.update(model,Date.now()-t1);scheduler.delay=newDelay,this._renderCodeLensSymbols(result),this._resolveCodeLensesInViewportSoon()}),errors_1.onUnexpectedError)}),this._provideCodeLensDebounce.get(model));this._localToDispose.add(scheduler),this._localToDispose.add((0,lifecycle_1.toDisposable)((()=>this._resolveCodeLensesScheduler.cancel()))),this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._editor.changeDecorations((decorationsAccessor=>{this._editor.changeViewZones((viewZonesAccessor=>{let toDispose=[],lastLensLineNumber=-1;this._lenses.forEach((lens=>{lens.isValid()&&lastLensLineNumber!==lens.getLineNumber()?(lens.update(viewZonesAccessor),lastLensLineNumber=lens.getLineNumber()):toDispose.push(lens)}));let helper=new codelensWidget_1.CodeLensHelper;toDispose.forEach((l=>{l.dispose(helper,viewZonesAccessor),this._lenses.splice(this._lenses.indexOf(l),1)})),helper.commit(decorationsAccessor)}))})),scheduler.schedule()}))),this._localToDispose.add(this._editor.onDidFocusEditorWidget((()=>{scheduler.schedule()}))),this._localToDispose.add(this._editor.onDidScrollChange((e=>{e.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(this._editor.onDidLayoutChange((()=>{this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add((0,lifecycle_1.toDisposable)((()=>{if(this._editor.getModel()){const scrollState=stableEditorScroll_1.StableEditorScrollState.capture(this._editor);this._editor.changeDecorations((decorationsAccessor=>{this._editor.changeViewZones((viewZonesAccessor=>{this._disposeAllLenses(decorationsAccessor,viewZonesAccessor)}))})),scrollState.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)}))),this._localToDispose.add(this._editor.onMouseDown((e=>{if(9!==e.target.type)return;let target=e.target.element;if("SPAN"===(null==target?void 0:target.tagName)&&(target=target.parentElement),"A"===(null==target?void 0:target.tagName))for(const lens of this._lenses){let command=lens.getCommand(target);if(command){this._commandService.executeCommand(command.id,...command.arguments||[]).catch((err=>this._notificationService.error(err)));break}}}))),scheduler.schedule()}_disposeAllLenses(decChangeAccessor,viewZoneChangeAccessor){const helper=new codelensWidget_1.CodeLensHelper;for(const lens of this._lenses)lens.dispose(helper,viewZoneChangeAccessor);decChangeAccessor&&helper.commit(decChangeAccessor),this._lenses.length=0}_renderCodeLensSymbols(symbols){if(!this._editor.hasModel())return;let lastGroup,maxLineNumber=this._editor.getModel().getLineCount(),groups=[];for(let symbol of symbols.lenses){let line=symbol.symbol.range.startLineNumber;line<1||line>maxLineNumber||(lastGroup&&lastGroup[lastGroup.length-1].symbol.range.startLineNumber===line?lastGroup.push(symbol):(lastGroup=[symbol],groups.push(lastGroup)))}const scrollState=stableEditorScroll_1.StableEditorScrollState.capture(this._editor),layoutInfo=this._getLayoutInfo();this._editor.changeDecorations((decorationsAccessor=>{this._editor.changeViewZones((viewZoneAccessor=>{const helper=new codelensWidget_1.CodeLensHelper;let codeLensIndex=0,groupsIndex=0;for(;groupsIndex<groups.length&&codeLensIndex<this._lenses.length;){let symbolsLineNumber=groups[groupsIndex][0].symbol.range.startLineNumber,codeLensLineNumber=this._lenses[codeLensIndex].getLineNumber();codeLensLineNumber<symbolsLineNumber?(this._lenses[codeLensIndex].dispose(helper,viewZoneAccessor),this._lenses.splice(codeLensIndex,1)):codeLensLineNumber===symbolsLineNumber?(this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex],helper),groupsIndex++,codeLensIndex++):(this._lenses.splice(codeLensIndex,0,new codelensWidget_1.CodeLensWidget(groups[groupsIndex],this._editor,this._styleClassName,helper,viewZoneAccessor,layoutInfo.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),codeLensIndex++,groupsIndex++)}for(;codeLensIndex<this._lenses.length;)this._lenses[codeLensIndex].dispose(helper,viewZoneAccessor),this._lenses.splice(codeLensIndex,1);for(;groupsIndex<groups.length;)this._lenses.push(new codelensWidget_1.CodeLensWidget(groups[groupsIndex],this._editor,this._styleClassName,helper,viewZoneAccessor,layoutInfo.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),groupsIndex++;helper.commit(decorationsAccessor)}))})),scrollState.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var _a;null===(_a=this._resolveCodeLensesPromise)||void 0===_a||_a.cancel(),this._resolveCodeLensesPromise=void 0;const model=this._editor.getModel();if(!model)return;const toResolve=[],lenses=[];if(this._lenses.forEach((lens=>{const request=lens.computeIfNecessary(model);request&&(toResolve.push(request),lenses.push(lens))})),0===toResolve.length)return;const t1=Date.now(),resolvePromise=(0,async_1.createCancelablePromise)((token=>{const promises=toResolve.map(((request,i)=>{const resolvedSymbols=new Array(request.length),promises=request.map(((request,i)=>request.symbol.command||"function"!=typeof request.provider.resolveCodeLens?(resolvedSymbols[i]=request.symbol,Promise.resolve(void 0)):Promise.resolve(request.provider.resolveCodeLens(model,request.symbol,token)).then((symbol=>{resolvedSymbols[i]=symbol}),errors_1.onUnexpectedExternalError)));return Promise.all(promises).then((()=>{token.isCancellationRequested||lenses[i].isDisposed()||lenses[i].updateCommands(resolvedSymbols)}))}));return Promise.all(promises)}));this._resolveCodeLensesPromise=resolvePromise,this._resolveCodeLensesPromise.then((()=>{const newDelay=this._resolveCodeLensesDebounce.update(model,Date.now()-t1);this._resolveCodeLensesScheduler.delay=newDelay,this._currentCodeLensModel&&this._codeLensCache.put(model,this._currentCodeLensModel),this._oldCodeLensModels.clear(),resolvePromise===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}),(err=>{(0,errors_1.onUnexpectedError)(err),resolvePromise===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}))}getModel(){return this._currentCodeLensModel}};CodeLensContribution.ID="css.editor.codeLens",CodeLensContribution=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService),__param(2,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(3,commands_1.ICommandService),__param(4,notification_1.INotificationService),__param(5,codeLensCache_1.ICodeLensCache)],CodeLensContribution),exports.CodeLensContribution=CodeLensContribution,(0,editorExtensions_1.registerEditorContribution)(CodeLensContribution.ID,CodeLensContribution),(0,editorExtensions_1.registerEditorAction)(class ShowLensesInCurrentLine extends editorExtensions_1.EditorAction{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:editorContextKeys_1.EditorContextKeys.hasCodeLensProvider,label:(0,nls_1.localize)(0,null),alias:"Show CodeLens Commands For Current Line"})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){if(!editor.hasModel())return;const quickInputService=accessor.get(quickInput_1.IQuickInputService),commandService=accessor.get(commands_1.ICommandService),notificationService=accessor.get(notification_1.INotificationService),lineNumber=editor.getSelection().positionLineNumber,codelensController=editor.getContribution(CodeLensContribution.ID);if(!codelensController)return;const model=codelensController.getModel();if(!model)return;const items=[];for(const lens of model.lenses)lens.symbol.command&&lens.symbol.range.startLineNumber===lineNumber&&items.push({label:lens.symbol.command.title,command:lens.symbol.command});if(0===items.length)return;const item=yield quickInputService.pick(items,{canPickMany:!1});if(item){if(model.isDisposed)return yield commandService.executeCommand(this.id);try{yield commandService.executeCommand(item.command.id,...item.command.arguments||[])}catch(err){notificationService.error(err)}}}))}})})),define(__m[299],__M([1,0,10,30,13,2,55,8,133,15,3,38,67,20,276,41]),(function(require,exports,async_1,color_1,errors_1,lifecycle_1,stopwatch_1,strings_1,editorDom_1,editorExtensions_1,range_1,textModel_1,languageFeatureDebounce_1,languageFeatures_1,color_2,configuration_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorDetector=exports.ColorDecorationInjectedTextMarker=void 0,exports.ColorDecorationInjectedTextMarker=Object.create({});let ColorDetector=class ColorDetector extends lifecycle_1.Disposable{constructor(_editor,_configurationService,_languageFeaturesService,languageFeatureDebounceService){super(),this._editor=_editor,this._configurationService=_configurationService,this._languageFeaturesService=_languageFeaturesService,this._localToDispose=this._register(new lifecycle_1.DisposableStore),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=new Set,this._ruleFactory=new editorDom_1.DynamicCssRules(this._editor),this._colorDecorationClassRefs=this._register(new lifecycle_1.DisposableStore),this._debounceInformation=languageFeatureDebounceService.for(_languageFeaturesService.colorProvider,"Document Colors",{min:ColorDetector.RECOMPUTE_TIME}),this._register(_editor.onDidChangeModel((()=>{this._isEnabled=this.isEnabled(),this.onModelChanged()}))),this._register(_editor.onDidChangeModelLanguage((()=>this.onModelChanged()))),this._register(_languageFeaturesService.colorProvider.onDidChange((()=>this.onModelChanged()))),this._register(_editor.onDidChangeConfiguration((()=>{let prevIsEnabled=this._isEnabled;this._isEnabled=this.isEnabled(),prevIsEnabled!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())}))),this._timeoutTimer=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){const model=this._editor.getModel();if(!model)return!1;const languageId=model.getLanguageId(),deprecatedConfig=this._configurationService.getValue(languageId);if(deprecatedConfig&&"object"==typeof deprecatedConfig){const colorDecorators=deprecatedConfig.colorDecorators;if(colorDecorators&&void 0!==colorDecorators.enable&&!colorDecorators.enable)return colorDecorators.enable}return this._editor.getOption(17)}static get(editor){return editor.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}onModelChanged(){if(this.stop(),!this._isEnabled)return;const model=this._editor.getModel();model&&this._languageFeaturesService.colorProvider.has(model)&&(this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._timeoutTimer||(this._timeoutTimer=new async_1.TimeoutTimer,this._timeoutTimer.cancelAndSet((()=>{this._timeoutTimer=null,this.beginCompute()}),this._debounceInformation.get(model)))}))),this.beginCompute())}beginCompute(){this._computePromise=(0,async_1.createCancelablePromise)((token=>__awaiter(this,void 0,void 0,(function*(){const model=this._editor.getModel();if(!model)return Promise.resolve([]);const sw=new stopwatch_1.StopWatch(!1),colors=yield(0,color_2.getColors)(this._languageFeaturesService.colorProvider,model,token);return this._debounceInformation.update(model,sw.elapsed()),colors})))),this._computePromise.then((colorInfos=>{this.updateDecorations(colorInfos),this.updateColorDecorators(colorInfos),this._computePromise=null}),errors_1.onUnexpectedError)}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(colorDatas){const decorations=colorDatas.map((c=>({range:{startLineNumber:c.colorInfo.range.startLineNumber,startColumn:c.colorInfo.range.startColumn,endLineNumber:c.colorInfo.range.endLineNumber,endColumn:c.colorInfo.range.endColumn},options:textModel_1.ModelDecorationOptions.EMPTY})));this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,decorations),this._colorDatas=new Map,this._decorationsIds.forEach(((id,i)=>this._colorDatas.set(id,colorDatas[i])))}updateColorDecorators(colorData){this._colorDecorationClassRefs.clear();let decorations=[];for(let i=0;i<colorData.length&&decorations.length<500;i++){const{red,green,blue,alpha}=colorData[i].colorInfo.color,rgba=new color_1.RGBA(Math.round(255*red),Math.round(255*green),Math.round(255*blue),alpha);let color=`rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;const ref=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:color}));decorations.push({range:{startLineNumber:colorData[i].colorInfo.range.startLineNumber,startColumn:colorData[i].colorInfo.range.startColumn,endLineNumber:colorData[i].colorInfo.range.endLineNumber,endColumn:colorData[i].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:strings_1.noBreakWhitespace,inlineClassName:`${ref.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:exports.ColorDecorationInjectedTextMarker}}})}this._colorDecoratorIds=new Set(this._editor.deltaDecorations([...this._colorDecoratorIds],decorations))}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=new Set(this._editor.deltaDecorations([...this._colorDecoratorIds],[])),this._colorDecorationClassRefs.clear()}getColorData(position){const model=this._editor.getModel();if(!model)return null;const decorations=model.getDecorationsInRange(range_1.Range.fromPositions(position,position)).filter((d=>this._colorDatas.has(d.id)));return 0===decorations.length?null:this._colorDatas.get(decorations[0].id)}isColorDecorationId(decorationId){return this._colorDecoratorIds.has(decorationId)}};ColorDetector.ID="editor.contrib.colorDetector",ColorDetector.RECOMPUTE_TIME=1e3,ColorDetector=__decorate([__param(1,configuration_1.IConfigurationService),__param(2,languageFeatures_1.ILanguageFeaturesService),__param(3,languageFeatureDebounce_1.ILanguageFeatureDebounceService)],ColorDetector),exports.ColorDetector=ColorDetector,(0,editorExtensions_1.registerEditorContribution)(ColorDetector.ID,ColorDetector)})),define(__m[720],__M([1,0,10,21,30,2,3,276,299,459,661,14]),(function(require,exports,async_1,cancellation_1,color_1,lifecycle_1,range_1,color_2,colorDetector_1,colorPickerModel_1,colorPickerWidget_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorHoverParticipant=exports.ColorHover=void 0;class ColorHover{constructor(owner,range,model,provider){this.owner=owner,this.range=range,this.model=model,this.provider=provider,this.forceShowAtRange=!0}isValidForHoverAnchor(anchor){return 1===anchor.type&&this.range.startColumn<=anchor.range.startColumn&&this.range.endColumn>=anchor.range.endColumn}}exports.ColorHover=ColorHover;let ColorHoverParticipant=class ColorHoverParticipant{constructor(_editor,_themeService){this._editor=_editor,this._themeService=_themeService,this.hoverOrdinal=1}computeSync(anchor,lineDecorations){return[]}computeAsync(anchor,lineDecorations,token){return async_1.AsyncIterableObject.fromPromise(this._computeAsync(anchor,lineDecorations,token))}_computeAsync(anchor,lineDecorations,token){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return[];const colorDetector=colorDetector_1.ColorDetector.get(this._editor);if(!colorDetector)return[];for(const d of lineDecorations){if(!colorDetector.isColorDecorationId(d.id))continue;const colorData=colorDetector.getColorData(d.range.getStartPosition());if(colorData){return[yield this._createColorHover(this._editor.getModel(),colorData.colorInfo,colorData.provider)]}}return[]}))}_createColorHover(editorModel,colorInfo,provider){return __awaiter(this,void 0,void 0,(function*(){const originalText=editorModel.getValueInRange(colorInfo.range),{red,green,blue,alpha}=colorInfo.color,rgba=new color_1.RGBA(Math.round(255*red),Math.round(255*green),Math.round(255*blue),alpha),color=new color_1.Color(rgba),colorPresentations=yield(0,color_2.getColorPresentations)(editorModel,colorInfo,provider,cancellation_1.CancellationToken.None),model=new colorPickerModel_1.ColorPickerModel(color,[],0);return model.colorPresentations=colorPresentations||[],model.guessColorPresentation(color,originalText),new ColorHover(this,range_1.Range.lift(colorInfo.range),model,provider)}))}renderHoverParts(context,hoverParts){if(0===hoverParts.length||!this._editor.hasModel())return lifecycle_1.Disposable.None;const disposables=new lifecycle_1.DisposableStore,colorHover=hoverParts[0],editorModel=this._editor.getModel(),model=colorHover.model,widget=disposables.add(new colorPickerWidget_1.ColorPickerWidget(context.fragment,model,this._editor.getOption(129),this._themeService));context.setColorPicker(widget);let range=new range_1.Range(colorHover.range.startLineNumber,colorHover.range.startColumn,colorHover.range.endLineNumber,colorHover.range.endColumn);const updateEditorModel=()=>{let textEdits,newRange;if(model.presentation.textEdit){textEdits=[model.presentation.textEdit],newRange=new range_1.Range(model.presentation.textEdit.range.startLineNumber,model.presentation.textEdit.range.startColumn,model.presentation.textEdit.range.endLineNumber,model.presentation.textEdit.range.endColumn);const trackedRange=this._editor.getModel()._setTrackedRange(null,newRange,3);this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",textEdits),newRange=this._editor.getModel()._getTrackedRange(trackedRange)||newRange}else textEdits=[{range,text:model.presentation.label,forceMoveMarkers:!1}],newRange=range.setEndPosition(range.endLineNumber,range.startColumn+model.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",textEdits);model.presentation.additionalTextEdits&&(textEdits=[...model.presentation.additionalTextEdits],this._editor.executeEdits("colorpicker",textEdits),context.hide()),this._editor.pushUndoStop(),range=newRange},updateColorPresentations=color=>(0,color_2.getColorPresentations)(editorModel,{range,color:{red:color.rgba.r/255,green:color.rgba.g/255,blue:color.rgba.b/255,alpha:color.rgba.a}},colorHover.provider,cancellation_1.CancellationToken.None).then((colorPresentations=>{model.colorPresentations=colorPresentations||[]}));return disposables.add(model.onColorFlushed((color=>{updateColorPresentations(color).then(updateEditorModel)}))),disposables.add(model.onDidChangeColor(updateColorPresentations)),disposables}};ColorHoverParticipant=__decorate([__param(1,themeService_1.IThemeService)],ColorHoverParticipant),exports.ColorHoverParticipant=ColorHoverParticipant})),define(__m[721],__M([1,0,2,16,15,11,3,22,38,460,376]),(function(require,exports,lifecycle_1,platform_1,editorExtensions_1,position_1,range_1,selection_1,textModel_1,dragAndDropCommand_1){"use strict";function hasTriggerModifier(e){return platform_1.isMacintosh?e.altKey:e.ctrlKey}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DragAndDropController=void 0;class DragAndDropController extends lifecycle_1.Disposable{constructor(editor){super(),this._editor=editor,this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._dndDecorationIds=[],this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(31)&&!this._editor.getOption(18)&&(hasTriggerModifier(e)&&(this._modifierPressed=!0),this._mouseDown&&hasTriggerModifier(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(31)&&!this._editor.getOption(18)&&(hasTriggerModifier(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===DragAndDropController.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(mouseEvent){this._mouseDown=!0}_onEditorMouseUp(mouseEvent){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(mouseEvent){let target=mouseEvent.target;if(null===this._dragSelection){let possibleSelections=(this._editor.getSelections()||[]).filter((selection=>target.position&&selection.containsPosition(target.position)));if(1!==possibleSelections.length)return;this._dragSelection=possibleSelections[0]}hasTriggerModifier(mouseEvent.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),target.position&&(this._dragSelection.containsPosition(target.position)?this._removeDecoration():this.showAt(target.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(mouseEvent){if(mouseEvent.target&&(this._hitContent(mouseEvent.target)||this._hitMargin(mouseEvent.target))&&mouseEvent.target.position){let newCursorPosition=new position_1.Position(mouseEvent.target.position.lineNumber,mouseEvent.target.position.column);if(null===this._dragSelection){let newSelections=null;if(mouseEvent.event.shiftKey){let primarySelection=this._editor.getSelection();if(primarySelection){const{selectionStartLineNumber,selectionStartColumn}=primarySelection;newSelections=[new selection_1.Selection(selectionStartLineNumber,selectionStartColumn,newCursorPosition.lineNumber,newCursorPosition.column)]}}else newSelections=(this._editor.getSelections()||[]).map((selection=>selection.containsPosition(newCursorPosition)?new selection_1.Selection(newCursorPosition.lineNumber,newCursorPosition.column,newCursorPosition.lineNumber,newCursorPosition.column):selection));this._editor.setSelections(newSelections||[],"mouse",3)}else(!this._dragSelection.containsPosition(newCursorPosition)||(hasTriggerModifier(mouseEvent.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(newCursorPosition)||this._dragSelection.getStartPosition().equals(newCursorPosition)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(DragAndDropController.ID,new dragAndDropCommand_1.DragAndDropCommand(this._dragSelection,newCursorPosition,hasTriggerModifier(mouseEvent.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(position){let newDecorations=[{range:new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),options:DragAndDropController._DECORATION_OPTIONS}];this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,newDecorations),this._editor.revealPosition(position,1)}_removeDecoration(){this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,[])}_hitContent(target){return 6===target.type||7===target.type}_hitMargin(target){return 2===target.type||3===target.type||4===target.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}exports.DragAndDropController=DragAndDropController,DragAndDropController.ID="editor.contrib.dragAndDrop",DragAndDropController.TRIGGER_KEY_VALUE=platform_1.isMacintosh?6:5,DragAndDropController._DECORATION_OPTIONS=textModel_1.ModelDecorationOptions.register({description:"dnd-target",className:"dnd-target"}),(0,editorExtensions_1.registerEditorContribution)(DragAndDropController.ID,DragAndDropController)})),define(__m[722],__M([1,0,3,50,38,23,14]),(function(require,exports,range_1,model_1,textModel_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindDecorations=void 0;class FindDecorations{constructor(editor){this._editor=editor,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const scopes=this._findScopeDecorationIds.map((findScopeDecorationId=>this._editor.getModel().getDecorationRange(findScopeDecorationId))).filter((element=>!!element));if(scopes.length)return scopes}return null}getStartPosition(){return this._startPosition}setStartPosition(newStartPosition){this._startPosition=newStartPosition,this.setCurrentFindMatch(null)}_getDecorationIndex(decorationId){const index=this._decorations.indexOf(decorationId);return index>=0?index+1:1}getCurrentMatchesPosition(desiredRange){let candidates=this._editor.getModel().getDecorationsInRange(desiredRange);for(const candidate of candidates){const candidateOpts=candidate.options;if(candidateOpts===FindDecorations._FIND_MATCH_DECORATION||candidateOpts===FindDecorations._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(candidate.id)}return 0}setCurrentFindMatch(nextMatch){let newCurrentDecorationId=null,matchPosition=0;if(nextMatch)for(let i=0,len=this._decorations.length;i<len;i++){let range=this._editor.getModel().getDecorationRange(this._decorations[i]);if(nextMatch.equalsRange(range)){newCurrentDecorationId=this._decorations[i],matchPosition=i+1;break}}return null===this._highlightedDecorationId&&null===newCurrentDecorationId||this._editor.changeDecorations((changeAccessor=>{if(null!==this._highlightedDecorationId&&(changeAccessor.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==newCurrentDecorationId&&(this._highlightedDecorationId=newCurrentDecorationId,changeAccessor.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(changeAccessor.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==newCurrentDecorationId){let rng=this._editor.getModel().getDecorationRange(newCurrentDecorationId);if(rng.startLineNumber!==rng.endLineNumber&&1===rng.endColumn){let lineBeforeEnd=rng.endLineNumber-1,lineBeforeEndMaxColumn=this._editor.getModel().getLineMaxColumn(lineBeforeEnd);rng=new range_1.Range(rng.startLineNumber,rng.startColumn,lineBeforeEnd,lineBeforeEndMaxColumn)}this._rangeHighlightDecorationId=changeAccessor.addDecoration(rng,FindDecorations._RANGE_HIGHLIGHT_DECORATION)}})),matchPosition}set(findMatches,findScopes){this._editor.changeDecorations((accessor=>{let findMatchesOptions=FindDecorations._FIND_MATCH_DECORATION,newOverviewRulerApproximateDecorations=[];if(findMatches.length>1e3){findMatchesOptions=FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;const lineCount=this._editor.getModel().getLineCount(),approxPixelsPerLine=this._editor.getLayoutInfo().height/lineCount,mergeLinesDelta=Math.max(2,Math.ceil(3/approxPixelsPerLine));let prevStartLineNumber=findMatches[0].range.startLineNumber,prevEndLineNumber=findMatches[0].range.endLineNumber;for(let i=1,len=findMatches.length;i<len;i++){const range=findMatches[i].range;prevEndLineNumber+mergeLinesDelta>=range.startLineNumber?range.endLineNumber>prevEndLineNumber&&(prevEndLineNumber=range.endLineNumber):(newOverviewRulerApproximateDecorations.push({range:new range_1.Range(prevStartLineNumber,1,prevEndLineNumber,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),prevStartLineNumber=range.startLineNumber,prevEndLineNumber=range.endLineNumber)}newOverviewRulerApproximateDecorations.push({range:new range_1.Range(prevStartLineNumber,1,prevEndLineNumber,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let newFindMatchesDecorations=new Array(findMatches.length);for(let i=0,len=findMatches.length;i<len;i++)newFindMatchesDecorations[i]={range:findMatches[i].range,options:findMatchesOptions};this._decorations=accessor.deltaDecorations(this._decorations,newFindMatchesDecorations),this._overviewRulerApproximateDecorations=accessor.deltaDecorations(this._overviewRulerApproximateDecorations,newOverviewRulerApproximateDecorations),this._rangeHighlightDecorationId&&(accessor.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((findScopeDecorationId=>accessor.removeDecoration(findScopeDecorationId))),this._findScopeDecorationIds=[]),(null==findScopes?void 0:findScopes.length)&&(this._findScopeDecorationIds=findScopes.map((findScope=>accessor.addDecoration(findScope,FindDecorations._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(position){if(0===this._decorations.length)return null;for(let i=this._decorations.length-1;i>=0;i--){let decorationId=this._decorations[i],r=this._editor.getModel().getDecorationRange(decorationId);if(r&&!(r.endLineNumber>position.lineNumber)){if(r.endLineNumber<position.lineNumber)return r;if(!(r.endColumn>position.column))return r}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(position){if(0===this._decorations.length)return null;for(let i=0,len=this._decorations.length;i<len;i++){let decorationId=this._decorations[i],r=this._editor.getModel().getDecorationRange(decorationId);if(r&&!(r.startLineNumber<position.lineNumber)){if(r.startLineNumber>position.lineNumber)return r;if(!(r.startColumn<position.column))return r}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let result=[];return result=result.concat(this._decorations),result=result.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&result.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&result.push(this._rangeHighlightDecorationId),result}}exports.FindDecorations=FindDecorations,FindDecorations._CURRENT_FIND_MATCH_DECORATION=textModel_1.ModelDecorationOptions.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.overviewRulerFindMatchForeground),position:model_1.OverviewRulerLane.Center},minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapFindMatch),position:model_1.MinimapPosition.Inline}}),FindDecorations._FIND_MATCH_DECORATION=textModel_1.ModelDecorationOptions.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.overviewRulerFindMatchForeground),position:model_1.OverviewRulerLane.Center},minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapFindMatch),position:model_1.MinimapPosition.Inline}}),FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION=textModel_1.ModelDecorationOptions.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION=textModel_1.ModelDecorationOptions.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.overviewRulerFindMatchForeground),position:model_1.OverviewRulerLane.Center}}),FindDecorations._RANGE_HIGHLIGHT_DECORATION=textModel_1.ModelDecorationOptions.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),FindDecorations._FIND_SCOPE_DECORATION=textModel_1.ModelDecorationOptions.register({description:"find-scope",className:"findScope",isWholeLine:!0})})),define(__m[165],__M([1,0,18,10,2,100,11,3,22,153,722,461,462,17]),(function(require,exports,arrays_1,async_1,lifecycle_1,replaceCommand_1,position_1,range_1,selection_1,textModelSearch_1,findDecorations_1,replaceAllCommand_1,replacePattern_1,contextkey_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindModelBoundToEditorModel=exports.MATCHES_LIMIT=exports.FIND_IDS=exports.TogglePreserveCaseKeybinding=exports.ToggleSearchScopeKeybinding=exports.ToggleRegexKeybinding=exports.ToggleWholeWordKeybinding=exports.ToggleCaseSensitiveKeybinding=exports.CONTEXT_REPLACE_INPUT_FOCUSED=exports.CONTEXT_FIND_INPUT_FOCUSED=exports.CONTEXT_FIND_WIDGET_NOT_VISIBLE=exports.CONTEXT_FIND_WIDGET_VISIBLE=void 0,exports.CONTEXT_FIND_WIDGET_VISIBLE=new contextkey_1.RawContextKey("findWidgetVisible",!1),exports.CONTEXT_FIND_WIDGET_NOT_VISIBLE=exports.CONTEXT_FIND_WIDGET_VISIBLE.toNegated(),exports.CONTEXT_FIND_INPUT_FOCUSED=new contextkey_1.RawContextKey("findInputFocussed",!1),exports.CONTEXT_REPLACE_INPUT_FOCUSED=new contextkey_1.RawContextKey("replaceInputFocussed",!1),exports.ToggleCaseSensitiveKeybinding={primary:545,mac:{primary:2593}},exports.ToggleWholeWordKeybinding={primary:565,mac:{primary:2613}},exports.ToggleRegexKeybinding={primary:560,mac:{primary:2608}},exports.ToggleSearchScopeKeybinding={primary:554,mac:{primary:2602}},exports.TogglePreserveCaseKeybinding={primary:558,mac:{primary:2606}},exports.FIND_IDS={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},exports.MATCHES_LIMIT=19999;class FindModelBoundToEditorModel{constructor(editor,state){this._toDispose=new lifecycle_1.DisposableStore,this._editor=editor,this._state=state,this._isDisposed=!1,this._startSearchingTimer=new async_1.TimeoutTimer,this._decorations=new findDecorations_1.FindDecorations(editor),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new async_1.RunOnceScheduler((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,(0,lifecycle_1.dispose)(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),240)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(model,findScope){return findScope||model.getFullModelRange()}research(moveCursor,newFindScope){let findScopes=null;void 0!==newFindScope?null!==newFindScope&&(findScopes=Array.isArray(newFindScope)?newFindScope:[newFindScope]):findScopes=this._decorations.getFindScopes(),null!==findScopes&&(findScopes=findScopes.map((findScope=>{if(findScope.startLineNumber!==findScope.endLineNumber){let endLineNumber=findScope.endLineNumber;return 1===findScope.endColumn&&(endLineNumber-=1),new range_1.Range(findScope.startLineNumber,1,endLineNumber,this._editor.getModel().getLineMaxColumn(endLineNumber))}return findScope})));let findMatches=this._findMatches(findScopes,!1,exports.MATCHES_LIMIT);this._decorations.set(findMatches,findScopes);const editorSelection=this._editor.getSelection();let currentMatchesPosition=this._decorations.getCurrentMatchesPosition(editorSelection);if(0===currentMatchesPosition&&findMatches.length>0){const matchAfterSelection=(0,arrays_1.findFirstInSorted)(findMatches.map((match=>match.range)),(range=>range_1.Range.compareRangesUsingStarts(range,editorSelection)>=0));currentMatchesPosition=matchAfterSelection>0?matchAfterSelection-1+1:currentMatchesPosition}this._state.changeMatchInfo(currentMatchesPosition,this._decorations.getCount(),void 0),moveCursor&&this._editor.getOption(35).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let findScope=this._decorations.getFindScope();return findScope&&this._editor.revealRangeInCenterIfOutsideViewport(findScope,0),!0}return!1}_setCurrentFindMatch(match){let matchesPosition=this._decorations.setCurrentFindMatch(match);this._state.changeMatchInfo(matchesPosition,this._decorations.getCount(),match),this._editor.setSelection(match),this._editor.revealRangeInCenterIfOutsideViewport(match,0)}_prevSearchPosition(before){let isUsingLineStops=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber,column}=before,model=this._editor.getModel();return isUsingLineStops||1===column?(1===lineNumber?lineNumber=model.getLineCount():lineNumber--,column=model.getLineMaxColumn(lineNumber)):column--,new position_1.Position(lineNumber,column)}_moveToPrevMatch(before,isRecursed=!1){if(!this._state.canNavigateBack()){const nextMatchRange=this._decorations.matchAfterPosition(before);return void(nextMatchRange&&this._setCurrentFindMatch(nextMatchRange))}if(this._decorations.getCount()<exports.MATCHES_LIMIT){let prevMatchRange=this._decorations.matchBeforePosition(before);return prevMatchRange&&prevMatchRange.isEmpty()&&prevMatchRange.getStartPosition().equals(before)&&(before=this._prevSearchPosition(before),prevMatchRange=this._decorations.matchBeforePosition(before)),void(prevMatchRange&&this._setCurrentFindMatch(prevMatchRange))}if(this._cannotFind())return;let findScope=this._decorations.getFindScope(),searchRange=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),findScope);searchRange.getEndPosition().isBefore(before)&&(before=searchRange.getEndPosition()),before.isBefore(searchRange.getStartPosition())&&(before=searchRange.getEndPosition());let{lineNumber,column}=before,model=this._editor.getModel(),position=new position_1.Position(lineNumber,column),prevMatch=model.findPreviousMatch(this._state.searchString,position,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,!1);return prevMatch&&prevMatch.range.isEmpty()&&prevMatch.range.getStartPosition().equals(position)&&(position=this._prevSearchPosition(position),prevMatch=model.findPreviousMatch(this._state.searchString,position,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,!1)),prevMatch?isRecursed||searchRange.containsRange(prevMatch.range)?void this._setCurrentFindMatch(prevMatch.range):this._moveToPrevMatch(prevMatch.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(after){let isUsingLineStops=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber,column}=after,model=this._editor.getModel();return isUsingLineStops||column===model.getLineMaxColumn(lineNumber)?(lineNumber===model.getLineCount()?lineNumber=1:lineNumber++,column=1):column++,new position_1.Position(lineNumber,column)}_moveToNextMatch(after){if(!this._state.canNavigateForward()){const prevMatchRange=this._decorations.matchBeforePosition(after);return void(prevMatchRange&&this._setCurrentFindMatch(prevMatchRange))}if(this._decorations.getCount()<exports.MATCHES_LIMIT){let nextMatchRange=this._decorations.matchAfterPosition(after);return nextMatchRange&&nextMatchRange.isEmpty()&&nextMatchRange.getStartPosition().equals(after)&&(after=this._nextSearchPosition(after),nextMatchRange=this._decorations.matchAfterPosition(after)),void(nextMatchRange&&this._setCurrentFindMatch(nextMatchRange))}let nextMatch=this._getNextMatch(after,!1,!0);nextMatch&&this._setCurrentFindMatch(nextMatch.range)}_getNextMatch(after,captureMatches,forceMove,isRecursed=!1){if(this._cannotFind())return null;let findScope=this._decorations.getFindScope(),searchRange=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),findScope);searchRange.getEndPosition().isBefore(after)&&(after=searchRange.getStartPosition()),after.isBefore(searchRange.getStartPosition())&&(after=searchRange.getStartPosition());let{lineNumber,column}=after,model=this._editor.getModel(),position=new position_1.Position(lineNumber,column),nextMatch=model.findNextMatch(this._state.searchString,position,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,captureMatches);return forceMove&&nextMatch&&nextMatch.range.isEmpty()&&nextMatch.range.getStartPosition().equals(position)&&(position=this._nextSearchPosition(position),nextMatch=model.findNextMatch(this._state.searchString,position,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,captureMatches)),nextMatch?isRecursed||searchRange.containsRange(nextMatch.range)?nextMatch:this._getNextMatch(nextMatch.range.getEndPosition(),captureMatches,forceMove,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?(0,replacePattern_1.parseReplaceString)(this._state.replaceString):replacePattern_1.ReplacePattern.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let replacePattern=this._getReplacePattern(),selection=this._editor.getSelection(),nextMatch=this._getNextMatch(selection.getStartPosition(),!0,!1);if(nextMatch)if(selection.equalsRange(nextMatch.range)){let replaceString=replacePattern.buildReplaceString(nextMatch.matches,this._state.preserveCase),command=new replaceCommand_1.ReplaceCommand(selection,replaceString);this._executeEditorCommand("replace",command),this._decorations.setStartPosition(new position_1.Position(selection.startLineNumber,selection.startColumn+replaceString.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(nextMatch.range)}_findMatches(findScopes,captureMatches,limitResultCount){const searchRanges=(findScopes||[null]).map((scope=>FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),scope)));return this._editor.getModel().findMatches(this._state.searchString,searchRanges,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,captureMatches,limitResultCount)}replaceAll(){if(!this._hasMatches())return;const findScopes=this._decorations.getFindScopes();null===findScopes&&this._state.matchesCount>=exports.MATCHES_LIMIT?this._largeReplaceAll():this._regularReplaceAll(findScopes),this.research(!1)}_largeReplaceAll(){const searchData=new textModelSearch_1.SearchParams(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null).parseSearchRequest();if(!searchData)return;let searchRegex=searchData.regex;if(!searchRegex.multiline){let mod="mu";searchRegex.ignoreCase&&(mod+="i"),searchRegex.global&&(mod+="g"),searchRegex=new RegExp(searchRegex.source,mod)}const model=this._editor.getModel(),modelText=model.getValue(1),fullModelRange=model.getFullModelRange(),replacePattern=this._getReplacePattern();let resultText;const preserveCase=this._state.preserveCase;resultText=replacePattern.hasReplacementPatterns||preserveCase?modelText.replace(searchRegex,(function(){return replacePattern.buildReplaceString(arguments,preserveCase)})):modelText.replace(searchRegex,replacePattern.buildReplaceString(null,preserveCase));let command=new replaceCommand_1.ReplaceCommandThatPreservesSelection(fullModelRange,resultText,this._editor.getSelection());this._executeEditorCommand("replaceAll",command)}_regularReplaceAll(findScopes){const replacePattern=this._getReplacePattern();let matches=this._findMatches(findScopes,replacePattern.hasReplacementPatterns||this._state.preserveCase,1073741824),replaceStrings=[];for(let i=0,len=matches.length;i<len;i++)replaceStrings[i]=replacePattern.buildReplaceString(matches[i].matches,this._state.preserveCase);let command=new replaceAllCommand_1.ReplaceAllCommand(this._editor.getSelection(),matches.map((m=>m.range)),replaceStrings);this._executeEditorCommand("replaceAll",command)}selectAllMatches(){if(!this._hasMatches())return;let findScopes=this._decorations.getFindScopes(),selections=this._findMatches(findScopes,!1,1073741824).map((m=>new selection_1.Selection(m.range.startLineNumber,m.range.startColumn,m.range.endLineNumber,m.range.endColumn))),editorSelection=this._editor.getSelection();for(let i=0,len=selections.length;i<len;i++){if(selections[i].equalsRange(editorSelection)){selections=[editorSelection].concat(selections.slice(0,i)).concat(selections.slice(i+1));break}}this._editor.setSelections(selections)}_executeEditorCommand(source,command){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(source,command),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}exports.FindModelBoundToEditorModel=FindModelBoundToEditorModel})),define(__m[723],__M([1,0,7,268,62,10,165,23,14]),(function(require,exports,dom,findInputCheckboxes_1,widget_1,async_1,findModel_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindOptionsWidget=void 0;class FindOptionsWidget extends widget_1.Widget{constructor(editor,state,keybindingService,themeService){super(),this._hideSoon=this._register(new async_1.RunOnceScheduler((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=editor,this._state=state,this._keybindingService=keybindingService,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const inputActiveOptionBorderColor=themeService.getColorTheme().getColor(colorRegistry_1.inputActiveOptionBorder),inputActiveOptionForegroundColor=themeService.getColorTheme().getColor(colorRegistry_1.inputActiveOptionForeground),inputActiveOptionBackgroundColor=themeService.getColorTheme().getColor(colorRegistry_1.inputActiveOptionBackground);this.caseSensitive=this._register(new findInputCheckboxes_1.CaseSensitiveCheckbox({appendTitle:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,inputActiveOptionBorder:inputActiveOptionBorderColor,inputActiveOptionForeground:inputActiveOptionForegroundColor,inputActiveOptionBackground:inputActiveOptionBackgroundColor})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new findInputCheckboxes_1.WholeWordsCheckbox({appendTitle:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleWholeWordCommand),isChecked:this._state.wholeWord,inputActiveOptionBorder:inputActiveOptionBorderColor,inputActiveOptionForeground:inputActiveOptionForegroundColor,inputActiveOptionBackground:inputActiveOptionBackgroundColor})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new findInputCheckboxes_1.RegexCheckbox({appendTitle:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleRegexCommand),isChecked:this._state.isRegex,inputActiveOptionBorder:inputActiveOptionBorderColor,inputActiveOptionForeground:inputActiveOptionForegroundColor,inputActiveOptionBackground:inputActiveOptionBackgroundColor})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let somethingChanged=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,somethingChanged=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,somethingChanged=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,somethingChanged=!0),!this._state.isRevealed&&somethingChanged&&this._revealTemporarily()}))),this._register(dom.addDisposableNonBubblingMouseOutListener(this._domNode,(e=>this._onMouseOut()))),this._register(dom.addDisposableListener(this._domNode,"mouseover",(e=>this._onMouseOver()))),this._applyTheme(themeService.getColorTheme()),this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(actionId){let kb=this._keybindingService.lookupKeybinding(actionId);return kb?` (${kb.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return FindOptionsWidget.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(theme){let inputStyles={inputActiveOptionBorder:theme.getColor(colorRegistry_1.inputActiveOptionBorder),inputActiveOptionForeground:theme.getColor(colorRegistry_1.inputActiveOptionForeground),inputActiveOptionBackground:theme.getColor(colorRegistry_1.inputActiveOptionBackground)};this.caseSensitive.style(inputStyles),this.wholeWords.style(inputStyles),this.regex.style(inputStyles)}}exports.FindOptionsWidget=FindOptionsWidget,FindOptionsWidget.ID="editor.contrib.findOptionsWidget",(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const widgetBackground=theme.getColor(colorRegistry_1.editorWidgetBackground);widgetBackground&&collector.addRule(`.monaco-editor .findOptionsWidget { background-color: ${widgetBackground}; }`);const widgetForeground=theme.getColor(colorRegistry_1.editorWidgetForeground);widgetForeground&&collector.addRule(`.monaco-editor .findOptionsWidget { color: ${widgetForeground}; }`);const widgetShadowColor=theme.getColor(colorRegistry_1.widgetShadow);widgetShadowColor&&collector.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);const hcBorder=theme.getColor(colorRegistry_1.contrastBorder);hcBorder&&collector.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${hcBorder}; }`)}))})),define(__m[724],__M([1,0,4,2,3,165]),(function(require,exports,event_1,lifecycle_1,range_1,findModel_1){"use strict";function effectiveOptionValue(override,value){return 1===override||2!==override&&value}Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindReplaceState=void 0;class FindReplaceState extends lifecycle_1.Disposable{constructor(){super(),this._onFindReplaceStateChange=this._register(new event_1.Emitter),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return effectiveOptionValue(this._isRegexOverride,this._isRegex)}get wholeWord(){return effectiveOptionValue(this._wholeWordOverride,this._wholeWord)}get matchCase(){return effectiveOptionValue(this._matchCaseOverride,this._matchCase)}get preserveCase(){return effectiveOptionValue(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(matchesPosition,matchesCount,currentMatch){let changeEvent={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1},somethingChanged=!1;0===matchesCount&&(matchesPosition=0),matchesPosition>matchesCount&&(matchesPosition=matchesCount),this._matchesPosition!==matchesPosition&&(this._matchesPosition=matchesPosition,changeEvent.matchesPosition=!0,somethingChanged=!0),this._matchesCount!==matchesCount&&(this._matchesCount=matchesCount,changeEvent.matchesCount=!0,somethingChanged=!0),void 0!==currentMatch&&(range_1.Range.equalsRange(this._currentMatch,currentMatch)||(this._currentMatch=currentMatch,changeEvent.currentMatch=!0,somethingChanged=!0)),somethingChanged&&this._onFindReplaceStateChange.fire(changeEvent)}change(newState,moveCursor,updateHistory=!0){var _a;let changeEvent={moveCursor,updateHistory,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1},somethingChanged=!1;const oldEffectiveIsRegex=this.isRegex,oldEffectiveWholeWords=this.wholeWord,oldEffectiveMatchCase=this.matchCase,oldEffectivePreserveCase=this.preserveCase;void 0!==newState.searchString&&this._searchString!==newState.searchString&&(this._searchString=newState.searchString,changeEvent.searchString=!0,somethingChanged=!0),void 0!==newState.replaceString&&this._replaceString!==newState.replaceString&&(this._replaceString=newState.replaceString,changeEvent.replaceString=!0,somethingChanged=!0),void 0!==newState.isRevealed&&this._isRevealed!==newState.isRevealed&&(this._isRevealed=newState.isRevealed,changeEvent.isRevealed=!0,somethingChanged=!0),void 0!==newState.isReplaceRevealed&&this._isReplaceRevealed!==newState.isReplaceRevealed&&(this._isReplaceRevealed=newState.isReplaceRevealed,changeEvent.isReplaceRevealed=!0,somethingChanged=!0),void 0!==newState.isRegex&&(this._isRegex=newState.isRegex),void 0!==newState.wholeWord&&(this._wholeWord=newState.wholeWord),void 0!==newState.matchCase&&(this._matchCase=newState.matchCase),void 0!==newState.preserveCase&&(this._preserveCase=newState.preserveCase),void 0!==newState.searchScope&&((null===(_a=newState.searchScope)||void 0===_a?void 0:_a.every((newSearchScope=>{var _a;return null===(_a=this._searchScope)||void 0===_a?void 0:_a.some((existingSearchScope=>!range_1.Range.equalsRange(existingSearchScope,newSearchScope)))})))||(this._searchScope=newState.searchScope,changeEvent.searchScope=!0,somethingChanged=!0)),void 0!==newState.loop&&this._loop!==newState.loop&&(this._loop=newState.loop,changeEvent.loop=!0,somethingChanged=!0),void 0!==newState.isSearching&&this._isSearching!==newState.isSearching&&(this._isSearching=newState.isSearching,changeEvent.isSearching=!0,somethingChanged=!0),void 0!==newState.filters&&(this._filters?this._filters.update(newState.filters):this._filters=newState.filters,changeEvent.filters=!0,somethingChanged=!0),this._isRegexOverride=void 0!==newState.isRegexOverride?newState.isRegexOverride:0,this._wholeWordOverride=void 0!==newState.wholeWordOverride?newState.wholeWordOverride:0,this._matchCaseOverride=void 0!==newState.matchCaseOverride?newState.matchCaseOverride:0,this._preserveCaseOverride=void 0!==newState.preserveCaseOverride?newState.preserveCaseOverride:0,oldEffectiveIsRegex!==this.isRegex&&(somethingChanged=!0,changeEvent.isRegex=!0),oldEffectiveWholeWords!==this.wholeWord&&(somethingChanged=!0,changeEvent.wholeWord=!0),oldEffectiveMatchCase!==this.matchCase&&(somethingChanged=!0,changeEvent.matchCase=!0),oldEffectivePreserveCase!==this.preserveCase&&(somethingChanged=!0,changeEvent.preserveCase=!0),somethingChanged&&this._onFindReplaceStateChange.fire(changeEvent)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=findModel_1.MATCHES_LIMIT}}exports.FindReplaceState=FindReplaceState})),define(__m[725],__M([1,0,7,46,174,116,62,10,28,13,2,16,8,3,165,537,283,605,23,74,14,377]),(function(require,exports,dom,aria_1,checkbox_1,sash_1,widget_1,async_1,codicons_1,errors_1,lifecycle_1,platform,strings,range_1,findModel_1,nls,contextScopedHistoryWidget_1,historyWidgetKeybindingHint_1,colorRegistry_1,iconRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleButton=exports.FindWidget=exports.FindWidgetViewZone=exports.NLS_NO_RESULTS=exports.NLS_MATCHES_LOCATION=exports.findNextMatchIcon=exports.findPreviousMatchIcon=exports.findReplaceAllIcon=exports.findReplaceIcon=void 0;const findSelectionIcon=(0,iconRegistry_1.registerIcon)("find-selection",codicons_1.Codicon.selection,nls.localize(0,null)),findCollapsedIcon=(0,iconRegistry_1.registerIcon)("find-collapsed",codicons_1.Codicon.chevronRight,nls.localize(1,null)),findExpandedIcon=(0,iconRegistry_1.registerIcon)("find-expanded",codicons_1.Codicon.chevronDown,nls.localize(2,null));exports.findReplaceIcon=(0,iconRegistry_1.registerIcon)("find-replace",codicons_1.Codicon.replace,nls.localize(3,null)),exports.findReplaceAllIcon=(0,iconRegistry_1.registerIcon)("find-replace-all",codicons_1.Codicon.replaceAll,nls.localize(4,null)),exports.findPreviousMatchIcon=(0,iconRegistry_1.registerIcon)("find-previous-match",codicons_1.Codicon.arrowUp,nls.localize(5,null)),exports.findNextMatchIcon=(0,iconRegistry_1.registerIcon)("find-next-match",codicons_1.Codicon.arrowDown,nls.localize(6,null));const NLS_FIND_INPUT_LABEL=nls.localize(7,null),NLS_FIND_INPUT_PLACEHOLDER=nls.localize(8,null),NLS_PREVIOUS_MATCH_BTN_LABEL=nls.localize(9,null),NLS_NEXT_MATCH_BTN_LABEL=nls.localize(10,null),NLS_TOGGLE_SELECTION_FIND_TITLE=nls.localize(11,null),NLS_CLOSE_BTN_LABEL=nls.localize(12,null),NLS_REPLACE_INPUT_LABEL=nls.localize(13,null),NLS_REPLACE_INPUT_PLACEHOLDER=nls.localize(14,null),NLS_REPLACE_BTN_LABEL=nls.localize(15,null),NLS_REPLACE_ALL_BTN_LABEL=nls.localize(16,null),NLS_TOGGLE_REPLACE_MODE_BTN_LABEL=nls.localize(17,null),NLS_MATCHES_COUNT_LIMIT_TITLE=nls.localize(18,null,findModel_1.MATCHES_LIMIT);exports.NLS_MATCHES_LOCATION=nls.localize(19,null),exports.NLS_NO_RESULTS=nls.localize(20,null);let MAX_MATCHES_COUNT_WIDTH=69;const ctrlKeyMod=platform.isMacintosh?256:2048;class FindWidgetViewZone{constructor(afterLineNumber){this.afterLineNumber=afterLineNumber,this.heightInPx=33,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function stopPropagationForMultiLineUpwards(event,value,textarea){const isMultiline=!!value.match(/\n/);textarea&&isMultiline&&textarea.selectionStart>0&&event.stopPropagation()}function stopPropagationForMultiLineDownwards(event,value,textarea){const isMultiline=!!value.match(/\n/);textarea&&isMultiline&&textarea.selectionEnd<textarea.value.length&&event.stopPropagation()}exports.FindWidgetViewZone=FindWidgetViewZone;class FindWidget extends widget_1.Widget{constructor(codeEditor,controller,state,contextViewProvider,keybindingService,contextKeyService,themeService,storageService,notificationService){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=codeEditor,this._controller=controller,this._state=state,this._contextViewProvider=contextViewProvider,this._keybindingService=keybindingService,this._contextKeyService=contextKeyService,this._storageService=storageService,this._notificationService=notificationService,this._ctrlEnterReplaceAllWarningPrompted=!!storageService.getBoolean("ctrlEnterReplaceAll.windows.donotask",0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new async_1.Delayer(500),this._register((0,lifecycle_1.toDisposable)((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(81)&&(this._codeEditor.getOption(81)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(131)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(35)){const addExtraSpaceOnTop=this._codeEditor.getOption(35).addExtraSpaceOnTop;addExtraSpaceOnTop&&!this._viewZone&&(this._viewZone=new FindWidgetViewZone(0),this._showViewZone()),!addExtraSpaceOnTop&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>__awaiter(this,void 0,void 0,(function*(){if(this._isVisible){let globalBufferTerm=yield this._controller.getGlobalBufferTerm();globalBufferTerm&&globalBufferTerm!==this._state.searchString&&(this._state.change({searchString:globalBufferTerm},!1),this._findInput.select())}}))))),this._findInputFocused=findModel_1.CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService),this._findFocusTracker=this._register(dom.trackFocus(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=findModel_1.CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService),this._replaceFocusTracker=this._register(dom.trackFocus(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(35).addExtraSpaceOnTop&&(this._viewZone=new FindWidgetViewZone(0)),this._applyTheme(themeService.getColorTheme()),this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return FindWidget.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(81)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let showRedOutline=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",showRedOutline),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,errors_1.onUnexpectedError)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let label;if(this._matchesCount.style.minWidth=MAX_MATCHES_COUNT_WIDTH+"px",this._state.matchesCount>=findModel_1.MATCHES_LIMIT?this._matchesCount.title=NLS_MATCHES_COUNT_LIMIT_TITLE:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let matchesCount=String(this._state.matchesCount);this._state.matchesCount>=findModel_1.MATCHES_LIMIT&&(matchesCount+="+");let matchesPosition=String(this._state.matchesPosition);"0"===matchesPosition&&(matchesPosition="?"),label=strings.format(exports.NLS_MATCHES_LOCATION,matchesPosition,matchesCount)}else label=exports.NLS_NO_RESULTS;this._matchesCount.appendChild(document.createTextNode(label)),(0,aria_1.alert)(this._getAriaLabel(label,this._state.currentMatch,this._state.searchString)),MAX_MATCHES_COUNT_WIDTH=Math.max(MAX_MATCHES_COUNT_WIDTH,this._matchesCount.clientWidth)}_getAriaLabel(label,currentMatch,searchString){if(label===exports.NLS_NO_RESULTS)return""===searchString?nls.localize(21,null,label):nls.localize(22,null,label,searchString);if(currentMatch){const ariaLabel=nls.localize(23,null,label,searchString,currentMatch.startLineNumber+":"+currentMatch.startColumn),model=this._codeEditor.getModel();if(model&&currentMatch.startLineNumber<=model.getLineCount()&&currentMatch.startLineNumber>=1){return`${model.getLineContent(currentMatch.startLineNumber)}, ${ariaLabel}`}return ariaLabel}return nls.localize(24,null,label,searchString)}_updateToggleSelectionFindButton(){let selection=this._codeEditor.getSelection(),isSelection=!!selection&&(selection.startLineNumber!==selection.endLineNumber||selection.startColumn!==selection.endColumn),isChecked=this._toggleSelectionFind.checked;this._isVisible&&(isChecked||isSelection)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let findInputIsNonEmpty=this._state.searchString.length>0,matchesCount=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&findInputIsNonEmpty&&matchesCount&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&findInputIsNonEmpty&&matchesCount&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&findInputIsNonEmpty),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&findInputIsNonEmpty),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let canReplace=!this._codeEditor.getOption(81);this._toggleReplaceBtn.setEnabled(this._isVisible&&canReplace)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const selection=this._codeEditor.getSelection();switch(this._codeEditor.getOption(35).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const isSelectionMultipleLine=!!selection&&selection.startLineNumber!==selection.endLineNumber;this._toggleSelectionFind.checked=isSelectionMultipleLine;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let adjustEditorScrollTop=!0;if(this._codeEditor.getOption(35).seedSearchStringFromSelection&&selection){const domNode=this._codeEditor.getDomNode();if(domNode){const editorCoords=dom.getDomNodePagePosition(domNode),startCoords=this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition()),startLeft=editorCoords.left+(startCoords?startCoords.left:0),startTop=startCoords?startCoords.top:0;if(this._viewZone&&startTop<this._viewZone.heightInPx){selection.endLineNumber>selection.startLineNumber&&(adjustEditorScrollTop=!1);const leftOfFindWidget=dom.getTopLeftOffset(this._domNode).left;startLeft>leftOfFindWidget&&(adjustEditorScrollTop=!1);const endCoords=this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());editorCoords.left+(endCoords?endCoords.left:0)>leftOfFindWidget&&(adjustEditorScrollTop=!1)}}}this._showViewZone(adjustEditorScrollTop)}}_hide(focusTheEditor){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),focusTheEditor&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(targetScrollTop){if(!this._codeEditor.getOption(35).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const viewZone=this._viewZone;void 0===this._viewZoneId&&viewZone&&this._codeEditor.changeViewZones((accessor=>{viewZone.heightInPx=this._getHeight(),this._viewZoneId=accessor.addZone(viewZone),this._codeEditor.setScrollTop(targetScrollTop||this._codeEditor.getScrollTop()+viewZone.heightInPx)}))}_showViewZone(adjustScroll=!0){if(!this._isVisible)return;if(!this._codeEditor.getOption(35).addExtraSpaceOnTop)return;void 0===this._viewZone&&(this._viewZone=new FindWidgetViewZone(0));const viewZone=this._viewZone;this._codeEditor.changeViewZones((accessor=>{if(void 0!==this._viewZoneId){const newHeight=this._getHeight();if(newHeight===viewZone.heightInPx)return;let scrollAdjustment=newHeight-viewZone.heightInPx;return viewZone.heightInPx=newHeight,accessor.layoutZone(this._viewZoneId),void(adjustScroll&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+scrollAdjustment))}{let scrollAdjustment=this._getHeight();if(scrollAdjustment-=this._codeEditor.getOption(75).top,scrollAdjustment<=0)return;viewZone.heightInPx=scrollAdjustment,this._viewZoneId=accessor.addZone(viewZone),adjustScroll&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+scrollAdjustment)}}))}_removeViewZone(){this._codeEditor.changeViewZones((accessor=>{void 0!==this._viewZoneId&&(accessor.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_applyTheme(theme){let inputStyles={inputActiveOptionBorder:theme.getColor(colorRegistry_1.inputActiveOptionBorder),inputActiveOptionBackground:theme.getColor(colorRegistry_1.inputActiveOptionBackground),inputActiveOptionForeground:theme.getColor(colorRegistry_1.inputActiveOptionForeground),inputBackground:theme.getColor(colorRegistry_1.inputBackground),inputForeground:theme.getColor(colorRegistry_1.inputForeground),inputBorder:theme.getColor(colorRegistry_1.inputBorder),inputValidationInfoBackground:theme.getColor(colorRegistry_1.inputValidationInfoBackground),inputValidationInfoForeground:theme.getColor(colorRegistry_1.inputValidationInfoForeground),inputValidationInfoBorder:theme.getColor(colorRegistry_1.inputValidationInfoBorder),inputValidationWarningBackground:theme.getColor(colorRegistry_1.inputValidationWarningBackground),inputValidationWarningForeground:theme.getColor(colorRegistry_1.inputValidationWarningForeground),inputValidationWarningBorder:theme.getColor(colorRegistry_1.inputValidationWarningBorder),inputValidationErrorBackground:theme.getColor(colorRegistry_1.inputValidationErrorBackground),inputValidationErrorForeground:theme.getColor(colorRegistry_1.inputValidationErrorForeground),inputValidationErrorBorder:theme.getColor(colorRegistry_1.inputValidationErrorBorder)};this._findInput.style(inputStyles),this._replaceInput.style(inputStyles),this._toggleSelectionFind.style(inputStyles)}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!dom.isInDOM(this._domNode))return;const layoutInfo=this._codeEditor.getLayoutInfo();if(layoutInfo.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const editorWidth=layoutInfo.width,minimapWidth=layoutInfo.minimap.minimapWidth;let collapsedFindWidget=!1,reducedFindWidget=!1,narrowFindWidget=!1;if(this._resized){if(dom.getTotalWidth(this._domNode)>419)return this._domNode.style.maxWidth=editorWidth-28-minimapWidth-15+"px",void(this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode))}if(447+minimapWidth>=editorWidth&&(reducedFindWidget=!0),447+minimapWidth-MAX_MATCHES_COUNT_WIDTH>=editorWidth&&(narrowFindWidget=!0),447+minimapWidth-MAX_MATCHES_COUNT_WIDTH>=editorWidth+50&&(collapsedFindWidget=!0),this._domNode.classList.toggle("collapsed-find-widget",collapsedFindWidget),this._domNode.classList.toggle("narrow-find-widget",narrowFindWidget),this._domNode.classList.toggle("reduced-find-widget",reducedFindWidget),narrowFindWidget||collapsedFindWidget||(this._domNode.style.maxWidth=editorWidth-28-minimapWidth-15+"px"),this._resized){this._findInput.inputBox.layout();let findInputWidth=this._findInput.inputBox.element.clientWidth;findInputWidth>0&&(this._replaceInput.width=findInputWidth)}else this._isReplaceVisible&&(this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode))}_getHeight(){let totalheight=0;return totalheight+=4,totalheight+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(totalheight+=4,totalheight+=this._replaceInput.inputBox.height+2),totalheight+=4,totalheight}_tryUpdateHeight(){const totalHeight=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==totalHeight)&&(this._cachedHeight=totalHeight,this._domNode.style.height=`${totalHeight}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let selections=this._codeEditor.getSelections();selections.map((selection=>{1===selection.endColumn&&selection.endLineNumber>selection.startLineNumber&&(selection=selection.setEndPosition(selection.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber-1)));const currentMatch=this._state.currentMatch;return selection.startLineNumber===selection.endLineNumber||range_1.Range.equalsRange(selection,currentMatch)?null:selection})).filter((element=>!!element)),selections.length&&this._state.change({searchScope:selections},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|ctrlKeyMod)?(this._keybindingService.dispatchEvent(e,e.target)||this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?stopPropagationForMultiLineUpwards(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?stopPropagationForMultiLineDownwards(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|ctrlKeyMod)?(this._keybindingService.dispatchEvent(e,e.target)||(platform.isWindows&&platform.isNative&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(nls.localize(25,null)),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store("ctrlEnterReplaceAll.windows.donotask",!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n")),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?stopPropagationForMultiLineUpwards(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?stopPropagationForMultiLineDownwards(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(_sash){return 0}_keybindingLabelFor(actionId){let kb=this._keybindingService.lookupKeybinding(actionId);return kb?` (${kb.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new contextScopedHistoryWidget_1.ContextScopedFindInput(null,this._contextViewProvider,{width:221,label:NLS_FIND_INPUT_LABEL,placeholder:NLS_FIND_INPUT_PLACEHOLDER,appendCaseSensitiveLabel:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleRegexCommand),validation:value=>{if(0===value.length||!this._findInput.getRegex())return null;try{return new RegExp(value,"gu"),null}catch(e){return{content:e.message}}},flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>(0,historyWidgetKeybindingHint_1.showHistoryKeybindingHint)(this._keybindingService)},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),platform.isLinux&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new SimpleButton({label:NLS_PREVIOUS_MATCH_BTN_LABEL+this._keybindingLabelFor(findModel_1.FIND_IDS.PreviousMatchFindAction),icon:exports.findPreviousMatchIcon,onTrigger:()=>{this._codeEditor.getAction(findModel_1.FIND_IDS.PreviousMatchFindAction).run().then(void 0,errors_1.onUnexpectedError)}})),this._nextBtn=this._register(new SimpleButton({label:NLS_NEXT_MATCH_BTN_LABEL+this._keybindingLabelFor(findModel_1.FIND_IDS.NextMatchFindAction),icon:exports.findNextMatchIcon,onTrigger:()=>{this._codeEditor.getAction(findModel_1.FIND_IDS.NextMatchFindAction).run().then(void 0,errors_1.onUnexpectedError)}}));let findPart=document.createElement("div");findPart.className="find-part",findPart.appendChild(this._findInput.domNode);const actionsContainer=document.createElement("div");actionsContainer.className="find-actions",findPart.appendChild(actionsContainer),actionsContainer.appendChild(this._matchesCount),actionsContainer.appendChild(this._prevBtn.domNode),actionsContainer.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new checkbox_1.Checkbox({icon:findSelectionIcon,title:NLS_TOGGLE_SELECTION_FIND_TITLE+this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleSearchScopeCommand),isChecked:!1})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let selections=this._codeEditor.getSelections();selections.map((selection=>(1===selection.endColumn&&selection.endLineNumber>selection.startLineNumber&&(selection=selection.setEndPosition(selection.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber-1))),selection.isEmpty()?null:selection))).filter((element=>!!element)),selections.length&&this._state.change({searchScope:selections},!0)}}else this._state.change({searchScope:null},!0)}))),actionsContainer.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new SimpleButton({label:NLS_CLOSE_BTN_LABEL+this._keybindingLabelFor(findModel_1.FIND_IDS.CloseFindWidgetCommand),icon:iconRegistry_1.widgetClose,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),actionsContainer.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new contextScopedHistoryWidget_1.ContextScopedReplaceInput(null,void 0,{label:NLS_REPLACE_INPUT_LABEL,placeholder:NLS_REPLACE_INPUT_PLACEHOLDER,appendPreserveCaseLabel:this._keybindingLabelFor(findModel_1.FIND_IDS.TogglePreserveCaseCommand),history:[],flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>(0,historyWidgetKeybindingHint_1.showHistoryKeybindingHint)(this._keybindingService)},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new SimpleButton({label:NLS_REPLACE_BTN_LABEL+this._keybindingLabelFor(findModel_1.FIND_IDS.ReplaceOneAction),icon:exports.findReplaceIcon,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new SimpleButton({label:NLS_REPLACE_ALL_BTN_LABEL+this._keybindingLabelFor(findModel_1.FIND_IDS.ReplaceAllAction),icon:exports.findReplaceAllIcon,onTrigger:()=>{this._controller.replaceAll()}}));let replacePart=document.createElement("div");replacePart.className="replace-part",replacePart.appendChild(this._replaceInput.domNode);const replaceActionsContainer=document.createElement("div");replaceActionsContainer.className="replace-actions",replacePart.appendChild(replaceActionsContainer),replaceActionsContainer.appendChild(this._replaceBtn.domNode),replaceActionsContainer.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new SimpleButton({label:NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width="419px",this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(findPart),this._domNode.appendChild(replacePart),this._resizeSash=new sash_1.Sash(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let originalWidth=419;this._register(this._resizeSash.onDidStart((()=>{originalWidth=dom.getTotalWidth(this._domNode)}))),this._register(this._resizeSash.onDidChange((evt=>{this._resized=!0;let width=originalWidth+evt.startX-evt.currentX;if(width<419)return;width>(parseFloat(dom.getComputedStyle(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${width}px`,this._isReplaceVisible&&(this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const currentWidth=dom.getTotalWidth(this._domNode);if(currentWidth<419)return;let width=419;if(!this._resized||419===currentWidth){const layoutInfo=this._codeEditor.getLayoutInfo();width=layoutInfo.width-28-layoutInfo.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${width}px`,this._isReplaceVisible&&(this._replaceInput.width=dom.getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const value=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==value)}}exports.FindWidget=FindWidget,FindWidget.ID="editor.contrib.findWidget";class SimpleButton extends widget_1.Widget{constructor(opts){super(),this._opts=opts;let className="button";this._opts.className&&(className=className+" "+this._opts.className),this._opts.icon&&(className=className+" "+themeService_1.ThemeIcon.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=className,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();this._opts.onKeyDown&&this._opts.onKeyDown(e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(enabled){this._domNode.classList.toggle("disabled",!enabled),this._domNode.setAttribute("aria-disabled",String(!enabled)),this._domNode.tabIndex=enabled?0:-1}setExpanded(expanded){this._domNode.setAttribute("aria-expanded",String(!!expanded)),expanded?(this._domNode.classList.remove(...themeService_1.ThemeIcon.asClassNameArray(findCollapsedIcon)),this._domNode.classList.add(...themeService_1.ThemeIcon.asClassNameArray(findExpandedIcon))):(this._domNode.classList.remove(...themeService_1.ThemeIcon.asClassNameArray(findExpandedIcon)),this._domNode.classList.add(...themeService_1.ThemeIcon.asClassNameArray(findCollapsedIcon)))}}exports.SimpleButton=SimpleButton,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const addBackgroundColorRule=(selector,color)=>{color&&collector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`)};addBackgroundColorRule(".findMatch",theme.getColor(colorRegistry_1.editorFindMatchHighlight)),addBackgroundColorRule(".currentFindMatch",theme.getColor(colorRegistry_1.editorFindMatch)),addBackgroundColorRule(".findScope",theme.getColor(colorRegistry_1.editorFindRangeHighlight));addBackgroundColorRule(".find-widget",theme.getColor(colorRegistry_1.editorWidgetBackground));const widgetShadowColor=theme.getColor(colorRegistry_1.widgetShadow);widgetShadowColor&&collector.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);const findMatchHighlightBorder=theme.getColor(colorRegistry_1.editorFindMatchHighlightBorder);findMatchHighlightBorder&&collector.addRule(`.monaco-editor .findMatch { border: 1px ${"hc"===theme.type?"dotted":"solid"} ${findMatchHighlightBorder}; box-sizing: border-box; }`);const findMatchBorder=theme.getColor(colorRegistry_1.editorFindMatchBorder);findMatchBorder&&collector.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${findMatchBorder}; padding: 1px; box-sizing: border-box; }`);const findRangeHighlightBorder=theme.getColor(colorRegistry_1.editorFindRangeHighlightBorder);findRangeHighlightBorder&&collector.addRule(`.monaco-editor .findScope { border: 1px ${"hc"===theme.type?"dashed":"solid"} ${findRangeHighlightBorder}; }`);const hcBorder=theme.getColor(colorRegistry_1.contrastBorder);hcBorder&&collector.addRule(`.monaco-editor .find-widget { border: 1px solid ${hcBorder}; }`);const foreground=theme.getColor(colorRegistry_1.editorWidgetForeground);foreground&&collector.addRule(`.monaco-editor .find-widget { color: ${foreground}; }`);const error=theme.getColor(colorRegistry_1.errorForeground);error&&collector.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${error}; }`);const resizeBorderBackground=theme.getColor(colorRegistry_1.editorWidgetResizeBorder);if(resizeBorderBackground)collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${resizeBorderBackground}; }`);else{const border=theme.getColor(colorRegistry_1.editorWidgetBorder);border&&collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${border}; }`)}const toolbarHoverBackgroundColor=theme.getColor(colorRegistry_1.toolbarHoverBackground);toolbarHoverBackgroundColor&&collector.addRule(`\n\t\t.monaco-editor .find-widget .button:not(.disabled):hover,\n\t\t.monaco-editor .find-widget .codicon-find-selection:hover {\n\t\t\tbackground-color: ${toolbarHoverBackgroundColor} !important;\n\t\t}\n\t`);const focusOutline=theme.getColor(colorRegistry_1.focusBorder);focusOutline&&collector.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${focusOutline}; }`)}))})),define(__m[300],__M([1,0,10,2,8,15,24,165,723,724,725,536,37,104,17,78,43,39,82,14]),(function(require,exports,async_1,lifecycle_1,strings,editorExtensions_1,editorContextKeys_1,findModel_1,findOptionsWidget_1,findState_1,findWidget_1,nls,actions_1,clipboardService_1,contextkey_1,contextView_1,keybinding_1,notification_1,storage_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StartFindReplaceAction=exports.PreviousSelectionMatchFindAction=exports.NextSelectionMatchFindAction=exports.SelectionMatchFindAction=exports.PreviousMatchFindAction=exports.NextMatchFindAction=exports.MatchFindAction=exports.StartFindWithSelectionAction=exports.StartFindWithArgsAction=exports.StartFindAction=exports.FindController=exports.CommonFindController=exports.getSelectionSearchString=void 0;function getSelectionSearchString(editor,seedSearchStringFromSelection="single",seedSearchStringFromNonEmptySelection=!1){if(!editor.hasModel())return null;const selection=editor.getSelection();if("single"===seedSearchStringFromSelection&&selection.startLineNumber===selection.endLineNumber||"multiple"===seedSearchStringFromSelection)if(selection.isEmpty()){const wordAtPosition=editor.getConfiguredWordAtPosition(selection.getStartPosition());if(wordAtPosition&&!1===seedSearchStringFromNonEmptySelection)return wordAtPosition.word}else if(editor.getModel().getValueLengthInRange(selection)<524288)return editor.getModel().getValueInRange(selection);return null}exports.getSelectionSearchString=getSelectionSearchString;let CommonFindController=class CommonFindController extends lifecycle_1.Disposable{constructor(editor,contextKeyService,storageService,clipboardService){super(),this._editor=editor,this._findWidgetVisible=findModel_1.CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService),this._contextKeyService=contextKeyService,this._storageService=storageService,this._clipboardService=clipboardService,this._updateHistoryDelayer=new async_1.Delayer(500),this._state=this._register(new findState_1.FindReplaceState),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{let shouldRestartFind=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),shouldRestartFind&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(35).loop})})))}get editor(){return this._editor}static get(editor){return editor.getContribution(CommonFindController.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!findModel_1.CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let selections=this._editor.getSelections();selections.map((selection=>(1===selection.endColumn&&selection.endLineNumber>selection.startLineNumber&&(selection=selection.setEndPosition(selection.endLineNumber-1,this._editor.getModel().getLineMaxColumn(selection.endLineNumber-1))),selection.isEmpty()?null:selection))).filter((element=>!!element)),selections.length&&this._state.change({searchScope:selections},!0)}}setSearchString(searchString){this._state.isRegex&&(searchString=strings.escapeRegExpCharacters(searchString)),this._state.change({searchString},!1)}highlightFindOptions(ignoreWhenVisible=!1){}_start(opts,newState){return __awaiter(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;let stateChanges=Object.assign(Object.assign({},newState),{isRevealed:!0});if("single"===opts.seedSearchStringFromSelection){let selectionSearchString=getSelectionSearchString(this._editor,opts.seedSearchStringFromSelection,opts.seedSearchStringFromNonEmptySelection);selectionSearchString&&(this._state.isRegex?stateChanges.searchString=strings.escapeRegExpCharacters(selectionSearchString):stateChanges.searchString=selectionSearchString)}else if("multiple"===opts.seedSearchStringFromSelection&&!opts.updateSearchScope){let selectionSearchString=getSelectionSearchString(this._editor,opts.seedSearchStringFromSelection);selectionSearchString&&(stateChanges.searchString=selectionSearchString)}if(!stateChanges.searchString&&opts.seedSearchStringFromGlobalClipboard){let selectionSearchString=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;selectionSearchString&&(stateChanges.searchString=selectionSearchString)}if(opts.forceRevealReplace||stateChanges.isReplaceRevealed?stateChanges.isReplaceRevealed=!0:this._findWidgetVisible.get()||(stateChanges.isReplaceRevealed=!1),opts.updateSearchScope){let currentSelections=this._editor.getSelections();currentSelections.some((selection=>!selection.isEmpty()))&&(stateChanges.searchScope=currentSelections)}stateChanges.loop=opts.loop,this._state.change(stateChanges,!1),this._model||(this._model=new findModel_1.FindModelBoundToEditorModel(this._editor,this._state))}))}start(opts,newState){return this._start(opts,newState)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return __awaiter(this,void 0,void 0,(function*(){return this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(text){this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(text)}};CommonFindController.ID="editor.contrib.findController",CommonFindController=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,storage_1.IStorageService),__param(3,clipboardService_1.IClipboardService)],CommonFindController),exports.CommonFindController=CommonFindController;let FindController=class FindController extends CommonFindController{constructor(editor,_contextViewService,_contextKeyService,_keybindingService,_themeService,_notificationService,_storageService,clipboardService){super(editor,_contextKeyService,_storageService,clipboardService),this._contextViewService=_contextViewService,this._keybindingService=_keybindingService,this._themeService=_themeService,this._notificationService=_notificationService,this._widget=null,this._findOptionsWidget=null}_start(opts,newState){const _super=Object.create(null,{_start:{get:()=>super._start}});return __awaiter(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const selection=this._editor.getSelection();let updateSearchScope=!1;switch(this._editor.getOption(35).autoFindInSelection){case"always":updateSearchScope=!0;break;case"never":updateSearchScope=!1;break;case"multiline":updateSearchScope=!!selection&&selection.startLineNumber!==selection.endLineNumber;break}opts.updateSearchScope=opts.updateSearchScope||updateSearchScope,yield _super._start.call(this,opts,newState),this._widget&&(2===opts.shouldFocus?this._widget.focusReplaceInput():1===opts.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(ignoreWhenVisible=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!ignoreWhenVisible?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new findWidget_1.FindWidget(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new findOptionsWidget_1.FindOptionsWidget(this._editor,this._state,this._keybindingService,this._themeService))}};FindController=__decorate([__param(1,contextView_1.IContextViewService),__param(2,contextkey_1.IContextKeyService),__param(3,keybinding_1.IKeybindingService),__param(4,themeService_1.IThemeService),__param(5,notification_1.INotificationService),__param(6,storage_1.IStorageService),__param(7,clipboardService_1.IClipboardService)],FindController),exports.FindController=FindController,exports.StartFindAction=(0,editorExtensions_1.registerMultiEditorAction)(new editorExtensions_1.MultiEditorAction({id:findModel_1.FIND_IDS.StartFindAction,label:nls.localize(0,null),alias:"Find",precondition:contextkey_1.ContextKeyExpr.or(editorContextKeys_1.EditorContextKeys.focus,contextkey_1.ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarEditMenu,group:"3_find",title:nls.localize(1,null),order:1}})),exports.StartFindAction.addImplementation(0,((accessor,editor,args)=>{const controller=CommonFindController.get(editor);return!!controller&&controller.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==editor.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===editor.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:editor.getOption(35).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:editor.getOption(35).loop})}));const findArgDescription={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:nls.localize(2,null)},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:nls.localize(3,null)},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:nls.localize(4,null)},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:nls.localize(5,null)},findInSelection:{type:"boolean"}}}}]};class StartFindWithArgsAction extends editorExtensions_1.EditorAction{constructor(){super({id:findModel_1.FIND_IDS.StartFindWithArgs,label:nls.localize(6,null),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:findArgDescription})}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){const controller=CommonFindController.get(editor);if(controller){const newState=args?{searchString:args.searchString,replaceString:args.replaceString,isReplaceRevealed:void 0!==args.replaceString,isRegex:args.isRegex,wholeWord:args.matchWholeWord,matchCase:args.isCaseSensitive,preserveCase:args.preserveCase}:{};yield controller.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===controller.getState().searchString.length&&"never"!==editor.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===editor.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(null==args?void 0:args.findInSelection)||!1,loop:editor.getOption(35).loop},newState),controller.setGlobalBufferTerm(controller.getState().searchString)}}))}}exports.StartFindWithArgsAction=StartFindWithArgsAction;class StartFindWithSelectionAction extends editorExtensions_1.EditorAction{constructor(){super({id:findModel_1.FIND_IDS.StartFindWithSelection,label:nls.localize(7,null),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=CommonFindController.get(editor);controller&&(yield controller.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:editor.getOption(35).loop}),controller.setGlobalBufferTerm(controller.getState().searchString))}))}}exports.StartFindWithSelectionAction=StartFindWithSelectionAction;class MatchFindAction extends editorExtensions_1.EditorAction{run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=CommonFindController.get(editor);controller&&!this._run(controller)&&(yield controller.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===controller.getState().searchString.length&&"never"!==editor.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===editor.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:editor.getOption(35).loop}),this._run(controller))}))}}exports.MatchFindAction=MatchFindAction;class NextMatchFindAction extends MatchFindAction{constructor(){super({id:findModel_1.FIND_IDS.NextMatchFindAction,label:nls.localize(8,null),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.focus,findModel_1.CONTEXT_FIND_INPUT_FOCUSED),primary:3,weight:100}]})}_run(controller){return!!controller.moveToNextMatch()&&(controller.editor.pushUndoStop(),!0)}}exports.NextMatchFindAction=NextMatchFindAction;class PreviousMatchFindAction extends MatchFindAction{constructor(){super({id:findModel_1.FIND_IDS.PreviousMatchFindAction,label:nls.localize(9,null),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.focus,findModel_1.CONTEXT_FIND_INPUT_FOCUSED),primary:1027,weight:100}]})}_run(controller){return controller.moveToPrevMatch()}}exports.PreviousMatchFindAction=PreviousMatchFindAction;class SelectionMatchFindAction extends editorExtensions_1.EditorAction{run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=CommonFindController.get(editor);if(!controller)return;const seedSearchStringFromNonEmptySelection="selection"===editor.getOption(35).seedSearchStringFromSelection;let selectionSearchString=null;"never"!==editor.getOption(35).seedSearchStringFromSelection&&(selectionSearchString=getSelectionSearchString(editor,"single",seedSearchStringFromNonEmptySelection)),selectionSearchString&&controller.setSearchString(selectionSearchString),this._run(controller)||(yield controller.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==editor.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:editor.getOption(35).loop}),this._run(controller))}))}}exports.SelectionMatchFindAction=SelectionMatchFindAction;class NextSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:findModel_1.FIND_IDS.NextSelectionMatchFindAction,label:nls.localize(10,null),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:2109,weight:100}})}_run(controller){return controller.moveToNextMatch()}}exports.NextSelectionMatchFindAction=NextSelectionMatchFindAction;class PreviousSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:findModel_1.FIND_IDS.PreviousSelectionMatchFindAction,label:nls.localize(11,null),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:3133,weight:100}})}_run(controller){return controller.moveToPrevMatch()}}exports.PreviousSelectionMatchFindAction=PreviousSelectionMatchFindAction,exports.StartFindReplaceAction=(0,editorExtensions_1.registerMultiEditorAction)(new editorExtensions_1.MultiEditorAction({id:findModel_1.FIND_IDS.StartFindReplaceAction,label:nls.localize(12,null),alias:"Replace",precondition:contextkey_1.ContextKeyExpr.or(editorContextKeys_1.EditorContextKeys.focus,contextkey_1.ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarEditMenu,group:"3_find",title:nls.localize(13,null),order:2}})),exports.StartFindReplaceAction.addImplementation(0,((accessor,editor,args)=>{if(!editor.hasModel()||editor.getOption(81))return!1;const controller=CommonFindController.get(editor);if(!controller)return!1;const currentSelection=editor.getSelection(),findInputFocused=controller.isFindInputFocused(),seedSearchStringFromSelection=!currentSelection.isEmpty()&&currentSelection.startLineNumber===currentSelection.endLineNumber&&"never"!==editor.getOption(35).seedSearchStringFromSelection&&!findInputFocused,shouldFocus=findInputFocused||seedSearchStringFromSelection?2:1;return controller.start({forceRevealReplace:!0,seedSearchStringFromSelection:seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===editor.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==editor.getOption(35).seedSearchStringFromSelection,shouldFocus,shouldAnimate:!0,updateSearchScope:!1,loop:editor.getOption(35).loop})})),(0,editorExtensions_1.registerEditorContribution)(CommonFindController.ID,FindController),(0,editorExtensions_1.registerEditorAction)(StartFindWithArgsAction),(0,editorExtensions_1.registerEditorAction)(StartFindWithSelectionAction),(0,editorExtensions_1.registerEditorAction)(NextMatchFindAction),(0,editorExtensions_1.registerEditorAction)(PreviousMatchFindAction),(0,editorExtensions_1.registerEditorAction)(NextSelectionMatchFindAction),(0,editorExtensions_1.registerEditorAction)(PreviousSelectionMatchFindAction);const FindCommand=editorExtensions_1.EditorCommand.bindToContribution(CommonFindController.get);(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.CloseFindWidgetCommand,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.closeFindWidget(),kbOpts:{weight:105,kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.focus,contextkey_1.ContextKeyExpr.not("isComposing")),primary:9,secondary:[1033]}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ToggleCaseSensitiveCommand,precondition:void 0,handler:x=>x.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:findModel_1.ToggleCaseSensitiveKeybinding.primary,mac:findModel_1.ToggleCaseSensitiveKeybinding.mac,win:findModel_1.ToggleCaseSensitiveKeybinding.win,linux:findModel_1.ToggleCaseSensitiveKeybinding.linux}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ToggleWholeWordCommand,precondition:void 0,handler:x=>x.toggleWholeWords(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:findModel_1.ToggleWholeWordKeybinding.primary,mac:findModel_1.ToggleWholeWordKeybinding.mac,win:findModel_1.ToggleWholeWordKeybinding.win,linux:findModel_1.ToggleWholeWordKeybinding.linux}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ToggleRegexCommand,precondition:void 0,handler:x=>x.toggleRegex(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:findModel_1.ToggleRegexKeybinding.primary,mac:findModel_1.ToggleRegexKeybinding.mac,win:findModel_1.ToggleRegexKeybinding.win,linux:findModel_1.ToggleRegexKeybinding.linux}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ToggleSearchScopeCommand,precondition:void 0,handler:x=>x.toggleSearchScope(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:findModel_1.ToggleSearchScopeKeybinding.primary,mac:findModel_1.ToggleSearchScopeKeybinding.mac,win:findModel_1.ToggleSearchScopeKeybinding.win,linux:findModel_1.ToggleSearchScopeKeybinding.linux}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.TogglePreserveCaseCommand,precondition:void 0,handler:x=>x.togglePreserveCase(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:findModel_1.TogglePreserveCaseKeybinding.primary,mac:findModel_1.TogglePreserveCaseKeybinding.mac,win:findModel_1.TogglePreserveCaseKeybinding.win,linux:findModel_1.TogglePreserveCaseKeybinding.linux}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ReplaceOneAction,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.replace(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:3094}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ReplaceOneAction,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.replace(),kbOpts:{weight:105,kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.focus,findModel_1.CONTEXT_REPLACE_INPUT_FOCUSED),primary:3}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ReplaceAllAction,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.replaceAll(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:2563}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.ReplaceAllAction,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.replaceAll(),kbOpts:{weight:105,kbExpr:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.focus,findModel_1.CONTEXT_REPLACE_INPUT_FOCUSED),primary:void 0,mac:{primary:2051}}})),(0,editorExtensions_1.registerEditorCommand)(new FindCommand({id:findModel_1.FIND_IDS.SelectAllMatchesAction,precondition:findModel_1.CONTEXT_FIND_WIDGET_VISIBLE,handler:x=>x.selectAllMatches(),kbOpts:{weight:105,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:515}}))})),define(__m[726],__M([1,0,28,38,539,74,14]),(function(require,exports,codicons_1,textModel_1,nls_1,iconRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FoldingDecorationProvider=exports.foldingCollapsedIcon=exports.foldingExpandedIcon=void 0,exports.foldingExpandedIcon=(0,iconRegistry_1.registerIcon)("folding-expanded",codicons_1.Codicon.chevronDown,(0,nls_1.localize)(0,null)),exports.foldingCollapsedIcon=(0,iconRegistry_1.registerIcon)("folding-collapsed",codicons_1.Codicon.chevronRight,(0,nls_1.localize)(1,null));class FoldingDecorationProvider{constructor(editor){this.editor=editor,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(isCollapsed,isHidden){return isHidden?FoldingDecorationProvider.HIDDEN_RANGE_DECORATION:isCollapsed?this.showFoldingHighlights?FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION}deltaDecorations(oldDecorations,newDecorations){return this.editor.deltaDecorations(oldDecorations,newDecorations)}changeDecorations(callback){return this.editor.changeDecorations(callback)}}exports.FoldingDecorationProvider=FoldingDecorationProvider,FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION=textModel_1.ModelDecorationOptions.register({description:"folding-collapsed-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:themeService_1.ThemeIcon.asClassName(exports.foldingCollapsedIcon)}),FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=textModel_1.ModelDecorationOptions.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",className:"folded-background",isWholeLine:!0,firstLineDecorationClassName:themeService_1.ThemeIcon.asClassName(exports.foldingCollapsedIcon)}),FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=textModel_1.ModelDecorationOptions.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:themeService_1.ThemeIcon.asClassName(exports.foldingExpandedIcon)}),FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION=textModel_1.ModelDecorationOptions.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+themeService_1.ThemeIcon.asClassName(exports.foldingExpandedIcon)}),FoldingDecorationProvider.HIDDEN_RANGE_DECORATION=textModel_1.ModelDecorationOptions.register({description:"folding-hidden-range-decoration",stickiness:1})})),define(__m[727],__M([1,0,10,13,58,2,8,19,146,15,24,27,33,463,464,465,466,538,17,23,14,726,258,39,76,67,55,20,378]),(function(require,exports,async_1,errors_1,keyCodes_1,lifecycle_1,strings_1,types,stableEditorScroll_1,editorExtensions_1,editorContextKeys_1,languages_1,languageConfigurationRegistry_1,foldingModel_1,hiddenRangeModel_1,indentRangeProvider_1,intializingRangeProvider_1,nls,contextkey_1,colorRegistry_1,themeService_1,foldingDecorations_1,syntaxRangeProvider_1,notification_1,severity_1,languageFeatureDebounce_1,stopwatch_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorFoldForeground=exports.foldBackgroundBackground=exports.FoldingController=void 0;const CONTEXT_FOLDING_ENABLED=new contextkey_1.RawContextKey("foldingEnabled",!1);let FoldingController=class FoldingController extends lifecycle_1.Disposable{constructor(editor,contextKeyService,languageConfigurationService,notificationService,languageFeatureDebounceService,languageFeaturesService){super(),this.contextKeyService=contextKeyService,this.languageConfigurationService=languageConfigurationService,this.languageFeaturesService=languageFeaturesService,this._tooManyRegionsNotified=!1,this.localToDispose=this._register(new lifecycle_1.DisposableStore),this.editor=editor;const options=this.editor.getOptions();this._isEnabled=options.get(37),this._useFoldingProviders="indentation"!==options.get(38),this._unfoldOnClickAfterEndOfLine=options.get(42),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=options.get(40),this._maxFoldingRegions=options.get(41),this.updateDebounceInfo=languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new foldingDecorations_1.FoldingDecorationProvider(editor),this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===options.get(99),this.foldingDecorationProvider.showFoldingHighlights=options.get(39),this.foldingEnabled=CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._notifyTooManyRegions=maxFoldingRegions=>{this._tooManyRegionsNotified||(notificationService.notify({severity:severity_1.default.Warning,sticky:!0,message:nls.localize(0,null,maxFoldingRegions)}),this._tooManyRegionsNotified=!0)},this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((e=>{if(e.hasChanged(37)&&(this._isEnabled=this.editor.getOptions().get(37),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(41)&&(this._maxFoldingRegions=this.editor.getOptions().get(41),this._tooManyRegionsNotified=!1,this.onModelChanged()),e.hasChanged(99)||e.hasChanged(39)){const options=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===options.get(99),this.foldingDecorationProvider.showFoldingHighlights=options.get(39),this.triggerFoldingModelChanged()}e.hasChanged(38)&&(this._useFoldingProviders="indentation"!==this.editor.getOptions().get(38),this.onFoldingStrategyChanged()),e.hasChanged(42)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(42)),e.hasChanged(40)&&(this._foldingImportsByDefault=this.editor.getOptions().get(40))}))),this.onModelChanged()}static get(editor){return editor.getContribution(FoldingController.ID)}saveViewState(){let model=this.editor.getModel();if(!model||!this._isEnabled||model.isTooLargeForTokenization())return{};if(this.foldingModel){let collapsedRegions=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),provider=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions,lineCount:model.getLineCount(),provider,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(state){let model=this.editor.getModel();if(!model||!this._isEnabled||model.isTooLargeForTokenization()||!this.hiddenRangeModel)return;if(!state||state.lineCount!==model.getLineCount())return;if(this._currentModelHasFoldedImports=!!state.foldedImports,!state.collapsedRegions)return;state.provider!==syntaxRangeProvider_1.ID_SYNTAX_PROVIDER&&state.provider!==intializingRangeProvider_1.ID_INIT_PROVIDER||(this.foldingStateMemento=state);const collapsedRegions=state.collapsedRegions;if(this.hiddenRangeModel.applyMemento(collapsedRegions)){const foldingModel=this.getFoldingModel();foldingModel&&foldingModel.then((foldingModel=>{if(foldingModel){this._restoringViewState=!0;try{foldingModel.applyMemento(collapsedRegions)}finally{this._restoringViewState=!1}}})).then(void 0,errors_1.onUnexpectedError)}}onModelChanged(){this.localToDispose.clear();let model=this.editor.getModel();this._isEnabled&&model&&!model.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new foldingModel_1.FoldingModel(model,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new hiddenRangeModel_1.HiddenRangeModel(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((hr=>this.onHiddenRangesChanges(hr)))),this.updateScheduler=new async_1.Delayer(this.updateDebounceInfo.get(model)),this.cursorChangedScheduler=new async_1.RunOnceScheduler((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((e=>this.onDidChangeModelContent(e)))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.localToDispose.add(this.editor.onMouseUp((e=>this.onEditorMouseUp(e)))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(editorModel){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new indentRangeProvider_1.IndentRangeProvider(editorModel,this.languageConfigurationService,this._maxFoldingRegions),this._useFoldingProviders&&this.foldingModel){let foldingProviders=this.languageFeaturesService.foldingRangeProvider.ordered(this.foldingModel.textModel);if(0===foldingProviders.length&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions){return this.rangeProvider=new intializingRangeProvider_1.InitializingRangeProvider(editorModel,this.foldingStateMemento.collapsedRegions,(()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()}),3e4)}foldingProviders.length>0&&(this.rangeProvider=new syntaxRangeProvider_1.SyntaxRangeProvider(editorModel,foldingProviders,(()=>this.triggerFoldingModelChanged()),this._maxFoldingRegions))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var _a;null===(_a=this.hiddenRangeModel)||void 0===_a||_a.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const foldingModel=this.foldingModel;if(!foldingModel)return null;const sw=new stopwatch_1.StopWatch(!0),provider=this.getRangeProvider(foldingModel.textModel);let foldingRegionPromise=this.foldingRegionPromise=(0,async_1.createCancelablePromise)((token=>provider.compute(token,this._notifyTooManyRegions)));return foldingRegionPromise.then((foldingRanges=>{if(foldingRanges&&foldingRegionPromise===this.foldingRegionPromise){let scrollState;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const hasChanges=foldingRanges.setCollapsedAllOfType(languages_1.FoldingRangeKind.Imports.value,!0);hasChanges&&(scrollState=stableEditorScroll_1.StableEditorScrollState.capture(this.editor),this._currentModelHasFoldedImports=hasChanges)}let selections=this.editor.getSelections(),selectionLineNumbers=selections?selections.map((s=>s.startLineNumber)):[];foldingModel.update(foldingRanges,selectionLineNumbers),scrollState&&scrollState.restore(this.editor);const newValue=this.updateDebounceInfo.update(foldingModel.textModel,sw.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=newValue)}return foldingModel}))})).then(void 0,(err=>((0,errors_1.onUnexpectedError)(err),null))))}onHiddenRangesChanges(hiddenRanges){if(this.hiddenRangeModel&&hiddenRanges.length&&!this._restoringViewState){let selections=this.editor.getSelections();selections&&this.hiddenRangeModel.adjustSelections(selections)&&this.editor.setSelections(selections)}this.editor.setHiddenAreas(hiddenRanges)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const foldingModel=this.getFoldingModel();foldingModel&&foldingModel.then((foldingModel=>{if(foldingModel){let selections=this.editor.getSelections();if(selections&&selections.length>0){let toToggle=[];for(let selection of selections){let lineNumber=selection.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(lineNumber)&&toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber,(r=>r.isCollapsed&&lineNumber>r.startLineNumber)))}toToggle.length&&(foldingModel.toggleCollapseState(toToggle),this.reveal(selections[0].getPosition()))}}})).then(void 0,errors_1.onUnexpectedError)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range)return;if(!e.event.leftButton&&!e.event.middleButton)return;const range=e.target.range;let iconClicked=!1;switch(e.target.type){case 4:{const data=e.target.detail,offsetLeftInGutter=e.target.element.offsetLeft;if(data.offsetX-offsetLeftInGutter<5)return;iconClicked=!0;break}case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()){if(!e.target.detail.isAfterLines)break}return;case 6:if(this.hiddenRangeModel.hasRanges()){let model=this.editor.getModel();if(model&&range.startColumn===model.getLineMaxColumn(range.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:range.startLineNumber,iconClicked}}onEditorMouseUp(e){const foldingModel=this.getFoldingModel();if(!foldingModel||!this.mouseDownInfo||!e.target)return;let lineNumber=this.mouseDownInfo.lineNumber,iconClicked=this.mouseDownInfo.iconClicked,range=e.target.range;if(range&&range.startLineNumber===lineNumber){if(iconClicked){if(4!==e.target.type)return}else{let model=this.editor.getModel();if(!model||range.startColumn!==model.getLineMaxColumn(lineNumber))return}foldingModel.then((foldingModel=>{if(foldingModel){let region=foldingModel.getRegionAtLine(lineNumber);if(region&&region.startLineNumber===lineNumber){let isCollapsed=region.isCollapsed;if(iconClicked||isCollapsed){let toToggle=[];if(e.event.altKey){let filter=otherRegion=>!otherRegion.containedBy(region)&&!region.containedBy(otherRegion),toMaybeToggle=foldingModel.getRegionsInside(null,filter);for(const r of toMaybeToggle)r.isCollapsed&&toToggle.push(r);0===toToggle.length&&(toToggle=toMaybeToggle)}else{let recursive=e.event.middleButton||e.event.shiftKey;if(recursive)for(const r of foldingModel.getRegionsInside(region))r.isCollapsed===isCollapsed&&toToggle.push(r);!isCollapsed&&recursive&&0!==toToggle.length||toToggle.push(region)}foldingModel.toggleCollapseState(toToggle),this.reveal({lineNumber,column:1})}}}})).then(void 0,errors_1.onUnexpectedError)}}reveal(position){this.editor.revealPositionInCenterIfOutsideViewport(position,0)}};FoldingController.ID="editor.contrib.folding",FoldingController=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(3,notification_1.INotificationService),__param(4,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(5,languageFeatures_1.ILanguageFeaturesService)],FoldingController),exports.FoldingController=FoldingController;class FoldingAction extends editorExtensions_1.EditorAction{runEditorCommand(accessor,editor,args){const languageConfigurationService=accessor.get(languageConfigurationRegistry_1.ILanguageConfigurationService),foldingController=FoldingController.get(editor);if(!foldingController)return;const foldingModelPromise=foldingController.getFoldingModel();return foldingModelPromise?(this.reportTelemetry(accessor,editor),foldingModelPromise.then((foldingModel=>{if(foldingModel){this.invoke(foldingController,foldingModel,editor,args,languageConfigurationService);const selection=editor.getSelection();selection&&foldingController.reveal(selection.getStartPosition())}}))):void 0}getSelectedLines(editor){let selections=editor.getSelections();return selections?selections.map((s=>s.startLineNumber)):[]}getLineNumbers(args,editor){return args&&args.selectionLines?args.selectionLines.map((l=>l+1)):this.getSelectedLines(editor)}run(_accessor,_editor){}}function foldingArgumentsConstraint(args){if(!types.isUndefined(args)){if(!types.isObject(args))return!1;const foldingArgs=args;if(!types.isUndefined(foldingArgs.levels)&&!types.isNumber(foldingArgs.levels))return!1;if(!types.isUndefined(foldingArgs.direction)&&!types.isString(foldingArgs.direction))return!1;if(!(types.isUndefined(foldingArgs.selectionLines)||types.isArray(foldingArgs.selectionLines)&&foldingArgs.selectionLines.every(types.isNumber)))return!1}return!0}class FoldLevelAction extends FoldingAction{getFoldingLevel(){return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length))}invoke(_foldingController,foldingModel,editor){(0,foldingModel_1.setCollapseStateAtLevel)(foldingModel,this.getFoldingLevel(),!0,this.getSelectedLines(editor))}}FoldLevelAction.ID_PREFIX="editor.foldLevel",FoldLevelAction.ID=level=>FoldLevelAction.ID_PREFIX+level;(0,editorExtensions_1.registerEditorContribution)(FoldingController.ID,FoldingController),(0,editorExtensions_1.registerEditorAction)(class UnfoldAction extends FoldingAction{constructor(){super({id:"editor.unfold",label:nls.localize(1,null),alias:"Unfold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(_foldingController,foldingModel,editor,args){let levels=args&&args.levels||1,lineNumbers=this.getLineNumbers(args,editor);args&&"up"===args.direction?(0,foldingModel_1.setCollapseStateLevelsUp)(foldingModel,!1,levels,lineNumbers):(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!1,levels,lineNumbers)}}),(0,editorExtensions_1.registerEditorAction)(class UnFoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.unfoldRecursively",label:nls.localize(2,null),alias:"Unfold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2137),weight:100}})}invoke(_foldingController,foldingModel,editor,_args){(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!1,Number.MAX_VALUE,this.getSelectedLines(editor))}}),(0,editorExtensions_1.registerEditorAction)(class FoldAction extends FoldingAction{constructor(){super({id:"editor.fold",label:nls.localize(3,null),alias:"Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(_foldingController,foldingModel,editor,args){let lineNumbers=this.getLineNumbers(args,editor);const levels=args&&args.levels,direction=args&&args.direction;"number"!=typeof levels&&"string"!=typeof direction?(0,foldingModel_1.setCollapseStateUp)(foldingModel,!0,lineNumbers):"up"===direction?(0,foldingModel_1.setCollapseStateLevelsUp)(foldingModel,!0,levels||1,lineNumbers):(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!0,levels||1,lineNumbers)}}),(0,editorExtensions_1.registerEditorAction)(class FoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.foldRecursively",label:nls.localize(5,null),alias:"Fold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2135),weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!0,Number.MAX_VALUE,selectedLines)}}),(0,editorExtensions_1.registerEditorAction)(class FoldAllAction extends FoldingAction{constructor(){super({id:"editor.foldAll",label:nls.localize(11,null),alias:"Fold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2069),weight:100}})}invoke(_foldingController,foldingModel,_editor){(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!0)}}),(0,editorExtensions_1.registerEditorAction)(class UnfoldAllAction extends FoldingAction{constructor(){super({id:"editor.unfoldAll",label:nls.localize(12,null),alias:"Unfold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2088),weight:100}})}invoke(_foldingController,foldingModel,_editor){(0,foldingModel_1.setCollapseStateLevelsDown)(foldingModel,!1)}}),(0,editorExtensions_1.registerEditorAction)(class FoldAllBlockCommentsAction extends FoldingAction{constructor(){super({id:"editor.foldAllBlockComments",label:nls.localize(6,null),alias:"Fold All Block Comments",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2133),weight:100}})}invoke(_foldingController,foldingModel,editor,args,languageConfigurationService){if(foldingModel.regions.hasTypes())(0,foldingModel_1.setCollapseStateForType)(foldingModel,languages_1.FoldingRangeKind.Comment.value,!0);else{const editorModel=editor.getModel();if(!editorModel)return;const comments=languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;if(comments&&comments.blockCommentStartToken){let regExp=new RegExp("^\\s*"+(0,strings_1.escapeRegExpCharacters)(comments.blockCommentStartToken));(0,foldingModel_1.setCollapseStateForMatchingLines)(foldingModel,regExp,!0)}}}}),(0,editorExtensions_1.registerEditorAction)(class FoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.foldAllMarkerRegions",label:nls.localize(7,null),alias:"Fold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2077),weight:100}})}invoke(_foldingController,foldingModel,editor,args,languageConfigurationService){if(foldingModel.regions.hasTypes())(0,foldingModel_1.setCollapseStateForType)(foldingModel,languages_1.FoldingRangeKind.Region.value,!0);else{const editorModel=editor.getModel();if(!editorModel)return;const foldingRules=languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;if(foldingRules&&foldingRules.markers&&foldingRules.markers.start){let regExp=new RegExp(foldingRules.markers.start);(0,foldingModel_1.setCollapseStateForMatchingLines)(foldingModel,regExp,!0)}}}}),(0,editorExtensions_1.registerEditorAction)(class UnfoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:nls.localize(8,null),alias:"Unfold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2078),weight:100}})}invoke(_foldingController,foldingModel,editor,args,languageConfigurationService){if(foldingModel.regions.hasTypes())(0,foldingModel_1.setCollapseStateForType)(foldingModel,languages_1.FoldingRangeKind.Region.value,!1);else{const editorModel=editor.getModel();if(!editorModel)return;const foldingRules=languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;if(foldingRules&&foldingRules.markers&&foldingRules.markers.start){let regExp=new RegExp(foldingRules.markers.start);(0,foldingModel_1.setCollapseStateForMatchingLines)(foldingModel,regExp,!1)}}}}),(0,editorExtensions_1.registerEditorAction)(class FoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.foldAllExcept",label:nls.localize(9,null),alias:"Fold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2131),weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);(0,foldingModel_1.setCollapseStateForRest)(foldingModel,!0,selectedLines)}}),(0,editorExtensions_1.registerEditorAction)(class UnfoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllExcept",label:nls.localize(10,null),alias:"Unfold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2129),weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);(0,foldingModel_1.setCollapseStateForRest)(foldingModel,!1,selectedLines)}}),(0,editorExtensions_1.registerEditorAction)(class ToggleFoldAction extends FoldingAction{constructor(){super({id:"editor.toggleFold",label:nls.localize(4,null),alias:"Toggle Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2090),weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);(0,foldingModel_1.toggleCollapseState)(foldingModel,1,selectedLines)}}),(0,editorExtensions_1.registerEditorAction)(class GotoParentFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoParentFold",label:nls.localize(13,null),alias:"Go to Parent Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);if(selectedLines.length>0){let startLineNumber=(0,foldingModel_1.getParentFoldLine)(selectedLines[0],foldingModel);null!==startLineNumber&&editor.setSelection({startLineNumber,startColumn:1,endLineNumber:startLineNumber,endColumn:1})}}}),(0,editorExtensions_1.registerEditorAction)(class GotoPreviousFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoPreviousFold",label:nls.localize(14,null),alias:"Go to Previous Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);if(selectedLines.length>0){let startLineNumber=(0,foldingModel_1.getPreviousFoldLine)(selectedLines[0],foldingModel);null!==startLineNumber&&editor.setSelection({startLineNumber,startColumn:1,endLineNumber:startLineNumber,endColumn:1})}}}),(0,editorExtensions_1.registerEditorAction)(class GotoNextFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoNextFold",label:nls.localize(15,null),alias:"Go to Next Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,weight:100}})}invoke(_foldingController,foldingModel,editor){let selectedLines=this.getSelectedLines(editor);if(selectedLines.length>0){let startLineNumber=(0,foldingModel_1.getNextFoldLine)(selectedLines[0],foldingModel);null!==startLineNumber&&editor.setSelection({startLineNumber,startColumn:1,endLineNumber:startLineNumber,endColumn:1})}}});for(let i=1;i<=7;i++)(0,editorExtensions_1.registerInstantiatedEditorAction)(new FoldLevelAction({id:FoldLevelAction.ID(i),label:nls.localize(16,null,i),alias:`Fold Level ${i}`,precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2048|21+i),weight:100}}));exports.foldBackgroundBackground=(0,colorRegistry_1.registerColor)("editor.foldBackground",{light:(0,colorRegistry_1.transparent)(colorRegistry_1.editorSelectionBackground,.3),dark:(0,colorRegistry_1.transparent)(colorRegistry_1.editorSelectionBackground,.3),hc:null},nls.localize(17,null),!0),exports.editorFoldForeground=(0,colorRegistry_1.registerColor)("editorGutter.foldingControlForeground",{dark:colorRegistry_1.iconForeground,light:colorRegistry_1.iconForeground,hc:colorRegistry_1.iconForeground},nls.localize(18,null)),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const foldBackground=theme.getColor(exports.foldBackgroundBackground);foldBackground&&collector.addRule(`.monaco-editor .folded-background { background-color: ${foldBackground}; }`);const editorFoldColor=theme.getColor(exports.editorFoldForeground);editorFoldColor&&collector.addRule(`\n\t\t.monaco-editor .cldr${themeService_1.ThemeIcon.asCSSSelector(foldingDecorations_1.foldingExpandedIcon)},\n\t\t.monaco-editor .cldr${themeService_1.ThemeIcon.asCSSSelector(foldingDecorations_1.foldingCollapsedIcon)} {\n\t\t\tcolor: ${editorFoldColor} !important;\n\t\t}\n\t\t`)}))})),define(__m[728],__M([1,0,7,230,18,2,11,3,38,27,260,86,17,9,43,109,10,24,4]),(function(require,exports,dom,hoverWidget_1,arrays_1,lifecycle_1,position_1,range_1,textModel_1,languages_1,hoverOperation_1,hoverTypes_1,contextkey_1,instantiation_1,keybinding_1,suggest_1,async_1,editorContextKeys_1,event_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContentHoverWidget=exports.ContentHoverController=void 0;const $=dom.$;let ContentHoverController=class ContentHoverController extends lifecycle_1.Disposable{constructor(_editor,_instantiationService,_keybindingService){super(),this._editor=_editor,this._instantiationService=_instantiationService,this._keybindingService=_keybindingService,this._widget=this._register(this._instantiationService.createInstance(ContentHoverWidget,this._editor)),this._decorationsChangerListener=this._register(new EditorDecorationsChangerListener(this._editor)),this._messages=[],this._messagesAreComplete=!1,this._participants=[];for(const participant of hoverTypes_1.HoverParticipantRegistry.getAll())this._participants.push(this._instantiationService.createInstance(participant,this._editor));this._participants.sort(((p1,p2)=>p1.hoverOrdinal-p2.hoverOrdinal)),this._computer=new ContentHoverComputer(this._editor,this._participants),this._hoverOperation=this._register(new hoverOperation_1.HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult((result=>{this._withResult(result.value,result.isComplete,result.hasLoadingMessage)}))),this._register(this._decorationsChangerListener.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(dom.addStandardDisposableListener(this._widget.getDomNode(),"keydown",(e=>{e.equals(9)&&this.hide()}))),this._register(languages_1.TokenizationRegistry.onDidChange((()=>{this._widget.position&&this._computer.anchor&&this._messages.length>0&&(this._widget.clear(),this._renderMessages(this._computer.anchor,this._messages))})))}_onModelDecorationsChanged(){this._widget.position&&(this._hoverOperation.cancel(),this._widget.isColorPickerVisible||this._hoverOperation.start(0))}maybeShowAt(mouseEvent){const anchorCandidates=[];for(const participant of this._participants)if(participant.suggestHoverAnchor){const anchor=participant.suggestHoverAnchor(mouseEvent);anchor&&anchorCandidates.push(anchor)}const target=mouseEvent.target;if(6===target.type&&anchorCandidates.push(new hoverTypes_1.HoverRangeAnchor(0,target.range)),7===target.type){const epsilon=this._editor.getOption(44).typicalHalfwidthCharacterWidth/2;!target.detail.isAfterLines&&"number"==typeof target.detail.horizontalDistanceToText&&target.detail.horizontalDistanceToText<epsilon&&anchorCandidates.push(new hoverTypes_1.HoverRangeAnchor(0,target.range))}return 0!==anchorCandidates.length&&(anchorCandidates.sort(((a,b)=>b.priority-a.priority)),this._startShowingAt(anchorCandidates[0],0,!1),!0)}startShowingAtRange(range,mode,focus){this._startShowingAt(new hoverTypes_1.HoverRangeAnchor(0,range),mode,focus)}_startShowingAt(anchor,mode,focus){if(!this._computer.anchor||!this._computer.anchor.equals(anchor)){if(this._hoverOperation.cancel(),this._widget.position)if(this._computer.anchor&&anchor.canAdoptVisibleHover(this._computer.anchor,this._widget.position)){const filteredMessages=this._messages.filter((m=>m.isValidForHoverAnchor(anchor)));if(0===filteredMessages.length)this.hide();else{if(filteredMessages.length===this._messages.length&&this._messagesAreComplete)return;this._renderMessages(anchor,filteredMessages)}}else this.hide();this._computer.anchor=anchor,this._computer.shouldFocus=focus,this._hoverOperation.start(mode)}}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._widget.hide()}isColorPickerVisible(){return this._widget.isColorPickerVisible}_addLoadingMessage(result){if(this._computer.anchor)for(const participant of this._participants)if(participant.createLoadingMessage){const loadingMessage=participant.createLoadingMessage(this._computer.anchor);if(loadingMessage)return result.slice(0).concat([loadingMessage])}return result}_withResult(result,isComplete,hasLoadingMessage){this._messages=hasLoadingMessage?this._addLoadingMessage(result):result,this._messagesAreComplete=isComplete,this._computer.anchor&&this._messages.length>0?this._renderMessages(this._computer.anchor,this._messages):isComplete&&this.hide()}_renderMessages(anchor,messages){let renderColumn=1073741824,highlightRange=messages[0].range,forceShowAtRange=null;for(const msg of messages)renderColumn=Math.min(renderColumn,msg.range.startColumn),highlightRange=range_1.Range.plusRange(highlightRange,msg.range),msg.forceShowAtRange&&(forceShowAtRange=msg.range);const disposables=new lifecycle_1.DisposableStore,statusBar=disposables.add(new EditorHoverStatusBar(this._keybindingService)),fragment=document.createDocumentFragment();let colorPicker=null;const context={fragment,statusBar,setColorPicker:widget=>colorPicker=widget,onContentsChanged:()=>this._widget.onContentsChanged(),hide:()=>this.hide()};for(const participant of this._participants){const hoverParts=messages.filter((msg=>msg.owner===participant));hoverParts.length>0&&disposables.add(participant.renderHoverParts(context,hoverParts))}if(statusBar.hasContent&&fragment.appendChild(statusBar.hoverElement),fragment.hasChildNodes()){if(highlightRange){const highlightDecorations=this._decorationsChangerListener.deltaDecorations([],[{range:highlightRange,options:ContentHoverController._DECORATION_OPTIONS}]);disposables.add((0,lifecycle_1.toDisposable)((()=>{this._decorationsChangerListener.deltaDecorations(highlightDecorations,[])})))}this._widget.showAt(fragment,new ContentHoverVisibleData(colorPicker,forceShowAtRange?forceShowAtRange.getStartPosition():new position_1.Position(anchor.range.startLineNumber,renderColumn),forceShowAtRange||highlightRange,this._editor.getOption(53).above,this._computer.shouldFocus,disposables))}else disposables.dispose()}};ContentHoverController._DECORATION_OPTIONS=textModel_1.ModelDecorationOptions.register({description:"content-hover-highlight",className:"hoverHighlight"}),ContentHoverController=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,keybinding_1.IKeybindingService)],ContentHoverController),exports.ContentHoverController=ContentHoverController;class EditorDecorationsChangerListener extends lifecycle_1.Disposable{constructor(_editor){super(),this._editor=_editor,this._onDidChangeModelDecorations=this._register(new event_1.Emitter),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._isChangingDecorations=!1,this._register(this._editor.onDidChangeModelDecorations((e=>{this._isChangingDecorations||this._onDidChangeModelDecorations.fire(e)})))}deltaDecorations(oldDecorations,newDecorations){try{return this._isChangingDecorations=!0,this._editor.deltaDecorations(oldDecorations,newDecorations)}finally{this._isChangingDecorations=!1}}}class ContentHoverVisibleData{constructor(colorPicker,showAtPosition,showAtRange,preferAbove,stoleFocus,disposables){this.colorPicker=colorPicker,this.showAtPosition=showAtPosition,this.showAtRange=showAtRange,this.preferAbove=preferAbove,this.stoleFocus=stoleFocus,this.disposables=disposables}}let ContentHoverWidget=class ContentHoverWidget extends lifecycle_1.Disposable{constructor(_editor,_contextKeyService){super(),this._editor=_editor,this._contextKeyService=_contextKeyService,this.allowEditorOverflow=!0,this._hoverVisibleKey=editorContextKeys_1.EditorContextKeys.hoverVisible.bindTo(this._contextKeyService),this._hover=this._register(new hoverWidget_1.HoverWidget),this._visibleData=null,this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._setVisibleData(null),this._layout(),this._editor.addContentWidget(this)}get position(){var _a,_b;return null!==(_b=null===(_a=this._visibleData)||void 0===_a?void 0:_a.showAtPosition)&&void 0!==_b?_b:null}get isColorPickerVisible(){var _a;return Boolean(null===(_a=this._visibleData)||void 0===_a?void 0:_a.colorPicker)}dispose(){this._editor.removeContentWidget(this),this._visibleData&&this._visibleData.disposables.dispose(),super.dispose()}getId(){return ContentHoverWidget.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){if(!this._visibleData)return null;let preferAbove=this._visibleData.preferAbove;return!preferAbove&&this._contextKeyService.getContextKeyValue(suggest_1.Context.Visible.key)&&(preferAbove=!0),{position:this._visibleData.showAtPosition,range:this._visibleData.showAtRange,preference:preferAbove?[1,2]:[2,1]}}_setVisibleData(visibleData){this._visibleData&&this._visibleData.disposables.dispose(),this._visibleData=visibleData,this._hoverVisibleKey.set(!!this._visibleData),this._hover.containerDomNode.classList.toggle("hidden",!this._visibleData)}_layout(){const height=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize,lineHeight}=this._editor.getOption(44);this._hover.contentsDomNode.style.fontSize=`${fontSize}px`,this._hover.contentsDomNode.style.lineHeight=""+lineHeight/fontSize,this._hover.contentsDomNode.style.maxHeight=`${height}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((node=>this._editor.applyFontInfo(node)))}showAt(node,visibleData){this._setVisibleData(visibleData),this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(node),this._hover.contentsDomNode.style.paddingBottom="",this._updateFont(),this._editor.layoutContentWidget(this),this.onContentsChanged(),this._editor.render(),this._editor.layoutContentWidget(this),this.onContentsChanged(),visibleData.stoleFocus&&this._hover.containerDomNode.focus(),visibleData.colorPicker&&visibleData.colorPicker.layout()}hide(){if(this._visibleData){const stoleFocus=this._visibleData.stoleFocus;this._setVisibleData(null),this._editor.layoutContentWidget(this),stoleFocus&&this._editor.focus()}}onContentsChanged(){this._hover.onContentsChanged();const scrollDimensions=this._hover.scrollbar.getScrollDimensions();if(scrollDimensions.scrollWidth>scrollDimensions.width){const extraBottomPadding=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingBottom!==extraBottomPadding&&(this._hover.contentsDomNode.style.paddingBottom=extraBottomPadding,this._editor.layoutContentWidget(this),this._hover.onContentsChanged())}}clear(){this._hover.contentsDomNode.textContent=""}};ContentHoverWidget.ID="editor.contrib.contentHoverWidget",ContentHoverWidget=__decorate([__param(1,contextkey_1.IContextKeyService)],ContentHoverWidget),exports.ContentHoverWidget=ContentHoverWidget;let EditorHoverStatusBar=class EditorHoverStatusBar extends lifecycle_1.Disposable{constructor(_keybindingService){super(),this._keybindingService=_keybindingService,this._hasContent=!1,this.hoverElement=$("div.hover-row.status-bar"),this.actionsElement=dom.append(this.hoverElement,$("div.actions"))}get hasContent(){return this._hasContent}addAction(actionOptions){const keybinding=this._keybindingService.lookupKeybinding(actionOptions.commandId),keybindingLabel=keybinding?keybinding.getLabel():null;return this._hasContent=!0,this._register(hoverWidget_1.HoverAction.render(this.actionsElement,actionOptions,keybindingLabel))}append(element){const result=dom.append(this.actionsElement,element);return this._hasContent=!0,result}};EditorHoverStatusBar=__decorate([__param(0,keybinding_1.IKeybindingService)],EditorHoverStatusBar);class ContentHoverComputer{constructor(_editor,_participants){this._editor=_editor,this._participants=_participants,this._anchor=null,this._shouldFocus=!1}get anchor(){return this._anchor}set anchor(value){this._anchor=value}get shouldFocus(){return this._shouldFocus}set shouldFocus(value){this._shouldFocus=value}static _getLineDecorations(editor,anchor){if(1!==anchor.type)return[];const model=editor.getModel(),lineNumber=anchor.range.startLineNumber,maxColumn=model.getLineMaxColumn(lineNumber);return editor.getLineDecorations(lineNumber).filter((d=>{if(d.options.isWholeLine)return!0;const startColumn=d.range.startLineNumber===lineNumber?d.range.startColumn:1,endColumn=d.range.endLineNumber===lineNumber?d.range.endColumn:maxColumn;if(d.options.showIfCollapsed){if(startColumn>anchor.range.startColumn+1||anchor.range.endColumn-1>endColumn)return!1}else if(startColumn>anchor.range.startColumn||anchor.range.endColumn>endColumn)return!1;return!0}))}computeAsync(token){const anchor=this._anchor;if(!this._editor.hasModel()||!anchor)return async_1.AsyncIterableObject.EMPTY;const lineDecorations=ContentHoverComputer._getLineDecorations(this._editor,anchor);return async_1.AsyncIterableObject.merge(this._participants.map((participant=>participant.computeAsync?participant.computeAsync(anchor,lineDecorations,token):async_1.AsyncIterableObject.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const lineDecorations=ContentHoverComputer._getLineDecorations(this._editor,this._anchor);let result=[];for(const participant of this._participants)result=result.concat(participant.computeSync(this._anchor,lineDecorations));return(0,arrays_1.coalesce)(result)}}})),define(__m[729],__M([1,0,10,13,108,15,3,22,24,38,88,54,555,14,467]),(function(require,exports,async_1,errors_1,editorState_1,editorExtensions_1,range_1,selection_1,editorContextKeys_1,textModel_1,editorWorker_1,editorColorRegistry_1,nls,themeService_1,inPlaceReplaceCommand_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let InPlaceReplaceController=class InPlaceReplaceController{constructor(editor,editorWorkerService){this.decorationIds=[],this.editor=editor,this.editorWorkerService=editorWorkerService}static get(editor){return editor.getContribution(InPlaceReplaceController.ID)}dispose(){}run(source,up){this.currentRequest&&this.currentRequest.cancel();const editorSelection=this.editor.getSelection(),model=this.editor.getModel();if(!model||!editorSelection)return;let selection=editorSelection;if(selection.startLineNumber!==selection.endLineNumber)return;const state=new editorState_1.EditorState(this.editor,5),modelURI=model.uri;return this.editorWorkerService.canNavigateValueSet(modelURI)?(this.currentRequest=(0,async_1.createCancelablePromise)((token=>this.editorWorkerService.navigateValueSet(modelURI,selection,up))),this.currentRequest.then((result=>{if(!result||!result.range||!result.value)return;if(!state.validate(this.editor))return;let editRange=range_1.Range.lift(result.range),highlightRange=result.range,diff=result.value.length-(selection.endColumn-selection.startColumn);highlightRange={startLineNumber:highlightRange.startLineNumber,startColumn:highlightRange.startColumn,endLineNumber:highlightRange.endLineNumber,endColumn:highlightRange.startColumn+result.value.length},diff>1&&(selection=new selection_1.Selection(selection.startLineNumber,selection.startColumn,selection.endLineNumber,selection.endColumn+diff-1));const command=new inPlaceReplaceCommand_1.InPlaceReplaceCommand(editRange,selection,result.value);this.editor.pushUndoStop(),this.editor.executeCommand(source,command),this.editor.pushUndoStop(),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[{range:highlightRange,options:InPlaceReplaceController.DECORATION}]),this.decorationRemover&&this.decorationRemover.cancel(),this.decorationRemover=(0,async_1.timeout)(350),this.decorationRemover.then((()=>this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[]))).catch(errors_1.onUnexpectedError)})).catch(errors_1.onUnexpectedError)):Promise.resolve(void 0)}};InPlaceReplaceController.ID="editor.contrib.inPlaceReplaceController",InPlaceReplaceController.DECORATION=textModel_1.ModelDecorationOptions.register({description:"in-place-replace",className:"valueSetReplacement"}),InPlaceReplaceController=__decorate([__param(1,editorWorker_1.IEditorWorkerService)],InPlaceReplaceController);class InPlaceReplaceUp extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.up",label:nls.localize(0,null),alias:"Replace with Previous Value",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3154,weight:100}})}run(accessor,editor){const controller=InPlaceReplaceController.get(editor);return controller?controller.run(this.id,!0):Promise.resolve(void 0)}}class InPlaceReplaceDown extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.down",label:nls.localize(1,null),alias:"Replace with Next Value",precondition:editorContextKeys_1.EditorContextKeys.writable,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3156,weight:100}})}run(accessor,editor){const controller=InPlaceReplaceController.get(editor);return controller?controller.run(this.id,!1):Promise.resolve(void 0)}}(0,editorExtensions_1.registerEditorContribution)(InPlaceReplaceController.ID,InPlaceReplaceController),(0,editorExtensions_1.registerEditorAction)(InPlaceReplaceUp),(0,editorExtensions_1.registerEditorAction)(InPlaceReplaceDown),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const border=theme.getColor(editorColorRegistry_1.editorBracketMatchBorder);border&&collector.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${border}; }`)}))})),define(__m[730],__M([1,0,18,10,21,30,13,4,2,8,25,15,29,11,3,24,38,33,562,17,23,14,20,67,55]),(function(require,exports,arrays,async_1,cancellation_1,color_1,errors_1,event_1,lifecycle_1,strings,uri_1,editorExtensions_1,codeEditorService_1,position_1,range_1,editorContextKeys_1,textModel_1,languageConfigurationRegistry_1,nls,contextkey_1,colorRegistry_1,themeService_1,languageFeatures_1,languageFeatureDebounce_1,stopwatch_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorLinkedEditingBackground=exports.LinkedEditingAction=exports.LinkedEditingContribution=exports.CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE=void 0,exports.CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE=new contextkey_1.RawContextKey("LinkedEditingInputVisible",!1);let LinkedEditingContribution=class LinkedEditingContribution extends lifecycle_1.Disposable{constructor(editor,contextKeyService,languageFeaturesService,languageConfigurationService,languageFeatureDebounceService){super(),this.languageConfigurationService=languageConfigurationService,this._localToDispose=this._register(new lifecycle_1.DisposableStore),this._editor=editor,this._providers=languageFeaturesService.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=exports.CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService),this._debounceInformation=languageFeatureDebounceService.for(this._providers,"Linked Editing",{min:200}),this._currentDecorations=[],this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new lifecycle_1.DisposableStore),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(62)||e.hasChanged(82))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}static get(editor){return editor.getContribution(LinkedEditingContribution.ID)}reinitialize(forceRefresh){const model=this._editor.getModel(),isEnabled=null!==model&&(this._editor.getOption(62)||this._editor.getOption(82))&&this._providers.has(model);if(isEnabled===this._enabled&&!forceRefresh)return;if(this._enabled=isEnabled,this.clearRanges(),this._localToDispose.clear(),!isEnabled||null===model)return;this._localToDispose.add(event_1.Event.runAndSubscribe(model.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition()})));const rangeUpdateScheduler=new async_1.Delayer(this._debounceInformation.get(model)),triggerRangeUpdate=()=>{var _a;this._rangeUpdateTriggerPromise=rangeUpdateScheduler.trigger((()=>this.updateRanges()),null!==(_a=this._debounceDuration)&&void 0!==_a?_a:this._debounceInformation.get(model))},rangeSyncScheduler=new async_1.Delayer(0),triggerRangeSync=decorations=>{this._rangeSyncTriggerPromise=rangeSyncScheduler.trigger((()=>this._syncRanges(decorations)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{triggerRangeUpdate()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const referenceRange=model.getDecorationRange(this._currentDecorations[0]);if(referenceRange&&e.changes.every((c=>referenceRange.intersectRanges(c.range))))return void triggerRangeSync(this._currentDecorations)}triggerRangeUpdate()}))),this._localToDispose.add({dispose:()=>{rangeUpdateScheduler.dispose(),rangeSyncScheduler.dispose()}}),this.updateRanges()}_syncRanges(decorations){if(!this._editor.hasModel()||decorations!==this._currentDecorations||0===decorations.length)return;const model=this._editor.getModel(),referenceRange=model.getDecorationRange(decorations[0]);if(!referenceRange||referenceRange.startLineNumber!==referenceRange.endLineNumber)return this.clearRanges();const referenceValue=model.getValueInRange(referenceRange);if(this._currentWordPattern){const match=referenceValue.match(this._currentWordPattern);if((match?match[0].length:0)!==referenceValue.length)return this.clearRanges()}let edits=[];for(let i=1,len=decorations.length;i<len;i++){const mirrorRange=model.getDecorationRange(decorations[i]);if(mirrorRange)if(mirrorRange.startLineNumber!==mirrorRange.endLineNumber)edits.push({range:mirrorRange,text:referenceValue});else{let oldValue=model.getValueInRange(mirrorRange),newValue=referenceValue,rangeStartColumn=mirrorRange.startColumn,rangeEndColumn=mirrorRange.endColumn;const commonPrefixLength=strings.commonPrefixLength(oldValue,newValue);rangeStartColumn+=commonPrefixLength,oldValue=oldValue.substr(commonPrefixLength),newValue=newValue.substr(commonPrefixLength);const commonSuffixLength=strings.commonSuffixLength(oldValue,newValue);rangeEndColumn-=commonSuffixLength,oldValue=oldValue.substr(0,oldValue.length-commonSuffixLength),newValue=newValue.substr(0,newValue.length-commonSuffixLength),rangeStartColumn===rangeEndColumn&&0===newValue.length||edits.push({range:new range_1.Range(mirrorRange.startLineNumber,rangeStartColumn,mirrorRange.endLineNumber,rangeEndColumn),text:newValue})}}if(0!==edits.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const prevEditOperationType=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",edits),this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,[]),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(force=!1){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const position=this._editor.getPosition();if(!this._enabled&&!force||this._editor.getSelections().length>1)return void this.clearRanges();const model=this._editor.getModel(),modelVersionId=model.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===modelVersionId){if(position.equals(this._currentRequestPosition))return;if(this._currentDecorations&&this._currentDecorations.length>0){const range=model.getDecorationRange(this._currentDecorations[0]);if(range&&range.containsPosition(position))return}}this._currentRequestPosition=position,this._currentRequestModelVersion=modelVersionId;const request=(0,async_1.createCancelablePromise)((token=>__awaiter(this,void 0,void 0,(function*(){try{const sw=new stopwatch_1.StopWatch(!1),response=yield getLinkedEditingRanges(this._providers,model,position,token);if(this._debounceInformation.update(model,sw.elapsed()),request!==this._currentRequest)return;if(this._currentRequest=null,modelVersionId!==model.getVersionId())return;let ranges=[];(null==response?void 0:response.ranges)&&(ranges=response.ranges),this._currentWordPattern=(null==response?void 0:response.wordPattern)||this._languageWordPattern;let foundReferenceRange=!1;for(let i=0,len=ranges.length;i<len;i++)if(range_1.Range.containsPosition(ranges[i],position)){if(foundReferenceRange=!0,0!==i){const referenceRange=ranges[i];ranges.splice(i,1),ranges.unshift(referenceRange)}break}if(!foundReferenceRange)return void this.clearRanges();const decorations=ranges.map((range=>({range,options:LinkedEditingContribution.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,decorations)}catch(err){(0,errors_1.isCancellationError)(err)||(0,errors_1.onUnexpectedError)(err),this._currentRequest!==request&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=request,request}))}};LinkedEditingContribution.ID="editor.contrib.linkedEditing",LinkedEditingContribution.DECORATION=textModel_1.ModelDecorationOptions.register({description:"linked-editing",stickiness:0,className:"linked-editing-decoration"}),LinkedEditingContribution=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,languageFeatures_1.ILanguageFeaturesService),__param(3,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(4,languageFeatureDebounce_1.ILanguageFeatureDebounceService)],LinkedEditingContribution),exports.LinkedEditingContribution=LinkedEditingContribution;class LinkedEditingAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.linkedEditing",label:nls.localize(0,null),alias:"Start Linked Editing",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3132,weight:100}})}runCommand(accessor,args){const editorService=accessor.get(codeEditorService_1.ICodeEditorService),[uri,pos]=Array.isArray(args)&&args||[void 0,void 0];return uri_1.URI.isUri(uri)&&position_1.Position.isIPosition(pos)?editorService.openCodeEditor({resource:uri},editorService.getActiveCodeEditor()).then((editor=>{editor&&(editor.setPosition(pos),editor.invokeWithinContext((accessor=>(this.reportTelemetry(accessor,editor),this.run(accessor,editor)))))}),errors_1.onUnexpectedError):super.runCommand(accessor,args)}run(_accessor,editor){const controller=LinkedEditingContribution.get(editor);return controller?Promise.resolve(controller.updateRanges(!0)):Promise.resolve()}}exports.LinkedEditingAction=LinkedEditingAction;const LinkedEditingCommand=editorExtensions_1.EditorCommand.bindToContribution(LinkedEditingContribution.get);function getLinkedEditingRanges(providers,model,position,token){const orderedByScore=providers.ordered(model);return(0,async_1.first)(orderedByScore.map((provider=>()=>__awaiter(this,void 0,void 0,(function*(){try{return yield provider.provideLinkedEditingRanges(model,position,token)}catch(e){return void(0,errors_1.onUnexpectedExternalError)(e)}})))),(result=>!!result&&arrays.isNonEmptyArray(null==result?void 0:result.ranges)))}(0,editorExtensions_1.registerEditorCommand)(new LinkedEditingCommand({id:"cancelLinkedEditingInput",precondition:exports.CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,handler:x=>x.clearRanges(),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,weight:199,primary:9,secondary:[1033]}})),exports.editorLinkedEditingBackground=(0,colorRegistry_1.registerColor)("editor.linkedEditingBackground",{dark:color_1.Color.fromHex("#f00").transparent(.3),light:color_1.Color.fromHex("#f00").transparent(.3),hc:color_1.Color.fromHex("#f00").transparent(.3)},nls.localize(1,null)),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const editorLinkedEditingBackgroundColor=theme.getColor(exports.editorLinkedEditingBackground);editorLinkedEditingBackgroundColor&&collector.addRule(`.monaco-editor .linked-editing-decoration { background: ${editorLinkedEditingBackgroundColor}; border-left-color: ${editorLinkedEditingBackgroundColor}; }`)})),(0,editorExtensions_1.registerModelAndPositionCommand)("_executeLinkedEditingProvider",((_accessor,model,position)=>{const{linkedEditingRangeProvider}=_accessor.get(languageFeatures_1.ILanguageFeaturesService);return getLinkedEditingRanges(linkedEditingRangeProvider,model,position,cancellation_1.CancellationToken.None)})),(0,editorExtensions_1.registerEditorContribution)(LinkedEditingContribution.ID,LinkedEditingContribution),(0,editorExtensions_1.registerEditorAction)(LinkedEditingAction)})),define(__m[731],__M([1,0,10,21,13,68,2,45,16,42,55,25,15,38,67,20,192,608,563,39,53,23,14,383]),(function(require,exports,async_1,cancellation_1,errors_1,htmlContent_1,lifecycle_1,network_1,platform,resources,stopwatch_1,uri_1,editorExtensions_1,textModel_1,languageFeatureDebounce_1,languageFeatures_1,clickLinkGesture_1,getLinks_1,nls,notification_1,opener_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LinkDetector=void 0;let LinkDetector=class LinkDetector extends lifecycle_1.Disposable{constructor(editor,openerService,notificationService,languageFeaturesService,languageFeatureDebounceService){super(),this.editor=editor,this.openerService=openerService,this.notificationService=notificationService,this.languageFeaturesService=languageFeaturesService,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=languageFeatureDebounceService.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new async_1.RunOnceScheduler((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const clickLinkGesture=this._register(new clickLinkGesture_1.ClickLinkGesture(editor));this._register(clickLinkGesture.onMouseMoveOrRelevantKeyDown((([mouseEvent,keyboardEvent])=>{this._onEditorMouseMove(mouseEvent,keyboardEvent)}))),this._register(clickLinkGesture.onExecute((e=>{this.onEditorMouseUp(e)}))),this._register(clickLinkGesture.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this._register(editor.onDidChangeConfiguration((e=>{e.hasChanged(63)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(editor.onDidChangeModelContent((e=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(editor.onDidChangeModel((e=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(editor.onDidChangeModelLanguage((e=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((e=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}static get(editor){return editor.getContribution(LinkDetector.ID)}computeLinksNow(){return __awaiter(this,void 0,void 0,(function*(){if(!this.editor.hasModel()||!this.editor.getOption(63))return;const model=this.editor.getModel();if(this.providers.has(model)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=(0,async_1.createCancelablePromise)((token=>(0,getLinks_1.getLinks)(this.providers,model,token)));try{const sw=new stopwatch_1.StopWatch(!1);if(this.activeLinksList=yield this.computePromise,this.debounceInformation.update(model,sw.elapsed()),model.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(err){(0,errors_1.onUnexpectedError)(err)}finally{this.computePromise=null}}}))}updateDecorations(links){const useMetaKey="altKey"===this.editor.getOption(70),oldDecorations=[],keys=Object.keys(this.currentOccurrences);for(const decorationId of keys){const occurence=this.currentOccurrences[decorationId];oldDecorations.push(occurence.decorationId)}const newDecorations=[];if(links)for(const link of links)newDecorations.push(LinkOccurrence.decoration(link,useMetaKey));const decorations=this.editor.deltaDecorations(oldDecorations,newDecorations);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let i=0,len=decorations.length;i<len;i++){const occurence=new LinkOccurrence(links[i],decorations[i]);this.currentOccurrences[occurence.decorationId]=occurence}}_onEditorMouseMove(mouseEvent,withKey){const useMetaKey="altKey"===this.editor.getOption(70);if(this.isEnabled(mouseEvent,withKey)){this.cleanUpActiveLinkDecoration();const occurrence=this.getLinkOccurrence(mouseEvent.target.position);occurrence&&this.editor.changeDecorations((changeAccessor=>{occurrence.activate(changeAccessor,useMetaKey),this.activeLinkDecorationId=occurrence.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const useMetaKey="altKey"===this.editor.getOption(70);if(this.activeLinkDecorationId){const occurrence=this.currentOccurrences[this.activeLinkDecorationId];occurrence&&this.editor.changeDecorations((changeAccessor=>{occurrence.deactivate(changeAccessor,useMetaKey)})),this.activeLinkDecorationId=null}}onEditorMouseUp(mouseEvent){if(!this.isEnabled(mouseEvent))return;const occurrence=this.getLinkOccurrence(mouseEvent.target.position);occurrence&&this.openLinkOccurrence(occurrence,mouseEvent.hasSideBySideModifier,!0)}openLinkOccurrence(occurrence,openToSide,fromUserGesture=!1){if(!this.openerService)return;const{link}=occurrence;link.resolve(cancellation_1.CancellationToken.None).then((uri=>{if("string"==typeof uri&&this.editor.hasModel()){const modelUri=this.editor.getModel().uri;if(modelUri.scheme===network_1.Schemas.file&&uri.startsWith(`${network_1.Schemas.file}:`)){const parsedUri=uri_1.URI.parse(uri);if(parsedUri.scheme===network_1.Schemas.file){const fsPath=resources.originalFSPath(parsedUri);let relativePath=null;fsPath.startsWith("/./")?relativePath=`.${fsPath.substr(1)}`:fsPath.startsWith("//./")&&(relativePath=`.${fsPath.substr(2)}`),relativePath&&(uri=resources.joinPath(modelUri,relativePath))}}}return this.openerService.open(uri,{openToSide,fromUserGesture,allowContributedOpeners:!0,allowCommands:!0})}),(err=>{const messageOrError=err instanceof Error?err.message:err;"invalid"===messageOrError?this.notificationService.warn(nls.localize(0,null,link.url.toString())):"missing"===messageOrError?this.notificationService.warn(nls.localize(1,null)):(0,errors_1.onUnexpectedError)(err)}))}getLinkOccurrence(position){if(!this.editor.hasModel()||!position)return null;const decorations=this.editor.getModel().getDecorationsInRange({startLineNumber:position.lineNumber,startColumn:position.column,endLineNumber:position.lineNumber,endColumn:position.column},0,!0);for(const decoration of decorations){const currentOccurrence=this.currentOccurrences[decoration.id];if(currentOccurrence)return currentOccurrence}return null}isEnabled(mouseEvent,withKey){return Boolean(6===mouseEvent.target.type&&(mouseEvent.hasTriggerModifier||withKey&&withKey.keyCodeIsTriggerKey))}stop(){var _a;this.computeLinks.cancel(),this.activeLinksList&&(null===(_a=this.activeLinksList)||void 0===_a||_a.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};LinkDetector.ID="editor.linkDetector",LinkDetector=__decorate([__param(1,opener_1.IOpenerService),__param(2,notification_1.INotificationService),__param(3,languageFeatures_1.ILanguageFeaturesService),__param(4,languageFeatureDebounce_1.ILanguageFeatureDebounceService)],LinkDetector),exports.LinkDetector=LinkDetector;const decoration={general:textModel_1.ModelDecorationOptions.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:textModel_1.ModelDecorationOptions.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class LinkOccurrence{constructor(link,decorationId){this.link=link,this.decorationId=decorationId}static decoration(link,useMetaKey){return{range:link.range,options:LinkOccurrence._getOptions(link,useMetaKey,!1)}}static _getOptions(link,useMetaKey,isActive){const options=Object.assign({},isActive?decoration.active:decoration.general);return options.hoverMessage=function getHoverMessage(link,useMetaKey){const executeCmd=link.url&&/^command:/i.test(link.url.toString()),label=link.tooltip?link.tooltip:executeCmd?nls.localize(2,null):nls.localize(3,null),kb=useMetaKey?platform.isMacintosh?nls.localize(4,null):nls.localize(5,null):platform.isMacintosh?nls.localize(6,null):nls.localize(7,null);if(link.url){let nativeLabel="";if(/^command:/i.test(link.url.toString())){const match=link.url.toString().match(/^command:([^?#]+)/);if(match){const commandId=match[1];nativeLabel=` "${nls.localize(8,null,commandId)}"`}}return new htmlContent_1.MarkdownString("",!0).appendMarkdown(`[${label}](${link.url.toString(!0).replace(/ /g,"%20")}${nativeLabel}) (${kb})`)}return(new htmlContent_1.MarkdownString).appendText(`${label} (${kb})`)}(link,useMetaKey),options}activate(changeAccessor,useMetaKey){changeAccessor.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,useMetaKey,!0))}deactivate(changeAccessor,useMetaKey){changeAccessor.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,useMetaKey,!1))}}class OpenLinkAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.openLink",label:nls.localize(9,null),alias:"Open Link",precondition:void 0})}run(accessor,editor){const linkDetector=LinkDetector.get(editor);if(!linkDetector)return;if(!editor.hasModel())return;const selections=editor.getSelections();for(const sel of selections){const link=linkDetector.getLinkOccurrence(sel.getEndPosition());link&&linkDetector.openLinkOccurrence(link,!1)}}}(0,editorExtensions_1.registerEditorContribution)(LinkDetector.ID,LinkDetector),(0,editorExtensions_1.registerEditorAction)(OpenLinkAction),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const activeLinkForeground=theme.getColor(colorRegistry_1.editorActiveLinkForeground);activeLinkForeground&&collector.addRule(`.monaco-editor .detected-link-active { color: ${activeLinkForeground} !important; }`)}))})),define(__m[732],__M([1,0,46,10,58,2,15,182,3,22,24,50,38,300,565,37,17,23,14,20]),(function(require,exports,aria_1,async_1,keyCodes_1,lifecycle_1,editorExtensions_1,cursorMoveCommands_1,range_1,selection_1,editorContextKeys_1,model_1,textModel_1,findController_1,nls,actions_1,contextkey_1,colorRegistry_1,themeService_1,languageFeatures_1){"use strict";function announceCursorChange(previousCursorState,cursorState){const cursorDiff=cursorState.filter((cs=>!previousCursorState.find((pcs=>pcs.equals(cs)))));if(cursorDiff.length>=1){const cursorPositions=cursorDiff.map((cs=>`line ${cs.viewState.position.lineNumber} column ${cs.viewState.position.column}`)).join(", "),msg=1===cursorDiff.length?nls.localize(0,null,cursorPositions):nls.localize(1,null,cursorPositions);(0,aria_1.status)(msg)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectionHighlighter=exports.CompatChangeAll=exports.SelectHighlightsAction=exports.MoveSelectionToPreviousFindMatchAction=exports.MoveSelectionToNextFindMatchAction=exports.AddSelectionToPreviousFindMatchAction=exports.AddSelectionToNextFindMatchAction=exports.MultiCursorSelectionControllerAction=exports.MultiCursorSelectionController=exports.MultiCursorSession=exports.MultiCursorSessionResult=exports.InsertCursorBelow=exports.InsertCursorAbove=void 0;class InsertCursorAbove extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.insertCursorAbove",label:nls.localize(2,null),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(3,null),order:2}})}run(accessor,editor,args){if(!editor.hasModel())return;let useLogicalLine=!0;args&&!1===args.logicalLine&&(useLogicalLine=!1);const viewModel=editor._getViewModel();if(viewModel.cursorConfig.readOnly)return;viewModel.model.pushStackElement();const previousCursorState=viewModel.getCursorStates();viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.addCursorUp(viewModel,previousCursorState,useLogicalLine)),viewModel.revealTopMostCursor(args.source),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}exports.InsertCursorAbove=InsertCursorAbove;class InsertCursorBelow extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.insertCursorBelow",label:nls.localize(4,null),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(5,null),order:3}})}run(accessor,editor,args){if(!editor.hasModel())return;let useLogicalLine=!0;args&&!1===args.logicalLine&&(useLogicalLine=!1);const viewModel=editor._getViewModel();if(viewModel.cursorConfig.readOnly)return;viewModel.model.pushStackElement();const previousCursorState=viewModel.getCursorStates();viewModel.setCursorStates(args.source,3,cursorMoveCommands_1.CursorMoveCommands.addCursorDown(viewModel,previousCursorState,useLogicalLine)),viewModel.revealBottomMostCursor(args.source),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}exports.InsertCursorBelow=InsertCursorBelow;class InsertCursorAtEndOfEachLineSelected extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:nls.localize(6,null),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(7,null),order:4}})}getCursorsForSelection(selection,model,result){if(!selection.isEmpty()){for(let i=selection.startLineNumber;i<selection.endLineNumber;i++){let currentLineMaxColumn=model.getLineMaxColumn(i);result.push(new selection_1.Selection(i,currentLineMaxColumn,i,currentLineMaxColumn))}selection.endColumn>1&&result.push(new selection_1.Selection(selection.endLineNumber,selection.endColumn,selection.endLineNumber,selection.endColumn))}}run(accessor,editor){if(!editor.hasModel())return;const model=editor.getModel(),selections=editor.getSelections(),viewModel=editor._getViewModel(),previousCursorState=viewModel.getCursorStates();let newSelections=[];selections.forEach((sel=>this.getCursorsForSelection(sel,model,newSelections))),newSelections.length>0&&editor.setSelections(newSelections),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}class InsertCursorAtEndOfLineSelected extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.addCursorsToBottom",label:nls.localize(8,null),alias:"Add Cursors To Bottom",precondition:void 0})}run(accessor,editor){if(!editor.hasModel())return;const selections=editor.getSelections(),lineCount=editor.getModel().getLineCount();let newSelections=[];for(let i=selections[0].startLineNumber;i<=lineCount;i++)newSelections.push(new selection_1.Selection(i,selections[0].startColumn,i,selections[0].endColumn));const viewModel=editor._getViewModel(),previousCursorState=viewModel.getCursorStates();newSelections.length>0&&editor.setSelections(newSelections),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}class InsertCursorAtTopOfLineSelected extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.addCursorsToTop",label:nls.localize(9,null),alias:"Add Cursors To Top",precondition:void 0})}run(accessor,editor){if(!editor.hasModel())return;const selections=editor.getSelections();let newSelections=[];for(let i=selections[0].startLineNumber;i>=1;i--)newSelections.push(new selection_1.Selection(i,selections[0].startColumn,i,selections[0].endColumn));const viewModel=editor._getViewModel(),previousCursorState=viewModel.getCursorStates();newSelections.length>0&&editor.setSelections(newSelections),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}class MultiCursorSessionResult{constructor(selections,revealRange,revealScrollType){this.selections=selections,this.revealRange=revealRange,this.revealScrollType=revealScrollType}}exports.MultiCursorSessionResult=MultiCursorSessionResult;class MultiCursorSession{constructor(_editor,findController,isDisconnectedFromFindController,searchText,wholeWord,matchCase,currentMatch){this._editor=_editor,this.findController=findController,this.isDisconnectedFromFindController=isDisconnectedFromFindController,this.searchText=searchText,this.wholeWord=wholeWord,this.matchCase=matchCase,this.currentMatch=currentMatch}static create(editor,findController){if(!editor.hasModel())return null;const findState=findController.getState();if(!editor.hasTextFocus()&&findState.isRevealed&&findState.searchString.length>0)return new MultiCursorSession(editor,findController,!1,findState.searchString,findState.wholeWord,findState.matchCase,null);let wholeWord,matchCase,isDisconnectedFromFindController=!1;const selections=editor.getSelections();1===selections.length&&selections[0].isEmpty()?(isDisconnectedFromFindController=!0,wholeWord=!0,matchCase=!0):(wholeWord=findState.wholeWord,matchCase=findState.matchCase);const s=editor.getSelection();let searchText,currentMatch=null;if(s.isEmpty()){const word=editor.getConfiguredWordAtPosition(s.getStartPosition());if(!word)return null;searchText=word.word,currentMatch=new selection_1.Selection(s.startLineNumber,word.startColumn,s.startLineNumber,word.endColumn)}else searchText=editor.getModel().getValueInRange(s).replace(/\r\n/g,"\n");return new MultiCursorSession(editor,findController,isDisconnectedFromFindController,searchText,wholeWord,matchCase,currentMatch)}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const nextMatch=this._getNextMatch();if(!nextMatch)return null;const allSelections=this._editor.getSelections();return new MultiCursorSessionResult(allSelections.concat(nextMatch),nextMatch,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const nextMatch=this._getNextMatch();if(!nextMatch)return null;const allSelections=this._editor.getSelections();return new MultiCursorSessionResult(allSelections.slice(0,allSelections.length-1).concat(nextMatch),nextMatch,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const result=this.currentMatch;return this.currentMatch=null,result}this.findController.highlightFindOptions();const allSelections=this._editor.getSelections(),lastAddedSelection=allSelections[allSelections.length-1],nextMatch=this._editor.getModel().findNextMatch(this.searchText,lastAddedSelection.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1);return nextMatch?new selection_1.Selection(nextMatch.range.startLineNumber,nextMatch.range.startColumn,nextMatch.range.endLineNumber,nextMatch.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const previousMatch=this._getPreviousMatch();if(!previousMatch)return null;const allSelections=this._editor.getSelections();return new MultiCursorSessionResult(allSelections.concat(previousMatch),previousMatch,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const previousMatch=this._getPreviousMatch();if(!previousMatch)return null;const allSelections=this._editor.getSelections();return new MultiCursorSessionResult(allSelections.slice(0,allSelections.length-1).concat(previousMatch),previousMatch,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const result=this.currentMatch;return this.currentMatch=null,result}this.findController.highlightFindOptions();const allSelections=this._editor.getSelections(),lastAddedSelection=allSelections[allSelections.length-1],previousMatch=this._editor.getModel().findPreviousMatch(this.searchText,lastAddedSelection.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1);return previousMatch?new selection_1.Selection(previousMatch.range.startLineNumber,previousMatch.range.startColumn,previousMatch.range.endLineNumber,previousMatch.range.endColumn):null}selectAll(){return this._editor.hasModel()?(this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1,1073741824)):[]}}exports.MultiCursorSession=MultiCursorSession;class MultiCursorSelectionController extends lifecycle_1.Disposable{constructor(editor){super(),this._sessionDispose=this._register(new lifecycle_1.DisposableStore),this._editor=editor,this._ignoreSelectionChange=!1,this._session=null}static get(editor){return editor.getContribution(MultiCursorSelectionController.ID)}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(findController){if(!this._session){const session=MultiCursorSession.create(this._editor,findController);if(!session)return;this._session=session;const newState={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(newState.wholeWordOverride=1,newState.matchCaseOverride=1,newState.isRegexOverride=2),findController.getState().change(newState,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(findController.getState().onFindReplaceStateChange((e=>{(e.matchCase||e.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const newState={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(newState,!1)}this._session=null}_setSelections(selections){this._ignoreSelectionChange=!0,this._editor.setSelections(selections),this._ignoreSelectionChange=!1}_expandEmptyToWord(model,selection){if(!selection.isEmpty())return selection;const word=this._editor.getConfiguredWordAtPosition(selection.getStartPosition());return word?new selection_1.Selection(selection.startLineNumber,word.startColumn,selection.startLineNumber,word.endColumn):selection}_applySessionResult(result){result&&(this._setSelections(result.selections),result.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange,result.revealScrollType))}getSession(findController){return this._session}addSelectionToNextFindMatch(findController){if(this._editor.hasModel()){if(!this._session){const allSelections=this._editor.getSelections();if(allSelections.length>1){const matchCase=findController.getState().matchCase;if(!modelRangesContainSameText(this._editor.getModel(),allSelections,matchCase)){const model=this._editor.getModel();let resultingSelections=[];for(let i=0,len=allSelections.length;i<len;i++)resultingSelections[i]=this._expandEmptyToWord(model,allSelections[i]);return void this._editor.setSelections(resultingSelections)}}}this._beginSessionIfNeeded(findController),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(findController){this._beginSessionIfNeeded(findController),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(findController){this._beginSessionIfNeeded(findController),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(findController){this._beginSessionIfNeeded(findController),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(findController){if(!this._editor.hasModel())return;let matches=null;const findState=findController.getState();if(findState.isRevealed&&findState.searchString.length>0&&findState.isRegex)matches=this._editor.getModel().findMatches(findState.searchString,!0,findState.isRegex,findState.matchCase,findState.wholeWord?this._editor.getOption(117):null,!1,1073741824);else{if(this._beginSessionIfNeeded(findController),!this._session)return;matches=this._session.selectAll()}if(findState.searchScope){const states=findState.searchScope;let inSelection=[];matches.forEach((match=>{states.forEach((state=>{match.range.endLineNumber<=state.endLineNumber&&match.range.startLineNumber>=state.startLineNumber&&inSelection.push(match)}))})),matches=inSelection}if(matches.length>0){const editorSelection=this._editor.getSelection();for(let i=0,len=matches.length;i<len;i++){const match=matches[i];if(match.range.intersectRanges(editorSelection)){matches[i]=matches[0],matches[0]=match;break}}this._setSelections(matches.map((m=>new selection_1.Selection(m.range.startLineNumber,m.range.startColumn,m.range.endLineNumber,m.range.endColumn))))}}}exports.MultiCursorSelectionController=MultiCursorSelectionController,MultiCursorSelectionController.ID="editor.contrib.multiCursorController";class MultiCursorSelectionControllerAction extends editorExtensions_1.EditorAction{run(accessor,editor){const multiCursorController=MultiCursorSelectionController.get(editor);if(!multiCursorController)return;const findController=findController_1.CommonFindController.get(editor);if(!findController)return;const viewModel=editor._getViewModel();if(viewModel){const previousCursorState=viewModel.getCursorStates();this._run(multiCursorController,findController),announceCursorChange(previousCursorState,viewModel.getCursorStates())}}}exports.MultiCursorSelectionControllerAction=MultiCursorSelectionControllerAction;class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:nls.localize(10,null),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:2082,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(11,null),order:5}})}_run(multiCursorController,findController){multiCursorController.addSelectionToNextFindMatch(findController)}}exports.AddSelectionToNextFindMatchAction=AddSelectionToNextFindMatchAction;class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:nls.localize(12,null),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(13,null),order:6}})}_run(multiCursorController,findController){multiCursorController.addSelectionToPreviousFindMatch(findController)}}exports.AddSelectionToPreviousFindMatchAction=AddSelectionToPreviousFindMatchAction;class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:nls.localize(14,null),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:(0,keyCodes_1.KeyChord)(2089,2082),weight:100}})}_run(multiCursorController,findController){multiCursorController.moveSelectionToNextFindMatch(findController)}}exports.MoveSelectionToNextFindMatchAction=MoveSelectionToNextFindMatchAction;class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:nls.localize(15,null),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(multiCursorController,findController){multiCursorController.moveSelectionToPreviousFindMatch(findController)}}exports.MoveSelectionToPreviousFindMatchAction=MoveSelectionToPreviousFindMatchAction;class SelectHighlightsAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.selectHighlights",label:nls.localize(16,null),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:3114,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarSelectionMenu,group:"3_multi",title:nls.localize(17,null),order:7}})}_run(multiCursorController,findController){multiCursorController.selectAll(findController)}}exports.SelectHighlightsAction=SelectHighlightsAction;class CompatChangeAll extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.changeAll",label:nls.localize(18,null),alias:"Change All Occurrences",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.editorTextFocus),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(multiCursorController,findController){multiCursorController.selectAll(findController)}}exports.CompatChangeAll=CompatChangeAll;class SelectionHighlighterState{constructor(_model,_searchText,_matchCase,_wordSeparators,prevState){this._model=_model,this._searchText=_searchText,this._matchCase=_matchCase,this._wordSeparators=_wordSeparators,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,prevState&&this._model===prevState._model&&this._searchText===prevState._searchText&&this._matchCase===prevState._matchCase&&this._wordSeparators===prevState._wordSeparators&&this._modelVersionId===prevState._modelVersionId&&(this._cachedFindMatches=prevState._cachedFindMatches)}findMatches(){return null===this._cachedFindMatches&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map((m=>m.range)),this._cachedFindMatches.sort(range_1.Range.compareRangesUsingStarts)),this._cachedFindMatches}}let SelectionHighlighter=class SelectionHighlighter extends lifecycle_1.Disposable{constructor(editor,_languageFeaturesService){super(),this._languageFeaturesService=_languageFeaturesService,this.editor=editor,this._isEnabled=editor.getOption(97),this.decorations=[],this.updateSoon=this._register(new async_1.RunOnceScheduler((()=>this._update()),300)),this.state=null,this._register(editor.onDidChangeConfiguration((e=>{this._isEnabled=editor.getOption(97)}))),this._register(editor.onDidChangeCursorSelection((e=>{this._isEnabled&&(e.selection.isEmpty()?3===e.reason?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(editor.onDidChangeModel((e=>{this._setState(null)}))),this._register(editor.onDidChangeModelContent((e=>{this._isEnabled&&this.updateSoon.schedule()})));const findController=findController_1.CommonFindController.get(editor);findController&&this._register(findController.getState().onFindReplaceStateChange((e=>{this._update()})))}_update(){this._setState(SelectionHighlighter._createState(this.state,this._isEnabled,this.editor))}static _createState(oldState,isEnabled,editor){if(!isEnabled)return null;if(!editor.hasModel())return null;const s=editor.getSelection();if(s.startLineNumber!==s.endLineNumber)return null;const multiCursorController=MultiCursorSelectionController.get(editor);if(!multiCursorController)return null;const findController=findController_1.CommonFindController.get(editor);if(!findController)return null;let r=multiCursorController.getSession(findController);if(!r){const allSelections=editor.getSelections();if(allSelections.length>1){const matchCase=findController.getState().matchCase;if(!modelRangesContainSameText(editor.getModel(),allSelections,matchCase))return null}r=MultiCursorSession.create(editor,findController)}if(!r)return null;if(r.currentMatch)return null;if(/^[ \t]+$/.test(r.searchText))return null;if(r.searchText.length>200)return null;const findState=findController.getState(),caseSensitive=findState.matchCase;if(findState.isRevealed){let findStateSearchString=findState.searchString;caseSensitive||(findStateSearchString=findStateSearchString.toLowerCase());let mySearchString=r.searchText;if(caseSensitive||(mySearchString=mySearchString.toLowerCase()),findStateSearchString===mySearchString&&r.matchCase===findState.matchCase&&r.wholeWord===findState.wholeWord&&!findState.isRegex)return null}return new SelectionHighlighterState(editor.getModel(),r.searchText,r.matchCase,r.wholeWord?editor.getOption(117):null,oldState)}_setState(newState){if(this.state=newState,!this.state)return void(this.decorations=this.editor.deltaDecorations(this.decorations,[]));if(!this.editor.hasModel())return;const model=this.editor.getModel();if(model.isTooLargeForTokenization())return;const allMatches=this.state.findMatches(),selections=this.editor.getSelections();selections.sort(range_1.Range.compareRangesUsingStarts);const matches=[];for(let i=0,j=0,len=allMatches.length,lenJ=selections.length;i<len;){const match=allMatches[i];if(j>=lenJ)matches.push(match),i++;else{const cmp=range_1.Range.compareRangesUsingStarts(match,selections[j]);cmp<0?(!selections[j].isEmpty()&&range_1.Range.areIntersecting(match,selections[j])||matches.push(match),i++):(cmp>0||i++,j++)}}const hasFindOccurrences=this._languageFeaturesService.documentHighlightProvider.has(model)&&this.editor.getOption(72),decorations=matches.map((r=>({range:r,options:hasFindOccurrences?SelectionHighlighter._SELECTION_HIGHLIGHT:SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW})));this.decorations=this.editor.deltaDecorations(this.decorations,decorations)}dispose(){this._setState(null),super.dispose()}};function modelRangesContainSameText(model,ranges,matchCase){const selectedText=getValueInRange(model,ranges[0],!matchCase);for(let i=1,len=ranges.length;i<len;i++){const range=ranges[i];if(range.isEmpty())return!1;if(selectedText!==getValueInRange(model,range,!matchCase))return!1}return!0}function getValueInRange(model,range,toLowerCase){const text=model.getValueInRange(range);return toLowerCase?text.toLowerCase():text}SelectionHighlighter.ID="editor.contrib.selectionHighlighter",SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW=textModel_1.ModelDecorationOptions.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapSelectionOccurrenceHighlight),position:model_1.MinimapPosition.Inline},overviewRuler:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.overviewRulerSelectionHighlightForeground),position:model_1.OverviewRulerLane.Center}}),SelectionHighlighter._SELECTION_HIGHLIGHT=textModel_1.ModelDecorationOptions.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),SelectionHighlighter=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService)],SelectionHighlighter),exports.SelectionHighlighter=SelectionHighlighter,(0,editorExtensions_1.registerEditorContribution)(MultiCursorSelectionController.ID,MultiCursorSelectionController),(0,editorExtensions_1.registerEditorContribution)(SelectionHighlighter.ID,SelectionHighlighter),(0,editorExtensions_1.registerEditorAction)(InsertCursorAbove),(0,editorExtensions_1.registerEditorAction)(InsertCursorBelow),(0,editorExtensions_1.registerEditorAction)(InsertCursorAtEndOfEachLineSelected),(0,editorExtensions_1.registerEditorAction)(AddSelectionToNextFindMatchAction),(0,editorExtensions_1.registerEditorAction)(AddSelectionToPreviousFindMatchAction),(0,editorExtensions_1.registerEditorAction)(MoveSelectionToNextFindMatchAction),(0,editorExtensions_1.registerEditorAction)(MoveSelectionToPreviousFindMatchAction),(0,editorExtensions_1.registerEditorAction)(SelectHighlightsAction),(0,editorExtensions_1.registerEditorAction)(CompatChangeAll),(0,editorExtensions_1.registerEditorAction)(InsertCursorAtEndOfLineSelected),(0,editorExtensions_1.registerEditorAction)(InsertCursorAtTopOfLineSelected)})),define(__m[733],__M([1,0,7,117,10,13,4,2,113,8,164,701,578,17,9,82,23,134,14,265,109,282,711,143,389,289]),(function(require,exports,dom,listWidget_1,async_1,errors_1,event_1,lifecycle_1,numbers_1,strings,embeddedCodeEditorWidget_1,suggestWidgetStatus_1,nls,contextkey_1,instantiation_1,storage_1,colorRegistry_1,styler_1,themeService_1,resizable_1,suggest_1,suggestWidgetDetails_1,suggestWidgetRenderer_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestContentWidget=exports.SuggestWidget=exports.editorSuggestWidgetStatusForeground=exports.editorSuggestWidgetHighlightFocusForeground=exports.editorSuggestWidgetHighlightForeground=exports.editorSuggestWidgetSelectedBackground=exports.editorSuggestWidgetSelectedIconForeground=exports.editorSuggestWidgetSelectedForeground=exports.editorSuggestWidgetForeground=exports.editorSuggestWidgetBorder=exports.editorSuggestWidgetBackground=void 0,exports.editorSuggestWidgetBackground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.background",{dark:colorRegistry_1.editorWidgetBackground,light:colorRegistry_1.editorWidgetBackground,hc:colorRegistry_1.editorWidgetBackground},nls.localize(0,null)),exports.editorSuggestWidgetBorder=(0,colorRegistry_1.registerColor)("editorSuggestWidget.border",{dark:colorRegistry_1.editorWidgetBorder,light:colorRegistry_1.editorWidgetBorder,hc:colorRegistry_1.editorWidgetBorder},nls.localize(1,null)),exports.editorSuggestWidgetForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.foreground",{dark:colorRegistry_1.editorForeground,light:colorRegistry_1.editorForeground,hc:colorRegistry_1.editorForeground},nls.localize(2,null)),exports.editorSuggestWidgetSelectedForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.selectedForeground",{dark:colorRegistry_1.quickInputListFocusForeground,light:colorRegistry_1.quickInputListFocusForeground,hc:colorRegistry_1.quickInputListFocusForeground},nls.localize(3,null)),exports.editorSuggestWidgetSelectedIconForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.selectedIconForeground",{dark:colorRegistry_1.quickInputListFocusIconForeground,light:colorRegistry_1.quickInputListFocusIconForeground,hc:colorRegistry_1.quickInputListFocusIconForeground},nls.localize(4,null)),exports.editorSuggestWidgetSelectedBackground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.selectedBackground",{dark:colorRegistry_1.quickInputListFocusBackground,light:colorRegistry_1.quickInputListFocusBackground,hc:colorRegistry_1.quickInputListFocusBackground},nls.localize(5,null)),exports.editorSuggestWidgetHighlightForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.highlightForeground",{dark:colorRegistry_1.listHighlightForeground,light:colorRegistry_1.listHighlightForeground,hc:colorRegistry_1.listHighlightForeground},nls.localize(6,null)),exports.editorSuggestWidgetHighlightFocusForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidget.focusHighlightForeground",{dark:colorRegistry_1.listFocusHighlightForeground,light:colorRegistry_1.listFocusHighlightForeground,hc:colorRegistry_1.listFocusHighlightForeground},nls.localize(7,null)),exports.editorSuggestWidgetStatusForeground=(0,colorRegistry_1.registerColor)("editorSuggestWidgetStatus.foreground",{dark:(0,colorRegistry_1.transparent)(exports.editorSuggestWidgetForeground,.5),light:(0,colorRegistry_1.transparent)(exports.editorSuggestWidgetForeground,.5),hc:(0,colorRegistry_1.transparent)(exports.editorSuggestWidgetForeground,.5)},nls.localize(8,null));class PersistedWidgetSize{constructor(_service,editor){this._service=_service,this._key=`suggestWidget.size/${editor.getEditorType()}/${editor instanceof embeddedCodeEditorWidget_1.EmbeddedCodeEditorWidget}`}restore(){var _a;const raw=null!==(_a=this._service.get(this._key,0))&&void 0!==_a?_a:"";try{const obj=JSON.parse(raw);if(dom.Dimension.is(obj))return dom.Dimension.lift(obj)}catch(_b){}}store(size){this._service.store(this._key,JSON.stringify(size),0,1)}reset(){this._service.remove(this._key,0)}}let SuggestWidget=class SuggestWidget{constructor(editor,_storageService,_contextKeyService,_themeService,instantiationService){this.editor=editor,this._storageService=_storageService,this._state=0,this._isAuto=!1,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new async_1.TimeoutTimer,this._disposables=new lifecycle_1.DisposableStore,this._onDidSelect=new event_1.Emitter,this._onDidFocus=new event_1.Emitter,this._onDidHide=new event_1.Emitter,this._onDidShow=new event_1.Emitter,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new event_1.Emitter,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new resizable_1.ResizableHTMLElement,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new SuggestContentWidget(this,editor),this._persistedSize=new PersistedWidgetSize(_storageService,editor);class ResizeState{constructor(persistedSize,currentSize,persistHeight=!1,persistWidth=!1){this.persistedSize=persistedSize,this.currentSize=currentSize,this.persistHeight=persistHeight,this.persistWidth=persistWidth}}let state;this._disposables.add(this.element.onDidWillResize((()=>{this._contentWidget.lockPreference(),state=new ResizeState(this._persistedSize.restore(),this.element.size)}))),this._disposables.add(this.element.onDidResize((e=>{var _a,_b,_c,_d;if(this._resize(e.dimension.width,e.dimension.height),state&&(state.persistHeight=state.persistHeight||!!e.north||!!e.south,state.persistWidth=state.persistWidth||!!e.east||!!e.west),e.done){if(state){const{itemHeight,defaultSize}=this.getLayoutInfo(),threshold=Math.round(itemHeight/2);let{width,height}=this.element.size;(!state.persistHeight||Math.abs(state.currentSize.height-height)<=threshold)&&(height=null!==(_b=null===(_a=state.persistedSize)||void 0===_a?void 0:_a.height)&&void 0!==_b?_b:defaultSize.height),(!state.persistWidth||Math.abs(state.currentSize.width-width)<=threshold)&&(width=null!==(_d=null===(_c=state.persistedSize)||void 0===_c?void 0:_c.width)&&void 0!==_d?_d:defaultSize.width),this._persistedSize.store(new dom.Dimension(width,height))}this._contentWidget.unlockPreference(),state=void 0}}))),this._messageElement=dom.append(this.element.domNode,dom.$(".message")),this._listElement=dom.append(this.element.domNode,dom.$(".tree"));const details=instantiationService.createInstance(suggestWidgetDetails_1.SuggestDetailsWidget,this.editor);details.onDidClose(this.toggleDetails,this,this._disposables),this._details=new suggestWidgetDetails_1.SuggestDetailsOverlay(details,this.editor);const applyIconStyle=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(106).showIcons);applyIconStyle();const renderer=instantiationService.createInstance(suggestWidgetRenderer_1.ItemRenderer,this.editor);this._disposables.add(renderer),this._disposables.add(renderer.onDidToggleDetails((()=>this.toggleDetails()))),this._list=new listWidget_1.List("SuggestWidget",this._listElement,{getHeight:_element=>this.getLayoutInfo().itemHeight,getTemplateId:_element=>"suggestion"},[renderer],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>nls.localize(11,null),getWidgetRole:()=>"listbox",getAriaLabel:item=>{let label=item.textLabel;if("string"!=typeof item.completion.label){const{detail,description}=item.completion.label;detail&&description?label=nls.localize(12,null,label,detail,description):detail?label=nls.localize(13,null,label,detail):description&&(label=nls.localize(14,null,label,description))}if(!item.isResolved||!this._isDetailsVisible())return label;const{documentation,detail}=item.completion,docs=strings.format("{0}{1}",detail||"",documentation?"string"==typeof documentation?documentation:documentation.value:"");return nls.localize(15,null,label,docs)}}}),this._status=instantiationService.createInstance(suggestWidgetStatus_1.SuggestWidgetStatus,this.element.domNode);const applyStatusBarStyle=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(106).showStatusBar);applyStatusBarStyle(),this._disposables.add((0,styler_1.attachListStyler)(this._list,_themeService,{listInactiveFocusBackground:exports.editorSuggestWidgetSelectedBackground,listInactiveFocusOutline:colorRegistry_1.activeContrastBorder})),this._disposables.add(_themeService.onDidColorThemeChange((t=>this._onThemeChange(t)))),this._onThemeChange(_themeService.getColorTheme()),this._disposables.add(this._list.onMouseDown((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onTap((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onDidChangeSelection((e=>this._onListSelection(e)))),this._disposables.add(this._list.onDidChangeFocus((e=>this._onListFocus(e)))),this._disposables.add(this.editor.onDidChangeCursorSelection((()=>this._onCursorSelectionChanged()))),this._disposables.add(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(106)&&(applyStatusBarStyle(),applyIconStyle())}))),this._ctxSuggestWidgetVisible=suggest_1.Context.Visible.bindTo(_contextKeyService),this._ctxSuggestWidgetDetailsVisible=suggest_1.Context.DetailsVisible.bindTo(_contextKeyService),this._ctxSuggestWidgetMultipleSuggestions=suggest_1.Context.MultipleSuggestions.bindTo(_contextKeyService),this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode,"keydown",(e=>{this._onDetailsKeydown.fire(e)}))),this._disposables.add(this.editor.onMouseDown((e=>this._onEditorMouseDown(e))))}dispose(){var _a;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),null===(_a=this._loadingTimeout)||void 0===_a||_a.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(mouseEvent){this._details.widget.domNode.contains(mouseEvent.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(mouseEvent.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){0!==this._state&&this._contentWidget.layout()}_onListMouseDownOrTap(e){void 0!==e.element&&void 0!==e.index&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(item,index){const completionModel=this._completionModel;completionModel&&(this._onDidSelect.fire({item,index,model:completionModel}),this.editor.focus())}_onThemeChange(theme){this._details.widget.borderWidth="hc"===theme.type?2:1}_onListFocus(e){var _a;if(this._ignoreFocusEvents)return;if(!e.elements.length)return this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),void this.editor.setAriaOptions({activeDescendant:void 0});if(!this._completionModel)return;const item=e.elements[0],index=e.indexes[0];item!==this._focusedItem&&(null===(_a=this._currentSuggestionDetails)||void 0===_a||_a.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=item,this._list.reveal(index),this._currentSuggestionDetails=(0,async_1.createCancelablePromise)((token=>__awaiter(this,void 0,void 0,(function*(){const loading=(0,async_1.disposableTimeout)((()=>{this._isDetailsVisible()&&this.showDetails(!0)}),250),sub=token.onCancellationRequested((()=>loading.dispose())),result=yield item.resolve(token);return loading.dispose(),sub.dispose(),result})))),this._currentSuggestionDetails.then((()=>{index>=this._list.length||item!==this._list.element(index)||(this._ignoreFocusEvents=!0,this._list.splice(index,1,[item]),this._list.setFocus([index]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:(0,suggestWidgetRenderer_1.getAriaId)(index)}))})).catch(errors_1.onUnexpectedError)),this._onDidFocus.fire({item,index,model:this._completionModel})}_setState(state){if(this._state!==state)switch(this._state=state,this.element.domNode.classList.toggle("frozen",4===state),this.element.domNode.classList.remove("message"),state){case 0:dom.hide(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=SuggestWidget.LOADING_MESSAGE,dom.hide(this._listElement,this._status.element),dom.show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=SuggestWidget.NO_SUGGESTIONS_MESSAGE,dom.hide(this._listElement,this._status.element),dom.show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:case 4:dom.hide(this._messageElement),dom.show(this._listElement,this._status.element),this._show();break;case 5:dom.hide(this._messageElement),dom.show(this._listElement,this._status.element),this._details.show(),this._show()}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet((()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)}),100)}showTriggered(auto,delay){0===this._state&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!auto,this._isAuto||(this._loadingTimeout=(0,async_1.disposableTimeout)((()=>this._setState(1)),delay)))}showSuggestions(completionModel,selectionIndex,isFrozen,isAuto){var _a,_b;if(this._contentWidget.setPosition(this.editor.getPosition()),null===(_a=this._loadingTimeout)||void 0===_a||_a.dispose(),null===(_b=this._currentSuggestionDetails)||void 0===_b||_b.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==completionModel&&(this._completionModel=completionModel),isFrozen&&2!==this._state&&0!==this._state)return void this._setState(4);const visibleCount=this._completionModel.items.length,isEmpty=0===visibleCount;if(this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount>1),isEmpty)return this._setState(isAuto?0:2),void(this._completionModel=void 0);this._focusedItem=void 0,this._list.splice(0,this._list.length,this._completionModel.items),this._setState(isFrozen?4:3),this._list.reveal(selectionIndex,0),this._list.setFocus([selectionIndex]),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(0!==this._state&&2!==this._state&&1!==this._state&&this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){5===this._state?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):3===this._state&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):!(0,suggestWidgetDetails_1.canExpandCompletionItem)(this._list.getFocusedElements()[0])&&!this._explainMode||3!==this._state&&5!==this._state&&4!==this._state||(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(loading){this._details.show(),loading?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add("shows-details")}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var _a;null===(_a=this._loadingTimeout)||void 0===_a||_a.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const dim=this._persistedSize.restore(),minPersistedHeight=Math.ceil(4.3*this.getLayoutInfo().itemHeight);dim&&dim.height<minPersistedHeight&&this._persistedSize.store(dim.with(void 0,minPersistedHeight))}isFrozen(){return 4===this._state}_afterRender(position){null!==position?2!==this._state&&1!==this._state&&(this._isDetailsVisible()&&this._details.show(),this._positionDetails()):this._isDetailsVisible()&&this._details.hide()}_layout(size){var _a,_b,_c;if(!this.editor.hasModel())return;if(!this.editor.getDomNode())return;const bodyBox=dom.getClientArea(document.body),info=this.getLayoutInfo();size||(size=info.defaultSize);let height=size.height,width=size.width;if(this._status.element.style.lineHeight=`${info.itemHeight}px`,2===this._state||1===this._state)height=info.itemHeight+info.borderHeight,width=info.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new dom.Dimension(width,height),this._contentWidget.setPreference(2);else{const maxWidth=bodyBox.width-info.borderHeight-2*info.horizontalPadding;width>maxWidth&&(width=maxWidth);const preferredWidth=this._completionModel?this._completionModel.stats.pLabelLen*info.typicalHalfwidthCharacterWidth:width,fullHeight=info.statusBarHeight+this._list.contentHeight+info.borderHeight,minHeight=info.itemHeight+info.statusBarHeight,editorBox=dom.getDomNodePagePosition(this.editor.getDomNode()),cursorBox=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),cursorBottom=editorBox.top+cursorBox.top+cursorBox.height,maxHeightBelow=Math.min(bodyBox.height-cursorBottom-info.verticalPadding,fullHeight),availableSpaceAbove=editorBox.top+cursorBox.top-info.verticalPadding,maxHeightAbove=Math.min(availableSpaceAbove,fullHeight);let maxHeight=Math.min(Math.max(maxHeightAbove,maxHeightBelow)+info.borderHeight,fullHeight);height===(null===(_a=this._cappedHeight)||void 0===_a?void 0:_a.capped)&&(height=this._cappedHeight.wanted),height<minHeight&&(height=minHeight),height>maxHeight&&(height=maxHeight);const forceRenderingAboveRequiredSpace=150;height>maxHeightBelow||this._forceRenderingAbove&&availableSpaceAbove>forceRenderingAboveRequiredSpace?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),maxHeight=maxHeightAbove):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),maxHeight=maxHeightBelow),this.element.preferredSize=new dom.Dimension(preferredWidth,info.defaultSize.height),this.element.maxSize=new dom.Dimension(maxWidth,maxHeight),this.element.minSize=new dom.Dimension(220,minHeight),this._cappedHeight=height===fullHeight?{wanted:null!==(_c=null===(_b=this._cappedHeight)||void 0===_b?void 0:_b.wanted)&&void 0!==_c?_c:size.height,capped:height}:void 0}this._resize(width,height)}_resize(width,height){const{width:maxWidth,height:maxHeight}=this.element.maxSize;width=Math.min(maxWidth,width),height=Math.min(maxHeight,height);const{statusBarHeight}=this.getLayoutInfo();this._list.layout(height-statusBarHeight,width),this._listElement.style.height=height-statusBarHeight+"px",this.element.layout(height,width),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var _a;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,2===(null===(_a=this._contentWidget.getPosition())||void 0===_a?void 0:_a.preference[0]))}getLayoutInfo(){const fontInfo=this.editor.getOption(44),itemHeight=(0,numbers_1.clamp)(this.editor.getOption(108)||fontInfo.lineHeight,8,1e3),statusBarHeight=this.editor.getOption(106).showStatusBar&&2!==this._state&&1!==this._state?itemHeight:0,borderWidth=this._details.widget.borderWidth,borderHeight=2*borderWidth;return{itemHeight,statusBarHeight,borderWidth,borderHeight,typicalHalfwidthCharacterWidth:fontInfo.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new dom.Dimension(430,statusBarHeight+12*itemHeight+borderHeight)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(value){this._storageService.store("expandSuggestionDocs",value,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};SuggestWidget.LOADING_MESSAGE=nls.localize(9,null),SuggestWidget.NO_SUGGESTIONS_MESSAGE=nls.localize(10,null),SuggestWidget=__decorate([__param(1,storage_1.IStorageService),__param(2,contextkey_1.IContextKeyService),__param(3,themeService_1.IThemeService),__param(4,instantiation_1.IInstantiationService)],SuggestWidget),exports.SuggestWidget=SuggestWidget;class SuggestContentWidget{constructor(_widget,_editor){this._widget=_widget,this._editor=_editor,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return!this._hidden&&this._position&&this._preference?{position:this._position,preference:[this._preference]}:null}beforeRender(){const{height,width}=this._widget.element.size,{borderWidth,horizontalPadding}=this._widget.getLayoutInfo();return new dom.Dimension(width+2*borderWidth+horizontalPadding,height+2*borderWidth)}afterRender(position){this._widget._afterRender(position)}setPreference(preference){this._preferenceLocked||(this._preference=preference)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(position){this._position=position}}exports.SuggestContentWidget=SuggestContentWidget})),define(__m[734],__M([1,0,10,2,15,274,48,297,287,41,14,67,55,20]),(function(require,exports,async_1,lifecycle_1,editorExtensions_1,getSemanticTokens_1,model_1,modelService_1,semanticTokensProviderStyling_1,configuration_1,themeService_1,languageFeatureDebounce_1,stopwatch_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let ViewportSemanticTokensContribution=class ViewportSemanticTokensContribution extends lifecycle_1.Disposable{constructor(editor,_modelService,_themeService,_configurationService,languageFeatureDebounceService,languageFeaturesService){super(),this._modelService=_modelService,this._themeService=_themeService,this._configurationService=_configurationService,this._editor=editor,this._provider=languageFeaturesService.documentRangeSemanticTokensProvider,this._debounceInformation=languageFeatureDebounceService.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new async_1.RunOnceScheduler((()=>this._tokenizeViewportNow()),100)),this._outstandingRequests=[];const scheduleTokenizeViewport=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange((()=>{scheduleTokenizeViewport()}))),this._register(this._editor.onDidChangeModel((()=>{this._cancelAll(),scheduleTokenizeViewport()}))),this._register(this._editor.onDidChangeModelContent((e=>{this._cancelAll(),scheduleTokenizeViewport()}))),this._register(this._provider.onDidChange((()=>{this._cancelAll(),scheduleTokenizeViewport()}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration(modelService_1.SEMANTIC_HIGHLIGHTING_SETTING_ID)&&(this._cancelAll(),scheduleTokenizeViewport())}))),this._register(this._themeService.onDidColorThemeChange((()=>{this._cancelAll(),scheduleTokenizeViewport()})))}_cancelAll(){for(const request of this._outstandingRequests)request.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(req){for(let i=0,len=this._outstandingRequests.length;i<len;i++)if(this._outstandingRequests[i]===req)return void this._outstandingRequests.splice(i,1)}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const model=this._editor.getModel();if(model.hasCompleteSemanticTokens())return;if(!(0,modelService_1.isSemanticColoringEnabled)(model,this._themeService,this._configurationService))return void(model.hasSomeSemanticTokens()&&model.setSemanticTokens(null,!1));if(!(0,getSemanticTokens_1.hasDocumentRangeSemanticTokensProvider)(this._provider,model))return void(model.hasSomeSemanticTokens()&&model.setSemanticTokens(null,!1));const visibleRanges=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(visibleRanges.map((range=>this._requestRange(model,range))))}_requestRange(model,range){const requestVersionId=model.getVersionId(),request=(0,async_1.createCancelablePromise)((token=>Promise.resolve((0,getSemanticTokens_1.getDocumentRangeSemanticTokens)(this._provider,model,range,token)))),sw=new stopwatch_1.StopWatch(!1);return request.then((r=>{if(this._debounceInformation.update(model,sw.elapsed()),!r||!r.tokens||model.isDisposed()||model.getVersionId()!==requestVersionId)return;const{provider,tokens:result}=r,styling=this._modelService.getSemanticTokensProviderStyling(provider);model.setPartialSemanticTokens(range,(0,semanticTokensProviderStyling_1.toMultilineTokens2)(result,styling,model.getLanguageId()))})).then((()=>this._removeOutstandingRequest(request)),(()=>this._removeOutstandingRequest(request))),request}};ViewportSemanticTokensContribution.ID="editor.contrib.viewportSemanticTokens",ViewportSemanticTokensContribution=__decorate([__param(1,model_1.IModelService),__param(2,themeService_1.IThemeService),__param(3,configuration_1.IConfigurationService),__param(4,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(5,languageFeatures_1.ILanguageFeaturesService)],ViewportSemanticTokensContribution),(0,editorExtensions_1.registerEditorContribution)(ViewportSemanticTokensContribution.ID,ViewportSemanticTokensContribution)})),define(__m[735],__M([1,0,46,18,10,21,13,2,15,3,24,50,38,27,587,17,23,14,20]),(function(require,exports,aria_1,arrays,async_1,cancellation_1,errors_1,lifecycle_1,editorExtensions_1,range_1,editorContextKeys_1,model_1,textModel_1,languages_1,nls,contextkey_1,colorRegistry_1,themeService_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOccurrencesAtPosition=void 0;const editorWordHighlight=(0,colorRegistry_1.registerColor)("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hc:null},nls.localize(0,null),!0),editorWordHighlightStrong=(0,colorRegistry_1.registerColor)("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hc:null},nls.localize(1,null),!0),editorWordHighlightBorder=(0,colorRegistry_1.registerColor)("editor.wordHighlightBorder",{light:null,dark:null,hc:colorRegistry_1.activeContrastBorder},nls.localize(2,null)),editorWordHighlightStrongBorder=(0,colorRegistry_1.registerColor)("editor.wordHighlightStrongBorder",{light:null,dark:null,hc:colorRegistry_1.activeContrastBorder},nls.localize(3,null)),overviewRulerWordHighlightForeground=(0,colorRegistry_1.registerColor)("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},nls.localize(4,null),!0),overviewRulerWordHighlightStrongForeground=(0,colorRegistry_1.registerColor)("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hc:"#C0A0C0CC"},nls.localize(5,null),!0),ctxHasWordHighlights=new contextkey_1.RawContextKey("hasWordHighlights",!1);function getOccurrencesAtPosition(registry,model,position,token){const orderedByScore=registry.ordered(model);return(0,async_1.first)(orderedByScore.map((provider=>()=>Promise.resolve(provider.provideDocumentHighlights(model,position,token)).then(void 0,errors_1.onUnexpectedExternalError))),arrays.isNonEmptyArray)}exports.getOccurrencesAtPosition=getOccurrencesAtPosition;class OccurenceAtPositionRequest{constructor(_model,_selection,_wordSeparators){this._model=_model,this._selection=_selection,this._wordSeparators=_wordSeparators,this._wordRange=this._getCurrentWordRange(_model,_selection),this._result=null}get result(){return this._result||(this._result=(0,async_1.createCancelablePromise)((token=>this._compute(this._model,this._selection,this._wordSeparators,token)))),this._result}_getCurrentWordRange(model,selection){const word=model.getWordAtPosition(selection.getPosition());return word?new range_1.Range(selection.startLineNumber,word.startColumn,selection.startLineNumber,word.endColumn):null}isValid(model,selection,decorationIds){const lineNumber=selection.startLineNumber,startColumn=selection.startColumn,endColumn=selection.endColumn,currentWordRange=this._getCurrentWordRange(model,selection);let requestIsValid=Boolean(this._wordRange&&this._wordRange.equalsRange(currentWordRange));for(let i=0,len=decorationIds.length;!requestIsValid&&i<len;i++){let range=model.getDecorationRange(decorationIds[i]);range&&range.startLineNumber===lineNumber&&range.startColumn<=startColumn&&range.endColumn>=endColumn&&(requestIsValid=!0)}return requestIsValid}cancel(){this.result.cancel()}}class SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(model,selection,wordSeparators,providers){super(model,selection,wordSeparators),this._providers=providers}_compute(model,selection,wordSeparators,token){return getOccurrencesAtPosition(this._providers,model,selection.getPosition(),token).then((value=>value||[]))}}class TextualOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(model,selection,wordSeparators){super(model,selection,wordSeparators),this._selectionIsEmpty=selection.isEmpty()}_compute(model,selection,wordSeparators,token){return(0,async_1.timeout)(250,token).then((()=>{if(!selection.isEmpty())return[];const word=model.getWordAtPosition(selection.getPosition());if(!word||word.word.length>1e3)return[];return model.findMatches(word.word,!0,!1,!0,wordSeparators,!1).map((m=>({range:m.range,kind:languages_1.DocumentHighlightKind.Text})))}))}isValid(model,selection,decorationIds){const currentSelectionIsEmpty=selection.isEmpty();return this._selectionIsEmpty===currentSelectionIsEmpty&&super.isValid(model,selection,decorationIds)}}(0,editorExtensions_1.registerModelAndPositionCommand)("_executeDocumentHighlights",((accessor,model,position)=>getOccurrencesAtPosition(accessor.get(languageFeatures_1.ILanguageFeaturesService).documentHighlightProvider,model,position,cancellation_1.CancellationToken.None)));class WordHighlighter{constructor(editor,providers,contextKeyService){this.toUnhook=new lifecycle_1.DisposableStore,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=editor,this.providers=providers,this._hasWordHighlights=ctxHasWordHighlights.bindTo(contextKeyService),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(72),this.model=this.editor.getModel(),this.toUnhook.add(editor.onDidChangeCursorPosition((e=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(e)}))),this.toUnhook.add(editor.onDidChangeModelContent((e=>{this._stopAll()}))),this.toUnhook.add(editor.onDidChangeConfiguration((e=>{let newValue=this.editor.getOption(72);this.occurrencesHighlight!==newValue&&(this.occurrencesHighlight=newValue,this._stopAll())}))),this._decorationIds=[],this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this._decorationIds.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return arrays.coalesce(this._decorationIds.map((id=>this.model.getDecorationRange(id))).sort(range_1.Range.compareRangesUsingStarts))}moveNext(){let highlights=this._getSortedHighlights(),newIndex=(highlights.findIndex((range=>range.containsPosition(this.editor.getPosition())))+1)%highlights.length,dest=highlights[newIndex];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(dest.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(dest);const word=this._getWord();if(word){const lineContent=this.editor.getModel().getLineContent(dest.startLineNumber);(0,aria_1.alert)(`${lineContent}, ${newIndex+1} of ${highlights.length} for '${word.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){let highlights=this._getSortedHighlights(),newIndex=(highlights.findIndex((range=>range.containsPosition(this.editor.getPosition())))-1+highlights.length)%highlights.length,dest=highlights[newIndex];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(dest.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(dest);const word=this._getWord();if(word){const lineContent=this.editor.getModel().getLineContent(dest.startLineNumber);(0,aria_1.alert)(`${lineContent}, ${newIndex+1} of ${highlights.length} for '${word.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this._decorationIds.length>0&&(this._decorationIds=this.editor.deltaDecorations(this._decorationIds,[]),this._hasWordHighlights.set(!1))}_stopAll(){this._removeDecorations(),-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),null!==this.workerRequest&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){this.occurrencesHighlight&&3===e.reason?this._run():this._stopAll()}_getWord(){let editorSelection=this.editor.getSelection(),lineNumber=editorSelection.startLineNumber,startColumn=editorSelection.startColumn;return this.model.getWordAtPosition({lineNumber,column:startColumn})}_run(){let editorSelection=this.editor.getSelection();if(editorSelection.startLineNumber!==editorSelection.endLineNumber)return void this._stopAll();let startColumn=editorSelection.startColumn,endColumn=editorSelection.endColumn;const word=this._getWord();if(!word||word.startColumn>startColumn||word.endColumn<endColumn)return void this._stopAll();const workerRequestIsValid=this.workerRequest&&this.workerRequest.isValid(this.model,editorSelection,this._decorationIds);if(this.lastCursorPositionChangeTime=(new Date).getTime(),workerRequestIsValid)this.workerRequestCompleted&&-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();let myRequestId=++this.workerRequestTokenId;this.workerRequestCompleted=!1,this.workerRequest=function computeOccurencesAtPosition(registry,model,selection,wordSeparators){return registry.has(model)?new SemanticOccurenceAtPositionRequest(model,selection,wordSeparators,registry):new TextualOccurenceAtPositionRequest(model,selection,wordSeparators)}(this.providers,this.model,this.editor.getSelection(),this.editor.getOption(117)),this.workerRequest.result.then((data=>{myRequestId===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=data||[],this._beginRenderDecorations())}),errors_1.onUnexpectedError)}}_beginRenderDecorations(){let currentTime=(new Date).getTime(),minimumRenderTime=this.lastCursorPositionChangeTime+250;currentTime>=minimumRenderTime?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout((()=>{this.renderDecorations()}),minimumRenderTime-currentTime)}renderDecorations(){this.renderDecorationsTimer=-1;let decorations=[];for(const info of this.workerRequestValue)info.range&&decorations.push({range:info.range,options:WordHighlighter._getDecorationOptions(info.kind)});this._decorationIds=this.editor.deltaDecorations(this._decorationIds,decorations),this._hasWordHighlights.set(this.hasDecorations())}static _getDecorationOptions(kind){return kind===languages_1.DocumentHighlightKind.Write?this._WRITE_OPTIONS:kind===languages_1.DocumentHighlightKind.Text?this._TEXT_OPTIONS:this._REGULAR_OPTIONS}dispose(){this._stopAll(),this.toUnhook.dispose()}}WordHighlighter._WRITE_OPTIONS=textModel_1.ModelDecorationOptions.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:(0,themeService_1.themeColorFromId)(overviewRulerWordHighlightStrongForeground),position:model_1.OverviewRulerLane.Center},minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapSelectionOccurrenceHighlight),position:model_1.MinimapPosition.Inline}}),WordHighlighter._TEXT_OPTIONS=textModel_1.ModelDecorationOptions.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight",overviewRuler:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.overviewRulerSelectionHighlightForeground),position:model_1.OverviewRulerLane.Center},minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapSelectionOccurrenceHighlight),position:model_1.MinimapPosition.Inline}}),WordHighlighter._REGULAR_OPTIONS=textModel_1.ModelDecorationOptions.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:(0,themeService_1.themeColorFromId)(overviewRulerWordHighlightForeground),position:model_1.OverviewRulerLane.Center},minimap:{color:(0,themeService_1.themeColorFromId)(colorRegistry_1.minimapSelectionOccurrenceHighlight),position:model_1.MinimapPosition.Inline}});let WordHighlighterContribution=class WordHighlighterContribution extends lifecycle_1.Disposable{constructor(editor,contextKeyService,languageFeaturesService){super(),this.wordHighlighter=null;const createWordHighlighterIfPossible=()=>{editor.hasModel()&&(this.wordHighlighter=new WordHighlighter(editor,languageFeaturesService.documentHighlightProvider,contextKeyService))};this._register(editor.onDidChangeModel((e=>{this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),createWordHighlighterIfPossible()}))),createWordHighlighterIfPossible()}static get(editor){return editor.getContribution(WordHighlighterContribution.ID)}saveViewState(){return!(!this.wordHighlighter||!this.wordHighlighter.hasDecorations())}moveNext(){this.wordHighlighter&&this.wordHighlighter.moveNext()}moveBack(){this.wordHighlighter&&this.wordHighlighter.moveBack()}restoreViewState(state){this.wordHighlighter&&state&&this.wordHighlighter.restore()}dispose(){this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),super.dispose()}};WordHighlighterContribution.ID="editor.contrib.wordHighlighter",WordHighlighterContribution=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,languageFeatures_1.ILanguageFeaturesService)],WordHighlighterContribution);class WordHighlightNavigationAction extends editorExtensions_1.EditorAction{constructor(next,opts){super(opts),this._isNext=next}run(accessor,editor){const controller=WordHighlighterContribution.get(editor);controller&&(this._isNext?controller.moveNext():controller.moveBack())}}class TriggerWordHighlightAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.wordHighlight.trigger",label:nls.localize(8,null),alias:"Trigger Symbol Highlight",precondition:ctxHasWordHighlights.toNegated(),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:0,weight:100}})}run(accessor,editor,args){const controller=WordHighlighterContribution.get(editor);controller&&controller.restoreViewState(!0)}}(0,editorExtensions_1.registerEditorContribution)(WordHighlighterContribution.ID,WordHighlighterContribution),(0,editorExtensions_1.registerEditorAction)(class NextWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:nls.localize(6,null),alias:"Go to Next Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:65,weight:100}})}}),(0,editorExtensions_1.registerEditorAction)(class PrevWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:nls.localize(7,null),alias:"Go to Previous Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1089,weight:100}})}}),(0,editorExtensions_1.registerEditorAction)(TriggerWordHighlightAction),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const selectionHighlight=theme.getColor(colorRegistry_1.editorSelectionHighlight);selectionHighlight&&(collector.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${selectionHighlight}; }`),collector.addRule(`.monaco-editor .selectionHighlight { background-color: ${selectionHighlight.transparent(.5)}; }`));const wordHighlight=theme.getColor(editorWordHighlight);wordHighlight&&collector.addRule(`.monaco-editor .wordHighlight { background-color: ${wordHighlight}; }`);const wordHighlightStrong=theme.getColor(editorWordHighlightStrong);wordHighlightStrong&&collector.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${wordHighlightStrong}; }`);const selectionHighlightBorder=theme.getColor(colorRegistry_1.editorSelectionHighlightBorder);selectionHighlightBorder&&collector.addRule(`.monaco-editor .selectionHighlight { border: 1px ${"hc"===theme.type?"dotted":"solid"} ${selectionHighlightBorder}; box-sizing: border-box; }`);const wordHighlightBorder=theme.getColor(editorWordHighlightBorder);wordHighlightBorder&&collector.addRule(`.monaco-editor .wordHighlight { border: 1px ${"hc"===theme.type?"dashed":"solid"} ${wordHighlightBorder}; box-sizing: border-box; }`);const wordHighlightStrongBorder=theme.getColor(editorWordHighlightStrongBorder);wordHighlightStrongBorder&&collector.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${"hc"===theme.type?"dashed":"solid"} ${wordHighlightStrongBorder}; box-sizing: border-box; }`)}))})),define(__m[736],__M([1,0,7,116,30,136,2,40,3,38,392]),(function(require,exports,dom,sash_1,color_1,idGenerator_1,lifecycle_1,objects,range_1,textModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ZoneWidget=exports.OverlayWidgetDelegate=exports.ViewZoneDelegate=void 0;const defaultColor=new color_1.Color(new color_1.RGBA(0,122,204)),defaultOptions={showArrow:!0,showFrame:!0,className:"",frameColor:defaultColor,arrowColor:defaultColor,keepEditorSelection:!1};class ViewZoneDelegate{constructor(domNode,afterLineNumber,afterColumn,heightInLines,onDomNodeTop,onComputedHeight){this.id="",this.domNode=domNode,this.afterLineNumber=afterLineNumber,this.afterColumn=afterColumn,this.heightInLines=heightInLines,this._onDomNodeTop=onDomNodeTop,this._onComputedHeight=onComputedHeight}onDomNodeTop(top){this._onDomNodeTop(top)}onComputedHeight(height){this._onComputedHeight(height)}}exports.ViewZoneDelegate=ViewZoneDelegate;class OverlayWidgetDelegate{constructor(id,domNode){this._id=id,this._domNode=domNode}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}exports.OverlayWidgetDelegate=OverlayWidgetDelegate;class Arrow{constructor(_editor){this._editor=_editor,this._ruleName=Arrow._IdGenerator.nextId(),this._decorations=[],this._color=null,this._height=-1}dispose(){this.hide(),dom.removeCSSRulesContainingSelector(this._ruleName)}set color(value){this._color!==value&&(this._color=value,this._updateStyle())}set height(value){this._height!==value&&(this._height=value,this._updateStyle())}_updateStyle(){dom.removeCSSRulesContainingSelector(this._ruleName),dom.createCSSRule(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(where){1===where.column&&(where={lineNumber:where.lineNumber,column:2}),this._decorations=this._editor.deltaDecorations(this._decorations,[{range:range_1.Range.fromPositions(where),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}}Arrow._IdGenerator=new idGenerator_1.IdGenerator(".arrow-decoration-");exports.ZoneWidget=class ZoneWidget{constructor(editor,options={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._positionMarkerId=[],this._viewZone=null,this._disposables=new lifecycle_1.DisposableStore,this.container=null,this._isShowing=!1,this.editor=editor,this.options=objects.deepClone(options),objects.mixin(this.options,defaultOptions,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange((info=>{const width=this._getWidth(info);this.domNode.style.width=width+"px",this.domNode.style.left=this._getLeft(info)+"px",this._onWidth(width)})))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones((accessor=>{this._viewZone&&accessor.removeZone(this._viewZone.id),this._viewZone=null})),this.editor.deltaDecorations(this._positionMarkerId,[]),this._positionMarkerId=[],this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Arrow(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(styles){styles.frameColor&&(this.options.frameColor=styles.frameColor),styles.arrowColor&&(this.options.arrowColor=styles.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let frameColor=this.options.frameColor.toString();this.container.style.borderTopColor=frameColor,this.container.style.borderBottomColor=frameColor}if(this._arrow&&this.options.arrowColor){let arrowColor=this.options.arrowColor.toString();this._arrow.color=arrowColor}}_getWidth(info){return info.width-info.minimap.minimapWidth-info.verticalScrollbarWidth}_getLeft(info){return info.minimap.minimapWidth>0&&0===info.minimap.minimapLeft?info.minimap.minimapWidth:0}_onViewZoneTop(top){this.domNode.style.top=top+"px"}_onViewZoneHeight(height){if(this.domNode.style.height=`${height}px`,this.container){let containerHeight=height-this._decoratingElementsHeight();this.container.style.height=`${containerHeight}px`;const layoutInfo=this.editor.getLayoutInfo();this._doLayout(containerHeight,this._getWidth(layoutInfo))}this._resizeSash&&this._resizeSash.layout()}get position(){const[id]=this._positionMarkerId;if(!id)return;const model=this.editor.getModel();if(!model)return;const range=model.getDecorationRange(id);return range?range.getStartPosition():void 0}show(rangeOrPos,heightInLines){const range=range_1.Range.isIRange(rangeOrPos)?range_1.Range.lift(rangeOrPos):range_1.Range.fromPositions(rangeOrPos);this._isShowing=!0,this._showImpl(range,heightInLines),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range,options:textModel_1.ModelDecorationOptions.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones((accessor=>{this._viewZone&&accessor.removeZone(this._viewZone.id)})),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let lineHeight=this.editor.getOption(59),result=0;if(this.options.showArrow){result+=2*Math.round(lineHeight/3)}if(this.options.showFrame){result+=2*Math.round(lineHeight/9)}return result}_showImpl(where,heightInLines){const position=where.getStartPosition(),layoutInfo=this.editor.getLayoutInfo(),width=this._getWidth(layoutInfo);this.domNode.style.width=`${width}px`,this.domNode.style.left=this._getLeft(layoutInfo)+"px";const viewZoneDomNode=document.createElement("div");viewZoneDomNode.style.overflow="hidden";const lineHeight=this.editor.getOption(59),maxHeightInLines=Math.max(12,this.editor.getLayoutInfo().height/lineHeight*.8);heightInLines=Math.min(heightInLines,maxHeightInLines);let arrowHeight=0,frameThickness=0;if(this._arrow&&this.options.showArrow&&(arrowHeight=Math.round(lineHeight/3),this._arrow.height=arrowHeight,this._arrow.show(position)),this.options.showFrame&&(frameThickness=Math.round(lineHeight/9)),this.editor.changeViewZones((accessor=>{this._viewZone&&accessor.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new ViewZoneDelegate(viewZoneDomNode,position.lineNumber,position.column,heightInLines,(top=>this._onViewZoneTop(top)),(height=>this._onViewZoneHeight(height))),this._viewZone.id=accessor.addZone(this._viewZone),this._overlayWidget=new OverlayWidgetDelegate("vs.editor.contrib.zoneWidget"+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)})),this.container&&this.options.showFrame){const width=this.options.frameWidth?this.options.frameWidth:frameThickness;this.container.style.borderTopWidth=width+"px",this.container.style.borderBottomWidth=width+"px"}let containerHeight=heightInLines*lineHeight-this._decoratingElementsHeight();this.container&&(this.container.style.top=arrowHeight+"px",this.container.style.height=containerHeight+"px",this.container.style.overflow="hidden"),this._doLayout(containerHeight,width),this.options.keepEditorSelection||this.editor.setSelection(where);const model=this.editor.getModel();if(model){const revealLine=where.endLineNumber+1;revealLine<=model.getLineCount()?this.revealLine(revealLine,!1):this.revealLine(model.getLineCount(),!0)}}revealLine(lineNumber,isLastLine){isLastLine?this.editor.revealLineInCenter(lineNumber,0):this.editor.revealLine(lineNumber,0)}setCssClass(className,classToReplace){this.container&&(classToReplace&&this.container.classList.remove(classToReplace),this.container.classList.add(className))}_onWidth(widthInPixel){}_doLayout(heightInPixel,widthInPixel){}_relayout(newHeightInLines){this._viewZone&&this._viewZone.heightInLines!==newHeightInLines&&this.editor.changeViewZones((accessor=>{this._viewZone&&(this._viewZone.heightInLines=newHeightInLines,accessor.layoutZone(this._viewZone.id))}))}_initSash(){if(this._resizeSash)return;let data;this._resizeSash=this._disposables.add(new sash_1.Sash(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0),this._disposables.add(this._resizeSash.onDidStart((e=>{this._viewZone&&(data={startY:e.startY,heightInLines:this._viewZone.heightInLines})}))),this._disposables.add(this._resizeSash.onDidEnd((()=>{data=void 0}))),this._disposables.add(this._resizeSash.onDidChange((evt=>{if(data){let lineDelta=(evt.currentY-data.startY)/this.editor.getOption(59),roundedLineDelta=lineDelta<0?Math.ceil(lineDelta):Math.floor(lineDelta),newHeightInLines=data.heightInLines+roundedLineDelta;newHeightInLines>5&&newHeightInLines<35&&this._relayout(newHeightInLines)}})))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(null===this.domNode.style.height?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const layoutInfo=this.editor.getLayoutInfo();return layoutInfo.width-layoutInfo.minimap.minimapWidth}}})),define(__m[110],__M([1,0,7,87,47,28,30,4,40,15,29,164,736,568,209,17,52,9,23,386]),(function(require,exports,dom,actionbar_1,actions_1,codicons_1,color_1,event_1,objects,editorExtensions_1,codeEditorService_1,embeddedCodeEditorWidget_1,zoneWidget_1,nls,menuEntryActionViewItem_1,contextkey_1,extensions_1,instantiation_1,colorRegistry_1){"use strict";var PeekContext;Object.defineProperty(exports,"__esModule",{value:!0}),exports.peekViewEditorMatchHighlightBorder=exports.peekViewEditorMatchHighlight=exports.peekViewResultsMatchHighlight=exports.peekViewEditorGutterBackground=exports.peekViewEditorBackground=exports.peekViewResultsSelectionForeground=exports.peekViewResultsSelectionBackground=exports.peekViewResultsFileForeground=exports.peekViewResultsMatchForeground=exports.peekViewResultsBackground=exports.peekViewBorder=exports.peekViewTitleInfoForeground=exports.peekViewTitleForeground=exports.peekViewTitleBackground=exports.PeekViewWidget=exports.getOuterEditor=exports.PeekContext=exports.IPeekViewService=void 0,exports.IPeekViewService=(0,instantiation_1.createDecorator)("IPeekViewService"),(0,extensions_1.registerSingleton)(exports.IPeekViewService,class{constructor(){this._widgets=new Map}addExclusiveWidget(editor,widget){const existing=this._widgets.get(editor);existing&&(existing.listener.dispose(),existing.widget.dispose());this._widgets.set(editor,{widget,listener:widget.onDidClose((()=>{const data=this._widgets.get(editor);data&&data.widget===widget&&(data.listener.dispose(),this._widgets.delete(editor))}))})}}),function(PeekContext){PeekContext.inPeekEditor=new contextkey_1.RawContextKey("inReferenceSearchEditor",!0,nls.localize(0,null)),PeekContext.notInPeekEditor=PeekContext.inPeekEditor.toNegated()}(PeekContext=exports.PeekContext||(exports.PeekContext={}));let PeekContextController=class PeekContextController{constructor(editor,contextKeyService){editor instanceof embeddedCodeEditorWidget_1.EmbeddedCodeEditorWidget&&PeekContext.inPeekEditor.bindTo(contextKeyService)}dispose(){}};PeekContextController.ID="editor.contrib.referenceController",PeekContextController=__decorate([__param(1,contextkey_1.IContextKeyService)],PeekContextController),(0,editorExtensions_1.registerEditorContribution)(PeekContextController.ID,PeekContextController),exports.getOuterEditor=function getOuterEditor(accessor){let editor=accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();return editor instanceof embeddedCodeEditorWidget_1.EmbeddedCodeEditorWidget?editor.getParentEditor():editor};const defaultOptions={headerBackgroundColor:color_1.Color.white,primaryHeadingColor:color_1.Color.fromHex("#333333"),secondaryHeadingColor:color_1.Color.fromHex("#6c6c6cb3")};let PeekViewWidget=class PeekViewWidget extends zoneWidget_1.ZoneWidget{constructor(editor,options,instantiationService){super(editor,options),this.instantiationService=instantiationService,this._onDidClose=new event_1.Emitter,this.onDidClose=this._onDidClose.event,objects.mixin(this.options,defaultOptions,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(styles){let options=this.options;styles.headerBackgroundColor&&(options.headerBackgroundColor=styles.headerBackgroundColor),styles.primaryHeadingColor&&(options.primaryHeadingColor=styles.primaryHeadingColor),styles.secondaryHeadingColor&&(options.secondaryHeadingColor=styles.secondaryHeadingColor),super.style(styles)}_applyStyles(){super._applyStyles();let options=this.options;this._headElement&&options.headerBackgroundColor&&(this._headElement.style.backgroundColor=options.headerBackgroundColor.toString()),this._primaryHeading&&options.primaryHeadingColor&&(this._primaryHeading.style.color=options.primaryHeadingColor.toString()),this._secondaryHeading&&options.secondaryHeadingColor&&(this._secondaryHeading.style.color=options.secondaryHeadingColor.toString()),this._bodyElement&&options.frameColor&&(this._bodyElement.style.borderColor=options.frameColor.toString())}_fillContainer(container){this.setCssClass("peekview-widget"),this._headElement=dom.$(".head"),this._bodyElement=dom.$(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),container.appendChild(this._headElement),container.appendChild(this._bodyElement)}_fillHead(container,noCloseAction){const titleElement=dom.$(".peekview-title");this.options.supportOnTitleClick&&(titleElement.classList.add("clickable"),dom.addStandardDisposableListener(titleElement,"click",(event=>this._onTitleClick(event)))),dom.append(this._headElement,titleElement),this._fillTitleIcon(titleElement),this._primaryHeading=dom.$("span.filename"),this._secondaryHeading=dom.$("span.dirname"),this._metaHeading=dom.$("span.meta"),dom.append(titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const actionsContainer=dom.$(".peekview-actions");dom.append(this._headElement,actionsContainer);const actionBarOptions=this._getActionBarOptions();this._actionbarWidget=new actionbar_1.ActionBar(actionsContainer,actionBarOptions),this._disposables.add(this._actionbarWidget),noCloseAction||this._actionbarWidget.push(new actions_1.Action("peekview.close",nls.localize(1,null),codicons_1.Codicon.close.classNames,!0,(()=>(this.dispose(),Promise.resolve()))),{label:!1,icon:!0})}_fillTitleIcon(container){}_getActionBarOptions(){return{actionViewItemProvider:menuEntryActionViewItem_1.createActionViewItem.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(event){}setTitle(primaryHeading,secondaryHeading){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=primaryHeading,this._primaryHeading.setAttribute("title",primaryHeading),secondaryHeading?this._secondaryHeading.innerText=secondaryHeading:dom.clearNode(this._secondaryHeading))}setMetaTitle(value){this._metaHeading&&(value?(this._metaHeading.innerText=value,dom.show(this._metaHeading)):dom.hide(this._metaHeading))}_doLayout(heightInPixel,widthInPixel){if(!this._isShowing&&heightInPixel<0)return void this.dispose();const headHeight=Math.ceil(1.2*this.editor.getOption(59)),bodyHeight=Math.round(heightInPixel-(headHeight+2));this._doLayoutHead(headHeight,widthInPixel),this._doLayoutBody(bodyHeight,widthInPixel)}_doLayoutHead(heightInPixel,widthInPixel){this._headElement&&(this._headElement.style.height=`${heightInPixel}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(heightInPixel,widthInPixel){this._bodyElement&&(this._bodyElement.style.height=`${heightInPixel}px`)}};PeekViewWidget=__decorate([__param(2,instantiation_1.IInstantiationService)],PeekViewWidget),exports.PeekViewWidget=PeekViewWidget,exports.peekViewTitleBackground=(0,colorRegistry_1.registerColor)("peekViewTitle.background",{dark:(0,colorRegistry_1.transparent)(colorRegistry_1.editorInfoForeground,.1),light:(0,colorRegistry_1.transparent)(colorRegistry_1.editorInfoForeground,.1),hc:null},nls.localize(2,null)),exports.peekViewTitleForeground=(0,colorRegistry_1.registerColor)("peekViewTitleLabel.foreground",{dark:color_1.Color.white,light:color_1.Color.black,hc:color_1.Color.white},nls.localize(3,null)),exports.peekViewTitleInfoForeground=(0,colorRegistry_1.registerColor)("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hc:"#FFFFFF99"},nls.localize(4,null)),exports.peekViewBorder=(0,colorRegistry_1.registerColor)("peekView.border",{dark:colorRegistry_1.editorInfoForeground,light:colorRegistry_1.editorInfoForeground,hc:colorRegistry_1.contrastBorder},nls.localize(5,null)),exports.peekViewResultsBackground=(0,colorRegistry_1.registerColor)("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hc:color_1.Color.black},nls.localize(6,null)),exports.peekViewResultsMatchForeground=(0,colorRegistry_1.registerColor)("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hc:color_1.Color.white},nls.localize(7,null)),exports.peekViewResultsFileForeground=(0,colorRegistry_1.registerColor)("peekViewResult.fileForeground",{dark:color_1.Color.white,light:"#1E1E1E",hc:color_1.Color.white},nls.localize(8,null)),exports.peekViewResultsSelectionBackground=(0,colorRegistry_1.registerColor)("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hc:null},nls.localize(9,null)),exports.peekViewResultsSelectionForeground=(0,colorRegistry_1.registerColor)("peekViewResult.selectionForeground",{dark:color_1.Color.white,light:"#6C6C6C",hc:color_1.Color.white},nls.localize(10,null)),exports.peekViewEditorBackground=(0,colorRegistry_1.registerColor)("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hc:color_1.Color.black},nls.localize(11,null)),exports.peekViewEditorGutterBackground=(0,colorRegistry_1.registerColor)("peekViewEditorGutter.background",{dark:exports.peekViewEditorBackground,light:exports.peekViewEditorBackground,hc:exports.peekViewEditorBackground},nls.localize(12,null)),exports.peekViewResultsMatchHighlight=(0,colorRegistry_1.registerColor)("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hc:null},nls.localize(13,null)),exports.peekViewEditorMatchHighlight=(0,colorRegistry_1.registerColor)("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hc:null},nls.localize(14,null)),exports.peekViewEditorMatchHighlightBorder=(0,colorRegistry_1.registerColor)("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hc:colorRegistry_1.activeContrastBorder},nls.localize(15,null))})),define(__m[737],__M([1,0,7,69,18,30,4,173,2,42,8,3,110,544,209,37,17,9,131,79,53,707,23,14,379]),(function(require,exports,dom,scrollableElement_1,arrays_1,color_1,event_1,labels_1,lifecycle_1,resources_1,strings_1,range_1,peekView_1,nls,menuEntryActionViewItem_1,actions_1,contextkey_1,instantiation_1,label_1,markers_1,opener_1,severityIcon_1,colorRegistry_1,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.editorMarkerNavigationBackground=exports.editorMarkerNavigationInfoHeader=exports.editorMarkerNavigationInfo=exports.editorMarkerNavigationWarningHeader=exports.editorMarkerNavigationWarning=exports.editorMarkerNavigationErrorHeader=exports.editorMarkerNavigationError=exports.MarkerNavigationWidget=void 0;class MessageWidget{constructor(parent,editor,onRelatedInformation,_openerService,_labelService){this._openerService=_openerService,this._labelService=_labelService,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new lifecycle_1.DisposableStore,this._editor=editor;const domNode=document.createElement("div");domNode.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),domNode.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),domNode.appendChild(this._relatedBlock),this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock,"click",(event=>{event.preventDefault();const related=this._relatedDiagnostics.get(event.target);related&&onRelatedInformation(related)}))),this._scrollable=new scrollableElement_1.ScrollableElement(domNode,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),parent.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{domNode.style.left=`-${e.scrollLeft}px`,domNode.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){(0,lifecycle_1.dispose)(this._disposables)}update(marker){const{source,message,relatedInformation,code}=marker;let sourceAndCodeLength=((null==source?void 0:source.length)||0)+"()".length;code&&(sourceAndCodeLength+="string"==typeof code?code.length:code.value.length);const lines=(0,strings_1.splitLines)(message);this._lines=lines.length,this._longestLineLength=0;for(const line of lines)this._longestLineLength=Math.max(line.length+sourceAndCodeLength,this._longestLineLength);dom.clearNode(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(marker)),this._editor.applyFontInfo(this._messageBlock);let lastLineElement=this._messageBlock;for(const line of lines)lastLineElement=document.createElement("div"),lastLineElement.innerText=line,""===line&&(lastLineElement.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(lastLineElement);if(source||code){const detailsElement=document.createElement("span");if(detailsElement.classList.add("details"),lastLineElement.appendChild(detailsElement),source){const sourceElement=document.createElement("span");sourceElement.innerText=source,sourceElement.classList.add("source"),detailsElement.appendChild(sourceElement)}if(code)if("string"==typeof code){const codeElement=document.createElement("span");codeElement.innerText=`(${code})`,codeElement.classList.add("code"),detailsElement.appendChild(codeElement)}else{this._codeLink=dom.$("a.code-link"),this._codeLink.setAttribute("href",`${code.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(code.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};dom.append(this._codeLink,dom.$("span")).innerText=code.value,detailsElement.appendChild(this._codeLink)}}if(dom.clearNode(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),(0,arrays_1.isNonEmptyArray)(relatedInformation)){const relatedInformationNode=this._relatedBlock.appendChild(document.createElement("div"));relatedInformationNode.style.paddingTop=`${Math.floor(.66*this._editor.getOption(59))}px`,this._lines+=1;for(const related of relatedInformation){let container=document.createElement("div"),relatedResource=document.createElement("a");relatedResource.classList.add("filename"),relatedResource.innerText=`${(0,labels_1.getBaseLabel)(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `,relatedResource.title=this._labelService.getUriLabel(related.resource),this._relatedDiagnostics.set(relatedResource,related);let relatedMessage=document.createElement("span");relatedMessage.innerText=related.message,container.appendChild(relatedResource),container.appendChild(relatedMessage),this._lines+=1,relatedInformationNode.appendChild(container)}}const fontInfo=this._editor.getOption(44),scrollWidth=Math.ceil(fontInfo.typicalFullwidthCharacterWidth*this._longestLineLength*.75),scrollHeight=fontInfo.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth,scrollHeight})}layout(height,width){this._scrollable.getDomNode().style.height=`${height}px`,this._scrollable.getDomNode().style.width=`${width}px`,this._scrollable.setScrollDimensions({width,height})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(marker){let severityLabel="";switch(marker.severity){case markers_1.MarkerSeverity.Error:severityLabel=nls.localize(0,null);break;case markers_1.MarkerSeverity.Warning:severityLabel=nls.localize(1,null);break;case markers_1.MarkerSeverity.Info:severityLabel=nls.localize(2,null);break;case markers_1.MarkerSeverity.Hint:severityLabel=nls.localize(3,null)}let ariaLabel=nls.localize(4,null,severityLabel,marker.startLineNumber+":"+marker.startColumn);const model=this._editor.getModel();if(model&&marker.startLineNumber<=model.getLineCount()&&marker.startLineNumber>=1){ariaLabel=`${model.getLineContent(marker.startLineNumber)}, ${ariaLabel}`}return ariaLabel}}let MarkerNavigationWidget=class MarkerNavigationWidget extends peekView_1.PeekViewWidget{constructor(editor,_themeService,_openerService,_menuService,instantiationService,_contextKeyService,_labelService){super(editor,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},instantiationService),this._themeService=_themeService,this._openerService=_openerService,this._menuService=_menuService,this._contextKeyService=_contextKeyService,this._labelService=_labelService,this._callOnDispose=new lifecycle_1.DisposableStore,this._onDidSelectRelatedInformation=new event_1.Emitter,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=markers_1.MarkerSeverity.Warning,this._backgroundColor=color_1.Color.white,this._applyTheme(_themeService.getColorTheme()),this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(theme){this._backgroundColor=theme.getColor(exports.editorMarkerNavigationBackground);let colorId=exports.editorMarkerNavigationError,headerBackground=exports.editorMarkerNavigationErrorHeader;this._severity===markers_1.MarkerSeverity.Warning?(colorId=exports.editorMarkerNavigationWarning,headerBackground=exports.editorMarkerNavigationWarningHeader):this._severity===markers_1.MarkerSeverity.Info&&(colorId=exports.editorMarkerNavigationInfo,headerBackground=exports.editorMarkerNavigationInfoHeader);const frameColor=theme.getColor(colorId),headerBg=theme.getColor(headerBackground);this.style({arrowColor:frameColor,frameColor,headerBackgroundColor:headerBg,primaryHeadingColor:theme.getColor(peekView_1.peekViewTitleForeground),secondaryHeadingColor:theme.getColor(peekView_1.peekViewTitleInfoForeground)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(container){super._fillHead(container),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun((e=>this.editor.focus())));const actions=[],menu=this._menuService.createMenu(MarkerNavigationWidget.TitleMenu,this._contextKeyService);(0,menuEntryActionViewItem_1.createAndFillInActionBarActions)(menu,void 0,actions),this._actionbarWidget.push(actions,{label:!1,icon:!0,index:0}),menu.dispose()}_fillTitleIcon(container){this._icon=dom.append(container,dom.$(""))}_fillBody(container){this._parentContainer=container,container.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),container.appendChild(this._container),this._message=new MessageWidget(this._container,this.editor,(related=>this._onDidSelectRelatedInformation.fire(related)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(marker,markerIdx,markerCount){this._container.classList.remove("stale"),this._message.update(marker),this._severity=marker.severity,this._applyTheme(this._themeService.getColorTheme());let range=range_1.Range.lift(marker);const editorPosition=this.editor.getPosition();let position=editorPosition&&range.containsPosition(editorPosition)?editorPosition:range.getStartPosition();super.show(position,this.computeRequiredHeight());const model=this.editor.getModel();if(model){const detail=markerCount>1?nls.localize(5,null,markerIdx,markerCount):nls.localize(6,null,markerIdx,markerCount);this.setTitle((0,resources_1.basename)(model.uri),detail)}this._icon.className=`codicon ${severityIcon_1.SeverityIcon.className(markers_1.MarkerSeverity.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(position,0),this.editor.focus()}updateMarker(marker){this._container.classList.remove("stale"),this._message.update(marker)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(heightInPixel,widthInPixel){super._doLayoutBody(heightInPixel,widthInPixel),this._heightInPixel=heightInPixel,this._message.layout(heightInPixel,widthInPixel),this._container.style.height=`${heightInPixel}px`}_onWidth(widthInPixel){this._message.layout(this._heightInPixel,widthInPixel)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};MarkerNavigationWidget.TitleMenu=new actions_1.MenuId("gotoErrorTitleMenu"),MarkerNavigationWidget=__decorate([__param(1,themeService_1.IThemeService),__param(2,opener_1.IOpenerService),__param(3,actions_1.IMenuService),__param(4,instantiation_1.IInstantiationService),__param(5,contextkey_1.IContextKeyService),__param(6,label_1.ILabelService)],MarkerNavigationWidget),exports.MarkerNavigationWidget=MarkerNavigationWidget;let errorDefault=(0,colorRegistry_1.oneOf)(colorRegistry_1.editorErrorForeground,colorRegistry_1.editorErrorBorder),warningDefault=(0,colorRegistry_1.oneOf)(colorRegistry_1.editorWarningForeground,colorRegistry_1.editorWarningBorder),infoDefault=(0,colorRegistry_1.oneOf)(colorRegistry_1.editorInfoForeground,colorRegistry_1.editorInfoBorder);exports.editorMarkerNavigationError=(0,colorRegistry_1.registerColor)("editorMarkerNavigationError.background",{dark:errorDefault,light:errorDefault,hc:colorRegistry_1.contrastBorder},nls.localize(7,null)),exports.editorMarkerNavigationErrorHeader=(0,colorRegistry_1.registerColor)("editorMarkerNavigationError.headerBackground",{dark:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationError,.1),light:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationError,.1),hc:null},nls.localize(8,null)),exports.editorMarkerNavigationWarning=(0,colorRegistry_1.registerColor)("editorMarkerNavigationWarning.background",{dark:warningDefault,light:warningDefault,hc:colorRegistry_1.contrastBorder},nls.localize(9,null)),exports.editorMarkerNavigationWarningHeader=(0,colorRegistry_1.registerColor)("editorMarkerNavigationWarning.headerBackground",{dark:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationWarning,.1),light:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationWarning,.1),hc:"#0C141F"},nls.localize(10,null)),exports.editorMarkerNavigationInfo=(0,colorRegistry_1.registerColor)("editorMarkerNavigationInfo.background",{dark:infoDefault,light:infoDefault,hc:colorRegistry_1.contrastBorder},nls.localize(11,null)),exports.editorMarkerNavigationInfoHeader=(0,colorRegistry_1.registerColor)("editorMarkerNavigationInfo.headerBackground",{dark:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationInfo,.1),light:(0,colorRegistry_1.transparent)(exports.editorMarkerNavigationInfo,.1),hc:null},nls.localize(12,null)),exports.editorMarkerNavigationBackground=(0,colorRegistry_1.registerColor)("editorMarkerNavigation.background",{dark:colorRegistry_1.editorBackground,light:colorRegistry_1.editorBackground,hc:colorRegistry_1.editorBackground},nls.localize(13,null))})),define(__m[301],__M([1,0,28,2,15,29,11,3,24,626,543,37,17,9,74,737]),(function(require,exports,codicons_1,lifecycle_1,editorExtensions_1,codeEditorService_1,position_1,range_1,editorContextKeys_1,markerNavigationService_1,nls,actions_1,contextkey_1,instantiation_1,iconRegistry_1,gotoErrorWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NextMarkerAction=exports.MarkerController=void 0;let MarkerController=class MarkerController{constructor(editor,_markerNavigationService,_contextKeyService,_editorService,_instantiationService){this._markerNavigationService=_markerNavigationService,this._contextKeyService=_contextKeyService,this._editorService=_editorService,this._instantiationService=_instantiationService,this._sessionDispoables=new lifecycle_1.DisposableStore,this._editor=editor,this._widgetVisible=CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService)}static get(editor){return editor.getContribution(MarkerController.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(uri){if(this._model&&this._model.matches(uri))return this._model;let reusePosition=!1;return this._model&&(reusePosition=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(uri),reusePosition&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(gotoErrorWidget_1.MarkerNavigationWidget,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var _a,_b,_c;(null===(_a=this._model)||void 0===_a?void 0:_a.selected)&&range_1.Range.containsPosition(null===(_b=this._model)||void 0===_b?void 0:_b.selected.marker,e.position)||null===(_c=this._model)||void 0===_c||_c.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const info=this._model.find(this._editor.getModel().uri,this._widget.position);info?this._widget.updateMarker(info.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((related=>{this._editorService.openCodeEditor({resource:related.resource,options:{pinned:!0,revealIfOpened:!0,selection:range_1.Range.lift(related).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(focusEditor=!0){this._cleanUp(),focusEditor&&this._editor.focus()}showAtMarker(marker){if(this._editor.hasModel()){const model=this._getOrCreateModel(this._editor.getModel().uri);model.resetIndex(),model.move(!0,this._editor.getModel(),new position_1.Position(marker.startLineNumber,marker.startColumn)),model.selected&&this._widget.showAtMarker(model.selected.marker,model.selected.index,model.selected.total)}}nagivate(next,multiFile){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const model=this._getOrCreateModel(multiFile?void 0:this._editor.getModel().uri);if(model.move(next,this._editor.getModel(),this._editor.getPosition()),!model.selected)return;if(model.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const otherEditor=yield this._editorService.openCodeEditor({resource:model.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:model.selected.marker}},this._editor);otherEditor&&(null===(_a=MarkerController.get(otherEditor))||void 0===_a||_a.close(),null===(_b=MarkerController.get(otherEditor))||void 0===_b||_b.nagivate(next,multiFile))}else this._widget.showAtMarker(model.selected.marker,model.selected.index,model.selected.total)}}))}};MarkerController.ID="editor.contrib.markerController",MarkerController=__decorate([__param(1,markerNavigationService_1.IMarkerNavigationService),__param(2,contextkey_1.IContextKeyService),__param(3,codeEditorService_1.ICodeEditorService),__param(4,instantiation_1.IInstantiationService)],MarkerController),exports.MarkerController=MarkerController;class MarkerNavigationAction extends editorExtensions_1.EditorAction{constructor(_next,_multiFile,opts){super(opts),this._next=_next,this._multiFile=_multiFile}run(_accessor,editor){var _a;return __awaiter(this,void 0,void 0,(function*(){editor.hasModel()&&(null===(_a=MarkerController.get(editor))||void 0===_a||_a.nagivate(this._next,this._multiFile))}))}}class NextMarkerAction extends MarkerNavigationAction{constructor(){super(!0,!1,{id:NextMarkerAction.ID,label:NextMarkerAction.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:578,weight:100},menuOpts:{menuId:gotoErrorWidget_1.MarkerNavigationWidget.TitleMenu,title:NextMarkerAction.LABEL,icon:(0,iconRegistry_1.registerIcon)("marker-navigation-next",codicons_1.Codicon.arrowDown,nls.localize(1,null)),group:"navigation",order:1}})}}exports.NextMarkerAction=NextMarkerAction,NextMarkerAction.ID="editor.action.marker.next",NextMarkerAction.LABEL=nls.localize(0,null);class PrevMarkerAction extends MarkerNavigationAction{constructor(){super(!1,!1,{id:PrevMarkerAction.ID,label:PrevMarkerAction.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:1602,weight:100},menuOpts:{menuId:gotoErrorWidget_1.MarkerNavigationWidget.TitleMenu,title:PrevMarkerAction.LABEL,icon:(0,iconRegistry_1.registerIcon)("marker-navigation-previous",codicons_1.Codicon.arrowUp,nls.localize(3,null)),group:"navigation",order:2}})}}PrevMarkerAction.ID="editor.action.marker.prev",PrevMarkerAction.LABEL=nls.localize(2,null);(0,editorExtensions_1.registerEditorContribution)(MarkerController.ID,MarkerController),(0,editorExtensions_1.registerEditorAction)(NextMarkerAction),(0,editorExtensions_1.registerEditorAction)(PrevMarkerAction),(0,editorExtensions_1.registerEditorAction)(class NextMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:nls.localize(4,null),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:66,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarGoMenu,title:nls.localize(5,null),group:"6_problem_nav",order:1}})}}),(0,editorExtensions_1.registerEditorAction)(class PrevMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:nls.localize(6,null),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:1090,weight:100},menuOpts:{menuId:actions_1.MenuId.MenubarGoMenu,title:nls.localize(7,null),group:"6_problem_nav",order:2}})}});const CONTEXT_MARKERS_NAVIGATION_VISIBLE=new contextkey_1.RawContextKey("markersNavigationVisible",!1),MarkerCommand=editorExtensions_1.EditorCommand.bindToContribution(MarkerController.get);(0,editorExtensions_1.registerEditorCommand)(new MarkerCommand({id:"closeMarkersNavigation",precondition:CONTEXT_MARKERS_NAVIGATION_VISIBLE,handler:x=>x.close(),kbOpts:{weight:150,kbExpr:editorContextKeys_1.EditorContextKeys.focus,primary:9,secondary:[1033]}}))})),define(__m[738],__M([1,0,7,231,30,4,2,45,42,164,3,38,33,81,35,56,662,110,549,9,43,131,161,14,162,129,381]),(function(require,exports,dom,splitview_1,color_1,event_1,lifecycle_1,network_1,resources_1,embeddedCodeEditorWidget_1,range_1,textModel_1,languageConfigurationRegistry_1,modesRegistry_1,language_1,resolverService_1,referencesTree_1,peekView,nls,instantiation_1,keybinding_1,label_1,listService_1,themeService_1,undoRedo_1,referencesModel_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReferenceWidget=exports.LayoutData=void 0;class DecorationsManager{constructor(_editor,_model){this._editor=_editor,this._model=_model,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new lifecycle_1.DisposableStore,this._callOnModelChange=new lifecycle_1.DisposableStore,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const model=this._editor.getModel();if(model)for(let ref of this._model.references)if(ref.uri.toString()===model.uri.toString())return void this._addDecorations(ref.parent)}_addDecorations(reference){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const newDecorations=[],newDecorationsActualIndex=[];for(let i=0,len=reference.children.length;i<len;i++){let oneReference=reference.children[i];this._decorationIgnoreSet.has(oneReference.id)||oneReference.uri.toString()===this._editor.getModel().uri.toString()&&(newDecorations.push({range:oneReference.range,options:DecorationsManager.DecorationOptions}),newDecorationsActualIndex.push(i))}const decorations=this._editor.deltaDecorations([],newDecorations);for(let i=0;i<decorations.length;i++)this._decorations.set(decorations[i],reference.children[newDecorationsActualIndex[i]])}_onDecorationChanged(){const toRemove=[],model=this._editor.getModel();if(model){for(let[decorationId,reference]of this._decorations){const newRange=model.getDecorationRange(decorationId);if(!newRange)continue;let ignore=!1;if(!range_1.Range.equalsRange(newRange,reference.range)){if(range_1.Range.spansMultipleLines(newRange))ignore=!0;else{reference.range.endColumn-reference.range.startColumn!==newRange.endColumn-newRange.startColumn&&(ignore=!0)}ignore?(this._decorationIgnoreSet.add(reference.id),toRemove.push(decorationId)):reference.range=newRange}}for(let i=0,len=toRemove.length;i<len;i++)this._decorations.delete(toRemove[i]);this._editor.deltaDecorations(toRemove,[])}}removeDecorations(){this._editor.deltaDecorations([...this._decorations.keys()],[]),this._decorations.clear()}}DecorationsManager.DecorationOptions=textModel_1.ModelDecorationOptions.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});exports.LayoutData=class LayoutData{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(raw){let ratio,heightInLines;try{const data=JSON.parse(raw);ratio=data.ratio,heightInLines=data.heightInLines}catch(_a){}return{ratio:ratio||.7,heightInLines:heightInLines||18}}};class ReferencesTree extends listService_1.WorkbenchAsyncDataTree{}let ReferenceWidget=class ReferenceWidget extends peekView.PeekViewWidget{constructor(editor,_defaultTreeKeyboardSupport,layoutData,themeService,_textModelResolverService,_instantiationService,_peekViewService,_uriLabel,_undoRedoService,_keybindingService,_languageService,_languageConfigurationService){super(editor,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},_instantiationService),this._defaultTreeKeyboardSupport=_defaultTreeKeyboardSupport,this.layoutData=layoutData,this._textModelResolverService=_textModelResolverService,this._instantiationService=_instantiationService,this._peekViewService=_peekViewService,this._uriLabel=_uriLabel,this._undoRedoService=_undoRedoService,this._keybindingService=_keybindingService,this._languageService=_languageService,this._languageConfigurationService=_languageConfigurationService,this._disposeOnNewModel=new lifecycle_1.DisposableStore,this._callOnDispose=new lifecycle_1.DisposableStore,this._onDidSelectReference=new event_1.Emitter,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new dom.Dimension(0,0),this._applyTheme(themeService.getColorTheme()),this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(editor,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),(0,lifecycle_1.dispose)(this._preview),(0,lifecycle_1.dispose)(this._previewNotAvailableMessage),(0,lifecycle_1.dispose)(this._tree),(0,lifecycle_1.dispose)(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(theme){const borderColor=theme.getColor(peekView.peekViewBorder)||color_1.Color.transparent;this.style({arrowColor:borderColor,frameColor:borderColor,headerBackgroundColor:theme.getColor(peekView.peekViewTitleBackground)||color_1.Color.transparent,primaryHeadingColor:theme.getColor(peekView.peekViewTitleForeground),secondaryHeadingColor:theme.getColor(peekView.peekViewTitleInfoForeground)})}show(where){this.editor.revealRangeInCenterIfOutsideViewport(where,0),super.show(where,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(containerElement){this.setCssClass("reference-zone-widget"),this._messageContainer=dom.append(containerElement,dom.$("div.messages")),dom.hide(this._messageContainer),this._splitView=new splitview_1.SplitView(containerElement,{orientation:1}),this._previewContainer=dom.append(containerElement,dom.$("div.preview.inline"));this._preview=this._instantiationService.createInstance(embeddedCodeEditorWidget_1.EmbeddedCodeEditorWidget,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},this.editor),dom.hide(this._previewContainer),this._previewNotAvailableMessage=new textModel_1.TextModel(nls.localize(0,null),modesRegistry_1.PLAINTEXT_LANGUAGE_ID,textModel_1.TextModel.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=dom.append(containerElement,dom.$("div.ref-tree.inline"));const treeOptions={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new referencesTree_1.AccessibilityProvider,keyboardNavigationLabelProvider:this._instantiationService.createInstance(referencesTree_1.StringRepresentationProvider),identityProvider:new referencesTree_1.IdentityProvider,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:peekView.peekViewResultsBackground}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer,"keydown",(e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(ReferencesTree,"ReferencesWidget",this._treeContainer,new referencesTree_1.Delegate,[this._instantiationService.createInstance(referencesTree_1.FileReferencesRenderer),this._instantiationService.createInstance(referencesTree_1.OneReferenceRenderer)],this._instantiationService.createInstance(referencesTree_1.DataSource),treeOptions),this._splitView.addView({onDidChange:event_1.Event.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:width=>{this._preview.layout({height:this._dim.height,width})}},splitview_1.Sizing.Distribute),this._splitView.addView({onDidChange:event_1.Event.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:width=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${width}px`,this._tree.layout(this._dim.height,width)}},splitview_1.Sizing.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));let onEvent=(element,kind)=>{element instanceof referencesModel_1.OneReference&&("show"===kind&&this._revealReference(element,!1),this._onDidSelectReference.fire({element,kind,source:"tree"}))};this._tree.onDidOpen((e=>{e.sideBySide?onEvent(e.element,"side"):e.editorOptions.pinned?onEvent(e.element,"goto"):onEvent(e.element,"show")})),dom.hide(this._treeContainer)}_onWidth(width){this._dim&&this._doLayoutBody(this._dim.height,width)}_doLayoutBody(heightInPixel,widthInPixel){super._doLayoutBody(heightInPixel,widthInPixel),this._dim=new dom.Dimension(widthInPixel,heightInPixel),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(widthInPixel),this._splitView.resizeView(0,widthInPixel*this.layoutData.ratio)}setSelection(selection){return this._revealReference(selection,!0).then((()=>{this._model&&(this._tree.setSelection([selection]),this._tree.setFocus([selection]))}))}setModel(newModel){return this._disposeOnNewModel.clear(),this._model=newModel,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=nls.localize(1,null),dom.show(this._messageContainer),Promise.resolve(void 0)):(dom.hide(this._messageContainer),this._decorationsManager=new DecorationsManager(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((reference=>this._tree.rerender(reference)))),this._disposeOnNewModel.add(this._preview.onMouseDown((e=>{const{event,target}=e;if(2!==event.detail)return;const element=this._getFocusedReference();element&&this._onDidSelectReference.fire({element:{uri:element.uri,range:target.range},kind:event.ctrlKey||event.metaKey||event.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),dom.show(this._treeContainer),dom.show(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[element]=this._tree.getFocus();return element instanceof referencesModel_1.OneReference?element:element instanceof referencesModel_1.FileReferences&&element.children.length>0?element.children[0]:void 0}revealReference(reference){return __awaiter(this,void 0,void 0,(function*(){yield this._revealReference(reference,!1),this._onDidSelectReference.fire({element:reference,kind:"goto",source:"tree"})}))}_revealReference(reference,revealParent){return __awaiter(this,void 0,void 0,(function*(){if(this._revealedReference===reference)return;this._revealedReference=reference,reference.uri.scheme!==network_1.Schemas.inMemory?this.setTitle((0,resources_1.basenameOrAuthority)(reference.uri),this._uriLabel.getUriLabel((0,resources_1.dirname)(reference.uri))):this.setTitle(nls.localize(2,null));const promise=this._textModelResolverService.createModelReference(reference.uri);this._tree.getInput()===reference.parent||(revealParent&&this._tree.reveal(reference.parent),yield this._tree.expand(reference.parent)),this._tree.reveal(reference);const ref=yield promise;if(!this._model)return void ref.dispose();(0,lifecycle_1.dispose)(this._previewModelReference);const model=ref.object;if(model){const scrollType=this._preview.getModel()===model.textEditorModel?0:1,sel=range_1.Range.lift(reference.range).collapseToStart();this._previewModelReference=ref,this._preview.setModel(model.textEditorModel),this._preview.setSelection(sel),this._preview.revealRangeInCenter(sel,scrollType)}else this._preview.setModel(this._previewNotAvailableMessage),ref.dispose()}))}};ReferenceWidget=__decorate([__param(3,themeService_1.IThemeService),__param(4,resolverService_1.ITextModelService),__param(5,instantiation_1.IInstantiationService),__param(6,peekView.IPeekViewService),__param(7,label_1.ILabelService),__param(8,undoRedo_1.IUndoRedoService),__param(9,keybinding_1.IKeybindingService),__param(10,language_1.ILanguageService),__param(11,languageConfigurationRegistry_1.ILanguageConfigurationService)],ReferenceWidget),exports.ReferenceWidget=ReferenceWidget})),define(__m[302],__M([1,0,10,13,58,2,29,11,3,110,547,26,41,17,9,89,161,39,82,129,738]),(function(require,exports,async_1,errors_1,keyCodes_1,lifecycle_1,codeEditorService_1,position_1,range_1,peekView_1,nls,commands_1,configuration_1,contextkey_1,instantiation_1,keybindingsRegistry_1,listService_1,notification_1,storage_1,referencesModel_1,referencesWidget_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReferencesController=exports.ctxReferenceSearchVisible=void 0,exports.ctxReferenceSearchVisible=new contextkey_1.RawContextKey("referenceSearchVisible",!1,nls.localize(0,null));let ReferencesController=class ReferencesController{constructor(_defaultTreeKeyboardSupport,_editor,contextKeyService,_editorService,_notificationService,_instantiationService,_storageService,_configurationService){this._defaultTreeKeyboardSupport=_defaultTreeKeyboardSupport,this._editor=_editor,this._editorService=_editorService,this._notificationService=_notificationService,this._instantiationService=_instantiationService,this._storageService=_storageService,this._configurationService=_configurationService,this._disposables=new lifecycle_1.DisposableStore,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=exports.ctxReferenceSearchVisible.bindTo(contextKeyService)}static get(editor){return editor.getContribution(ReferencesController.ID)}dispose(){var _a,_b;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(_a=this._widget)||void 0===_a||_a.dispose(),null===(_b=this._model)||void 0===_b||_b.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(range,modelPromise,peekMode){let widgetPosition;if(this._widget&&(widgetPosition=this._widget.position),this.closeWidget(),widgetPosition&&range.containsPosition(widgetPosition))return;this._peekMode=peekMode,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const data=referencesWidget_1.LayoutData.fromJSON(this._storageService.get("peekViewLayout",0,"{}"));this._widget=this._instantiationService.createInstance(referencesWidget_1.ReferenceWidget,this._editor,this._defaultTreeKeyboardSupport,data),this._widget.setTitle(nls.localize(1,null)),this._widget.show(range),this._disposables.add(this._widget.onDidClose((()=>{modelPromise.cancel(),this._widget&&(this._storageService.store("peekViewLayout",JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((event=>{let{element,kind}=event;if(element)switch(kind){case"open":"editor"===event.source&&this._configurationService.getValue("editor.stablePeek")||this.openReference(element,!1,!1);break;case"side":this.openReference(element,!0,!1);break;case"goto":peekMode?this._gotoReference(element):this.openReference(element,!1,!0)}})));const requestId=++this._requestIdPool;modelPromise.then((model=>{var _a;if(requestId===this._requestIdPool&&this._widget)return null===(_a=this._model)||void 0===_a||_a.dispose(),this._model=model,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(nls.localize(2,null,this._model.title,this._model.references.length));let uri=this._editor.getModel().uri,pos=new position_1.Position(range.startLineNumber,range.startColumn),selection=this._model.nearestReference(uri,pos);if(selection)return this._widget.setSelection(selection).then((()=>{this._widget&&"editor"===this._editor.getOption(77)&&this._widget.focusOnPreviewEditor()}))}}));model.dispose()}),(error=>{this._notificationService.error(error)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(fwd){return __awaiter(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const currentPosition=this._widget.position;if(!currentPosition)return;const source=this._model.nearestReference(this._editor.getModel().uri,currentPosition);if(!source)return;const target=this._model.nextOrPreviousReference(source,fwd),editorFocus=this._editor.hasTextFocus(),previewEditorFocus=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(target),yield this._gotoReference(target),editorFocus?this._editor.focus():this._widget&&previewEditorFocus&&this._widget.focusOnPreviewEditor()}))}revealReference(reference){return __awaiter(this,void 0,void 0,(function*(){this._editor.hasModel()&&this._model&&this._widget&&(yield this._widget.revealReference(reference))}))}closeWidget(focusEditor=!0){var _a,_b;null===(_a=this._widget)||void 0===_a||_a.dispose(),null===(_b=this._model)||void 0===_b||_b.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,focusEditor&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(ref){this._widget&&this._widget.hide(),this._ignoreModelChangeEvent=!0;const range=range_1.Range.lift(ref.range).collapseToStart();return this._editorService.openCodeEditor({resource:ref.uri,options:{selection:range,selectionSource:"code.jump"}},this._editor).then((openedEditor=>{var _a;if(this._ignoreModelChangeEvent=!1,openedEditor&&this._widget)if(this._editor===openedEditor)this._widget.show(range),this._widget.focusOnReferenceTree();else{const other=ReferencesController.get(openedEditor),model=this._model.clone();this.closeWidget(),openedEditor.focus(),null==other||other.toggleWidget(range,(0,async_1.createCancelablePromise)((_=>Promise.resolve(model))),null!==(_a=this._peekMode)&&void 0!==_a&&_a)}else this.closeWidget()}),(err=>{this._ignoreModelChangeEvent=!1,(0,errors_1.onUnexpectedError)(err)}))}openReference(ref,sideBySide,pinned){sideBySide||this.closeWidget();const{uri,range}=ref;this._editorService.openCodeEditor({resource:uri,options:{selection:range,selectionSource:"code.jump",pinned}},this._editor,sideBySide)}};function withController(accessor,fn){const outerEditor=(0,peekView_1.getOuterEditor)(accessor);if(!outerEditor)return;const controller=ReferencesController.get(outerEditor);controller&&fn(controller)}ReferencesController.ID="editor.contrib.referencesController",ReferencesController=__decorate([__param(2,contextkey_1.IContextKeyService),__param(3,codeEditorService_1.ICodeEditorService),__param(4,notification_1.INotificationService),__param(5,instantiation_1.IInstantiationService),__param(6,storage_1.IStorageService),__param(7,configuration_1.IConfigurationService)],ReferencesController),exports.ReferencesController=ReferencesController,keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:(0,keyCodes_1.KeyChord)(2089,60),when:contextkey_1.ContextKeyExpr.or(exports.ctxReferenceSearchVisible,peekView_1.PeekContext.inPeekEditor),handler(accessor){withController(accessor,(controller=>{controller.changeFocusBetweenPreviewAndReferences()}))}}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:contextkey_1.ContextKeyExpr.or(exports.ctxReferenceSearchVisible,peekView_1.PeekContext.inPeekEditor),handler(accessor){withController(accessor,(controller=>{controller.goToNextOrPreviousReference(!0)}))}}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:contextkey_1.ContextKeyExpr.or(exports.ctxReferenceSearchVisible,peekView_1.PeekContext.inPeekEditor),handler(accessor){withController(accessor,(controller=>{controller.goToNextOrPreviousReference(!1)}))}}),commands_1.CommandsRegistry.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),commands_1.CommandsRegistry.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),commands_1.CommandsRegistry.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),commands_1.CommandsRegistry.registerCommand("closeReferenceSearch",(accessor=>withController(accessor,(controller=>controller.closeWidget())))),keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:contextkey_1.ContextKeyExpr.and(peekView_1.PeekContext.inPeekEditor,contextkey_1.ContextKeyExpr.not("config.editor.stablePeek"))}),keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:contextkey_1.ContextKeyExpr.and(exports.ctxReferenceSearchVisible,contextkey_1.ContextKeyExpr.not("config.editor.stablePeek"))}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:contextkey_1.ContextKeyExpr.and(exports.ctxReferenceSearchVisible,listService_1.WorkbenchListFocusContextKey,listService_1.WorkbenchTreeElementCanCollapse.negate(),listService_1.WorkbenchTreeElementCanExpand.negate()),handler(accessor){var _a;const focus=null===(_a=accessor.get(listService_1.IListService).lastFocusedList)||void 0===_a?void 0:_a.getFocus();Array.isArray(focus)&&focus[0]instanceof referencesModel_1.OneReference&&withController(accessor,(controller=>controller.revealReference(focus[0])))}}),keybindingsRegistry_1.KeybindingsRegistry.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:contextkey_1.ContextKeyExpr.and(exports.ctxReferenceSearchVisible,listService_1.WorkbenchListFocusContextKey,listService_1.WorkbenchTreeElementCanCollapse.negate(),listService_1.WorkbenchTreeElementCanExpand.negate()),handler(accessor){var _a;const focus=null===(_a=accessor.get(listService_1.IListService).lastFocusedList)||void 0===_a?void 0:_a.getFocus();Array.isArray(focus)&&focus[0]instanceof referencesModel_1.OneReference&&withController(accessor,(controller=>controller.openReference(focus[0],!0,!0)))}}),commands_1.CommandsRegistry.registerCommand("openReference",(accessor=>{var _a;const focus=null===(_a=accessor.get(listService_1.IListService).lastFocusedList)||void 0===_a?void 0:_a.getFocus();Array.isArray(focus)&&focus[0]instanceof referencesModel_1.OneReference&&withController(accessor,(controller=>controller.openReference(focus[0],!1,!0)))}))})),define(__m[210],__M([1,0,34,46,10,58,16,19,25,108,150,15,29,164,11,3,24,27,302,129,683,160,110,545,37,26,17,9,39,73,292,20]),(function(require,exports,browser_1,aria_1,async_1,keyCodes_1,platform_1,types_1,uri_1,editorState_1,editorBrowser_1,editorExtensions_1,codeEditorService_1,embeddedCodeEditorWidget_1,corePosition,range_1,editorContextKeys_1,languages_1,referencesController_1,referencesModel_1,symbolNavigation_1,messageController_1,peekView_1,nls,actions_1,commands_1,contextkey_1,instantiation_1,notification_1,progress_1,goToSymbol_1,languageFeatures_1){"use strict";var _a,_b,_c,_d,_e,_f,_g,_h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DefinitionAction=exports.SymbolNavigationAction=exports.SymbolNavigationAnchor=void 0,actions_1.MenuRegistry.appendMenuItem(actions_1.MenuId.EditorContext,{submenu:actions_1.MenuId.EditorContextPeek,title:nls.localize(0,null),group:"navigation",order:100});const _goToActionIds=new Set;function registerGoToAction(ctor){const result=new ctor;return(0,editorExtensions_1.registerInstantiatedEditorAction)(result),_goToActionIds.add(result.id),result}class SymbolNavigationAnchor{constructor(model,position){this.model=model,this.position=position}static is(thing){return!(!thing||"object"!=typeof thing)&&(thing instanceof SymbolNavigationAnchor||!(!corePosition.Position.isIPosition(thing.position)||!thing.model))}}exports.SymbolNavigationAnchor=SymbolNavigationAnchor;class SymbolNavigationAction extends editorExtensions_1.EditorAction{constructor(configuration,opts){super(opts),this.configuration=configuration}run(accessor,editor,arg){if(!editor.hasModel())return Promise.resolve(void 0);const notificationService=accessor.get(notification_1.INotificationService),editorService=accessor.get(codeEditorService_1.ICodeEditorService),progressService=accessor.get(progress_1.IEditorProgressService),symbolNavService=accessor.get(symbolNavigation_1.ISymbolNavigationService),languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),model=editor.getModel(),position=editor.getPosition(),anchor=SymbolNavigationAnchor.is(arg)?arg:new SymbolNavigationAnchor(model,position),cts=new editorState_1.EditorStateCancellationTokenSource(editor,5),promise=(0,async_1.raceCancellation)(this._getLocationModel(languageFeaturesService,anchor.model,anchor.position,cts.token),cts.token).then((references=>__awaiter(this,void 0,void 0,(function*(){var _a;if(!references||cts.token.isCancellationRequested)return;let altAction;if((0,aria_1.alert)(references.ariaMessage),references.referenceAt(model.uri,position)){const altActionId=this._getAlternativeCommand(editor);altActionId!==this.id&&_goToActionIds.has(altActionId)&&(altAction=editor.getAction(altActionId))}const referenceCount=references.references.length;if(0===referenceCount){if(!this.configuration.muteMessage){const info=model.getWordAtPosition(position);null===(_a=messageController_1.MessageController.get(editor))||void 0===_a||_a.showMessage(this._getNoResultFoundMessage(info),position)}}else{if(1!==referenceCount||!altAction)return this._onResult(editorService,symbolNavService,editor,references);altAction.run()}}))),(err=>{notificationService.error(err)})).finally((()=>{cts.dispose()}));return progressService.showWhile(promise,250),promise}_onResult(editorService,symbolNavService,editor,model){return __awaiter(this,void 0,void 0,(function*(){const gotoLocation=this._getGoToPreference(editor);if(editor instanceof embeddedCodeEditorWidget_1.EmbeddedCodeEditorWidget||!(this.configuration.openInPeek||"peek"===gotoLocation&&model.references.length>1)){const next=model.firstReference(),peek=model.references.length>1&&"gotoAndPeek"===gotoLocation,targetEditor=yield this._openReference(editor,editorService,next,this.configuration.openToSide,!peek);peek&&targetEditor?this._openInPeek(targetEditor,model):model.dispose(),"goto"===gotoLocation&&symbolNavService.put(next)}else this._openInPeek(editor,model)}))}_openReference(editor,editorService,reference,sideBySide,highlight){return __awaiter(this,void 0,void 0,(function*(){let range;if((0,languages_1.isLocationLink)(reference)&&(range=reference.targetSelectionRange),range||(range=reference.range),!range)return;const targetEditor=yield editorService.openCodeEditor({resource:reference.uri,options:{selection:range_1.Range.collapseToStart(range),selectionRevealType:3,selectionSource:"code.jump"}},editor,sideBySide);if(targetEditor){if(highlight){const modelNow=targetEditor.getModel(),ids=targetEditor.deltaDecorations([],[{range,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{targetEditor.getModel()===modelNow&&targetEditor.deltaDecorations(ids,[])}),350)}return targetEditor}}))}_openInPeek(target,model){const controller=referencesController_1.ReferencesController.get(target);controller&&target.hasModel()?controller.toggleWidget(target.getSelection(),(0,async_1.createCancelablePromise)((_=>Promise.resolve(model))),this.configuration.openInPeek):model.dispose()}}exports.SymbolNavigationAction=SymbolNavigationAction;class DefinitionAction extends SymbolNavigationAction{_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getDefinitionsAtPosition)(languageFeaturesService.definitionProvider,model,position,token),nls.localize(1,null))}))}_getNoResultFoundMessage(info){return info&&info.word?nls.localize(2,null,info.word):nls.localize(3,null)}_getAlternativeCommand(editor){return editor.getOption(51).alternativeDefinitionCommand}_getGoToPreference(editor){return editor.getOption(51).multipleDefinitions}}exports.DefinitionAction=DefinitionAction;const goToDefinitionKb=platform_1.isWeb&&!browser_1.isStandalone?2118:70;registerGoToAction(((_a=class GoToDefinitionAction extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:GoToDefinitionAction.id,label:nls.localize(4,null),alias:"Go to Definition",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasDefinitionProvider,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:goToDefinitionKb,weight:100},contextMenuOpts:{group:"navigation",order:1.1}}),commands_1.CommandsRegistry.registerCommandAlias("editor.action.goToDeclaration",GoToDefinitionAction.id)}}).id="editor.action.revealDefinition",_a)),registerGoToAction(((_b=class OpenDefinitionToSideAction extends DefinitionAction{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:OpenDefinitionToSideAction.id,label:nls.localize(5,null),alias:"Open Definition to the Side",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasDefinitionProvider,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,goToDefinitionKb),weight:100}}),commands_1.CommandsRegistry.registerCommandAlias("editor.action.openDeclarationToTheSide",OpenDefinitionToSideAction.id)}}).id="editor.action.revealDefinitionAside",_b)),registerGoToAction(((_c=class PeekDefinitionAction extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:PeekDefinitionAction.id,label:nls.localize(6,null),alias:"Peek Definition",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasDefinitionProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:582,linux:{primary:3140},weight:100},contextMenuOpts:{menuId:actions_1.MenuId.EditorContextPeek,group:"peek",order:2}}),commands_1.CommandsRegistry.registerCommandAlias("editor.action.previewDeclaration",PeekDefinitionAction.id)}}).id="editor.action.peekDefinition",_c));class DeclarationAction extends SymbolNavigationAction{_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getDeclarationsAtPosition)(languageFeaturesService.declarationProvider,model,position,token),nls.localize(7,null))}))}_getNoResultFoundMessage(info){return info&&info.word?nls.localize(8,null,info.word):nls.localize(9,null)}_getAlternativeCommand(editor){return editor.getOption(51).alternativeDeclarationCommand}_getGoToPreference(editor){return editor.getOption(51).multipleDeclarations}}registerGoToAction(((_d=class GoToDeclarationAction extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:GoToDeclarationAction.id,label:nls.localize(10,null),alias:"Go to Declaration",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasDeclarationProvider,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{group:"navigation",order:1.3}})}_getNoResultFoundMessage(info){return info&&info.word?nls.localize(11,null,info.word):nls.localize(12,null)}}).id="editor.action.revealDeclaration",_d)),registerGoToAction(class PeekDeclarationAction extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",label:nls.localize(13,null),alias:"Peek Declaration",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasDeclarationProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:actions_1.MenuId.EditorContextPeek,group:"peek",order:3}})}});class TypeDefinitionAction extends SymbolNavigationAction{_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getTypeDefinitionsAtPosition)(languageFeaturesService.typeDefinitionProvider,model,position,token),nls.localize(14,null))}))}_getNoResultFoundMessage(info){return info&&info.word?nls.localize(15,null,info.word):nls.localize(16,null)}_getAlternativeCommand(editor){return editor.getOption(51).alternativeTypeDefinitionCommand}_getGoToPreference(editor){return editor.getOption(51).multipleTypeDefinitions}}registerGoToAction(((_e=class GoToTypeDefinitionAction extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:GoToTypeDefinitionAction.ID,label:nls.localize(17,null),alias:"Go to Type Definition",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasTypeDefinitionProvider,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:0,weight:100},contextMenuOpts:{group:"navigation",order:1.4}})}}).ID="editor.action.goToTypeDefinition",_e)),registerGoToAction(((_f=class PeekTypeDefinitionAction extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:PeekTypeDefinitionAction.ID,label:nls.localize(18,null),alias:"Peek Type Definition",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasTypeDefinitionProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:actions_1.MenuId.EditorContextPeek,group:"peek",order:4}})}}).ID="editor.action.peekTypeDefinition",_f));class ImplementationAction extends SymbolNavigationAction{_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getImplementationsAtPosition)(languageFeaturesService.implementationProvider,model,position,token),nls.localize(19,null))}))}_getNoResultFoundMessage(info){return info&&info.word?nls.localize(20,null,info.word):nls.localize(21,null)}_getAlternativeCommand(editor){return editor.getOption(51).alternativeImplementationCommand}_getGoToPreference(editor){return editor.getOption(51).multipleImplementations}}registerGoToAction(((_g=class GoToImplementationAction extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:GoToImplementationAction.ID,label:nls.localize(22,null),alias:"Go to Implementations",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasImplementationProvider,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2118,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}}).ID="editor.action.goToImplementation",_g)),registerGoToAction(((_h=class PeekImplementationAction extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:PeekImplementationAction.ID,label:nls.localize(23,null),alias:"Peek Implementations",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasImplementationProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:3142,weight:100},contextMenuOpts:{menuId:actions_1.MenuId.EditorContextPeek,group:"peek",order:5}})}}).ID="editor.action.peekImplementation",_h));class ReferencesAction extends SymbolNavigationAction{_getNoResultFoundMessage(info){return info?nls.localize(24,null,info.word):nls.localize(25,null)}_getAlternativeCommand(editor){return editor.getOption(51).alternativeReferenceCommand}_getGoToPreference(editor){return editor.getOption(51).multipleReferences}}registerGoToAction(class GoToReferencesAction extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",label:nls.localize(26,null),alias:"Go to References",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasReferenceProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1094,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getReferencesAtPosition)(languageFeaturesService.referenceProvider,model,position,!0,token),nls.localize(27,null))}))}}),registerGoToAction(class PeekReferencesAction extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",label:nls.localize(28,null),alias:"Peek References",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.hasReferenceProvider,peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:actions_1.MenuId.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(languageFeaturesService,model,position,token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(yield(0,goToSymbol_1.getReferencesAtPosition)(languageFeaturesService.referenceProvider,model,position,!1,token),nls.localize(29,null))}))}});class GenericGoToLocationAction extends SymbolNavigationAction{constructor(config,_references,_gotoMultipleBehaviour){super(config,{id:"editor.action.goToLocation",label:nls.localize(30,null),alias:"Go to Any Symbol",precondition:contextkey_1.ContextKeyExpr.and(peekView_1.PeekContext.notInPeekEditor,editorContextKeys_1.EditorContextKeys.isInWalkThroughSnippet.toNegated())}),this._references=_references,this._gotoMultipleBehaviour=_gotoMultipleBehaviour}_getLocationModel(languageFeaturesService,_model,_position,_token){return __awaiter(this,void 0,void 0,(function*(){return new referencesModel_1.ReferencesModel(this._references,nls.localize(31,null))}))}_getNoResultFoundMessage(info){return info&&nls.localize(32,null,info.word)||""}_getGoToPreference(editor){var _a;return null!==(_a=this._gotoMultipleBehaviour)&&void 0!==_a?_a:editor.getOption(51).multipleReferences}_getAlternativeCommand(){return""}}commands_1.CommandsRegistry.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:uri_1.URI},{name:"position",description:"The position at which to start",constraint:corePosition.Position.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(accessor,resource,position,references,multiple,noResultsMessage,openInPeek)=>__awaiter(void 0,void 0,void 0,(function*(){(0,types_1.assertType)(uri_1.URI.isUri(resource)),(0,types_1.assertType)(corePosition.Position.isIPosition(position)),(0,types_1.assertType)(Array.isArray(references)),(0,types_1.assertType)(void 0===multiple||"string"==typeof multiple),(0,types_1.assertType)(void 0===openInPeek||"boolean"==typeof openInPeek);const editorService=accessor.get(codeEditorService_1.ICodeEditorService),editor=yield editorService.openCodeEditor({resource},editorService.getFocusedCodeEditor());if((0,editorBrowser_1.isCodeEditor)(editor))return editor.setPosition(position),editor.revealPositionInCenterIfOutsideViewport(position,0),editor.invokeWithinContext((accessor=>{const command=new class extends GenericGoToLocationAction{_getNoResultFoundMessage(info){return noResultsMessage||super._getNoResultFoundMessage(info)}}({muteMessage:!Boolean(noResultsMessage),openInPeek:Boolean(openInPeek),openToSide:!1},references,multiple);accessor.get(instantiation_1.IInstantiationService).invokeFunction(command.run.bind(command),editor)}))}))}),commands_1.CommandsRegistry.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:uri_1.URI},{name:"position",description:"The position at which to start",constraint:corePosition.Position.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(accessor,resource,position,references,multiple)=>__awaiter(void 0,void 0,void 0,(function*(){accessor.get(commands_1.ICommandService).executeCommand("editor.action.goToLocations",resource,position,references,multiple,void 0,!0)}))}),commands_1.CommandsRegistry.registerCommand({id:"editor.action.findReferences",handler:(accessor,resource,position)=>{(0,types_1.assertType)(uri_1.URI.isUri(resource)),(0,types_1.assertType)(corePosition.Position.isIPosition(position));const languageFeaturesService=accessor.get(languageFeatures_1.ILanguageFeaturesService),codeEditorService=accessor.get(codeEditorService_1.ICodeEditorService);return codeEditorService.openCodeEditor({resource},codeEditorService.getFocusedCodeEditor()).then((control=>{if(!(0,editorBrowser_1.isCodeEditor)(control)||!control.hasModel())return;const controller=referencesController_1.ReferencesController.get(control);if(!controller)return;const references=(0,async_1.createCancelablePromise)((token=>(0,goToSymbol_1.getReferencesAtPosition)(languageFeaturesService.referenceProvider,control.getModel(),corePosition.Position.lift(position),!1,token).then((references=>new referencesModel_1.ReferencesModel(references,nls.localize(33,null)))))),range=new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column);return Promise.resolve(controller.toggleWidget(range,references,!1))}))}}),commands_1.CommandsRegistry.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations"),actions_1.MenuRegistry.appendMenuItems([{id:actions_1.MenuId.MenubarGoMenu,item:{command:{id:"editor.action.revealDefinition",title:nls.localize(34,null)},group:"4_symbol_nav",order:2}},{id:actions_1.MenuId.MenubarGoMenu,item:{command:{id:"editor.action.revealDeclaration",title:nls.localize(35,null)},group:"4_symbol_nav",order:3}},{id:actions_1.MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToTypeDefinition",title:nls.localize(36,null)},group:"4_symbol_nav",order:3}},{id:actions_1.MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToImplementation",title:nls.localize(37,null)},group:"4_symbol_nav",order:4}},{id:actions_1.MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToReferences",title:nls.localize(38,null)},group:"4_symbol_nav",order:5}}])})),define(__m[303],__M([1,0,10,13,68,2,19,108,15,11,3,35,56,192,110,546,17,23,14,210,292,20,380]),(function(require,exports,async_1,errors_1,htmlContent_1,lifecycle_1,types_1,editorState_1,editorExtensions_1,position_1,range_1,language_1,resolverService_1,clickLinkGesture_1,peekView_1,nls,contextkey_1,colorRegistry_1,themeService_1,goToCommands_1,goToSymbol_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GotoDefinitionAtPositionEditorContribution=void 0;let GotoDefinitionAtPositionEditorContribution=class GotoDefinitionAtPositionEditorContribution{constructor(editor,textModelResolverService,languageService,languageFeaturesService){this.textModelResolverService=textModelResolverService,this.languageService=languageService,this.languageFeaturesService=languageFeaturesService,this.toUnhook=new lifecycle_1.DisposableStore,this.toUnhookForKeyboard=new lifecycle_1.DisposableStore,this.linkDecorations=[],this.currentWordAtPosition=null,this.previousPromise=null,this.editor=editor;let linkGesture=new clickLinkGesture_1.ClickLinkGesture(editor);this.toUnhook.add(linkGesture),this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown((([mouseEvent,keyboardEvent])=>{this.startFindDefinitionFromMouse(mouseEvent,(0,types_1.withNullAsUndefined)(keyboardEvent))}))),this.toUnhook.add(linkGesture.onExecute((mouseEvent=>{this.isEnabled(mouseEvent)&&this.gotoDefinition(mouseEvent.target.position,mouseEvent.hasSideBySideModifier).then((()=>{this.removeLinkDecorations()}),(error=>{this.removeLinkDecorations(),(0,errors_1.onUnexpectedError)(error)}))}))),this.toUnhook.add(linkGesture.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(editor){return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID)}startFindDefinitionFromCursor(position){return this.startFindDefinition(position).then((()=>{this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}))}startFindDefinitionFromMouse(mouseEvent,withKey){if(9===mouseEvent.target.type&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(mouseEvent,withKey))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const position=mouseEvent.target.position;this.startFindDefinition(position)}startFindDefinition(position){var _a;this.toUnhookForKeyboard.clear();const word=position?null===(_a=this.editor.getModel())||void 0===_a?void 0:_a.getWordAtPosition(position):null;if(!word)return this.currentWordAtPosition=null,this.removeLinkDecorations(),Promise.resolve(0);if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===word.startColumn&&this.currentWordAtPosition.endColumn===word.endColumn&&this.currentWordAtPosition.word===word.word)return Promise.resolve(0);this.currentWordAtPosition=word;let state=new editorState_1.EditorState(this.editor,15);return this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=(0,async_1.createCancelablePromise)((token=>this.findDefinition(position,token))),this.previousPromise.then((results=>{if(results&&results.length&&state.validate(this.editor))if(results.length>1)this.addDecoration(new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,word.endColumn),(new htmlContent_1.MarkdownString).appendText(nls.localize(0,null,results.length)));else{let result=results[0];if(!result.uri)return;this.textModelResolverService.createModelReference(result.uri).then((ref=>{if(!ref.object||!ref.object.textEditorModel)return void ref.dispose();const{object:{textEditorModel}}=ref,{startLineNumber}=result.range;if(startLineNumber<1||startLineNumber>textEditorModel.getLineCount())return void ref.dispose();const previewValue=this.getPreviewValue(textEditorModel,startLineNumber,result);let wordRange;wordRange=result.originSelectionRange?range_1.Range.lift(result.originSelectionRange):new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,word.endColumn);const languageId=this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);this.addDecoration(wordRange,(new htmlContent_1.MarkdownString).appendCodeblock(languageId||"",previewValue)),ref.dispose()}))}else this.removeLinkDecorations()})).then(void 0,errors_1.onUnexpectedError)}getPreviewValue(textEditorModel,startLineNumber,result){let rangeToUse=result.targetSelectionRange?result.range:this.getPreviewRangeBasedOnBrackets(textEditorModel,startLineNumber);rangeToUse.endLineNumber-rangeToUse.startLineNumber>=GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES&&(rangeToUse=this.getPreviewRangeBasedOnIndentation(textEditorModel,startLineNumber));return this.stripIndentationFromPreviewRange(textEditorModel,startLineNumber,rangeToUse)}stripIndentationFromPreviewRange(textEditorModel,startLineNumber,previewRange){let minIndent=textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);for(let endLineNumber=startLineNumber+1;endLineNumber<previewRange.endLineNumber;endLineNumber++){const endIndent=textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);minIndent=Math.min(minIndent,endIndent)}return textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\s{${minIndent-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(textEditorModel,startLineNumber){const startIndent=textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber),maxLineNumber=Math.min(textEditorModel.getLineCount(),startLineNumber+GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);let endLineNumber=startLineNumber+1;for(;endLineNumber<maxLineNumber;endLineNumber++){if(startIndent===textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber))break}return new range_1.Range(startLineNumber,1,endLineNumber+1,1)}getPreviewRangeBasedOnBrackets(textEditorModel,startLineNumber){const maxLineNumber=Math.min(textEditorModel.getLineCount(),startLineNumber+GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES),brackets=[];let ignoreFirstEmpty=!0,currentBracket=textEditorModel.bracketPairs.findNextBracket(new position_1.Position(startLineNumber,1));for(;null!==currentBracket;){if(0===brackets.length)brackets.push(currentBracket);else{const lastBracket=brackets[brackets.length-1];if(lastBracket.open[0]===currentBracket.open[0]&&lastBracket.isOpen&&!currentBracket.isOpen?brackets.pop():brackets.push(currentBracket),0===brackets.length){if(!ignoreFirstEmpty)return new range_1.Range(startLineNumber,1,currentBracket.range.endLineNumber+1,1);ignoreFirstEmpty=!1}}const maxColumn=textEditorModel.getLineMaxColumn(startLineNumber);let nextLineNumber=currentBracket.range.endLineNumber,nextColumn=currentBracket.range.endColumn;if(maxColumn===currentBracket.range.endColumn&&(nextLineNumber++,nextColumn=1),nextLineNumber>maxLineNumber)return new range_1.Range(startLineNumber,1,maxLineNumber+1,1);currentBracket=textEditorModel.bracketPairs.findNextBracket(new position_1.Position(nextLineNumber,nextColumn))}return new range_1.Range(startLineNumber,1,maxLineNumber+1,1)}addDecoration(range,hoverMessage){const newDecorations={range,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage}};this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[newDecorations])}removeLinkDecorations(){this.linkDecorations.length>0&&(this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[]))}isEnabled(mouseEvent,withKey){return this.editor.hasModel()&&mouseEvent.isNoneOrSingleMouseDown&&6===mouseEvent.target.type&&(mouseEvent.hasTriggerModifier||!!withKey&&withKey.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(position,token){const model=this.editor.getModel();return model?(0,goToSymbol_1.getDefinitionsAtPosition)(this.languageFeaturesService.definitionProvider,model,position,token):Promise.resolve(null)}gotoDefinition(position,openToSide){return this.editor.setPosition(position),this.editor.invokeWithinContext((accessor=>{const canPeek=!openToSide&&this.editor.getOption(78)&&!this.isInPeekEditor(accessor);return new goToCommands_1.DefinitionAction({openToSide,openInPeek:canPeek,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(accessor,this.editor)}))}isInPeekEditor(accessor){const contextKeyService=accessor.get(contextkey_1.IContextKeyService);return peekView_1.PeekContext.inPeekEditor.getValue(contextKeyService)}dispose(){this.toUnhook.dispose()}};GotoDefinitionAtPositionEditorContribution.ID="editor.contrib.gotodefinitionatposition",GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES=8,GotoDefinitionAtPositionEditorContribution=__decorate([__param(1,resolverService_1.ITextModelService),__param(2,language_1.ILanguageService),__param(3,languageFeatures_1.ILanguageFeaturesService)],GotoDefinitionAtPositionEditorContribution),exports.GotoDefinitionAtPositionEditorContribution=GotoDefinitionAtPositionEditorContribution,(0,editorExtensions_1.registerEditorContribution)(GotoDefinitionAtPositionEditorContribution.ID,GotoDefinitionAtPositionEditorContribution),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const activeLinkForeground=theme.getColor(colorRegistry_1.editorActiveLinkForeground);activeLinkForeground&&collector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`)}))})),define(__m[739],__M([1,0,7,18,10,13,2,42,3,201,159,294,155,301,554,79,53,73,23,14,20]),(function(require,exports,dom,arrays_1,async_1,errors_1,lifecycle_1,resources_1,range_1,markerDecorations_1,codeAction_1,codeActionCommands_1,types_1,gotoError_1,nls,markers_1,opener_1,progress_1,colorRegistry_1,themeService_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkerHoverParticipant=exports.MarkerHover=void 0;const $=dom.$;class MarkerHover{constructor(owner,range,marker){this.owner=owner,this.range=range,this.marker=marker}isValidForHoverAnchor(anchor){return 1===anchor.type&&this.range.startColumn<=anchor.range.startColumn&&this.range.endColumn>=anchor.range.endColumn}}exports.MarkerHover=MarkerHover;const markerCodeActionTrigger={type:1,filter:{include:types_1.CodeActionKind.QuickFix}};let MarkerHoverParticipant=class MarkerHoverParticipant{constructor(_editor,_markerDecorationsService,_openerService,_languageFeaturesService){this._editor=_editor,this._markerDecorationsService=_markerDecorationsService,this._openerService=_openerService,this._languageFeaturesService=_languageFeaturesService,this.hoverOrdinal=5,this.recentMarkerCodeActionsInfo=void 0}computeSync(anchor,lineDecorations){if(!this._editor.hasModel()||1!==anchor.type)return[];const model=this._editor.getModel(),lineNumber=anchor.range.startLineNumber,maxColumn=model.getLineMaxColumn(lineNumber),result=[];for(const d of lineDecorations){const startColumn=d.range.startLineNumber===lineNumber?d.range.startColumn:1,endColumn=d.range.endLineNumber===lineNumber?d.range.endColumn:maxColumn,marker=this._markerDecorationsService.getMarker(model.uri,d);if(!marker)continue;const range=new range_1.Range(anchor.range.startLineNumber,startColumn,anchor.range.startLineNumber,endColumn);result.push(new MarkerHover(this,range,marker))}return result}renderHoverParts(context,hoverParts){if(!hoverParts.length)return lifecycle_1.Disposable.None;const disposables=new lifecycle_1.DisposableStore;hoverParts.forEach((msg=>context.fragment.appendChild(this.renderMarkerHover(msg,disposables))));const markerHoverForStatusbar=1===hoverParts.length?hoverParts[0]:hoverParts.sort(((a,b)=>markers_1.MarkerSeverity.compare(a.marker.severity,b.marker.severity)))[0];return this.renderMarkerStatusbar(context,markerHoverForStatusbar,disposables),disposables}renderMarkerHover(markerHover,disposables){const hoverElement=$("div.hover-row"),markerElement=dom.append(hoverElement,$("div.marker.hover-contents")),{source,message,code,relatedInformation}=markerHover.marker;this._editor.applyFontInfo(markerElement);const messageElement=dom.append(markerElement,$("span"));if(messageElement.style.whiteSpace="pre-wrap",messageElement.innerText=message,source||code)if(code&&"string"!=typeof code){const sourceAndCodeElement=$("span");if(source){dom.append(sourceAndCodeElement,$("span")).innerText=source}const codeLink=dom.append(sourceAndCodeElement,$("a.code-link"));codeLink.setAttribute("href",code.target.toString()),disposables.add(dom.addDisposableListener(codeLink,"click",(e=>{this._openerService.open(code.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));dom.append(codeLink,$("span")).innerText=code.value;const detailsElement=dom.append(markerElement,sourceAndCodeElement);detailsElement.style.opacity="0.6",detailsElement.style.paddingLeft="6px"}else{const detailsElement=dom.append(markerElement,$("span"));detailsElement.style.opacity="0.6",detailsElement.style.paddingLeft="6px",detailsElement.innerText=source&&code?`${source}(${code})`:source||`(${code})`}if((0,arrays_1.isNonEmptyArray)(relatedInformation))for(const{message,resource,startLineNumber,startColumn}of relatedInformation){const relatedInfoContainer=dom.append(markerElement,$("div"));relatedInfoContainer.style.marginTop="8px";const a=dom.append(relatedInfoContainer,$("a"));a.innerText=`${(0,resources_1.basename)(resource)}(${startLineNumber}, ${startColumn}): `,a.style.cursor="pointer",disposables.add(dom.addDisposableListener(a,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(resource,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber,startColumn}}}).catch(errors_1.onUnexpectedError)})));const messageElement=dom.append(relatedInfoContainer,$("span"));messageElement.innerText=message,this._editor.applyFontInfo(messageElement)}return hoverElement}renderMarkerStatusbar(context,markerHover,disposables){if(markerHover.marker.severity!==markers_1.MarkerSeverity.Error&&markerHover.marker.severity!==markers_1.MarkerSeverity.Warning&&markerHover.marker.severity!==markers_1.MarkerSeverity.Info||context.statusBar.addAction({label:nls.localize(0,null),commandId:gotoError_1.NextMarkerAction.ID,run:()=>{var _a;context.hide(),null===(_a=gotoError_1.MarkerController.get(this._editor))||void 0===_a||_a.showAtMarker(markerHover.marker),this._editor.focus()}}),!this._editor.getOption(81)){const quickfixPlaceholderElement=context.statusBar.append($("div"));this.recentMarkerCodeActionsInfo&&(markers_1.IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker)===markers_1.IMarkerData.makeKey(markerHover.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(quickfixPlaceholderElement.textContent=nls.localize(1,null)):this.recentMarkerCodeActionsInfo=void 0);const updatePlaceholderDisposable=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?lifecycle_1.Disposable.None:disposables.add((0,async_1.disposableTimeout)((()=>quickfixPlaceholderElement.textContent=nls.localize(2,null)),200));quickfixPlaceholderElement.textContent||(quickfixPlaceholderElement.textContent=String.fromCharCode(160));const codeActionsPromise=this.getCodeActions(markerHover.marker);disposables.add((0,lifecycle_1.toDisposable)((()=>codeActionsPromise.cancel()))),codeActionsPromise.then((actions=>{if(updatePlaceholderDisposable.dispose(),this.recentMarkerCodeActionsInfo={marker:markerHover.marker,hasCodeActions:actions.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return actions.dispose(),void(quickfixPlaceholderElement.textContent=nls.localize(3,null));quickfixPlaceholderElement.style.display="none";let showing=!1;disposables.add((0,lifecycle_1.toDisposable)((()=>{showing||actions.dispose()}))),context.statusBar.addAction({label:nls.localize(4,null),commandId:codeActionCommands_1.QuickFixAction.Id,run:target=>{showing=!0;const controller=codeActionCommands_1.QuickFixController.get(this._editor),elementPosition=dom.getDomNodePagePosition(target);context.hide(),null==controller||controller.showCodeActions(markerCodeActionTrigger,actions,{x:elementPosition.left+6,y:elementPosition.top+elementPosition.height+6})}})}),errors_1.onUnexpectedError)}}getCodeActions(marker){return(0,async_1.createCancelablePromise)((cancellationToken=>(0,codeAction_1.getCodeActions)(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new range_1.Range(marker.startLineNumber,marker.startColumn,marker.endLineNumber,marker.endColumn),markerCodeActionTrigger,progress_1.Progress.None,cancellationToken)))}};MarkerHoverParticipant=__decorate([__param(1,markerDecorations_1.IMarkerDecorationsService),__param(2,opener_1.IOpenerService),__param(3,languageFeatures_1.ILanguageFeaturesService)],MarkerHoverParticipant),exports.MarkerHoverParticipant=MarkerHoverParticipant,(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const linkFg=theme.getColor(colorRegistry_1.textLinkForeground);linkFg&&collector.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${linkFg}; }`);const activeLinkFg=theme.getColor(colorRegistry_1.textLinkActiveForeground);activeLinkFg&&collector.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${activeLinkFg}; }`)}))})),define(__m[304],__M([1,0,58,2,15,3,24,35,303,728,634,552,17,9,53,23,14,86,207,739]),(function(require,exports,keyCodes_1,lifecycle_1,editorExtensions_1,range_1,editorContextKeys_1,language_1,goToDefinitionAtPosition_1,contentHover_1,marginHover_1,nls,contextkey_1,instantiation_1,opener_1,colorRegistry_1,themeService_1,hoverTypes_1,markdownHoverParticipant_1,markerHoverParticipant_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModesHoverController=void 0;let ModesHoverController=class ModesHoverController{constructor(_editor,_instantiationService,_openerService,_languageService,_contextKeyService){this._editor=_editor,this._instantiationService=_instantiationService,this._openerService=_openerService,this._languageService=_languageService,this._toUnhook=new lifecycle_1.DisposableStore,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration((e=>{e.hasChanged(53)&&(this._unhookEvents(),this._hookEvents())}))}static get(editor){return editor.getContribution(ModesHoverController.ID)}_hookEvents(){const hideWidgetsEventHandler=()=>this._hideWidgets(),hoverOpts=this._editor.getOption(53);this._isHoverEnabled=hoverOpts.enabled,this._isHoverSticky=hoverOpts.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave(hideWidgetsEventHandler)),this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler)),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(mouseEvent){this._isMouseDown=!0;const target=mouseEvent.target;9!==target.type||target.detail!==contentHover_1.ContentHoverWidget.ID?12===target.type&&target.detail===marginHover_1.MarginHoverWidget.ID||(12!==target.type&&(this._hoverClicked=!1),this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(mouseEvent){this._isMouseDown=!1}_onEditorMouseMove(mouseEvent){var _a,_b,_c,_d,_e;const target=mouseEvent.target;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&9===target.type&&target.detail===contentHover_1.ContentHoverWidget.ID)return;if(this._isHoverSticky&&!(null===(_b=null===(_a=mouseEvent.event.browserEvent.view)||void 0===_a?void 0:_a.getSelection())||void 0===_b?void 0:_b.isCollapsed))return;if(!this._isHoverSticky&&9===target.type&&target.detail===contentHover_1.ContentHoverWidget.ID&&(null===(_c=this._contentWidget)||void 0===_c?void 0:_c.isColorPickerVisible()))return;if(this._isHoverSticky&&12===target.type&&target.detail===marginHover_1.MarginHoverWidget.ID)return;if(!this._isHoverEnabled)return void this._hideWidgets();if(!this._getOrCreateContentWidget().maybeShowAt(mouseEvent))return 2===target.type&&target.position?(null===(_e=this._contentWidget)||void 0===_e||_e.hide(),this._glyphWidget||(this._glyphWidget=new marginHover_1.MarginHoverWidget(this._editor,this._languageService,this._openerService)),void this._glyphWidget.startShowingAt(target.position.lineNumber)):void this._hideWidgets();null===(_d=this._glyphWidget)||void 0===_d||_d.hide()}_onKeyDown(e){5!==e.keyCode&&6!==e.keyCode&&57!==e.keyCode&&4!==e.keyCode&&this._hideWidgets()}_hideWidgets(){var _a,_b,_c;this._isMouseDown&&this._hoverClicked&&(null===(_a=this._contentWidget)||void 0===_a?void 0:_a.isColorPickerVisible())||(this._hoverClicked=!1,null===(_b=this._glyphWidget)||void 0===_b||_b.hide(),null===(_c=this._contentWidget)||void 0===_c||_c.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(contentHover_1.ContentHoverController,this._editor)),this._contentWidget}isColorPickerVisible(){var _a;return(null===(_a=this._contentWidget)||void 0===_a?void 0:_a.isColorPickerVisible())||!1}showContentHover(range,mode,focus){this._getOrCreateContentWidget().startShowingAtRange(range,mode,focus)}dispose(){var _a,_b;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),null===(_a=this._glyphWidget)||void 0===_a||_a.dispose(),null===(_b=this._contentWidget)||void 0===_b||_b.dispose()}};ModesHoverController.ID="editor.contrib.hover",ModesHoverController=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,opener_1.IOpenerService),__param(3,language_1.ILanguageService),__param(4,contextkey_1.IContextKeyService)],ModesHoverController),exports.ModesHoverController=ModesHoverController;class ShowHoverAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.showHover",label:nls.localize(0,null),alias:"Show Hover",precondition:void 0,kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:(0,keyCodes_1.KeyChord)(2089,2087),weight:100}})}run(accessor,editor){if(!editor.hasModel())return;let controller=ModesHoverController.get(editor);if(!controller)return;const position=editor.getPosition(),range=new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),focus=2===editor.getOption(2);controller.showContentHover(range,1,focus)}}class ShowDefinitionPreviewHoverAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:nls.localize(1,null),alias:"Show Definition Preview Hover",precondition:void 0})}run(accessor,editor){const controller=ModesHoverController.get(editor);if(!controller)return;const position=editor.getPosition();if(!position)return;const range=new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column),goto=goToDefinitionAtPosition_1.GotoDefinitionAtPositionEditorContribution.get(editor);if(!goto)return;goto.startFindDefinitionFromCursor(position).then((()=>{controller.showContentHover(range,1,!0)}))}}(0,editorExtensions_1.registerEditorContribution)(ModesHoverController.ID,ModesHoverController),(0,editorExtensions_1.registerEditorAction)(ShowHoverAction),(0,editorExtensions_1.registerEditorAction)(ShowDefinitionPreviewHoverAction),hoverTypes_1.HoverParticipantRegistry.register(markdownHoverParticipant_1.MarkdownHoverParticipant),hoverTypes_1.HoverParticipantRegistry.register(markerHoverParticipant_1.MarkerHoverParticipant),(0,themeService_1.registerThemingParticipant)(((theme,collector)=>{const editorHoverHighlightColor=theme.getColor(colorRegistry_1.editorHoverHighlight);editorHoverHighlightColor&&collector.addRule(`.monaco-editor .hoverHighlight { background-color: ${editorHoverHighlightColor}; }`);const hoverBackground=theme.getColor(colorRegistry_1.editorHoverBackground);hoverBackground&&collector.addRule(`.monaco-editor .monaco-hover { background-color: ${hoverBackground}; }`);const hoverBorder=theme.getColor(colorRegistry_1.editorHoverBorder);hoverBorder&&(collector.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${hoverBorder}; }`),collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(.5)}; }`),collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(.5)}; }`),collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(.5)}; }`));const link=theme.getColor(colorRegistry_1.textLinkForeground);link&&collector.addRule(`.monaco-editor .monaco-hover a { color: ${link}; }`);const linkHover=theme.getColor(colorRegistry_1.textLinkActiveForeground);linkHover&&collector.addRule(`.monaco-editor .monaco-hover a:hover { color: ${linkHover}; }`);const hoverForeground=theme.getColor(colorRegistry_1.editorHoverForeground);hoverForeground&&collector.addRule(`.monaco-editor .monaco-hover { color: ${hoverForeground}; }`);const actionsBackground=theme.getColor(colorRegistry_1.editorHoverStatusBarBackground);actionsBackground&&collector.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${actionsBackground}; }`);const codeBackground=theme.getColor(colorRegistry_1.textCodeBlockBackground);codeBackground&&collector.addRule(`.monaco-editor .monaco-hover code { background-color: ${codeBackground}; }`)}))})),define(__m[740],__M([1,0,2,15,3,299,720,304,86]),(function(require,exports,lifecycle_1,editorExtensions_1,range_1,colorDetector_1,colorHoverParticipant_1,hover_1,hoverTypes_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorContribution=void 0;class ColorContribution extends lifecycle_1.Disposable{constructor(_editor){super(),this._editor=_editor,this._register(_editor.onMouseDown((e=>this.onMouseDown(e))))}dispose(){super.dispose()}onMouseDown(mouseEvent){const target=mouseEvent.target;if(6!==target.type)return;if(!target.detail.injectedText)return;if(target.detail.injectedText.options.attachedData!==colorDetector_1.ColorDecorationInjectedTextMarker)return;if(!target.range)return;const hoverController=this._editor.getContribution(hover_1.ModesHoverController.ID);if(hoverController&&!hoverController.isColorPickerVisible()){const range=new range_1.Range(target.range.startLineNumber,target.range.startColumn+1,target.range.endLineNumber,target.range.endColumn+1);hoverController.showContentHover(range,1,!1)}}}exports.ColorContribution=ColorContribution,ColorContribution.ID="editor.contrib.colorContribution",(0,editorExtensions_1.registerEditorContribution)(ColorContribution.ID,ColorContribution),hoverTypes_1.HoverParticipantRegistry.register(colorHoverParticipant_1.ColorHoverParticipant)})),define(__m[741],__M([1,0,7,47,21,15,3,56,210,110,37,26,17,78,9,39]),(function(require,exports,dom,actions_1,cancellation_1,editorExtensions_1,range_1,resolverService_1,goToCommands_1,peekView_1,actions_2,commands_1,contextkey_1,contextView_1,instantiation_1,notification_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.goToDefinitionWithLocation=exports.showGoToContextMenu=void 0,exports.showGoToContextMenu=function showGoToContextMenu(accessor,editor,anchor,part){var _a;return __awaiter(this,void 0,void 0,(function*(){const resolverService=accessor.get(resolverService_1.ITextModelService),contextMenuService=accessor.get(contextView_1.IContextMenuService),commandService=accessor.get(commands_1.ICommandService),instaService=accessor.get(instantiation_1.IInstantiationService),notificationService=accessor.get(notification_1.INotificationService);if(yield part.item.resolve(cancellation_1.CancellationToken.None),!part.part.location)return;const location=part.part.location,menuActions=[],filter=new Set(actions_2.MenuRegistry.getMenuItems(actions_2.MenuId.EditorContext).map((item=>(0,actions_2.isIMenuItem)(item)?item.command.id:"")));for(const delegate of editorExtensions_1.EditorExtensionsRegistry.getEditorActions())delegate instanceof goToCommands_1.SymbolNavigationAction&&filter.has(delegate.id)&&menuActions.push(new actions_1.Action(delegate.id,delegate.label,void 0,!0,(()=>__awaiter(this,void 0,void 0,(function*(){const ref=yield resolverService.createModelReference(location.uri);try{yield instaService.invokeFunction(delegate.run.bind(delegate),editor,new goToCommands_1.SymbolNavigationAnchor(ref.object.textEditorModel,range_1.Range.getStartPosition(location.range)))}finally{ref.dispose()}})))));if(part.part.command){const{command}=part.part;menuActions.push(new actions_1.Separator),menuActions.push(new actions_1.Action(command.id,command.title,void 0,!0,(()=>__awaiter(this,void 0,void 0,(function*(){var _b;try{yield commandService.executeCommand(command.id,...null!==(_b=command.arguments)&&void 0!==_b?_b:[])}catch(err){notificationService.notify({severity:notification_1.Severity.Error,source:part.item.provider.displayName,message:err})}})))))}const useShadowDOM=editor.getOption(115);contextMenuService.showContextMenu({domForShadowRoot:useShadowDOM&&null!==(_a=editor.getDomNode())&&void 0!==_a?_a:void 0,getAnchor:()=>{const box=dom.getDomNodePagePosition(anchor);return{x:box.left,y:box.top+box.height+8}},getActions:()=>menuActions,onHide:()=>{editor.focus()},autoSelectFirstItem:!0})}))},exports.goToDefinitionWithLocation=function goToDefinitionWithLocation(accessor,event,editor,location){return __awaiter(this,void 0,void 0,(function*(){const resolverService=accessor.get(resolverService_1.ITextModelService),ref=yield resolverService.createModelReference(location.uri);yield editor.invokeWithinContext((accessor=>__awaiter(this,void 0,void 0,(function*(){const openToSide=event.hasSideBySideModifier,contextKeyService=accessor.get(contextkey_1.IContextKeyService),isInPeek=peekView_1.PeekContext.inPeekEditor.getValue(contextKeyService),canPeek=!openToSide&&editor.getOption(78)&&!isInPeek;return new goToCommands_1.DefinitionAction({openToSide,openInPeek:canPeek,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(accessor,editor,{model:ref.object.textEditorModel,position:range_1.Range.getStartPosition(location.range)})})))),ref.dispose()}))}})),define(__m[305],__M([1,0,10,21,13,2,49,19,25,133,32,3,27,50,38,67,20,56,192,262,741,26,52,9,39,23,14]),(function(require,exports,async_1,cancellation_1,errors_1,lifecycle_1,map_1,types_1,uri_1,editorDom_1,editorOptions_1,range_1,languages,model_1,textModel_1,languageFeatureDebounce_1,languageFeatures_1,resolverService_1,clickLinkGesture_1,inlayHints_1,inlayHintsLocations_1,commands_1,extensions_1,instantiation_1,notification_1,colors,themeService_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InlayHintsController=exports.RenderedInlayHintLabelPart=void 0;class InlayHintsCache{constructor(){this._entries=new map_1.LRUCache(50)}get(model){const key=InlayHintsCache._key(model);return this._entries.get(key)}set(model,value){const key=InlayHintsCache._key(model);this._entries.set(key,value)}static _key(model){return`${model.uri.toString()}/${model.getVersionId()}`}}const IInlayHintsCache=(0,instantiation_1.createDecorator)("IInlayHintsCache");(0,extensions_1.registerSingleton)(IInlayHintsCache,InlayHintsCache,!0);class RenderedInlayHintLabelPart{constructor(item,index){this.item=item,this.index=index}get part(){const label=this.item.hint.label;return"string"==typeof label?{label}:label[this.index]}}exports.RenderedInlayHintLabelPart=RenderedInlayHintLabelPart;class ActiveInlayHintInfo{constructor(part,hasTriggerModifier){this.part=part,this.hasTriggerModifier=hasTriggerModifier}}let InlayHintsController=class InlayHintsController{constructor(_editor,_languageFeaturesService,_featureDebounce,_inlayHintsCache,_commandService,_notificationService,_instaService){this._editor=_editor,this._languageFeaturesService=_languageFeaturesService,this._inlayHintsCache=_inlayHintsCache,this._commandService=_commandService,this._notificationService=_notificationService,this._instaService=_instaService,this._disposables=new lifecycle_1.DisposableStore,this._sessionDisposables=new lifecycle_1.DisposableStore,this._decorationsMetadata=new Map,this._ruleFactory=new editorDom_1.DynamicCssRules(this._editor),this._debounceInfo=_featureDebounce.for(_languageFeaturesService.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(_editor.onDidChangeModel((()=>this._update()))),this._disposables.add(_editor.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(_editor.onDidChangeConfiguration((e=>{e.hasChanged(127)&&this._update()}))),this._update()}static get(editor){var _a;return null!==(_a=editor.getContribution(InlayHintsController.ID))&&void 0!==_a?_a:void 0}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){if(this._sessionDisposables.clear(),this._removeAllDecorations(),!this._editor.getOption(127).enabled)return;const model=this._editor.getModel();if(!model||!this._languageFeaturesService.inlayHintsProvider.has(model))return;const cached=this._inlayHintsCache.get(model);let cts;cached&&this._updateHintsDecorators([model.getFullModelRange()],cached),this._sessionDisposables.add((0,lifecycle_1.toDisposable)((()=>{model.isDisposed()||this._cacheHintsForFastRestore(model)})));let watchedProviders=new Set;const scheduler=new async_1.RunOnceScheduler((()=>__awaiter(this,void 0,void 0,(function*(){const t1=Date.now();null==cts||cts.dispose(!0),cts=new cancellation_1.CancellationTokenSource;const listener=model.onWillDispose((()=>null==cts?void 0:cts.cancel()));try{const myToken=cts.token,inlayHints=yield inlayHints_1.InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider,model,this._getHintsRanges(),myToken);if(scheduler.delay=this._debounceInfo.update(model,Date.now()-t1),myToken.isCancellationRequested)return void inlayHints.dispose();for(const provider of inlayHints.provider)"function"!=typeof provider.onDidChangeInlayHints||watchedProviders.has(provider)||(watchedProviders.add(provider),this._sessionDisposables.add(provider.onDidChangeInlayHints((()=>{scheduler.isScheduled()||scheduler.schedule()}))));this._sessionDisposables.add(inlayHints),this._updateHintsDecorators(inlayHints.ranges,inlayHints.items),this._cacheHintsForFastRestore(model)}catch(err){(0,errors_1.onUnexpectedError)(err)}finally{cts.dispose(),listener.dispose()}}))),this._debounceInfo.get(model));this._sessionDisposables.add(scheduler),this._sessionDisposables.add((0,lifecycle_1.toDisposable)((()=>null==cts?void 0:cts.dispose(!0)))),scheduler.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((e=>{!e.scrollTopChanged&&scheduler.isScheduled()||scheduler.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((e=>{const delay=Math.max(scheduler.delay,1250);scheduler.schedule(delay)}))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installDblClickGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const store=new lifecycle_1.DisposableStore,gesture=store.add(new clickLinkGesture_1.ClickLinkGesture(this._editor)),sessionStore=new lifecycle_1.DisposableStore;return store.add(sessionStore),store.add(gesture.onMouseMoveOrRelevantKeyDown((e=>{const[mouseEvent]=e,labelPart=this._getInlayHintLabelPart(mouseEvent),model=this._editor.getModel();if(!labelPart||!model)return void sessionStore.clear();const cts=new cancellation_1.CancellationTokenSource;sessionStore.add((0,lifecycle_1.toDisposable)((()=>cts.dispose(!0)))),labelPart.item.resolve(cts.token),this._activeInlayHintPart=labelPart.part.command||labelPart.part.location?new ActiveInlayHintInfo(labelPart,mouseEvent.hasTriggerModifier):void 0;const lineNumber=labelPart.item.hint.position.lineNumber,range=new range_1.Range(lineNumber,1,lineNumber,model.getLineMaxColumn(lineNumber)),lineHints=new Set;for(const data of this._decorationsMetadata.values())range.containsRange(data.item.anchor.range)&&lineHints.add(data.item);this._updateHintsDecorators([range],Array.from(lineHints)),sessionStore.add((0,lifecycle_1.toDisposable)((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([range],Array.from(lineHints))})))}))),store.add(gesture.onCancel((()=>sessionStore.clear()))),store.add(gesture.onExecute((e=>__awaiter(this,void 0,void 0,(function*(){const label=this._getInlayHintLabelPart(e);if(label){const part=label.part;part.location?this._instaService.invokeFunction(inlayHintsLocations_1.goToDefinitionWithLocation,e,this._editor,part.location):languages.Command.is(part.command)&&(yield this._invokeCommand(part.command,label.item))}}))))),store}_installDblClickGesture(){return this._editor.onMouseUp((e=>__awaiter(this,void 0,void 0,(function*(){if(2!==e.event.detail)return;const part=this._getInlayHintLabelPart(e);part&&(e.event.preventDefault(),yield part.item.resolve(cancellation_1.CancellationToken.None),part.item.hint.command&&(yield this._invokeCommand(part.item.hint.command,part.item)))}))))}_installContextMenu(){return this._editor.onContextMenu((e=>__awaiter(this,void 0,void 0,(function*(){if(!(e.event.target instanceof HTMLElement))return;const part=this._getInlayHintLabelPart(e);part&&(yield this._instaService.invokeFunction(inlayHintsLocations_1.showGoToContextMenu,this._editor,e.event.target,part))}))))}_getInlayHintLabelPart(e){var _a;if(6!==e.target.type)return;const options=null===(_a=e.target.detail.injectedText)||void 0===_a?void 0:_a.options;return options instanceof textModel_1.ModelDecorationInjectedTextOptions&&(null==options?void 0:options.attachedData)instanceof RenderedInlayHintLabelPart?options.attachedData:void 0}_invokeCommand(command,item){var _a;return __awaiter(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(command.id,...null!==(_a=command.arguments)&&void 0!==_a?_a:[])}catch(err){this._notificationService.notify({severity:notification_1.Severity.Error,source:item.provider.displayName,message:err})}}))}_cacheHintsForFastRestore(model){const items=new Map;for(const[id,obj]of this._decorationsMetadata){if(items.has(obj.item))continue;let value=obj.item;const range=model.getDecorationRange(id);if(range){const anchor=new inlayHints_1.InlayHintAnchor(range,obj.item.anchor.direction);value=obj.item.with({anchor})}items.set(obj.item,value)}this._inlayHintsCache.set(model,Array.from(items.values()))}_getHintsRanges(){const model=this._editor.getModel(),visibleRanges=this._editor.getVisibleRangesPlusViewportAboveBelow(),result=[];for(const range of visibleRanges.sort(range_1.Range.compareRangesUsingStarts)){const extendedRange=model.validateRange(new range_1.Range(range.startLineNumber-30,range.startColumn,range.endLineNumber+30,range.endColumn));0!==result.length&&range_1.Range.areIntersectingOrTouching(result[result.length-1],extendedRange)?result[result.length-1]=range_1.Range.plusRange(result[result.length-1],extendedRange):result.push(extendedRange)}return result}_updateHintsDecorators(ranges,items){var _a,_b;const newDecorationsData=[],addInjectedText=(item,ref,content,cursorStops,attachedData)=>{newDecorationsData.push({item,classNameRef:ref,decoration:{range:item.anchor.range,options:{description:"InlayHint",showIfCollapsed:item.anchor.range.isEmpty(),collapseOnReplaceEdit:!item.anchor.range.isEmpty(),stickiness:0,[item.anchor.direction]:{content,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:ref.className,cursorStops,attachedData}}}})},addInjectedWhitespace=(item,isLast)=>{const marginRule=this._ruleFactory.createClassNameRef({width:(fontSize/3|0)+"px",display:"inline-block"});addInjectedText(item,marginRule," ",isLast?model_1.InjectedTextCursorStops.Right:model_1.InjectedTextCursorStops.None)},{fontSize,fontFamily}=this._getLayoutInfo();this._editor.getContainerDomNode().style.setProperty("--code-editorInlayHintsFontFamily",fontFamily);for(const item of items){item.hint.paddingLeft&&addInjectedWhitespace(item,!1);const parts="string"==typeof item.hint.label?[{label:item.hint.label}]:item.hint.label;for(let i=0;i<parts.length;i++){const part=parts[i],isFirst=0===i,isLast=i===parts.length-1,cssProperties={fontSize:`${fontSize}px`,fontFamily:`var(--code-editorInlayHintsFontFamily), ${editorOptions_1.EDITOR_FONT_DEFAULTS.fontFamily}`,verticalAlign:"middle"};item.hint.command&&(cssProperties.cursor="pointer"),this._fillInColors(cssProperties,item.hint),(part.command||part.location)&&(null===(_a=this._activeInlayHintPart)||void 0===_a?void 0:_a.part.item)===item&&this._activeInlayHintPart.part.index===i&&(cssProperties.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(cssProperties.color=(0,themeService_1.themeColorFromId)(colors.editorActiveLinkForeground),cssProperties.cursor="pointer")),isFirst&&isLast?(cssProperties.padding=`1px ${0|Math.max(1,fontSize/4)}px`,cssProperties.borderRadius=(fontSize/4|0)+"px"):isFirst?(cssProperties.padding=`1px 0 1px ${0|Math.max(1,fontSize/4)}px`,cssProperties.borderRadius=`${fontSize/4|0}px 0 0 ${fontSize/4|0}px`):isLast?(cssProperties.padding=`1px ${0|Math.max(1,fontSize/4)}px 1px 0`,cssProperties.borderRadius=`0 ${fontSize/4|0}px ${fontSize/4|0}px 0`):cssProperties.padding="1px 0 1px 0",addInjectedText(item,this._ruleFactory.createClassNameRef(cssProperties),fixSpace(part.label),isLast&&!item.hint.paddingRight?model_1.InjectedTextCursorStops.Right:model_1.InjectedTextCursorStops.None,new RenderedInlayHintLabelPart(item,i))}if(item.hint.paddingRight&&addInjectedWhitespace(item,!0),newDecorationsData.length>InlayHintsController._MAX_DECORATORS)break}const decorationIdsToReplace=[];for(const range of ranges)for(const{id}of null!==(_b=this._editor.getDecorationsInRange(range))&&void 0!==_b?_b:[]){const metadata=this._decorationsMetadata.get(id);metadata&&(decorationIdsToReplace.push(id),metadata.classNameRef.dispose(),this._decorationsMetadata.delete(id))}const newDecorationIds=this._editor.deltaDecorations(decorationIdsToReplace,newDecorationsData.map((d=>d.decoration)));for(let i=0;i<newDecorationIds.length;i++){const data=newDecorationsData[i];this._decorationsMetadata.set(newDecorationIds[i],{item:data.item,classNameRef:data.classNameRef})}}_fillInColors(props,hint){hint.kind===languages.InlayHintKind.Parameter?(props.backgroundColor=(0,themeService_1.themeColorFromId)(colors.editorInlayHintParameterBackground),props.color=(0,themeService_1.themeColorFromId)(colors.editorInlayHintParameterForeground)):hint.kind===languages.InlayHintKind.Type?(props.backgroundColor=(0,themeService_1.themeColorFromId)(colors.editorInlayHintTypeBackground),props.color=(0,themeService_1.themeColorFromId)(colors.editorInlayHintTypeForeground)):(props.backgroundColor=(0,themeService_1.themeColorFromId)(colors.editorInlayHintBackground),props.color=(0,themeService_1.themeColorFromId)(colors.editorInlayHintForeground))}_getLayoutInfo(){const options=this._editor.getOption(127),editorFontSize=this._editor.getOption(46);let fontSize=options.fontSize;(!fontSize||fontSize<5||fontSize>editorFontSize)&&(fontSize=.9*editorFontSize|0);return{fontSize,fontFamily:options.fontFamily||this._editor.getOption(43)}}_removeAllDecorations(){this._editor.deltaDecorations(Array.from(this._decorationsMetadata.keys()),[]);for(let obj of this._decorationsMetadata.values())obj.classNameRef.dispose();this._decorationsMetadata.clear()}};function fixSpace(str){return str.replace(/[ \t]/g," ")}InlayHintsController.ID="editor.contrib.InlayHints",InlayHintsController._MAX_DECORATORS=1500,InlayHintsController=__decorate([__param(1,languageFeatures_1.ILanguageFeaturesService),__param(2,languageFeatureDebounce_1.ILanguageFeatureDebounceService),__param(3,IInlayHintsCache),__param(4,commands_1.ICommandService),__param(5,notification_1.INotificationService),__param(6,instantiation_1.IInstantiationService)],InlayHintsController),exports.InlayHintsController=InlayHintsController,commands_1.CommandsRegistry.registerCommand("_executeInlayHintProvider",((accessor,...args)=>__awaiter(void 0,void 0,void 0,(function*(){const[uri,range]=args;(0,types_1.assertType)(uri_1.URI.isUri(uri)),(0,types_1.assertType)(range_1.Range.isIRange(range));const{inlayHintsProvider}=accessor.get(languageFeatures_1.ILanguageFeaturesService),ref=yield accessor.get(resolverService_1.ITextModelService).createModelReference(uri);try{const model=yield inlayHints_1.InlayHintsFragments.create(inlayHintsProvider,ref.object.textEditorModel,[range_1.Range.lift(range)],cancellation_1.CancellationToken.None),result=model.items.map((i=>i.hint));return setTimeout((()=>model.dispose()),0),result}finally{ref.dispose()}}))))}));__asyncValues=this&&this.__asyncValues||function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,m=o[Symbol.asyncIterator];return m?m.call(o):(o="function"==typeof __values?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){(function settle(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)})(resolve,reject,(v=o[n](v)).done,v.value)}))}}};define(__m[742],__M([1,0,10,68,11,38,86,35,56,293,207,305,41,53,20,557,16,262]),(function(require,exports,async_1,htmlContent_1,position_1,textModel_1,hoverTypes_1,language_1,resolverService_1,getHover_1,markdownHoverParticipant_1,inlayHintsController_1,configuration_1,opener_1,languageFeatures_1,nls_1,platform,inlayHints_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InlayHintsHover=void 0;class InlayHintsHoverAnchor extends hoverTypes_1.HoverForeignElementAnchor{constructor(part,owner){super(10,owner,part.item.anchor.range),this.part=part}}let InlayHintsHover=class InlayHintsHover extends markdownHoverParticipant_1.MarkdownHoverParticipant{constructor(editor,languageService,openerService,configurationService,_resolverService,languageFeaturesService){super(editor,languageService,openerService,configurationService,languageFeaturesService),this._resolverService=_resolverService,this.hoverOrdinal=6}suggestHoverAnchor(mouseEvent){var _a;if(!inlayHintsController_1.InlayHintsController.get(this._editor))return null;if(6!==mouseEvent.target.type)return null;const options=null===(_a=mouseEvent.target.detail.injectedText)||void 0===_a?void 0:_a.options;return options instanceof textModel_1.ModelDecorationInjectedTextOptions&&options.attachedData instanceof inlayHintsController_1.RenderedInlayHintLabelPart?new InlayHintsHoverAnchor(options.attachedData,this):null}computeSync(){return[]}computeAsync(anchor,_lineDecorations,token){return anchor instanceof InlayHintsHoverAnchor?new async_1.AsyncIterableObject((executor=>__awaiter(this,void 0,void 0,(function*(){var e_1,_a;const{part}=anchor;if(yield part.item.resolve(token),token.isCancellationRequested)return;let itemTooltip,partTooltip;if("string"==typeof part.item.hint.tooltip?itemTooltip=(new htmlContent_1.MarkdownString).appendText(part.item.hint.tooltip):part.item.hint.tooltip&&(itemTooltip=part.item.hint.tooltip),itemTooltip&&executor.emitOne(new markdownHoverParticipant_1.MarkdownHover(this,anchor.range,[itemTooltip],0)),"string"==typeof part.part.tooltip?partTooltip=(new htmlContent_1.MarkdownString).appendText(part.part.tooltip):part.part.tooltip&&(partTooltip=part.part.tooltip),partTooltip&&executor.emitOne(new markdownHoverParticipant_1.MarkdownHover(this,anchor.range,[partTooltip],1)),part.part.location||part.part.command){let linkHint;const kb="altKey"===this._editor.getOption(70)?platform.isMacintosh?(0,nls_1.localize)(0,null):(0,nls_1.localize)(1,null):platform.isMacintosh?(0,nls_1.localize)(2,null):(0,nls_1.localize)(3,null);part.part.location&&part.part.command?linkHint=(new htmlContent_1.MarkdownString).appendText((0,nls_1.localize)(4,null,kb)):part.part.location?linkHint=(new htmlContent_1.MarkdownString).appendText((0,nls_1.localize)(5,null,kb)):part.part.command&&(linkHint=new htmlContent_1.MarkdownString(`[${(0,nls_1.localize)(6,null)}](${(0,inlayHints_1.asCommandLink)(part.part.command)} "${part.part.command.title}") (${kb})`,{isTrusted:!0})),linkHint&&executor.emitOne(new markdownHoverParticipant_1.MarkdownHover(this,anchor.range,[linkHint],1e4))}const iterable=yield this._resolveInlayHintLabelPartHover(part,token);try{for(var iterable_1_1,iterable_1=__asyncValues(iterable);!(iterable_1_1=yield iterable_1.next()).done;){let item=iterable_1_1.value;executor.emitOne(item)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{iterable_1_1&&!iterable_1_1.done&&(_a=iterable_1.return)&&(yield _a.call(iterable_1))}finally{if(e_1)throw e_1.error}}})))):async_1.AsyncIterableObject.EMPTY}_resolveInlayHintLabelPartHover(part,token){return __awaiter(this,void 0,void 0,(function*(){if(!part.part.location)return async_1.AsyncIterableObject.EMPTY;const{uri,range}=part.part.location,ref=yield this._resolverService.createModelReference(uri);try{const model=ref.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(model)?(0,getHover_1.getHover)(this._languageFeaturesService.hoverProvider,model,new position_1.Position(range.startLineNumber,range.startColumn),token).filter((item=>!(0,htmlContent_1.isEmptyMarkdownString)(item.hover.contents))).map((item=>new markdownHoverParticipant_1.MarkdownHover(this,part.item.anchor.range,item.hover.contents,2+item.ordinal))):async_1.AsyncIterableObject.EMPTY}finally{ref.dispose()}}))}};InlayHintsHover=__decorate([__param(1,language_1.ILanguageService),__param(2,opener_1.IOpenerService),__param(3,configuration_1.IConfigurationService),__param(4,resolverService_1.ITextModelService),__param(5,languageFeatures_1.ILanguageFeaturesService)],InlayHintsHover),exports.InlayHintsHover=InlayHintsHover})),define(__m[743],__M([1,0,15,86,305,742]),(function(require,exports,editorExtensions_1,hoverTypes_1,inlayHintsController_1,inlayHintsHover_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(0,editorExtensions_1.registerEditorContribution)(inlayHintsController_1.InlayHintsController.ID,inlayHintsController_1.InlayHintsController),hoverTypes_1.HoverParticipantRegistry.register(inlayHintsHover_1.InlayHintsHover)})),define(__m[744],__M([1,0,15,29,302,41,17,9,39,82]),(function(require,exports,editorExtensions_1,codeEditorService_1,referencesController_1,configuration_1,contextkey_1,instantiation_1,notification_1,storage_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandaloneReferencesController=void 0;let StandaloneReferencesController=class StandaloneReferencesController extends referencesController_1.ReferencesController{constructor(editor,contextKeyService,editorService,notificationService,instantiationService,storageService,configurationService){super(!0,editor,contextKeyService,editorService,notificationService,instantiationService,storageService,configurationService)}};StandaloneReferencesController=__decorate([__param(1,contextkey_1.IContextKeyService),__param(2,codeEditorService_1.ICodeEditorService),__param(3,notification_1.INotificationService),__param(4,instantiation_1.IInstantiationService),__param(5,storage_1.IStorageService),__param(6,configuration_1.IConfigurationService)],StandaloneReferencesController),exports.StandaloneReferencesController=StandaloneReferencesController,(0,editorExtensions_1.registerEditorContribution)(referencesController_1.ReferencesController.ID,StandaloneReferencesController)})),define(__m[745],__M([1,0,13,2,45,76,601,130,52,39,162]),(function(require,exports,errors_1,lifecycle_1,network_1,severity_1,nls,dialogs_1,extensions_1,notification_1,undoRedo_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UndoRedoService=void 0;function getResourceLabel(resource){return resource.scheme===network_1.Schemas.file?resource.fsPath:resource.path}let stackElementCounter=0;class ResourceStackElement{constructor(actual,resourceLabel,strResource,groupId,groupOrder,sourceId,sourceOrder){this.id=++stackElementCounter,this.type=0,this.actual=actual,this.label=actual.label,this.confirmBeforeUndo=actual.confirmBeforeUndo||!1,this.resourceLabel=resourceLabel,this.strResource=strResource,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=groupId,this.groupOrder=groupOrder,this.sourceId=sourceId,this.sourceOrder=sourceOrder,this.isValid=!0}setValid(isValid){this.isValid=isValid}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceReasonPair{constructor(resourceLabel,reason){this.resourceLabel=resourceLabel,this.reason=reason}}class RemovedResources{constructor(){this.elements=new Map}createMessage(){const externalRemoval=[],noParallelUniverses=[];for(const[,element]of this.elements){(0===element.reason?externalRemoval:noParallelUniverses).push(element.resourceLabel)}let messages=[];return externalRemoval.length>0&&messages.push(nls.localize(0,null,externalRemoval.join(", "))),noParallelUniverses.length>0&&messages.push(nls.localize(1,null,noParallelUniverses.join(", "))),messages.join("\n")}get size(){return this.elements.size}has(strResource){return this.elements.has(strResource)}set(strResource,value){this.elements.set(strResource,value)}delete(strResource){return this.elements.delete(strResource)}}class WorkspaceStackElement{constructor(actual,resourceLabels,strResources,groupId,groupOrder,sourceId,sourceOrder){this.id=++stackElementCounter,this.type=1,this.actual=actual,this.label=actual.label,this.confirmBeforeUndo=actual.confirmBeforeUndo||!1,this.resourceLabels=resourceLabels,this.strResources=strResources,this.groupId=groupId,this.groupOrder=groupOrder,this.sourceId=sourceId,this.sourceOrder=sourceOrder,this.removedResources=null,this.invalidatedResources=null}canSplit(){return"function"==typeof this.actual.split}removeResource(resourceLabel,strResource,reason){this.removedResources||(this.removedResources=new RemovedResources),this.removedResources.has(strResource)||this.removedResources.set(strResource,new ResourceReasonPair(resourceLabel,reason))}setValid(resourceLabel,strResource,isValid){isValid?this.invalidatedResources&&(this.invalidatedResources.delete(strResource),0===this.invalidatedResources.size&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new RemovedResources),this.invalidatedResources.has(strResource)||this.invalidatedResources.set(strResource,new ResourceReasonPair(resourceLabel,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceEditStack{constructor(resourceLabel,strResource){this.resourceLabel=resourceLabel,this.strResource=strResource,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const element of this._past)1===element.type&&element.removeResource(this.resourceLabel,this.strResource,0);for(const element of this._future)1===element.type&&element.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){let result=[];result.push(`* ${this.strResource}:`);for(let i=0;i<this._past.length;i++)result.push(`   * [UNDO] ${this._past[i]}`);for(let i=this._future.length-1;i>=0;i--)result.push(`   * [REDO] ${this._future[i]}`);return result.join("\n")}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(element,isValid){1===element.type?element.setValid(this.resourceLabel,this.strResource,isValid):element.setValid(isValid)}setElementsValidFlag(isValid,filter){for(const element of this._past)filter(element.actual)&&this._setElementValidFlag(element,isValid);for(const element of this._future)filter(element.actual)&&this._setElementValidFlag(element,isValid)}pushElement(element){for(const futureElement of this._future)1===futureElement.type&&futureElement.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(element),this.versionId++}createSnapshot(resource){const elements=[];for(let i=0,len=this._past.length;i<len;i++)elements.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)elements.push(this._future[i].id);return new undoRedo_1.ResourceEditStackSnapshot(resource,elements)}restoreSnapshot(snapshot){const snapshotLength=snapshot.elements.length;let isOK=!0,snapshotIndex=0,removePastAfter=-1;for(let i=0,len=this._past.length;i<len;i++,snapshotIndex++){const element=this._past[i];isOK&&(snapshotIndex>=snapshotLength||element.id!==snapshot.elements[snapshotIndex])&&(isOK=!1,removePastAfter=0),isOK||1!==element.type||element.removeResource(this.resourceLabel,this.strResource,0)}let removeFutureBefore=-1;for(let i=this._future.length-1;i>=0;i--,snapshotIndex++){const element=this._future[i];isOK&&(snapshotIndex>=snapshotLength||element.id!==snapshot.elements[snapshotIndex])&&(isOK=!1,removeFutureBefore=i),isOK||1!==element.type||element.removeResource(this.resourceLabel,this.strResource,0)}-1!==removePastAfter&&(this._past=this._past.slice(0,removePastAfter)),-1!==removeFutureBefore&&(this._future=this._future.slice(removeFutureBefore+1)),this.versionId++}getElements(){const past=[],future=[];for(const element of this._past)past.push(element.actual);for(const element of this._future)future.push(element.actual);return{past,future}}getClosestPastElement(){return 0===this._past.length?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return 0===this._future.length?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(toRemove,individualMap){for(let j=this._past.length-1;j>=0;j--)if(this._past[j]===toRemove){individualMap.has(this.strResource)?this._past[j]=individualMap.get(this.strResource):this._past.splice(j,1);break}this.versionId++}splitFutureWorkspaceElement(toRemove,individualMap){for(let j=this._future.length-1;j>=0;j--)if(this._future[j]===toRemove){individualMap.has(this.strResource)?this._future[j]=individualMap.get(this.strResource):this._future.splice(j,1);break}this.versionId++}moveBackward(element){this._past.pop(),this._future.push(element),this.versionId++}moveForward(element){this._future.pop(),this._past.push(element),this.versionId++}}class EditStackSnapshot{constructor(editStacks){this.editStacks=editStacks,this._versionIds=[];for(let i=0,len=this.editStacks.length;i<len;i++)this._versionIds[i]=this.editStacks[i].versionId}isValid(){for(let i=0,len=this.editStacks.length;i<len;i++)if(this._versionIds[i]!==this.editStacks[i].versionId)return!1;return!0}}const missingEditStack=new ResourceEditStack("","");missingEditStack.locked=!0;let UndoRedoService=class UndoRedoService{constructor(_dialogService,_notificationService){this._dialogService=_dialogService,this._notificationService=_notificationService,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(resource){for(const uriComparisonKeyComputer of this._uriComparisonKeyComputers)if(uriComparisonKeyComputer[0]===resource.scheme)return uriComparisonKeyComputer[1].getComparisonKey(resource);return resource.toString()}_print(label){console.log("------------------------------------"),console.log(`AFTER ${label}: `);let str=[];for(const element of this._editStacks)str.push(element[1].toString());console.log(str.join("\n"))}pushElement(element,group=undoRedo_1.UndoRedoGroup.None,source=undoRedo_1.UndoRedoSource.None){if(0===element.type){const resourceLabel=getResourceLabel(element.resource),strResource=this.getUriComparisonKey(element.resource);this._pushElement(new ResourceStackElement(element,resourceLabel,strResource,group.id,group.nextOrder(),source.id,source.nextOrder()))}else{const seen=new Set,resourceLabels=[],strResources=[];for(const resource of element.resources){const resourceLabel=getResourceLabel(resource),strResource=this.getUriComparisonKey(resource);seen.has(strResource)||(seen.add(strResource),resourceLabels.push(resourceLabel),strResources.push(strResource))}1===resourceLabels.length?this._pushElement(new ResourceStackElement(element,resourceLabels[0],strResources[0],group.id,group.nextOrder(),source.id,source.nextOrder())):this._pushElement(new WorkspaceStackElement(element,resourceLabels,strResources,group.id,group.nextOrder(),source.id,source.nextOrder()))}}_pushElement(element){for(let i=0,len=element.strResources.length;i<len;i++){const resourceLabel=element.resourceLabels[i],strResource=element.strResources[i];let editStack;this._editStacks.has(strResource)?editStack=this._editStacks.get(strResource):(editStack=new ResourceEditStack(resourceLabel,strResource),this._editStacks.set(strResource,editStack)),editStack.pushElement(element)}}getLastElement(resource){const strResource=this.getUriComparisonKey(resource);if(this._editStacks.has(strResource)){const editStack=this._editStacks.get(strResource);if(editStack.hasFutureElements())return null;const closestPastElement=editStack.getClosestPastElement();return closestPastElement?closestPastElement.actual:null}return null}_splitPastWorkspaceElement(toRemove,ignoreResources){const individualArr=toRemove.actual.split(),individualMap=new Map;for(const _element of individualArr){const resourceLabel=getResourceLabel(_element.resource),strResource=this.getUriComparisonKey(_element.resource),element=new ResourceStackElement(_element,resourceLabel,strResource,0,0,0,0);individualMap.set(element.strResource,element)}for(const strResource of toRemove.strResources){if(ignoreResources&&ignoreResources.has(strResource))continue;this._editStacks.get(strResource).splitPastWorkspaceElement(toRemove,individualMap)}}_splitFutureWorkspaceElement(toRemove,ignoreResources){const individualArr=toRemove.actual.split(),individualMap=new Map;for(const _element of individualArr){const resourceLabel=getResourceLabel(_element.resource),strResource=this.getUriComparisonKey(_element.resource),element=new ResourceStackElement(_element,resourceLabel,strResource,0,0,0,0);individualMap.set(element.strResource,element)}for(const strResource of toRemove.strResources){if(ignoreResources&&ignoreResources.has(strResource))continue;this._editStacks.get(strResource).splitFutureWorkspaceElement(toRemove,individualMap)}}removeElements(resource){const strResource="string"==typeof resource?resource:this.getUriComparisonKey(resource);if(this._editStacks.has(strResource)){this._editStacks.get(strResource).dispose(),this._editStacks.delete(strResource)}}setElementsValidFlag(resource,isValid,filter){const strResource=this.getUriComparisonKey(resource);if(this._editStacks.has(strResource)){this._editStacks.get(strResource).setElementsValidFlag(isValid,filter)}}createSnapshot(resource){const strResource=this.getUriComparisonKey(resource);if(this._editStacks.has(strResource)){return this._editStacks.get(strResource).createSnapshot(resource)}return new undoRedo_1.ResourceEditStackSnapshot(resource,[])}restoreSnapshot(snapshot){const strResource=this.getUriComparisonKey(snapshot.resource);if(this._editStacks.has(strResource)){const editStack=this._editStacks.get(strResource);editStack.restoreSnapshot(snapshot),editStack.hasPastElements()||editStack.hasFutureElements()||(editStack.dispose(),this._editStacks.delete(strResource))}}getElements(resource){const strResource=this.getUriComparisonKey(resource);if(this._editStacks.has(strResource)){return this._editStacks.get(strResource).getElements()}return{past:[],future:[]}}_findClosestUndoElementWithSource(sourceId){if(!sourceId)return[null,null];let matchedElement=null,matchedStrResource=null;for(const[strResource,editStack]of this._editStacks){const candidate=editStack.getClosestPastElement();candidate&&(candidate.sourceId===sourceId&&(!matchedElement||candidate.sourceOrder>matchedElement.sourceOrder)&&(matchedElement=candidate,matchedStrResource=strResource))}return[matchedElement,matchedStrResource]}canUndo(resourceOrSource){if(resourceOrSource instanceof undoRedo_1.UndoRedoSource){const[,matchedStrResource]=this._findClosestUndoElementWithSource(resourceOrSource.id);return!!matchedStrResource}const strResource=this.getUriComparisonKey(resourceOrSource);if(this._editStacks.has(strResource)){return this._editStacks.get(strResource).hasPastElements()}return!1}_onError(err,element){(0,errors_1.onUnexpectedError)(err);for(const strResource of element.strResources)this.removeElements(strResource);this._notificationService.error(err)}_acquireLocks(editStackSnapshot){for(const editStack of editStackSnapshot.editStacks)if(editStack.locked)throw new Error("Cannot acquire edit stack lock");for(const editStack of editStackSnapshot.editStacks)editStack.locked=!0;return()=>{for(const editStack of editStackSnapshot.editStacks)editStack.locked=!1}}_safeInvokeWithLocks(element,invoke,editStackSnapshot,cleanup,continuation){const releaseLocks=this._acquireLocks(editStackSnapshot);let result;try{result=invoke()}catch(err){return releaseLocks(),cleanup.dispose(),this._onError(err,element)}return result?result.then((()=>(releaseLocks(),cleanup.dispose(),continuation())),(err=>(releaseLocks(),cleanup.dispose(),this._onError(err,element)))):(releaseLocks(),cleanup.dispose(),continuation())}_invokeWorkspacePrepare(element){return __awaiter(this,void 0,void 0,(function*(){if(void 0===element.actual.prepareUndoRedo)return lifecycle_1.Disposable.None;const result=element.actual.prepareUndoRedo();return void 0===result?lifecycle_1.Disposable.None:result}))}_invokeResourcePrepare(element,callback){if(1!==element.actual.type||void 0===element.actual.prepareUndoRedo)return callback(lifecycle_1.Disposable.None);const r=element.actual.prepareUndoRedo();return r?(0,lifecycle_1.isDisposable)(r)?callback(r):r.then((disposable=>callback(disposable))):callback(lifecycle_1.Disposable.None)}_getAffectedEditStacks(element){const affectedEditStacks=[];for(const strResource of element.strResources)affectedEditStacks.push(this._editStacks.get(strResource)||missingEditStack);return new EditStackSnapshot(affectedEditStacks)}_tryToSplitAndUndo(strResource,element,ignoreResources,message){if(element.canSplit())return this._splitPastWorkspaceElement(element,ignoreResources),this._notificationService.warn(message),new WorkspaceVerificationError(this._undo(strResource,0,!0));for(const strResource of element.strResources)this.removeElements(strResource);return this._notificationService.warn(message),new WorkspaceVerificationError}_checkWorkspaceUndo(strResource,element,editStackSnapshot,checkInvalidatedResources){if(element.removedResources)return this._tryToSplitAndUndo(strResource,element,element.removedResources,nls.localize(2,null,element.label,element.removedResources.createMessage()));if(checkInvalidatedResources&&element.invalidatedResources)return this._tryToSplitAndUndo(strResource,element,element.invalidatedResources,nls.localize(3,null,element.label,element.invalidatedResources.createMessage()));const cannotUndoDueToResources=[];for(const editStack of editStackSnapshot.editStacks)editStack.getClosestPastElement()!==element&&cannotUndoDueToResources.push(editStack.resourceLabel);if(cannotUndoDueToResources.length>0)return this._tryToSplitAndUndo(strResource,element,null,nls.localize(4,null,element.label,cannotUndoDueToResources.join(", ")));const cannotLockDueToResources=[];for(const editStack of editStackSnapshot.editStacks)editStack.locked&&cannotLockDueToResources.push(editStack.resourceLabel);return cannotLockDueToResources.length>0?this._tryToSplitAndUndo(strResource,element,null,nls.localize(5,null,element.label,cannotLockDueToResources.join(", "))):editStackSnapshot.isValid()?null:this._tryToSplitAndUndo(strResource,element,null,nls.localize(6,null,element.label))}_workspaceUndo(strResource,element,undoConfirmed){const affectedEditStacks=this._getAffectedEditStacks(element),verificationError=this._checkWorkspaceUndo(strResource,element,affectedEditStacks,!1);return verificationError?verificationError.returnValue:this._confirmAndExecuteWorkspaceUndo(strResource,element,affectedEditStacks,undoConfirmed)}_isPartOfUndoGroup(element){if(!element.groupId)return!1;for(const[,editStack]of this._editStacks){const pastElement=editStack.getClosestPastElement();if(pastElement){if(pastElement===element){const secondPastElement=editStack.getSecondClosestPastElement();if(secondPastElement&&secondPastElement.groupId===element.groupId)return!0}if(pastElement.groupId===element.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(strResource,element,editStackSnapshot,undoConfirmed){return __awaiter(this,void 0,void 0,(function*(){if(element.canSplit()&&!this._isPartOfUndoGroup(element)){const result=yield this._dialogService.show(severity_1.default.Info,nls.localize(7,null,element.label),[nls.localize(8,null,editStackSnapshot.editStacks.length),nls.localize(9,null),nls.localize(10,null)],{cancelId:2});if(2===result.choice)return;if(1===result.choice)return this._splitPastWorkspaceElement(element,null),this._undo(strResource,0,!0);const verificationError1=this._checkWorkspaceUndo(strResource,element,editStackSnapshot,!1);if(verificationError1)return verificationError1.returnValue;undoConfirmed=!0}let cleanup;try{cleanup=yield this._invokeWorkspacePrepare(element)}catch(err){return this._onError(err,element)}const verificationError2=this._checkWorkspaceUndo(strResource,element,editStackSnapshot,!0);if(verificationError2)return cleanup.dispose(),verificationError2.returnValue;for(const editStack of editStackSnapshot.editStacks)editStack.moveBackward(element);return this._safeInvokeWithLocks(element,(()=>element.actual.undo()),editStackSnapshot,cleanup,(()=>this._continueUndoInGroup(element.groupId,undoConfirmed)))}))}_resourceUndo(editStack,element,undoConfirmed){if(element.isValid){if(!editStack.locked)return this._invokeResourcePrepare(element,(cleanup=>(editStack.moveBackward(element),this._safeInvokeWithLocks(element,(()=>element.actual.undo()),new EditStackSnapshot([editStack]),cleanup,(()=>this._continueUndoInGroup(element.groupId,undoConfirmed))))));{const message=nls.localize(11,null,element.label);this._notificationService.warn(message)}}else editStack.flushAllElements()}_findClosestUndoElementInGroup(groupId){if(!groupId)return[null,null];let matchedElement=null,matchedStrResource=null;for(const[strResource,editStack]of this._editStacks){const candidate=editStack.getClosestPastElement();candidate&&(candidate.groupId===groupId&&(!matchedElement||candidate.groupOrder>matchedElement.groupOrder)&&(matchedElement=candidate,matchedStrResource=strResource))}return[matchedElement,matchedStrResource]}_continueUndoInGroup(groupId,undoConfirmed){if(!groupId)return;const[,matchedStrResource]=this._findClosestUndoElementInGroup(groupId);return matchedStrResource?this._undo(matchedStrResource,0,undoConfirmed):void 0}undo(resourceOrSource){if(resourceOrSource instanceof undoRedo_1.UndoRedoSource){const[,matchedStrResource]=this._findClosestUndoElementWithSource(resourceOrSource.id);return matchedStrResource?this._undo(matchedStrResource,resourceOrSource.id,!1):void 0}return"string"==typeof resourceOrSource?this._undo(resourceOrSource,0,!1):this._undo(this.getUriComparisonKey(resourceOrSource),0,!1)}_undo(strResource,sourceId=0,undoConfirmed){if(!this._editStacks.has(strResource))return;const editStack=this._editStacks.get(strResource),element=editStack.getClosestPastElement();if(!element)return;if(element.groupId){const[matchedElement,matchedStrResource]=this._findClosestUndoElementInGroup(element.groupId);if(element!==matchedElement&&matchedStrResource)return this._undo(matchedStrResource,sourceId,undoConfirmed)}if((element.sourceId!==sourceId||element.confirmBeforeUndo)&&!undoConfirmed)return this._confirmAndContinueUndo(strResource,sourceId,element);try{return 1===element.type?this._workspaceUndo(strResource,element,undoConfirmed):this._resourceUndo(editStack,element,undoConfirmed)}finally{false}}_confirmAndContinueUndo(strResource,sourceId,element){return __awaiter(this,void 0,void 0,(function*(){if(1!==(yield this._dialogService.show(severity_1.default.Info,nls.localize(12,null,element.label),[nls.localize(13,null),nls.localize(14,null)],{cancelId:1})).choice)return this._undo(strResource,sourceId,!0)}))}_findClosestRedoElementWithSource(sourceId){if(!sourceId)return[null,null];let matchedElement=null,matchedStrResource=null;for(const[strResource,editStack]of this._editStacks){const candidate=editStack.getClosestFutureElement();candidate&&(candidate.sourceId===sourceId&&(!matchedElement||candidate.sourceOrder<matchedElement.sourceOrder)&&(matchedElement=candidate,matchedStrResource=strResource))}return[matchedElement,matchedStrResource]}canRedo(resourceOrSource){if(resourceOrSource instanceof undoRedo_1.UndoRedoSource){const[,matchedStrResource]=this._findClosestRedoElementWithSource(resourceOrSource.id);return!!matchedStrResource}const strResource=this.getUriComparisonKey(resourceOrSource);if(this._editStacks.has(strResource)){return this._editStacks.get(strResource).hasFutureElements()}return!1}_tryToSplitAndRedo(strResource,element,ignoreResources,message){if(element.canSplit())return this._splitFutureWorkspaceElement(element,ignoreResources),this._notificationService.warn(message),new WorkspaceVerificationError(this._redo(strResource));for(const strResource of element.strResources)this.removeElements(strResource);return this._notificationService.warn(message),new WorkspaceVerificationError}_checkWorkspaceRedo(strResource,element,editStackSnapshot,checkInvalidatedResources){if(element.removedResources)return this._tryToSplitAndRedo(strResource,element,element.removedResources,nls.localize(15,null,element.label,element.removedResources.createMessage()));if(checkInvalidatedResources&&element.invalidatedResources)return this._tryToSplitAndRedo(strResource,element,element.invalidatedResources,nls.localize(16,null,element.label,element.invalidatedResources.createMessage()));const cannotRedoDueToResources=[];for(const editStack of editStackSnapshot.editStacks)editStack.getClosestFutureElement()!==element&&cannotRedoDueToResources.push(editStack.resourceLabel);if(cannotRedoDueToResources.length>0)return this._tryToSplitAndRedo(strResource,element,null,nls.localize(17,null,element.label,cannotRedoDueToResources.join(", ")));const cannotLockDueToResources=[];for(const editStack of editStackSnapshot.editStacks)editStack.locked&&cannotLockDueToResources.push(editStack.resourceLabel);return cannotLockDueToResources.length>0?this._tryToSplitAndRedo(strResource,element,null,nls.localize(18,null,element.label,cannotLockDueToResources.join(", "))):editStackSnapshot.isValid()?null:this._tryToSplitAndRedo(strResource,element,null,nls.localize(19,null,element.label))}_workspaceRedo(strResource,element){const affectedEditStacks=this._getAffectedEditStacks(element),verificationError=this._checkWorkspaceRedo(strResource,element,affectedEditStacks,!1);return verificationError?verificationError.returnValue:this._executeWorkspaceRedo(strResource,element,affectedEditStacks)}_executeWorkspaceRedo(strResource,element,editStackSnapshot){return __awaiter(this,void 0,void 0,(function*(){let cleanup;try{cleanup=yield this._invokeWorkspacePrepare(element)}catch(err){return this._onError(err,element)}const verificationError=this._checkWorkspaceRedo(strResource,element,editStackSnapshot,!0);if(verificationError)return cleanup.dispose(),verificationError.returnValue;for(const editStack of editStackSnapshot.editStacks)editStack.moveForward(element);return this._safeInvokeWithLocks(element,(()=>element.actual.redo()),editStackSnapshot,cleanup,(()=>this._continueRedoInGroup(element.groupId)))}))}_resourceRedo(editStack,element){if(element.isValid){if(!editStack.locked)return this._invokeResourcePrepare(element,(cleanup=>(editStack.moveForward(element),this._safeInvokeWithLocks(element,(()=>element.actual.redo()),new EditStackSnapshot([editStack]),cleanup,(()=>this._continueRedoInGroup(element.groupId))))));{const message=nls.localize(20,null,element.label);this._notificationService.warn(message)}}else editStack.flushAllElements()}_findClosestRedoElementInGroup(groupId){if(!groupId)return[null,null];let matchedElement=null,matchedStrResource=null;for(const[strResource,editStack]of this._editStacks){const candidate=editStack.getClosestFutureElement();candidate&&(candidate.groupId===groupId&&(!matchedElement||candidate.groupOrder<matchedElement.groupOrder)&&(matchedElement=candidate,matchedStrResource=strResource))}return[matchedElement,matchedStrResource]}_continueRedoInGroup(groupId){if(!groupId)return;const[,matchedStrResource]=this._findClosestRedoElementInGroup(groupId);return matchedStrResource?this._redo(matchedStrResource):void 0}redo(resourceOrSource){if(resourceOrSource instanceof undoRedo_1.UndoRedoSource){const[,matchedStrResource]=this._findClosestRedoElementWithSource(resourceOrSource.id);return matchedStrResource?this._redo(matchedStrResource):void 0}return"string"==typeof resourceOrSource?this._redo(resourceOrSource):this._redo(this.getUriComparisonKey(resourceOrSource))}_redo(strResource){if(!this._editStacks.has(strResource))return;const editStack=this._editStacks.get(strResource),element=editStack.getClosestFutureElement();if(element){if(element.groupId){const[matchedElement,matchedStrResource]=this._findClosestRedoElementInGroup(element.groupId);if(element!==matchedElement&&matchedStrResource)return this._redo(matchedStrResource)}try{return 1===element.type?this._workspaceRedo(strResource,element):this._resourceRedo(editStack,element)}finally{false}}}};UndoRedoService=__decorate([__param(0,dialogs_1.IDialogService),__param(1,notification_1.INotificationService)],UndoRedoService),exports.UndoRedoService=UndoRedoService;class WorkspaceVerificationError{constructor(returnValue){this.returnValue=returnValue}}(0,extensions_1.registerSingleton)(undoRedo_1.IUndoRedoService,UndoRedoService)})),define(__m[211],__M([1,0,602,49,25,9]),(function(require,exports,nls_1,map_1,uri_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WORKSPACE_FILTER=exports.WORKSPACE_EXTENSION=exports.WorkspaceFolder=exports.Workspace=exports.toWorkspaceIdentifier=exports.isSingleFolderWorkspaceIdentifier=exports.IWorkspaceContextService=void 0,exports.IWorkspaceContextService=(0,instantiation_1.createDecorator)("contextService"),exports.isSingleFolderWorkspaceIdentifier=function isSingleFolderWorkspaceIdentifier(obj){const singleFolderIdentifier=obj;return"string"==typeof(null==singleFolderIdentifier?void 0:singleFolderIdentifier.id)&&uri_1.URI.isUri(singleFolderIdentifier.uri)},exports.toWorkspaceIdentifier=function toWorkspaceIdentifier(workspace){return workspace.configuration?{id:workspace.id,configPath:workspace.configuration}:1===workspace.folders.length?{id:workspace.id,uri:workspace.folders[0].uri}:void 0};exports.Workspace=class Workspace{constructor(_id,folders,_transient,_configuration,_ignorePathCasing){this._id=_id,this._transient=_transient,this._configuration=_configuration,this._ignorePathCasing=_ignorePathCasing,this._foldersMap=map_1.TernarySearchTree.forUris(this._ignorePathCasing),this.folders=folders}get folders(){return this._folders}set folders(folders){this._folders=folders,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(configuration){this._configuration=configuration}getFolder(resource){return resource&&this._foldersMap.findSubstr(resource.with({scheme:resource.scheme,authority:resource.authority,path:resource.path}))||null}updateFoldersMap(){this._foldersMap=map_1.TernarySearchTree.forUris(this._ignorePathCasing);for(const folder of this.folders)this._foldersMap.set(folder.uri,folder)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};exports.WorkspaceFolder=class WorkspaceFolder{constructor(data,raw){this.raw=raw,this.uri=data.uri,this.index=data.index,this.name=data.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}},exports.WORKSPACE_EXTENSION="code-workspace",exports.WORKSPACE_FILTER=[{name:(0,nls_1.localize)(0,null),extensions:[exports.WORKSPACE_EXTENSION]}]})),define(__m[746],__M([1,0,173,84,42,8,328,33,127,575,211]),(function(require,exports,labels_1,path,resources_1,strings_1,uuid_1,languageConfigurationRegistry_1,snippetParser_1,nls,workspace_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RandomBasedVariableResolver=exports.WorkspaceBasedVariableResolver=exports.TimeBasedVariableResolver=exports.CommentBasedVariableResolver=exports.ClipboardBasedVariableResolver=exports.ModelBasedVariableResolver=exports.SelectionBasedVariableResolver=exports.CompositeSnippetVariableResolver=exports.KnownSnippetVariableNames=void 0,exports.KnownSnippetVariableNames=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0});exports.CompositeSnippetVariableResolver=class CompositeSnippetVariableResolver{constructor(_delegates){this._delegates=_delegates}resolve(variable){for(const delegate of this._delegates){let value=delegate.resolve(variable);if(void 0!==value)return value}}};exports.SelectionBasedVariableResolver=class SelectionBasedVariableResolver{constructor(_model,_selection,_selectionIdx,_overtypingCapturer){this._model=_model,this._selection=_selection,this._selectionIdx=_selectionIdx,this._overtypingCapturer=_overtypingCapturer}resolve(variable){const{name}=variable;if("SELECTION"===name||"TM_SELECTED_TEXT"===name){let value=this._model.getValueInRange(this._selection)||void 0,isMultiline=this._selection.startLineNumber!==this._selection.endLineNumber;if(!value&&this._overtypingCapturer){const info=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);info&&(value=info.value,isMultiline=info.multiline)}if(value&&isMultiline&&variable.snippet){const line=this._model.getLineContent(this._selection.startLineNumber),lineLeadingWhitespace=(0,strings_1.getLeadingWhitespace)(line,0,this._selection.startColumn-1);let varLeadingWhitespace=lineLeadingWhitespace;variable.snippet.walk((marker=>marker!==variable&&(marker instanceof snippetParser_1.Text&&(varLeadingWhitespace=(0,strings_1.getLeadingWhitespace)((0,strings_1.splitLines)(marker.value).pop())),!0)));const whitespaceCommonLength=(0,strings_1.commonPrefixLength)(varLeadingWhitespace,lineLeadingWhitespace);value=value.replace(/(\r\n|\r|\n)(.*)/g,((m,newline,rest)=>`${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`))}return value}if("TM_CURRENT_LINE"===name)return this._model.getLineContent(this._selection.positionLineNumber);if("TM_CURRENT_WORD"===name){const info=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return info&&info.word||void 0}return"TM_LINE_INDEX"===name?String(this._selection.positionLineNumber-1):"TM_LINE_NUMBER"===name?String(this._selection.positionLineNumber):void 0}};exports.ModelBasedVariableResolver=class ModelBasedVariableResolver{constructor(_labelService,_model){this._labelService=_labelService,this._model=_model}resolve(variable){const{name}=variable;if("TM_FILENAME"===name)return path.basename(this._model.uri.fsPath);if("TM_FILENAME_BASE"===name){const name=path.basename(this._model.uri.fsPath),idx=name.lastIndexOf(".");return idx<=0?name:name.slice(0,idx)}return"TM_DIRECTORY"===name?"."===path.dirname(this._model.uri.fsPath)?"":this._labelService.getUriLabel((0,resources_1.dirname)(this._model.uri)):"TM_FILEPATH"===name?this._labelService.getUriLabel(this._model.uri):"RELATIVE_FILEPATH"===name?this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0}):void 0}};exports.ClipboardBasedVariableResolver=class ClipboardBasedVariableResolver{constructor(_readClipboardText,_selectionIdx,_selectionCount,_spread){this._readClipboardText=_readClipboardText,this._selectionIdx=_selectionIdx,this._selectionCount=_selectionCount,this._spread=_spread}resolve(variable){if("CLIPBOARD"!==variable.name)return;const clipboardText=this._readClipboardText();if(clipboardText){if(this._spread){const lines=clipboardText.split(/\r\n|\n|\r/).filter((s=>!(0,strings_1.isFalsyOrWhitespace)(s)));if(lines.length===this._selectionCount)return lines[this._selectionIdx]}return clipboardText}}};exports.CommentBasedVariableResolver=class CommentBasedVariableResolver{constructor(_model,_selection){this._model=_model,this._selection=_selection}resolve(variable){const{name}=variable,langId=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),config=languageConfigurationRegistry_1.LanguageConfigurationRegistry.getComments(langId);if(config)return"LINE_COMMENT"===name?config.lineCommentToken||void 0:"BLOCK_COMMENT_START"===name?config.blockCommentStartToken||void 0:"BLOCK_COMMENT_END"===name&&config.blockCommentEndToken||void 0}};class TimeBasedVariableResolver{constructor(){this._date=new Date}resolve(variable){const{name}=variable;return"CURRENT_YEAR"===name?String(this._date.getFullYear()):"CURRENT_YEAR_SHORT"===name?String(this._date.getFullYear()).slice(-2):"CURRENT_MONTH"===name?String(this._date.getMonth().valueOf()+1).padStart(2,"0"):"CURRENT_DATE"===name?String(this._date.getDate().valueOf()).padStart(2,"0"):"CURRENT_HOUR"===name?String(this._date.getHours().valueOf()).padStart(2,"0"):"CURRENT_MINUTE"===name?String(this._date.getMinutes().valueOf()).padStart(2,"0"):"CURRENT_SECOND"===name?String(this._date.getSeconds().valueOf()).padStart(2,"0"):"CURRENT_DAY_NAME"===name?TimeBasedVariableResolver.dayNames[this._date.getDay()]:"CURRENT_DAY_NAME_SHORT"===name?TimeBasedVariableResolver.dayNamesShort[this._date.getDay()]:"CURRENT_MONTH_NAME"===name?TimeBasedVariableResolver.monthNames[this._date.getMonth()]:"CURRENT_MONTH_NAME_SHORT"===name?TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()]:"CURRENT_SECONDS_UNIX"===name?String(Math.floor(this._date.getTime()/1e3)):void 0}}exports.TimeBasedVariableResolver=TimeBasedVariableResolver,TimeBasedVariableResolver.dayNames=[nls.localize(0,null),nls.localize(1,null),nls.localize(2,null),nls.localize(3,null),nls.localize(4,null),nls.localize(5,null),nls.localize(6,null)],TimeBasedVariableResolver.dayNamesShort=[nls.localize(7,null),nls.localize(8,null),nls.localize(9,null),nls.localize(10,null),nls.localize(11,null),nls.localize(12,null),nls.localize(13,null)],TimeBasedVariableResolver.monthNames=[nls.localize(14,null),nls.localize(15,null),nls.localize(16,null),nls.localize(17,null),nls.localize(18,null),nls.localize(19,null),nls.localize(20,null),nls.localize(21,null),nls.localize(22,null),nls.localize(23,null),nls.localize(24,null),nls.localize(25,null)],TimeBasedVariableResolver.monthNamesShort=[nls.localize(26,null),nls.localize(27,null),nls.localize(28,null),nls.localize(29,null),nls.localize(30,null),nls.localize(31,null),nls.localize(32,null),nls.localize(33,null),nls.localize(34,null),nls.localize(35,null),nls.localize(36,null),nls.localize(37,null)];exports.WorkspaceBasedVariableResolver=class WorkspaceBasedVariableResolver{constructor(_workspaceService){this._workspaceService=_workspaceService}resolve(variable){if(!this._workspaceService)return;const workspaceIdentifier=(0,workspace_1.toWorkspaceIdentifier)(this._workspaceService.getWorkspace());return workspaceIdentifier?"WORKSPACE_NAME"===variable.name?this._resolveWorkspaceName(workspaceIdentifier):"WORKSPACE_FOLDER"===variable.name?this._resoveWorkspacePath(workspaceIdentifier):void 0:void 0}_resolveWorkspaceName(workspaceIdentifier){if((0,workspace_1.isSingleFolderWorkspaceIdentifier)(workspaceIdentifier))return path.basename(workspaceIdentifier.uri.path);let filename=path.basename(workspaceIdentifier.configPath.path);return filename.endsWith(workspace_1.WORKSPACE_EXTENSION)&&(filename=filename.substr(0,filename.length-workspace_1.WORKSPACE_EXTENSION.length-1)),filename}_resoveWorkspacePath(workspaceIdentifier){if((0,workspace_1.isSingleFolderWorkspaceIdentifier)(workspaceIdentifier))return(0,labels_1.normalizeDriveLetter)(workspaceIdentifier.uri.fsPath);let filename=path.basename(workspaceIdentifier.configPath.path),folderpath=workspaceIdentifier.configPath.fsPath;return folderpath.endsWith(filename)&&(folderpath=folderpath.substr(0,folderpath.length-filename.length-1)),folderpath?(0,labels_1.normalizeDriveLetter)(folderpath):"/"}};exports.RandomBasedVariableResolver=class RandomBasedVariableResolver{resolve(variable){const{name}=variable;return"RANDOM"===name?Math.random().toString().slice(-6):"RANDOM_HEX"===name?Math.random().toString(16).slice(-6):"UUID"===name?(0,uuid_1.generateUuid)():void 0}}})),define(__m[306],__M([1,0,18,2,8,63,3,22,38,131,211,127,746,388]),(function(require,exports,arrays_1,lifecycle_1,strings_1,editOperation_1,range_1,selection_1,textModel_1,label_1,workspace_1,snippetParser_1,snippetVariables_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SnippetSession=exports.OneSnippet=void 0;class OneSnippet{constructor(_editor,_snippet,_offset,_snippetLineLeadingWhitespace){this._editor=_editor,this._snippet=_snippet,this._offset=_offset,this._snippetLineLeadingWhitespace=_snippetLineLeadingWhitespace,this._nestingLevel=1,this._placeholderGroups=(0,arrays_1.groupBy)(_snippet.placeholders,snippetParser_1.Placeholder.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.deltaDecorations([...this._placeholderDecorations.values()],[]),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const model=this._editor.getModel();this._editor.changeDecorations((accessor=>{for(const placeholder of this._snippet.placeholders){const placeholderOffset=this._snippet.offset(placeholder),placeholderLen=this._snippet.fullLen(placeholder),range=range_1.Range.fromPositions(model.getPositionAt(this._offset+placeholderOffset),model.getPositionAt(this._offset+placeholderOffset+placeholderLen)),options=placeholder.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive,handle=accessor.addDecoration(range,options);this._placeholderDecorations.set(placeholder,handle)}}))}move(fwd){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let operations=[];for(const placeholder of this._placeholderGroups[this._placeholderGroupsIdx])if(placeholder.transform){const id=this._placeholderDecorations.get(placeholder),range=this._editor.getModel().getDecorationRange(id),currentValue=this._editor.getModel().getValueInRange(range),transformedValueLines=placeholder.transform.resolve(currentValue).split(/\r\n|\r|\n/);for(let i=1;i<transformedValueLines.length;i++)transformedValueLines[i]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+transformedValueLines[i]);operations.push(editOperation_1.EditOperation.replace(range,transformedValueLines.join(this._editor.getModel().getEOL())))}operations.length>0&&this._editor.executeEdits("snippet.placeholderTransform",operations)}let couldSkipThisPlaceholder=!1;!0===fwd&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,couldSkipThisPlaceholder=!0):!1===fwd&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,couldSkipThisPlaceholder=!0);const newSelections=this._editor.getModel().changeDecorations((accessor=>{const activePlaceholders=new Set,selections=[];for(const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]){const id=this._placeholderDecorations.get(placeholder),range=this._editor.getModel().getDecorationRange(id);selections.push(new selection_1.Selection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn)),couldSkipThisPlaceholder=couldSkipThisPlaceholder&&this._hasPlaceholderBeenCollapsed(placeholder),accessor.changeDecorationOptions(id,placeholder.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),activePlaceholders.add(placeholder);for(const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)){const id=this._placeholderDecorations.get(enclosingPlaceholder);accessor.changeDecorationOptions(id,enclosingPlaceholder.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),activePlaceholders.add(enclosingPlaceholder)}}for(const[placeholder,id]of this._placeholderDecorations)activePlaceholders.has(placeholder)||accessor.changeDecorationOptions(id,placeholder.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive);return selections}));return couldSkipThisPlaceholder?this.move(fwd):null!=newSelections?newSelections:[]}_hasPlaceholderBeenCollapsed(placeholder){let marker=placeholder;for(;marker;){if(marker instanceof snippetParser_1.Placeholder){const id=this._placeholderDecorations.get(marker);if(this._editor.getModel().getDecorationRange(id).isEmpty()&&marker.toString().length>0)return!0}marker=marker.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||0===this._placeholderGroups.length}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}computePossibleSelections(){const result=new Map;for(const placeholdersWithEqualIndex of this._placeholderGroups){let ranges;for(const placeholder of placeholdersWithEqualIndex){if(placeholder.isFinalTabstop)break;ranges||(ranges=[],result.set(placeholder.index,ranges));const id=this._placeholderDecorations.get(placeholder),range=this._editor.getModel().getDecorationRange(id);if(!range){result.delete(placeholder.index);break}ranges.push(range)}}return result}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(others){const model=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations((accessor=>{for(const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]){const nested=others.shift();console.assert(!nested._placeholderDecorations);const indexLastPlaceholder=nested._snippet.placeholderInfo.last.index;for(const nestedPlaceholder of nested._snippet.placeholderInfo.all)nestedPlaceholder.isFinalTabstop?nestedPlaceholder.index=placeholder.index+(indexLastPlaceholder+1)/this._nestingLevel:nestedPlaceholder.index=placeholder.index+nestedPlaceholder.index/this._nestingLevel;this._snippet.replace(placeholder,nested._snippet.children);const id=this._placeholderDecorations.get(placeholder);accessor.removeDecoration(id),this._placeholderDecorations.delete(placeholder);for(const placeholder of nested._snippet.placeholders){const placeholderOffset=nested._snippet.offset(placeholder),placeholderLen=nested._snippet.fullLen(placeholder),range=range_1.Range.fromPositions(model.getPositionAt(nested._offset+placeholderOffset),model.getPositionAt(nested._offset+placeholderOffset+placeholderLen)),handle=accessor.addDecoration(range,OneSnippet._decor.inactive);this._placeholderDecorations.set(placeholder,handle)}}this._placeholderGroups=(0,arrays_1.groupBy)(this._snippet.placeholders,snippetParser_1.Placeholder.compareByIndex)}))}}exports.OneSnippet=OneSnippet,OneSnippet._decor={active:textModel_1.ModelDecorationOptions.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:textModel_1.ModelDecorationOptions.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:textModel_1.ModelDecorationOptions.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:textModel_1.ModelDecorationOptions.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const _defaultOptions={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};class SnippetSession{constructor(editor,template,options=_defaultOptions){this._templateMerges=[],this._snippets=[],this._editor=editor,this._template=template,this._options=options}static adjustWhitespace(model,position,snippet,adjustIndentation,adjustNewlines){const line=model.getLineContent(position.lineNumber),lineLeadingWhitespace=(0,strings_1.getLeadingWhitespace)(line,0,position.column-1);let snippetTextString;return snippet.walk((marker=>{if(!(marker instanceof snippetParser_1.Text)||marker.parent instanceof snippetParser_1.Choice)return!0;const lines=marker.value.split(/\r\n|\r|\n/);if(adjustIndentation){const offset=snippet.offset(marker);if(0===offset)lines[0]=model.normalizeIndentation(lines[0]);else{snippetTextString=null!=snippetTextString?snippetTextString:snippet.toString();let prevChar=snippetTextString.charCodeAt(offset-1);10!==prevChar&&13!==prevChar||(lines[0]=model.normalizeIndentation(lineLeadingWhitespace+lines[0]))}for(let i=1;i<lines.length;i++)lines[i]=model.normalizeIndentation(lineLeadingWhitespace+lines[i])}const newValue=lines.join(model.getEOL());return newValue!==marker.value&&(marker.parent.replace(marker,[new snippetParser_1.Text(newValue)]),snippetTextString=void 0),!0})),lineLeadingWhitespace}static adjustSelection(model,selection,overwriteBefore,overwriteAfter){if(0!==overwriteBefore||0!==overwriteAfter){const{positionLineNumber,positionColumn}=selection,positionColumnBefore=positionColumn-overwriteBefore,positionColumnAfter=positionColumn+overwriteAfter,range=model.validateRange({startLineNumber:positionLineNumber,startColumn:positionColumnBefore,endLineNumber:positionLineNumber,endColumn:positionColumnAfter});selection=selection_1.Selection.createWithDirection(range.startLineNumber,range.startColumn,range.endLineNumber,range.endColumn,selection.getDirection())}return selection}static createEditsAndSnippets(editor,template,overwriteBefore,overwriteAfter,enforceFinalTabstop,adjustWhitespace,clipboardText,overtypingCapturer){const edits=[],snippets=[];if(!editor.hasModel())return{edits,snippets};const model=editor.getModel(),workspaceService=editor.invokeWithinContext((accessor=>accessor.get(workspace_1.IWorkspaceContextService))),modelBasedVariableResolver=editor.invokeWithinContext((accessor=>new snippetVariables_1.ModelBasedVariableResolver(accessor.get(label_1.ILabelService),model))),readClipboardText=()=>clipboardText;let delta=0,firstBeforeText=model.getValueInRange(SnippetSession.adjustSelection(model,editor.getSelection(),overwriteBefore,0)),firstAfterText=model.getValueInRange(SnippetSession.adjustSelection(model,editor.getSelection(),0,overwriteAfter)),firstLineFirstNonWhitespace=model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);const indexedSelections=editor.getSelections().map(((selection,idx)=>({selection,idx}))).sort(((a,b)=>range_1.Range.compareRangesUsingStarts(a.selection,b.selection)));for(const{selection,idx}of indexedSelections){let extensionBefore=SnippetSession.adjustSelection(model,selection,overwriteBefore,0),extensionAfter=SnippetSession.adjustSelection(model,selection,0,overwriteAfter);firstBeforeText!==model.getValueInRange(extensionBefore)&&(extensionBefore=selection),firstAfterText!==model.getValueInRange(extensionAfter)&&(extensionAfter=selection);const snippetSelection=selection.setStartPosition(extensionBefore.startLineNumber,extensionBefore.startColumn).setEndPosition(extensionAfter.endLineNumber,extensionAfter.endColumn),snippet=(new snippetParser_1.SnippetParser).parse(template,!0,enforceFinalTabstop),start=snippetSelection.getStartPosition(),snippetLineLeadingWhitespace=SnippetSession.adjustWhitespace(model,start,snippet,adjustWhitespace||idx>0&&firstLineFirstNonWhitespace!==model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber),!0);snippet.resolveVariables(new snippetVariables_1.CompositeSnippetVariableResolver([modelBasedVariableResolver,new snippetVariables_1.ClipboardBasedVariableResolver(readClipboardText,idx,indexedSelections.length,"spread"===editor.getOption(71)),new snippetVariables_1.SelectionBasedVariableResolver(model,selection,idx,overtypingCapturer),new snippetVariables_1.CommentBasedVariableResolver(model,selection),new snippetVariables_1.TimeBasedVariableResolver,new snippetVariables_1.WorkspaceBasedVariableResolver(workspaceService),new snippetVariables_1.RandomBasedVariableResolver]));const offset=model.getOffsetAt(start)+delta;delta+=snippet.toString().length-model.getValueLengthInRange(snippetSelection),edits[idx]=editOperation_1.EditOperation.replace(snippetSelection,snippet.toString()),edits[idx].identifier={major:idx,minor:0},snippets[idx]=new OneSnippet(editor,snippet,offset,snippetLineLeadingWhitespace)}return{edits,snippets}}dispose(){(0,lifecycle_1.dispose)(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits,snippets}=SnippetSession.createEditsAndSnippets(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer);this._snippets=snippets,this._editor.executeEdits("snippet",edits,(undoEdits=>this._snippets[0].hasPlaceholder?this._move(!0):undoEdits.filter((edit=>!!edit.identifier)).map((edit=>selection_1.Selection.fromPositions(edit.range.getEndPosition()))))),this._editor.revealRange(this._editor.getSelections()[0])}merge(template,options=_defaultOptions){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,template]);const{edits,snippets}=SnippetSession.createEditsAndSnippets(this._editor,template,options.overwriteBefore,options.overwriteAfter,!0,options.adjustWhitespace,options.clipboardText,options.overtypingCapturer);this._editor.executeEdits("snippet",edits,(undoEdits=>{for(const snippet of this._snippets)snippet.merge(snippets);return console.assert(0===snippets.length),this._snippets[0].hasPlaceholder?this._move(void 0):undoEdits.filter((edit=>!!edit.identifier)).map((edit=>selection_1.Selection.fromPositions(edit.range.getEndPosition())))}))}next(){const newSelections=this._move(!0);this._editor.setSelections(newSelections),this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition())}prev(){const newSelections=this._move(!1);this._editor.setSelections(newSelections),this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition())}_move(fwd){const selections=[];for(const snippet of this._snippets){const oneSelection=snippet.move(fwd);selections.push(...oneSelection)}return selections}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const selections=this._editor.getSelections();if(selections.length<this._snippets.length)return!1;let allPossibleSelections=new Map;for(const snippet of this._snippets){const possibleSelections=snippet.computePossibleSelections();if(0===allPossibleSelections.size)for(const[index,ranges]of possibleSelections){ranges.sort(range_1.Range.compareRangesUsingStarts);for(const selection of selections)if(ranges[0].containsRange(selection)){allPossibleSelections.set(index,[]);break}}if(0===allPossibleSelections.size)return!1;allPossibleSelections.forEach(((array,index)=>{array.push(...possibleSelections.get(index))}))}selections.sort(range_1.Range.compareRangesUsingStarts);for(let[index,ranges]of allPossibleSelections)if(ranges.length===selections.length){ranges.sort(range_1.Range.compareRangesUsingStarts);for(let i=0;i<ranges.length;i++)ranges[i].containsRange(selections[i])||allPossibleSelections.delete(index)}else allPossibleSelections.delete(index);return allPossibleSelections.size>0}}exports.SnippetSession=SnippetSession})),define(__m[212],__M([1,0,2,15,3,22,24,109,574,17,9,66,306]),(function(require,exports,lifecycle_1,editorExtensions_1,range_1,selection_1,editorContextKeys_1,suggest_1,nls_1,contextkey_1,instantiation_1,log_1,snippetSession_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SnippetController2=void 0;const _defaultOptions={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetController2=class SnippetController2{constructor(_editor,_instantiationService,_logService,contextKeyService){this._editor=_editor,this._instantiationService=_instantiationService,this._logService=_logService,this._snippetListener=new lifecycle_1.DisposableStore,this._modelVersionId=-1,this._inSnippet=SnippetController2.InSnippetMode.bindTo(contextKeyService),this._hasNextTabstop=SnippetController2.HasNextTabstop.bindTo(contextKeyService),this._hasPrevTabstop=SnippetController2.HasPrevTabstop.bindTo(contextKeyService)}static get(editor){return editor.getContribution(SnippetController2.ID)}dispose(){var _a;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),null===(_a=this._session)||void 0===_a||_a.dispose(),this._snippetListener.dispose()}insert(template,opts){try{this._doInsert(template,void 0===opts?_defaultOptions:Object.assign(Object.assign({},_defaultOptions),opts))}catch(e){this.cancel(),this._logService.error(e),this._logService.error("snippet_error"),this._logService.error("insert_template=",template),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(template,opts){this._editor.hasModel()&&(this._snippetListener.clear(),opts.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(template,opts):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new snippetSession_1.SnippetSession(this._editor,template,opts),this._session.insert()),opts.undoStopAfter&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent((e=>e.isFlush&&this.cancel()))),this._snippetListener.add(this._editor.onDidChangeModel((()=>this.cancel()))),this._snippetListener.add(this._editor.onDidChangeCursorSelection((()=>this._updateState()))))}_updateState(){if(this._session&&this._editor.hasModel()){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel())return void(this._currentChoice=void 0);const{choice}=this._session;if(choice){if(this._currentChoice!==choice){this._currentChoice=choice,this._editor.setSelections(this._editor.getSelections().map((s=>selection_1.Selection.fromPositions(s.getStartPosition()))));const[first]=choice.options;this._instantiationService.invokeFunction(suggest_1.showSimpleSuggestions,this._editor,choice.options.map(((option,i)=>({kind:13,label:option.value,insertText:option.value,sortText:"a".repeat(i+1),range:range_1.Range.fromPositions(this._editor.getPosition(),this._editor.getPosition().delta(0,first.value.length))}))))}}else this._currentChoice=void 0}finish(){for(;this._inSnippet.get();)this.next()}cancel(resetSelection=!1){var _a;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),null===(_a=this._session)||void 0===_a||_a.dispose(),this._session=void 0,this._modelVersionId=-1,resetSelection&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session&&this._session.prev(),this._updateState()}next(){this._session&&this._session.next(),this._updateState()}isInSnippet(){return Boolean(this._inSnippet.get())}};SnippetController2.ID="snippetController2",SnippetController2.InSnippetMode=new contextkey_1.RawContextKey("inSnippetMode",!1,(0,nls_1.localize)(0,null)),SnippetController2.HasNextTabstop=new contextkey_1.RawContextKey("hasNextTabstop",!1,(0,nls_1.localize)(1,null)),SnippetController2.HasPrevTabstop=new contextkey_1.RawContextKey("hasPrevTabstop",!1,(0,nls_1.localize)(2,null)),SnippetController2=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,log_1.ILogService),__param(3,contextkey_1.IContextKeyService)],SnippetController2),exports.SnippetController2=SnippetController2,(0,editorExtensions_1.registerEditorContribution)(SnippetController2.ID,SnippetController2);const CommandCtor=editorExtensions_1.EditorCommand.bindToContribution(SnippetController2.get);(0,editorExtensions_1.registerEditorCommand)(new CommandCtor({id:"jumpToNextSnippetPlaceholder",precondition:contextkey_1.ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasNextTabstop),handler:ctrl=>ctrl.next(),kbOpts:{weight:130,kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:2}})),(0,editorExtensions_1.registerEditorCommand)(new CommandCtor({id:"jumpToPrevSnippetPlaceholder",precondition:contextkey_1.ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasPrevTabstop),handler:ctrl=>ctrl.prev(),kbOpts:{weight:130,kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:1026}})),(0,editorExtensions_1.registerEditorCommand)(new CommandCtor({id:"leaveSnippet",precondition:SnippetController2.InSnippetMode,handler:ctrl=>ctrl.cancel(!0),kbOpts:{weight:130,kbExpr:editorContextKeys_1.EditorContextKeys.editorTextFocus,primary:9,secondary:[1033]}})),(0,editorExtensions_1.registerEditorCommand)(new CommandCtor({id:"acceptSnippet",precondition:SnippetController2.InSnippetMode,handler:ctrl=>ctrl.finish()}))})),define(__m[747],__M([1,0,10,21,13,4,2,8,22,88,212,475,104,41,17,66,90,472,109,20]),(function(require,exports,async_1,cancellation_1,errors_1,event_1,lifecycle_1,strings_1,selection_1,editorWorker_1,snippetController2_1,wordDistance_1,clipboardService_1,configuration_1,contextkey_1,log_1,telemetry_1,completionModel_1,suggest_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestModel=exports.LineContext=void 0;class LineContext{constructor(model,position,auto,shy){this.leadingLineContent=model.getLineContent(position.lineNumber).substr(0,position.column-1),this.leadingWord=model.getWordUntilPosition(position),this.lineNumber=position.lineNumber,this.column=position.column,this.auto=auto,this.shy=shy}static shouldAutoTrigger(editor){if(!editor.hasModel())return!1;const model=editor.getModel(),pos=editor.getPosition();model.tokenizeIfCheap(pos.lineNumber);const word=model.getWordAtPosition(pos);return!!word&&(word.endColumn===pos.column&&!!isNaN(Number(word.word)))}}exports.LineContext=LineContext;let SuggestModel=class SuggestModel{constructor(_editor,_editorWorkerService,_clipboardService,_telemetryService,_logService,_contextKeyService,_configurationService,_languageFeaturesService){this._editor=_editor,this._editorWorkerService=_editorWorkerService,this._clipboardService=_clipboardService,this._telemetryService=_telemetryService,this._logService=_logService,this._contextKeyService=_contextKeyService,this._configurationService=_configurationService,this._languageFeaturesService=_languageFeaturesService,this._toDispose=new lifecycle_1.DisposableStore,this._quickSuggestDelay=10,this._triggerCharacterListener=new lifecycle_1.DisposableStore,this._triggerQuickSuggest=new async_1.TimeoutTimer,this._state=0,this._completionDisposables=new lifecycle_1.DisposableStore,this._onDidCancel=new event_1.Emitter,this._onDidTrigger=new event_1.Emitter,this._onDidSuggest=new event_1.Emitter,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new selection_1.Selection(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeModelLanguage((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeConfiguration((()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()}))),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange((()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})));let editorIsComposing=!1;this._toDispose.add(this._editor.onDidCompositionStart((()=>{editorIsComposing=!0}))),this._toDispose.add(this._editor.onDidCompositionEnd((()=>{editorIsComposing=!1,this._onCompositionEnd()}))),this._toDispose.add(this._editor.onDidChangeCursorSelection((e=>{editorIsComposing||this._onCursorChange(e)}))),this._toDispose.add(this._editor.onDidChangeModelContent((()=>{editorIsComposing||this._refilterCompletionItems()}))),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){(0,lifecycle_1.dispose)(this._triggerCharacterListener),(0,lifecycle_1.dispose)([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getOption(80),(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&0!==this._quickSuggestDelay||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(81)||!this._editor.hasModel()||!this._editor.getOption(109))return;const supportsByTriggerCharacter=new Map;for(const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const ch of support.triggerCharacters||[]){let set=supportsByTriggerCharacter.get(ch);set||(set=new Set,set.add((0,suggest_1.getSnippetSuggestSupport)()),supportsByTriggerCharacter.set(ch,set)),set.add(support)}const checkTriggerCharacter=text=>{if(!function canShowSuggestOnTriggerCharacters(editor,contextKeyService,configurationService){if(!Boolean(contextKeyService.getContextKeyValue("inlineSuggestionVisible")))return!0;const allowQuickSuggestions=configurationService.getValue("editor.inlineSuggest.allowSuggestOnTriggerCharacters");return void 0!==allowQuickSuggestions&&Boolean(allowQuickSuggestions)}(this._editor,this._contextKeyService,this._configurationService))return;if(LineContext.shouldAutoTrigger(this._editor))return;if(!text){const position=this._editor.getPosition();text=this._editor.getModel().getLineContent(position.lineNumber).substr(0,position.column-1)}let lastChar="";(0,strings_1.isLowSurrogate)(text.charCodeAt(text.length-1))?(0,strings_1.isHighSurrogate)(text.charCodeAt(text.length-2))&&(lastChar=text.substr(text.length-2)):lastChar=text.charAt(text.length-1);const supports=supportsByTriggerCharacter.get(lastChar);if(supports){const existing=this._completionModel?{items:this._completionModel.adopt(supports),clipboardText:this._completionModel.clipboardText}:void 0;this.trigger({auto:!0,shy:!1,triggerCharacter:lastChar},Boolean(this._completionModel),supports,existing)}};this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd((()=>checkTriggerCharacter())))}get state(){return this._state}cancel(retrigger=!1){var _a;0!==this._state&&(this._triggerQuickSuggest.cancel(),null===(_a=this._requestToken)||void 0===_a||_a.cancel(),this._requestToken=void 0,this._state=0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){0!==this._state&&(this._editor.hasModel()&&this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.trigger({auto:2===this._state,shy:!1},!0):this.cancel())}_onCursorChange(e){if(!this._editor.hasModel())return;const prevSelection=this._currentSelection;this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||0!==e.reason&&3!==e.reason||"keyboard"!==e.source&&"deleteLeft"!==e.source?this.cancel():0===this._state&&0===e.reason?(prevSelection.containsRange(this._currentSelection)||prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():0!==this._state&&3===e.reason&&this._refilterCompletionItems()}_onCompositionEnd(){0===this._state?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){var _a;!1!==this._editor.getOption(79)&&(this._editor.getOption(106).snippetsPreventQuickSuggestions&&(null===(_a=snippetController2_1.SnippetController2.get(this._editor))||void 0===_a?void 0:_a.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet((()=>{if(0!==this._state)return;if(!LineContext.shouldAutoTrigger(this._editor))return;if(!this._editor.hasModel())return;const model=this._editor.getModel(),pos=this._editor.getPosition(),quickSuggestions=this._editor.getOption(79);if(!1!==quickSuggestions){if(!0===quickSuggestions);else{model.tokenizeIfCheap(pos.lineNumber);const lineTokens=model.getLineTokens(pos.lineNumber),tokenType=lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column-1-1,0)));if(!(quickSuggestions.other&&0===tokenType||quickSuggestions.comments&&1===tokenType||quickSuggestions.strings&&2===tokenType))return}(function canShowQuickSuggest(editor,contextKeyService,configurationService){if(!Boolean(contextKeyService.getContextKeyValue("inlineSuggestionVisible")))return!0;const allowQuickSuggestions=configurationService.getValue("editor.inlineSuggest.allowQuickSuggestions");return void 0!==allowQuickSuggestions&&Boolean(allowQuickSuggestions)})(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(model)&&this.trigger({auto:!0,shy:!1})}}),this._quickSuggestDelay)))}_refilterCompletionItems(){Promise.resolve().then((()=>{if(0===this._state)return;if(!this._editor.hasModel())return;const model=this._editor.getModel(),position=this._editor.getPosition(),ctx=new LineContext(model,position,2===this._state,!1);this._onNewContext(ctx)}))}trigger(context,retrigger=!1,onlyFrom,existing){var _a;if(!this._editor.hasModel())return;const model=this._editor.getModel(),auto=context.auto,ctx=new LineContext(model,this._editor.getPosition(),auto,context.shy);this.cancel(retrigger),this._state=auto?2:1,this._onDidTrigger.fire({auto,shy:context.shy,position:this._editor.getPosition()}),this._context=ctx;let suggestCtx={triggerKind:null!==(_a=context.triggerKind)&&void 0!==_a?_a:0};context.triggerCharacter&&(suggestCtx={triggerKind:1,triggerCharacter:context.triggerCharacter}),this._requestToken=new cancellation_1.CancellationTokenSource;const snippetSuggestions=this._editor.getOption(101);let snippetSortOrder=1;switch(snippetSuggestions){case"top":snippetSortOrder=0;break;case"bottom":snippetSortOrder=2}const{itemKind:itemKindFilter,showDeprecated}=SuggestModel._createSuggestFilter(this._editor),wordDistance=wordDistance_1.WordDistance.create(this._editorWorkerService,this._editor),completions=(0,suggest_1.provideSuggestionItems)(this._languageFeaturesService.completionProvider,model,this._editor.getPosition(),new suggest_1.CompletionOptions(snippetSortOrder,itemKindFilter,onlyFrom,showDeprecated),suggestCtx,this._requestToken.token);Promise.all([completions,wordDistance]).then((([completions,wordDistance])=>__awaiter(this,void 0,void 0,(function*(){var _b;if(null===(_b=this._requestToken)||void 0===_b||_b.dispose(),!this._editor.hasModel())return;let clipboardText=null==existing?void 0:existing.clipboardText;if(!clipboardText&&completions.needsClipboard&&(clipboardText=yield this._clipboardService.readText()),0===this._state)return;const model=this._editor.getModel();let items=completions.items;if(existing){const cmpFn=(0,suggest_1.getSuggestionComparator)(snippetSortOrder);items=items.concat(existing.items).sort(cmpFn)}const ctx=new LineContext(model,this._editor.getPosition(),auto,context.shy);this._completionModel=new completionModel_1.CompletionModel(items,this._context.column,{leadingLineContent:ctx.leadingLineContent,characterCountDelta:ctx.column-this._context.column},wordDistance,this._editor.getOption(106),this._editor.getOption(101),clipboardText),this._completionDisposables.add(completions.disposable),this._onNewContext(ctx),this._reportDurationsTelemetry(completions.durations)})))).catch(errors_1.onUnexpectedError)}_reportDurationsTelemetry(durations){this._telemetryGate++%230==0&&setTimeout((()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(durations)}),this._logService.debug("suggest.durations.json",durations)}))}static _createSuggestFilter(editor){const result=new Set;"none"===editor.getOption(101)&&result.add(27);const suggestOptions=editor.getOption(106);return suggestOptions.showMethods||result.add(0),suggestOptions.showFunctions||result.add(1),suggestOptions.showConstructors||result.add(2),suggestOptions.showFields||result.add(3),suggestOptions.showVariables||result.add(4),suggestOptions.showClasses||result.add(5),suggestOptions.showStructs||result.add(6),suggestOptions.showInterfaces||result.add(7),suggestOptions.showModules||result.add(8),suggestOptions.showProperties||result.add(9),suggestOptions.showEvents||result.add(10),suggestOptions.showOperators||result.add(11),suggestOptions.showUnits||result.add(12),suggestOptions.showValues||result.add(13),suggestOptions.showConstants||result.add(14),suggestOptions.showEnums||result.add(15),suggestOptions.showEnumMembers||result.add(16),suggestOptions.showKeywords||result.add(17),suggestOptions.showWords||result.add(18),suggestOptions.showColors||result.add(19),suggestOptions.showFiles||result.add(20),suggestOptions.showReferences||result.add(21),suggestOptions.showColors||result.add(22),suggestOptions.showFolders||result.add(23),suggestOptions.showTypeParameters||result.add(24),suggestOptions.showSnippets||result.add(27),suggestOptions.showUsers||result.add(25),suggestOptions.showIssues||result.add(26),{itemKind:result,showDeprecated:suggestOptions.showDeprecated}}_onNewContext(ctx){if(this._context)if(ctx.lineNumber===this._context.lineNumber)if((0,strings_1.getLeadingWhitespace)(ctx.leadingLineContent)===(0,strings_1.getLeadingWhitespace)(this._context.leadingLineContent)){if(ctx.column<this._context.column)ctx.leadingWord.word?this.trigger({auto:this._context.auto,shy:!1},!0):this.cancel();else if(this._completionModel)if(0!==ctx.leadingWord.word.length&&ctx.leadingWord.startColumn>this._context.leadingWord.startColumn){const inactiveProvider=new Set(this._languageFeaturesService.completionProvider.all(this._editor.getModel()));for(let provider of this._completionModel.allProvider)inactiveProvider.delete(provider);const items=this._completionModel.adopt(new Set);this.trigger({auto:this._context.auto,shy:!1},!0,inactiveProvider,{items,clipboardText:this._completionModel.clipboardText})}else if(ctx.column>this._context.column&&this._completionModel.incomplete.size>0&&0!==ctx.leadingWord.word.length){const{incomplete}=this._completionModel,items=this._completionModel.adopt(incomplete);this.trigger({auto:2===this._state,shy:!1,triggerKind:2},!0,incomplete,{items,clipboardText:this._completionModel.clipboardText})}else{let oldLineContext=this._completionModel.lineContext,isFrozen=!1;if(this._completionModel.lineContext={leadingLineContent:ctx.leadingLineContent,characterCountDelta:ctx.column-this._context.column},0===this._completionModel.items.length){if(LineContext.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<ctx.leadingWord.startColumn)return void this.trigger({auto:this._context.auto,shy:!1},!0);if(this._context.auto)return void this.cancel();if(this._completionModel.lineContext=oldLineContext,isFrozen=this._completionModel.items.length>0,isFrozen&&0===ctx.leadingWord.word.length)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,shy:this._context.shy,isFrozen})}}else this.cancel();else this.cancel()}};SuggestModel=__decorate([__param(1,editorWorker_1.IEditorWorkerService),__param(2,clipboardService_1.IClipboardService),__param(3,telemetry_1.ITelemetryService),__param(4,log_1.ILogService),__param(5,contextkey_1.IContextKeyService),__param(6,configuration_1.IConfigurationService),__param(7,languageFeatures_1.ILanguageFeaturesService)],SuggestModel),exports.SuggestModel=SuggestModel})),define(__m[307],__M([1,0,46,18,10,21,13,4,96,2,16,55,19,146,15,63,11,3,24,212,127,640,613,577,37,26,17,9,89,66,109,612,473,747,474,733,90,42,114]),(function(require,exports,aria_1,arrays_1,async_1,cancellation_1,errors_1,event_1,keybindings_1,lifecycle_1,platform,stopwatch_1,types_1,stableEditorScroll_1,editorExtensions_1,editOperation_1,position_1,range_1,editorContextKeys_1,snippetController2_1,snippetParser_1,suggestMemory_1,wordContextKey_1,nls,actions_1,commands_1,contextkey_1,instantiation_1,keybindingsRegistry_1,log_1,suggest_1,suggestAlternatives_1,suggestCommitCharacters_1,suggestModel_1,suggestOvertypingCapturer_1,suggestWidget_1,telemetry_1,resources_1,hash_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TriggerSuggestAction=exports.SuggestController=void 0;class LineSuffix{constructor(_model,_position){this._model=_model,this._position=_position;if(_model.getLineMaxColumn(_position.lineNumber)!==_position.column){const offset=_model.getOffsetAt(_position),end=_model.getPositionAt(offset+1);this._marker=_model.deltaDecorations([],[{range:range_1.Range.fromPositions(_position,end),options:{description:"suggest-line-suffix",stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(position){if(this._model.isDisposed()||this._position.lineNumber!==position.lineNumber)return 0;if(this._marker){const range=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(range.getStartPosition())-this._model.getOffsetAt(position)}return this._model.getLineMaxColumn(position.lineNumber)-position.column}}let SuggestController=class SuggestController{constructor(editor,_memoryService,_commandService,_contextKeyService,_instantiationService,_logService,_telemetryService){this._memoryService=_memoryService,this._commandService=_commandService,this._contextKeyService=_contextKeyService,this._instantiationService=_instantiationService,this._logService=_logService,this._telemetryService=_telemetryService,this._lineSuffix=new lifecycle_1.MutableDisposable,this._toDispose=new lifecycle_1.DisposableStore,this._selectors=new PriorityRegistry((s=>s.priority)),this._telemetryGate=0,this.editor=editor,this.model=_instantiationService.createInstance(suggestModel_1.SuggestModel,this.editor);const ctxInsertMode=suggest_1.Context.InsertMode.bindTo(_contextKeyService);ctxInsertMode.set(editor.getOption(106).insertMode),this.model.onDidTrigger((()=>ctxInsertMode.set(editor.getOption(106).insertMode))),this.widget=this._toDispose.add(new async_1.IdleValue((()=>{const widget=this._instantiationService.createInstance(suggestWidget_1.SuggestWidget,this.editor);this._toDispose.add(widget),this._toDispose.add(widget.onDidSelect((item=>this._insertSuggestion(item,0)),this));const commitCharacterController=new suggestCommitCharacters_1.CommitCharacterController(this.editor,widget,(item=>this._insertSuggestion(item,2)));this._toDispose.add(commitCharacterController),this._toDispose.add(this.model.onDidSuggest((e=>{0===e.completionModel.items.length&&commitCharacterController.reset()})));const ctxMakesTextEdit=suggest_1.Context.MakesTextEdit.bindTo(this._contextKeyService),ctxHasInsertAndReplace=suggest_1.Context.HasInsertAndReplaceRange.bindTo(this._contextKeyService),ctxCanResolve=suggest_1.Context.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add((0,lifecycle_1.toDisposable)((()=>{ctxMakesTextEdit.reset(),ctxHasInsertAndReplace.reset(),ctxCanResolve.reset()}))),this._toDispose.add(widget.onDidFocus((({item})=>{const position=this.editor.getPosition(),startColumn=item.editStart.column,endColumn=position.column;let value=!0;if(!("smart"!==this.editor.getOption(1)||2!==this.model.state||item.completion.additionalTextEdits||4&item.completion.insertTextRules||endColumn-startColumn!==item.completion.insertText.length)){value=this.editor.getModel().getValueInRange({startLineNumber:position.lineNumber,startColumn,endLineNumber:position.lineNumber,endColumn})!==item.completion.insertText}ctxMakesTextEdit.set(value),ctxHasInsertAndReplace.set(!position_1.Position.equals(item.editInsertEnd,item.editReplaceEnd)),ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem)||Boolean(item.completion.documentation)||item.completion.detail!==item.completion.label)}))),this._toDispose.add(widget.onDetailsKeyDown((e=>{e.toKeybinding().equals(new keybindings_1.SimpleKeybinding(!0,!1,!1,!1,33))||platform.isMacintosh&&e.toKeybinding().equals(new keybindings_1.SimpleKeybinding(!1,!1,!1,!0,33))?e.stopPropagation():e.toKeybinding().isModifierKey()||this.editor.focus()}))),widget}))),this._overtypingCapturer=this._toDispose.add(new async_1.IdleValue((()=>this._toDispose.add(new suggestOvertypingCapturer_1.OvertypingCapturer(this.editor,this.model))))),this._alternatives=this._toDispose.add(new async_1.IdleValue((()=>this._toDispose.add(new suggestAlternatives_1.SuggestAlternatives(this.editor,this._contextKeyService))))),this._toDispose.add(_instantiationService.createInstance(wordContextKey_1.WordContextKey,editor)),this._toDispose.add(this.model.onDidTrigger((e=>{this.widget.value.showTriggered(e.auto,e.shy?250:50),this._lineSuffix.value=new LineSuffix(this.editor.getModel(),e.position)}))),this._toDispose.add(this.model.onDidSuggest((e=>{if(!e.shy){let index=-1;for(const selector of this._selectors.itemsOrderedByPriorityDesc)if(index=selector.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items),-1!==index)break;-1===index&&(index=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items)),this.widget.value.showSuggestions(e.completionModel,index,e.isFrozen,e.auto)}}))),this._toDispose.add(this.model.onDidCancel((e=>{e.retrigger||this.widget.value.hideWidget()}))),this._toDispose.add(this.editor.onDidBlurEditorWidget((()=>{this.model.cancel(),this.model.clear()})));let acceptSuggestionsOnEnter=suggest_1.Context.AcceptSuggestionsOnEnter.bindTo(_contextKeyService),updateFromConfig=()=>{const acceptSuggestionOnEnter=this.editor.getOption(1);acceptSuggestionsOnEnter.set("on"===acceptSuggestionOnEnter||"smart"===acceptSuggestionOnEnter)};this._toDispose.add(this.editor.onDidChangeConfiguration((()=>updateFromConfig()))),updateFromConfig()}static get(editor){return editor.getContribution(SuggestController.ID)}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(event,flags){if(!event||!event.item)return this._alternatives.value.reset(),this.model.cancel(),void this.model.clear();if(!this.editor.hasModel())return;const snippetController=snippetController2_1.SnippetController2.get(this.editor);if(!snippetController)return;const model=this.editor.getModel(),modelVersionNow=model.getAlternativeVersionId(),{item}=event,tasks=[],cts=new cancellation_1.CancellationTokenSource;1&flags||this.editor.pushUndoStop();const info=this.getOverwriteInfo(item,Boolean(8&flags));if(this._memoryService.memorize(model,this.editor.getPosition(),item),Array.isArray(item.completion.additionalTextEdits)){const scrollState=stableEditorScroll_1.StableEditorScrollState.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",item.completion.additionalTextEdits.map((edit=>editOperation_1.EditOperation.replace(range_1.Range.lift(edit.range),edit.text)))),scrollState.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!item.isResolved){const sw=new stopwatch_1.StopWatch(!0);let position;const docListener=model.onDidChangeContent((e=>{if(e.isFlush)return cts.cancel(),void docListener.dispose();for(let change of e.changes){const thisPosition=range_1.Range.getEndPosition(change.range);position&&!position_1.Position.isBefore(thisPosition,position)||(position=thisPosition)}}));let oldFlags=flags;flags|=2;let didType=!1,typeListener=this.editor.onWillType((()=>{typeListener.dispose(),didType=!0,2&oldFlags||this.editor.pushUndoStop()}));tasks.push(item.resolve(cts.token).then((()=>{if(!item.completion.additionalTextEdits||cts.token.isCancellationRequested)return!1;if(position&&item.completion.additionalTextEdits.some((edit=>position_1.Position.isBefore(position,range_1.Range.getStartPosition(edit.range)))))return!1;didType&&this.editor.pushUndoStop();const scrollState=stableEditorScroll_1.StableEditorScrollState.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",item.completion.additionalTextEdits.map((edit=>editOperation_1.EditOperation.replace(range_1.Range.lift(edit.range),edit.text)))),scrollState.restoreRelativeVerticalPositionOfCursor(this.editor),!didType&&2&oldFlags||this.editor.pushUndoStop(),!0})).then((applied=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",sw.elapsed(),applied),docListener.dispose(),typeListener.dispose()})))}let{insertText}=item.completion;4&item.completion.insertTextRules||(insertText=snippetParser_1.SnippetParser.escape(insertText)),snippetController.insert(insertText,{overwriteBefore:info.overwriteBefore,overwriteAfter:info.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(1&item.completion.insertTextRules),clipboardText:event.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),2&flags||this.editor.pushUndoStop(),item.completion.command?item.completion.command.id===TriggerSuggestAction.id?this.model.trigger({auto:!0,shy:!1},!0):(tasks.push(this._commandService.executeCommand(item.completion.command.id,...item.completion.command.arguments?[...item.completion.command.arguments]:[]).catch(errors_1.onUnexpectedError)),this.model.cancel()):this.model.cancel(),4&flags&&this._alternatives.value.set(event,(next=>{for(cts.cancel();model.canUndo();){modelVersionNow!==model.getAlternativeVersionId()&&model.undo(),this._insertSuggestion(next,3|(8&flags?8:0));break}})),this._alertCompletionItem(item),Promise.all(tasks).finally((()=>{this._reportSuggestionAcceptedTelemetry(model,event),this.model.clear(),cts.dispose()}))}_reportSuggestionAcceptedTelemetry(model,acceptedSuggestion){var _a;if(this._telemetryGate++%100!=0)return;const providerId=(null!==(_a=acceptedSuggestion.item.provider._debugDisplayName)&&void 0!==_a?_a:"unknown").split("(",1)[0].toLowerCase();this._telemetryService.publicLog2("suggest.acceptedSuggestion",{providerId,basenameHash:(0,hash_1.hash)((0,resources_1.basename)(model.uri)).toString(16),languageId:model.getLanguageId(),fileExtension:(0,resources_1.extname)(model.uri)})}getOverwriteInfo(item,toggleMode){(0,types_1.assertType)(this.editor.hasModel());let replace="replace"===this.editor.getOption(106).insertMode;toggleMode&&(replace=!replace);const overwriteBefore=item.position.column-item.editStart.column,overwriteAfter=(replace?item.editReplaceEnd.column:item.editInsertEnd.column)-item.position.column;return{overwriteBefore:overwriteBefore+(this.editor.getPosition().column-item.position.column),overwriteAfter:overwriteAfter+(this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0)}}_alertCompletionItem(item){if((0,arrays_1.isNonEmptyArray)(item.completion.additionalTextEdits)){let msg=nls.localize(0,null,item.textLabel,item.completion.additionalTextEdits.length);(0,aria_1.alert)(msg)}}triggerSuggest(onlyFrom,auto){this.editor.hasModel()&&(this.model.trigger({auto:null!=auto&&auto,shy:!1},!1,onlyFrom),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(arg){if(!this.editor.hasModel())return;const positionNow=this.editor.getPosition(),fallback=()=>{positionNow.equals(this.editor.getPosition())&&this._commandService.executeCommand(arg.fallback)},makesTextEdit=item=>{if(4&item.completion.insertTextRules||item.completion.additionalTextEdits)return!0;const position=this.editor.getPosition(),startColumn=item.editStart.column,endColumn=position.column;if(endColumn-startColumn!==item.completion.insertText.length)return!0;return this.editor.getModel().getValueInRange({startLineNumber:position.lineNumber,startColumn,endLineNumber:position.lineNumber,endColumn})!==item.completion.insertText};event_1.Event.once(this.model.onDidTrigger)((_=>{let listener=[];event_1.Event.any(this.model.onDidTrigger,this.model.onDidCancel)((()=>{(0,lifecycle_1.dispose)(listener),fallback()}),void 0,listener),this.model.onDidSuggest((({completionModel})=>{if((0,lifecycle_1.dispose)(listener),0===completionModel.items.length)return void fallback();const index=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),completionModel.items),item=completionModel.items[index];makesTextEdit(item)?(this.editor.pushUndoStop(),this._insertSuggestion({index,item,model:completionModel},7)):fallback()}),void 0,listener)})),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(positionNow,0),this.editor.focus()}acceptSelectedSuggestion(keepAlternativeSuggestions,alternativeOverwriteConfig){const item=this.widget.value.getFocusedItem();let flags=0;keepAlternativeSuggestions&&(flags|=4),alternativeOverwriteConfig&&(flags|=8),this._insertSuggestion(item,flags)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(selector){return this._selectors.register(selector)}};SuggestController.ID="editor.contrib.suggestController",SuggestController=__decorate([__param(1,suggestMemory_1.ISuggestMemoryService),__param(2,commands_1.ICommandService),__param(3,contextkey_1.IContextKeyService),__param(4,instantiation_1.IInstantiationService),__param(5,log_1.ILogService),__param(6,telemetry_1.ITelemetryService)],SuggestController),exports.SuggestController=SuggestController;class PriorityRegistry{constructor(prioritySelector){this.prioritySelector=prioritySelector,this._items=new Array}register(value){if(-1!==this._items.indexOf(value))throw new Error("Value is already registered");return this._items.push(value),this._items.sort(((s1,s2)=>this.prioritySelector(s2)-this.prioritySelector(s1))),{dispose:()=>{const idx=this._items.indexOf(value);idx>=0&&this._items.splice(idx,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class TriggerSuggestAction extends editorExtensions_1.EditorAction{constructor(){super({id:TriggerSuggestAction.id,label:nls.localize(1,null),alias:"Trigger Suggest",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,editorContextKeys_1.EditorContextKeys.hasCompletionItemProvider),kbOpts:{kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(_accessor,editor,args){const controller=SuggestController.get(editor);if(!controller)return;let auto;args&&"object"==typeof args&&!0===args.auto&&(auto=!0),controller.triggerSuggest(void 0,auto)}}exports.TriggerSuggestAction=TriggerSuggestAction,TriggerSuggestAction.id="editor.action.triggerSuggest",(0,editorExtensions_1.registerEditorContribution)(SuggestController.ID,SuggestController),(0,editorExtensions_1.registerEditorAction)(TriggerSuggestAction);const SuggestCommand=editorExtensions_1.EditorCommand.bindToContribution(SuggestController.get);(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"acceptSelectedSuggestion",precondition:suggest_1.Context.Visible,handler(x){x.acceptSelectedSuggestion(!0,!1)}})),keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({id:"acceptSelectedSuggestion",when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,editorContextKeys_1.EditorContextKeys.textInputFocus),primary:2,weight:190}),keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({id:"acceptSelectedSuggestion",when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,editorContextKeys_1.EditorContextKeys.textInputFocus,suggest_1.Context.AcceptSuggestionsOnEnter,suggest_1.Context.MakesTextEdit),primary:3,weight:190}),actions_1.MenuRegistry.appendMenuItem(suggest_1.suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:nls.localize(2,null)},group:"left",order:1,when:suggest_1.Context.HasInsertAndReplaceRange.toNegated()}),actions_1.MenuRegistry.appendMenuItem(suggest_1.suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:nls.localize(3,null)},group:"left",order:1,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.HasInsertAndReplaceRange,suggest_1.Context.InsertMode.isEqualTo("insert"))}),actions_1.MenuRegistry.appendMenuItem(suggest_1.suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:nls.localize(4,null)},group:"left",order:1,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.HasInsertAndReplaceRange,suggest_1.Context.InsertMode.isEqualTo("replace"))}),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"acceptAlternativeSelectedSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,editorContextKeys_1.EditorContextKeys.textInputFocus),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1027,secondary:[1026]},handler(x){x.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:suggest_1.suggestWidgetStatusbarMenu,group:"left",order:2,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.HasInsertAndReplaceRange,suggest_1.Context.InsertMode.isEqualTo("insert")),title:nls.localize(5,null)},{menuId:suggest_1.suggestWidgetStatusbarMenu,group:"left",order:2,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.HasInsertAndReplaceRange,suggest_1.Context.InsertMode.isEqualTo("replace")),title:nls.localize(6,null)}]})),commands_1.CommandsRegistry.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion"),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"hideSuggestWidget",precondition:suggest_1.Context.Visible,handler:x=>x.cancelSuggestWidget(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectNextSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectNextSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectNextPageSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectNextPageSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:12,secondary:[2060]}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectLastSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectLastSuggestion()})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectPrevSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectPrevSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectPrevPageSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectPrevPageSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:11,secondary:[2059]}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"selectFirstSuggestion",precondition:contextkey_1.ContextKeyExpr.and(suggest_1.Context.Visible,suggest_1.Context.MultipleSuggestions),handler:c=>c.selectFirstSuggestion()})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"toggleSuggestionDetails",precondition:suggest_1.Context.Visible,handler:x=>x.toggleSuggestionDetails(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:suggest_1.suggestWidgetStatusbarMenu,group:"right",order:1,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.DetailsVisible,suggest_1.Context.CanResolve),title:nls.localize(7,null)},{menuId:suggest_1.suggestWidgetStatusbarMenu,group:"right",order:1,when:contextkey_1.ContextKeyExpr.and(suggest_1.Context.DetailsVisible.toNegated(),suggest_1.Context.CanResolve),title:nls.localize(8,null)}]})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"toggleExplainMode",precondition:suggest_1.Context.Visible,handler:x=>x.toggleExplainMode(),kbOpts:{weight:100,primary:2133}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"toggleSuggestionFocus",precondition:suggest_1.Context.Visible,handler:x=>x.toggleSuggestionFocus(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2570,mac:{primary:778}}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"insertBestCompletion",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,contextkey_1.ContextKeyExpr.equals("config.editor.tabCompletion","on"),wordContextKey_1.WordContextKey.AtEnd,suggest_1.Context.Visible.toNegated(),suggestAlternatives_1.SuggestAlternatives.OtherSuggestions.toNegated(),snippetController2_1.SnippetController2.InSnippetMode.toNegated()),handler:(x,arg)=>{x.triggerSuggestAndAcceptBest((0,types_1.isObject)(arg)?Object.assign({fallback:"tab"},arg):{fallback:"tab"})},kbOpts:{weight:190,primary:2}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"insertNextSuggestion",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,contextkey_1.ContextKeyExpr.equals("config.editor.tabCompletion","on"),suggestAlternatives_1.SuggestAlternatives.OtherSuggestions,suggest_1.Context.Visible.toNegated(),snippetController2_1.SnippetController2.InSnippetMode.toNegated()),handler:x=>x.acceptNextSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:2}})),(0,editorExtensions_1.registerEditorCommand)(new SuggestCommand({id:"insertPrevSuggestion",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.textInputFocus,contextkey_1.ContextKeyExpr.equals("config.editor.tabCompletion","on"),suggestAlternatives_1.SuggestAlternatives.OtherSuggestions,suggest_1.Context.Visible.toNegated(),snippetController2_1.SnippetController2.InSnippetMode.toNegated()),handler:x=>x.acceptPrevSuggestion(),kbOpts:{weight:190,kbExpr:editorContextKeys_1.EditorContextKeys.textInputFocus,primary:1026}})),(0,editorExtensions_1.registerEditorAction)(class extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.resetSuggestSize",label:nls.localize(9,null),alias:"Reset Suggest Widget Size",precondition:void 0})}run(_accessor,editor){var _a;null===(_a=SuggestController.get(editor))||void 0===_a||_a.resetWidgetSize()}})})),define(__m[748],__M([1,0,18,10,4,2,11,3,127,306,307,208,194]),(function(require,exports,arrays_1,async_1,event_1,lifecycle_1,position_1,range_1,snippetParser_1,snippetSession_1,suggestController_1,inlineCompletionsModel_1,inlineCompletionToGhostText_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.rangeStartsWith=exports.SuggestWidgetInlineCompletionProvider=void 0;class SuggestWidgetInlineCompletionProvider extends lifecycle_1.Disposable{constructor(editor,suggestControllerPreselector){super(),this.editor=editor,this.suggestControllerPreselector=suggestControllerPreselector,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new async_1.RunOnceScheduler((()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())}),100)),this._register(editor.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(editor.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const suggestController=suggestController_1.SuggestController.get(this.editor);if(suggestController){this._register(suggestController.registerSelector({priority:100,select:(model,pos,suggestItems)=>{const textModel=this.editor.getModel(),normalizedItemToPreselect=(0,inlineCompletionsModel_1.minimizeInlineCompletion)(textModel,this.suggestControllerPreselector());if(!normalizedItemToPreselect)return-1;const position=position_1.Position.lift(pos),candidates=suggestItems.map(((suggestItem,index)=>{const inlineSuggestItem=suggestionToSuggestItemInfo(suggestController,position,suggestItem,this.isShiftKeyPressed),normalizedSuggestItem=(0,inlineCompletionsModel_1.minimizeInlineCompletion)(textModel,null==inlineSuggestItem?void 0:inlineSuggestItem.normalizedInlineCompletion);if(!normalizedSuggestItem)return;return{index,valid:rangeStartsWith(normalizedItemToPreselect.range,normalizedSuggestItem.range)&&normalizedItemToPreselect.text.startsWith(normalizedSuggestItem.text),prefixLength:normalizedSuggestItem.text.length,suggestItem}})).filter((item=>item&&item.valid)),result=(0,arrays_1.findMaxBy)(candidates,(0,arrays_1.compareBy)((s=>s.prefixLength),arrays_1.numberComparator));return result?result.index:-1}}));let isBoundToSuggestWidget=!1;const bindToSuggestWidget=()=>{isBoundToSuggestWidget||(isBoundToSuggestWidget=!0,this._register(suggestController.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(suggestController.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)}))),this._register(suggestController.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(event_1.Event.once(suggestController.model.onDidTrigger)((e=>{bindToSuggestWidget()})))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItem:this._currentSuggestItemInfo}}update(newActive){const newInlineCompletion=this.getSuggestItemInfo();let shouldFire=!1;(function suggestItemInfoEquals(a,b){if(a===b)return!0;if(!a||!b)return!1;return a.completionItemKind===b.completionItemKind&&a.isSnippetText===b.isSnippetText&&(0,inlineCompletionToGhostText_1.normalizedInlineCompletionsEquals)(a.normalizedInlineCompletion,b.normalizedInlineCompletion)})(this._currentSuggestItemInfo,newInlineCompletion)||(this._currentSuggestItemInfo=newInlineCompletion,shouldFire=!0),this._isActive!==newActive&&(this._isActive=newActive,shouldFire=!0),shouldFire&&this.onDidChangeEmitter.fire()}getSuggestItemInfo(){const suggestController=suggestController_1.SuggestController.get(this.editor);if(!suggestController)return;if(!this.isSuggestWidgetVisible)return;const focusedItem=suggestController.widget.value.getFocusedItem();return focusedItem?suggestionToSuggestItemInfo(suggestController,this.editor.getPosition(),focusedItem.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const suggestController=suggestController_1.SuggestController.get(this.editor);suggestController&&suggestController.stopForceRenderingAbove()}forceRenderingAbove(){const suggestController=suggestController_1.SuggestController.get(this.editor);suggestController&&suggestController.forceRenderingAbove()}}function rangeStartsWith(rangeToTest,prefix){return prefix.startLineNumber===rangeToTest.startLineNumber&&prefix.startColumn===rangeToTest.startColumn&&(prefix.endLineNumber<rangeToTest.endLineNumber||prefix.endLineNumber===rangeToTest.endLineNumber&&prefix.endColumn<=rangeToTest.endColumn)}function suggestionToSuggestItemInfo(suggestController,position,item,toggleMode){if(Array.isArray(item.completion.additionalTextEdits)&&item.completion.additionalTextEdits.length>0)return{completionItemKind:item.completion.kind,isSnippetText:!1,normalizedInlineCompletion:{range:range_1.Range.fromPositions(position,position),text:""}};let{insertText}=item.completion,isSnippetText=!1;if(4&item.completion.insertTextRules){const snippet=(new snippetParser_1.SnippetParser).parse(insertText),model=suggestController.editor.getModel();if(snippet.children.length>100)return;snippetSession_1.SnippetSession.adjustWhitespace(model,position,snippet,!0,!0),insertText=snippet.toString(),isSnippetText=!0}const info=suggestController.getOverwriteInfo(item,toggleMode);return{isSnippetText,completionItemKind:item.completion.kind,normalizedInlineCompletion:{text:insertText,range:range_1.Range.fromPositions(position.delta(0,-info.overwriteBefore),position.delta(0,Math.max(info.overwriteAfter,0)))}}}exports.SuggestWidgetInlineCompletionProvider=SuggestWidgetInlineCompletionProvider,exports.rangeStartsWith=rangeStartsWith})),define(__m[749],__M([1,0,10,13,2,27,20,193,208,194,748]),(function(require,exports,async_1,errors_1,lifecycle_1,languages_1,languageFeatures_1,ghostText_1,inlineCompletionsModel_1,inlineCompletionToGhostText_1,suggestWidgetInlineCompletionProvider_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SuggestWidgetPreviewModel=void 0;let SuggestWidgetPreviewModel=class SuggestWidgetPreviewModel extends ghostText_1.BaseGhostTextWidgetModel{constructor(editor,cache,languageFeaturesService){super(editor),this.cache=cache,this.languageFeaturesService=languageFeaturesService,this.suggestionInlineCompletionSource=this._register(new suggestWidgetInlineCompletionProvider_1.SuggestWidgetInlineCompletionProvider(this.editor,(()=>{var _a,_b;return null===(_b=null===(_a=this.cache.value)||void 0===_a?void 0:_a.completions[0])||void 0===_b?void 0:_b.toLiveInlineCompletion()}))),this.updateOperation=this._register(new lifecycle_1.MutableDisposable),this.updateCacheSoon=this._register(new async_1.RunOnceScheduler((()=>this.updateCache()),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange((()=>{this.updateCacheSoon.schedule();this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);const newGhostText=this.ghostText;newGhostText&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,function sum(arr){return arr.reduce(((a,b)=>a+b),0)}(newGhostText.parts.map((p=>p.lines.length-1))))),this.minReservedLineCount>=1?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()}))),this._register(this.cache.onDidChange((()=>{this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire()}))),this._register((0,lifecycle_1.toDisposable)((()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove())))}get isActive(){return void 0!==this.suggestionInlineCompletionSource.state}isSuggestionPreviewEnabled(){return this.editor.getOption(106).preview}updateCache(){return __awaiter(this,void 0,void 0,(function*(){const state=this.suggestionInlineCompletionSource.state;if(!state||!state.selectedItem)return;const info={text:state.selectedItem.normalizedInlineCompletion.text,range:state.selectedItem.normalizedInlineCompletion.range,isSnippetText:state.selectedItem.isSnippetText,completionKind:state.selectedItem.completionItemKind},position=this.editor.getPosition(),promise=(0,async_1.createCancelablePromise)((token=>__awaiter(this,void 0,void 0,(function*(){let result;try{result=yield(0,inlineCompletionsModel_1.provideInlineCompletions)(this.languageFeaturesService.inlineCompletionsProvider,position,this.editor.getModel(),{triggerKind:languages_1.InlineCompletionTriggerKind.Automatic,selectedSuggestionInfo:info},token)}catch(e){return void(0,errors_1.onUnexpectedError)(e)}token.isCancellationRequested||(this.cache.setValue(this.editor,result,languages_1.InlineCompletionTriggerKind.Automatic),this.onDidChangeEmitter.fire())})))),operation=new inlineCompletionsModel_1.UpdateOperation(promise,languages_1.InlineCompletionTriggerKind.Automatic);this.updateOperation.value=operation,yield promise,this.updateOperation.value===operation&&this.updateOperation.clear()}))}get ghostText(){var _a,_b,_c;const isSuggestionPreviewEnabled=this.isSuggestionPreviewEnabled(),augmentedCompletion=(0,inlineCompletionsModel_1.minimizeInlineCompletion)(this.editor.getModel(),null===(_b=null===(_a=this.cache.value)||void 0===_a?void 0:_a.completions[0])||void 0===_b?void 0:_b.toLiveInlineCompletion()),suggestWidgetState=this.suggestionInlineCompletionSource.state,suggestInlineCompletion=(0,inlineCompletionsModel_1.minimizeInlineCompletion)(this.editor.getModel(),null===(_c=null==suggestWidgetState?void 0:suggestWidgetState.selectedItem)||void 0===_c?void 0:_c.normalizedInlineCompletion),isAugmentedCompletionValid=augmentedCompletion&&suggestInlineCompletion&&augmentedCompletion.text.startsWith(suggestInlineCompletion.text)&&augmentedCompletion.range.equalsRange(suggestInlineCompletion.range);if(!isSuggestionPreviewEnabled&&!isAugmentedCompletionValid)return;const finalCompletion=isAugmentedCompletionValid?augmentedCompletion:suggestInlineCompletion||augmentedCompletion,inlineCompletionPreviewLength=isAugmentedCompletionValid?finalCompletion.text.length-suggestInlineCompletion.text.length:0;return this.toGhostText(finalCompletion,inlineCompletionPreviewLength)}toGhostText(completion,inlineCompletionPreviewLength){const mode=this.editor.getOptions().get(106).previewMode;return completion?(0,inlineCompletionToGhostText_1.inlineCompletionToGhostText)(completion,this.editor.getModel(),mode,this.editor.getPosition(),inlineCompletionPreviewLength)||new ghostText_1.GhostText(completion.range.endLineNumber,[],this.minReservedLineCount):void 0}};SuggestWidgetPreviewModel=__decorate([__param(2,languageFeatures_1.ILanguageFeaturesService)],SuggestWidgetPreviewModel),exports.SuggestWidgetPreviewModel=SuggestWidgetPreviewModel})),define(__m[750],__M([1,0,4,2,11,27,208,749,468,9]),(function(require,exports,event_1,lifecycle_1,position_1,languages_1,inlineCompletionsModel_1,suggestWidgetPreviewModel_1,utils_1,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SharedInlineCompletionCache=exports.GhostTextModel=exports.DelegatingModel=void 0;class DelegatingModel extends lifecycle_1.Disposable{constructor(){super(...arguments),this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new lifecycle_1.MutableDisposable)}get targetModel(){var _a;return null===(_a=this.currentModelRef.value)||void 0===_a?void 0:_a.object}setTargetModel(model){var _a;(null===(_a=this.currentModelRef.value)||void 0===_a?void 0:_a.object)!==model&&(this.currentModelRef.clear(),this.currentModelRef.value=model?(0,utils_1.createDisposableRef)(model,model.onDidChange((()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()}))):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}get ghostText(){var _a,_b;return this.hasCachedGhostText||(this.cachedGhostText=null===(_b=null===(_a=this.currentModelRef.value)||void 0===_a?void 0:_a.object)||void 0===_b?void 0:_b.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}setExpanded(expanded){var _a;null===(_a=this.targetModel)||void 0===_a||_a.setExpanded(expanded)}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}}exports.DelegatingModel=DelegatingModel;let GhostTextModel=class GhostTextModel extends DelegatingModel{constructor(editor,instantiationService){super(),this.editor=editor,this.instantiationService=instantiationService,this.sharedCache=this._register(new SharedInlineCompletionCache),this.suggestWidgetAdapterModel=this._register(this.instantiationService.createInstance(suggestWidgetPreviewModel_1.SuggestWidgetPreviewModel,this.editor,this.sharedCache)),this.inlineCompletionsModel=this._register(this.instantiationService.createInstance(inlineCompletionsModel_1.InlineCompletionsModel,this.editor,this.sharedCache)),this._register(this.suggestWidgetAdapterModel.onDidChange((()=>{this.updateModel()}))),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(hoverRange){var _a;const ghostText=null===(_a=this.activeInlineCompletionsModel)||void 0===_a?void 0:_a.ghostText;return!!ghostText&&ghostText.parts.some((p=>hoverRange.containsPosition(new position_1.Position(ghostText.lineNumber,p.column))))}triggerInlineCompletion(){var _a;null===(_a=this.activeInlineCompletionsModel)||void 0===_a||_a.trigger(languages_1.InlineCompletionTriggerKind.Explicit)}commitInlineCompletion(){var _a;null===(_a=this.activeInlineCompletionsModel)||void 0===_a||_a.commitCurrentSuggestion()}hideInlineCompletion(){var _a;null===(_a=this.activeInlineCompletionsModel)||void 0===_a||_a.hide()}showNextInlineCompletion(){var _a;null===(_a=this.activeInlineCompletionsModel)||void 0===_a||_a.showNext()}showPreviousInlineCompletion(){var _a;null===(_a=this.activeInlineCompletionsModel)||void 0===_a||_a.showPrevious()}hasMultipleInlineCompletions(){var _a;return __awaiter(this,void 0,void 0,(function*(){const result=yield null===(_a=this.activeInlineCompletionsModel)||void 0===_a?void 0:_a.hasMultipleInlineCompletions();return void 0!==result&&result}))}};GhostTextModel=__decorate([__param(1,instantiation_1.IInstantiationService)],GhostTextModel),exports.GhostTextModel=GhostTextModel;class SharedInlineCompletionCache extends lifecycle_1.Disposable{constructor(){super(...arguments),this.onDidChangeEmitter=new event_1.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.cache=this._register(new lifecycle_1.MutableDisposable)}get value(){return this.cache.value}setValue(editor,completionsSource,triggerKind){this.cache.value=new inlineCompletionsModel_1.SynchronizedInlineCompletionsCache(editor,completionsSource,(()=>this.onDidChangeEmitter.fire()),triggerKind)}clearAndLeak(){return this.cache.clearAndLeak()}clear(){this.cache.clear()}}exports.SharedInlineCompletionCache=SharedInlineCompletionCache})),define(__m[308],__M([1,0,4,2,8,15,70,24,263,750,663,558,17,9,89]),(function(require,exports,event_1,lifecycle_1,strings_1,editorExtensions_1,cursorColumns_1,editorContextKeys_1,consts_1,ghostTextModel_1,ghostTextWidget_1,nls,contextkey_1,instantiation_1,keybindingsRegistry_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TriggerInlineSuggestionAction=exports.ShowPreviousInlineSuggestionAction=exports.ShowNextInlineSuggestionAction=exports.commitInlineSuggestionAction=exports.ActiveGhostTextController=exports.GhostTextController=void 0;let GhostTextController=class GhostTextController extends lifecycle_1.Disposable{constructor(editor,instantiationService){super(),this.editor=editor,this.instantiationService=instantiationService,this.triggeredExplicitly=!1,this.activeController=this._register(new lifecycle_1.MutableDisposable),this.activeModelDidChangeEmitter=this._register(new event_1.Emitter),this._register(this.editor.onDidChangeModel((()=>{this.updateModelController()}))),this._register(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(106)&&this.updateModelController(),e.hasChanged(55)&&this.updateModelController()}))),this.updateModelController()}static get(editor){return editor.getContribution(GhostTextController.ID)}get activeModel(){var _a;return null===(_a=this.activeController.value)||void 0===_a?void 0:_a.model}updateModelController(){const suggestOptions=this.editor.getOption(106),inlineSuggestOptions=this.editor.getOption(55);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(suggestOptions.preview||inlineSuggestOptions.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(ActiveGhostTextController,this.editor):void 0,this.activeModelDidChangeEmitter.fire()}shouldShowHoverAt(hoverRange){var _a;return(null===(_a=this.activeModel)||void 0===_a?void 0:_a.shouldShowHoverAt(hoverRange))||!1}shouldShowHoverAtViewZone(viewZoneId){var _a,_b;return(null===(_b=null===(_a=this.activeController.value)||void 0===_a?void 0:_a.widget)||void 0===_b?void 0:_b.shouldShowHoverAtViewZone(viewZoneId))||!1}trigger(){var _a;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),null===(_a=this.activeModel)||void 0===_a||_a.triggerInlineCompletion()}commit(){var _a;null===(_a=this.activeModel)||void 0===_a||_a.commitInlineCompletion()}hide(){var _a;null===(_a=this.activeModel)||void 0===_a||_a.hideInlineCompletion()}showNextInlineCompletion(){var _a;null===(_a=this.activeModel)||void 0===_a||_a.showNextInlineCompletion()}showPreviousInlineCompletion(){var _a;null===(_a=this.activeModel)||void 0===_a||_a.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var _a;return __awaiter(this,void 0,void 0,(function*(){const result=yield null===(_a=this.activeModel)||void 0===_a?void 0:_a.hasMultipleInlineCompletions();return void 0!==result&&result}))}};GhostTextController.inlineSuggestionVisible=new contextkey_1.RawContextKey("inlineSuggestionVisible",!1,nls.localize(0,null)),GhostTextController.inlineSuggestionHasIndentation=new contextkey_1.RawContextKey("inlineSuggestionHasIndentation",!1,nls.localize(1,null)),GhostTextController.inlineSuggestionHasIndentationLessThanTabSize=new contextkey_1.RawContextKey("inlineSuggestionHasIndentationLessThanTabSize",!0,nls.localize(2,null)),GhostTextController.ID="editor.contrib.ghostTextController",GhostTextController=__decorate([__param(1,instantiation_1.IInstantiationService)],GhostTextController),exports.GhostTextController=GhostTextController;class GhostTextContextKeys{constructor(contextKeyService){this.contextKeyService=contextKeyService,this.inlineCompletionVisible=GhostTextController.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=GhostTextController.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=GhostTextController.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)}}let ActiveGhostTextController=class ActiveGhostTextController extends lifecycle_1.Disposable{constructor(editor,instantiationService,contextKeyService){super(),this.editor=editor,this.instantiationService=instantiationService,this.contextKeyService=contextKeyService,this.contextKeys=new GhostTextContextKeys(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(ghostTextModel_1.GhostTextModel,this.editor)),this.widget=this._register(this.instantiationService.createInstance(ghostTextWidget_1.GhostTextWidget,this.editor,this.model)),this._register((0,lifecycle_1.toDisposable)((()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)}))),this._register(this.model.onDidChange((()=>{this.updateContextKeys()}))),this.updateContextKeys()}updateContextKeys(){var _a;this.contextKeys.inlineCompletionVisible.set(void 0!==(null===(_a=this.model.activeInlineCompletionsModel)||void 0===_a?void 0:_a.ghostText));let startsWithIndentation=!1,startsWithIndentationLessThanTabSize=!0;const ghostText=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&ghostText&&ghostText.parts.length>0){const{column,lines}=ghostText.parts[0],firstLine=lines[0];if(column<=this.editor.getModel().getLineIndentColumn(ghostText.lineNumber)){let firstNonWsIdx=(0,strings_1.firstNonWhitespaceIndex)(firstLine);-1===firstNonWsIdx&&(firstNonWsIdx=firstLine.length-1),startsWithIndentation=firstNonWsIdx>0;const tabSize=this.editor.getModel().getOptions().tabSize;startsWithIndentationLessThanTabSize=cursorColumns_1.CursorColumns.visibleColumnFromColumn(firstLine,firstNonWsIdx+1,tabSize)<tabSize}}this.contextKeys.inlineCompletionSuggestsIndentation.set(startsWithIndentation),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(startsWithIndentationLessThanTabSize)}};ActiveGhostTextController=__decorate([__param(1,instantiation_1.IInstantiationService),__param(2,contextkey_1.IContextKeyService)],ActiveGhostTextController),exports.ActiveGhostTextController=ActiveGhostTextController;const GhostTextCommand=editorExtensions_1.EditorCommand.bindToContribution(GhostTextController.get);exports.commitInlineSuggestionAction=new GhostTextCommand({id:consts_1.inlineSuggestCommitId,precondition:GhostTextController.inlineSuggestionVisible,handler(x){x.commit(),x.editor.focus()}}),(0,editorExtensions_1.registerEditorCommand)(exports.commitInlineSuggestionAction),keybindingsRegistry_1.KeybindingsRegistry.registerKeybindingRule({primary:2,weight:200,id:exports.commitInlineSuggestionAction.id,when:contextkey_1.ContextKeyExpr.and(exports.commitInlineSuggestionAction.precondition,editorContextKeys_1.EditorContextKeys.tabMovesFocus.toNegated(),GhostTextController.inlineSuggestionHasIndentationLessThanTabSize)}),(0,editorExtensions_1.registerEditorCommand)(new GhostTextCommand({id:"editor.action.inlineSuggest.hide",precondition:GhostTextController.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler(x){x.hide()}}));class ShowNextInlineSuggestionAction extends editorExtensions_1.EditorAction{constructor(){super({id:ShowNextInlineSuggestionAction.ID,label:nls.localize(3,null),alias:"Show Next Inline Suggestion",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,GhostTextController.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=GhostTextController.get(editor);controller&&(controller.showNextInlineCompletion(),editor.focus())}))}}exports.ShowNextInlineSuggestionAction=ShowNextInlineSuggestionAction,ShowNextInlineSuggestionAction.ID="editor.action.inlineSuggest.showNext";class ShowPreviousInlineSuggestionAction extends editorExtensions_1.EditorAction{constructor(){super({id:ShowPreviousInlineSuggestionAction.ID,label:nls.localize(4,null),alias:"Show Previous Inline Suggestion",precondition:contextkey_1.ContextKeyExpr.and(editorContextKeys_1.EditorContextKeys.writable,GhostTextController.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=GhostTextController.get(editor);controller&&(controller.showPreviousInlineCompletion(),editor.focus())}))}}exports.ShowPreviousInlineSuggestionAction=ShowPreviousInlineSuggestionAction,ShowPreviousInlineSuggestionAction.ID="editor.action.inlineSuggest.showPrevious";class TriggerInlineSuggestionAction extends editorExtensions_1.EditorAction{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:nls.localize(5,null),alias:"Trigger Inline Suggestion",precondition:editorContextKeys_1.EditorContextKeys.writable})}run(accessor,editor){return __awaiter(this,void 0,void 0,(function*(){const controller=GhostTextController.get(editor);controller&&controller.trigger()}))}}exports.TriggerInlineSuggestionAction=TriggerInlineSuggestionAction})),define(__m[751],__M([1,0,7,68,2,106,3,35,86,308,559,65,37,26,17,53]),(function(require,exports,dom,htmlContent_1,lifecycle_1,markdownRenderer_1,range_1,language_1,hoverTypes_1,ghostTextController_1,nls,accessibility_1,actions_1,commands_1,contextkey_1,opener_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InlineCompletionsHoverParticipant=exports.InlineCompletionsHover=void 0;class InlineCompletionsHover{constructor(owner,range,controller){this.owner=owner,this.range=range,this.controller=controller}isValidForHoverAnchor(anchor){return 1===anchor.type&&this.range.startColumn<=anchor.range.startColumn&&this.range.endColumn>=anchor.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}}exports.InlineCompletionsHover=InlineCompletionsHover;let InlineCompletionsHoverParticipant=class InlineCompletionsHoverParticipant{constructor(_editor,_commandService,_menuService,_contextKeyService,_languageService,_openerService,accessibilityService){this._editor=_editor,this._commandService=_commandService,this._menuService=_menuService,this._contextKeyService=_contextKeyService,this._languageService=_languageService,this._openerService=_openerService,this.accessibilityService=accessibilityService,this.hoverOrdinal=3}suggestHoverAnchor(mouseEvent){const controller=ghostTextController_1.GhostTextController.get(this._editor);if(!controller)return null;const target=mouseEvent.target;if(8===target.type){const viewZoneData=target.detail;if(controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId))return new hoverTypes_1.HoverForeignElementAnchor(1e3,this,range_1.Range.fromPositions(viewZoneData.positionBefore||viewZoneData.position,viewZoneData.positionBefore||viewZoneData.position))}if(7===target.type&&controller.shouldShowHoverAt(target.range))return new hoverTypes_1.HoverForeignElementAnchor(1e3,this,target.range);if(6===target.type){if(target.detail.mightBeForeignElement&&controller.shouldShowHoverAt(target.range))return new hoverTypes_1.HoverForeignElementAnchor(1e3,this,target.range)}return null}computeSync(anchor,lineDecorations){const controller=ghostTextController_1.GhostTextController.get(this._editor);return controller&&controller.shouldShowHoverAt(anchor.range)?[new InlineCompletionsHover(this,anchor.range,controller)]:[]}renderHoverParts(context,hoverParts){const disposableStore=new lifecycle_1.DisposableStore,part=hoverParts[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(context,part,disposableStore);const menu=disposableStore.add(this._menuService.createMenu(actions_1.MenuId.InlineCompletionsActions,this._contextKeyService)),previousAction=context.statusBar.addAction({label:nls.localize(0,null),commandId:ghostTextController_1.ShowNextInlineSuggestionAction.ID,run:()=>this._commandService.executeCommand(ghostTextController_1.ShowNextInlineSuggestionAction.ID)}),nextAction=context.statusBar.addAction({label:nls.localize(1,null),commandId:ghostTextController_1.ShowPreviousInlineSuggestionAction.ID,run:()=>this._commandService.executeCommand(ghostTextController_1.ShowPreviousInlineSuggestionAction.ID)});context.statusBar.addAction({label:nls.localize(2,null),commandId:ghostTextController_1.commitInlineSuggestionAction.id,run:()=>this._commandService.executeCommand(ghostTextController_1.commitInlineSuggestionAction.id)});const actions=[previousAction,nextAction];for(const action of actions)action.setEnabled(!1);part.hasMultipleSuggestions().then((hasMore=>{for(const action of actions)action.setEnabled(hasMore)}));for(const[_,group]of menu.getActions())for(const action of group)action instanceof actions_1.MenuItemAction&&context.statusBar.addAction({label:action.label,commandId:action.item.id,run:()=>this._commandService.executeCommand(action.item.id)});return disposableStore}renderScreenReaderText(context,part,disposableStore){var _a,_b;const $=dom.$,markdownHoverElement=$("div.hover-row.markdown-hover"),hoverContentsElement=dom.append(markdownHoverElement,$("div.hover-contents")),renderer=disposableStore.add(new markdownRenderer_1.MarkdownRenderer({editor:this._editor},this._languageService,this._openerService)),ghostText=null===(_b=null===(_a=part.controller.activeModel)||void 0===_a?void 0:_a.inlineCompletionsModel)||void 0===_b?void 0:_b.ghostText;if(ghostText){const lineText=this._editor.getModel().getLineContent(ghostText.lineNumber);(code=>{disposableStore.add(renderer.onDidRenderAsync((()=>{hoverContentsElement.className="hover-contents code-hover-contents",context.onContentsChanged()})));const inlineSuggestionAvailable=nls.localize(3,null),renderedContents=disposableStore.add(renderer.render((new htmlContent_1.MarkdownString).appendText(inlineSuggestionAvailable).appendCodeblock("text",code)));hoverContentsElement.replaceChildren(renderedContents.element)})(ghostText.renderForScreenReader(lineText))}context.fragment.appendChild(markdownHoverElement)}};InlineCompletionsHoverParticipant=__decorate([__param(1,commands_1.ICommandService),__param(2,actions_1.IMenuService),__param(3,contextkey_1.IContextKeyService),__param(4,language_1.ILanguageService),__param(5,opener_1.IOpenerService),__param(6,accessibility_1.IAccessibilityService)],InlineCompletionsHoverParticipant),exports.InlineCompletionsHoverParticipant=InlineCompletionsHoverParticipant})),define(__m[752],__M([1,0,15,86,308,751]),(function(require,exports,editorExtensions_1,hoverTypes_1,ghostTextController_1,inlineCompletionsHoverParticipant_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(0,editorExtensions_1.registerEditorContribution)(ghostTextController_1.GhostTextController.ID,ghostTextController_1.GhostTextController),(0,editorExtensions_1.registerEditorAction)(ghostTextController_1.TriggerInlineSuggestionAction),(0,editorExtensions_1.registerEditorAction)(ghostTextController_1.ShowNextInlineSuggestionAction),(0,editorExtensions_1.registerEditorAction)(ghostTextController_1.ShowPreviousInlineSuggestionAction),hoverTypes_1.HoverParticipantRegistry.register(inlineCompletionsHoverParticipant_1.InlineCompletionsHoverParticipant)})),define(__m[309],__M([1,0,9]),(function(require,exports,instantiation_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IWorkspaceTrustManagementService=void 0,exports.IWorkspaceTrustManagementService=(0,instantiation_1.createDecorator)("workspaceTrustManagementService")})),define(__m[753],__M([1,0,10,28,2,16,8,15,32,38,249,88,35,271,86,207,712,585,41,9,53,80,74,309,391]),(function(require,exports,async_1,codicons_1,lifecycle_1,platform,strings_1,editorExtensions_1,editorOptions_1,textModel_1,unicodeTextModelHighlighter_1,editorWorker_1,language_1,viewModelDecorations_1,hoverTypes_1,markdownHoverParticipant_1,bannerController_1,nls,configuration_1,instantiation_1,opener_1,quickInput_1,iconRegistry_1,workspaceTrust_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShowExcludeOptions=exports.DisableHighlightingOfNonBasicAsciiCharactersAction=exports.DisableHighlightingOfInvisibleCharactersAction=exports.DisableHighlightingOfAmbiguousCharactersAction=exports.DisableHighlightingInStringsAction=exports.DisableHighlightingInCommentsAction=exports.UnicodeHighlighterHoverParticipant=exports.UnicodeHighlighter=exports.warningIcon=void 0,exports.warningIcon=(0,iconRegistry_1.registerIcon)("extensions-warning-message",codicons_1.Codicon.warning,nls.localize(0,null));let UnicodeHighlighter=class UnicodeHighlighter extends lifecycle_1.Disposable{constructor(_editor,_editorWorkerService,_workspaceTrustService,instantiationService){super(),this._editor=_editor,this._editorWorkerService=_editorWorkerService,this._workspaceTrustService=_workspaceTrustService,this._highlighter=null,this._bannerClosed=!1,this._updateState=state=>{if(state&&state.hasMore){if(this._bannerClosed)return;const max=Math.max(state.ambiguousCharacterCount,state.nonBasicAsciiCharacterCount,state.invisibleCharacterCount);let data;if(state.nonBasicAsciiCharacterCount>=max)data={message:nls.localize(1,null),command:new DisableHighlightingOfNonBasicAsciiCharactersAction};else if(state.ambiguousCharacterCount>=max)data={message:nls.localize(2,null),command:new DisableHighlightingOfAmbiguousCharactersAction};else{if(!(state.invisibleCharacterCount>=max))throw new Error("Unreachable");data={message:nls.localize(3,null),command:new DisableHighlightingOfInvisibleCharactersAction}}this._bannerController.show({id:"unicodeHighlightBanner",message:data.message,icon:exports.warningIcon,actions:[{label:data.command.shortLabel,href:`command:${data.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(instantiationService.createInstance(bannerController_1.BannerController,_editor)),this._register(this._editor.onDidChangeModel((()=>{this._bannerClosed=!1,this._updateHighlighter()}))),this._options=_editor.getOption(113),this._register(_workspaceTrustService.onDidChangeTrust((e=>{this._updateHighlighter()}))),this._register(_editor.onDidChangeConfiguration((e=>{e.hasChanged(113)&&(this._options=_editor.getOption(113),this._updateHighlighter())}))),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const options=function resolveOptions(trusted,options){return{nonBasicASCII:options.nonBasicASCII===editorOptions_1.inUntrustedWorkspace?!trusted:options.nonBasicASCII,ambiguousCharacters:options.ambiguousCharacters,invisibleCharacters:options.invisibleCharacters,includeComments:options.includeComments===editorOptions_1.inUntrustedWorkspace?!trusted:options.includeComments,includeStrings:options.includeStrings===editorOptions_1.inUntrustedWorkspace?!trusted:options.includeStrings,allowedCharacters:options.allowedCharacters,allowedLocales:options.allowedLocales}}(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([options.nonBasicASCII,options.ambiguousCharacters,options.invisibleCharacters].every((option=>!1===option)))return;const highlightOptions={nonBasicASCII:options.nonBasicASCII,ambiguousCharacters:options.ambiguousCharacters,invisibleCharacters:options.invisibleCharacters,includeComments:options.includeComments,includeStrings:options.includeStrings,allowedCodePoints:Object.keys(options.allowedCharacters).map((c=>c.codePointAt(0))),allowedLocales:Object.keys(options.allowedLocales).map((locale=>{if("_os"===locale){return(new Intl.NumberFormat).resolvedOptions().locale}return"_vscode"===locale?platform.language:locale}))};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new DocumentUnicodeHighlighter(this._editor,highlightOptions,this._updateState,this._editorWorkerService):this._highlighter=new ViewportUnicodeHighlighter(this._editor,highlightOptions,this._updateState)}getDecorationInfo(decorationId){return this._highlighter?this._highlighter.getDecorationInfo(decorationId):null}};UnicodeHighlighter.ID="editor.contrib.unicodeHighlighter",UnicodeHighlighter=__decorate([__param(1,editorWorker_1.IEditorWorkerService),__param(2,workspaceTrust_1.IWorkspaceTrustManagementService),__param(3,instantiation_1.IInstantiationService)],UnicodeHighlighter),exports.UnicodeHighlighter=UnicodeHighlighter;let DocumentUnicodeHighlighter=class DocumentUnicodeHighlighter extends lifecycle_1.Disposable{constructor(_editor,_options,_updateState,_editorWorkerService){super(),this._editor=_editor,this._options=_options,this._updateState=_updateState,this._editorWorkerService=_editorWorkerService,this._model=this._editor.getModel(),this._decorationIds=new Set,this._updateSoon=this._register(new async_1.RunOnceScheduler((()=>this._update()),250)),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorationIds=new Set(this._model.deltaDecorations(Array.from(this._decorationIds),[])),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void(this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),[])));const modelVersionId=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then((info=>{if(this._model.isDisposed())return;if(this._model.getVersionId()!==modelVersionId)return;this._updateState(info);const decorations=[];if(!info.hasMore)for(const range of info.ranges)decorations.push({range,options:Decorations.instance.getDecorationFromOptions(this._options)});this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),decorations))}))}getDecorationInfo(decorationId){if(!this._decorationIds.has(decorationId))return null;const model=this._editor.getModel(),range=model.getDecorationRange(decorationId),decoration={range,options:Decorations.instance.getDecorationFromOptions(this._options),id:decorationId,ownerId:0};if(!(0,viewModelDecorations_1.isModelDecorationVisible)(model,decoration))return null;return{reason:computeReason(model.getValueInRange(range),this._options),inComment:(0,viewModelDecorations_1.isModelDecorationInComment)(model,decoration),inString:(0,viewModelDecorations_1.isModelDecorationInString)(model,decoration)}}};DocumentUnicodeHighlighter=__decorate([__param(3,editorWorker_1.IEditorWorkerService)],DocumentUnicodeHighlighter);class ViewportUnicodeHighlighter extends lifecycle_1.Disposable{constructor(_editor,_options,_updateState){super(),this._editor=_editor,this._options=_options,this._updateState=_updateState,this._model=this._editor.getModel(),this._decorationIds=new Set,this._updateSoon=this._register(new async_1.RunOnceScheduler((()=>this._update()),250)),this._register(this._editor.onDidLayoutChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidScrollChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeHiddenAreas((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorationIds=new Set(this._model.deltaDecorations(Array.from(this._decorationIds),[])),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void(this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),[])));const ranges=this._editor.getVisibleRanges(),decorations=[],totalResult={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const range of ranges){const result=unicodeTextModelHighlighter_1.UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model,this._options,range);for(const r of result.ranges)totalResult.ranges.push(r);totalResult.ambiguousCharacterCount+=totalResult.ambiguousCharacterCount,totalResult.invisibleCharacterCount+=totalResult.invisibleCharacterCount,totalResult.nonBasicAsciiCharacterCount+=totalResult.nonBasicAsciiCharacterCount,totalResult.hasMore=totalResult.hasMore||result.hasMore}if(!totalResult.hasMore)for(const range of totalResult.ranges)decorations.push({range,options:Decorations.instance.getDecorationFromOptions(this._options)});this._updateState(totalResult),this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),decorations))}getDecorationInfo(decorationId){if(!this._decorationIds.has(decorationId))return null;const model=this._editor.getModel(),range=model.getDecorationRange(decorationId),text=model.getValueInRange(range),decoration={range,options:Decorations.instance.getDecorationFromOptions(this._options),id:decorationId,ownerId:0};return(0,viewModelDecorations_1.isModelDecorationVisible)(model,decoration)?{reason:computeReason(text,this._options),inComment:(0,viewModelDecorations_1.isModelDecorationInComment)(model,decoration),inString:(0,viewModelDecorations_1.isModelDecorationInString)(model,decoration)}:null}}let UnicodeHighlighterHoverParticipant=class UnicodeHighlighterHoverParticipant{constructor(_editor,_languageService,_openerService){this._editor=_editor,this._languageService=_languageService,this._openerService=_openerService,this.hoverOrdinal=4}computeSync(anchor,lineDecorations){if(!this._editor.hasModel()||1!==anchor.type)return[];const model=this._editor.getModel(),unicodeHighlighter=this._editor.getContribution(UnicodeHighlighter.ID);if(!unicodeHighlighter)return[];const result=[];let index=300;for(const d of lineDecorations){const highlightInfo=unicodeHighlighter.getDecorationInfo(d.id);if(!highlightInfo)continue;const codePoint=model.getValueInRange(d.range).codePointAt(0),codePointStr=formatCodePointMarkdown(codePoint);let reason;switch(highlightInfo.reason.kind){case 0:reason=nls.localize(4,null,codePointStr,formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));break;case 1:reason=nls.localize(5,null,codePointStr);break;case 2:reason=nls.localize(6,null,codePointStr)}const adjustSettingsArgs={codePoint,reason:highlightInfo.reason,inComment:highlightInfo.inComment,inString:highlightInfo.inString},contents=[{value:`${reason} [${nls.localize(7,null)}](command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(adjustSettingsArgs))})`,isTrusted:!0}];result.push(new markdownHoverParticipant_1.MarkdownHover(this,d.range,contents,index++))}return result}renderHoverParts(context,hoverParts){return(0,markdownHoverParticipant_1.renderMarkdownHovers)(context,hoverParts,this._editor,this._languageService,this._openerService)}};function codePointToHex(codePoint){return`U+${codePoint.toString(16).padStart(4,"0")}`}function formatCodePointMarkdown(codePoint){let value=`\`${codePointToHex(codePoint)}\``;return strings_1.InvisibleCharacters.isInvisibleCharacter(codePoint)||(value+=` "${function renderCodePointAsInlineCode(codePoint){if(96===codePoint)return"`` ` ``";return"`"+String.fromCodePoint(codePoint)+"`"}(codePoint)}"`),value}function computeReason(char,options){return unicodeTextModelHighlighter_1.UnicodeTextModelHighlighter.computeUnicodeHighlightReason(char,options)}UnicodeHighlighterHoverParticipant=__decorate([__param(1,language_1.ILanguageService),__param(2,opener_1.IOpenerService)],UnicodeHighlighterHoverParticipant),exports.UnicodeHighlighterHoverParticipant=UnicodeHighlighterHoverParticipant;class Decorations{constructor(){this.map=new Map}getDecorationFromOptions(options){return this.getDecoration(!options.includeComments,!options.includeStrings)}getDecoration(hideInComments,hideInStrings){const key=`${hideInComments}${hideInStrings}`;let options=this.map.get(key);return options||(options=textModel_1.ModelDecorationOptions.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:hideInComments,hideInStringTokens:hideInStrings}),this.map.set(key,options)),options}}Decorations.instance=new Decorations;class DisableHighlightingInCommentsAction extends editorExtensions_1.EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:nls.localize(9,null),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=nls.localize(8,null)}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){let configurationService=null==accessor?void 0:accessor.get(configuration_1.IConfigurationService);configurationService&&this.runAction(configurationService)}))}runAction(configurationService){return __awaiter(this,void 0,void 0,(function*(){yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.includeComments,!1,1)}))}}exports.DisableHighlightingInCommentsAction=DisableHighlightingInCommentsAction;class DisableHighlightingInStringsAction extends editorExtensions_1.EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:nls.localize(11,null),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=nls.localize(10,null)}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){let configurationService=null==accessor?void 0:accessor.get(configuration_1.IConfigurationService);configurationService&&this.runAction(configurationService)}))}runAction(configurationService){return __awaiter(this,void 0,void 0,(function*(){yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.includeStrings,!1,1)}))}}exports.DisableHighlightingInStringsAction=DisableHighlightingInStringsAction;class DisableHighlightingOfAmbiguousCharactersAction extends editorExtensions_1.EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:nls.localize(13,null),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=nls.localize(12,null)}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){let configurationService=null==accessor?void 0:accessor.get(configuration_1.IConfigurationService);configurationService&&this.runAction(configurationService)}))}runAction(configurationService){return __awaiter(this,void 0,void 0,(function*(){yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.ambiguousCharacters,!1,1)}))}}exports.DisableHighlightingOfAmbiguousCharactersAction=DisableHighlightingOfAmbiguousCharactersAction,DisableHighlightingOfAmbiguousCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";class DisableHighlightingOfInvisibleCharactersAction extends editorExtensions_1.EditorAction{constructor(){super({id:DisableHighlightingOfInvisibleCharactersAction.ID,label:nls.localize(15,null),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=nls.localize(14,null)}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){let configurationService=null==accessor?void 0:accessor.get(configuration_1.IConfigurationService);configurationService&&this.runAction(configurationService)}))}runAction(configurationService){return __awaiter(this,void 0,void 0,(function*(){yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.invisibleCharacters,!1,1)}))}}exports.DisableHighlightingOfInvisibleCharactersAction=DisableHighlightingOfInvisibleCharactersAction,DisableHighlightingOfInvisibleCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";class DisableHighlightingOfNonBasicAsciiCharactersAction extends editorExtensions_1.EditorAction{constructor(){super({id:DisableHighlightingOfNonBasicAsciiCharactersAction.ID,label:nls.localize(17,null),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=nls.localize(16,null)}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){let configurationService=null==accessor?void 0:accessor.get(configuration_1.IConfigurationService);configurationService&&this.runAction(configurationService)}))}runAction(configurationService){return __awaiter(this,void 0,void 0,(function*(){yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.nonBasicASCII,!1,1)}))}}exports.DisableHighlightingOfNonBasicAsciiCharactersAction=DisableHighlightingOfNonBasicAsciiCharactersAction,DisableHighlightingOfNonBasicAsciiCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";class ShowExcludeOptions extends editorExtensions_1.EditorAction{constructor(){super({id:ShowExcludeOptions.ID,label:nls.localize(18,null),alias:"Show Exclude Options",precondition:void 0})}run(accessor,editor,args){return __awaiter(this,void 0,void 0,(function*(){const{codePoint,reason,inString,inComment}=args,char=String.fromCodePoint(codePoint),quickPickService=accessor.get(quickInput_1.IQuickInputService),configurationService=accessor.get(configuration_1.IConfigurationService);const options=[];if(0===reason.kind)for(const locale of reason.notAmbiguousInLocales)options.push({label:nls.localize(21,null,locale),run:()=>__awaiter(this,void 0,void 0,(function*(){excludeLocaleFromBeingHighlighted(configurationService,[locale])}))});if(options.push({label:function getExcludeCharFromBeingHighlightedLabel(codePoint){return strings_1.InvisibleCharacters.isInvisibleCharacter(codePoint)?nls.localize(19,null,codePointToHex(codePoint)):nls.localize(20,null,`${codePointToHex(codePoint)} "${char}"`)}(codePoint),run:()=>function excludeCharFromBeingHighlighted(configurationService,charCodes){return __awaiter(this,void 0,void 0,(function*(){const existingValue=configurationService.getValue(editorOptions_1.unicodeHighlightConfigKeys.allowedCharacters);let value;value="object"==typeof existingValue&&existingValue?existingValue:{};for(const charCode of charCodes)value[String.fromCodePoint(charCode)]=!0;yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.allowedCharacters,value,1)}))}(configurationService,[codePoint])}),inComment){const action=new DisableHighlightingInCommentsAction;options.push({label:action.label,run:()=>__awaiter(this,void 0,void 0,(function*(){return action.runAction(configurationService)}))})}else if(inString){const action=new DisableHighlightingInStringsAction;options.push({label:action.label,run:()=>__awaiter(this,void 0,void 0,(function*(){return action.runAction(configurationService)}))})}if(0===reason.kind){const action=new DisableHighlightingOfAmbiguousCharactersAction;options.push({label:action.label,run:()=>__awaiter(this,void 0,void 0,(function*(){return action.runAction(configurationService)}))})}else if(1===reason.kind){const action=new DisableHighlightingOfInvisibleCharactersAction;options.push({label:action.label,run:()=>__awaiter(this,void 0,void 0,(function*(){return action.runAction(configurationService)}))})}else if(2===reason.kind){const action=new DisableHighlightingOfNonBasicAsciiCharactersAction;options.push({label:action.label,run:()=>__awaiter(this,void 0,void 0,(function*(){return action.runAction(configurationService)}))})}else!function expectNever(value){throw new Error(`Unexpected value: ${value}`)}(reason);const result=yield quickPickService.pick(options,{title:nls.localize(22,null)});result&&(yield result.run())}))}}function excludeLocaleFromBeingHighlighted(configurationService,locales){var _a;return __awaiter(this,void 0,void 0,(function*(){const existingValue=null===(_a=configurationService.inspect(editorOptions_1.unicodeHighlightConfigKeys.allowedLocales).user)||void 0===_a?void 0:_a.value;let value;value="object"==typeof existingValue&&existingValue?Object.assign({},existingValue):{};for(const locale of locales)value[locale]=!0;yield configurationService.updateValue(editorOptions_1.unicodeHighlightConfigKeys.allowedLocales,value,1)}))}exports.ShowExcludeOptions=ShowExcludeOptions,ShowExcludeOptions.ID="editor.action.unicodeHighlight.showExcludeOptions",(0,editorExtensions_1.registerEditorAction)(DisableHighlightingOfAmbiguousCharactersAction),(0,editorExtensions_1.registerEditorAction)(DisableHighlightingOfInvisibleCharactersAction),(0,editorExtensions_1.registerEditorAction)(DisableHighlightingOfNonBasicAsciiCharactersAction),(0,editorExtensions_1.registerEditorAction)(ShowExcludeOptions),(0,editorExtensions_1.registerEditorContribution)(UnicodeHighlighter.ID,UnicodeHighlighter),hoverTypes_1.HoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant)})),define(__m[754],__M([1,0,158,163,298,238,671,717,672,673,674,688,719,740,675,676,677,721,300,727,681,682,624,752,210,303,301,304,684,743,729,685,686,730,731,732,710,689,690,212,307,691,295,753,692,734,735,296,693,72,143]),(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0})})),define(__m[213],__M([1,0,8,7,44,4,96,2,16,76,25,200,630,63,11,3,48,56,156,26,41,635,17,130,9,618,43,620,89,279,621,131,39,73,90,211,132,72,29,66,309,78,622,633,703,14,52,628,88,281,35,659,201,297,706,714,103,615,65,37,702,625,104,616,199,617,157,161,79,627,53,80,82,33,290,280,745,67,607]),(function(require,exports,strings,dom,keyboardEvent_1,event_1,keybindings_1,lifecycle_1,platform_1,severity_1,uri_1,bulkEditService_1,editorConfigurationSchema_1,editOperation_1,position_1,range_1,model_1,resolverService_1,textResourceConfiguration_1,commands_1,configuration_1,configurationModels_1,contextkey_1,dialogs_1,instantiation_1,abstractKeybindingService_1,keybinding_1,keybindingResolver_1,keybindingsRegistry_1,resolvedKeybindingItem_1,usLayoutResolvedKeybinding_1,label_1,notification_1,progress_1,telemetry_1,workspace_1,layoutService_1,standaloneStrings_1,codeEditorService_1,log_1,workspaceTrust_1,contextView_1,contextViewService_1,languageService_1,contextMenuService_1,themeService_1,extensions_1,openerService_1,editorWorker_1,editorWorkerService_1,language_1,markerDecorationsService_1,markerDecorations_1,modelService_1,standaloneQuickInputService_1,standaloneThemeService_1,standaloneTheme_1,accessibilityService_1,accessibility_1,actions_1,menuService_1,clipboardService_1,clipboardService_2,contextKeyService_1,descriptors_1,instantiationService_1,serviceCollection_1,listService_1,markers_1,markerService_1,opener_1,quickInput_1,storage_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandaloneServices=exports.updateConfigurationService=exports.StandaloneConfigurationService=exports.StandaloneKeybindingService=exports.StandaloneCommandService=exports.StandaloneNotificationService=void 0;class SimpleModel{constructor(model){this.disposed=!1,this.model=model,this._onWillDispose=new event_1.Emitter}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let StandaloneTextModelService=class StandaloneTextModelService{constructor(modelService){this.modelService=modelService}createModelReference(resource){const model=this.modelService.getModel(resource);return model?Promise.resolve(new lifecycle_1.ImmortalReference(new SimpleModel(model))):Promise.reject(new Error("Model not found"))}};StandaloneTextModelService=__decorate([__param(0,model_1.IModelService)],StandaloneTextModelService);class StandaloneEditorProgressService{show(){return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER}showWhile(promise,delay){return __awaiter(this,void 0,void 0,(function*(){yield promise}))}}StandaloneEditorProgressService.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class StandaloneNotificationService{info(message){return this.notify({severity:severity_1.default.Info,message})}warn(message){return this.notify({severity:severity_1.default.Warning,message})}error(error){return this.notify({severity:severity_1.default.Error,message:error})}notify(notification){switch(notification.severity){case severity_1.default.Error:console.error(notification.message);break;case severity_1.default.Warning:console.warn(notification.message);break;default:console.log(notification.message)}return StandaloneNotificationService.NO_OP}status(message,options){return lifecycle_1.Disposable.None}}exports.StandaloneNotificationService=StandaloneNotificationService,StandaloneNotificationService.NO_OP=new notification_1.NoOpNotification;let StandaloneCommandService=class StandaloneCommandService{constructor(instantiationService){this._onWillExecuteCommand=new event_1.Emitter,this._onDidExecuteCommand=new event_1.Emitter,this.onWillExecuteCommand=this._onWillExecuteCommand.event,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=instantiationService}executeCommand(id,...args){const command=commands_1.CommandsRegistry.getCommand(id);if(!command)return Promise.reject(new Error(`command '${id}' not found`));try{this._onWillExecuteCommand.fire({commandId:id,args});const result=this._instantiationService.invokeFunction.apply(this._instantiationService,[command.handler,...args]);return this._onDidExecuteCommand.fire({commandId:id,args}),Promise.resolve(result)}catch(err){return Promise.reject(err)}}};StandaloneCommandService=__decorate([__param(0,instantiation_1.IInstantiationService)],StandaloneCommandService),exports.StandaloneCommandService=StandaloneCommandService;let StandaloneKeybindingService=class StandaloneKeybindingService extends abstractKeybindingService_1.AbstractKeybindingService{constructor(contextKeyService,commandService,telemetryService,notificationService,logService,codeEditorService){super(contextKeyService,commandService,telemetryService,notificationService,logService),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const addContainer=domNode=>{const disposables=new lifecycle_1.DisposableStore;disposables.add(dom.addDisposableListener(domNode,dom.EventType.KEY_DOWN,(e=>{const keyEvent=new keyboardEvent_1.StandardKeyboardEvent(e);this._dispatch(keyEvent,keyEvent.target)&&(keyEvent.preventDefault(),keyEvent.stopPropagation())}))),disposables.add(dom.addDisposableListener(domNode,dom.EventType.KEY_UP,(e=>{const keyEvent=new keyboardEvent_1.StandardKeyboardEvent(e);this._singleModifierDispatch(keyEvent,keyEvent.target)&&keyEvent.preventDefault()}))),this._domNodeListeners.push(new DomNodeListeners(domNode,disposables))},removeContainer=domNode=>{for(let i=0;i<this._domNodeListeners.length;i++){const domNodeListeners=this._domNodeListeners[i];domNodeListeners.domNode===domNode&&(this._domNodeListeners.splice(i,1),domNodeListeners.dispose())}},addCodeEditor=codeEditor=>{codeEditor.getOption(54)||addContainer(codeEditor.getContainerDomNode())};this._register(codeEditorService.onCodeEditorAdd(addCodeEditor)),this._register(codeEditorService.onCodeEditorRemove((codeEditor=>{codeEditor.getOption(54)||removeContainer(codeEditor.getContainerDomNode())}))),codeEditorService.listCodeEditors().forEach(addCodeEditor);const addDiffEditor=diffEditor=>{addContainer(diffEditor.getContainerDomNode())};this._register(codeEditorService.onDiffEditorAdd(addDiffEditor)),this._register(codeEditorService.onDiffEditorRemove((diffEditor=>{removeContainer(diffEditor.getContainerDomNode())}))),codeEditorService.listDiffEditors().forEach(addDiffEditor)}addDynamicKeybinding(commandId,_keybinding,handler,when){const keybinding=(0,keybindings_1.createKeybinding)(_keybinding,platform_1.OS),toDispose=new lifecycle_1.DisposableStore;return keybinding&&(this._dynamicKeybindings.push({keybinding:keybinding.parts,command:commandId,when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}),toDispose.add((0,lifecycle_1.toDisposable)((()=>{for(let i=0;i<this._dynamicKeybindings.length;i++){if(this._dynamicKeybindings[i].command===commandId)return this._dynamicKeybindings.splice(i,1),void this.updateResolver({source:1})}})))),toDispose.add(commands_1.CommandsRegistry.registerCommand(commandId,handler)),this.updateResolver({source:1}),toDispose}updateResolver(event){this._cachedResolver=null,this._onDidUpdateKeybindings.fire(event)}_getResolver(){if(!this._cachedResolver){const defaults=this._toNormalizedKeybindingItems(keybindingsRegistry_1.KeybindingsRegistry.getDefaultKeybindings(),!0),overrides=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new keybindingResolver_1.KeybindingResolver(defaults,overrides,(str=>this._log(str)))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(items,isDefault){const result=[];let resultLen=0;for(const item of items){const when=item.when||void 0,keybinding=item.keybinding;if(keybinding){const resolvedKeybindings=usLayoutResolvedKeybinding_1.USLayoutResolvedKeybinding.resolveUserBinding(keybinding,platform_1.OS);for(const resolvedKeybinding of resolvedKeybindings)result[resultLen++]=new resolvedKeybindingItem_1.ResolvedKeybindingItem(resolvedKeybinding,item.command,item.commandArgs,when,isDefault,null,!1)}else result[resultLen++]=new resolvedKeybindingItem_1.ResolvedKeybindingItem(void 0,item.command,item.commandArgs,when,isDefault,null,!1)}return result}resolveKeyboardEvent(keyboardEvent){const keybinding=new keybindings_1.SimpleKeybinding(keyboardEvent.ctrlKey,keyboardEvent.shiftKey,keyboardEvent.altKey,keyboardEvent.metaKey,keyboardEvent.keyCode).toChord();return new usLayoutResolvedKeybinding_1.USLayoutResolvedKeybinding(keybinding,platform_1.OS)}};StandaloneKeybindingService=__decorate([__param(0,contextkey_1.IContextKeyService),__param(1,commands_1.ICommandService),__param(2,telemetry_1.ITelemetryService),__param(3,notification_1.INotificationService),__param(4,log_1.ILogService),__param(5,codeEditorService_1.ICodeEditorService)],StandaloneKeybindingService),exports.StandaloneKeybindingService=StandaloneKeybindingService;class DomNodeListeners extends lifecycle_1.Disposable{constructor(domNode,disposables){super(),this.domNode=domNode,this._register(disposables)}}function isConfigurationOverrides(thing){return thing&&"object"==typeof thing&&(!thing.overrideIdentifier||"string"==typeof thing.overrideIdentifier)&&(!thing.resource||thing.resource instanceof uri_1.URI)}class StandaloneConfigurationService{constructor(){this._onDidChangeConfiguration=new event_1.Emitter,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new configurationModels_1.Configuration(new configurationModels_1.DefaultConfigurationModel,new configurationModels_1.ConfigurationModel)}getValue(arg1,arg2){const section="string"==typeof arg1?arg1:void 0,overrides=isConfigurationOverrides(arg1)?arg1:isConfigurationOverrides(arg2)?arg2:{};return this._configuration.getValue(section,overrides,void 0)}updateValues(values){const previous={data:this._configuration.toData()},changedKeys=[];for(const entry of values){const[key,value]=entry;this.getValue(key)!==value&&(this._configuration.updateValue(key,value),changedKeys.push(key))}if(changedKeys.length>0){const configurationChangeEvent=new configurationModels_1.ConfigurationChangeEvent({keys:changedKeys,overrides:[]},previous,this._configuration);configurationChangeEvent.source=7,configurationChangeEvent.sourceConfig=null,this._onDidChangeConfiguration.fire(configurationChangeEvent)}return Promise.resolve()}updateValue(key,value,arg3,arg4){return this.updateValues([[key,value]])}inspect(key,options={}){return this._configuration.inspect(key,options,void 0)}}exports.StandaloneConfigurationService=StandaloneConfigurationService;let StandaloneResourceConfigurationService=class StandaloneResourceConfigurationService{constructor(configurationService){this.configurationService=configurationService,this._onDidChangeConfiguration=new event_1.Emitter,this.configurationService.onDidChangeConfiguration((e=>{this._onDidChangeConfiguration.fire({affectedKeys:e.affectedKeys,affectsConfiguration:(resource,configuration)=>e.affectsConfiguration(configuration)})}))}getValue(resource,arg2,arg3){const section=(position_1.Position.isIPosition(arg2)?arg2:null)?"string"==typeof arg3?arg3:void 0:"string"==typeof arg2?arg2:void 0;return void 0===section?this.configurationService.getValue():this.configurationService.getValue(section)}};StandaloneResourceConfigurationService=__decorate([__param(0,configuration_1.IConfigurationService)],StandaloneResourceConfigurationService);let StandaloneResourcePropertiesService=class StandaloneResourcePropertiesService{constructor(configurationService){this.configurationService=configurationService}getEOL(resource,language){const eol=this.configurationService.getValue("files.eol",{overrideIdentifier:language,resource});return eol&&"string"==typeof eol&&"auto"!==eol?eol:platform_1.isLinux||platform_1.isMacintosh?"\n":"\r\n"}};StandaloneResourcePropertiesService=__decorate([__param(0,configuration_1.IConfigurationService)],StandaloneResourcePropertiesService);class StandaloneWorkspaceContextService{constructor(){const resource=uri_1.URI.from({scheme:StandaloneWorkspaceContextService.SCHEME,authority:"model",path:"/"});this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new workspace_1.WorkspaceFolder({uri:resource,name:"",index:0})]}}getWorkspace(){return this.workspace}}StandaloneWorkspaceContextService.SCHEME="inmemory",exports.updateConfigurationService=function updateConfigurationService(configurationService,source,isDiffEditor){if(!source)return;if(!(configurationService instanceof StandaloneConfigurationService))return;const toUpdate=[];Object.keys(source).forEach((key=>{(0,editorConfigurationSchema_1.isEditorConfigurationKey)(key)&&toUpdate.push([`editor.${key}`,source[key]]),isDiffEditor&&(0,editorConfigurationSchema_1.isDiffEditorConfigurationKey)(key)&&toUpdate.push([`diffEditor.${key}`,source[key]])})),toUpdate.length>0&&configurationService.updateValues(toUpdate)};let StandaloneBulkEditService=class StandaloneBulkEditService{constructor(_modelService){this._modelService=_modelService}hasPreviewHandler(){return!1}apply(edits,_options){return __awaiter(this,void 0,void 0,(function*(){const textEdits=new Map;for(let edit of edits){if(!(edit instanceof bulkEditService_1.ResourceTextEdit))throw new Error("bad edit - only text edits are supported");const model=this._modelService.getModel(edit.resource);if(!model)throw new Error("bad edit - model not found");if("number"==typeof edit.versionId&&model.getVersionId()!==edit.versionId)throw new Error("bad state - model changed in the meantime");let array=textEdits.get(model);array||(array=[],textEdits.set(model,array)),array.push(editOperation_1.EditOperation.replaceMove(range_1.Range.lift(edit.textEdit.range),edit.textEdit.text))}let totalEdits=0,totalFiles=0;for(const[model,edits]of textEdits)model.pushStackElement(),model.pushEditOperations([],edits,(()=>[])),model.pushStackElement(),totalFiles+=1,totalEdits+=edits.length;return{ariaSummary:strings.format(standaloneStrings_1.StandaloneServicesNLS.bulkEditServiceSummary,totalEdits,totalFiles)}}))}};StandaloneBulkEditService=__decorate([__param(0,model_1.IModelService)],StandaloneBulkEditService);let StandaloneContextViewService=class StandaloneContextViewService extends contextViewService_1.ContextViewService{constructor(layoutService,_codeEditorService){super(layoutService),this._codeEditorService=_codeEditorService}showContextView(delegate,container,shadowRoot){if(!container){const codeEditor=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();codeEditor&&(container=codeEditor.getContainerDomNode())}return super.showContextView(delegate,container,shadowRoot)}};StandaloneContextViewService=__decorate([__param(0,layoutService_1.ILayoutService),__param(1,codeEditorService_1.ICodeEditorService)],StandaloneContextViewService);class StandaloneLanguageService extends languageService_1.LanguageService{constructor(){super()}}class StandaloneLogService extends log_1.LogService{constructor(){super(new log_1.ConsoleLogger)}}let StandaloneContextMenuService=class StandaloneContextMenuService extends contextMenuService_1.ContextMenuService{constructor(telemetryService,notificationService,contextViewService,keybindingService,themeService){super(telemetryService,notificationService,contextViewService,keybindingService,themeService),this.configure({blockMouse:!1})}};StandaloneContextMenuService=__decorate([__param(0,telemetry_1.ITelemetryService),__param(1,notification_1.INotificationService),__param(2,contextView_1.IContextViewService),__param(3,keybinding_1.IKeybindingService),__param(4,themeService_1.IThemeService)],StandaloneContextMenuService),(0,extensions_1.registerSingleton)(configuration_1.IConfigurationService,StandaloneConfigurationService),(0,extensions_1.registerSingleton)(textResourceConfiguration_1.ITextResourceConfigurationService,StandaloneResourceConfigurationService),(0,extensions_1.registerSingleton)(textResourceConfiguration_1.ITextResourcePropertiesService,StandaloneResourcePropertiesService),(0,extensions_1.registerSingleton)(workspace_1.IWorkspaceContextService,StandaloneWorkspaceContextService),(0,extensions_1.registerSingleton)(label_1.ILabelService,class StandaloneUriLabelService{getUriLabel(resource,options){return"file"===resource.scheme?resource.fsPath:resource.path}}),(0,extensions_1.registerSingleton)(telemetry_1.ITelemetryService,class StandaloneTelemetryService{publicLog(eventName,data){return Promise.resolve(void 0)}publicLog2(eventName,data){return this.publicLog(eventName,data)}}),(0,extensions_1.registerSingleton)(dialogs_1.IDialogService,class StandaloneDialogService{confirm(confirmation){return this.doConfirm(confirmation).then((confirmed=>({confirmed,checkboxChecked:!1})))}doConfirm(confirmation){let messageText=confirmation.message;return confirmation.detail&&(messageText=messageText+"\n\n"+confirmation.detail),Promise.resolve(window.confirm(messageText))}show(severity,message,buttons,options){return Promise.resolve({choice:0})}}),(0,extensions_1.registerSingleton)(notification_1.INotificationService,StandaloneNotificationService),(0,extensions_1.registerSingleton)(markers_1.IMarkerService,markerService_1.MarkerService),(0,extensions_1.registerSingleton)(language_1.ILanguageService,StandaloneLanguageService),(0,extensions_1.registerSingleton)(standaloneTheme_1.IStandaloneThemeService,standaloneThemeService_1.StandaloneThemeService),(0,extensions_1.registerSingleton)(log_1.ILogService,StandaloneLogService),(0,extensions_1.registerSingleton)(model_1.IModelService,modelService_1.ModelService),(0,extensions_1.registerSingleton)(markerDecorations_1.IMarkerDecorationsService,markerDecorationsService_1.MarkerDecorationsService),(0,extensions_1.registerSingleton)(contextkey_1.IContextKeyService,contextKeyService_1.ContextKeyService),(0,extensions_1.registerSingleton)(progress_1.IEditorProgressService,StandaloneEditorProgressService),(0,extensions_1.registerSingleton)(storage_1.IStorageService,storage_1.InMemoryStorageService),(0,extensions_1.registerSingleton)(editorWorker_1.IEditorWorkerService,editorWorkerService_1.EditorWorkerService),(0,extensions_1.registerSingleton)(bulkEditService_1.IBulkEditService,StandaloneBulkEditService),(0,extensions_1.registerSingleton)(workspaceTrust_1.IWorkspaceTrustManagementService,class StandaloneWorkspaceTrustManagementService{constructor(){this._neverEmitter=new event_1.Emitter,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}),(0,extensions_1.registerSingleton)(resolverService_1.ITextModelService,StandaloneTextModelService),(0,extensions_1.registerSingleton)(accessibility_1.IAccessibilityService,accessibilityService_1.AccessibilityService),(0,extensions_1.registerSingleton)(listService_1.IListService,listService_1.ListService),(0,extensions_1.registerSingleton)(commands_1.ICommandService,StandaloneCommandService),(0,extensions_1.registerSingleton)(keybinding_1.IKeybindingService,StandaloneKeybindingService),(0,extensions_1.registerSingleton)(quickInput_1.IQuickInputService,standaloneQuickInputService_1.StandaloneQuickInputService),(0,extensions_1.registerSingleton)(contextView_1.IContextViewService,StandaloneContextViewService),(0,extensions_1.registerSingleton)(opener_1.IOpenerService,openerService_1.OpenerService),(0,extensions_1.registerSingleton)(clipboardService_2.IClipboardService,clipboardService_1.BrowserClipboardService),(0,extensions_1.registerSingleton)(contextView_1.IContextMenuService,StandaloneContextMenuService),(0,extensions_1.registerSingleton)(actions_1.IMenuService,menuService_1.MenuService),function(StandaloneServices){const serviceCollection=new serviceCollection_1.ServiceCollection;for(const[id,descriptor]of(0,extensions_1.getSingletonServiceDescriptors)())serviceCollection.set(id,descriptor);const instantiationService=new instantiationService_1.InstantiationService(serviceCollection,!0);serviceCollection.set(instantiation_1.IInstantiationService,instantiationService),StandaloneServices.get=function get(serviceId){const r=serviceCollection.get(serviceId);if(!r)throw new Error("Missing service "+serviceId);return r instanceof descriptors_1.SyncDescriptor?instantiationService.invokeFunction((accessor=>accessor.get(serviceId))):r};let initialized=!1;StandaloneServices.initialize=function initialize(overrides){if(initialized)return instantiationService;initialized=!0;for(const[id,descriptor]of(0,extensions_1.getSingletonServiceDescriptors)())serviceCollection.get(id)||serviceCollection.set(id,descriptor);for(const serviceId in overrides)if(overrides.hasOwnProperty(serviceId)){const serviceIdentifier=(0,instantiation_1.createDecorator)(serviceId);serviceCollection.get(serviceIdentifier)instanceof descriptors_1.SyncDescriptor&&serviceCollection.set(serviceIdentifier,overrides[serviceId])}return instantiationService}}(exports.StandaloneServices||(exports.StandaloneServices={}))})),define(__m[755],__M([1,0,46,2,29,163,298,242,88,213,103,37,26,41,17,78,9,43,39,14,65,72,104,73,48,35,290,81,33,20]),(function(require,exports,aria,lifecycle_1,codeEditorService_1,codeEditorWidget_1,diffEditorWidget_1,editorAction_1,editorWorker_1,standaloneServices_1,standaloneTheme_1,actions_1,commands_1,configuration_1,contextkey_1,contextView_1,instantiation_1,keybinding_1,notification_1,themeService_1,accessibility_1,standaloneStrings_1,clipboardService_1,progress_1,model_1,language_1,standaloneCodeEditorService_1,modesRegistry_1,languageConfigurationRegistry_1,languageFeatures_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createTextModel=exports.StandaloneDiffEditor=exports.StandaloneEditor=exports.StandaloneCodeEditor=void 0;let LAST_GENERATED_COMMAND_ID=0,ariaDomNodeCreated=!1;let StandaloneCodeEditor=class StandaloneCodeEditor extends codeEditorWidget_1.CodeEditorWidget{constructor(domElement,_options,instantiationService,codeEditorService,commandService,contextKeyService,keybindingService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService){const options=Object.assign({},_options);options.ariaLabel=options.ariaLabel||standaloneStrings_1.StandaloneCodeEditorNLS.editorViewAccessibleLabel,options.ariaLabel=options.ariaLabel+";"+standaloneStrings_1.StandaloneCodeEditorNLS.accessibilityHelpMessage,super(domElement,options,{},instantiationService,codeEditorService,commandService,contextKeyService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService),keybindingService instanceof standaloneServices_1.StandaloneKeybindingService?this._standaloneKeybindingService=keybindingService:this._standaloneKeybindingService=null,function createAriaDomNode(parent){if(!parent){if(ariaDomNodeCreated)return;ariaDomNodeCreated=!0}aria.setARIAContainer(parent||document.body)}(options.ariaContainerElement)}addCommand(keybinding,handler,context){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const commandId="DYNAMIC_"+ ++LAST_GENERATED_COMMAND_ID,whenExpression=contextkey_1.ContextKeyExpr.deserialize(context);return this._standaloneKeybindingService.addDynamicKeybinding(commandId,keybinding,handler,whenExpression),commandId}createContextKey(key,defaultValue){return this._contextKeyService.createKey(key,defaultValue)}addAction(_descriptor){if("string"!=typeof _descriptor.id||"string"!=typeof _descriptor.label||"function"!=typeof _descriptor.run)throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),lifecycle_1.Disposable.None;const id=_descriptor.id,label=_descriptor.label,precondition=contextkey_1.ContextKeyExpr.and(contextkey_1.ContextKeyExpr.equals("editorId",this.getId()),contextkey_1.ContextKeyExpr.deserialize(_descriptor.precondition)),keybindings=_descriptor.keybindings,keybindingsWhen=contextkey_1.ContextKeyExpr.and(precondition,contextkey_1.ContextKeyExpr.deserialize(_descriptor.keybindingContext)),contextMenuGroupId=_descriptor.contextMenuGroupId||null,contextMenuOrder=_descriptor.contextMenuOrder||0,run=(accessor,...args)=>Promise.resolve(_descriptor.run(this,...args)),toDispose=new lifecycle_1.DisposableStore,uniqueId=this.getId()+":"+id;if(toDispose.add(commands_1.CommandsRegistry.registerCommand(uniqueId,run)),contextMenuGroupId){const menuItem={command:{id:uniqueId,title:label},when:precondition,group:contextMenuGroupId,order:contextMenuOrder};toDispose.add(actions_1.MenuRegistry.appendMenuItem(actions_1.MenuId.EditorContext,menuItem))}if(Array.isArray(keybindings))for(const kb of keybindings)toDispose.add(this._standaloneKeybindingService.addDynamicKeybinding(uniqueId,kb,run,keybindingsWhen));const internalAction=new editorAction_1.InternalEditorAction(uniqueId,label,label,precondition,run,this._contextKeyService);return this._actions[id]=internalAction,toDispose.add((0,lifecycle_1.toDisposable)((()=>{delete this._actions[id]}))),toDispose}_triggerCommand(handlerId,payload){if(this._codeEditorService instanceof standaloneCodeEditorService_1.StandaloneCodeEditorService)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(handlerId,payload)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(handlerId,payload)}};StandaloneCodeEditor=__decorate([__param(2,instantiation_1.IInstantiationService),__param(3,codeEditorService_1.ICodeEditorService),__param(4,commands_1.ICommandService),__param(5,contextkey_1.IContextKeyService),__param(6,keybinding_1.IKeybindingService),__param(7,themeService_1.IThemeService),__param(8,notification_1.INotificationService),__param(9,accessibility_1.IAccessibilityService),__param(10,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(11,languageFeatures_1.ILanguageFeaturesService)],StandaloneCodeEditor),exports.StandaloneCodeEditor=StandaloneCodeEditor;let StandaloneEditor=class StandaloneEditor extends StandaloneCodeEditor{constructor(domElement,_options,instantiationService,codeEditorService,commandService,contextKeyService,keybindingService,themeService,notificationService,configurationService,accessibilityService,modelService,languageService,languageConfigurationService,languageFeaturesService){const options=Object.assign({},_options);(0,standaloneServices_1.updateConfigurationService)(configurationService,options,!1);const themeDomRegistration=themeService.registerEditorContainer(domElement);"string"==typeof options.theme&&themeService.setTheme(options.theme),void 0!==options.autoDetectHighContrast&&themeService.setAutoDetectHighContrast(Boolean(options.autoDetectHighContrast));const _model=options.model;let model;if(delete options.model,super(domElement,options,instantiationService,codeEditorService,commandService,contextKeyService,keybindingService,themeService,notificationService,accessibilityService,languageConfigurationService,languageFeaturesService),this._configurationService=configurationService,this._standaloneThemeService=themeService,this._register(themeDomRegistration),void 0===_model){const languageId=languageService.getLanguageIdByMimeType(options.language)||options.language||modesRegistry_1.PLAINTEXT_LANGUAGE_ID;model=createTextModel(modelService,languageService,options.value||"",languageId,void 0),this._ownsModel=!0}else model=_model,this._ownsModel=!1;if(this._attachModel(model),model){const e={oldModelUrl:null,newModelUrl:model.uri};this._onDidChangeModel.fire(e)}}dispose(){super.dispose()}updateOptions(newOptions){(0,standaloneServices_1.updateConfigurationService)(this._configurationService,newOptions,!1),"string"==typeof newOptions.theme&&this._standaloneThemeService.setTheme(newOptions.theme),void 0!==newOptions.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(newOptions.autoDetectHighContrast)),super.updateOptions(newOptions)}_postDetachModelCleanup(detachedModel){super._postDetachModelCleanup(detachedModel),detachedModel&&this._ownsModel&&(detachedModel.dispose(),this._ownsModel=!1)}};StandaloneEditor=__decorate([__param(2,instantiation_1.IInstantiationService),__param(3,codeEditorService_1.ICodeEditorService),__param(4,commands_1.ICommandService),__param(5,contextkey_1.IContextKeyService),__param(6,keybinding_1.IKeybindingService),__param(7,standaloneTheme_1.IStandaloneThemeService),__param(8,notification_1.INotificationService),__param(9,configuration_1.IConfigurationService),__param(10,accessibility_1.IAccessibilityService),__param(11,model_1.IModelService),__param(12,language_1.ILanguageService),__param(13,languageConfigurationRegistry_1.ILanguageConfigurationService),__param(14,languageFeatures_1.ILanguageFeaturesService)],StandaloneEditor),exports.StandaloneEditor=StandaloneEditor;let StandaloneDiffEditor=class StandaloneDiffEditor extends diffEditorWidget_1.DiffEditorWidget{constructor(domElement,_options,instantiationService,contextKeyService,editorWorkerService,codeEditorService,themeService,notificationService,configurationService,contextMenuService,editorProgressService,clipboardService){const options=Object.assign({},_options);(0,standaloneServices_1.updateConfigurationService)(configurationService,options,!0);const themeDomRegistration=themeService.registerEditorContainer(domElement);"string"==typeof options.theme&&themeService.setTheme(options.theme),void 0!==options.autoDetectHighContrast&&themeService.setAutoDetectHighContrast(Boolean(options.autoDetectHighContrast)),super(domElement,options,{},clipboardService,editorWorkerService,contextKeyService,instantiationService,codeEditorService,themeService,notificationService,contextMenuService,editorProgressService),this._configurationService=configurationService,this._standaloneThemeService=themeService,this._register(themeDomRegistration)}dispose(){super.dispose()}updateOptions(newOptions){(0,standaloneServices_1.updateConfigurationService)(this._configurationService,newOptions,!0),"string"==typeof newOptions.theme&&this._standaloneThemeService.setTheme(newOptions.theme),void 0!==newOptions.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(newOptions.autoDetectHighContrast)),super.updateOptions(newOptions)}_createInnerEditor(instantiationService,container,options){return instantiationService.createInstance(StandaloneCodeEditor,container,options)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(keybinding,handler,context){return this.getModifiedEditor().addCommand(keybinding,handler,context)}createContextKey(key,defaultValue){return this.getModifiedEditor().createContextKey(key,defaultValue)}addAction(descriptor){return this.getModifiedEditor().addAction(descriptor)}};function createTextModel(modelService,languageService,value,languageId,uri){if(value=value||"",!languageId){const firstLF=value.indexOf("\n");let firstLine=value;return-1!==firstLF&&(firstLine=value.substring(0,firstLF)),doCreateModel(modelService,value,languageService.createByFilepathOrFirstLine(uri||null,firstLine),uri)}return doCreateModel(modelService,value,languageService.createById(languageId),uri)}function doCreateModel(modelService,value,languageSelection,uri){return modelService.createModel(value,languageSelection,uri)}StandaloneDiffEditor=__decorate([__param(2,instantiation_1.IInstantiationService),__param(3,contextkey_1.IContextKeyService),__param(4,editorWorker_1.IEditorWorkerService),__param(5,codeEditorService_1.ICodeEditorService),__param(6,standaloneTheme_1.IStandaloneThemeService),__param(7,notification_1.INotificationService),__param(8,configuration_1.IConfigurationService),__param(9,contextView_1.IContextMenuService),__param(10,progress_1.IEditorProgressService),__param(11,clipboardService_1.IClipboardService)],StandaloneDiffEditor),exports.StandaloneDiffEditor=StandaloneDiffEditor,exports.createTextModel=createTextModel})),define(__m[756],__M([1,0,8,270,29,238,32,176,149,50,27,33,124,35,48,623,185,477,755,213,103,26,79,397]),(function(require,exports,strings_1,fontMeasurements_1,codeEditorService_1,diffNavigator_1,editorOptions_1,fontInfo_1,editorCommon_1,model_1,languages,languageConfigurationRegistry_1,nullTokenize_1,language_1,model_2,webWorker_1,standaloneEnums,colorizer_1,standaloneCodeEditor_1,standaloneServices_1,standaloneTheme_1,commands_1,markers_1){"use strict";function create(domElement,options,override){return standaloneServices_1.StandaloneServices.initialize(override||{}).createInstance(standaloneCodeEditor_1.StandaloneEditor,domElement,options)}function onDidCreateEditor(listener){return standaloneServices_1.StandaloneServices.get(codeEditorService_1.ICodeEditorService).onCodeEditorAdd((editor=>{listener(editor)}))}function createDiffEditor(domElement,options,override){return standaloneServices_1.StandaloneServices.initialize(override||{}).createInstance(standaloneCodeEditor_1.StandaloneDiffEditor,domElement,options)}function createDiffNavigator(diffEditor,opts){return new diffNavigator_1.DiffNavigator(diffEditor,opts)}function createModel(value,language,uri){const languageService=standaloneServices_1.StandaloneServices.get(language_1.ILanguageService),languageId=languageService.getLanguageIdByMimeType(language)||language;return(0,standaloneCodeEditor_1.createTextModel)(standaloneServices_1.StandaloneServices.get(model_2.IModelService),languageService,value,languageId,uri)}function setModelLanguage(model,languageId){const languageService=standaloneServices_1.StandaloneServices.get(language_1.ILanguageService);standaloneServices_1.StandaloneServices.get(model_2.IModelService).setMode(model,languageService.createById(languageId))}function setModelMarkers(model,owner,markers){if(model){standaloneServices_1.StandaloneServices.get(markers_1.IMarkerService).changeOne(owner,model.uri,markers)}}function getModelMarkers(filter){return standaloneServices_1.StandaloneServices.get(markers_1.IMarkerService).read(filter)}function onDidChangeMarkers(listener){return standaloneServices_1.StandaloneServices.get(markers_1.IMarkerService).onMarkerChanged(listener)}function getModel(uri){return standaloneServices_1.StandaloneServices.get(model_2.IModelService).getModel(uri)}function getModels(){return standaloneServices_1.StandaloneServices.get(model_2.IModelService).getModels()}function onDidCreateModel(listener){return standaloneServices_1.StandaloneServices.get(model_2.IModelService).onModelAdded(listener)}function onWillDisposeModel(listener){return standaloneServices_1.StandaloneServices.get(model_2.IModelService).onModelRemoved(listener)}function onDidChangeModelLanguage(listener){return standaloneServices_1.StandaloneServices.get(model_2.IModelService).onModelLanguageChanged((e=>{listener({model:e.model,oldLanguage:e.oldLanguageId})}))}function createWebWorker(opts){return(0,webWorker_1.createWebWorker)(standaloneServices_1.StandaloneServices.get(model_2.IModelService),standaloneServices_1.StandaloneServices.get(languageConfigurationRegistry_1.ILanguageConfigurationService),opts)}function colorizeElement(domNode,options){const languageService=standaloneServices_1.StandaloneServices.get(language_1.ILanguageService),themeService=standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService);return themeService.registerEditorContainer(domNode),colorizer_1.Colorizer.colorizeElement(themeService,languageService,domNode,options)}function colorize(text,languageId,options){const languageService=standaloneServices_1.StandaloneServices.get(language_1.ILanguageService);return standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService).registerEditorContainer(document.body),colorizer_1.Colorizer.colorize(languageService,text,languageId,options)}function colorizeModelLine(model,lineNumber,tabSize=4){return standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService).registerEditorContainer(document.body),colorizer_1.Colorizer.colorizeModelLine(model,lineNumber,tabSize)}function tokenize(text,languageId){languages.TokenizationRegistry.getOrCreate(languageId);const tokenizationSupport=function getSafeTokenizationSupport(language){return languages.TokenizationRegistry.get(language)||{getInitialState:()=>nullTokenize_1.NullState,tokenize:(line,hasEOL,state)=>(0,nullTokenize_1.nullTokenize)(language,state)}}(languageId),lines=(0,strings_1.splitLines)(text),result=[];let state=tokenizationSupport.getInitialState();for(let i=0,len=lines.length;i<len;i++){const line=lines[i],tokenizationResult=tokenizationSupport.tokenize(line,!0,state);result[i]=tokenizationResult.tokens,state=tokenizationResult.endState}return result}function defineTheme(themeName,themeData){standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService).defineTheme(themeName,themeData)}function setTheme(themeName){standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService).setTheme(themeName)}function remeasureFonts(){fontMeasurements_1.FontMeasurements.clearAllFontInfos()}function registerCommand(id,handler){return commands_1.CommandsRegistry.registerCommand({id,handler})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMonacoEditorAPI=exports.registerCommand=exports.remeasureFonts=exports.setTheme=exports.defineTheme=exports.tokenize=exports.colorizeModelLine=exports.colorize=exports.colorizeElement=exports.createWebWorker=exports.onDidChangeModelLanguage=exports.onWillDisposeModel=exports.onDidCreateModel=exports.getModels=exports.getModel=exports.onDidChangeMarkers=exports.getModelMarkers=exports.setModelMarkers=exports.setModelLanguage=exports.createModel=exports.createDiffNavigator=exports.createDiffEditor=exports.onDidCreateEditor=exports.create=void 0,exports.create=create,exports.onDidCreateEditor=onDidCreateEditor,exports.createDiffEditor=createDiffEditor,exports.createDiffNavigator=createDiffNavigator,exports.createModel=createModel,exports.setModelLanguage=setModelLanguage,exports.setModelMarkers=setModelMarkers,exports.getModelMarkers=getModelMarkers,exports.onDidChangeMarkers=onDidChangeMarkers,exports.getModel=getModel,exports.getModels=getModels,exports.onDidCreateModel=onDidCreateModel,exports.onWillDisposeModel=onWillDisposeModel,exports.onDidChangeModelLanguage=onDidChangeModelLanguage,exports.createWebWorker=createWebWorker,exports.colorizeElement=colorizeElement,exports.colorize=colorize,exports.colorizeModelLine=colorizeModelLine,exports.tokenize=tokenize,exports.defineTheme=defineTheme,exports.setTheme=setTheme,exports.remeasureFonts=remeasureFonts,exports.registerCommand=registerCommand,exports.createMonacoEditorAPI=function createMonacoEditorAPI(){return{create,onDidCreateEditor,createDiffEditor,createDiffNavigator,createModel,setModelLanguage,setModelMarkers,getModelMarkers,onDidChangeMarkers,getModels,getModel,onDidCreateModel,onWillDisposeModel,onDidChangeModelLanguage,createWebWorker,colorizeElement,colorize,colorizeModelLine,tokenize,defineTheme,setTheme,remeasureFonts,registerCommand,AccessibilitySupport:standaloneEnums.AccessibilitySupport,ContentWidgetPositionPreference:standaloneEnums.ContentWidgetPositionPreference,CursorChangeReason:standaloneEnums.CursorChangeReason,DefaultEndOfLine:standaloneEnums.DefaultEndOfLine,EditorAutoIndentStrategy:standaloneEnums.EditorAutoIndentStrategy,EditorOption:standaloneEnums.EditorOption,EndOfLinePreference:standaloneEnums.EndOfLinePreference,EndOfLineSequence:standaloneEnums.EndOfLineSequence,MinimapPosition:standaloneEnums.MinimapPosition,MouseTargetType:standaloneEnums.MouseTargetType,OverlayWidgetPositionPreference:standaloneEnums.OverlayWidgetPositionPreference,OverviewRulerLane:standaloneEnums.OverviewRulerLane,RenderLineNumbersType:standaloneEnums.RenderLineNumbersType,RenderMinimap:standaloneEnums.RenderMinimap,ScrollbarVisibility:standaloneEnums.ScrollbarVisibility,ScrollType:standaloneEnums.ScrollType,TextEditorCursorBlinkingStyle:standaloneEnums.TextEditorCursorBlinkingStyle,TextEditorCursorStyle:standaloneEnums.TextEditorCursorStyle,TrackedRangeStickiness:standaloneEnums.TrackedRangeStickiness,WrappingIndent:standaloneEnums.WrappingIndent,InjectedTextCursorStops:standaloneEnums.InjectedTextCursorStops,PositionAffinity:standaloneEnums.PositionAffinity,ConfigurationChangedEvent:editorOptions_1.ConfigurationChangedEvent,BareFontInfo:fontInfo_1.BareFontInfo,FontInfo:fontInfo_1.FontInfo,TextModelResolvedOptions:model_1.TextModelResolvedOptions,FindMatch:model_1.FindMatch,ApplyUpdateResult:editorOptions_1.ApplyUpdateResult,EditorType:editorCommon_1.EditorType,EditorOptions:editorOptions_1.EditorOptions}}})),define(__m[757],__M([1,0,30,3,27,33,81,35,185,213,476,267,103,79,20]),(function(require,exports,color_1,range_1,languages,languageConfigurationRegistry_1,modesRegistry_1,language_1,standaloneEnums,standaloneServices_1,monarchCompile_1,monarchLexer_1,standaloneTheme_1,markers_1,languageFeatures_1){"use strict";function register(language){modesRegistry_1.ModesRegistry.registerLanguage(language)}function getLanguages(){let result=[];return result=result.concat(modesRegistry_1.ModesRegistry.getLanguages()),result}function getEncodedLanguageId(languageId){return standaloneServices_1.StandaloneServices.get(language_1.ILanguageService).languageIdCodec.encodeLanguageId(languageId)}function onLanguage(languageId,callback){const disposable=standaloneServices_1.StandaloneServices.get(language_1.ILanguageService).onDidEncounterLanguage((encounteredLanguageId=>{encounteredLanguageId===languageId&&(disposable.dispose(),callback())}));return disposable}function setLanguageConfiguration(languageId,configuration){if(!standaloneServices_1.StandaloneServices.get(language_1.ILanguageService).isRegisteredLanguageId(languageId))throw new Error(`Cannot set configuration for unknown language ${languageId}`);return languageConfigurationRegistry_1.LanguageConfigurationRegistry.register(languageId,configuration,100)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMonacoLanguagesAPI=exports.registerInlayHintsProvider=exports.registerInlineCompletionsProvider=exports.registerDocumentRangeSemanticTokensProvider=exports.registerDocumentSemanticTokensProvider=exports.registerSelectionRangeProvider=exports.registerDeclarationProvider=exports.registerFoldingRangeProvider=exports.registerColorProvider=exports.registerCompletionItemProvider=exports.registerLinkProvider=exports.registerOnTypeFormattingEditProvider=exports.registerDocumentRangeFormattingEditProvider=exports.registerDocumentFormattingEditProvider=exports.registerCodeActionProvider=exports.registerCodeLensProvider=exports.registerTypeDefinitionProvider=exports.registerImplementationProvider=exports.registerDefinitionProvider=exports.registerLinkedEditingRangeProvider=exports.registerDocumentHighlightProvider=exports.registerDocumentSymbolProvider=exports.registerHoverProvider=exports.registerSignatureHelpProvider=exports.registerRenameProvider=exports.registerReferenceProvider=exports.setMonarchTokensProvider=exports.setTokensProvider=exports.registerTokensProviderFactory=exports.setColorMap=exports.TokenizationSupportAdapter=exports.EncodedTokenizationSupportAdapter=exports.setLanguageConfiguration=exports.onLanguage=exports.getEncodedLanguageId=exports.getLanguages=exports.register=void 0,exports.register=register,exports.getLanguages=getLanguages,exports.getEncodedLanguageId=getEncodedLanguageId,exports.onLanguage=onLanguage,exports.setLanguageConfiguration=setLanguageConfiguration;class EncodedTokenizationSupportAdapter{constructor(languageId,actual){this._languageId=languageId,this._actual=actual}getInitialState(){return this._actual.getInitialState()}tokenize(line,hasEOL,state){if("function"==typeof this._actual.tokenize)return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,line,state);throw new Error("Not supported!")}tokenizeEncoded(line,hasEOL,state){const result=this._actual.tokenizeEncoded(line,state);return new languages.EncodedTokenizationResult(result.tokens,result.endState)}}exports.EncodedTokenizationSupportAdapter=EncodedTokenizationSupportAdapter;class TokenizationSupportAdapter{constructor(_languageId,_actual,_languageService,_standaloneThemeService){this._languageId=_languageId,this._actual=_actual,this._languageService=_languageService,this._standaloneThemeService=_standaloneThemeService}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(tokens,language){const result=[];let previousStartIndex=0;for(let i=0,len=tokens.length;i<len;i++){const t=tokens[i];let startIndex=t.startIndex;0===i?startIndex=0:startIndex<previousStartIndex&&(startIndex=previousStartIndex),result[i]=new languages.Token(startIndex,t.scopes,language),previousStartIndex=startIndex}return result}static adaptTokenize(language,actual,line,state){const actualResult=actual.tokenize(line,state),tokens=TokenizationSupportAdapter._toClassicTokens(actualResult.tokens,language);let endState;return endState=actualResult.endState.equals(state)?state:actualResult.endState,new languages.TokenizationResult(tokens,endState)}tokenize(line,hasEOL,state){return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,line,state)}_toBinaryTokens(languageIdCodec,tokens){const languageId=languageIdCodec.encodeLanguageId(this._languageId),tokenTheme=this._standaloneThemeService.getColorTheme().tokenTheme,result=[];let resultLen=0,previousStartIndex=0;for(let i=0,len=tokens.length;i<len;i++){const t=tokens[i],metadata=tokenTheme.match(languageId,t.scopes);if(resultLen>0&&result[resultLen-1]===metadata)continue;let startIndex=t.startIndex;0===i?startIndex=0:startIndex<previousStartIndex&&(startIndex=previousStartIndex),result[resultLen++]=startIndex,result[resultLen++]=metadata,previousStartIndex=startIndex}const actualResult=new Uint32Array(resultLen);for(let i=0;i<resultLen;i++)actualResult[i]=result[i];return actualResult}tokenizeEncoded(line,hasEOL,state){const actualResult=this._actual.tokenize(line,state),tokens=this._toBinaryTokens(this._languageService.languageIdCodec,actualResult.tokens);let endState;return endState=actualResult.endState.equals(state)?state:actualResult.endState,new languages.EncodedTokenizationResult(tokens,endState)}}function isThenable(obj){return obj&&"function"==typeof obj.then}function setColorMap(colorMap){const standaloneThemeService=standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService);if(colorMap){const result=[null];for(let i=1,len=colorMap.length;i<len;i++)result[i]=color_1.Color.fromHex(colorMap[i]);standaloneThemeService.setColorMapOverride(result)}else standaloneThemeService.setColorMapOverride(null)}function createTokenizationSupportAdapter(languageId,provider){return function isEncodedTokensProvider(provider){return"tokenizeEncoded"in provider}(provider)?new EncodedTokenizationSupportAdapter(languageId,provider):new TokenizationSupportAdapter(languageId,provider,standaloneServices_1.StandaloneServices.get(language_1.ILanguageService),standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService))}function registerTokensProviderFactory(languageId,factory){const adaptedFactory={createTokenizationSupport:()=>__awaiter(this,void 0,void 0,(function*(){const result=yield Promise.resolve(factory.create());return result?function isATokensProvider(provider){return"function"==typeof provider.getInitialState}(result)?createTokenizationSupportAdapter(languageId,result):new monarchLexer_1.MonarchTokenizer(standaloneServices_1.StandaloneServices.get(language_1.ILanguageService),standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService),languageId,(0,monarchCompile_1.compile)(languageId,result)):null}))};return languages.TokenizationRegistry.registerFactory(languageId,adaptedFactory)}function setTokensProvider(languageId,provider){if(!standaloneServices_1.StandaloneServices.get(language_1.ILanguageService).isRegisteredLanguageId(languageId))throw new Error(`Cannot set tokens provider for unknown language ${languageId}`);return isThenable(provider)?registerTokensProviderFactory(languageId,{create:()=>provider}):languages.TokenizationRegistry.register(languageId,createTokenizationSupportAdapter(languageId,provider))}function setMonarchTokensProvider(languageId,languageDef){return isThenable(languageDef)?registerTokensProviderFactory(languageId,{create:()=>languageDef}):languages.TokenizationRegistry.register(languageId,(languageDef=>new monarchLexer_1.MonarchTokenizer(standaloneServices_1.StandaloneServices.get(language_1.ILanguageService),standaloneServices_1.StandaloneServices.get(standaloneTheme_1.IStandaloneThemeService),languageId,(0,monarchCompile_1.compile)(languageId,languageDef)))(languageDef))}function registerReferenceProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).referenceProvider.register(languageSelector,provider)}function registerRenameProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).renameProvider.register(languageSelector,provider)}function registerSignatureHelpProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).signatureHelpProvider.register(languageSelector,provider)}function registerHoverProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).hoverProvider.register(languageSelector,{provideHover:(model,position,token)=>{const word=model.getWordAtPosition(position);return Promise.resolve(provider.provideHover(model,position,token)).then((value=>{if(value)return!value.range&&word&&(value.range=new range_1.Range(position.lineNumber,word.startColumn,position.lineNumber,word.endColumn)),value.range||(value.range=new range_1.Range(position.lineNumber,position.column,position.lineNumber,position.column)),value}))}})}function registerDocumentSymbolProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentSymbolProvider.register(languageSelector,provider)}function registerDocumentHighlightProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentHighlightProvider.register(languageSelector,provider)}function registerLinkedEditingRangeProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).linkedEditingRangeProvider.register(languageSelector,provider)}function registerDefinitionProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).definitionProvider.register(languageSelector,provider)}function registerImplementationProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).implementationProvider.register(languageSelector,provider)}function registerTypeDefinitionProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).typeDefinitionProvider.register(languageSelector,provider)}function registerCodeLensProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).codeLensProvider.register(languageSelector,provider)}function registerCodeActionProvider(languageSelector,provider,metadata){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).codeActionProvider.register(languageSelector,{providedCodeActionKinds:null==metadata?void 0:metadata.providedCodeActionKinds,provideCodeActions:(model,range,context,token)=>{const markers=standaloneServices_1.StandaloneServices.get(markers_1.IMarkerService).read({resource:model.uri}).filter((m=>range_1.Range.areIntersectingOrTouching(m,range)));return provider.provideCodeActions(model,range,{markers,only:context.only},token)},resolveCodeAction:provider.resolveCodeAction})}function registerDocumentFormattingEditProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentFormattingEditProvider.register(languageSelector,provider)}function registerDocumentRangeFormattingEditProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentRangeFormattingEditProvider.register(languageSelector,provider)}function registerOnTypeFormattingEditProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).onTypeFormattingEditProvider.register(languageSelector,provider)}function registerLinkProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).linkProvider.register(languageSelector,provider)}function registerCompletionItemProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).completionProvider.register(languageSelector,provider)}function registerColorProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).colorProvider.register(languageSelector,provider)}function registerFoldingRangeProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).foldingRangeProvider.register(languageSelector,provider)}function registerDeclarationProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).declarationProvider.register(languageSelector,provider)}function registerSelectionRangeProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).selectionRangeProvider.register(languageSelector,provider)}function registerDocumentSemanticTokensProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentSemanticTokensProvider.register(languageSelector,provider)}function registerDocumentRangeSemanticTokensProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).documentRangeSemanticTokensProvider.register(languageSelector,provider)}function registerInlineCompletionsProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).inlineCompletionsProvider.register(languageSelector,provider)}function registerInlayHintsProvider(languageSelector,provider){return standaloneServices_1.StandaloneServices.get(languageFeatures_1.ILanguageFeaturesService).inlayHintsProvider.register(languageSelector,provider)}exports.TokenizationSupportAdapter=TokenizationSupportAdapter,exports.setColorMap=setColorMap,exports.registerTokensProviderFactory=registerTokensProviderFactory,exports.setTokensProvider=setTokensProvider,exports.setMonarchTokensProvider=setMonarchTokensProvider,exports.registerReferenceProvider=registerReferenceProvider,exports.registerRenameProvider=registerRenameProvider,exports.registerSignatureHelpProvider=registerSignatureHelpProvider,exports.registerHoverProvider=registerHoverProvider,exports.registerDocumentSymbolProvider=registerDocumentSymbolProvider,exports.registerDocumentHighlightProvider=registerDocumentHighlightProvider,exports.registerLinkedEditingRangeProvider=registerLinkedEditingRangeProvider,exports.registerDefinitionProvider=registerDefinitionProvider,exports.registerImplementationProvider=registerImplementationProvider,exports.registerTypeDefinitionProvider=registerTypeDefinitionProvider,exports.registerCodeLensProvider=registerCodeLensProvider,exports.registerCodeActionProvider=registerCodeActionProvider,exports.registerDocumentFormattingEditProvider=registerDocumentFormattingEditProvider,exports.registerDocumentRangeFormattingEditProvider=registerDocumentRangeFormattingEditProvider,exports.registerOnTypeFormattingEditProvider=registerOnTypeFormattingEditProvider,exports.registerLinkProvider=registerLinkProvider,exports.registerCompletionItemProvider=registerCompletionItemProvider,exports.registerColorProvider=registerColorProvider,exports.registerFoldingRangeProvider=registerFoldingRangeProvider,exports.registerDeclarationProvider=registerDeclarationProvider,exports.registerSelectionRangeProvider=registerSelectionRangeProvider,exports.registerDocumentSemanticTokensProvider=registerDocumentSemanticTokensProvider,exports.registerDocumentRangeSemanticTokensProvider=registerDocumentRangeSemanticTokensProvider,exports.registerInlineCompletionsProvider=registerInlineCompletionsProvider,exports.registerInlayHintsProvider=registerInlayHintsProvider,exports.createMonacoLanguagesAPI=function createMonacoLanguagesAPI(){return{register,getLanguages,onLanguage,getEncodedLanguageId,setLanguageConfiguration,setColorMap,registerTokensProviderFactory,setTokensProvider,setMonarchTokensProvider,registerReferenceProvider,registerRenameProvider,registerCompletionItemProvider,registerSignatureHelpProvider,registerHoverProvider,registerDocumentSymbolProvider,registerDocumentHighlightProvider,registerLinkedEditingRangeProvider,registerDefinitionProvider,registerImplementationProvider,registerTypeDefinitionProvider,registerCodeLensProvider,registerCodeActionProvider,registerDocumentFormattingEditProvider,registerDocumentRangeFormattingEditProvider,registerOnTypeFormattingEditProvider,registerLinkProvider,registerColorProvider,registerFoldingRangeProvider,registerDeclarationProvider,registerSelectionRangeProvider,registerDocumentSemanticTokensProvider,registerDocumentRangeSemanticTokensProvider,registerInlineCompletionsProvider,registerInlayHintsProvider,DocumentHighlightKind:standaloneEnums.DocumentHighlightKind,CompletionItemKind:standaloneEnums.CompletionItemKind,CompletionItemTag:standaloneEnums.CompletionItemTag,CompletionItemInsertTextRule:standaloneEnums.CompletionItemInsertTextRule,SymbolKind:standaloneEnums.SymbolKind,SymbolTag:standaloneEnums.SymbolTag,IndentAction:standaloneEnums.IndentAction,CompletionTriggerKind:standaloneEnums.CompletionTriggerKind,SignatureHelpTriggerKind:standaloneEnums.SignatureHelpTriggerKind,InlayHintKind:standaloneEnums.InlayHintKind,InlineCompletionTriggerKind:standaloneEnums.InlineCompletionTriggerKind,FoldingRangeKind:languages.FoldingRangeKind}}})),define(__m[758],__M([1,0,32,252,756,757,16,291]),(function(require,exports,editorOptions_1,editorBaseApi_1,standaloneEditor_1,standaloneLanguages_1,platform_1,format_1){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.languages=exports.editor=exports.Token=exports.Uri=exports.MarkerTag=exports.MarkerSeverity=exports.SelectionDirection=exports.Selection=exports.Range=exports.Position=exports.KeyMod=exports.KeyCode=exports.Emitter=exports.CancellationTokenSource=void 0,editorOptions_1.EditorOptions.wrappingIndent.defaultValue=0,editorOptions_1.EditorOptions.glyphMargin.defaultValue=!1,editorOptions_1.EditorOptions.autoIndent.defaultValue=3,editorOptions_1.EditorOptions.overviewRulerLanes.defaultValue=2,format_1.FormattingConflicts.setFormatterSelector(((formatter,document,mode)=>Promise.resolve(formatter[0])));const api=(0,editorBaseApi_1.createMonacoBaseAPI)();api.editor=(0,standaloneEditor_1.createMonacoEditorAPI)(),api.languages=(0,standaloneLanguages_1.createMonacoLanguagesAPI)(),exports.CancellationTokenSource=api.CancellationTokenSource,exports.Emitter=api.Emitter,exports.KeyCode=api.KeyCode,exports.KeyMod=api.KeyMod,exports.Position=api.Position,exports.Range=api.Range,exports.Selection=api.Selection,exports.SelectionDirection=api.SelectionDirection,exports.MarkerSeverity=api.MarkerSeverity,exports.MarkerTag=api.MarkerTag,exports.Uri=api.Uri,exports.Token=api.Token,exports.editor=api.editor,exports.languages=api.languages,((null===(_a=platform_1.globals.MonacoEnvironment)||void 0===_a?void 0:_a.globalAPI)||"function"==typeof define&&define.amd)&&(self.monaco=api),void 0!==self.require&&"function"==typeof self.require.config&&self.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]})}));__createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};define(__m[760],__M([1,0,758,754,694,695,696,637,698,699,697,744,700]),(function(require,exports,editor_api_1){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(editor_api_1,exports)}))}).call(this),define("vs/basic-languages/monaco.contribution",["require","vs/editor/editor.api"],(require=>(()=>{var cb,mod,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__require=(x=>void 0!==require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(a,b)=>(void 0!==require?require:a)[b]}):x)((function(x){if(void 0!==require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')})),__reExport=(target,module,copyDefault,desc)=>{if(module&&"object"==typeof module||"function"==typeof module)for(let key of __getOwnPropNames(module))__hasOwnProp.call(target,key)||!copyDefault&&"default"===key||__defProp(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});return target},__toESM=(module,isNodeMode)=>{return __reExport((target=__defProp(null!=module?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:!0}:{value:module,enumerable:!0}),__defProp(target,"__esModule",{value:!0})),module);var target},require_monaco_editor_core_amd=(cb={"src/fillers/monaco-editor-core-amd.ts"(exports,module){var api=__toESM(__require("vs/editor/editor.api"));module.exports=api}},function __require2(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,__toESM(require_monaco_editor_core_amd()));var languageDefinitions={},lazyLanguageLoaders={},LazyLanguageLoader=class{static getOrCreate(languageId){return lazyLanguageLoaders[languageId]||(lazyLanguageLoaders[languageId]=new LazyLanguageLoader(languageId)),lazyLanguageLoaders[languageId]}_languageId;_loadingTriggered;_lazyLoadPromise;_lazyLoadPromiseResolve;_lazyLoadPromiseReject;constructor(languageId){this._languageId=languageId,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise(((resolve,reject)=>{this._lazyLoadPromiseResolve=resolve,this._lazyLoadPromiseReject=reject}))}load(){return this._loadingTriggered||(this._loadingTriggered=!0,languageDefinitions[this._languageId].loader().then((mod=>this._lazyLoadPromiseResolve(mod)),(err=>this._lazyLoadPromiseReject(err)))),this._lazyLoadPromise}};function registerLanguage(def){const languageId=def.id;languageDefinitions[languageId]=def,monaco_editor_core_exports.languages.register(def);const lazyLanguageLoader=LazyLanguageLoader.getOrCreate(languageId);monaco_editor_core_exports.languages.registerTokensProviderFactory(languageId,{create:async()=>(await lazyLanguageLoader.load()).language}),monaco_editor_core_exports.languages.onLanguage(languageId,(async()=>{const mod=await lazyLanguageLoader.load();monaco_editor_core_exports.languages.setLanguageConfiguration(languageId,mod.conf)}))}registerLanguage({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/abap/abap"],resolve,reject)}))}),registerLanguage({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/apex/apex"],resolve,reject)}))}),registerLanguage({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/azcli/azcli"],resolve,reject)}))}),registerLanguage({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/bat/bat"],resolve,reject)}))}),registerLanguage({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/bicep/bicep"],resolve,reject)}))}),registerLanguage({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/cameligo/cameligo"],resolve,reject)}))}),registerLanguage({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/clojure/clojure"],resolve,reject)}))}),registerLanguage({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/coffee/coffee"],resolve,reject)}))}),registerLanguage({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/cpp/cpp"],resolve,reject)}))}),registerLanguage({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/cpp/cpp"],resolve,reject)}))}),registerLanguage({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/csharp/csharp"],resolve,reject)}))}),registerLanguage({id:"csp",extensions:[],aliases:["CSP","csp"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/csp/csp"],resolve,reject)}))}),registerLanguage({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/css/css"],resolve,reject)}))}),registerLanguage({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/dart/dart"],resolve,reject)}))}),registerLanguage({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/dockerfile/dockerfile"],resolve,reject)}))}),registerLanguage({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/ecl/ecl"],resolve,reject)}))}),registerLanguage({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/elixir/elixir"],resolve,reject)}))}),registerLanguage({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/flow9/flow9"],resolve,reject)}))}),registerLanguage({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/fsharp/fsharp"],resolve,reject)}))}),registerLanguage({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagAngleInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagAngleInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagBracketInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagAngleInterpolationBracket))}),registerLanguage({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagBracketInterpolationBracket))}),registerLanguage({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagAutoInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/freemarker2/freemarker2"],resolve,reject)})).then((m=>m.TagAutoInterpolationBracket))}),registerLanguage({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/go/go"],resolve,reject)}))}),registerLanguage({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/graphql/graphql"],resolve,reject)}))}),registerLanguage({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/handlebars/handlebars"],resolve,reject)}))}),registerLanguage({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/hcl/hcl"],resolve,reject)}))}),registerLanguage({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/html/html"],resolve,reject)}))}),registerLanguage({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/ini/ini"],resolve,reject)}))}),registerLanguage({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/java/java"],resolve,reject)}))}),registerLanguage({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/javascript/javascript"],resolve,reject)}))}),registerLanguage({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/julia/julia"],resolve,reject)}))}),registerLanguage({id:"kotlin",extensions:[".kt"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/kotlin/kotlin"],resolve,reject)}))}),registerLanguage({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/less/less"],resolve,reject)}))}),registerLanguage({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/lexon/lexon"],resolve,reject)}))}),registerLanguage({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/lua/lua"],resolve,reject)}))}),registerLanguage({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/liquid/liquid"],resolve,reject)}))}),registerLanguage({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/m3/m3"],resolve,reject)}))}),registerLanguage({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/markdown/markdown"],resolve,reject)}))}),registerLanguage({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/mips/mips"],resolve,reject)}))}),registerLanguage({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/msdax/msdax"],resolve,reject)}))}),registerLanguage({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/mysql/mysql"],resolve,reject)}))}),registerLanguage({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/objective-c/objective-c"],resolve,reject)}))}),registerLanguage({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/pascal/pascal"],resolve,reject)}))}),registerLanguage({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/pascaligo/pascaligo"],resolve,reject)}))}),registerLanguage({id:"perl",extensions:[".pl"],aliases:["Perl","pl"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/perl/perl"],resolve,reject)}))}),registerLanguage({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/pgsql/pgsql"],resolve,reject)}))}),registerLanguage({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/php/php"],resolve,reject)}))}),registerLanguage({id:"pla",extensions:[".pla"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/pla/pla"],resolve,reject)}))}),registerLanguage({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/postiats/postiats"],resolve,reject)}))}),registerLanguage({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/powerquery/powerquery"],resolve,reject)}))}),registerLanguage({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/powershell/powershell"],resolve,reject)}))}),registerLanguage({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/protobuf/protobuf"],resolve,reject)}))}),registerLanguage({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/pug/pug"],resolve,reject)}))}),registerLanguage({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/python/python"],resolve,reject)}))}),registerLanguage({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/qsharp/qsharp"],resolve,reject)}))}),registerLanguage({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/r/r"],resolve,reject)}))}),registerLanguage({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/razor/razor"],resolve,reject)}))}),registerLanguage({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/redis/redis"],resolve,reject)}))}),registerLanguage({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/redshift/redshift"],resolve,reject)}))}),registerLanguage({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/restructuredtext/restructuredtext"],resolve,reject)}))}),registerLanguage({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/ruby/ruby"],resolve,reject)}))}),registerLanguage({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/rust/rust"],resolve,reject)}))}),registerLanguage({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/sb/sb"],resolve,reject)}))}),registerLanguage({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/scala/scala"],resolve,reject)}))}),registerLanguage({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/scheme/scheme"],resolve,reject)}))}),registerLanguage({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/scss/scss"],resolve,reject)}))}),registerLanguage({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/shell/shell"],resolve,reject)}))}),registerLanguage({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/solidity/solidity"],resolve,reject)}))}),registerLanguage({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/sophia/sophia"],resolve,reject)}))}),registerLanguage({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/sparql/sparql"],resolve,reject)}))}),registerLanguage({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/sql/sql"],resolve,reject)}))}),registerLanguage({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib"],aliases:["StructuredText","scl","stl"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/st/st"],resolve,reject)}))}),registerLanguage({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/swift/swift"],resolve,reject)}))}),registerLanguage({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/systemverilog/systemverilog"],resolve,reject)}))}),registerLanguage({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/systemverilog/systemverilog"],resolve,reject)}))}),registerLanguage({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/tcl/tcl"],resolve,reject)}))}),registerLanguage({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/twig/twig"],resolve,reject)}))}),registerLanguage({id:"typescript",extensions:[".ts",".tsx"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/typescript/typescript"],resolve,reject)}))}),registerLanguage({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/vb/vb"],resolve,reject)}))}),registerLanguage({id:"xml",extensions:[".xml",".dtd",".ascx",".csproj",".config",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/xml/xml"],resolve,reject)}))}),registerLanguage({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>new Promise(((resolve,reject)=>{__require(["vs/basic-languages/yaml/yaml"],resolve,reject)}))})})())),define("vs/language/css/monaco.contribution",["require","vs/editor/editor.api"],(require=>(()=>{var cb,mod,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__markAsModule=target=>__defProp(target,"__esModule",{value:!0}),__require=(x=>void 0!==require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(a,b)=>(void 0!==require?require:a)[b]}):x)((function(x){if(void 0!==require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')})),__reExport=(target,module,copyDefault,desc)=>{if(module&&"object"==typeof module||"function"==typeof module)for(let key of __getOwnPropNames(module))__hasOwnProp.call(target,key)||!copyDefault&&"default"===key||__defProp(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});return target},__toESM=(module,isNodeMode)=>__reExport(__markAsModule(__defProp(null!=module?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:!0}:{value:module,enumerable:!0})),module),__toCommonJS=(cache=>(module,temp)=>cache&&cache.get(module)||(temp=__reExport(__markAsModule({}),module,1),cache&&cache.set(module,temp),temp))("undefined"!=typeof WeakMap?new WeakMap:0),require_monaco_editor_core_amd=(cb={"src/fillers/monaco-editor-core-amd.ts"(exports,module){var api=__toESM(__require("vs/editor/editor.api"));module.exports=api}},function __require2(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),monaco_contribution_exports={};((target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})})(monaco_contribution_exports,{cssDefaults:()=>cssDefaults,lessDefaults:()=>lessDefaults,scssDefaults:()=>scssDefaults});var monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,__toESM(require_monaco_editor_core_amd()));var LanguageServiceDefaultsImpl=class{_onDidChange=new monaco_editor_core_exports.Emitter;_options;_modeConfiguration;_languageId;constructor(languageId,options,modeConfiguration){this._languageId=languageId,this.setOptions(options),this.setModeConfiguration(modeConfiguration)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(options){this._options=options||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(options){this.setOptions(options)}setModeConfiguration(modeConfiguration){this._modeConfiguration=modeConfiguration||Object.create(null),this._onDidChange.fire(this)}},optionsDefault={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0}},modeConfigurationDefault={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},cssDefaults=new LanguageServiceDefaultsImpl("css",optionsDefault,modeConfigurationDefault),scssDefaults=new LanguageServiceDefaultsImpl("scss",optionsDefault,modeConfigurationDefault),lessDefaults=new LanguageServiceDefaultsImpl("less",optionsDefault,modeConfigurationDefault);function getMode(){return new Promise(((resolve,reject)=>{__require(["vs/language/css/cssMode"],resolve,reject)}))}return monaco_editor_core_exports.languages.css={cssDefaults,lessDefaults,scssDefaults},monaco_editor_core_exports.languages.onLanguage("less",(()=>{getMode().then((mode=>mode.setupMode(lessDefaults)))})),monaco_editor_core_exports.languages.onLanguage("scss",(()=>{getMode().then((mode=>mode.setupMode(scssDefaults)))})),monaco_editor_core_exports.languages.onLanguage("css",(()=>{getMode().then((mode=>mode.setupMode(cssDefaults)))})),__toCommonJS(monaco_contribution_exports)})())),define("vs/language/html/monaco.contribution",["require","vs/editor/editor.api"],(require=>(()=>{var cb,mod,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__markAsModule=target=>__defProp(target,"__esModule",{value:!0}),__require=(x=>void 0!==require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(a,b)=>(void 0!==require?require:a)[b]}):x)((function(x){if(void 0!==require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')})),__reExport=(target,module,copyDefault,desc)=>{if(module&&"object"==typeof module||"function"==typeof module)for(let key of __getOwnPropNames(module))__hasOwnProp.call(target,key)||!copyDefault&&"default"===key||__defProp(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});return target},__toESM=(module,isNodeMode)=>__reExport(__markAsModule(__defProp(null!=module?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:!0}:{value:module,enumerable:!0})),module),__toCommonJS=(cache=>(module,temp)=>cache&&cache.get(module)||(temp=__reExport(__markAsModule({}),module,1),cache&&cache.set(module,temp),temp))("undefined"!=typeof WeakMap?new WeakMap:0),require_monaco_editor_core_amd=(cb={"src/fillers/monaco-editor-core-amd.ts"(exports,module){var api=__toESM(__require("vs/editor/editor.api"));module.exports=api}},function __require2(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),monaco_contribution_exports={};((target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})})(monaco_contribution_exports,{handlebarDefaults:()=>handlebarDefaults,handlebarLanguageService:()=>handlebarLanguageService,htmlDefaults:()=>htmlDefaults,htmlLanguageService:()=>htmlLanguageService,razorDefaults:()=>razorDefaults,razorLanguageService:()=>razorLanguageService,registerHTMLLanguageService:()=>registerHTMLLanguageService});var monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,__toESM(require_monaco_editor_core_amd()));var optionsDefault={format:{tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},suggest:{},data:{useDefaultDataProvider:!0}};function getConfigurationDefault(languageId){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:languageId===htmlLanguageId,documentFormattingEdits:languageId===htmlLanguageId,documentRangeFormattingEdits:languageId===htmlLanguageId}}var htmlLanguageId="html",htmlLanguageService=registerHTMLLanguageService(htmlLanguageId,optionsDefault,getConfigurationDefault(htmlLanguageId)),htmlDefaults=htmlLanguageService.defaults,handlebarLanguageService=registerHTMLLanguageService("handlebars",optionsDefault,getConfigurationDefault("handlebars")),handlebarDefaults=handlebarLanguageService.defaults,razorLanguageService=registerHTMLLanguageService("razor",optionsDefault,getConfigurationDefault("razor")),razorDefaults=razorLanguageService.defaults;function registerHTMLLanguageService(languageId,options=optionsDefault,modeConfiguration=getConfigurationDefault(languageId)){const defaults=new class{_onDidChange=new monaco_editor_core_exports.Emitter;_options;_modeConfiguration;_languageId;constructor(languageId,options,modeConfiguration){this._languageId=languageId,this.setOptions(options),this.setModeConfiguration(modeConfiguration)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(options){this._options=options||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(modeConfiguration){this._modeConfiguration=modeConfiguration||Object.create(null),this._onDidChange.fire(this)}}(languageId,options,modeConfiguration);let mode;const onLanguageListener=monaco_editor_core_exports.languages.onLanguage(languageId,(async()=>{mode=(await function getMode(){return new Promise(((resolve,reject)=>{__require(["vs/language/html/htmlMode"],resolve,reject)}))}()).setupMode(defaults)}));return{defaults,dispose(){onLanguageListener.dispose(),mode?.dispose(),mode=void 0}}}return monaco_editor_core_exports.languages.html={htmlDefaults,razorDefaults,handlebarDefaults,htmlLanguageService,handlebarLanguageService,razorLanguageService,registerHTMLLanguageService},__toCommonJS(monaco_contribution_exports)})())),define("vs/language/json/monaco.contribution",["require","vs/editor/editor.api"],(require=>(()=>{var cb,mod,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__markAsModule=target=>__defProp(target,"__esModule",{value:!0}),__require=(x=>void 0!==require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(a,b)=>(void 0!==require?require:a)[b]}):x)((function(x){if(void 0!==require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')})),__reExport=(target,module,copyDefault,desc)=>{if(module&&"object"==typeof module||"function"==typeof module)for(let key of __getOwnPropNames(module))__hasOwnProp.call(target,key)||!copyDefault&&"default"===key||__defProp(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});return target},__toESM=(module,isNodeMode)=>__reExport(__markAsModule(__defProp(null!=module?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:!0}:{value:module,enumerable:!0})),module),__toCommonJS=(cache=>(module,temp)=>cache&&cache.get(module)||(temp=__reExport(__markAsModule({}),module,1),cache&&cache.set(module,temp),temp))("undefined"!=typeof WeakMap?new WeakMap:0),require_monaco_editor_core_amd=(cb={"src/fillers/monaco-editor-core-amd.ts"(exports,module){var api=__toESM(__require("vs/editor/editor.api"));module.exports=api}},function __require2(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),monaco_contribution_exports={};((target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})})(monaco_contribution_exports,{jsonDefaults:()=>jsonDefaults});var monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,__toESM(require_monaco_editor_core_amd()));var jsonDefaults=new class{_onDidChange=new monaco_editor_core_exports.Emitter;_diagnosticsOptions;_modeConfiguration;_languageId;constructor(languageId,diagnosticsOptions,modeConfiguration){this._languageId=languageId,this.setDiagnosticsOptions(diagnosticsOptions),this.setModeConfiguration(modeConfiguration)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(options){this._diagnosticsOptions=options||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(modeConfiguration){this._modeConfiguration=modeConfiguration||Object.create(null),this._onDidChange.fire(this)}}("json",{validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},{documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0});return monaco_editor_core_exports.languages.json={jsonDefaults},monaco_editor_core_exports.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]}),monaco_editor_core_exports.languages.onLanguage("json",(()=>{(function getMode(){return new Promise(((resolve,reject)=>{__require(["vs/language/json/jsonMode"],resolve,reject)}))})().then((mode=>mode.setupMode(jsonDefaults)))})),__toCommonJS(monaco_contribution_exports)})())),define("vs/language/typescript/monaco.contribution",["require","vs/editor/editor.api"],(require=>(()=>{var cb,mod,__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__markAsModule=target=>__defProp(target,"__esModule",{value:!0}),__require=(x=>void 0!==require?require:"undefined"!=typeof Proxy?new Proxy(x,{get:(a,b)=>(void 0!==require?require:a)[b]}):x)((function(x){if(void 0!==require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+x+'" is not supported')})),__reExport=(target,module,copyDefault,desc)=>{if(module&&"object"==typeof module||"function"==typeof module)for(let key of __getOwnPropNames(module))__hasOwnProp.call(target,key)||!copyDefault&&"default"===key||__defProp(target,key,{get:()=>module[key],enumerable:!(desc=__getOwnPropDesc(module,key))||desc.enumerable});return target},__toESM=(module,isNodeMode)=>__reExport(__markAsModule(__defProp(null!=module?__create(__getProtoOf(module)):{},"default",!isNodeMode&&module&&module.__esModule?{get:()=>module.default,enumerable:!0}:{value:module,enumerable:!0})),module),__toCommonJS=(cache=>(module,temp)=>cache&&cache.get(module)||(temp=__reExport(__markAsModule({}),module,1),cache&&cache.set(module,temp),temp))("undefined"!=typeof WeakMap?new WeakMap:0),require_monaco_editor_core_amd=(cb={"src/fillers/monaco-editor-core-amd.ts"(exports,module){var api=__toESM(__require("vs/editor/editor.api"));module.exports=api}},function __require2(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),monaco_contribution_exports={};((target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})})(monaco_contribution_exports,{JsxEmit:()=>JsxEmit,ModuleKind:()=>ModuleKind,ModuleResolutionKind:()=>ModuleResolutionKind,NewLineKind:()=>NewLineKind,ScriptTarget:()=>ScriptTarget,getJavaScriptWorker:()=>getJavaScriptWorker,getTypeScriptWorker:()=>getTypeScriptWorker,javascriptDefaults:()=>javascriptDefaults,typescriptDefaults:()=>typescriptDefaults,typescriptVersion:()=>typescriptVersion2});var monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,__toESM(require_monaco_editor_core_amd()));var ModuleKind=(ModuleKind2=>(ModuleKind2[ModuleKind2.None=0]="None",ModuleKind2[ModuleKind2.CommonJS=1]="CommonJS",ModuleKind2[ModuleKind2.AMD=2]="AMD",ModuleKind2[ModuleKind2.UMD=3]="UMD",ModuleKind2[ModuleKind2.System=4]="System",ModuleKind2[ModuleKind2.ES2015=5]="ES2015",ModuleKind2[ModuleKind2.ESNext=99]="ESNext",ModuleKind2))(ModuleKind||{}),JsxEmit=(JsxEmit2=>(JsxEmit2[JsxEmit2.None=0]="None",JsxEmit2[JsxEmit2.Preserve=1]="Preserve",JsxEmit2[JsxEmit2.React=2]="React",JsxEmit2[JsxEmit2.ReactNative=3]="ReactNative",JsxEmit2[JsxEmit2.ReactJSX=4]="ReactJSX",JsxEmit2[JsxEmit2.ReactJSXDev=5]="ReactJSXDev",JsxEmit2))(JsxEmit||{}),NewLineKind=(NewLineKind2=>(NewLineKind2[NewLineKind2.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",NewLineKind2[NewLineKind2.LineFeed=1]="LineFeed",NewLineKind2))(NewLineKind||{}),ScriptTarget=(ScriptTarget2=>(ScriptTarget2[ScriptTarget2.ES3=0]="ES3",ScriptTarget2[ScriptTarget2.ES5=1]="ES5",ScriptTarget2[ScriptTarget2.ES2015=2]="ES2015",ScriptTarget2[ScriptTarget2.ES2016=3]="ES2016",ScriptTarget2[ScriptTarget2.ES2017=4]="ES2017",ScriptTarget2[ScriptTarget2.ES2018=5]="ES2018",ScriptTarget2[ScriptTarget2.ES2019=6]="ES2019",ScriptTarget2[ScriptTarget2.ES2020=7]="ES2020",ScriptTarget2[ScriptTarget2.ESNext=99]="ESNext",ScriptTarget2[ScriptTarget2.JSON=100]="JSON",ScriptTarget2[ScriptTarget2.Latest=99]="Latest",ScriptTarget2))(ScriptTarget||{}),ModuleResolutionKind=(ModuleResolutionKind2=>(ModuleResolutionKind2[ModuleResolutionKind2.Classic=1]="Classic",ModuleResolutionKind2[ModuleResolutionKind2.NodeJs=2]="NodeJs",ModuleResolutionKind2))(ModuleResolutionKind||{}),LanguageServiceDefaultsImpl=class{_onDidChange=new monaco_editor_core_exports.Emitter;_onDidExtraLibsChange=new monaco_editor_core_exports.Emitter;_extraLibs;_removedExtraLibs;_eagerModelSync;_compilerOptions;_diagnosticsOptions;_workerOptions;_onDidExtraLibsChangeTimeout;_inlayHintsOptions;constructor(compilerOptions,diagnosticsOptions,workerOptions,inlayHintsOptions){this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(compilerOptions),this.setDiagnosticsOptions(diagnosticsOptions),this.setWorkerOptions(workerOptions),this.setInlayHintsOptions(inlayHintsOptions),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(content,_filePath){let filePath;if(filePath=void 0===_filePath?`ts:extralib-${Math.random().toString(36).substring(2,15)}`:_filePath,this._extraLibs[filePath]&&this._extraLibs[filePath].content===content)return{dispose:()=>{}};let myVersion=1;return this._removedExtraLibs[filePath]&&(myVersion=this._removedExtraLibs[filePath]+1),this._extraLibs[filePath]&&(myVersion=this._extraLibs[filePath].version+1),this._extraLibs[filePath]={content,version:myVersion},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let extraLib=this._extraLibs[filePath];extraLib&&extraLib.version===myVersion&&(delete this._extraLibs[filePath],this._removedExtraLibs[filePath]=myVersion,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(libs){for(const filePath in this._extraLibs)this._removedExtraLibs[filePath]=this._extraLibs[filePath].version;if(this._extraLibs=Object.create(null),libs&&libs.length>0)for(const lib of libs){const filePath=lib.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,content=lib.content;let myVersion=1;this._removedExtraLibs[filePath]&&(myVersion=this._removedExtraLibs[filePath]+1),this._extraLibs[filePath]={content,version:myVersion}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){-1===this._onDidExtraLibsChangeTimeout&&(this._onDidExtraLibsChangeTimeout=window.setTimeout((()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)}),0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(options){this._compilerOptions=options||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(options){this._diagnosticsOptions=options||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(options){this._workerOptions=options||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(options){this._inlayHintsOptions=options||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(value){}setEagerModelSync(value){this._eagerModelSync=value}getEagerModelSync(){return this._eagerModelSync}},typescriptVersion2="4.5.5",typescriptDefaults=new LanguageServiceDefaultsImpl({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{}),javascriptDefaults=new LanguageServiceDefaultsImpl({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{}),getTypeScriptWorker=()=>getMode().then((mode=>mode.getTypeScriptWorker())),getJavaScriptWorker=()=>getMode().then((mode=>mode.getJavaScriptWorker()));function getMode(){return new Promise(((resolve,reject)=>{__require(["vs/language/typescript/tsMode"],resolve,reject)}))}return monaco_editor_core_exports.languages.typescript={ModuleKind,JsxEmit,NewLineKind,ScriptTarget,ModuleResolutionKind,typescriptVersion:typescriptVersion2,typescriptDefaults,javascriptDefaults,getTypeScriptWorker,getJavaScriptWorker},monaco_editor_core_exports.languages.onLanguage("typescript",(()=>getMode().then((mode=>mode.setupTypeScript(typescriptDefaults))))),monaco_editor_core_exports.languages.onLanguage("javascript",(()=>getMode().then((mode=>mode.setupJavaScript(javascriptDefaults))))),__toCommonJS(monaco_contribution_exports)})())),define("vs/editor/editor.main",["vs/editor/edcore.main","vs/basic-languages/monaco.contribution","vs/language/css/monaco.contribution","vs/language/html/monaco.contribution","vs/language/json/monaco.contribution","vs/language/typescript/monaco.contribution"],(function(api){return api}));